window.__require=function t(e,o,i){function n(r,s){if(!o[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var p=o[r]={exports:{}};e[r][0].call(p.exports,function(t){return n(e[r][1][t]||t)},p,p.exports,t,e,o,i)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({AndroidManager:[function(t,e,o){"use strict";cc._RF.push(e,"40133XcA2tDz76REDE3IcGD","AndroidManager");var i=t,n=e,a=o;cc._RF.push(n,"40133XcA2tDz76REDE3IcGD","AndroidManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.AndroidManager=void 0,i("PlatformManager"),i("PlatformConfig");var r=function(){function t(){this.infostr=[],this.nativeCode="xx2"}return t.prototype.getLaunchOptionsSync=function(){},t.prototype.canShare=function(){return!1},t.prototype.pauseRecord=function(){},t.prototype.resumeRecord=function(){},t.prototype.toAppStore=function(){},t.prototype.openNotify=function(){},t.prototype.shareImg=function(){},t.prototype.getUserInfo=function(){},t.prototype.getIsZhiTouUser=function(){return!1},t.prototype.checkCanOpenSideBar=function(){},t.prototype.openSideBar=function(){},t.prototype.isFromBroadside=function(){},t.prototype.playMultitonVideo=function(){},t.prototype.checkShortcut=function(){},t.prototype.addShortcut=function(){},t.prototype.hasVerify=function(){return!0},t.prototype.youmengTrack=function(){console.log("\u53cb\u76df3")},t.prototype.initSdk=function(){},t.prototype.verifyKey=function(){},t.prototype.getCode=function(t){return t&&t(this.nativeCode),this.nativeCode},t.prototype.login=function(t,e){e&&e()},t.prototype.pay=function(t,e){e&&e()},t.prototype.share=function(t,e){e&&e()},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.showInsertAd=function(t){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/SdkManager","showInsertAd","(Ljava/lang/String;)V",t)},t.prototype.showVideoAd=function(t,e,o){this.callback=e,this.errorCallback=o},t.prototype.videoCallback=function(t){var e=this;t?setTimeout(function(){e.callback&&e.callback()},1e3):setTimeout(function(){e.errorCallback&&e.errorCallback()},1e3)},t.prototype.otherFun=function(t,e){e&&e()},t.prototype.shark=function(t,e){e&&e()},t.prototype.recordVideo=function(t,e){e&&e()},t.prototype.shareVideo=function(t,e){e&&e()},t.prototype.stopRecorderManager=function(t,e){e&&e()},t.prototype.setLanguage=function(t,e){return e&&e(),"zh"},t}();a.AndroidManager=r,cc._RF.pop(),cc._RF.pop()},{}],AniBg:[function(t,e,o){"use strict";cc._RF.push(e,"ddc68L0Z8VOHKwE62vVcTzg","AniBg");var i=e,n=o;cc._RF.push(i,"ddc68L0Z8VOHKwE62vVcTzg","AniBg");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.start=function(){this.node.setContentSize(2e3,2e3),cc.tween(this.node).set({position:cc.v3(0,0,0)}).to(6,{position:cc.v3(403,202)}).union().repeatForever().start()},s([l],e)}(cc.Component));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],AnimationAction:[function(t,e){"use strict";cc._RF.push(e,"13d4cYjE4pKzLAAtggYj92A","AnimationAction");var o=e;cc._RF.push(o,"13d4cYjE4pKzLAAtggYj92A","AnimationAction"),cc._RF.pop(),cc._RF.pop()},{}],AppManager:[function(t,e,o){"use strict";cc._RF.push(e,"7a92beSf6tNlZFbo2fm2LFH","AppManager");var i=t,n=e,a=o;cc._RF.push(n,"7a92beSf6tNlZFbo2fm2LFH","AppManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.IAppManager=a.AppManager=void 0;var r=i("BasePlatform"),s=i("Appcfg"),c=i("PlatformConfig"),l=i("PlatformSetting"),p=i("HttpMgr"),u=function(){function t(){this._switchsMap=new Map}return t.prototype.getABDConf=function(){return c.ABCF[l.PlatformSetting.currentApp]?this.getCheckVersion(l.SwitchID.ShenHe_ABD)?c.ABCF[l.PlatformSetting.currentApp][s.ABD_ENV.DEV]:c.ABCF[l.PlatformSetting.currentApp][s.ABD_ENV.PRO]:(console.error("\u6ca1\u6709\u914d\u7f6e\u5f53\u524d\u5e94\u7528\u540d"),null)},t.prototype.getAdConf=function(){return c.ABCF[l.PlatformSetting.currentApp]?c.AdConfig[l.PlatformSetting.currentApp]:(console.error("\u6ca1\u6709\u914d\u7f6e\u5f53\u524d\u5e94\u7528\u540d"),null)},t.prototype.getUMConf=function(){return c.UM_VERSION[l.PlatformSetting.currentApp]?c.UM_VERSION[l.PlatformSetting.currentApp]:(console.error("\u6ca1\u6709\u914d\u7f6e\u5f53\u524d\u5e94\u7528\u540d"),null)},t.prototype.requestCheckVersion=function(t){var e=this;if(l.PlatformSetting.currentPlatform==r.Platform.BYTEDANCE||l.PlatformSetting.currentPlatform==r.Platform.WECHAT||l.PlatformSetting.currentPlatform==r.Platform.KuaiShou||l.PlatformSetting.currentPlatform==r.Platform.KUAIKAN){var o=this._getSwitchIds(),i=this._getABSwitchIds(),n="";for(var a in o)(u=o[a]).appId<=0||-1!=u[l.PlatformSetting.currentPlatform]&&(n=n+u.appId+",");for(var a in i){var u,d=i[a];if(!(d.switchId<=0)&&(u=c.ABSettingCF[l.PlatformSetting.currentApp])){var h=u[l.PlatformSetting.currentPlatform];!h||h.type!=s.ABTestType.AB_Test&&h.type!=s.ABTestType.ABD_Test||(n=n+d.switchId+",")}}0!=n.length?(n=n.substring(0,n.length-1),cc.log("appids",n),p.HttpMgr.getInstance().httpPost({appIds:n},function(o){if(o){var i=JSON.parse(o);if(i&&i.data){for(var n=0,a=i.data;n<a.length;n++){var r=a[n];e._switchsMap.set(r.appId,r)}cc.log("appids",e._switchsMap)}t()}else t()},"https://yuema.sfplay.net:9090/getPlatformInfo4")):t()}else t()},t.prototype.getCheckVersion=function(t){if(l.PlatformSetting.currentPlatform==r.Platform.EDITOR)return!1;if(l.PlatformSetting.currentPlatform==r.Platform.WEB_LINK)return!1;if(l.PlatformSetting.currentPlatform==r.Platform.VIVO)return t!=l.SwitchID.ShenHe_ABD;if(l.PlatformSetting.currentPlatform==r.Platform.OPPO)return t!=l.SwitchID.ShenHe_ABD;if(l.PlatformSetting.currentPlatform==r.Platform.ANDROID_233)return t!=l.SwitchID.ShenHe_ABD;if(l.PlatformSetting.currentPlatform==r.Platform.Implode)return t!=l.SwitchID.ShenHe_ABD;var e=c.SWCF[l.PlatformSetting.currentApp];if(!e)return console.error("\u6ca1\u6709\u914d\u7f6e\u5f53\u524d\u5e94\u7528\u540d"),!1;var o=e[t];if(!o)return console.error("\u6ca1\u6709\u914d\u7f6e\u5f53\u5e94\u7528\u7684\u5f00\u5173"),!1;var i=this._switchsMap.get(o.appId);return i?this.getSwitchVersion(o)==this.getSwitchVersion(i):(console.error("\u540e\u53f0\u6ca1\u914d\u7f6e"),!1)},t.prototype.getABVersion=function(t){if(l.PlatformSetting.currentPlatform==r.Platform.EDITOR)return null;if(l.PlatformSetting.currentPlatform==r.Platform.WEB_LINK)return null;var e=this._switchsMap.get(t);return e?this.getSwitchVersion(e):(console.error("\u540e\u53f0\u6ca1\u914d\u7f6e"),null)},t.prototype.getABTestType=function(){var t=c.ABSettingCF[l.PlatformSetting.currentApp];return t&&t[l.PlatformSetting.currentPlatform]?t[l.PlatformSetting.currentPlatform].type:s.ABTestType.NO_AB},t.prototype._getSwitchIds=function(){return c.SWCF[l.PlatformSetting.currentApp]||(console.error("\u6ca1\u6709\u914d\u7f6e\u5f53\u524d\u5e94\u7528\u540d"),null)},t.prototype._getABSwitchIds=function(){return c.ABCF[l.PlatformSetting.currentApp]||(console.error("\u6ca1\u6709\u914d\u7f6e\u5f53\u524d\u5e94\u7528\u540d"),null)},t.prototype.getSwitchVersion=function(t){if(!t)return cc.error("\u5f00\u5173\u6ca1\u6709\u914d\u7f6e,\u8bf7\u5230\u5728PlatformManager.ts\u4e0a\u8fdb\u884c\u914d\u7f6e"),0;switch(l.PlatformSetting.currentPlatform){case r.Platform.WECHAT:return t.h5_wechat;case r.Platform.BYTEDANCE:return t.h5_bytedance;case r.Platform.KUAIKAN:return t.h5_kuaikan;case r.Platform.OPPO:return t.h5_oppo;case r.Platform.VIVO:return t.h5_vivo;case r.Platform.QQ:return t.h5_qq;case r.Platform.ANDROID_233:return t.android_233;case r.Platform.ANDROID_4399:return t.android_4399;case r.Platform.ANDROID_VIVO:return t.android_vivo;case r.Platform.ANDROID_XIAOMI:return t.android_xiaomi;case r.Platform.GOOGLE:return t.android_google;case r.Platform.Ios:return t.ios;default:return t.h5_baidu}},t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t}();a.AppManager=u,a.IAppManager=u.getInstance(),cc._RF.pop(),cc._RF.pop()},{}],Appcfg:[function(t,e,o){"use strict";cc._RF.push(e,"f6782lzPXBN14uWcX62VMEH","Appcfg");var i=e,n=o;cc._RF.push(i,"f6782lzPXBN14uWcX62VMEH","Appcfg"),Object.defineProperty(n,"__esModule",{value:!0}),n.BaseEventName=n.ABTestType=n.ABD_ENV=n.ObjectWeightValue=n.ObjectValue=n.WeightObject=n.LoadingProcess=n.OrderLayer=n.LanguageType=void 0,function(t){t.zh="zh",t.zh_tw="fz",t.en="en",t.jp="jp"}(n.LanguageType||(n.LanguageType={})),function(t){t[t.main=0]="main",t[t.special=50]="special",t[t.pop=100]="pop",t[t.top=200]="top",t[t.pop2=300]="pop2",t[t.tip=400]="tip",t[t.guide=900]="guide",t[t.touch=1e3]="touch",t[t.Log=2e3]="Log"}(n.OrderLayer||(n.OrderLayer={})),function(t){t[t.StartLoading=5]="StartLoading",t[t.ExcelCfg=10]="ExcelCfg",t[t.PlayerCfg=20]="PlayerCfg",t[t.ResCfg=40]="ResCfg",t[t.AudioCfg=60]="AudioCfg",t[t.OtherCfg=80]="OtherCfg",t[t.EndLoading=100]="EndLoading"}(n.LoadingProcess||(n.LoadingProcess={})),n.WeightObject=function(){},n.ObjectValue=function(){},n.ObjectWeightValue=function(){},function(t){t[t.DEV=0]="DEV",t[t.PRO=1]="PRO"}(n.ABD_ENV||(n.ABD_ENV={})),function(t){t[t.NO_AB=0]="NO_AB",t[t.AB_Test=1]="AB_Test",t[t.ABD_Test=2]="ABD_Test",t[t.A_fixed=3]="A_fixed",t[t.B_fixed=4]="B_fixed",t[t.D_fixed=5]="D_fixed"}(n.ABTestType||(n.ABTestType={})),function(t){t.Loading="Loading",t.OpenUI="openUi",t.CloseUI="CloseUI",t.ShowTopUI="ShowTopUI",t.blocktouch="blocktouch",t.onShow="onShow",t.onHide="onHide",t.RefreshReport="onRefreshReport",t.ClearData="ClearData"}(n.BaseEventName||(n.BaseEventName={})),cc._RF.pop(),cc._RF.pop()},{}],ArgsParseUtils:[function(t,e,o){"use strict";cc._RF.push(e,"14743rQ6f9BObX51QcWz3Un","ArgsParseUtils");var i=e,n=o;cc._RF.push(i,"14743rQ6f9BObX51QcWz3Un","ArgsParseUtils"),Object.defineProperty(n,"__esModule",{value:!0}),n.ArgsParseUtils=void 0;var a=function(){function t(){}return t._makeLoadResArgs=function(){if(arguments.length<1||"string"!=typeof arguments[0])return console.error("_makeLoadResArgs error "+arguments),null;for(var t={bundle:arguments[0],path:arguments[1],type:arguments[2],callback:arguments[3],autoRelese:!1,cacheTme:10,saveKey:null},e=4;e<arguments.length;++e)4==e&&"boolean"==typeof arguments[e]&&(t.autoRelese=arguments[e]),5==e&&"number"==typeof arguments[e]?t.cacheTme=arguments[e]:e==arguments.length-1&&"string"==typeof arguments[e]&&(t.saveKey=arguments[e]);return t},t._makeloadSpriteFrameResrgs=function(){if(arguments.length<1||"string"!=typeof arguments[0])return console.error("_makeloadSpriteFrameResrgs error "+arguments),null;for(var t={bundle:arguments[0],path:arguments[1],callback:arguments[2],autoRelese:!1,cacheTme:10,saveKey:null},e=3;e<arguments.length;++e)3==e&&"boolean"==typeof arguments[e]&&(t.autoRelese=arguments[e]),4==e&&"number"==typeof arguments[e]?t.cacheTme=arguments[e]:e==arguments.length-1&&"string"==typeof arguments[e]&&(t.saveKey=arguments[e]);return t},t}();n.ArgsParseUtils=a,cc._RF.pop(),cc._RF.pop()},{}],ArrLib:[function(t,e,o){"use strict";cc._RF.push(e,"85d2cTbLK1Pca0XsxQZ7bJq","ArrLib");var i=e,n=o;cc._RF.push(i,"85d2cTbLK1Pca0XsxQZ7bJq","ArrLib"),Object.defineProperty(n,"__esModule",{value:!0}),n.ArrLib=void 0;var a=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.getUniqueElementsByIndex=function(t,e){var o;if(e>t.length)throw new Error("n cannot be greater than the array length");for(var i=Object.keys(t),n=i.length-1;n>0;n--){var a=Math.floor(Math.random()*(n+1));o=[i[a],i[n]],i[n]=o[0],i[a]=o[1]}return i.slice(0,e).map(function(e){return t[e]})},t.prototype.getRandomUniqueElements=function(t,e){var o=t.slice(),i=[];if(e<=t.length)for(var n=0;n<e;n++){var a=Math.floor(Math.random()*o.length);i.push(o.splice(a,1)[0])}else{i.push.apply(i,o);var r=e-t.length;for(n=0;n<r;n++)a=Math.floor(Math.random()*t.length),i.push(t[a])}return i},t}();n.ArrLib=a,cc._RF.pop(),cc._RF.pop()},{}],AudioMgr:[function(t,e,o){"use strict";cc._RF.push(e,"01e28yg0bJGMoJ+TmUHgvk/","AudioMgr");var i=t,n=e,a=o;cc._RF.push(n,"01e28yg0bJGMoJ+TmUHgvk/","AudioMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.AudioMgr=void 0;var c=i("Config"),l=i("BaseMgr"),p=i("CacheUtils"),u=i("LogMgr"),d=i("ResourceMgr"),h=function(t){function e(){var e=t.call(this)||this;return e.audioSourceMap=new Map,e.audioClipMap=new Map,e.freeEffectMap=new Map,e.ADConf={},e.otherADConf=[],e.musicKeys=[],e.effectVolume=1,e.musicVolume=1,e}return s(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.init=function(t){this.ADConf=t;var e=p.CacheUtils.getData("EFFECTVOLUME");e&&(this.effectVolume=Number(e));var o=p.CacheUtils.getData("MUSICVOLUME");o&&(this.musicVolume=Number(o)),this.setButtonNomalAudio(c.AudioId.btnClick)},e.prototype.loadAudio=function(t,e){var o=this,i=this.getAdConf(t);i?d.ResourceMgr.getInstance().loadRes(i.bundle,i.path,cc.AudioClip,function(t){o.audioClipMap.set(i.path,t),e&&e()}):u.LogMgr.getInstance().error("\u97f3\u6548\u6ca1\u6709\u914d\u7f6e\uff1a",t)},e.prototype.addAdConf=function(t){this.otherADConf.push(t)},e.prototype.getAdConf=function(t){var e=this.ADConf[t];if(e)return e;for(var o=0;o<this.otherADConf.length;o++){var i=this.otherADConf[o][t];if(i)return i}return null},e.prototype.addMusicKey=function(t){for(var e=0;e<this.musicKeys.length;e++)if(this.musicKeys[e]==t)return!1;return this.musicKeys.push(t),!0},e.prototype.removeMusicKey=function(t){for(var e=0;e<this.musicKeys.length;e++)if(this.musicKeys[e]==t)return this.musicKeys.splice(e,1),!0;return!1},e.prototype.creatreAudioSource=function(t){var e=new cc.AudioSource;return this.audioSourceMap.has(t)&&this.audioSourceMap.get(t).destroy(),this.audioSourceMap.set(t,e),e},e.prototype.setEffectVolume=function(t){void 0===t&&(t=1),this.effectVolume=t,this.effectVolume<=0&&(this.effectVolume=.01),p.CacheUtils.saveData("EFFECTVOLUME",this.effectVolume+"")},e.prototype.setMusicVolume=function(t){var e=this;void 0===t&&(t=1),this.musicVolume=t,this.musicVolume<=0&&(this.musicVolume=.01),this.musicKeys.forEach(function(t){var o=e.getAudioSource(t);null!=o?o.volume=e.musicVolume:u.LogMgr.getInstance().error("audioSourceName\uff1a"+t+"\u4e0d\u5b58\u5728")}),p.CacheUtils.saveData("MUSICVOLUME",this.musicVolume+"")},e.prototype.getEffectVolume=function(){return this.effectVolume},e.prototype.getMusicVolume=function(){return this.musicVolume},e.prototype.getAudioSource=function(t){return this.audioSourceMap.has(t)?this.audioSourceMap.get(t):this.creatreAudioSource(t)},e.prototype.playMusic=function(t,e,o,i){var n=this;if(void 0===o&&(o=!0),void 0===i&&(i=1),p.CacheUtils.canPlayMusin()){var a=this.getAudioSource(e);if(null==a)return void u.LogMgr.getInstance().error("audioSourceName\uff1a"+e+"\u4e0d\u5b58\u5728");a.stop();var r=this.getAdConf(t);if(null==r)return void u.LogMgr.getInstance().error("audio id:"+t+"\u4e0d\u5b58\u5728");if(o&&this.addMusicKey(e),this.audioClipMap.has(r.path)){var s=this.audioClipMap.get(r.path);a.clip=s,a.loop=o,a.volume=this.musicVolume?this.musicVolume:i,a.play()}else d.ResourceMgr.getInstance().loadRes(r.bundle,r.path,cc.AudioClip,function(t){a.clip=t,n.audioClipMap.set(r.path,t),a.loop=o,a.volume=n.musicVolume?n.musicVolume:i,a.play()})}},e.prototype.pauseMusic=function(t){if(p.CacheUtils.canPlayMusin()){var e=this.getAudioSource(t);if(null==e)return void u.LogMgr.getInstance().error("audioSourceName\uff1a"+t+"\u4e0d\u5b58\u5728");e.pause()}},e.prototype.resumeMusic=function(t){if(p.CacheUtils.canPlayMusin()){var e=this.getAudioSource(t);if(null==e)return void u.LogMgr.getInstance().error("audioSourceName\uff1a"+t+"\u4e0d\u5b58\u5728");e.resume()}},e.prototype.pauseAllMusic=function(){var t=this;this.musicKeys.forEach(function(e){t.pauseMusic(e)})},e.prototype.resumeAllMusic=function(){var t=this;this.musicKeys.forEach(function(e){t.resumeMusic(e)})},e.prototype.stopMusic=function(t){if(p.CacheUtils.canPlayMusin()){var e=this.getAudioSource(t);if(null==e)return void u.LogMgr.getInstance().error("audioSourceName\uff1a"+t+"\u4e0d\u5b58\u5728");this.removeMusicKey(t),e.stop()}},e.prototype.stopAll=function(){this.audioSourceMap.forEach(function(t){t.stop()}),this.freeEffectMap.forEach(function(t){t.stop()})},e.prototype.playEffect=function(t,e,o){var i=this;if(void 0===e&&(e="effect"),void 0===o&&(o=1),p.CacheUtils.canPlayEffect()){var n=this.EffectAduioSource;null==n&&(n=this.getAudioSource(e));var a=this.getAdConf(t);if(this.audioClipMap.has(a.path)){var r=this.audioClipMap.get(a.path);n.clip=r,n.volume=this.effectVolume?this.effectVolume:o,n.play()}else d.ResourceMgr.getInstance().loadRes(a.bundle,a.path,cc.AudioClip,function(t){i.audioClipMap.set(a.path,t),n.clip=t,n.volume=i.effectVolume?i.effectVolume:o,n.play()})}},e.prototype.playEffectFree=function(t,e,o){var i=this;if(void 0===e&&(e=1),void 0===o&&(o=20),p.CacheUtils.canPlayEffect()){for(var n,a=function(o){var a=r.freeEffectMap.get("effect"+o);if(null==a&&(a=r.getAudioSource("effect"+o),r.freeEffectMap.set("effect"+o,a)),!a.isPlaying){var s=r.getAdConf(t);if(r.audioClipMap.has(s.path)){var c=r.audioClipMap.get(s.path);a.clip=c,a.volume=r.effectVolume?r.effectVolume:e,a.play()}else d.ResourceMgr.getInstance().loadRes(s.bundle,s.path,cc.AudioClip,function(t){i.audioClipMap.set(s.path,t),a.clip=t,a.volume=i.effectVolume?i.effectVolume:e,a.play()});return n=!0,"break"}},r=this,s=1;s<o&&"break"!==a(s);s++);n||this.playEffect(t,void 0,e)}},e.prototype.playAudioFromPath=function(t,e,o,i,n){var a=this;if(p.CacheUtils.canPlayMusin()){var r=this.getAudioSource(o);if(null==r)return void u.LogMgr.getInstance().error("audioSourceName\uff1a"+o+"\u4e0d\u5b58\u5728");if(r.stop(),this.audioClipMap.has(t+e)){var s=this.audioClipMap.get(t+e);r.clip=s,r.volume=this.musicVolume,i?(r.loop=!0,this.addMusicKey(o)):r.loop=!1,r.play(),n&&n(r)}else d.ResourceMgr.getInstance().loadRes(t,String(e),cc.AudioClip,function(s){r.clip=s,a.audioClipMap.set(t+e,s),r.volume=a.musicVolume,i?(r.loop=!0,a.addMusicKey(o)):r.loop=!1,r.play(),n&&n(r)})}},e.prototype.stopEffect=function(){var t=this.getAudioSource("effect");t&&t.stop()},e.prototype.setButtonNomalAudio=function(t){this.normalButtonAudio=t},e.prototype.playAudioButtonClicked=function(){this.normalButtonAudio&&this.playEffect(this.normalButtonAudio,"click")},e}(l.default);a.AudioMgr=h,cc._RF.pop(),cc._RF.pop()},{}],BACK_APP2:[function(t,e,o){"use strict";cc._RF.push(e,"fa277IqxtVOrpdjiXg4o/r0","BACK_APP2");var i=t,n=e,a=o;cc._RF.push(n,"fa277IqxtVOrpdjiXg4o/r0","BACK_APP2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("AudioMgr"),l=i("UIMgr"),p=i("BACK_PlayerData"),u=i("BACK_PoolMgr"),d=i("BACK_Config"),h=i("BACK_DataMgr"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isInited=!1,e._exitCall=null,e.isLevel2=!1,e}return s(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.enter_App=function(t,e,o){void 0===o&&(o=!1),this.isLevel2=!0,cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!0,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,this._exitCall=e,c.AudioMgr.getInstance().pauseAllMusic();var i=function(){l.UIMgr.getInstance().openUIOfCallback(d.BACK_UIID.BACK_UIGame2,d.BACK_UIID.BACK_UIGame2,function(){t&&t()})};this._isInited?i():(this.backData=new p.default,this.backData.getData(),l.UIMgr.getInstance().addUICnf(d.BACK_UICF),c.AudioMgr.getInstance().addAdConf(d.BACK_Audio),h.default.getInstance().loadCfg(function(){i()}))},e.prototype.exit_App=function(t){void 0===t&&(t=0),this.isLevel2=!1,cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!1,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,cc.systemEvent.clear(),l.UIMgr.getInstance().closeById(d.BACK_UIID.BACK_UIGame2),l.UIMgr.getInstance().closeById(d.BACK_UIID.BACK_UIPause),l.UIMgr.getInstance().closeById(d.BACK_UIID.BACK_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,u.default.getInstance().clear()},e._instance=null,e}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BACK_APP:[function(t,e,o){"use strict";cc._RF.push(e,"073fdKeMJBEbKYPYfOMdojv","BACK_APP");var i=t,n=e,a=o;cc._RF.push(n,"073fdKeMJBEbKYPYfOMdojv","BACK_APP");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("AudioMgr"),l=i("UIMgr"),p=i("BACK_PlayerData"),u=i("BACK_PoolMgr"),d=i("BACK_Config"),h=i("BACK_DataMgr"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isInited=!1,e._exitCall=null,e}return s(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.enter_App=function(t,e,o){void 0===o&&(o=!1),cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!0,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,this._exitCall=e,c.AudioMgr.getInstance().pauseAllMusic();var i=function(){l.UIMgr.getInstance().openUIOfCallback(d.BACK_UIID.BACK_UIGame1,d.BACK_UIID.BACK_UIGame1,function(){t&&t()})};this._isInited?i():(this.backData=new p.default,this.backData.getData(),l.UIMgr.getInstance().addUICnf(d.BACK_UICF),c.AudioMgr.getInstance().addAdConf(d.BACK_Audio),h.default.getInstance().loadCfg(function(){i()}))},e.prototype.exit_App=function(t){void 0===t&&(t=0),cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!1,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,cc.systemEvent.clear(),l.UIMgr.getInstance().closeById(d.BACK_UIID.BACK_UIGame1),l.UIMgr.getInstance().closeById(d.BACK_UIID.BACK_UIPause),l.UIMgr.getInstance().closeById(d.BACK_UIID.BACK_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,u.default.getInstance().clear()},e._instance=null,e}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BACK_Btn_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"a55b9UyD6NI9Ymzdx/ZeVVe","BACK_Btn_Skills");var i=t,n=e,a=o;cc._RF.push(n,"a55b9UyD6NI9Ymzdx/ZeVVe","BACK_Btn_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("BACK_Config"),d=i("BACK_DataMgr"),h=i("BACK_GameManager"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skillName=null,e.lockMack=null,e.skillIcon=null,e.isDie=!1,e.skillID=0,e.level=0,e.isSkillLock=!1,e.skillInterval=0,e.skillTime=0,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.skillID=t,this.lockMack.node.active=!1,this.skillName.string=d.default.getInstance().getSkillsCfg(t).introduce,this.skillInterval=d.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime=this.skillInterval,this.updateLevel(e),this.node.on(cc.Node.EventType.TOUCH_END,this.playSkill,this),this.node.setScale(0);var i="skillsBtnIcon/"+d.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(u.BACK_BundleName.Sprite,i,function(t){o.skillIcon.spriteFrame=t,cc.tween(o.node).to(.2,{scale:1}).start()})},e.prototype.update=function(t){h.default.Instance.gameState!=u.BACK_GameState.pause&&h.default.Instance.isfight&&(this.isDie||this.isSkillLock&&(this.skillTime-=t,this.lockMack.progress=this.skillTime/this.skillInterval,this.skillTime<0&&(this.isSkillLock=!1,this.lockMack.node.active=!1)))},e.prototype.updateLevel=function(t){var e=this;if(this.level!=t){this.level=t;var o="skillsBtnIcon/kuang_0"+this.level;this.loadSpriteFrame(u.BACK_BundleName.Sprite,o,function(t){e.node.getComponent(cc.Sprite).spriteFrame=t})}},e.prototype.playSkill=function(){if(h.default.Instance.isfight&&!this.isSkillLock){switch(this.lockMack.node.active=!0,this.lockMack.progress=1,this.isSkillLock=!0,this.skillTime=this.skillInterval,this.skillID){case 1:case 2:case 3:case 4:case 6:case 8:case 9:case 10:case 11:h.default.Instance.playSkillsAtk(this.skillID);break;case 5:this.sendEvent(u.BACK_EventName.SkillsAtkDouble);break;case 7:h.default.Instance.playSkillsRole()}p.AudioMgr.getInstance().playEffectFree(d.default.getInstance().getSkillsCfg(this.skillID).mateSound),this.sendEvent(u.BACK_EventName.PlaySkillBanner,this.skillID)}},c([g(cc.Label)],e.prototype,"skillName",void 0),c([g(cc.ProgressBar)],e.prototype,"lockMack",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BACK_Config:[function(t,e,o){"use strict";cc._RF.push(e,"8d9aaBmV7dLVbkpCmS8wxL1","BACK_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"8d9aaBmV7dLVbkpCmS8wxL1","BACK_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.BACK_RoleAsePath=l.BACK_RoleType=l.BACK_GameState=l.BACK_MoveRoleState=l.BACK_AnimName=l.BACK_EventName=l.BACK_Audio=l.BACK_AudioId=l.BACK_UICF=l.BACK_UIID=l.BACK_BundleName=void 0,function(t){t.Prefabs="BACK_Prefabs",t.Sprite="BACK_Sprite",t.Audio="BACK_Audio",t.SpAnim="BACK_SpAnim"}(a=l.BACK_BundleName||(l.BACK_BundleName={})),function(t){t.BACK_UIGame1="BACK_UIGame_Level1",t.BACK_UIGame2="BACK_UIGame_Level2",t.BACK_UIGM="BACK_UIGM",t.BACK_UIPause="BACK_UIPause",t.BACK_UIGameOver="BACK_UIGameOver",t.BACK_SelectLevel="BACK_SelectLevel"}(r=l.BACK_UIID||(l.BACK_UIID={})),l.BACK_UICF=((i={})[r.BACK_UIGame1]={prefab:"ui/BACK_UIGame_Level1",name:"BACK_UIGame_Level1",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.BACK_UIGame2]={prefab:"ui/BACK_UIGame_Level2",name:"BACK_UIGame_Level2",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.BACK_UIGM]={prefab:"ui/BACK_UIGM",name:"BACK_UIGM",showTop:!0,showMult:!1,zIndex:1002,bundleName:a.Prefabs},i[r.BACK_UIPause]={prefab:"ui/BACK_UIPause",name:"BACK_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.BACK_UIGameOver]={prefab:"ui/BACK_UIGameOver",name:"BACK_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.BACK_SelectLevel]={prefab:"ui/BACK_SelectLevel",name:"BACK_SelectLevel",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i),function(t){t.dragonHit="dragonHit",t.gongji="gongji",t.shibai="shibai",t.shengji="shengji",t.shitou="shitou",t.kaishi="kaishi",t.fangrugezi="fangrugezi",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.moonGod="moonGod",t.boom="boom",t.summon="summon",t.cwsq="cwsq",t.jdqx="jdqx",t.sgml="sgml",t.zysq="zysq"}(s=l.BACK_AudioId||(l.BACK_AudioId={})),l.BACK_Audio=((n={})[s.dragonHit]={path:s.dragonHit,bundle:a.Audio},n[s.gongji]={path:s.gongji,bundle:a.Audio},n[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.shengji]={path:s.shengji,bundle:a.Audio},n[s.shitou]={path:s.shitou,bundle:a.Audio},n[s.kaishi]={path:s.kaishi,bundle:a.Audio},n[s.fangrugezi]={path:s.fangrugezi,bundle:a.Audio},n[s.lotus]={path:s.lotus,bundle:a.Audio},n[s.goldGod]={path:s.goldGod,bundle:a.Audio},n[s.classic]={path:s.classic,bundle:a.Audio},n[s.swordHit]={path:s.swordHit,bundle:a.Audio},n[s.moonGod]={path:s.moonGod,bundle:a.Audio},n[s.boom]={path:s.boom,bundle:a.Audio},n[s.summon]={path:s.summon,bundle:a.Audio},n[s.cwsq]={path:s.cwsq,bundle:a.Audio},n[s.jdqx]={path:s.jdqx,bundle:a.Audio},n[s.sgml]={path:s.sgml,bundle:a.Audio},n[s.zysq]={path:s.zysq,bundle:a.Audio},n),function(t){t.SetGameState="BACK_SetGameState",t.UpdateWaveUI="BACK_UpdateWaveUI",t.UpdateWaveBarUI="BACK_UpdateWaveBarUI",t.PlaySkillsAtk="BACK_PlaySkillsAtk",t.SkillsAtkDouble="BACK_SkillsAtkDouble",t.WaveOver="BACK_WaveOver",t.ActivateSkills="BACK_ActivateSkills",t.ActivateRoleSkills="BACK_ActivateRoleSkills",t.PlaySkillBanner="BACK_PlaySkillBanner",t.PlayStoneAtkEnAnim="BACK_PlayStoneAtkEnAnim",t.PlayGame="BACK_PlayGame",t.BoxTouchState="BACK_BoxTouchState",t.UpdateAllBoxAccord="BACK_UpdateAllBoxAccord",t.IsAtkStone="BACK_IsAtkStone",t.PlayTips="BACK_PlayTips"}(l.BACK_EventName||(l.BACK_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="move",t.animation="animation"}(l.BACK_AnimName||(l.BACK_AnimName={})),function(t){t[t.TouchStart=0]="TouchStart",t[t.TouchMove=1]="TouchMove",t[t.TouchEnd=2]="TouchEnd"}(l.BACK_MoveRoleState||(l.BACK_MoveRoleState={})),function(t){t[t.playing=0]="playing",t[t.pause=1]="pause"}(l.BACK_GameState||(l.BACK_GameState={})),function(t){t[t._Null=0]="_Null",t[t.Role_1=1]="Role_1",t[t.Role_3=3]="Role_3",t[t.Role_4=4]="Role_4",t[t.Role_5=5]="Role_5",t[t.Role_6=6]="Role_6",t[t.Role_7=7]="Role_7",t[t.Role_8=8]="Role_8",t[t.Role_10=10]="Role_10",t[t.Role_11=11]="Role_11",t[t.Role_17=17]="Role_17"}(l.BACK_RoleType||(l.BACK_RoleType={})),l.BACK_RoleAsePath={1:{path:"soilder_3/soilder_3",ID:1,bullet:"hero1_bullet1"},3:{path:"djdh_3/djdh_3",ID:3,bullet:"hero3_bullet1"},4:{path:"djdh_4/djdh_4",ID:4,bullet:"hero4_bullet1"},5:{path:"djdh_5/djdh_5",ID:5,bullet:"hero16_bullet1"},6:{path:"djdh_6/djdh_6",ID:6,bullet:"hero6_bullet1"},7:{path:"soilder_4/soilder_4",ID:7,bullet:"hero7_bullet1"},8:{path:"djdh_8/djdh_8",ID:8,bullet:"hero8_bullet1"},10:{path:"djdh_10/djdh_10",ID:10,bullet:"hero6_bullet1"},11:{path:"soilder_1/soilder_1",ID:11,bullet:"hero11_bullet1"},17:{path:"djdh_17/djdh_17",ID:17,bullet:"hero17_bullet1"}},cc._RF.pop(),cc._RF.pop()},{}],BACK_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a55feTQ3IlPcLQujjQAEfnz","BACK_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"a55feTQ3IlPcLQujjQAEfnz","BACK_DataMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.getData=function(){return this.data},t.prototype.loadCfg=function(t){var e=this;r.ResourceMgr.getInstance().loadRes("BACK_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getCfgByPrimaryKey2=function(t,e,o,i,n){if(t)for(var a=0;a<t.length;a++)if(t[a][i]==e&&t[a][n]==o)return t[a];return null},t.prototype.getParameterCfg=function(t){return this.data.GearParameterCfg[t].value},t.prototype.getEnemyInfo1=function(t){return this.getCfgByPrimaryKey(this.data.HealthyCfg1,t,"level")},t.prototype.getEnemyInfo2=function(t){return this.getCfgByPrimaryKey(this.data.HealthyCfg2,t,"level")},t.prototype.getRoleInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.CharacterNum,t,e,"level","CharacterID")},t.prototype.getSkillsCfg=function(t){return this.getCfgByPrimaryKey(this.data.mateCfg,t,"mateID")},t.prototype.getEnemyExp=function(t){return this.getCfgByPrimaryKey(this.data.monsterID,t,"ID")},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],BACK_EffDie:[function(t,e,o){"use strict";cc._RF.push(e,"6e564ocvuBEc6N7DBIL5jWX","BACK_EffDie");var i=t,n=e,a=o;cc._RF.push(n,"6e564ocvuBEc6N7DBIL5jWX","BACK_EffDie");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BACK_Config"),p=i("BACK_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==l.BACK_AnimName.animation&&p.default.getInstance().PushObj(t.node)})},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BACK_Enemy:[function(t,e,o){"use strict";cc._RF.push(e,"fd7cbPqC8pAP5l/FltamOxW","BACK_Enemy");var i=t,n=e,a=o;cc._RF.push(n,"fd7cbPqC8pAP5l/FltamOxW","BACK_Enemy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("AudioMgr"),u=i("BACK_APP2"),d=i("BACK_Config"),h=i("BACK_DataMgr"),f=i("BACK_GameEnumData"),m=i("BACK_GameManager"),g=i("BACK_PoolMgr"),y=i("BACK_RoleBase"),v=cc._decorator,_=v.ccclass,b=v.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.die=2]="die"}(l||(l={}));var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemyType=0,e.hpBG=null,e.hpBar=null,e.boxCol=null,e.enemyState=null,e.isDie=!1,e.moveSpeed=70,e.moveSpeedPro=100,e.maxHp=10,e.nowHp=0,e.exp=0,e.immune=!1,e.immuneTime=0,e.isSkillsStasis=!1,e.skillsStasisTime=0,e.speedY={speed:10},e.maxY=Number.MAX_SAFE_INTEGER,e.isCut=!1,e.nowNobePos=cc.v2(),e.isTest=!1,e.harmEffFew=0,e}return s(e,t),e.prototype.start=function(){this.moveSpeed=h.default.getInstance().getParameterCfg(f.BACK_enumGearParameterCfg.EnemySpeed)[this.enemyType-1],this.moveSpeedPro=this.moveSpeed*h.default.getInstance().getParameterCfg(f.BACK_enumGearParameterCfg.EnemySpeedPro),this.exp=h.default.getInstance().getEnemyExp(this.enemyType).experience,this.getAtkAnimSpeed(),this.setSpAnimPlaySpeed(),this.addEvent(d.BACK_EventName.PlaySkillsAtk,this.playSkillsAtk)},e.prototype.init=function(t){switch(this.hpBG.active=!1,this.hpBar.progress=1,this.isDie=!1,this.enemyState=l.move,this.spAnim.paused=!1,this.spAnim.setAnimation(0,d.BACK_AnimName.move,!0),this.harmEffFew=0,this.immune=!0,this.immuneTime=0,this.spAnim.node.color=cc.Color.WHITE,this.isSkillsStasis=!1,this.speedY.speed=.2*this.moveSpeed,this.maxY=this.node.y+50,this.isCut=!1,this.enemyType){case 1:u.default.instance.isLevel2?(this.maxHp=h.default.getInstance().getEnemyInfo2(t).ZombieHp,this.atkForce=h.default.getInstance().getEnemyInfo2(t).ZombieAtk):(this.maxHp=h.default.getInstance().getEnemyInfo1(t).ZombieHp,this.atkForce=h.default.getInstance().getEnemyInfo1(t).ZombieAtk);break;case 2:u.default.instance.isLevel2?(this.maxHp=h.default.getInstance().getEnemyInfo2(t).MiniBossHp,this.atkForce=h.default.getInstance().getEnemyInfo2(t).MiniBossAtk):(this.maxHp=h.default.getInstance().getEnemyInfo1(t).MiniBossHp,this.atkForce=h.default.getInstance().getEnemyInfo1(t).MiniBossAtk);break;case 3:u.default.instance.isLevel2?(this.maxHp=h.default.getInstance().getEnemyInfo2(t).OilHp,this.atkForce=h.default.getInstance().getEnemyInfo2(t).OilAtk):(this.maxHp=h.default.getInstance().getEnemyInfo1(t).OilHp,this.atkForce=h.default.getInstance().getEnemyInfo1(t).OilAtk);break;case 4:u.default.instance.isLevel2?(this.maxHp=h.default.getInstance().getEnemyInfo2(t).BallHP,this.atkForce=h.default.getInstance().getEnemyInfo2(t).BallAtk):(this.maxHp=h.default.getInstance().getEnemyInfo1(t).BallHP,this.atkForce=h.default.getInstance().getEnemyInfo1(t).BallAtk)}this.maxHp=m.default.Instance.round(this.maxHp),this.nowHp=this.maxHp},e.prototype.update=function(t){if(m.default.Instance.gameState!=d.BACK_GameState.pause&&!this.getIsDie()){if(this.immune&&(this.immuneTime+=t,this.immuneTime>.2&&(this.immune=!1)),this.isSkillsStasis)return this.skillsStasisTime+=t,void(this.skillsStasisTime>3&&(this.skillsStasisTime=0,this.isSkillsStasis=!1,this.setGameState(d.BACK_GameState.playing)));var e=this.boxCol.getBoundingBoxToWorld(),o=m.default.Instance.yunBoxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(e,o)?this.enemyState!=l.attack&&(this.enemyState=l.attack,this.spAnim.setAnimation(0,d.BACK_AnimName.attack,!1)):this.enemyState!=l.move&&(this.enemyState=l.move,this.spAnim.setAnimation(0,d.BACK_AnimName.move,!0)),this.enemyState==l.move){this.nowNobePos=this.node.getPosition();var i=m.default.Instance.isColStone?this.moveSpeedPro:this.moveSpeed;this.node.setPosition(this.nowNobePos.x+i*t,this.nowNobePos.y+this.speedY.speed*t),this.node.y>this.maxY&&!this.isCut&&this.node.x>-190&&(this.isCut=!0,cc.tween(this.speedY).to(5,{speed:-this.speedY.speed}).start())}else this.enemyState==l.attack&&(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,d.BACK_AnimName.attack,!1)))}},e.prototype.attack=function(){var t=Math.floor(this.atkForce);m.default.Instance.attackEd(t)},e.prototype.setGameState=function(t){if(!this.isSkillsStasis)switch(t){case d.BACK_GameState.pause:this.spAnim.paused=!0;break;case d.BACK_GameState.playing:this.spAnim.paused=!1}},e.prototype.playSkillsAtk=function(t,e){m.default.Instance.gameState!=d.BACK_GameState.pause&&(this.getIsDie()||(3==t&&(this.setGameState(d.BACK_GameState.pause),this.skillsStasisTime=0,this.isSkillsStasis=!0,this.isTest=!0),this.attackEd(e,!1)))},e.prototype.attackEd=function(t,e){var o=this;m.default.Instance.gameState!=d.BACK_GameState.pause&&(this.getIsDie()||this.immune||(p.AudioMgr.getInstance().playEffectFree(d.BACK_AudioId.dragonHit),this.nowHp-=t,this.harmEffFew<3&&(this.harmEffFew++,setTimeout(function(){o.harmEffFew--},110),m.default.Instance.playHarmEff(this.node,this.harmEffFew,t,e)),cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.2,{color:cc.Color.WHITE}).start(),this.hpBG.active||(this.hpBG.active=!0),this.updeteHpBar(),this.nowHp<1&&(this.isDie=!0,this.enemyState=l.die,this.die())))},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.getIsDie=function(){return this.isDie||this.nowHp<1},e.prototype.die=function(){cc.Tween.stopAllByTarget(this.speedY),this.maxY=Number.MAX_SAFE_INTEGER,m.default.Instance.addDropExp(this.exp),m.default.Instance.playDieEff(this.node),m.default.Instance.removeEnemyList(this.node),g.default.getInstance().PushObj(this.node)},c([b(cc.Integer)],e.prototype,"enemyType",void 0),c([b(cc.Node)],e.prototype,"hpBG",void 0),c([b(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([b(cc.Node)],e.prototype,"boxCol",void 0),c([_],e)}(y.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],BACK_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"e27a3b4NBBHYZFQ7LY53Gnn","BACK_GameData");var i=e,n=o;cc._RF.push(i,"e27a3b4NBBHYZFQ7LY53Gnn","BACK_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emBACK_GameDataKeys=void 0,function(t){t.mateCfg="mateCfg",t.GearParameterCfg="GearParameterCfg",t.BoxCfg="BoxCfg",t.waveCfg1="waveCfg1",t.waveCfg2="waveCfg2",t.HealthyCfg1="HealthyCfg1",t.HealthyCfg2="HealthyCfg2",t.monsterID="monsterID",t.CharacterCfg="CharacterCfg",t.CharacterNum="CharacterNum"}(n.emBACK_GameDataKeys||(n.emBACK_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],BACK_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"dbb73kDs/ZJL6x8fz+QeHEt","BACK_GameEnumData");var i=e,n=o;cc._RF.push(i,"dbb73kDs/ZJL6x8fz+QeHEt","BACK_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.BACK_enumGearParameterCfg=void 0,function(t){t[t.CloudHP=1]="CloudHP",t[t.ShopNum=2]="ShopNum",t[t.CloundAtk=3]="CloundAtk",t[t.EnemySpeed=4]="EnemySpeed",t[t.EnemySpeedPro=5]="EnemySpeedPro",t[t.duanyuAtkSpeed=6]="duanyuAtkSpeed",t[t.BoxNumber=7]="BoxNumber",t[t.ProWeight=8]="ProWeight",t[t.BoxHate=9]="BoxHate"}(n.BACK_enumGearParameterCfg||(n.BACK_enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],BACK_GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"541e6wiUBJA47o2t67WpJFY","BACK_GameManager");var i=t,n=e,a=o;cc._RF.push(n,"541e6wiUBJA47o2t67WpJFY","BACK_GameManager");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("BACK_APP2"),h=i("BACK_Config"),f=i("BACK_DataMgr"),m=i("BACK_GameEnumData"),g=i("BACK_Sphere"),y=i("BACK_HarmEff"),v=i("BACK_Skills"),_=i("BACK_StoneMap"),b=i("BACK_YunSpAnim"),B=i("BACK_PoolMgr"),I=i("BACK_Enemy"),P=i("BACK_RoleBox"),C=i("BACK_RoleField"),D=cc._decorator,T=D.ccclass,S=D.property,A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameTopUI=null,e.boxMatrix=null,e.boxMatrixArray=[],e.roleBoxSpare=null,e.roleBoxSpareAll=[],e.roleBoxField=null,e.roleBoxFieldAll=[],e.useRoleFieldBoxInfo=new Map,e.sceneAllRoleBoxs=[],e.roleOursideBase=null,e.roleRoot1=null,e.roleRoot2=null,e.rolePosBase1=null,e.rolePosBase2=null,e.yunBoxCol=null,e.moveNode=null,e.btn_PlayGo=null,e.yunSpAnim1=null,e.yunSpAnim2=null,e.fieldRoles=new Map,e.enemyBase=null,e.birthEnemyPos=null,e.roleBulletBase=null,e.harmEffBase=null,e.skillsBase=null,e.bithStonePos=null,e.sphere=null,e.skillRolePos=null,e.stoneAtk=null,e.isAtkStone=!1,e.isColStone=!1,e.gameState=null,e.isfight=!1,e.mapLevel=0,e.pitchRoleBox=null,e.nowMaxWave=0,e.nowminWave=0,e.outWaveTime=0,e.waveInterval=0,e.isCanWave=!1,e.enemyTypeNum={},e.outEnemyInterval=.2,e.outEnemyTime=0,e.enemyAllArray=[],e.isWaveOver=!1,e.isWaveGameOver=!1,e.waveOverSumUI=0,e.waveOverNum=0,e.spareRoleBoxNumScope=3,e.isYesWaveOver=!1,e.txtAtk=null,e.hpBar=null,e.txtHp=null,e.maxHp=0,e.nowHp=0,e.secondAtkIcon=null,e.hpTxtIcon=null,e.roleBulletSpriteFrame=[],e.roleBulletCfg={},e.harmCritical=[],e.harmOrdinary=[],e.dropBoxIcon=null,e.dropBoxBar=null,e.btn_OpenDrop=null,e.txtOpenDrop=null,e.dropLevelIcon=null,e.dropLevel=0,e.dropUpLevelExp=0,e.dropNowExp=0,e.dropExpAll=0,e.dropBoxWeightCfg=[],e.dropBoxMaxEff=null,e.outEnemyNum=0,e.lastNowHp=100,e.color_Green=cc.color().fromHEX("#08f61b"),e.color_Red=cc.color().fromHEX("#f85454"),e.lastAllAtk=0,e.nearestBoxs=[],e.solderGainIDs=[],e.activateSkills=[],e.mateCfgs=[],e.mateKeyNum=[],e.activateSkillAtks=[],e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this)},e.prototype.start=function(){for(var t=0,e=this.boxMatrix.children;t<e.length;t++){var o=e[t];this.boxMatrixArray.push(o)}for(var i=0,n=this.roleBulletSpriteFrame;i<n.length;i++){var a=n[i];this.roleBulletCfg[a.name]=a}this.btn_PlayGo.on(cc.Node.EventType.TOUCH_END,this.playGame,this),d.default.instance.isLevel2&&(this.btn_OpenDrop.on(cc.Node.EventType.TOUCH_END,this.openDropBox,this),this.dropBoxIcon.node.on(cc.Node.EventType.TOUCH_END,this.openDropBox,this),this.dropBoxMaxEff.node.active=!1,this.dropLevelIcon.node.active=!1),this.initData(),this.updateRoleBoxSpare(),this.setEnemyMoveX(),this.setGameState(h.BACK_GameState.playing)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.upMaxLevelDropBoxId),o.Instance=null},e.prototype.initData=function(){this.characterCfg=f.default.getInstance().data.CharacterCfg,d.default.instance.isLevel2?(this.waveCfg=f.default.getInstance().data.waveCfg2,this.dropUpLevelExp=f.default.getInstance().getParameterCfg(m.BACK_enumGearParameterCfg.BoxNumber)[this.dropLevel],this.dropBoxWeightCfg=f.default.getInstance().data.BoxCfg):this.waveCfg=f.default.getInstance().data.waveCfg1,this.mateCfgs=f.default.getInstance().data.mateCfg,this.spareRoleBoxNumScope=f.default.getInstance().getParameterCfg(m.BACK_enumGearParameterCfg.ShopNum),this.maxHp=f.default.getInstance().getParameterCfg(m.BACK_enumGearParameterCfg.CloudHP),this.nowHp=this.maxHp,this.updeteHpBar()},e.prototype.setGameState=function(t){this.gameState=t,this.sendEvent(h.BACK_EventName.SetGameState,this.gameState)},e.prototype.playGame=function(){if(!this.isfight)if(0!=this.rolePosBase1.childrenCount){if(null!=this.pitchRoleBox){for(var t=0,e=this.nearestBoxs;t<e.length;t++){var o=e[t];cc.Tween.stopAllByTarget(o),o.color=cc.Color.WHITE}var i=this.sceneAllRoleBoxs.indexOf(this.pitchRoleBox.getComponent(P.default));this.sceneAllRoleBoxs.splice(i,1),this.sendEvent(h.BACK_EventName.UpdateAllBoxAccord,this.sceneAllRoleBoxs),this.downFieldRole(this.pitchRoleBox.getComponent(P.default)),this.pitchRoleBox.destroy(),this.pitchRoleBox=null}var n=this.moveNode.position.clone();n.y-=600,cc.Tween.stopAllByTarget(this.moveNode),cc.tween(this.moveNode).to(.25,{position:n}).start(),this.isfight=!0,this.updateEnemyMaxWave(),this.sendEvent(h.BACK_EventName.PlayGame),p.AudioMgr.getInstance().playEffectFree(h.BACK_AudioId.kaishi)}else this.sendEvent(h.BACK_EventName.PlayTips,"\u8bf7\u5148\u4e0a\u9635\u89d2\u8272")},e.prototype.waveOver=function(){var t=this.moveNode.position.clone();t.y+=600,cc.Tween.stopAllByTarget(this.moveNode),cc.tween(this.moveNode).to(.25,{position:t}).start(),this.isfight=!1,this.updateRoleBoxSpare(),this.sendEvent(h.BACK_EventName.UpdateWaveUI,this.nowMaxWave+1),this.sendEvent(h.BACK_EventName.UpdateWaveBarUI,0,10),this.sendEvent(h.BACK_EventName.WaveOver)},e.prototype.update=function(t){if(this.gameState!=h.BACK_GameState.pause&&this.isfight)if(!this.isWaveOver&&this.isCanWave)this.outWaveTime+=t,this.outWaveTime>this.waveInterval&&(this.nowminWave++,this.updateEnemyMinWave());else if(this.outEnemyTime+=t,this.outEnemyTime>this.outEnemyInterval){this.outEnemyTime=0;var e=Object.keys(this.enemyTypeNum);if(0===e.length)return void(this.isCanWave=!0);this.isCanWave=!1;var o=Number(e[Math.floor(Math.random()*e.length)]);this.enemyTypeNum[o],this.outEnemy(o),this.enemyTypeNum[o]-=1,0==this.enemyTypeNum[o]&&delete this.enemyTypeNum[o],0===Object.keys(this.enemyTypeNum).length?this.isCanWave=!0:this.isCanWave=!1}},e.prototype.updateEnemyMaxWave=function(){this.isYesWaveOver=!1,this.nowMaxWave++,this.nowMaxMonsterInfo=[],this.outEnemyNum=0,this.waveOverNum=0;for(var t=0;t<this.waveCfg.length;t++)this.waveCfg[t].id==this.nowMaxWave&&(this.nowMaxMonsterInfo.push(this.waveCfg[t]),this.waveOverNum+=this.waveCfg[t].MonsterSum,t==this.waveCfg.length-1&&(this.isWaveGameOver=!0));this.waveOverSumUI=this.waveOverNum,this.nowminWave=0,this.updateEnemyMinWave(),this.isWaveOver=!1},e.prototype.updateEnemyMinWave=function(){this.enemyTypeNum=[],this.outWaveTime=0,this.waveInterval=this.nowMaxMonsterInfo[this.nowminWave].FirstInterval;for(var t=this.nowMaxMonsterInfo[this.nowminWave].MonsterSum,e=0;e<this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++){var o=this.nowMaxMonsterInfo[this.nowminWave].Monster[e][0];this.enemyTypeNum[o]=1}for(e=0;e<t-this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++)this.addOutEnemyQueue(this.nowMaxMonsterInfo[this.nowminWave].Monster);var i;1==this.nowMaxMonsterInfo[this.nowminWave].stone&&(i=d.default.instance.isLevel2?f.default.getInstance().getEnemyInfo2(this.nowMaxWave).StoneHP:f.default.getInstance().getEnemyInfo1(this.nowMaxWave).StoneHP,this.outStoneMap(i)),this.nowminWave==this.nowMaxMonsterInfo.length-1&&(this.isWaveOver=!0),this.isCanWave=!1},e.prototype.addOutEnemyQueue=function(t){var e=this.random(0,t.length,!0),o=t[e][0];this.enemyTypeNum[o]==t[e][1]?this.addOutEnemyQueue(t):this.enemyTypeNum[o]+=1},e.prototype.outEnemy=function(t){var e=this,o="enemy/enemy_"+t;B.default.getInstance().getObj(o,function(t){t.setParent(e.enemyBase);var o=e.birthEnemyPos.position.clone();o.y+=e.random(-65,55),t.setPosition(o),t.getComponent(I.default).init(e.nowMaxWave),e.addEnemyList(t),e.outEnemyNum++})},e.prototype.addEnemyList=function(t){this.enemyAllArray.push(t),this.tierEnemyList()},e.prototype.removeEnemyList=function(t){var e=this.enemyAllArray.indexOf(t);if(this.enemyAllArray.splice(e,1),this.waveOverNum--,this.sendEvent(h.BACK_EventName.UpdateWaveBarUI,this.waveOverSumUI-this.waveOverNum,this.waveOverSumUI),0==this.waveOverNum){if(this.isYesWaveOver=!0,this.isColStone)return;this.isWaveGameOver?(this.setGameState(h.BACK_GameState.pause),u.UIMgr.getInstance().openUI(h.BACK_UIID.BACK_UIGameOver,1,!0)):this.waveOver()}},e.prototype.tierEnemyList=function(){var t=this.enemyAllArray;t.sort(function(t,e){return e.y-t.y}),t.forEach(function(t,e){t.setSiblingIndex(e)})},e.prototype.getEnemyNear=function(t){for(var e=t.parent.convertToWorldSpaceAR(t.getPosition()).x,o=null,i=Number.POSITIVE_INFINITY,n=0,a=this.enemyAllArray;n<a.length;n++){var r=a[n];if(r.active){var s=r.parent.convertToWorldSpaceAR(r.getPosition()),c=Math.abs(s.x-e);s.x>35&&c<i&&(i=c,o=r)}}return o},e.prototype.getCollisionBullet=function(t){for(var e=t.boxCol.getBoundingBoxToWorld(),o=0,i=this.enemyAllArray;o<i.length;o++){var n=i[o],a=n.getComponent(I.default).boxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(e,a))return n}return null},e.prototype.getBulletImg=function(t){return this.roleBulletCfg[t]},e.prototype.outStoneMap=function(t){var e=this;this.loadPrefab(h.BACK_BundleName.Prefabs,"enemy/stoneMap",function(o){var i=cc.instantiate(o);i.setParent(e.bithStonePos),i.setPosition(cc.v3()),i.angle=-25;var n=e.getWorldAngle(i),a=e.getWorldAngle(e.sphere.node),r=i.parent.convertToWorldSpaceAR(i.position);i.setParent(e.sphere.node),i.angle=n-a,i.setPosition(e.sphere.node.convertToNodeSpaceAR(r)),i.getComponent(_.default).init(t),e.stoneAtk=i})},e.prototype.getWorldAngle=function(t){var e=new cc.Mat4;t.getWorldMatrix(e);var o=e.m[0],i=e.m[1];return Math.atan2(i,o)*(180/Math.PI)},e.prototype.setIsColStone=function(t){var e=this;if(this.sendEvent(h.BACK_EventName.IsAtkStone,t),this.isAtkStone=t,t){var o=cc.v3(-130,0);cc.Tween.stopAllByTarget(this.roleOursideBase),cc.tween(this.roleOursideBase).to(1.3,{position:o}).call(function(){e.isColStone=!0}).start(),cc.Tween.stopAllByTarget(this.roleRoot1),cc.tween(this.roleRoot1).to(1.3,{angle:0}).start(),cc.Tween.stopAllByTarget(this.roleRoot2),cc.tween(this.roleRoot2).to(1.3,{angle:0}).start()}else this.stoneAtk=null,this.isColStone=!1,this.yunSpAnim1.playAnim(h.BACK_AnimName.idle),cc.Tween.stopAllByTarget(this.roleOursideBase),cc.tween(this.roleOursideBase).to(1.3,{position:cc.v3()}).start(),cc.Tween.stopAllByTarget(this.roleRoot1),cc.tween(this.roleRoot1).to(1.3,{angle:-7}).start(),cc.Tween.stopAllByTarget(this.roleRoot2),cc.tween(this.roleRoot2).to(1.3,{angle:-7}).start(),this.isYesWaveOver&&(this.isWaveGameOver?(this.setGameState(h.BACK_GameState.pause),u.UIMgr.getInstance().openUI(h.BACK_UIID.BACK_UIGameOver,1,!0)):this.waveOver())},e.prototype.playSkillsRole=function(){var t=this,e=0,o=100,i=1;this.fieldRoles.forEach(function(t){7==t.skillID&&t.level>e&&(t.roleID,e=t.level,o=t.atkForce,i=t.mateRate)}),this.loadPrefab(h.BACK_BundleName.Prefabs,"role/roleFieldSkill",function(e){var n=cc.instantiate(e);n.setParent(t.skillRolePos);var a=t.round(i*o);n.getComponent(C.default).summonSkill(a)})},e.prototype.playSkillsAtk=function(t){var e=this,o=0,i=100,n=1;this.fieldRoles.forEach(function(e){e.skillID==t&&e.level>o&&(e.roleID,o=e.level,i=e.atkForce,n=e.mateRate)});var a="skills/skill_"+t;this.loadPrefab(h.BACK_BundleName.Prefabs,a,function(o){var a=cc.instantiate(o);a.setParent(e.skillsBase),a.setPosition(cc.v3());var r=e.round(n*i);a.getComponent(v.default).init(r,t)})},e.prototype.attackEd=function(t){this.gameState!=h.BACK_GameState.pause&&(this.nowHp-=t,this.updeteHpBar(),this.nowHp<1&&(u.UIMgr.getInstance().openUI(h.BACK_UIID.BACK_UIGameOver,1,!1),this.setGameState(h.BACK_GameState.pause),p.AudioMgr.getInstance().playEffectFree(h.BACK_AudioId.shibai)))},e.prototype.updeteHpBar=function(){var t=this;this.txtHp.string=""+this.nowHp,this.lastNowHp!=this.nowHp&&(this.txtHp.node.color=this.nowHp>this.lastNowHp?this.color_Green:this.color_Red,cc.Tween.stopAllByTarget(this.hpTxtIcon),cc.tween(this.hpTxtIcon).to(.1,{scale:1.6}).to(.1,{scale:1.2}).call(function(){t.txtHp.node.color=cc.Color.WHITE}).start()),this.lastNowHp=this.nowHp;var e=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.15,{progress:e}).start()},e.prototype.updeteProperty=function(){var t=this,e=this.nowHp/this.maxHp;this.maxHp=f.default.getInstance().getParameterCfg(m.BACK_enumGearParameterCfg.CloudHP);var o=0;this.fieldRoles.forEach(function(e){t.maxHp+=e.hp,o+=e.secondAtk}),this.maxHp=this.round(this.maxHp),this.nowHp=this.round(this.maxHp*e),o=this.round(o),this.txtAtk.string=""+o,this.lastAllAtk!=o&&(this.txtAtk.node.color=o>this.lastAllAtk?this.color_Green:this.color_Red,cc.Tween.stopAllByTarget(this.secondAtkIcon),cc.tween(this.secondAtkIcon).to(.1,{scale:1.6}).to(.1,{scale:1.2}).call(function(){t.txtAtk.node.color=cc.Color.WHITE}).start()),this.lastAllAtk=o,this.updeteHpBar()},e.prototype.addDropExp=function(t){var e=this;if(d.default.instance.isLevel2)if(this.dropNowExp+=t,this.dropExpAll+=t,this.dropNowExp>=this.dropUpLevelExp&&this.dropLevel<4){var o=this.dropNowExp-this.dropUpLevelExp;this.dropLevel++,this.dropNowExp=o,this.txtOpenDrop.string="\u5f00\u542f"+this.dropLevel+"\u7ea7\u5b9d\u7bb1";var i=this.dropNowExp/this.dropUpLevelExp;this.dropBoxBar.progress=0,clearInterval(this.upMaxLevelDropBoxId),this.upMaxLevelDropBoxId=null,cc.Tween.stopAllByTarget(this.dropBoxIcon.node),cc.tween(this.dropBoxIcon.node).to(.5,{scale:1.4}).to(.5,{scale:1.2}).start(),this.upMaxLevelDropBoxId=setInterval(function(){cc.Tween.stopAllByTarget(e.dropBoxIcon.node),cc.tween(e.dropBoxIcon.node).to(.5,{scale:1.4}).to(.5,{scale:1.2}).start()},1e3),this.loadSpriteFrame(h.BACK_BundleName.Sprite,"dropBoxIcon/box_0"+this.dropLevel,function(t){e.dropBoxIcon.spriteFrame=t});var n="";this.dropLevel<4?(n="roleLevelIcon/jb_0"+this.dropLevel,this.dropUpLevelExp=f.default.getInstance().getParameterCfg(m.BACK_enumGearParameterCfg.BoxNumber)[this.dropLevel]):(n="roleLevelIcon/max",i=1),this.dropLevelIcon.node.active=!0,this.loadSpriteFrame(h.BACK_BundleName.Sprite,n,function(t){e.dropLevelIcon.spriteFrame=t}),this.playUpLevelEff(this.dropBoxIcon.node.parent),cc.Tween.stopAllByTarget(this.dropBoxBar),cc.tween(this.dropBoxBar).to(.1,{progress:i}).start()}else{if(4==this.dropLevel)return;i=this.dropNowExp/this.dropUpLevelExp,cc.Tween.stopAllByTarget(this.dropBoxBar),cc.tween(this.dropBoxBar).to(.1,{progress:i}).start()}},e.prototype.openDropBox=function(){var t=this;if(this.dropLevel>0&&!this.isfight){p.AudioMgr.getInstance().playEffectFree(h.BACK_AudioId.shengji),this.random(1,3,!0);var e=this.randomDropBoxRole(1,this.dropLevel);this.dropExpAll,this.dropLevelIcon.node.active=!1;for(var o=f.default.getInstance().getParameterCfg(m.BACK_enumGearParameterCfg.BoxNumber),i=0;i<o.length;i++)i<this.dropLevel&&o[i];this.dropExpAll=0,this.dropNowExp=this.dropExpAll,this.dropLevel=0,this.dropBoxBar.progress=0,this.dropUpLevelExp=f.default.getInstance().getParameterCfg(m.BACK_enumGearParameterCfg.BoxNumber)[this.dropLevel],this.loadSpriteFrame(h.BACK_BundleName.Sprite,"dropBoxIcon/box_0"+this.dropLevel,function(e){t.dropBoxIcon.spriteFrame=e}),clearInterval(this.upMaxLevelDropBoxId),this.upMaxLevelDropBoxId=null,cc.Tween.stopAllByTarget(this.dropBoxIcon.node),this.dropBoxIcon.node.setScale(1.3),this.addDropExp(0);for(var n=function(e){var o="roleBox/roleBox_"+e.CharacterID,i=a.dropBoxIcon.node.convertToWorldSpaceAR(cc.v2(0,0));a.loadPrefab(h.BACK_BundleName.Prefabs,o,function(o){var n=cc.instantiate(o);n.setParent(t.roleBoxSpare);var a=n.parent.convertToNodeSpaceAR(i);n.setPosition(a),n.getComponent(P.default).init(e.grade),t.roleBoxSpareAll.push(n),t.sceneAllRoleBoxs.push(n.getComponent(P.default)),t.calculateLayout(-1,!0),t.sendEvent(h.BACK_EventName.UpdateAllBoxAccord,t.sceneAllRoleBoxs)})},a=this,r=0,s=e;r<s.length;r++)n(s[r])}},e.prototype.randomDropBoxRole=function(t,e){for(var o=[],i=[],n=0,a=this.dropBoxWeightCfg;n<a.length;n++)(p=a[n]).BoxLevel==e&&p.weight>0&&o.push(p);for(var r=[],s=0,c=0,l=o;c<l.length;c++){var p;s+=(p=l[c]).weight,r.push(s)}for(var u=s,d=0;d<t;d++)for(var h=Math.random()*u,f=0;f<r.length;f++)if(h<r[f]){i.push(o[f]);break}return i},e.prototype.updateRoleBoxSpare=function(){for(var t=this,e=0,o=this.roleBoxSpareAll;e<o.length;e++){var i=o[e],n=this.sceneAllRoleBoxs.indexOf(i.getComponent(P.default));this.sceneAllRoleBoxs.splice(n,1)}this.roleBoxSpare.removeAllChildren(),this.roleBoxSpareAll=[];for(var a=0,r=this.randomRoles(this.spareRoleBoxNumScope),s=function(e){var o="roleBox/roleBox_"+e.CharacterID;c.loadPrefab(h.BACK_BundleName.Prefabs,o,function(o){var i=cc.instantiate(o);i.setParent(t.roleBoxSpare),i.getComponent(P.default).init(e.grade),t.roleBoxSpareAll.push(i),t.sceneAllRoleBoxs.push(i.getComponent(P.default)),++a==t.spareRoleBoxNumScope&&(t.calculateLayout(-1,!0),t.sendEvent(h.BACK_EventName.UpdateAllBoxAccord,t.sceneAllRoleBoxs))})},c=this,l=0,p=r;l<p.length;l++)s(p[l])},e.prototype.randomRoles=function(t){var e=JSON.parse(JSON.stringify(this.characterCfg));if(d.default.instance.isLevel2&&this.nowMaxWave>=10)for(var o=0,i=e;o<i.length;o++)(p=i[o]).weight+=p.weightUp;for(var n=e.filter(function(t){return t.weight>0}),a=[],r=[],s=0,c=0,l=n;c<l.length;c++){var p;s+=(p=l[c]).weight,r.push(s)}for(var u=s,h=0;h<t;h++)for(var f=Math.random()*u,m=0;m<r.length;m++)if(f<r[m]){a.push(n[m]);break}return a},e.prototype.moveRoleBox=function(t,e){if(t!=h.BACK_MoveRoleState.TouchStart){this.nearestBoxs=[];for(var o=0,i=this.boxMatrixArray;o<i.length;o++)i[o].color=cc.Color.WHITE;for(var n=0,a=e.boxPosArray;n<a.length;n++){for(var r=a[n],s=null,c=Number.MAX_SAFE_INTEGER,l=this.getWorldPosV2(r),p=0,u=this.boxMatrixArray;p<u.length;p++){var d=u[p],f=cc.Vec2.distance(l,this.getWorldPosV2(d));f<c&&(c=f,s=d)}c<65&&!this.nearestBoxs.includes(s)&&this.nearestBoxs.push(s)}var m=this.nearestBoxs.length==e.boxPosArray.length;if(m)for(var g=0,y=this.nearestBoxs;g<y.length;g++){var v=y[g];if(this.useRoleFieldBoxInfo.has(v)){var _=this.useRoleFieldBoxInfo.get(v).getComponent(P.default);e.roleType==_.roleType&&e.level==_.level&&e.level<4||(m=!1)}else m=!1}for(var b=!1,B=function(t){I.useRoleFieldBoxInfo.forEach(function(e,o){o!=t||(b=!0)})},I=this,C=0,D=this.nearestBoxs;C<D.length;C++)B(v=D[C]);for(var T=this.nearestBoxs.length==e.boxPosArray.length,S=0,A=this.nearestBoxs;S<A.length;S++)(v=A[S]).color=m?cc.Color.GREEN:T?b?cc.Color.RED:cc.Color.GREEN:cc.Color.GRAY;t==h.BACK_MoveRoleState.TouchEnd&&this.endRoleBox(e)}else{if(this.setParentPos(e.node,this.gameTopUI),this.roleBoxSpareAll.includes(e.node)){var k=this.roleBoxSpareAll.indexOf(e.node);this.roleBoxSpareAll.splice(k,1),this.calculateLayout()}this.roleBoxFieldAll.includes(e.node)&&(k=this.roleBoxFieldAll.indexOf(e.node),this.roleBoxFieldAll.splice(k,1),this.removeRoleFieldBoxInfo(e.node))}},e.prototype.endRoleBox=function(t){for(var e=this,o=0,i=this.nearestBoxs;o<i.length;o++){var n=i[o];cc.Tween.stopAllByTarget(n),cc.tween(n).to(.15,{color:cc.Color.WHITE}).start()}if(!this.isUpRoleLevel(t,this.roleBoxFieldAll)&&!this.isUpRoleLevel(t,this.roleBoxSpareAll))if(this.nearestBoxs.length==t.boxPosArray.length){this.setParentPos(t.node,this.roleBoxField),this.roleBoxFieldAll.push(t.node),p.AudioMgr.getInstance().playEffectFree(h.BACK_AudioId.fangrugezi);var a=this.getWorldPosV3(this.nearestBoxs[0]),r=this.getWorldPosV3(t.boxPosArray[0]),s=a.subtract(r);t.upRoleMatrix(s);for(var c=[],l=0,u=this.nearestBoxs;l<u.length;l++){var d=u[l];this.useRoleFieldBoxInfo.has(d)&&(c.includes(this.useRoleFieldBoxInfo.get(d))||c.push(this.useRoleFieldBoxInfo.get(d)),this.useRoleFieldBoxInfo.delete(d)),this.useRoleFieldBoxInfo.set(d,t.node)}for(var f=this.getWorldPosV2(t.node),m=function(t){var o=t.getComponent(P.default);g.downFieldRole(o);var i=g.roleBoxFieldAll.indexOf(o.node);g.roleBoxFieldAll.splice(i,1),g.removeRoleFieldBoxInfo(t);var n=.8*(o.node.width+t.width)/2;g.getWorldPosV2(t).x<f.x&&(n=-n);var a=cc.v3(t.x+n,t.y+30);cc.Tween.stopAllByTarget(t),cc.tween(t).to(.15,{position:a}).call(function(){e.insertRoleBoxSpare(o)}).start()},g=this,y=0,v=c;y<v.length;y++)m(d=v[y]);this.upFieldRole(t)}else this.downFieldRole(t),this.insertRoleBoxSpare(t)},e.prototype.isUpRoleLevel=function(t,e){for(var o=this,i=this.getWorldPosV3(t.node),n=function(e){var n=a.getWorldPosV3(e),r=e.getComponent(P.default);if(cc.Vec2.distance(i,n)<47.8&&r.roleType==t.roleType&&r.level==t.level&&t.level<5&&r!=t){var s=t.node.parent.convertToNodeSpaceAR(n);return cc.Tween.stopAllByTarget(t.node),cc.tween(t.node).to(.15,{position:s}).call(function(){o.downFieldRole(t),r.upRoleLevel(),o.fieldRoles.has(r)&&(o.fieldRoles.get(r).upRoleLevel(),o.updeteProperty(),o.updateSolderID()),p.AudioMgr.getInstance().playEffectFree(h.BACK_AudioId.shengji),o.playUpLevelEff(e);var i=o.sceneAllRoleBoxs.indexOf(t);o.sceneAllRoleBoxs.splice(i,1),o.sendEvent(h.BACK_EventName.UpdateAllBoxAccord,o.sceneAllRoleBoxs),t.die()}).start(),{value:!0}}},a=this,r=0,s=e;r<s.length;r++){var c=n(s[r]);if("object"==typeof c)return c.value}return!1},e.prototype.removeRoleFieldBoxInfo=function(t){var e=[];this.useRoleFieldBoxInfo.forEach(function(o,i){o==t&&e.push(i)});for(var o=0,i=e;o<i.length;o++){var n=i[o];this.useRoleFieldBoxInfo.delete(n)}},e.prototype.insertRoleBoxSpare=function(t){this.setParentPos(t.node,this.roleBoxSpare);var e=this.findPosIndex(t.node);e<this.roleBoxSpare.childrenCount&&this.roleBoxSpare.insertChild(t.node,e),e>this.roleBoxSpareAll.length?this.roleBoxSpareAll.push(t.node):this.roleBoxSpareAll.splice(e,0,t.node),this.calculateLayout(e)},e.prototype.findPosIndex=function(t){if(0==this.roleBoxSpareAll.length)return 0;for(var e=0,o=Number.MAX_SAFE_INTEGER,i=this.getWorldPosV2(t),n=0;n<this.roleBoxSpareAll.length;n++){var a=cc.Vec2.distance(i,this.getWorldPosV2(this.roleBoxSpareAll[n]));a<o&&(o=a,e=n)}return this.getWorldPosV2(this.roleBoxSpareAll[e]).x>i.x?e:e+1},e.prototype.calculateLayout=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=this.roleBoxSpareAll;if(!(o.length<1)){var i=this.roleBoxSpare.width-20,n=o.reduce(function(t,e){return t+e.width},0),a=[];if(n<=i)for(var r=-i/2+(p=(i-n)/(o.length+1)),s=0,c=o;s<c.length;s++){var l=c[s];a.push(cc.v3(r+l.width/2,0)),r+=l.width+p}else for(var p=(i-n)/(o.length-1),u=(r=-i/2,0),d=o;u<d.length;u++)l=d[u],a.push(cc.v3(r+l.width/2,0)),r+=l.width+p;for(var h=0;h<o.length;h++){var f=h,m=o[f];cc.Tween.stopAllByTarget(m),t==f||e?cc.tween(m).to(.2,{position:a[f],angle:this.random(0,1)>.5?10:-10},{easing:"quadOut"}).start():cc.tween(m).to(.2,{position:a[f]},{easing:"quadOut"}).start()}}},e.prototype.upFieldRole=function(t){var e=this;this.fieldRoles.has(t)||B.default.getInstance().getObj("role/roleField",function(o){var i=o.getComponent(C.default);i.init(t.roleType,t.level),e.fieldRoles.set(t,i),e.rolePosBase1.childrenCount<4?(o.setParent(e.rolePosBase1),e.rolePosBase1.width=70*e.rolePosBase1.childrenCount,e.fieldRoleLayout(e.rolePosBase1),e.yunSpAnim1.updateYunSkin(),e.setEnemyMoveX()):(e.rolePosBase2.parent.active||(e.rolePosBase2.parent.active=!0),o.setParent(e.rolePosBase2),e.rolePosBase2.width=70*e.rolePosBase2.childrenCount,e.fieldRoleLayout(e.rolePosBase2),e.yunSpAnim2.updateYunSkin()),e.updeteProperty(),e.updateSolderID()})},e.prototype.fieldRoleLayout=function(t){for(var e=t.width,o=t.children,i=[],n=(e-o.reduce(function(t,e){return t+e.width},0))/(o.length-1),a=-e/2,r=0,s=o;r<s.length;r++){var c=s[r];i.push(cc.v3(a+c.width/2,-20)),a+=c.width+n}for(var l=0;l<o.length;l++){var p=l,u=o[p];cc.Tween.stopAllByTarget(u),cc.tween(u).to(.2,{position:i[p]},{easing:"quadOut"}).start()}},e.prototype.downFieldRole=function(t){if(this.fieldRoles.has(t)){var e=this.fieldRoles.get(t);this.fieldRoles.delete(t);var o=e.node.parent;this.setParentPos(e.node,e.node.parent.parent),e.node.setScale(1,1);var i=cc.v3(e.node.x+300,e.node.y);cc.Tween.stopAllByTarget(e.node),cc.tween(e.node).to(.3,{position:i}).call(function(){e.die()}).start();var n=this.fieldRoles.size;if(n<=4&&this.rolePosBase2.parent.active||n>4&&this.rolePosBase1.childrenCount<4){for(var a=0,r=this.rolePosBase2.children;a<r.length;a++){var s=r[a];if(4==this.rolePosBase1.childrenCount)break;this.setParentPos(s,this.rolePosBase1)}this.rolePosBase1.width=70*this.rolePosBase1.childrenCount,this.rolePosBase2.width=70*this.rolePosBase2.childrenCount,this.fieldRoleLayout(this.rolePosBase1),this.fieldRoleLayout(this.rolePosBase2)}else o.width=70*o.childrenCount,this.fieldRoleLayout(o);this.setEnemyMoveX(),this.yunSpAnim1.updateYunSkin(),this.yunSpAnim2.updateYunSkin(),0==this.rolePosBase2.childrenCount&&(this.rolePosBase2.parent.active=!1),this.updeteProperty(),this.updateSolderID()}},e.prototype.setEnemyMoveX=function(){var t=this.rolePosBase1.childrenCount;t<=2?this.yunBoxCol.width=160:3==t?this.yunBoxCol.width=205:4==t&&(this.yunBoxCol.width=260)},e.prototype.updateSolderID=function(){var t=this;this.activateSkillAtks=[],this.fieldRoles.forEach(function(e){(null==t.activateSkillAtks[e.skillID]||e.level>t.activateSkillAtks[e.skillID])&&(t.activateSkillAtks[e.skillID]=e.level)}),this.sendEvent(h.BACK_EventName.ActivateRoleSkills,this.activateSkillAtks)},e.prototype.getActivatedMateIDs=function(){var t=this;this.activateSkills=[];for(var e=function(e){for(var i=0,n=o.mateCfgs;i<n.length;i++){var a=n[i];o.activateSkills.includes(a.mateID)||a.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).includes(e)})&&a.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).every(function(e){return t.solderGainIDs.includes(e)})})&&o.activateSkills.push(a.mateID)}},o=this,i=0,n=this.solderGainIDs;i<n.length;i++)e(n[i]);this.sendEvent(h.BACK_EventName.ActivateSkills,this.activateSkills,this.mateKeyNum)},e.prototype.playUpLevelEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));B.default.getInstance().getObj("effAnim/roleUpLevelEff",function(t){t.setParent(e.gameTopUI);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playDieEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));B.default.getInstance().getObj("effAnim/dieEff",function(t){t.setParent(e.roleBulletBase);var i=t.parent.convertToNodeSpaceAR(o);i.y-=25,t.setPosition(i)})},e.prototype.playHarmEff=function(t,e,o,i){var n=this,a=t.convertToWorldSpaceAR(cc.v2(0,0));B.default.getInstance().getObj("effAnim/harmEff",function(t){t.setParent(n.harmEffBase);var r=t.parent.convertToNodeSpaceAR(a);r.x+=30*e,r.y+=30*e,n.harmEffBase.insertChild(t,0),t.setPosition(r),t.getComponent(y.default).init(o,i)})},e.prototype.getHarmIcon=function(t,e){return e?this.harmCritical[t]:this.harmOrdinary[t]},e.prototype.getWorldPosV2=function(t){return t.parent.convertToWorldSpaceAR(t.getPosition())},e.prototype.getWorldPosV3=function(t){return t.parent.convertToWorldSpaceAR(t.position)},e.prototype.setParentPos=function(t,e){var o=this.getWorldPosV3(t);t.setParent(e);var i=e.convertToNodeSpaceAR(o);t.setPosition(i)},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.Instance=null,c([S(cc.Node)],e.prototype,"gameTopUI",void 0),c([S(cc.Node)],e.prototype,"boxMatrix",void 0),c([S(cc.Node)],e.prototype,"roleBoxSpare",void 0),c([S(cc.Node)],e.prototype,"roleBoxField",void 0),c([S(cc.Node)],e.prototype,"roleOursideBase",void 0),c([S(cc.Node)],e.prototype,"roleRoot1",void 0),c([S(cc.Node)],e.prototype,"roleRoot2",void 0),c([S(cc.Node)],e.prototype,"rolePosBase1",void 0),c([S(cc.Node)],e.prototype,"rolePosBase2",void 0),c([S(cc.Node)],e.prototype,"yunBoxCol",void 0),c([S(cc.Node)],e.prototype,"moveNode",void 0),c([S(cc.Node)],e.prototype,"btn_PlayGo",void 0),c([S(b.default)],e.prototype,"yunSpAnim1",void 0),c([S(b.default)],e.prototype,"yunSpAnim2",void 0),c([S(cc.Node)],e.prototype,"enemyBase",void 0),c([S(cc.Node)],e.prototype,"birthEnemyPos",void 0),c([S(cc.Node)],e.prototype,"roleBulletBase",void 0),c([S(cc.Node)],e.prototype,"harmEffBase",void 0),c([S(cc.Node)],e.prototype,"skillsBase",void 0),c([S(cc.Node)],e.prototype,"bithStonePos",void 0),c([S(g.default)],e.prototype,"sphere",void 0),c([S(cc.Node)],e.prototype,"skillRolePos",void 0),c([S(cc.Label)],e.prototype,"txtAtk",void 0),c([S(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([S(cc.Label)],e.prototype,"txtHp",void 0),c([S(cc.Node)],e.prototype,"secondAtkIcon",void 0),c([S(cc.Node)],e.prototype,"hpTxtIcon",void 0),c([S(cc.SpriteFrame)],e.prototype,"roleBulletSpriteFrame",void 0),c([S(cc.SpriteFrame)],e.prototype,"harmCritical",void 0),c([S(cc.SpriteFrame)],e.prototype,"harmOrdinary",void 0),c([S(cc.Sprite)],e.prototype,"dropBoxIcon",void 0),c([S(cc.ProgressBar)],e.prototype,"dropBoxBar",void 0),c([S(cc.Node)],e.prototype,"btn_OpenDrop",void 0),c([S(cc.Label)],e.prototype,"txtOpenDrop",void 0),c([S(cc.Sprite)],e.prototype,"dropLevelIcon",void 0),c([S(sp.Skeleton)],e.prototype,"dropBoxMaxEff",void 0),o=c([T],e)}(l.default);a.default=A,cc._RF.pop(),cc._RF.pop()},{}],BACK_HarmEff:[function(t,e,o){"use strict";cc._RF.push(e,"dd2a8eOAEZBQJcF65euuEds","BACK_HarmEff");var i=t,n=e,a=o;cc._RF.push(n,"dd2a8eOAEZBQJcF65euuEds","BACK_HarmEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BACK_GameManager"),u=i("BACK_PoolMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ordinaryRoot=null,e.criticalRoot=null,e.critical=null,e.criticalIcon=null,e.ordinary=null,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.node.opacity=255;var i=t.toString().split("").map(Number);this.ordinaryRoot.removeAllChildren(),this.criticalRoot.removeAllChildren(),this.ordinaryRoot.active=!e,this.criticalRoot.active=e,e?(this.criticalIcon.setParent(this.criticalRoot),this.criticalIcon.active=!0):this.criticalIcon.active=!1;for(var n=0;n<i.length;n++){var a=e?cc.instantiate(this.critical):cc.instantiate(this.ordinary),r=e?this.criticalRoot:this.ordinaryRoot;a.setParent(r),a.active=!0,a.getComponent(cc.Sprite).spriteFrame=p.default.Instance.getHarmIcon(i[n],e)}var s=this.node.position.clone();s.y+=40,cc.tween(this.node).to(.2,{position:s}).call(function(){s.y+=40}).to(.2,{position:s,opacity:0}).call(function(){o.die()}).start()},e.prototype.die=function(){this.criticalIcon.setParent(this.node),u.default.getInstance().PushObj(this.node)},c([f(cc.Node)],e.prototype,"ordinaryRoot",void 0),c([f(cc.Node)],e.prototype,"criticalRoot",void 0),c([f(cc.Node)],e.prototype,"critical",void 0),c([f(cc.Node)],e.prototype,"criticalIcon",void 0),c([f(cc.Node)],e.prototype,"ordinary",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BACK_PlayerData:[function(t,e,o){"use strict";cc._RF.push(e,"8f963GedwtPiZzQH5xXLjwE","BACK_PlayerData");var i=t,n=e,a=o;cc._RF.push(n,"8f963GedwtPiZzQH5xXLjwE","BACK_PlayerData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.back_level1mission=!1,this.back_level2AdNum=0},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ecrypt=!1,e.gameKey=l.GameConfig.AppCacheName+"BACK_Sub",e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.backLevel1mission=function(){this.data.back_level1mission=!0,this.saveData()},e.prototype.addBacklevel2AdNum=function(){this.data.back_level2AdNum+=1,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],BACK_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"d6673urTfhNTa5T7HdGSRtM","BACK_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"d6673urTfhNTa5T7HdGSRtM","BACK_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=i("BACK_Config"),l=cc._decorator.ccclass,p=function(){function t(){this.poolMap={},this.poolRoot=null;var t=new cc.Node("poolRoot"),e=cc.find("uiRoot");t.setParent(e),e.insertChild(t,0),this.poolRoot=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e){var o=t.replace(/\//g,"_");this.poolMap[o]&&this.poolMap[o].poolList.length>0?e(this.poolMap[o].getObj()):s.ResourceMgr.getInstance().loadRes(c.BACK_BundleName.Prefabs,t,cc.Prefab,function(t){var i=cc.instantiate(t);i.name=o,e(i)})},t.prototype.PushObj=function(t){if(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new u(t,this.poolRoot);this.poolMap[e]=o}}},t.prototype.clear=function(){this.poolMap={},this.poolRoot.removeAllChildren()},e=r([l],t)}();a.default=p;var u=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],BACK_RoleBase:[function(t,e,o){"use strict";cc._RF.push(e,"9791cXX8khPwbfaI37QLjMX","BACK_RoleBase");var i=t,n=e,a=o;cc._RF.push(n,"9791cXX8khPwbfaI37QLjMX","BACK_RoleBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BACK_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkInterval=1,e.atkTime=0,e.atkForce=1,e.isAtkCooling=!0,e.clipDuration=null,e.atkAnimTimeSpeed=1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.isAtkCooling=!0,this.spAnim.setCompleteListener(function(e){e.animation.name==p.BACK_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.isAtkCooling=!0,t.spAnim.setAnimation(0,p.BACK_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==p.BACK_AnimName.attack&&t.attack()}),this.addEvent(p.BACK_EventName.SetGameState,this.setGameState)},e.prototype.setGameState=function(t){switch(t){case p.BACK_GameState.pause:this.spAnim.paused=!0;break;case p.BACK_GameState.playing:this.spAnim.paused=!1}},e.prototype.getAtkAnimSpeed=function(){var t=this.spAnim.findAnimation(p.BACK_AnimName.attack);this.clipDuration=t.duration},e.prototype.setSpAnimPlaySpeed=function(){this.atkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.atkInterval*1.05)},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BACK_RoleBox:[function(t,e,o){"use strict";cc._RF.push(e,"3cbe5Mof4pBZ7dIigfDTBDp","BACK_RoleBox");var i=t,n=e,a=o;cc._RF.push(n,"3cbe5Mof4pBZ7dIigfDTBDp","BACK_RoleBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BACK_Config"),u=i("BACK_GameManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleType=p.BACK_RoleType._Null,e.roleIcon=null,e.boxPos=null,e.boxPosArray=[],e.levelIcon=null,e.level=1,e.isTapTouchStart=!1,e.deviationOnStart=null,e.isAccord=!1,e.animIndexID=null,e}return s(e,t),e.prototype.start=function(){for(var t=0,e=this.boxPos.children;t<e.length;t++){var o=e[t];this.boxPosArray.push(o)}this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),clearInterval(this.animIndexID)},e.prototype.init=function(t){this.level=t,this.updateIconLevel(),this.addEvent(p.BACK_EventName.UpdateAllBoxAccord,this.updateAllBoxAccord),this.addEvent(p.BACK_EventName.PlayGame,this.closeBoxUpTips)},e.prototype.onTouchStart=function(t){if(null==u.default.Instance.pitchRoleBox&&!u.default.Instance.isfight){u.default.Instance.pitchRoleBox=this.node,this.isTapTouchStart=!0,this.node.angle=0,cc.Tween.stopAllByTarget(this.node),cc.Tween.stopAllByTarget(this.roleIcon.node),clearInterval(this.animIndexID),this.animIndexID=null,this.roleIcon.node.angle=0;var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.deviationOnStart=this.node.getPosition().subtract(e),this.updateTouchPos(t.getLocation()),u.default.Instance.moveRoleBox(p.BACK_MoveRoleState.TouchStart,this)}},e.prototype.onTouchMove=function(t){this.isTapTouchStart&&(this.updateTouchPos(t.getLocation()),u.default.Instance.moveRoleBox(p.BACK_MoveRoleState.TouchMove,this))},e.prototype.onTouchEnd=function(t){this.isTapTouchStart&&(this.isTapTouchStart=!1,u.default.Instance.pitchRoleBox=null,this.isAccord&&this.openBoxUpTips(),this.updateTouchPos(t.getLocation()),u.default.Instance.moveRoleBox(p.BACK_MoveRoleState.TouchEnd,this))},e.prototype.updateTouchPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t).add(this.deviationOnStart);this.node.setPosition(e)},e.prototype.upRoleMatrix=function(t){this.node.angle=0;var e=this.node.position.add(t);cc.tween(this.node).to(.15,{position:e},{easing:"bounceOut"}).start()},e.prototype.updateAllBoxAccord=function(t){for(var e=!1,o=0;o<t.length;o++)if(t[o]!=this){var i=t[o];if(i.roleType==this.roleType&&i.level==this.level&&this.level<5){e=!0;break}}e?this.openBoxUpTips():this.closeBoxUpTips()},e.prototype.openBoxUpTips=function(){var t=this;this.isAccord=!0,clearInterval(this.animIndexID),this.animIndexID=null,cc.Tween.stopAllByTarget(this.roleIcon.node),cc.tween(this.roleIcon.node).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.1,{angle:10}).to(.2,{angle:-10}).to(.3,{angle:0}).start(),this.animIndexID=setInterval(function(){cc.tween(t.roleIcon.node).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.1,{angle:10}).to(.2,{angle:-10}).to(.3,{angle:0}).start()},1420)},e.prototype.closeBoxUpTips=function(){this.isAccord&&(cc.Tween.stopAllByTarget(this.roleIcon.node),cc.tween(this.roleIcon.node).to(.02,{angle:0}).start(),clearInterval(this.animIndexID),this.animIndexID=null),this.isAccord=!1},e.prototype.upRoleLevel=function(){this.level>=5||(this.level++,this.updateIconLevel())},e.prototype.updateIconLevel=function(){var t=this,e="roleBox/roleBox"+this.roleType+"_"+this.level;this.loadSpriteFrame(p.BACK_BundleName.Sprite,e,function(e){t.roleIcon.spriteFrame=e});var o="roleLevelIcon/jb_0"+this.level;this.loadSpriteFrame(p.BACK_BundleName.Sprite,o,function(e){t.levelIcon.spriteFrame=e})},e.prototype.die=function(){clearInterval(this.animIndexID),this.animIndexID=null,this.node.destroy()},c([f({type:cc.Enum(p.BACK_RoleType)})],e.prototype,"roleType",void 0),c([f(cc.Sprite)],e.prototype,"roleIcon",void 0),c([f(cc.Node)],e.prototype,"boxPos",void 0),c([f(cc.Sprite)],e.prototype,"levelIcon",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BACK_RoleBullet:[function(t,e,o){"use strict";cc._RF.push(e,"a8474x7IINH0Jb8P6lldFJt","BACK_RoleBullet");var i=t,n=e,a=o;cc._RF.push(n,"a8474x7IINH0Jb8P6lldFJt","BACK_RoleBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BACK_Config"),u=i("BACK_GameManager"),d=i("BACK_StoneMap"),h=i("BACK_PoolMgr"),f=i("BACK_Enemy"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.boxCol=null,e.atkForce=0,e.moveSpeed=1e3,e.moveDir=cc.v2(0,1),e.atkList=[],e.criticalForce=0,e.criticalChance=0,e.dieTime=0,e.isDie=!1,e}return s(e,t),e.prototype.init=function(t,e,o,i,n){this.atkForce=e,this.criticalChance=i,this.criticalForce=n,this.icon.spriteFrame=u.default.Instance.getBulletImg(t),this.isDie=!1,this.moveDir=o},e.prototype.update=function(t){u.default.Instance.gameState!=p.BACK_GameState.pause&&(this.isDie||(this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t,this.checkCollisionStone(),this.checkCollisionEnemy(),this.dieTime+=t,this.dieTime>2&&this.die()))},e.prototype.checkCollisionStone=function(){var t=u.default.Instance.stoneAtk;if(t){var e=t.getComponent(d.default),o=this.boxCol.getBoundingBoxToWorld(),i=e.boxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(o,i)){var n=this.atkForce,a=Math.random()<this.criticalChance;a&&(n=this.atkForce*this.criticalForce),n=Math.floor(n),e.attackEd(n,a),this.die()}}},e.prototype.checkCollisionEnemy=function(){var t=u.default.Instance.getCollisionBullet(this);if(t){var e=t.getComponent(f.default);if(e.getIsDie())return;var o=this.atkForce,i=Math.random()<this.criticalChance;i&&(o=this.atkForce*this.criticalForce),o=Math.floor(o),e.attackEd(o,i),this.die()}},e.prototype.die=function(){this.isDie=!0,this.moveDir=cc.v2(),this.atkList=[],this.dieTime=0,h.default.getInstance().PushObj(this.node)},c([y(cc.Sprite)],e.prototype,"icon",void 0),c([y(cc.Node)],e.prototype,"boxCol",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],BACK_RoleField:[function(t,e,o){"use strict";cc._RF.push(e,"697fafpbV5FJLb2uITffBE2","BACK_RoleField");var i=t,n=e,a=o;cc._RF.push(n,"697fafpbV5FJLb2uITffBE2","BACK_RoleField");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("BACK_Config"),u=i("BACK_DataMgr"),d=i("BACK_GameEnumData"),h=i("BACK_GameManager"),f=i("BACK_PoolMgr"),m=i("BACK_RoleBase"),g=i("BACK_RoleBullet"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.qualityAnim=null,e.levelIcon=null,e.atkPos=null,e.skillsAnim=null,e.isSkillsAtkDouble=!1,e.skillsAtkDoubleTime=0,e.isSkillRole=!1,e.skillRoleTime=0,e.mate=[],e.skillID=0,e.mateRate=0,e.isDie=!1,e.isPoolDie=!1,e.level=1,e.hp=0,e.bulletPath="",e.bulletTrajectory=1,e.bulletStepY=23,e.criticalForce=0,e.criticalChance=0,e.secondAtk=0,e.atkTarget=null,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.addEvent(p.BACK_EventName.IsAtkStone,this.setAtkStone),this.addEvent(p.BACK_EventName.SkillsAtkDouble,this.skillsAtkDouble),this.addEvent(p.BACK_EventName.WaveOver,this.waveOver)},e.prototype.init=function(t,e){var o=this;this.roleID=t,this.level=e,this.spAnim.node.setScale(-1,1),this.bulletPath=p.BACK_RoleAsePath[t].bullet;var i=p.BACK_RoleAsePath[t].path;this.loadResFromBundle(p.BACK_BundleName.SpAnim,i,sp.SkeletonData,function(t){o.spAnim.skeletonData=t,o.spAnim.setAnimation(0,p.BACK_AnimName.idle,!0),o.getAtkAnimSpeed(),o.setSpAnimPlaySpeed()}),this.isSkillsAtkDouble=!1,this.skillsAnim.node.active=!1,this.isDie=!1,this.isPoolDie=!1,this.updateAnimLevel(),this.updateProperty()},e.prototype.summonSkill=function(t){var e=this;this.isSkillRole=!0,this.skillRoleTime=0,this.atkForce=t,this.atkInterval=u.default.getInstance().getParameterCfg(d.BACK_enumGearParameterCfg.duanyuAtkSpeed),this.isDie=!0,this.isPoolDie=!1,this.bulletPath="hero8_bullet1",cc.tween(this.node).to(.5,{position:cc.v3()}).call(function(){e.isDie=!1}).start()},e.prototype.waveOver=function(){var t=this;if(!this.isPoolDie)if(this.isSkillRole){this.spAnim.node.setScale(1,1);var e=this.node.position;e.x+=400,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.5,{position:e}).call(function(){t.node.destroy()}).start()}else this.isSkillsAtkDouble=!1,this.skillsAnim.node.active=!1},e.prototype.skillsAtkDouble=function(){this.isPoolDie||(this.isSkillsAtkDouble=!0,this.skillsAtkDoubleTime=0,this.skillsAnim.node.active=!0,this.skillsAnim.setAnimation(0,p.BACK_AnimName.animation,!0))},e.prototype.setAtkStone=function(t){this.isPoolDie||(t?this.spAnim.node.setScale(1,1):this.spAnim.node.setScale(-1,1))},e.prototype.update=function(t){var e=this;if(h.default.Instance.gameState!=p.BACK_GameState.pause&&h.default.Instance.isfight&&!this.isDie&&(this.isSkillsAtkDouble&&(this.skillsAtkDoubleTime+=t,this.skillsAtkDoubleTime>15&&(this.isSkillsAtkDouble=!1,this.skillsAtkDoubleTime=0,this.skillsAnim.node.active=!1)),this.isAtkCooling?(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.isAtkCooling=!1)):this.isSkillRole?(this.attack(),this.isAtkCooling=!0):this.isPlayAtkAnim(),this.isSkillRole&&(this.skillRoleTime+=t,this.skillRoleTime>30))){this.skillRoleTime=0,this.isSkillRole=!1,this.isDie=!0,this.spAnim.node.setScale(1,1);var o=this.node.position;o.x+=400,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.5,{position:o}).call(function(){e.node.destroy()}).start()}},e.prototype.isPlayAtkAnim=function(){h.default.Instance.isAtkStone?this.atkTarget=h.default.Instance.stoneAtk:this.atkTarget=h.default.Instance.getEnemyNear(this.node),this.atkTarget&&(this.isAtkCooling=!0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,p.BACK_AnimName.attack,!1),l.AudioMgr.getInstance().playEffectFree(p.BACK_AudioId.gongji))},e.prototype.attack=function(){var t=this;if(null==this.atkTarget&&(this.atkTarget=h.default.Instance.getEnemyNear(this.node)),null!=this.atkTarget&&this.atkTarget.parent){var e=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),o=this.atkTarget.convertToWorldSpaceAR(cc.v2(0,0)).sub(e).normalize(),i=180*Math.atan2(o.y,o.x)/Math.PI-90;this.atkTarget=null;var n=h.default.Instance.random(-15,15),a=this.atkForce;this.isSkillsAtkDouble&&(a=2*this.atkForce);for(var r=function(e){f.default.getInstance().getObj("bullet/roleBullet",function(r){r.setParent(h.default.Instance.roleBulletBase);var s=t.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),c=t.bulletTrajectory,l=-t.bulletStepY*(c-1)/2+e*t.bulletStepY;s.y+=l,s.y+=n;var p=r.parent.convertToNodeSpaceAR(s);r.setPosition(p),r.angle=i,r.getComponent(g.default).init(t.bulletPath,a,o,t.criticalChance,t.criticalForce)})},s=0;s<this.bulletTrajectory;s++)r(s)}},e.prototype.upRoleLevel=function(){this.level>=5||(this.level++,this.updateAnimLevel(),this.updateProperty())},e.prototype.updateAnimLevel=function(){var t=this,e="roleLevelIcon/jb_0"+this.level;this.loadSpriteFrame(p.BACK_BundleName.Sprite,e,function(e){t.levelIcon.spriteFrame=e})},e.prototype.updateProperty=function(){var t=u.default.getInstance().getRoleInfo(this.level,this.roleID);this.hp=t.HP,this.atkForce=t.Atk,this.bulletTrajectory=t.Bullet,this.atkInterval=t.AtkSpeed,this.criticalChance=t.CriticPro,this.criticalForce=t.CriticProDamage,this.skillID=t.mate,this.secondAtk=t.BattleNumber,this.mateRate=t.MateRate,this.setSpAnimPlaySpeed()},e.prototype.die=function(){this.isPoolDie=!0,f.default.getInstance().PushObj(this.node)},c([_(sp.Skeleton)],e.prototype,"qualityAnim",void 0),c([_(cc.Sprite)],e.prototype,"levelIcon",void 0),c([_(cc.Node)],e.prototype,"atkPos",void 0),c([_(sp.Skeleton)],e.prototype,"skillsAnim",void 0),c([v],e)}(m.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BACK_SelectLevel:[function(t,e,o){"use strict";cc._RF.push(e,"58aa0RukddB2a4mjF7VoDAi","BACK_SelectLevel");var i=t,n=e,a=o;cc._RF.push(n,"58aa0RukddB2a4mjF7VoDAi","BACK_SelectLevel");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("SdkMgr"),u=i("BACK_APP"),d=i("BACK_APP2"),h=i("BACK_Config"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBack=null,e.btnLevel1=null,e.btnLevel2=null,e.levelLock=null,e.txtPlay=null,e.txtAdNun=null,e.isTouch=!1,e}return s(e,t),e.prototype.start=function(){var t=this;u.default.instance.backData.data.back_level2AdNum>=2||u.default.instance.backData.data.back_level1mission?(this.levelLock.active=!1,this.txtPlay.active=!0):(this.levelLock.active=!0,this.txtPlay.active=!1,this.txtAdNun.string=u.default.instance.backData.data.back_level2AdNum+"/2"),this.btnBack.on(cc.Node.EventType.TOUCH_END,function(){t.isTouch||(t.isTouch=!0,t.closeUI(),d.default.instance.isLevel2?d.default.instance.exit_App(0):u.default.instance.exit_App(0))},this),this.btnLevel1.on(cc.Node.EventType.TOUCH_END,function(){t.isTouch||(t.isTouch=!0,t.openUICallBack(h.BACK_UIID.BACK_UIGame1,function(){t.closeUI()}))},this),this.btnLevel2.on(cc.Node.EventType.TOUCH_END,function(){if(!t.isTouch){t.isTouch=!0;var e=function(){t.openUICallBack(h.BACK_UIID.BACK_UIGame2,function(){t.closeUI()})};u.default.instance.backData.data.back_level2AdNum>=2||u.default.instance.backData.data.back_level1mission?e():p.SdkMgr.getInstance().playVideo(p.AdType.AdFreeTime,function(){t.isTouch=!1,u.default.instance.backData.addBacklevel2AdNum(),t.txtAdNun.string=u.default.instance.backData.data.back_level2AdNum+"/2",u.default.instance.backData.data.back_level2AdNum>=2&&e()})}},this)},c([g(cc.Node)],e.prototype,"btnBack",void 0),c([g(cc.Node)],e.prototype,"btnLevel1",void 0),c([g(cc.Node)],e.prototype,"btnLevel2",void 0),c([g(cc.Node)],e.prototype,"levelLock",void 0),c([g(cc.Node)],e.prototype,"txtPlay",void 0),c([g(cc.Label)],e.prototype,"txtAdNun",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BACK_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"e31e11y3xJK7pEKczxy3noU","BACK_Skills");var i=t,n=e,a=o;cc._RF.push(n,"e31e11y3xJK7pEKczxy3noU","BACK_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BACK_Config"),u=i("BACK_GameManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkForce=0,e.skillID=0,e.clipDuration=0,e.time=0,e.isDie=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==p.BACK_AnimName.animation&&t.node.destroy()}),this.spAnim.setEventListener(function(e,o){if(6!=t.skillID)switch(o.data.name){case p.BACK_AnimName.attack:case"hit":t.sendEvent(p.BACK_EventName.PlaySkillsAtk,t.skillID,t.atkForce)}}),this.addEvent(p.BACK_EventName.SetGameState,this.setGameState);var e=this.spAnim.findAnimation(p.BACK_AnimName.animation);this.clipDuration=.65*e.duration},e.prototype.update=function(t){u.default.Instance.gameState!=p.BACK_GameState.pause&&(this.isDie||6!=this.skillID&&4!=this.skillID||(this.time+=t,this.time>this.clipDuration&&(this.isDie=!0,this.time=0,this.sendEvent(p.BACK_EventName.PlaySkillsAtk,this.skillID,this.atkForce))))},e.prototype.init=function(t,e){var o=this;this.atkForce=t,this.skillID=e,this.isDie=!1,this.spAnim.setAnimation(0,p.BACK_AnimName.animation,!1),6==this.skillID&&setTimeout(function(){o.sendEvent(p.BACK_EventName.PlaySkillsAtk,o.skillID,o.atkForce)},300)},e.prototype.setGameState=function(t){switch(t){case p.BACK_GameState.pause:this.spAnim.paused=!0;break;case p.BACK_GameState.playing:this.spAnim.paused=!1}},c([f(sp.Skeleton)],e.prototype,"spAnim",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BACK_Sphere:[function(t,e,o){"use strict";cc._RF.push(e,"06be8dEshFM+bBeCQcZgCuI","BACK_Sphere");var i=t,n=e,a=o;cc._RF.push(n,"06be8dEshFM+bBeCQcZgCuI","BACK_Sphere");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BACK_Config"),u=i("BACK_GameManager"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rotateSpeed=7,e}return s(e,t),e.prototype.start=function(){},e.prototype.update=function(t){u.default.Instance.gameState!=p.BACK_GameState.pause&&(u.default.Instance.isColStone||u.default.Instance.isfight&&(this.node.angle+=this.rotateSpeed*t))},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BACK_StoneMap:[function(t,e,o){"use strict";cc._RF.push(e,"d55e3siyE9OPZRbTVtekshg","BACK_StoneMap");var i=t,n=e,a=o;cc._RF.push(n,"d55e3siyE9OPZRbTVtekshg","BACK_StoneMap");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("BACK_Config"),d=i("BACK_GameManager"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtHp=null,e.boxCol=null,e.atkEnAnim=null,e.hp=0,e.isCol=!1,e.isDie=!1,e.harmEffFew=0,e}return s(e,t),e.prototype.start=function(){var t=this;this.atkEnAnim.setCompleteListener(function(e){e.animation.name==u.BACK_AnimName.animation&&(t.atkEnAnim.node.active=!1)}),this.addEvent(u.BACK_EventName.PlayStoneAtkEnAnim,this.playAtkEnAnim)},e.prototype.init=function(t){this.hp=t,this.hp=d.default.Instance.round(this.hp),this.txtHp.string=""+this.hp,this.atkEnAnim.node.active=!1},e.prototype.update=function(){if(d.default.Instance.gameState!=u.BACK_GameState.pause&&!this.isDie&&!this.isCol){var t=this.boxCol.getBoundingBoxToWorld(),e=d.default.Instance.yunBoxCol.getBoundingBoxToWorld();cc.Intersection.rectRect(t,e)&&(this.isCol=!0,d.default.Instance.setIsColStone(!0))}},e.prototype.attackEd=function(t,e){var o=this;d.default.Instance.gameState!=u.BACK_GameState.pause&&(this.playAtkEnAnim(),p.AudioMgr.getInstance().playEffectFree(u.BACK_AudioId.dragonHit),this.hp-=t,this.hp=d.default.Instance.round(this.hp),this.txtHp.string=""+this.hp,this.harmEffFew<3&&(this.harmEffFew++,setTimeout(function(){o.harmEffFew--},110),d.default.Instance.playHarmEff(this.node,this.harmEffFew,t,e)),this.hp<1&&this.die())},e.prototype.playAtkEnAnim=function(){p.AudioMgr.getInstance().playEffectFree(u.BACK_AudioId.shitou),this.atkEnAnim.node.active||(this.atkEnAnim.node.active=!0,this.atkEnAnim.setAnimation(0,u.BACK_AnimName.animation,!1))},e.prototype.die=function(){this.isDie=!0,d.default.Instance.setIsColStone(!1),this.node.destroy()},c([m(cc.Label)],e.prototype,"txtHp",void 0),c([m(cc.Node)],e.prototype,"boxCol",void 0),c([m(sp.Skeleton)],e.prototype,"atkEnAnim",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BACK_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"bdba4YOh/tPlKkZSvv81/bq","BACK_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"bdba4YOh/tPlKkZSvv81/bq","BACK_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("BACK_Config"),d=i("BACK_DataMgr"),h=i("BACK_GameManager"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.btnAddRoleBox=null,e.btnPlaySkill=null,e.skillID=0,e}return s(e,t),e.prototype.start=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.btnAddRoleBox.on(cc.Node.EventType.TOUCH_END,function(){h.default.Instance.updateRoleBoxSpare()},this),this.btnPlaySkill.on(cc.Node.EventType.TOUCH_END,function(){switch(t.skillID++,t.skillID>11&&(t.skillID=1),t.skillID){case 1:case 2:case 3:case 4:case 6:case 8:case 9:case 10:case 11:h.default.Instance.playSkillsAtk(t.skillID);break;case 5:t.sendEvent(u.BACK_EventName.SkillsAtkDouble);break;case 7:h.default.Instance.playSkillsRole()}p.AudioMgr.getInstance().playEffectFree(d.default.getInstance().getSkillsCfg(t.skillID).mateSound),t.sendEvent(u.BACK_EventName.PlaySkillBanner,t.skillID)},this)},c([g(cc.Node)],e.prototype,"btnClose",void 0),c([g(cc.Node)],e.prototype,"btnAddRoleBox",void 0),c([g(cc.Node)],e.prototype,"btnPlaySkill",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BACK_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"d3854qQ6SZDlr97ITeJbD/V","BACK_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"d3854qQ6SZDlr97ITeJbD/V","BACK_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BACK_APP"),u=i("BACK_APP2"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.win=null,e.fail=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.isLevel2?u.default.instance.exit_App(0):p.default.instance.exit_App(0)},this),this.win.active=this.isWin,this.fail.active=!this.isWin},c([f(cc.Node)],e.prototype,"btnClose",void 0),c([f(cc.Node)],e.prototype,"win",void 0),c([f(cc.Node)],e.prototype,"fail",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BACK_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"75a66mGMgBORrUGDteZQC4k","BACK_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"75a66mGMgBORrUGDteZQC4k","BACK_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("SdkMgr"),h=i("BACK_APP2"),f=i("BACK_Config"),m=i("BACK_DataMgr"),g=i("BACK_GameManager"),y=i("BACK_Btn_Skills"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnPause=null,e.lockTips=null,e.txtLevel=null,e.levelBar=null,e.skillBtnsBase=null,e.btn_Skills=null,e.playSkillTips=null,e.toolTips=null,e.mateKeyNumBase=null,e.matekeyInfo=null,e.mateKeyNumInfo=[],e.activateSkills=[],e.isSkillTipsUnder=!1,e.skillTipsQueue=[],e}return s(e,t),e.prototype.start=function(){var t=this;(d.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR)&&this.lockTips.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(f.BACK_UIID.BACK_UIGM)},this),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(f.BACK_UIID.BACK_UIPause),g.default.Instance.setGameState(f.BACK_GameState.pause)},this),this.addEvent(f.BACK_EventName.UpdateWaveUI,this.updateWaveUI),this.addEvent(f.BACK_EventName.UpdateWaveBarUI,this.updateWaveBarUI),this.addEvent(f.BACK_EventName.ActivateSkills,this.onSkillAdded),this.addEvent(f.BACK_EventName.PlaySkillBanner,this.playSkillBanner),this.addEvent(f.BACK_EventName.PlayGame,this.playGame),this.addEvent(f.BACK_EventName.WaveOver,this.waveOver),this.addEvent(f.BACK_EventName.ActivateRoleSkills,this.onRoleSkillAdded),this.addEvent(f.BACK_EventName.PlayTips,this.playTips),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),clearTimeout(this.playTipsID),clearTimeout(this.playAddSkillTipsID)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.space:this.openUI(f.BACK_UIID.BACK_UIPause),g.default.Instance.setGameState(f.BACK_GameState.pause)}},e.prototype.onRoleSkillAdded=function(t){for(var e=0,o=Object.entries(t);e<o.length;e++){var i=o[e],n=i[0],a=i[1],r=Number(n);if(null==this.activateSkills[r]){var s=cc.instantiate(this.btn_Skills);s.setParent(this.skillBtnsBase),s.active=!0,this.activateSkills[r]=s.getComponent(y.default),this.activateSkills[r].init(r,a),this.skillTipsQueue.push(r)}else this.activateSkills[r].isDie=!1,this.activateSkills[r].node.active=!0,this.activateSkills[r].updateLevel(a)}this.playAddSkillTips();for(var c=[],l=0,p=Object.entries(this.activateSkills);l<p.length;l++){var u=p[l],d=(n=u[0],a=u[1],Number(n));null==t[d]&&c.push(d)}for(var h=0,f=c;h<f.length;h++)r=f[h],this.activateSkills[r].isDie=!0,this.activateSkills[r].node.active=!1;for(var m=0,g=0,v=this.skillBtnsBase.children;g<v.length;g++)v[g].active&&m++;m>4&&(m=4),this.skillBtnsBase.width=100*m-10},e.prototype.onSkillAdded=function(t,e){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(null==this.activateSkills[n]){var a=cc.instantiate(this.btn_Skills);a.setParent(this.skillBtnsBase),a.active=!0,this.activateSkills[n]=a.getComponent(y.default),this.activateSkills[n].init(n,0),this.skillTipsQueue.push(n)}else this.activateSkills[n].isDie&&(this.activateSkills[n].isDie=!1,this.activateSkills[n].node.active=!0)}this.playAddSkillTips();for(var r=[],s=0,c=Object.entries(this.activateSkills);s<c.length;s++){var l=c[s],p=l[0],u=(l[1],Number(p));t.includes(u)||r.push(u)}for(var d=0,h=r;d<h.length;d++){var g=h[d];this.activateSkills[g].isDie=!0,this.activateSkills[g].node.active=!1}for(var v=function(t,e){var o=Number(t);if(null==_.mateKeyNumInfo[o]){var i=cc.instantiate(_.matekeyInfo);i.setParent(_.mateKeyNumBase),i.active=!0,i.getChildByName("txtNum").getComponent(cc.Label).string=e+"/2",i.getChildByName("txtNum").color=2==e?cc.Color.ORANGE:cc.Color.WHITE;var n="skillsBtnIcon/"+m.default.getInstance().getSkillsCfg(o).mateIconRes;_.loadSpriteFrame(f.BACK_BundleName.Sprite,n,function(t){i.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),_.mateKeyNumInfo[o]={node:i,keyNum:e}}else _.mateKeyNumInfo[o].keyNum=e,_.mateKeyNumInfo[o].node.active=!0,_.mateKeyNumInfo[o].node.getChildByName("txtNum").getComponent(cc.Label).string=e+"/2",_.mateKeyNumInfo[o].node.getChildByName("txtNum").color=2==e?cc.Color.ORANGE:cc.Color.WHITE},_=this,b=0,B=Object.entries(e);b<B.length;b++){var I=B[b];v(p=I[0],I[1])}for(var P=[],C=0,D=Object.entries(this.mateKeyNumInfo);C<D.length;C++){var T=D[C];p=T[0],T[1],null==e[g=Number(p)]&&P.push(g)}for(var S=0,A=P;S<A.length;S++)g=A[S],this.mateKeyNumInfo[g].node.active=!1;this.sortActivateSkillNodes()},e.prototype.sortActivateSkillNodes=function(){var t=Object.entries(this.mateKeyNumInfo).map(function(t){var e=t[0],o=t[1];return{key:Number(e),node:o.node,keyNum:o.keyNum,origIndex:o.node.getSiblingIndex()}});t.sort(function(t,e){return e.keyNum!==t.keyNum?e.keyNum-t.keyNum:0}),t.forEach(function(t,e){var o=t.node;o.parent&&o.setSiblingIndex(e)})},e.prototype.playGame=function(){var t=this.mateKeyNumBase.position.clone();t.x-=200,cc.Tween.stopAllByTarget(this.mateKeyNumBase),cc.tween(this.mateKeyNumBase).to(.25,{position:t}).start()},e.prototype.waveOver=function(){var t=this.mateKeyNumBase.position.clone();t.x+=200,cc.Tween.stopAllByTarget(this.mateKeyNumBase),cc.tween(this.mateKeyNumBase).to(.25,{position:t}).start()},e.prototype.playAddSkillTips=function(){var t=this;if(0!=this.skillTipsQueue.length&&!this.isSkillTipsUnder){var e=this.skillTipsQueue.shift();this.isSkillTipsUnder=!0;var o=cc.instantiate(this.toolTips);o.setParent(this.toolTips.parent),o.active=!0,o.getChildByName("tipsName").getComponent(cc.Label).string=m.default.getInstance().getSkillsCfg(e).mateName,o.getChildByName("info").getComponent(cc.Label).string=m.default.getInstance().getSkillsCfg(e).introduce;var i="skillsBtnIcon/"+m.default.getInstance().getSkillsCfg(e).mateIconRes;this.loadSpriteFrame(f.BACK_BundleName.Sprite,i,function(t){o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),o.setScale(0),cc.tween(o).to(.2,{scale:1}).start(),o.setPosition(0,400),clearTimeout(this.playAddSkillTipsID),this.playAddSkillTipsID=setTimeout(function(){t.isSkillTipsUnder=!1,t.playAddSkillTips();var e=o.position.clone();e.y+=300,cc.tween(o).to(.4,{position:e}).call(function(){o.destroy()}).start()},2100)}},e.prototype.playSkillBanner=function(t){var e=this,o=cc.instantiate(this.toolTips);o.setParent(this.toolTips.parent),o.active=!0,o.getChildByName("tipsName").getComponent(cc.Label).string=m.default.getInstance().getSkillsCfg(t).mateName,o.getChildByName("info").getComponent(cc.Label).string=m.default.getInstance().getSkillsCfg(t).introduce;var i="skillsBtnIcon/"+m.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(f.BACK_BundleName.Sprite,i,function(t){o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),o.setScale(0),cc.tween(o).to(.2,{scale:1}).start(),o.setPosition(0,470),setTimeout(function(){e.isSkillTipsUnder=!1;var t=o.position.clone();t.y+=300,cc.tween(o).to(.4,{position:t}).call(function(){o.destroy()}).start()},2100)},e.prototype.playTips=function(t){var e=this,o=cc.instantiate(this.toolTips);o.setParent(this.toolTips.parent),o.active=!0,o.getChildByName("tipsName").active=!1,o.getChildByName("icon").active=!1;var i=o.getChildByName("info");i.getComponent(cc.Label).string=t,i.setPosition(cc.v2(0,i.y)),cc.tween(o).to(.2,{scale:1}).start(),o.setPosition(0,470),clearTimeout(this.playTipsID),this.playTipsID=setTimeout(function(){e.isSkillTipsUnder=!1,e.playAddSkillTips();var t=o.position.clone();t.y+=300,cc.tween(o).to(.4,{position:t}).call(function(){o.destroy()}).start()},1300)},e.prototype.updateWaveUI=function(t){var e=h.default.instance.isLevel2?20:15;this.txtLevel.string="\u7b2c"+t+"/"+e+"\u6ce2";var o=this.mateKeyNumBase.position.clone();o.x-=300,cc.Tween.stopAllByTarget(this.mateKeyNumBase),cc.tween(this.mateKeyNumBase).to(.25,{position:o}).start()},e.prototype.updateWaveBarUI=function(t,e){var o=t/e;cc.Tween.stopAllByTarget(this.levelBar),cc.tween(this.levelBar).to(.1,{progress:o}).start()},c([b(cc.Node)],e.prototype,"btnPause",void 0),c([b(cc.Node)],e.prototype,"lockTips",void 0),c([b(cc.Label)],e.prototype,"txtLevel",void 0),c([b(cc.ProgressBar)],e.prototype,"levelBar",void 0),c([b(cc.Node)],e.prototype,"skillBtnsBase",void 0),c([b(cc.Node)],e.prototype,"btn_Skills",void 0),c([b(cc.Node)],e.prototype,"playSkillTips",void 0),c([b(cc.Node)],e.prototype,"toolTips",void 0),c([b(cc.Node)],e.prototype,"mateKeyNumBase",void 0),c([b(cc.Node)],e.prototype,"matekeyInfo",void 0),c([_],e)}(p.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],BACK_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"c5632b+R5BOYrEK7sbxvKCv","BACK_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"c5632b+R5BOYrEK7sbxvKCv","BACK_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BACK_APP"),u=i("BACK_APP2"),d=i("BACK_Config"),h=i("BACK_GameManager"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),h.default.Instance.setGameState(d.BACK_GameState.playing)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.isLevel2?u.default.instance.exit_App(0):p.default.instance.exit_App(0),t.closeUI()},this)},c([g(cc.Node)],e.prototype,"btnResume",void 0),c([g(cc.Node)],e.prototype,"btnClose",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BACK_YunSpAnim:[function(t,e,o){"use strict";cc._RF.push(e,"66e97n1/kRJ079WjWp2RKoP","BACK_YunSpAnim");var i=t,n=e,a=o;cc._RF.push(n,"66e97n1/kRJ079WjWp2RKoP","BACK_YunSpAnim");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BACK_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.rolePosBase=null,e}return s(e,t),e.prototype.start=function(){this.playAnim(p.BACK_AnimName.idle),this.addEvent(p.BACK_EventName.SetGameState,this.setGameState)},e.prototype.playAnim=function(t){this.spAnim.setAnimation(0,t,!0)},e.prototype.updateYunSkin=function(){var t=this.rolePosBase.childrenCount;t<=2?(this.spAnim.setSkin("skin_01"),this.node.setScale(1)):3==t?(this.spAnim.setSkin("skin_02"),this.node.setScale(1)):t>=4&&(this.spAnim.setSkin("skin_03"),this.node.setScale(1.15,1))},e.prototype.setGameState=function(t){switch(t){case p.BACK_GameState.pause:this.spAnim.paused=!0;break;case p.BACK_GameState.playing:this.spAnim.paused=!1}},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([h(cc.Node)],e.prototype,"rolePosBase",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BALLGameData:[function(t,e,o){"use strict";cc._RF.push(e,"ff2b1TgrTxPu51Bn2uSlmj4","BALLGameData");var i=e,n=o;cc._RF.push(i,"ff2b1TgrTxPu51Bn2uSlmj4","BALLGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emBALLGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffOddsCfg="buffOddsCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.dragonBallShowCfg="dragonBallShowCfg",t.dragonBallCfg="dragonBallCfg",t.levelCfg="levelCfg",t.mateOddsCfg="mateOddsCfg",t.mateCfg="mateCfg"}(n.emBALLGameDataKeys||(n.emBALLGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],BALLGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"c33ee2ji6FMNbih9fT1X1+i","BALLGameEnumData");var i=e,n=o;cc._RF.push(i,"c33ee2ji6FMNbih9fT1X1+i","BALLGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.girlMoveSpeed=15]="girlMoveSpeed",t[t.wordsTime=16]="wordsTime",t[t.wordShow=17]="wordShow",t[t.dieWordDistance=18]="dieWordDistance",t[t.girlPosition=19]="girlPosition",t[t.dragonMoveAmniTime=20]="dragonMoveAmniTime",t[t.tipsStayTime=21]="tipsStayTime",t[t.ballFlySpeed=22]="ballFlySpeed",t[t.changeLimit=23]="changeLimit",t[t.sunsxLimit=24]="sunsxLimit"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],BALL_App:[function(t,e,o){"use strict";cc._RF.push(e,"71fc2NGgIJLv7XHybsatAOw","BALL_App");var i=t,n=e,a=o;cc._RF.push(n,"71fc2NGgIJLv7XHybsatAOw","BALL_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("BALL_Configs"),p=i("BALL_DataMgr"),u=i("BALL_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;if(void 0===o&&(o=!1),l.Global.isDirect=o,this.addTouchEvent(),this._exitCall=e,o)s.UIMgr.getInstance().addUICnf(l.BALL_UICF),r.AudioMgr.getInstance().addAdConf(l.BALL_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){s.UIMgr.getInstance().openUIOfCallback(l.BALL_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.BALL_AudioId.bgm,l.BALLConfig.BgMusic)})})},!0);else{var n=function(){i._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.BALL_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.BALL_AudioId.bgm,l.BALLConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.BALL_UICF),r.AudioMgr.getInstance().addAdConf(l.BALL_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){n()})}))}},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.BALL_UIID.UIGame),s.UIMgr.getInstance().closeById(l.BALL_UIID.UIResult),s.UIMgr.getInstance().closeById(l.BALL_UIID.UISetting),l.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],BALL_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c4497DsbzpHcIXnPftMjyzd","BALL_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c4497DsbzpHcIXnPftMjyzd","BALL_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Utils"),u=i("BALL_Configs"),d=function(t,e){this.flag=t,this.num=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useState=!1,e.bloodArr=[],e.limitTime=3,e.showNum=10,e}return s(e,t),e.prototype.isCirt=function(t,e){t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e+""):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e+""),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=p.Utils.randomRang(-30,30),o=p.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){l.PoolMgr.getInstance().freeNode(u.poolName.blood,t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.x=0,this.node.y=0,this.node.opacity=255},e.prototype.inUse=function(){return this.useState},e.prototype.pushBlood=function(t,e){var o=new d(t,e);this.bloodArr.push(o)},e.prototype.showBlood=function(){for(var t=this.bloodArr.splice(0,this.showNum),e=0;e<t.length;e++){var o=t[e];this.isCirt(o.flag,o.num)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){(this.nowTime<0||!this.nowTime)&&(this.nowTime=this.limitTime,this.showBlood()),this.nowTime--},e.prototype.onDestroy=function(){this.bloodArr=[]},c([m(cc.Node)],e.prototype,"isCritState",void 0),c([m(cc.Label)],e.prototype,"critLabel",void 0),c([m(cc.Label)],e.prototype,"commonLabel",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BALL_Body:[function(t,e,o){"use strict";cc._RF.push(e,"abe2bdNrRhNBqaSNjAKhq8x","BALL_Body");var i=t,n=e,a=o;cc._RF.push(n,"abe2bdNrRhNBqaSNjAKhq8x","BALL_Body");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("BALL_Configs"),d=i("BALLGameEnumData"),h=i("BALL_DataMgr"),f=i("BALL_UIGame"),m=i("ball"),g=i("BALL_bodyCtrl"),y=i("BALL_boxCtrl"),v=i("ballCtrl"),_=i("fireNode"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.playerParent=null,e.box=null,e.hpParent=null,e.path=new Array,e.gapY=200,e.gapX=200,e.ballpState=!1,e.skillState=!1,e.nowIndex=0,e.moveWidth=300,e.colliderArr=[],e.width=35,e.lastTime=0,e.bodyArr=[],e.lastMoveTime=0,e.animationIndex=1,e.gapTime=0,e.nowTime=0,e.iceState=!1,e.fireState=!1,e.fireNum=0,e.vagueNum=1,e.onceTime=1,e.fireTime=0,e.haveFireNode=0,e.fireNodeArr=[],e.fireNodePos=[],e.num=0,e.dtNum=10,e.boxNum=0,e.isFirst=!0,e.isLast=!1,e.boxTemp=null,e.FirstAnimationTime=0,e.NeedDoAnimationTime=0,e.AnimationGapTime=.1,e.ballIndex=100001,e.fireIndex=100002,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){this.initBodyGapTime(),o.script=this,this.createPath(),this.ballCtrl=new v.default(this,this.path),this.lastNode=this.head,this.addEvent(u.emBALLEventName.pause,this.stop),this.addEvent(u.emBALLEventName.skillPause,this.skillPause),this.addEvent(u.emBALLEventName.skillResume,this.skillResume),this.addEvent(u.emBALLEventName.resume,this.resume),this.moveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed),this.gapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniTime),this.gapTime=.1,this.nowTime=this.gapTime,this.shouldMove=this.width,this.moveWidth=this.shouldMove,this.lastTime=Date.now()},e.prototype.doBallSkill=function(t,e){if(e.dragonBallID==m.ballID.iceBall)this.iceState=!0,this.stopAnimation();else if(e.dragonBallID==m.ballID.fireBall)if(t==m.ballState.dragon){var o=h.default.getInstance().getLevelCfgByID(this.nowIndex);this.createFireNode(e.dragonGetPara1*o.dragonHp,e.dragonGetPara2)}else this.fireState=!0,this.fireNum=e.playerGetPara1,this.changeFire();else e.dragonBallID==m.ballID.thunderBall||(e.dragonBallID==m.ballID.windBall?this.moveSpeed=e.dragonGetPara1:e.dragonBallID==m.ballID.vagueBall&&(this.vagueNum=e.dragonGetPara1));this.showBuff(e.dragonBallID)},e.prototype.changeFire=function(){for(var t in this.bodyArr)this.bodyArr[t].getComponent(g.default).changeFireState()},e.prototype.showBuff=function(t){if(t==m.ballID.iceBall){this.iceNode.active=!0;var e=this.iceNode.getComponent(sp.Skeleton);e.setAnimation(0,"dj_1",!1),e.setCompleteListener(function(){e.setAnimation(0,"dj_2",!0)})}else if(t==m.ballID.vagueBall){this.shieldNode.active=!0;var o=f.default.script.getWallPosY()+225;this.shieldNode.y=this.head.y-200<o?o:this.head.y-200,this.shieldNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!0)}},e.prototype.resumeBuff=function(t){var e=this;if(t==m.ballID.iceBall){var o=this.iceNode.getComponent(sp.Skeleton);o.setAnimation(0,"dj_3",!1),o.setCompleteListener(function(){e.iceNode.active=!1})}else t==m.ballID.vagueBall&&(this.shieldNode.active=!1)},e.prototype.resumeBallSkill=function(t){t==m.ballID.iceBall?(this.iceState=!1,this.resumeAnimation()):t==m.ballID.fireBall?(this.fireState=!1,this.changeFire()):t==m.ballID.windBall?this.moveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed):t==m.ballID.vagueBall&&(this.vagueNum=1),this.resumeBuff(t)},e.prototype.doFireLose=function(t){if(this.fireTime-=t,this.fireTime<0)for(var e in this.fireTime=this.onceTime,this.colliderArr)this.colliderArr[e].getComponent(y.default).doFireDamage(this.fireNum*this.vagueNum)},e.prototype.createFireNode=function(t,e){this.fireNodeArr=[],this.fireNodePos=[];var o=cc.winSize.height/2+this.fireNode.height/2+50,i=this.fireNode.width-100,n=this.fireNode.height;this.haveFireNode=3;for(var a=-1;a<=1;a++)this.fireNodePos.push(new cc.Vec2(i*a+0,n*Math.abs(a)+o));for(this.fireNodePos[2].y-=100,a=0;a<this.fireNodePos.length;a++){var r=cc.instantiate(this.fireNode);r.parent=this.fireNode.parent,r.setPosition(this.fireNodePos[a]),r.getComponent(_.default).initParam(t,e),this.fireNodeArr.push(r)}},e.prototype.fireNodeDestroy=function(){this.haveFireNode--},e.prototype.skillPause=function(){this.skillState=!0},e.prototype.skillResume=function(){this.skillState=!1},e.prototype.stop=function(){this.ballpState=!0,this.stopAnimation()},e.prototype.stopAnimation=function(){for(var t in this.head.getComponent(g.default).stop(),this.bodyArr)this.bodyArr[t].getComponent(g.default)&&this.bodyArr[t].getComponent(g.default).stop()},e.prototype.resumeAnimation=function(){if(!this.iceState)for(var t in this.head.getComponent(g.default).resume(),this.bodyArr)this.bodyArr[t].getComponent(g.default)&&this.bodyArr[t].getComponent(g.default).resume()},e.prototype.resume=function(){this.ballpState=!1,this.lastTime=Date.now(),this.resumeAnimation()},e.prototype.getTurn=function(){return new cc.Vec2(200,this.gapY/2)},e.prototype.initBanner=function(t){var e=this;this.ballBanner.active=!0,this.ballBanner.getComponentInChildren(cc.Label).string=t+"\u5df2\u51fa\u73b0\uff0c\u5f00\u59cb\u62a2\u593a\uff01",this.bannerGapTime||(this.bannerGapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.tipsStayTime)),this.scheduleOnce(function(){e.ballBanner.active=!1},this.bannerGapTime)},e.prototype.createPath=function(){for(var t=-this.bgNode.width/2-30,e=cc.winSize.height/2-100,o=this.bgNode.width,i=f.default.script.getWallPosY(),n=this.bgNode.height/2+i,a=-this.bgNode.height/2+n,r=0;e>a;r++){for(var s=0;s<3;s++){var c=void 0;if(r%2==0){var l=2==s?this.gapX:0,p=2==s?this.gapY/2:0,u=0==s?t+l:t+o+l;c=new cc.Vec2(u,e-p)}else l=2==s?this.gapX:0,p=2==s?this.gapY/2:0,u=0==s?-t+l:-t-o-l,c=new cc.Vec2(u,e-p);if(Math.abs(c.y-i)<=100){for(;this.path.length<3*r+s+1;)this.path.push(new cc.Vec2(0,i));return void(this.path[this.path.length-1]=new cc.Vec2(0,i))}this.path.push(c)}e-=this.gapY}this.path[this.path.length-1]=new cc.Vec2(0,i)},e.prototype.changeSpeed=function(t,e){var o=Number(e);o<0?this.ballCtrl.test():this.moveSpeed=o},e.prototype.start=function(){this.head.zIndex=1e3,this.head.setPosition(this.path[0].x-200,this.path[0].y),this.head.getComponent(g.default).startBALL(this.path,-1,0,0),this.bodyArr.push(this.head)},e.prototype.getHeadY=function(){var t=9999;return t=Math.min(t,this.head.y),t=Math.min(t,this.ballNode.y),t=Math.min(t,this.fireNode.y),this.head.y},e.prototype.getHeadNode=function(){return this.head},e.prototype.createNode=function(t){this.isLast||(this.moveWidth-=this.moveSpeed*t,this.lastMoveTime+=Number(t.toFixed(4)),this.moveWidth<=0&&(this.moveWidth+=this.shouldMove,this.createBody()))},e.prototype.initBodyGapTime=function(){this.AnimationGapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniTime)},e.prototype.createBody=function(){this.num>=9&&!u.Global.canAttack&&(u.Global.canAttack=!0),this.num%8==0&&(this.boxTemp&&this.boxTemp.getComponent(y.default).setCanBeAttack(),this.boxTemp=p.PoolMgr.getInstance().getNode(u.poolName.box),this.boxTemp||(this.boxTemp=cc.instantiate(this.boxNode)),this.nowIndex++,this.boxTemp.parent=this.hpParent,this.boxTemp.active=!0);var t=this.nowIndex%4;this.checkLength()&&(t=4,this.isLast=!0);var e=this.boxTemp.getComponent(y.default),o=h.default.getInstance().getLevelCfgByID(this.nowIndex),i=p.PoolMgr.getInstance().getNode(u.poolName.body);i||(i=cc.instantiate(this.player)),i.active=!0,i.parent=this.playerParent,this.bodyArr.push(i);var n=i.getComponent(g.default);n.setPreNode(this.lastNode,this.shouldMove);var a=Number((Date.now()/1e3).toFixed(2));this.NeedDoAnimationTime+=this.AnimationGapTime;var r=this.NeedDoAnimationTime-(a-this.FirstAnimationTime);n.doAnimation(r),this.fireState&&n.changeFireState();var s=this.lastNode.getComponent(g.default).getIndex();this.num%8==0&&(this.lastMoveTime=0),n.startBALL(this.path,t,0,s),this.lastNode=i,e.addOtherNode(i),this.num%4==0&&this.num%8!=0&&(this.checkLength(1)?e.initNode(i,o.dragonHp,this.nowIndex,!0):e.initNode(i,o.dragonHp,this.nowIndex,!1),this.colliderArr.push(this.boxTemp)),i.zIndex=2e3-this.num++,this.isFirst&&(this.isFirst=!1)},e.prototype.doAnimation=function(t){if(this.nowTime>0)this.nowTime-=t;else{var e=this.bodyArr[this.animationIndex];e&&(this.animationIndex++,e.getComponent(g.default).doAnimation(),this.nowTime+=this.gapTime)}},e.prototype.checkLength=function(t){return void 0===t&&(t=0),this.nowIndex>=h.default.getInstance().getLevelCfg().length-t},e.prototype.checkCollider=function(t,e,o){var i=null,n=-1;for(var a in e!=this.ballIndex&&-1==n&&this.ballNode.getComponent(m.default).checkCollider(t)&&(i=this.ballNode.getComponent(m.default),n=this.ballIndex),this.fireNodeArr){if(-1!=n)break;var r=this.fireIndex+Number(a),s=this.fireNodeArr[a];e!=r&&s.getComponent(_.default).checkCollider(t)&&(i=s.getComponent(_.default),n=r)}for(var a in this.colliderArr){if(-1!=n)break;if(Number(a)!=e){var c=this.colliderArr[a].getComponent(y.default);c.checkCollider(t)&&(i=c,n=Number(a))}}return-1!=n&&this.handleAttack(o,i),n},e.prototype.handleAttack=function(t,e){var o=t.getDamageProperty(),i=Math.floor(o.damage*this.vagueNum);e.handleDamage(i,o.pos,o.isCrit,o.timer,o.timer>1)},e.prototype.checkSkillCollider=function(t,e){for(var o in e*=this.vagueNum,e=Math.floor(e),this.ballNode.getComponent(m.default).checkSkillCollider(t,e),this.fireNodeArr)this.fireNodeArr[o].getComponent(_.default).checkSkillCollider(t,e);for(var o in this.colliderArr)this.colliderArr[o].getComponent(y.default).checkSkillCollider(t,e)},e.prototype.moveBody=function(t){for(var e=0;e<this.bodyArr.length;e++){var o=this.bodyArr[e];o?o.getComponent(g.default).onUpdate(t,this.moveSpeed):(this.bodyArr.splice(e,1),e--)}},e.prototype.update=function(t){if(!this.ballpState){if(!this.skillState&&!this.iceState){if(this.haveFireNode)for(var e=0;e<this.fireNodeArr.length;e++)this.fireNodeArr[e].getComponent(_.default).onUpdate(t);this.createNode(t),this.moveBody(t)}this.fireState&&this.doFireLose(t);var o=Date.now(),i=(o-this.lastTime)/1e3;this.ballCtrl.onUpdate(i),this.lastTime=o}},c([I(cc.Animation)],e.prototype,"animation",void 0),c([I(cc.Node)],e.prototype,"head",void 0),c([I(cc.Node)],e.prototype,"playerParent",void 0),c([I(cc.Node)],e.prototype,"box",void 0),c([I(cc.Node)],e.prototype,"hpParent",void 0),c([I(cc.Node)],e.prototype,"boxNode",void 0),c([I(cc.Node)],e.prototype,"player",void 0),c([I(cc.Node)],e.prototype,"bgNode",void 0),c([I(cc.Node)],e.prototype,"ballNode",void 0),c([I(cc.Node)],e.prototype,"fireNode",void 0),c([I(cc.Node)],e.prototype,"ballBanner",void 0),c([I(cc.Node)],e.prototype,"iceNode",void 0),c([I(cc.Node)],e.prototype,"shieldNode",void 0),c([I({tooltip:"\u4fe9\u6392\u9f99\u4e4b\u95f4\u7684\u95f4\u9694"})],e.prototype,"gapY",void 0),c([I({tooltip:"\u8f6c\u5f2f\u5904\u79bb\u5c4f\u5e55\u7684\u8ddd\u79bb"})],e.prototype,"gapX",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BALL_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"87b269HPw1Jg7kJsDns0OPU","BALL_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"87b269HPw1Jg7kJsDns0OPU","BALL_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("Utils"),d=i("BALL_Configs"),h=i("BALLGameEnumData"),f=i("BALL_DataMgr"),m=i("BALL_UIGame"),g=i("BALL_Hero"),y=i("BALL_HeroCtrl"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t,e){this.name=t,this.weight=e},I=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.nodeObj1=new I,e.nodeObj2=new I,e.lock=!0,e}return s(e,t),e.prototype.initNode=function(t){this.node.active=!1;var e=f.default.getInstance().getLevelCfgByID(t);if(e){if(e.buffType)if(1==e.buffType){var o=this.getResult(),i=this.getResult(),n=this.getPropertyResultArr(o,i,e);(0==o||1==o||2==o)&&this.initPropertyNode(o,n[0],this.node1,this.nodeObj1),(0==i||1==i||2==i)&&this.initPropertyNode(i,n[1],this.node2,this.nodeObj2)}else if(2==e.buffType){if(0==(o=this.getResult())){var a=this.getPropertyResult(e.buff1,o);this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)}else 1==o?(a=this.getPropertyResult(e.buff2?e.buff2:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)):2==o&&(a=this.getPropertyResult(e.buff3?e.buff3:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1));var r=this.getNewRole();this.initNewNode(r[0],this.node2,this.nodeObj2)}else r=this.getNewRole(2),this.initNewNode(r[0],this.node1,this.nodeObj1),this.initNewNode(r[1],this.node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=d.Global.heroID.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getResult=function(){var t=f.default.getInstance().getBuffOddsCfgByAmount(d.Global.heroID.length),e=[],o=t.buff1Odds+t.buff2Odds+t.buff3Odds;e.push(t.buff1Odds),e.push(t.buff2Odds),e.push(t.buff3Odds);for(var i=Math.random()*o,n=0;n<e.length;n++)if((i-=e[n])<=0)return n},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t)),i=d.Global.heroID[e].node;if(3==d.Global.heroID[e].id){for(var n=0;n<o.length;n++)if(o[n].includes("penetrate")){o.splice(n,1);break}}else if(i.getComponent(g.default).getAttackSpeedState())for(n=0;n<o.length;n++)if(o[n].includes("speed")){o.splice(n,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=[],o=d.Global.heroID[0].id,i=d.Global.heroID[1]?d.Global.heroID[1].id:-1;for(var n in d.Global.heroID){var a=d.Global.heroID[n].id,r=f.default.getInstance().getMateOddsCfgByID(a);e=e.concat(this.createRoleLottery(r.mateOdds.split("|"),o,i))}for(var s=[];t--;){var c=Number(u.Utils.weight_rand(e).name);for(n=0;n<e.length;n++)c==Number(e[n].name)&&(e.splice(n,1),n--);s.push(c)}return s},e.prototype.createRoleLottery=function(t,e,o){var i=[];for(var n in t){var a=t[n].split(","),r=Number(a[0]),s=Number(a[1]);if(e!=r&&r!=o){var c=new B(r.toString(),s);i.push(c)}}return i},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=d.Global.heroID[t].id,r=f.default.getInstance().getCharacterByID(a);this.loadSpriteFrame(d.emBALLBundles.imgs,"js_b/"+r.image,function(r){n.initPropertyView(o,r,e,a),n.lock=!1,n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=f.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=d.Global.heroID[t].node,c.buffType==d.emBALLBuffType.speedPlus?i.type=1:c.buffType==d.emBALLBuffType.ATKmul||c.buffType==d.emBALLBuffType.ATKplus?i.type=2:c.buffType==d.emBALLBuffType.penetratePlus?i.type=3:c.buffType==d.emBALLBuffType.bulletPlus?i.type=4:c.buffType==d.emBALLBuffType.critPlus?i.type=5:c.buffType==d.emBALLBuffType.skillMul&&(i.type=6)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=f.default.getInstance().getCharacterByID(i).characterName,p=f.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon"),s=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emBALLBundles.imgs,"js_b/"+s.image,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.lock=!1,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=f.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffectFree(d.BALL_AudioId.buff),y.default.script.checkCollider()?this.nodeObj1.isNew?y.default.script.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?y.default.script.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.destroy()},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;1==o?e.getComponent(g.default).addAttackSpeed(t.addType,t.addNum):2==o?e.getComponent(g.default).addAttackPower(t.addType,t.addNum):3==o?e.getComponent(g.default).addAttackPenerate(t.addType,t.addNum):4==o?e.getComponent(g.default).addBulletCount(t.addType,t.addNum):5==o?e.getComponent(g.default).addCritChance(t.addType,t.addNum):6==o&&e.getComponent(g.default).addSkill(t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){this.addEvent(d.emBALLEventName.pause,this.ballp),this.addEvent(d.emBALLEventName.resume,this.resume)},e.prototype.ballp=function(){this.lock=!0},e.prototype.resume=function(){this.lock=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.lock||(this.node.y-=f.default.getInstance().getParam(h.enumBasicParaCfg.buffMove)*t*100,m.default.script.checkReWardLayer(this.node.y)&&this.doReward())},c([b(cc.Node)],e.prototype,"node1",void 0),c([b(cc.Node)],e.prototype,"node2",void 0),c([b(cc.SpriteFrame)],e.prototype,"sp",void 0),c([_],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BALL_Bullet2:[function(t,e,o){"use strict";cc._RF.push(e,"286efGxz/1CF6M26KugPVMi","BALL_Bullet2");var i=t,n=e,a=o;cc._RF.push(n,"286efGxz/1CF6M26KugPVMi","BALL_Bullet2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("BALL_Configs"),d=i("BALL_Body"),h=i("BALL_Hero"),f=function(t,e,o,i){this.damage=t,this.isCrit=e,this.pos=o,this.timer=i};a.damageObj=f;var m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDeballry=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e.timer=0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,f){if(void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===f&&(f=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDeballry=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.heroCtrl=c.getComponent(h.default),this.createNeedCheckY(),this.timer>1)for(var m in f)r=cc.instantiate(r),this.initNodeView(a,r,s,f[m]);else this.initNodeView(a,r,s)},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=d.default.script.getHeadY()-this.node.y},e.prototype.update=function(t){if(this.active&&!this.isDeballry){var e=this.flySpeed*t*100;if(this.node.y+=e,this.range-=e,this.needCheckY-=e,this.range<=0&&this.removeNode(),this.needCheckY<=0){var i=d.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(u.emBALLEventName.GAD_Show_Hit_Effect,n),this.lastAttackID=i,this.onDie()}}}},e.prototype.getDamageProperty=function(){return this.hit()},e.prototype.hit=function(){return this.damage=this.heroCtrl.getAttackPower(),this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new f(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition(),this.timer)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDeballry||(this.isDeballry=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)p.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start())},e.prototype.render=function(){},e.prototype.ballp=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},o=c([g],e)}(l.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BALL_Bullet3:[function(t,e,o){"use strict";cc._RF.push(e,"2a6a2xqUgNBQLC91JgiVVr8","BALL_Bullet3");var i=t,n=e,a=o;cc._RF.push(n,"2a6a2xqUgNBQLC91JgiVVr8","BALL_Bullet3");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BALL_Configs"),p=i("BALL_UIGame"),u=i("BALL_Body"),d=i("BALL_Bullet2"),h=i("Utils"),f=i("BALL_DataMgr");a.damageObj=function(t,e,o){this.damage=t,this.isCrit=e,this.pos=o};var m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.angle=0,e.degree=10,e.onlyWall=!1,e.needBounce=!1,e.basePenarate=0,e.disappearTime=0,e.readyBounce=!1,e}var o;return s(e,t),o=e,e.prototype.initNode=function(e,o,i,n,a,r,s,c,p,u,d,h,m,g){void 0===n&&(n=.2),void 0===a&&(a=2),void 0===m&&(m=1),void 0===g&&(g=[]),t.prototype.initNode.call(this,e,o,i,n,a,r,s,c,p,u,d,h,m,g);var y=Number(d.split("bullet")[1]);if(3!=y&&17!=y||(this.needBounce=!0),this.needBounce){this.initAngle(),this.lastDir=l.bulletDir.None;var v=f.default.getInstance().getCharacterByID(y);this.disappearTime=v.disappearTime,this.degree=v.hitTimes?v.hitTimes:10,this.flySpeed=v.bulletSpeed?v.bulletSpeed:o,3==y?this.onlyWall=!0:(this.onlyWall=!1,this.basePenarate=i)}},e.prototype.resume=function(){if(t.prototype.resume.call(this),this.needBounce&&!this.onlyWall)for(var e in this.prefab)this.prefab[e].children[0].getComponent(cc.Animation).resume()},e.prototype.ballp=function(){if(t.prototype.ballp.call(this),this.needBounce&&!this.onlyWall)for(var e in this.prefab)this.prefab[e].children[0].getComponent(cc.Animation).pause()},e.prototype.initAngle=function(){var t=h.Utils.randomRang(-45,45);this.angle=t;var e=(t+90)*(Math.PI/180),o=new cc.Vec3(Math.cos(e),Math.sin(e),0);this.velocity=o.multiplyScalar(100*this.flySpeed),this.changeAngle()},e.prototype.changeAngle=function(){for(var t in this.lastAttackID=-1,this.prefab)this.prefab[t].angle=this.angle},e.prototype.onDie=function(){this.needBounce?(this.degree--,this.onlyWall||(this.penetrate--,this.penetrate<0&&this.bounceWithDragon()),this.degree>=0||this.removeNode()):t.prototype.onDie.call(this)},e.prototype.bounceWithDragon=function(){this.penetrate=this.heroCtrl.getPenetrate(),this.lastDir=l.bulletDir.None,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()},e.prototype.overSide=function(t,e){if(this.readyBounce){var o=!1;t.x<e.leftBoundary-100&&(o=!0),t.x>e.rightBoundary+100&&(o=!0),t.y<e.downBoundary-100&&(o=!0),t.y>e.upBoundary+100&&(o=!0),o&&this.removeNode()}},e.prototype.disAppearNode=function(t){this.disappearTime-=t,this.disappearTime<=0&&this.removeNode()},e.prototype.onLoad=function(){},e.prototype.update=function(e){if(this.needBounce){if(this.active&&!this.isDeballry){this.disAppearNode(e);var i=this.velocity.clone().multiplyScalar(e);this.node.setPosition(this.node.position.add(i));var n=p.default.script.getBulletBoundary(),a=this.node.position;a.y>n.downBoundary&&(this.readyBounce=!0),this.readyBounce&&(this.overSide(a,n),a.x<n.leftBoundary&&this.lastDir!=l.bulletDir.left&&(this.lastDir=l.bulletDir.left,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),a.x>n.rightBoundary&&this.lastDir!=l.bulletDir.right&&(this.lastDir=l.bulletDir.right,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),a.y<n.downBoundary&&this.lastDir!=l.bulletDir.down&&(this.lastDir=l.bulletDir.down,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()),a.y>n.upBoundary&&this.lastDir!=l.bulletDir.up&&(this.lastDir=l.bulletDir.up,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()));var r=u.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(r>=0){var s=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(l.emBALLEventName.GAD_Show_Hit_Effect,s),this.lastAttackID=r,this.onDie()}}}else t.prototype.update.call(this,e)},o=c([g],e)}(d.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BALL_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"36e13eTPtpM14YCHQQLUjB3","BALL_BulletEffect");var i=e,n=o;cc._RF.push(i,"36e13eTPtpM14YCHQQLUjB3","BALL_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.show()},e.prototype.hide=function(){this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.node.active=!1,t.resetSystem()})},e.prototype.show=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],BALL_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"ae4feItU4BIOq/O8LJ9gF1w","BALL_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"ae4feItU4BIOq/O8LJ9gF1w","BALL_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.bulletDir=l.emBALLHitState=l.poolName=l.emBALLBuffType=l.emBALLGameState=l.emBALLRoleState=l.emBALLRoleType=l.emBALLEventName=l.BALL_AudioCF=l.BALL_AudioId=l.BALL_UICF=l.BALLConfig=l.emBALLBundles=l.BALL_UIID=void 0,function(t){t.UIGame="BALL_UIGame",t.UIResult="BALL_UIResult",t.UISetting="BALL_UISetting"}(a=l.BALL_UIID||(l.BALL_UIID={})),function(t){t.prefabs="ball_prefabs",t.audios="ball_audios",t.imgs="ball_imgs",t.configs="ball_configs",t.configsB="ball_configsB"}(r=l.emBALLBundles||(l.emBALLBundles={})),l.BALLConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.BALL_UICF=((i={})[a.UIGame]={prefab:"ui/BALL_UIGame",name:"BALL_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/BALL_UIResult",name:"BALL_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/BALL_UISetting",name:"BALL_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.ballgonHit="dragonHit",t.rake="rake",t.typhoon="typhoon",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.barrier="barrier",t.dragonBallGet="dragonBallGet",t.dragonBallShow="dragonBallShow",t.electric="electric",t.fireball="fireball",t.ice="ice",t.icebreak="icebreak",t.lightningBullet="lightningBullet",t.magic="magic",t.wind="wind",t.moon="moon",t.boomerang="boomerang",t.boom="boom",t.moonGod="moonGod",t.doubleSword="doubleSword",t.lotus="lotus",t.summon="summon",t.bluePalm="bluePalm"}(s=l.BALL_AudioId||(l.BALL_AudioId={})),l.BALL_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.ballgonHit]={path:"dragonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.dragonBallGet]={path:"dragonBallGet",bundle:r.audios},n[s.barrier]={path:"barrier",bundle:r.audios},n[s.dragonBallShow]={path:"dragonBallShow",bundle:r.audios},n[s.electric]={path:"electric",bundle:r.audios},n[s.fireball]={path:"fireball",bundle:r.audios},n[s.ice]={path:"ice",bundle:r.audios},n[s.icebreak]={path:"icebreak",bundle:r.audios},n[s.lightningBullet]={path:"lightningBullet",bundle:r.audios},n[s.magic]={path:"magic",bundle:r.audios},n[s.wind]={path:"wind",bundle:r.audios},n[s.moon]={path:"moon",bundle:r.audios},n[s.boomerang]={path:"boomerang",bundle:r.audios},n[s.boom]={path:"boom",bundle:r.audios},n[s.moonGod]={path:"moonGod",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.summon]={path:"summon",bundle:r.audios},n[s.bluePalm]={path:"bluePalm",bundle:r.audios},n),function(t){t.GAD_Player_Die="ball_gad_player_die",t.GAD_Shoot_Bullet="ball_gad_shoot_bullet",t.GAD_Show_Hit_Text="ball_gad_show_hit_text",t.GAD_Show_Warn="ball_gad_show_warn",t.GAD_Bubble_Buf="ball_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="ball_gad_hit_effect",t.GAD_Show_Buff_Tip="ball_gad_show_buff_tip",t.GAD_Setting_Back="ball_gad_setting_back",t.pause="ball_pause",t.resume="ball_resume",t.skillPause="ball_skillPause",t.skillResume="ball_skillResume",t.buff="ball_buff",t.blood="ball_blood",t.newTarm="ball_newTarm",t.ball_loot="ball_loot",t.ball_tips="ball_tips"}(l.emBALLEventName||(l.emBALLEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emBALLRoleType||(l.emBALLRoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emBALLRoleState||(l.emBALLRoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emBALLGameState||(l.emBALLGameState={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emBALLBuffType||(l.emBALLBuffType={})),function(t){t.blood="ball_blood",t.destroy="ball_destroy",t.effect="ball_effect",t.box="ball_box",t.body="ball_body",t.ball_item="ball_item",t.ball_bullet="ball_bullet",t.newball_bullet="newball_bullet",t.BALL_Bullet_skill="BALL_Bullet_skill"}(l.poolName||(l.poolName={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emBALLHitState||(l.emBALLHitState={})),function(t){t.None="None",t.up="up",t.down="down",t.left="left",t.right="right"}(l.bulletDir||(l.bulletDir={}));var p=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t.isBug=!1,t}();l.Global=p,cc._RF.pop(),cc._RF.pop()},{}],BALL_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"3d2c5LIoXNCdJ3/PQdXoW91","BALL_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"3d2c5LIoXNCdJ3/PQdXoW91","BALL_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("BALL_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}e?i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_ball/configsB",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emBALLBundles.configsB,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()}):i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_ball/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emBALLBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getDragonBallShowCfg=function(){return this.data.dragonBallShowCfg},t.prototype.getDragonBallCfg=function(){return this.data.dragonBallCfg},t.prototype.getDragonBallCfgBYid=function(t){var e=this.data.dragonBallCfg;for(var o in e)if(e[o].dragonBallID==t)return e[o]},t.prototype.getMateOddsCfgByID=function(t){var e=this.data.mateOddsCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getBuffOddsCfgByAmount=function(t){var e=this.data.buffOddsCfg;for(var o in e)if(e[o].charAmount==t)return e[o]},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BALL_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1b6e9CqL7ZJFbznhjPdKk03","BALL_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1b6e9CqL7ZJFbznhjPdKk03","BALL_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("BALL_Configs"),d=i("BALL_DataMgr"),h=i("BALL_Hero"),f=i("BALL_SkillCtrl"),m=i("BALL_TarmCtrl"),g=i("ball"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e){this.id=t,this.node=e},B=function(t,e){this.cfg=t,this.state=e},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPuase=!1,e.isBallLock=!1,e.ballArr=[],e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;o.script=this,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.heroRoot.x+=o})},e.prototype.heroMove=function(t){this.heroRoot.x+=t},e.prototype.test=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).addAttackPower(2,5);else if("speed"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).addAttackSpeed(1,4);else if("penerate"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).addAttackPenerate(1,1);else if("fire"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).changeFire()}else this.addHero(Number(e))},e.prototype.doBallSkill=function(t,e){e.dragonBallID==g.ballID.iceBall?this.heroDoSkill(e):e.dragonBallID==g.ballID.thunderBall?(t==g.ballState.dragon&&(this.isBallLock=!0),this.heroDoSkill(e,t)):e.dragonBallID==g.ballID.windBall?this.heroDoSkill(e):e.dragonBallID==g.ballID.vagueBall&&(this.heroDoSkill(e),f.default.script.changeDelayTime(e.playerGetPara1));var o=new B(e,t);this.ballArr.push(o)},e.prototype.heroDoSkill=function(t,e){for(var o in void 0===e&&(e=g.ballState.None),u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).doBallSkill(t,e)},e.prototype.heroResumeSkill=function(t){t==g.ballID.thunderBall?(this.isBallLock=!1,p.AudioMgr.getInstance().playEffect(u.BALL_AudioId.electric,"skillBuff")):t==g.ballID.vagueBall&&f.default.script.resumeDelayTime();for(var e=0;e<this.ballArr.length;e++)this.ballArr[e].cfg.dragonBallID==t&&(this.ballArr.splice(e,1),e--);for(var e in u.Global.heroID)u.Global.heroID[e].node.getComponent(h.default).resumeBallSkill(t)},e.prototype.getBallLock=function(){return this.isBallLock},e.prototype.getBallSkill=function(t){for(var e in this.ballArr)t.getComponent(h.default).doBallSkill(this.ballArr[e].cfg,this.ballArr[e].state)},e.prototype.addFirstHero=function(){for(var t=d.default.getInstance().getCharacter(),e=[],o=0;o<t.length;o++)14!=t[o].characterID&&e.push(t[o].characterID);var i=Math.floor(Math.random()*e.length);this.addHero(e[i])},e.prototype.addHero=function(t){var e=this;if(u.Global.heroID.length>=3)console.error("\u4e0d\u5141\u8bb8\u52a0\u5165\u8d85\u8fc7\u4e09\u4e2a\u82f1\u96c4");else{u.Global.heroID||(u.Global.heroID=[]),this.node.getComponent(m.default).pushCard(t);var o=cc.instantiate(this.heorNode);o.active=!0,o.parent=this.node;var i=new b(t,o);u.Global.heroID.push(i),o.getComponent(h.default).initHero(t),this.getBallSkill(o),this.scheduleOnce(function(){e.checkOverSide()},.01)}},e.prototype.addTempHero=function(t,e,o,i,n){var a=cc.instantiate(this.heorNode);a.active=!0;var r=a.getComponent(h.default);a.parent=this.node,r.initHero(t),r.initTempHero(t,e,o,n,i)},e.prototype.clearHero=function(){u.Global.heroID=[]},e.prototype.getMaxDamage=function(t,e){var o=0;for(var i in u.Global.heroID)u.Global.heroID[i].id!=t&&u.Global.heroID[i].id!=e||(o=Math.max(u.Global.heroID[i].node.getComponent(h.default).getAttackPower(),o));return o},e.prototype.checkOverSide=function(){this.heroRoot.x+this.node.width/2>cc.winSize.width/2?this.heroRoot.x=cc.winSize.width/2-this.node.width/2:this.heroRoot.x-this.node.width/2<-cc.winSize.width/2&&(this.heroRoot.x=-cc.winSize.width/2+this.node.width/2)},e.prototype.checkCollider=function(){return this.node.x<0},e.prototype.start=function(){},c([_(cc.Node)],e.prototype,"heroRoot",void 0),c([_(cc.Node)],e.prototype,"heorNode",void 0),o=c([v],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],BALL_Hero:[function(t,e,o){"use strict";cc._RF.push(e,"e5e5eMDUgdNG7278rTdBiqW","BALL_Hero");var i=t,n=e,a=o;cc._RF.push(n,"e5e5eMDUgdNG7278rTdBiqW","BALL_Hero");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("BALL_Configs"),h=i("BALLGameEnumData"),f=i("BALL_DataMgr"),m=i("BALL_UIGame"),g=i("BALL_Bullet2"),y=i("BALL_Bullet3"),v=i("BALL_BulletEffect"),_=i("BALL_SkillCtrl"),b=i("ball"),B=i("BALL_Body"),I=cc._decorator,P=I.ccclass,C=I.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.rawBulletCount=1,e.firing=!1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.bullets=[],e.skillTimer=0,e.bulletPrefabSkillName="BALL_Bullet_skill",e.skillMultiplier=0,e.maxSpeed=12,e.ballSubSpeed=1,e.ballAddSpeed=1,e.ballSubSkillCD=-1,e.thunderLock=!1,e.thunderState=!1,e.noInFactSpeed=5,e.speedInfactTimer=1,e.maxBulletNum=99999,e.rawMaxBulletNum=99999,e.isNewHero=!1,e.isTemp=!1,e.tempTime=0,e.lastFireTime=0,e.fireCooldown=.5,e.audioID=0,e}return s(e,t),e.prototype.initHero=function(t){this.initParm(t),this.initView(t),this.heroIndex=t,this.addEvent(d.emBALLEventName.pause,this.doPause),this.addEvent(d.emBALLEventName.resume,this.doResume)},e.prototype.initParm=function(t){1==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.basicATK):2==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.secondCharATK):3==d.Global.heroID.length&&(this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.thirdCharATK)),3==t?(this.maxBulletNum=f.default.getInstance().getParam(h.enumBasicParaCfg.changeLimit),this.isNewHero=!0):17==t?(this.maxBulletNum=f.default.getInstance().getParam(h.enumBasicParaCfg.sunsxLimit),this.isNewHero=!0):(this.maxBulletNum=99999,this.isNewHero=!1),this.rawMaxBulletNum=this.maxBulletNum,this.attackSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.basicASPD),this.bulletCount=f.default.getInstance().getParam(h.enumBasicParaCfg.basicBullet),this.penetrate=f.default.getInstance().getParam(h.enumBasicParaCfg.basicPenetrate),this.flySpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.bulletFlySpeed),this.critChance=f.default.getInstance().getParam(h.enumBasicParaCfg.basicCrit),this.critMultiplier=f.default.getInstance().getParam(h.enumBasicParaCfg.critDamage);var e=f.default.getInstance().getCharacterByID(t);this.skillInterval=e.skillCDtime,this.ballSubSkillCD=-1,this.skillMultiplier=e.skillATK,this.skillEffect=e.skillSound,this.speedInfactTimer=e.characterASPD,this.rawBulletCount=this.bulletCount,this.isTemp=!1},e.prototype.initView=function(t){var e=this;this.loadPrefab(d.emBALLBundles.prefabs,"bullets/BALL_Bullet_"+t,function(o){e.poolName="bullet"+t,u.PoolMgr.getInstance().creatrePool(e.poolName,cc.instantiate(o)),e.bulletPrefab=o,e.startFiring()}),this.bulletNodeSkill=u.PoolMgr.getInstance().getNode(d.poolName.BALL_Bullet_skill);var o=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emBALLBundles.imgs,"backs/"+o.cardColor,function(t){e.itemBg.spriteFrame=t}),this.loadSpriteFrame(d.emBALLBundles.imgs,"js/js_"+t,function(t){e.itemIcon.spriteFrame=t}),this.loadSpriteFrame(d.emBALLBundles.imgs,"skill/"+o.skillIcon,function(t){e.itemSkill.spriteFrame=t}),this.loadPrefab(d.emBALLBundles.prefabs,"skills/"+o.skill,function(o){e.heroSkill=cc.instantiate(o),11==t&&e.loadPrefab(d.emBALLBundles.prefabs,"skills/CardSkill"+t,function(){})}),this.itemName.string=o.characterName},e.prototype.startFiring=function(){this.firing=!0},e.prototype.ballpFiring=function(){this.firing=!1},e.prototype.changeFire=function(){this.firing=!this.firing},e.prototype.initTempHero=function(t,e,o,i,n){this.attackPower=e,this.heroIndex=t,this.attackSpeedMultiplier=o,this.bulletCount=i,this.isTemp=!0,this.tempTime=n},e.prototype.doBallSkill=function(t,e){void 0===e&&(e=b.ballState.None),this.isTemp||(t.dragonBallID!=b.ballID.thunderBall&&this.showBuff(t.dragonBallID),t.dragonBallID==b.ballID.iceBall?this.ballSubSpeed=t.dragonGetPara1:t.dragonBallID==b.ballID.thunderBall?e==b.ballState.dragon?(this.thunderLock=!0,this.showBuff(t.dragonBallID)):e==b.ballState.player&&(this.thunderState=!0):t.dragonBallID==b.ballID.windBall?(this.ballAddSpeed=t.playerGetPara1,this.maxBulletNum=2*this.rawMaxBulletNum):t.dragonBallID==b.ballID.vagueBall&&(this.ballSubSkillCD=t.playerGetPara1,this.isChangeCD()))},e.prototype.resumeBallSkill=function(t){if(!this.isTemp){if(t==b.ballID.iceBall)this.ballSubSpeed=1;else if(t==b.ballID.thunderBall)this.thunderLock=!1,this.thunderState=!1;else if(t==b.ballID.windBall)this.ballAddSpeed=1,this.maxBulletNum=this.rawMaxBulletNum;else if(t==b.ballID.vagueBall){if(-1==this.ballSubSkillCD)return;this.ballSubSkillCD=-1,this.isChangeCD()}this.doResumeBuff(t)}},e.prototype.isChangeCD=function(){var t=this.skillPercent.fillRange;this.skillTimer=this.infactCD*t},e.prototype.useSkill=function(){var t=m.default.script.getSkillLayer(),e=this.bulletPos.getPosition(),o=this.bulletPos.convertToWorldSpaceAR(e);return e=t.convertToNodeSpaceAR(o),_.default.script.useSkill(this.heroIndex,Math.floor(this.attackPower*this.skillMultiplier),this.heroSkill,e)},e.prototype.addAttackPower=function(t,e){this.addBuffTween(),1==t?this.attackPower+=e:this.attackPower*=e},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.getBulletCount=function(){return this.bulletCount},e.prototype.getSpeed=function(){return this.attackSpeedMultiplier},e.prototype.changeSkillInterval=function(t,e){this.addBuffTween();var o=this.skillInterval*(1-t);(o=Number(o.toFixed(2)))<e&&(o=e),this.skillInterval=o,this.cdTime.getComponent(cc.Label).string=this.skillInterval+""},e.prototype.addAttackSpeed=function(t,e){this.addBuffTween(),this.getAttackSpeedState()||(this.attackSpeedMultiplier+=e/f.default.getInstance().getParam(h.enumBasicParaCfg.speedPlusTimes))},e.prototype.getAttackSpeedState=function(){return this.attackSpeedMultiplier>=this.maxSpeed},e.prototype.addAttackPenerate=function(t,e,o,i){this.addBuffTween(),1==t?this.penetrate+=e:2==t?this.penetrate*=e:3==t&&(this.penetrate+e>o?this.addAttackSpeed(1,i):this.penetrate+=e)},e.prototype.getPenetrate=function(){return this.penetrate},e.prototype.addCritChance=function(t,e){this.addBuffTween(),1==t?this.critChance+=e:2==t?this.critChance*=e:3==t&&(this.critChance>=1?this.addBulletCount(1,1):this.critChance+=e)},e.prototype.showBuff=function(t){var e;t==b.ballID.windBall?e=this.windSp:t==b.ballID.thunderBall?e=this.thunderSp:t==b.ballID.vagueBall?e=this.vagueSp:t==b.ballID.iceBall&&(e=this.iceSp),e&&this.doShowBuff(e)},e.prototype.doShowBuff=function(t){var e=t.getComponent(sp.Skeleton);t.active=!0,e&&e.setAnimation(0,"animation",!0)},e.prototype.doResumeBuff=function(t){var e;t==b.ballID.windBall?e=this.windSp:t==b.ballID.thunderBall?e=this.thunderSp:t==b.ballID.vagueBall?e=this.vagueSp:t==b.ballID.iceBall&&(e=this.iceSp),e&&(e.active=!1)},e.prototype.addSkill=function(t,e){this.addBuffTween(),1==t?this.skillMultiplier+=e:2==t?this.skillMultiplier*=e:3==t&&(this.critChance>=1?this.addBulletCount(1,1):this.critChance+=e)},e.prototype.addBulletCount=function(t,e){this.addBuffTween(),1==t?this.bulletCount+=e:this.bulletCount*=e,this.rawBulletCount=this.bulletCount},e.prototype.addBuffTween=function(){var t=this;this.addBuffSp.opacity=255,this.addBuffSp.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.addBuffSp.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.addBuffSp.opacity=0},.1)})},e.prototype.getAttackSpeed=function(){var t=this.attackSpeedMultiplier*this.ballAddSpeed/this.ballSubSpeed;return(t*=this.speedInfactTimer)<this.speedInfactTimer&&(t=this.speedInfactTimer),this.attackSpeed/t},e.prototype.updateSkillView=function(){this.isTemp||(this.skillPercent.fillRange=this.skillTimer/this.infactCD)},Object.defineProperty(e.prototype,"infactCD",{get:function(){return-1==this.ballSubSkillCD?this.skillInterval:this.ballSubSkillCD},enumerable:!1,configurable:!0}),e.prototype.update=function(t){var e=this;if(this.firing&&d.Global.canAttack&&(!this.thunderLock||this.isTemp)){if(this.nowAttackTime+=t,this.skillTimer+=t,this.isTemp&&(this.tempTime-=t,this.tempTime<=0)){var o=m.default.script.getBulletLayer(this.heroIndex).children;for(var i in o)o[i].removeFromParent();this.node.removeFromParent(),this.tempTime=0,this.isTemp=!1}if(this.updateSkillView(),this.skillTimer>=this.infactCD){if(this.isTemp)return;this.useSkill()&&(this.skillSp.opacity=255,p.AudioMgr.getInstance().playEffect(this.skillEffect,this.skillEffect),this.skillSp.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.skillSp.getComponent(sp.Skeleton).setCompleteListener(function(){e.scheduleOnce(function(){e.skillSp.opacity=0},.1)}),this.skillTimer=0)}this.nowAttackTime-this.lastAttackTime>this.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime)}},e.prototype.checkIsInfact=function(){return this.attackSpeedMultiplier<this.noInFactSpeed||1==this.bulletCount||3==this.heroIndex||17==this.heroIndex},e.prototype.fireBullets=function(){this.audioID=(this.audioID+1)%5;var t=m.default.script.getBulletLayer(this.heroIndex),e=this.bulletPos.getPosition();if(this.thunderState){var o=u.PoolMgr.getInstance().getNode(this.bulletPrefabSkillName)||cc.instantiate(this.bulletNodeSkill);this.doThunderBullet(o,t,e),p.AudioMgr.getInstance().playEffect(d.BALL_AudioId.lightningBullet,"bullet"+this.heroIndex+this.audioID)}else{p.AudioMgr.getInstance().playEffect(d.BALL_AudioId.bullet,"bullet"+this.heroIndex+this.audioID);for(var i=t.children.length+this.bulletCount-this.maxBulletNum,n=0;i>0;)t.children[n++].getComponent(y.default).removeNode(),i--;this.checkIsInfact()?this.creatInfactBullet(t,e):this.creatNoInfactBullet(t,e)}},e.prototype.doThunderBullet=function(t,e,o){var i=this,n=this.bulletPos.convertToWorldSpaceAR(o);t.parent=m.default.script.getBulletSkill(),o=e.convertToNodeSpaceAR(n),t.setPosition(o),t.active=!0,B.default.script.checkSkillCollider(this.getWorldColldierRect(t,0,0),Math.floor(this.attackPower*this.bulletCount)),t.getChildByName("bullet").getComponent(cc.Animation).play(),this.scheduleOnce(function(){t.active=!1,u.PoolMgr.getInstance().freeNode(i.bulletPrefabSkillName,t)},.07)},e.prototype.getWorldColldierRect=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var i=t.getAnchorPoint(),n=t.parent.convertToWorldSpaceAR(t.position),a=(t.width+e)*t.scaleX,r=(t.height+o)*t.scaleY;return cc.rect(n.x-i.x*a,n.y-i.y*r,a,r)},e.prototype.creatInfactBullet=function(t,e){this.isNewHero&&1!=this.ballAddSpeed?this.bulletCount=this.bulletCount>3?3:this.bulletCount:this.bulletCount=this.rawBulletCount;for(var o=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,i=0;i<this.bulletCount;i++){var n=new cc.Vec2(e.x-o,e.y);o+=30;var a=this.bulletPos.convertToWorldSpaceAR(n);n=t.convertToNodeSpaceAR(a);var r=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab);(u.PoolMgr.getInstance().getNode(d.poolName.newball_bullet)||cc.instantiate(this.bullet)).getComponent(y.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,n,r,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier)}},e.prototype.creatNoInfactBullet=function(t,e){for(var o=[],i=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,n=0;n<this.bulletCount;n++){var a=new cc.Vec2(0-i,0);i+=30,o.push(a)}var r=u.PoolMgr.getInstance().getNode(d.poolName.newball_bullet)||cc.instantiate(this.bullet),s=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab),c=this.bulletPos.convertToWorldSpaceAR(e),l=t.convertToNodeSpaceAR(c);r.getComponent(y.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,l,s,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier,this.bulletCount,o)},e.prototype.pushBullet=function(t){t.getComponent(v.default).hide(),this.bullets.push(t)},e.prototype.doPause=function(){this.ballpFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).ballp()},e.prototype.doResume=function(){this.startFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).resume()},c([C(cc.Prefab)],e.prototype,"bullet",void 0),c([C(cc.Node)],e.prototype,"bulletPos",void 0),c([C(cc.Node)],e.prototype,"skillSp",void 0),c([C(cc.Node)],e.prototype,"addBuffSp",void 0),c([C(cc.Label)],e.prototype,"itemName",void 0),c([C(cc.Sprite)],e.prototype,"itemBg",void 0),c([C(cc.Sprite)],e.prototype,"itemIcon",void 0),c([C(cc.Sprite)],e.prototype,"itemSkill",void 0),c([C(cc.Sprite)],e.prototype,"skillPercent",void 0),c([C(cc.Node)],e.prototype,"windSp",void 0),c([C(cc.Node)],e.prototype,"thunderSp",void 0),c([C(cc.Node)],e.prototype,"vagueSp",void 0),c([C(cc.Node)],e.prototype,"iceSp",void 0),c([C(cc.Node)],e.prototype,"cdTime",void 0),c([P],e)}(l.default);a.default=D,cc._RF.pop(),cc._RF.pop()},{}],BALL_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a08afy8i2hJ27Py23qYQU12","BALL_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"a08afy8i2hJ27Py23qYQU12","BALL_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("BALL_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],BALL_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"ac83fVTc5xKI6QjMwzF6qLo","BALL_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"ac83fVTc5xKI6QjMwzF6qLo","BALL_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BALL_Configs"),u=i("BALL_Skill"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e.rawDelayTime=1.5,e.delayTime=1.5,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){return!this.isSkill&&(this.isSkill=!0,this.showBanner(t),o.parent=this.node,o.getComponent(u.default).useSkill(i,e,t),!0)},e.prototype.changeDelayTime=function(t){t/2<this.delayTime&&(this.delayTime=t/2-.15)},e.prototype.resumeDelayTime=function(){this.delayTime=this.rawDelayTime},e.prototype.showBanner=function(t){var e=this;this.loadSpriteFrame(p.emBALLBundles.imgs,"banner/banner"+t,function(t){e.banner.getComponent(cc.Sprite).spriteFrame=t,e.banner.active=!0});var o=Number((this.delayTime/3).toFixed(1));cc.tween(this.banner).by(o,{x:this.banner.width}).delay(o).by(o,{x:-this.banner.width}).call(function(){e.isSkill=!1,e.banner.active=!1}).start()},e.prototype.onLoad=function(){o.script=this,this.banner.x=-cc.winSize.width/2-this.banner.width/2},e.prototype.start=function(){},e.prototype.update=function(){},c([f(cc.Label)],e.prototype,"label",void 0),c([f(cc.Node)],e.prototype,"banner",void 0),c([f],e.prototype,"text",void 0),o=c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BALL_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"b665eGKQLJDyoFhVMebPcX8","BALL_Skill");var i=t,n=e,a=o;cc._RF.push(n,"b665eGKQLJDyoFhVMebPcX8","BALL_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BALL_Body"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){"attack"==o.data.name&&(t.animationDuration=e.animation.duration)})},e.prototype.useSkill=function(t,e,o){this.index=o,this.skillSpeed=this.speed,this.damage=e,this["useSkill"+o](t),this.flyDis=l.default.script.getHeadY()-this.node.y},e.prototype.useSkill1=function(){var t=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-300),this.spAni.setAnimation(0,"hit",!1);var e=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65),this.offHeight=300},e.prototype.useSkill3=function(){var t=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-100),this.spAni.setAnimation(0,"cedz",!1);var e=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65)},e.prototype.useSkill4=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill6=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,l.default.script.getHeadY()),this.spAni.setAnimation(0,"hit",!1);var o=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill7=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill8=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill11=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!1),this.sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)},e.prototype.useSkill10=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,l.default.script.getHeadY()),this.spAni.setAnimation(0,"animation",!1);var o=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill17=function(){var t=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-100),this.spAni.setAnimation(0,"ssxdz",!1);var e=this.spAni.getCurrent(0).animation.duration;this.offHeight=100,this.scheduleOnce(function(){t.doAttack()},e-2)},e.prototype.update=function(){var t=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed,this.flyDis-=this.skillSpeed,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){t.sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),t.sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.spAni.setAnimation(0,"hit",!1),this.doAttack()))},e.prototype.doAttack=function(){l.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([d({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([d({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([d({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],BALL_Target:[function(t,e,o){"use strict";cc._RF.push(e,"9d53dtj4tJPoq7TmH4B8Sre","BALL_Target");var i=e,n=o;cc._RF.push(i,"9d53dtj4tJPoq7TmH4B8Sre","BALL_Target"),Object.defineProperty(n,"__esModule",{value:!0}),n.Target=void 0;var a=function(){function t(t){this.health=t}return t.prototype.takeDamage=function(t){this.health-=t,console.log("Target takes "+t+" damage! Remaining health: "+this.health),this.health<=0&&this.destroy()},t.prototype.destroy=function(){console.log("Target destroyed!")},t}();n.Target=a,cc._RF.pop(),cc._RF.pop()},{}],BALL_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f5963llkj5PLpwso46Lf7Z1","BALL_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f5963llkj5PLpwso46Lf7Z1","BALL_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BALL_Configs"),u=i("BALL_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tarmMap=new Map,e.isTureTarmMap=new Map,e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.sendEvent(p.emBALLEventName.newTarm,e[0],this.delayTime),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BALL_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"7d7a0bTOPZBQK4QPIXqw071","BALL_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"7d7a0bTOPZBQK4QPIXqw071","BALL_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("BALL_Configs"),f=i("BALL_BloodCtrl"),m=i("BALL_BuffCtrl"),g=i("BALL_mateCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.buffLayer=null,e.bloodLayer=null,e.hitLayer=null,e.blood=null,e.pauseLayer=null,e.closeNode=null,e.skillLayer=null,e.banner=null,e.bannerSp=[],e.isPause=!1,e.maxLength=50,e.hpIndex=0,e.hpArr=[],e.tipPools=[],e.gaptime=.5,e.nowTime=0,e.buffIndex=[],e.buffState=!1,e.maxShowCount=50,e.lastShowTime=0,e.throttleTime=.2,e}return s(e,t),e.prototype.onLoad=function(){p.PoolMgr.getInstance().creatrePool(h.poolName.effect,this.hitEffect,5),p.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2),this.createHpArr(this.maxLength),this.initSystemListen()},e.prototype.createHpArr=function(t){for(;t--;){var e=p.PoolMgr.getInstance().getNode(h.poolName.blood)||cc.instantiate(this.blood);this.hpArr.push(e)}},e.prototype.initSystemListen=function(){var t=this;h.Global.isDirect||cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){t.pauseLayer&&e.keyCode==cc.macro.KEY.space&&(t.pauseLayer.active?(t.pauseLayer.active=!1,t.sendEvent(h.emBALLEventName.resume),t.isPause=!1):(t.pauseLayer.active=!0,t.sendEvent(h.emBALLEventName.pause),t.isPause=!0))})},e.prototype.start=function(){var t=this;this.addEvent(h.emBALLEventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(h.emBALLEventName.GAD_Show_Warn,this.playWarn),this.addEvent(h.emBALLEventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(h.emBALLEventName.buff,this.showBuff),this.addEvent(h.emBALLEventName.blood,this.showLoseLabel),this.addEvent(h.emBALLEventName.newTarm,this.showNewTarm),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(h.emBALLEventName.pause),t.isPause=!0,h.Global.isDirect?u.UIMgr.getInstance().openUI(h.BALL_UIID.UISetting,d.UIID.UINONE,function(e){e&&t.sendEvent(h.emBALLEventName.resume)}):t.pauseLayer.active=!0}),this.pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active&&(t.sendEvent(h.emBALLEventName.resume),t.isPause=!1,t.pauseLayer.active=!1)}),this.closeNode.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active=!1,u.UIMgr.getInstance().openUI(h.BALL_UIID.UISetting,d.UIID.UINONE,function(e){e&&(t.sendEvent(h.emBALLEventName.resume),t.isPause=!1)})})},e.prototype.onShowHitText=function(){},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.ndWarn),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.ndWarn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.ndWarn),t.ndWarn.active=!1}).start()},e.prototype.showHitEffect=function(t){var e=this.node.convertToNodeSpaceAR(t),o=p.PoolMgr.getInstance().getNode(h.poolName.effect)||cc.instantiate(this.hitEffect);o.parent=this.hitLayer,o.setPosition(e),o.active=!0,o.opacity=255,this.scheduleOnce(function(){o.active=!1,p.PoolMgr.getInstance().freeNode("pbt_hit_effect",o)},.1)},e.prototype.update=function(t){var e,o=this;this.buffState&&!this.isPause&&(this.nowTime+=t,this.nowTime>this.gaptime&&(this.nowTime=0,this.buffIndex.length?e=this.buffIndex.shift():this.buffState=!1,this.buffState=0!=this.buffIndex.length,e&&this.loadPrefab(h.emBALLBundles.prefabs,"item/buff",function(t){var i=cc.instantiate(t);i.parent=o.buffLayer,i.getComponent(m.default).initNode(e)})))},e.prototype.showBuff=function(t){this.buffIndex.push(t),this.buffState=!0},e.prototype.showLoseLabel=function(t,e,o,i){if(void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),!(this.bloodLayer.children.length>=this.maxShowCount)||i){var n=cc.director.getTotalTime();if(!(n-this.lastShowTime<this.throttleTime)||i){this.lastShowTime=n;var a=p.PoolMgr.getInstance().getNode(h.poolName.blood);a.parent||(a.parent=this.bloodLayer);var r=a.getComponent(f.default);r.resumeNode(),a.setPosition(e.x,e.y+40),r.isCirt(o,t)}}},e.prototype.showNewTarm=function(t,e){var o=this;this.loadPrefab(h.emBALLBundles.prefabs,"item/mateIcon",function(e){var i=cc.instantiate(e);i.parent=o.skillLayer,i.getComponent(g.default).initNode(t)}),this.showBanner(t,e)},e.prototype.showBanner=function(t,e){var o=this;this.banner.getComponent(cc.Sprite).spriteFrame=this.bannerSp[t],cc.tween(this.banner).by(e/2,{x:this.banner.width}).delay(e/2).call(function(){o.banner.x=-cc.winSize.width/2-o.banner.width/2}).start()},c([_(cc.Node)],e.prototype,"ndTipRoot",void 0),c([_(cc.Node)],e.prototype,"ndWarn",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"hitEffect",void 0),c([_(cc.Node)],e.prototype,"ndBuffImg",void 0),c([_(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([_(cc.Sprite)],e.prototype,"spBack",void 0),c([_(cc.Node)],e.prototype,"buffLayer",void 0),c([_(cc.Node)],e.prototype,"bloodLayer",void 0),c([_(cc.Node)],e.prototype,"hitLayer",void 0),c([_(cc.Node)],e.prototype,"blood",void 0),c([_(cc.Node)],e.prototype,"pauseLayer",void 0),c([_(cc.Node)],e.prototype,"closeNode",void 0),c([_(cc.Node)],e.prototype,"skillLayer",void 0),c([_(cc.Node)],e.prototype,"banner",void 0),c([_(cc.SpriteFrame)],e.prototype,"bannerSp",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BALL_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"574441tvmJOs5wg90ekUvj8","BALL_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"574441tvmJOs5wg90ekUvj8","BALL_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.boundary=void 0;var l=i("BaseUI"),p=i("BALL_Configs"),u=i("BALL_DataMgr"),d=i("BALL_HeroCtrl"),h=i("PoolMgr"),f=i("AudioMgr"),m=i("BALLGameEnumData"),g=i("SdkMgr"),y=i("PlatformSetting"),v=i("BasePlatform"),_=function(){};a.boundary=_;var b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.sprBgSup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.heroRoot=null,e.ndFence=null,e.content=null,e.item=null,e.bulletLayer=null,e.rewardLayer=null,e.bloodLayer=null,e.destroyLayer=null,e.startNode=null,e.skillLayer=null,e.dieLayer=null,e.bulletSkill=null,e.gmNode=null,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this.ndCardGroup.getComponent(d.default);t.clearHero(),p.Global.canAttack=!1,p.Global.bulletID=0,t.addFirstHero(),o.script=this,this.createNodePool(),this.doStart(),this.initBulletBoundary()},e.prototype.initBulletBoundary=function(){this.bulletBoundary=new _;var t=cc.winSize;this.bulletBoundary.upBoundary=t.height/2,this.bulletBoundary.leftBoundary=-t.width/2,this.bulletBoundary.rightBoundary=t.width/2,this.bulletBoundary.downBoundary=this.getWallPosY()+50},e.prototype.getBulletBoundary=function(){return this.bulletBoundary},e.prototype.setGmNode=function(){(g.SdkMgr.getInstance().getCheckVersion(y.SwitchID.ShenHe_ABD)||y.PlatformSetting.currentPlatform==v.Platform.EDITOR||y.PlatformSetting.currentPlatform==v.Platform.WEB_LINK)&&(this.gmNode.active=!0)},e.prototype.doStart=function(){var t=this;f.AudioMgr.getInstance().playEffectFree(p.BALL_AudioId.mission),this.startNode.active=!0,this.startNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.startNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.startNode.active=!1},.1)})},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=u.default.getInstance().getCharacter(),o=[];for(var i in e)(!p.Global.isDirect||17!=e[i].characterID&&3!=e[i].characterID)&&o.push(e[i].characterID);return o[Math.floor(Math.random()*o.length)]},e.prototype.getWallPosY=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.y},e.prototype.getBulletSkill=function(){return this.bulletSkill},e.prototype.getWallPos=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.getPosition()},e.prototype.start=function(){this.initEvents()},e.prototype.createNodePool=function(){this.loadPrefab(p.emBALLBundles.prefabs,"item/blood",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.blood,e)}),this.loadPrefab(p.emBALLBundles.prefabs,"item/destroy",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.destroy,e)}),this.loadPrefab(p.emBALLBundles.prefabs,"item/box",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.box,e)}),this.loadPrefab(p.emBALLBundles.prefabs,"item/body",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.body,e)}),this.loadPrefab(p.emBALLBundles.prefabs,"item/ball_item",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.ball_item,e)}),this.loadPrefab(p.emBALLBundles.prefabs,"item/ball_bullet",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.ball_bullet,e)}),this.loadPrefab(p.emBALLBundles.prefabs,"item/ball_bullet2",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.newball_bullet,e)}),this.loadPrefab(p.emBALLBundles.prefabs,"bullets/"+p.poolName.BALL_Bullet_skill,function(t){h.PoolMgr.getInstance().creatrePool(p.poolName.BALL_Bullet_skill,cc.instantiate(t))})},e.prototype.initEvents=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.ndCardGroup.getComponent(d.default).heroMove(o)})},e.prototype.getBulletLayer=function(t){var e="layer"+t,o=this.bulletLayer.getChildByName(e);return o||((o=new cc.Node(e)).name=e,o.parent=this.bulletLayer),this.bulletLayer.getChildByName(e)},e.prototype.getAllBullet=function(){var t=[];for(var e in this.bulletLayer.children)for(var o in this.bulletLayer.children[e].children)t.push(this.bulletLayer.children[e].children[o])},e.prototype.getDestroyLayer=function(){return this.destroyLayer},e.prototype.getSkillLayer=function(){return this.skillLayer},e.prototype.checkReWardLayer=function(t){return this.rewardLayer.y>t},e.prototype.addHero=function(){},e.prototype.update=function(){},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.sprBgSup);var t=u.default.getInstance().getParam(m.enumBasicParaCfg.quake);cc.tween(this.sprBgSup).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-1*t,-1*t)}).by(.05,{position:cc.v3(2*t,1*t)}).by(.05,{position:cc.v3(-2*t,0*t)}).by(.05,{position:cc.v3(2*t,-1*t)}).by(.05,{position:cc.v3(-1*t,1*t)}).set({position:cc.v3(0,0)}).start()},c([I(cc.Node)],e.prototype,"ndCardGroup",void 0),c([I(cc.Node)],e.prototype,"sprBgSup",void 0),c([I(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([I(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([I(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([I(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([I(cc.Node)],e.prototype,"heroRoot",void 0),c([I(cc.Node)],e.prototype,"ndFence",void 0),c([I(cc.Node)],e.prototype,"content",void 0),c([I(cc.Node)],e.prototype,"item",void 0),c([I(cc.Node)],e.prototype,"bulletLayer",void 0),c([I(cc.Node)],e.prototype,"rewardLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"destroyLayer",void 0),c([I(cc.Node)],e.prototype,"startNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"dieLayer",void 0),c([I(cc.Node)],e.prototype,"bulletSkill",void 0),c([I(cc.Node)],e.prototype,"gmNode",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BALL_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"d71dfMIT8VDaK6U1/7+OQa4","BALL_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"d71dfMIT8VDaK6U1/7+OQa4","BALL_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BALL_Configs"),p=i("BALL_App"),u=i("BaseUI"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e.isDirect=null,e.unDirect=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t,this.isDirect.active=l.Global.isDirect,this.unDirect.active=!l.Global.isDirect},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([f(cc.Label)],e.prototype,"lblBar",void 0),c([f(cc.Sprite)],e.prototype,"spBar",void 0),c([f(cc.Node)],e.prototype,"ndWin",void 0),c([f(cc.Node)],e.prototype,"ndFail",void 0),c([f(cc.Node)],e.prototype,"ndTop",void 0),c([f(cc.Node)],e.prototype,"ndBar",void 0),c([f(cc.Node)],e.prototype,"btn",void 0),c([f(cc.Node)],e.prototype,"btnPlay",void 0),c([f(cc.Label)],e.prototype,"lblRwd",void 0),c([f(cc.Node)],e.prototype,"isDirect",void 0),c([f(cc.Node)],e.prototype,"unDirect",void 0),c([h],e)}(u.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BALL_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"a3e52L7kR5Ea7kW/ZVT3s+y","BALL_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"a3e52L7kR5Ea7kW/ZVT3s+y","BALL_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("BALL_Configs"),m=i("BALL_App"),g=i("BALL_UIGame"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t,this.isDirect.active=f.Global.isDirect,this.unDirect.active=!f.Global.isDirect},e.prototype.onEnable=function(){this.musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&g.default.script.setGmNode()}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){m.default.instance.exit_App(0)}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([_(cc.Slider)],e.prototype,"musicSlider",void 0),c([_(cc.Slider)],e.prototype,"effectSlider",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([_(cc.Node)],e.prototype,"btnBackHome",void 0),c([_(cc.Node)],e.prototype,"isDirect",void 0),c([_(cc.Node)],e.prototype,"unDirect",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Node)],e.prototype,"gmNode",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BALL_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"197e7JJxxpPK6a1o21ii0EO","BALL_UserData");var i=t,n=e,a=o;cc._RF.push(n,"197e7JJxxpPK6a1o21ii0EO","BALL_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"gad_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],BALL_bodyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"ae943PtkHZES7yNTXRDIvzI","BALL_bodyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"ae943PtkHZES7yNTXRDIvzI","BALL_bodyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("BALL_Configs"),d=i("BALLGameEnumData"),h=i("BALL_DataMgr"),f=i("BALL_UIGame"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStart=!1,e.index=0,e.ballgonSpeed=100,e.end=!1,e.sp=[],e.gapDt=.2,e.isBALLgon=!1,e.isLast=!1,e.baseTime=.5,e.resumeTime=.5,e.damageState=!1,e.posNum=2,e}var o;return s(e,t),o=e,e.prototype.startBALL=function(t,e,o,i){this.isBALLgon=!1,4==e&&(this.isLast=!0),-1!=e?(this.changeSp(e),this.destroyNode=p.PoolMgr.getInstance().getNode(u.poolName.destroy)):this.isBALLgon=!0,this.path=t,this.index=i,this.targetPos=this.path[this.index],this.isStart=!0,this.maxIndex=this.path.length-4,this.posNum=2},e.prototype.changeFireState=function(){this.isBALLgon||this.isLast||(this.fireNode.active=!this.fireNode.active,this.fireNode.active&&this.fireNode.getComponent(sp.Skeleton).setAnimation(0,"fire",!0))},e.prototype.stop=function(){this.isStart=!1,this.isBALLgon?this.node.getComponent(sp.Skeleton).clearTrack(0):this.spNode.getComponent(cc.Animation).pause()},e.prototype.resume=function(){this.isStart=!0,this.isBALLgon?this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0):this.spNode.getComponent(cc.Animation).resume()},e.prototype.changeSp=function(t){this.spNode.getComponent(cc.Sprite).spriteFrame=this.sp[t]},e.prototype.playAnimation=function(t){var e=this;this.scheduleOnce(function(){e.spNode.getComponent(cc.Animation).play(),e.spNode.getComponent(cc.Animation).play().clip.speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmni)},t)},e.prototype.doAnimation=function(t){var e=this;void 0===t&&(t=0),this.scheduleOnce(function(){var t=e.spNode.getComponent(cc.Animation);t.play("body"),t.getAnimationState("body").speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmni)},t)},e.prototype.doDamage=function(){this.spNode.color=cc.color().fromHEX("#a60000"),this.resumeTime=this.baseTime,this.damageState=!0},e.prototype.reSumeDamage=function(){this.spNode.color=cc.Color.WHITE},e.prototype.resumeNode=function(t){0!=this.damageState&&(this.resumeTime-=t,this.resumeTime<0&&this.damageState&&(this.reSumeDamage(),this.damageState=!1))},e.prototype.informPre=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0),this.preNode&&(u.Global.isBug&&(this.node.active=!1),u.Global.isBug||(this.preNode=this.getInfactPre()),this.preNode.getComponent(o).setNodePosition(this.node.getPosition(),this.index))},e.prototype.getInfactPre=function(){for(var t=this.preNode;!t.active;)t.removeFromParent(),t=t.getComponent(o).preNode;return t},e.prototype.setNodePosition=function(t,e){var o=this;u.Global.isBug||this.informPre(t,e),this.index=e,this.targetPos=this.path[this.index],this.node.setPosition(t),u.Global.isBug&&this.informPre(t,e),this.isBALLgon&&"die"!=this.node.getComponent(sp.Skeleton).animation&&(this.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1),this.node.getComponent(sp.Skeleton).setCompleteListener(function(){o.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}))},e.prototype.getIndex=function(){return this.index},e.prototype.playDeballry=function(){var t=this;f.default.script.onScreenShake();var e=p.PoolMgr.getInstance().getNode(u.poolName.destroy);e||(e=cc.instantiate(this.destroyNode)),e.parent=f.default.script.getDestroyLayer(),e.setPosition(this.node.getPosition()),e.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){e.destroy()},.1)})},e.prototype.setPreNode=function(t,e){var o=t.position;o.x-=e,this.isLast&&(this.spNode.anchorX=.8,this.spNode.anchorY=.3),this.node.position=o,this.preNode=t},e.prototype.onLoad=function(){this.ballgonSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed)},e.prototype.start=function(){var t=this;cc.game.on("gameEnd",function(){t.isStart=!1})},e.prototype.update=function(t){this.isStart&&this.resumeNode(t)},e.prototype.onUpdate=function(t,e){if(this.node.active&&!this.end&&this.isStart){var o=this.targetPos,i=this.node.getPosition();if(null!=o&&null!=i){var n=o.sub(i).mag(),a=e*t;a=Math.min(a,n);var r=o.sub(i).normalize().mul(a);this.node.setPosition(i.add(r)),(this.isBALLgon||this.isLast)&&(r.x<0?this.node.scaleX=-1:r.x>0&&(this.node.scaleX=1)),n<=a&&(this.node.setPosition(o),this.index++,this.index>=this.path.length||(this.targetPos=this.path[this.index])),this.index>=this.maxIndex&&(this.endPos||(this.endPos=f.default.script.getWallPos()),this.node.getPosition().fuzzyEquals(this.endPos,50)&&(this.end=!0,this.sendEvent(u.emBALLEventName.pause),this.openUI(u.BALL_UIID.UIResult)))}}},c([y(cc.SpriteFrame)],e.prototype,"sp",void 0),c([y(cc.Node)],e.prototype,"spNode",void 0),c([y(cc.Node)],e.prototype,"fireNode",void 0),o=c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],BALL_boxCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c2d5aEZW1BEIZZSVSxMrRQN","BALL_boxCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c2d5aEZW1BEIZZSVSxMrRQN","BALL_boxCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("Utils"),h=i("BALL_Configs"),f=i("BALL_DataMgr"),m=i("BALL_bodyCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.boxSpArr=[],e.otherNodes=[],e.isDie=!1,e.lastAttackIndex=0,e.hp=2,e.isLast=!1,e.canBeAttack=!1,e.isCreate=!1,e}return s(e,t),e.prototype.start=function(){this.canBeAttack=!1},e.prototype.setCanBeAttack=function(){this.canBeAttack=!0},e.prototype.initNode=function(t,e,o,i){var n=this;void 0===i&&(i=!1),this.scheduleOnce(function(){n.boxSp.node.active=!0,n.label.node.active=!0},.1),this.isLast=i,this.targetNode=t,this.hp=e,this.boxIndex=o,this.label.string=e.toString(),this.initBox(),this.blood=u.PoolMgr.getInstance().getNode(h.poolName.blood)},e.prototype.initBox=function(){f.default.getInstance().getLevelCfgByID(this.boxIndex).buffType&&(this.boxSp.spriteFrame=this.boxSpArr[1])},e.prototype.addOtherNode=function(t){this.otherNodes.push(t)},e.prototype.checkCollider=function(t){if(this.checkIsDie(),this.canBeAttack)return!this.isDie&&!!this.isInRange(t)},e.prototype.checkIsDie=function(){if(!this.isDie){var t=!1;for(var e in this.otherNodes)if(0==this.otherNodes[e].active){t=!0;break}t&&(this.node.active=!1),this.isDie=t}},e.prototype.checkSkillCollider=function(t,e){this.canBeAttack&&(this.isDie||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0))},e.prototype.doFireDamage=function(t){if(!this.isDie){var e=Math.ceil(this.hp*t);this.handleDamage(e,this.node.getPosition())}},e.prototype.isInRange=function(t){var e=this.targetNode.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hp-=s,this.hp<=0)this.sendEvent(h.emBALLEventName.blood,t,this.getPos(e),o),this.doDie();else for(;r--;)this.doDamage(t,this.getPos(e),o,a);p.AudioMgr.getInstance().playEffect(h.BALL_AudioId.ballgonHit,h.BALL_AudioId.ballgonHit)},e.prototype.getPos=function(t){var e=d.Utils.randomRang(-30,30),o=d.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(h.emBALLEventName.blood,t,e,o,i),this.label.string=Math.max(this.hp,0).toString(),this.otherNodes.forEach(function(t){t.getComponent(m.default).doDamage()})},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.doDie=function(){var t=this;p.AudioMgr.getInstance().playEffectFree(h.BALL_AudioId.burn,6),this.isDie=!0,this.node.active=!1,h.Global.isBug?this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(),e.active=!1,o%2&&e.getComponent(m.default).playDeballry()},.05*o)}):this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(e.getPosition(),e.getComponent(m.default).getIndex()),e.active=!1},.05*(9-o)),t.scheduleOnce(function(){o%2&&e.getComponent(m.default).playDeballry()},.05*o)}),this.isLast&&(this.sendEvent(h.emBALLEventName.pause),this.openUI(h.BALL_UIID.UIResult,!0)),this.spawnBuffItem()},e.prototype.spawnBuffItem=function(){this.isCreate||(this.isCreate=!0,this.sendEvent(h.emBALLEventName.buff,this.boxIndex))},e.prototype.update=function(){this.targetNode&&!this.isDie&&this.node.setPosition(this.targetNode.position)},c([v(cc.Label)],e.prototype,"label",void 0),c([v(cc.Sprite)],e.prototype,"boxSp",void 0),c([v(cc.SpriteFrame)],e.prototype,"boxSpArr",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],BALL_mateCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"b518eae0O1CjYQhgKhOeh6U","BALL_mateCtrl");var i=t,n=e,a=o;cc._RF.push(n,"b518eae0O1CjYQhgKhOeh6U","BALL_mateCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BALL_Configs"),u=i("BALL_DataMgr"),d=i("BALL_HeroCtrl"),h=i("BALL_mateSkillCtrl"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e.maxCDTime=0,e.cdTime=0,e.mateSkillAttack=1,e.mateID=1,e.isPause=!1,e}return s(e,t),e.prototype.initNode=function(t){this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=this,e=u.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=e.mateCDtime,this.mateSkillAttack=e.mateSkillATK,this.loadPrefab(p.emBALLBundles.prefabs,"skills/mateSkill"+this.mateID,function(e){t.skillNode=cc.instantiate(e)})},e.prototype.initView=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID);this.skillLabel.string=t.mateName,this.cdPercent.fillRange=0,this.skillIcon.spriteFrame=this.getSpriteByName(),this.cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){if(this.cdTime<=0){if(d.default.script.getBallLock())return;var t=u.default.getInstance().getMateCfgByID(this.mateID),e=Number(t.mateRole.split(",")[0]),o=Number(t.mateRole.split(",")[1]);h.default.script.useSkill(this.mateID,d.default.script.getMaxDamage(e,o)*t.mateSkillATK,this.skillNode,new cc.Vec2(0,0))&&this.initStartUseSkill()}},e.prototype.initStartUseSkill=function(){this.cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.cdLabel.string=this.cdTime+"",this.cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.cdLabel.node.active=!1,this.spNode.node.active=!0,this.spNode.setAnimation(0,"animation",!1),this.spNode.setCompleteListener(function(){e.spNode.node.active=!1})):this.cdLabel.string=this.cdTime.toFixed(0)},e.prototype.getSpriteByName=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID).mateIconRes;for(var e in this.spArr)if(t==this.spArr[e].name)return this.spArr[e]},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.onLoad=function(){this.addEvent(p.emBALLEventName.pause,this.pause),this.addEvent(p.emBALLEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.cdTime>0&&!this.isPause&&!d.default.script.getBallLock()&&this.refreshSkillView(t)},c([g(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([g(cc.Label)],e.prototype,"cdLabel",void 0),c([g(cc.Label)],e.prototype,"skillLabel",void 0),c([g(cc.Sprite)],e.prototype,"cdPercent",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([g(sp.Skeleton)],e.prototype,"spNode",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BALL_mateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"9bd4dqcoEZPbqoRvn1KYVgR","BALL_mateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"9bd4dqcoEZPbqoRvn1KYVgR","BALL_mateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BALL_mateSkill"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){var n=this;return!this.isSkill&&(this.isSkill=!0,this.scheduleOnce(function(){n.isSkill=!1},.5),o.parent=this.node,o.getComponent(p.default).useSkill(i,e,t),!0)},e.prototype.onLoad=function(){o.script=this},e.prototype.start=function(){},e.prototype.update=function(){},c([h(cc.Label)],e.prototype,"label",void 0),c([h(cc.Node)],e.prototype,"banner",void 0),c([h],e.prototype,"text",void 0),o=c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BALL_mateSkill:[function(t,e,o){"use strict";cc._RF.push(e,"1007c3GNxhKqqB9aJKeQY1c","BALL_mateSkill");var i=t,n=e,a=o;cc._RF.push(n,"1007c3GNxhKqqB9aJKeQY1c","BALL_mateSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("BALL_Configs"),d=i("BALL_DataMgr"),h=i("BALL_Body"),f=i("BALL_Hero"),m=i("BALL_HeroCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){var i=d.default.getInstance().getMateCfgByID(t.index),n=Number(i.mateRole.split(",")[0]),a=Number(i.mateRole.split(",")[1]),r=[];for(var s in u.Global.heroID)u.Global.heroID[s].id!=n&&u.Global.heroID[s].id!=a||r.push(u.Global.heroID[s].node.getComponent(f.default));"attack"==o.data.name&&(t.doMateSkillCtrl(t.index,r,i),t.doAttack())})},e.prototype.doMateSkillCtrl=function(t,e,o){1==t?this.doMateSkill1(e,o):2==t?this.doMateSkill2(e,o):3==t?this.doMateSkill3(e,o):4==t?this.doMateSkill4(e,o):5==t?this.doMateSkill5(e,o):6==t?this.doMateSkill6(e,o):7==t&&this.doMateSkill7(e,o)},e.prototype.doMateSkill1=function(t,e){for(var o in t)t[o].addAttackSpeed(1,Number(e.matePara))},e.prototype.doMateSkill2=function(t,e){var o=m.default.script.getMaxDamage(4,8),i=Math.floor(o*Number(e.matePara));for(var n in t)t[n].addAttackPower(1,i)},e.prototype.doMateSkill3=function(t,e){p.EventMgr.getInstance().emit(u.emBALLEventName.skillPause),this.scheduleOnce(function(){p.EventMgr.getInstance().emit(u.emBALLEventName.skillResume)},Number(e.matePara))},e.prototype.doMateSkill4=function(t,e){for(var o in t){var i=Math.floor(2*Math.random()),n=Number(e.matePara.split(",")[i]),a=t[o];n<1?a.addCritChance(3,n):a.addBulletCount(1,n)}},e.prototype.doMateSkill5=function(t,e){var o=Number(e.matePara.split(",")[0]),i=Number(e.matePara.split(",")[1]);for(var n in t)t[n].changeSkillInterval(o,i)},e.prototype.doMateSkill6=function(t,e){var o=Number(e.matePara.split(",")[0]),i=Number(e.matePara.split(",")[1]);for(var n in t)t[n].addAttackPenerate(3,o,5,i)},e.prototype.doMateSkill7=function(t,e){var o=Math.max(t[0].getAttackPower(),t[1].getAttackPower()),i=Math.max(t[0].getSpeed(),t[1].getSpeed()),n=e.matePara.split(","),a=Math.floor(o*Number(n[0])),r=Math.floor(i*Number(n[1])),s=Number(n[2]),c=Math.min(t[0].getBulletCount(),t[1].getBulletCount());m.default.script.addTempHero(14,a,r,s,c)},e.prototype.useSkill=function(t,e,o){var i=d.default.getInstance().getMateCfgByID(o);if(l.AudioMgr.getInstance().playEffect(i.mateSound,"mateSkill"),this.index=o,this.spAni.setAnimation(0,"animation",!1),7!=o)this.node.setPosition(t.x,h.default.script.getHeadY());else{var n=m.default.script.node.getPosition();console.log(n,"pos"),this.node.setPosition(n)}this.damage=e},e.prototype.update=function(){},e.prototype.doAttack=function(){h.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([v({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([v({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([v({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([y],e)}(cc.Component);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],BBD2Anima:[function(t,e,o){"use strict";cc._RF.push(e,"ddfa9pc5RdEnYja4Xi/8YUs","BBD2Anima");var i=t,n=e,a=o;cc._RF.push(n,"ddfa9pc5RdEnYja4Xi/8YUs","BBD2Anima");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("BBD2_Configs"),u=i("BBD2_UIGame"),d=cc._decorator,h=d.ccclass,f=d.property,m={1:{path:"ppl_boom",audio:p.BBD2_AudioId.boom},2:{path:"ppl_iceboom"},3:{path:"ppl_flash",audio:p.BBD2_AudioId.flsah},4:{path:"ppl_broken",audio:p.BBD2_AudioId.ppBomb},5:{path:"ppl_fade",audio:p.BBD2_AudioId.hit},6:{path:"ppl_hook",audio:p.BBD2_AudioId.hook},7:{path:"ppl_gyskill",audio:p.BBD2_AudioId.gySkill},8:{path:"ppl_wkskill",audio:p.BBD2_AudioId.swkSkill},9:{path:"ppl_zxskill",audio:p.BBD2_AudioId.zxSkill},10:{path:"PungFX",audio:p.BBD2_AudioId.grassboom}},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animItem=null,e._hurtData=null,e}return s(e,t),e.prototype.init=function(t){var e=this;this._hurtData=t;var o=p.emBBD2Bundles.GameIcon,i="anim/"+m[t.type].path+"/"+m[t.type].path;t.pos?this.node.setPosition(t.pos):this.node.setPosition(cc.v3(0,0,0)),t.scal?this.node.setScale(t.scal):this.node.setScale(cc.v3(1,1,1)),m[t.type].audio&&l.AudioMgr.getInstance().playEffectFree(m[t.type].audio);var n=this.animItem;n.skeletonData=null,n.node.active=!1,u.default.instance.loadResSkeleton(this.node,o,i,function(o){n.node.active=!0,n.skeletonData=o;var i="animation";t.animaName&&(i=t.animaName),t.skin&&n.setSkin(t.skin),n.setAnimation(0,i,!1),n.setCompleteListener(null),n.setCompleteListener(function(){t.callback&&t.callback(),n.setCompleteListener(null),u.default.instance.freePoolNode(p.BBD2PoolName.AnimItem,e.node)})})},c([f({type:sp.Skeleton,tooltip:""})],e.prototype,"animItem",void 0),c([h],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BBD2ArrowItem2:[function(t,e,o){"use strict";cc._RF.push(e,"20834swuLZFHLBV+Rf6kO6D","BBD2ArrowItem2");var i=t,n=e,a=o;cc._RF.push(n,"20834swuLZFHLBV+Rf6kO6D","BBD2ArrowItem2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("EventMgr"),p=i("BBD2_Configs"),u=i("BBD2_DataMgr"),d=i("BBD2_UIGame"),h=i("BBD2GridItem"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsIcon=null,e._tempPos=cc.v3(),e._data={type:0,idx:0,playType:0},e._mapdata=null,e.startX=p.BBD2GameData2.startX,e.itemW=p.BBD2GameData2.itemW,e._type=0,e._spData=null,e._nowIdx=-999,e._endPos=null,e._speed=24,e._attackNum=0,e}return s(e,t),e.prototype.onEnable=function(){l.EventMgr.getInstance().on(p.BBD2EventName.GameUpdata,this,this.onUpdate)},e.prototype.onDisable=function(){l.EventMgr.getInstance().off(p.BBD2EventName.GameUpdata,this,this.onUpdate)},e.prototype.init=function(t,e){this._data=t,this._mapdata=e,this._nowIdx=t.idx,this._type=t.type,this._spData=t.skill,this.loadIcon(this._data.playType)},e.prototype.loadIcon=function(t){var e="bullet"+t;d.default.instance.loadIcon(this.obsIcon,e)},e.prototype.refreshPos=function(){this.restPos()},e.prototype.restPos=function(){var t,e,o=null;this._endPos=null;for(var i=this._mapdata.length-1;i>=0;i--){var n=this._mapdata[i];if(null===(t=n[this._nowIdx])||void 0===t?void 0:t.node){o=null===(e=n[this._nowIdx])||void 0===e?void 0:e.node,this._endPos=o;break}}},e.prototype.onUpdate=function(){this.refreshPos();var t=p.BBD2GameData2.startY+p.BBD2GameData2.itemH;this._endPos&&(t=this._endPos.y),t-this.node.y>this._speed?this.node.y+=this._speed:(this.checkAttObs2(),d.default.instance.freePoolNode(p.BBD2PoolName.ArrowItem,this.node))},e.prototype.checkAttObs2=function(){for(var t,e=this._spData,o=null,i=this._mapdata.length-1;i>=0;i--){var n=this._mapdata[i];if(n&&(null===(t=n[this._nowIdx])||void 0===t?void 0:t.node)){o=n[this._nowIdx].node;break}}if(o)if(e&&e.spType){var a=o.getComponent(h.default).getGridId();3==e.spType&&d.default.instance.mapGridCrtl.checkBuff3Bomb(a),4==e.spType&&d.default.instance.mapGridCrtl.checkBuff4Bomb(a),5==e.spType&&(d.default.instance.mapGridCrtl.creatAnim({type:1,pos:this.node.getPosition()}),d.default.instance.mapGridCrtl.checkBuff5Light(a))}else{var r={type:this._type,num:1},s=u.default.getInstance().checkBuffIsGet(7);s&&(this._attackNum++,this._attackNum>=s.buffParametric&&(r.num=999,this._attackNum=0)),o.getComponent(h.default).attack(r)}else l.EventMgr.getInstance().emit(p.BBD2EventName.GameAttackDrog,!0);e&&e.skill&&this.checkPlayAttSkill(e,o),d.default.instance.mapGridCrtl.gragAttack()},e.prototype.checkPlayAttSkill=function(t){var e={};1==t.skill?(e.type=7,e.pos=cc.v3(this.node.x,0),e.callback=function(){l.EventMgr.getInstance().emit(p.BBD2EventName.GamePlayerSkillEnd)},d.default.instance.mapGridCrtl.playSkill1(this._nowIdx)):2==t.skill?(e.type=8,e.pos=cc.v3(this.node.x,0),e.callback=function(){l.EventMgr.getInstance().emit(p.BBD2EventName.GamePlayerSkillEnd)},d.default.instance.mapGridCrtl.playSkill2(this._nowIdx)):3==t.skill&&(e.type=9,e.callback=function(){l.EventMgr.getInstance().emit(p.BBD2EventName.GamePlayerSkillEnd)},d.default.instance.mapGridCrtl.playSkill3(this._nowIdx)),d.default.instance.mapGridCrtl.creatAnim(e)},c([g({type:cc.Sprite})],e.prototype,"obsIcon",void 0),c([m],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBD2ArrowItem:[function(t,e,o){"use strict";cc._RF.push(e,"fc038wx1J5FG4kTRxe1MaUU","BBD2ArrowItem");var i=t,n=e,a=o;cc._RF.push(n,"fc038wx1J5FG4kTRxe1MaUU","BBD2ArrowItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("EventMgr"),p=i("BBD2_Configs"),u=i("BBD2_UIGame"),d=i("BBD2GridItem"),h=cc._decorator,f=h.ccclass,m=h.property,g={1:"skin_4",2:"skin_5",3:"skin_3",4:"skin_2",5:"skin_1"},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsIcon=null,e.tipIcon=null,e.playerNode=null,e.animaNode=null,e._tempPos=cc.v3(),e._data=null,e._mapdata=null,e.startX=p.BBD2GameData2.startX,e.itemW=p.BBD2GameData2.itemW,e._speed=12,e._nowIdx=-999,e}return s(e,t),e.prototype.onEnable=function(){l.EventMgr.getInstance().on(p.BBD2EventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().on(p.BBD2EventName.GameRestArrowIcon,this,this.loadSpArrow),l.EventMgr.getInstance().on(p.BBD2EventName.GameArrowAttow2,this,this.checkAttObs2)},e.prototype.onDisable=function(){l.EventMgr.getInstance().off(p.BBD2EventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().off(p.BBD2EventName.GameRestArrowIcon,this,this.loadSpArrow),l.EventMgr.getInstance().off(p.BBD2EventName.GameArrowAttow2,this,this.checkAttObs2)},e.prototype.init=function(t,e){this._data=t,this._mapdata=e,this.loadIcon(this._data.type)},e.prototype.loadIcon=function(t){var e="arrow_"+t;this.loadIcon2(t),u.default.instance.loadIcon(this.obsIcon,e)},e.prototype.loadIcon2=function(t){for(var e="light"+t,o=0;o<this.tipIcon.children.length;o++){var i=this.tipIcon.children[o];u.default.instance.loadIcon(i.getComponent(cc.Sprite),e)}},e.prototype.loadSpArrow=function(t){if(t){var e="";3==t?e="type3_1":5==t?e="type7_1":4==t&&(e="type3_2"),u.default.instance.loadIcon(this.obsIcon,e)}else this.loadIcon(this._data.type)},e.prototype.refreshPos=function(){var t=(this.playerNode.position.x-(this.startX-this.itemW/2))/this.itemW,e=Math.floor(t);e=e<0?0:e,this._nowIdx!=e&&(this._nowIdx=e),this.restPos()},e.prototype.restPos=function(){for(var t,e,o,i=!1,n=null,a=this._mapdata.length-1;a>=0;a--){var r=this._mapdata[a];if(null===(t=r[this._nowIdx])||void 0===t?void 0:t.node){i=!0,n=null===(e=r[this._nowIdx])||void 0===e?void 0:e.node,null===(o=r[this._nowIdx])||void 0===o||o.node.getPosition(this._tempPos);break}}i?this._tempPos.y-=p.BBD2GameData2.itemH:(this._tempPos.x=p.BBD2GameData2.startX+p.BBD2GameData2.itemW*this._nowIdx,this._tempPos.y=p.BBD2GameData2.startY+p.BBD2GameData2.itemH),this.node.setPosition(cc.v3(this._tempPos.x,-430)),this.tipIcon.parent.setPosition(cc.v3(this._tempPos.x,this.node.y));var s=this._tempPos.y-this.node.y;s=36*Math.round(s/36),this.tipIcon.parent.height=s,this.refreshAnimaNode(n)},e.prototype.refreshAnimaNode=function(t){t?(this.animaNode.parent=t,t.getComponent(d.default).setGridSeletZindex(this.animaNode),this.animaNode.x=0,this.animaNode.y=0,this.animaNode.active=!0):this.animaNode.active=!1},e.prototype.onUpdate=function(){this.refreshPos()},e.prototype.playAnima=function(){},e.prototype.checkAttObs=function(t){this.playAnima(),this._data.idx=this._nowIdx,this._data.pos.x=this.node.x,this.node.opacity=1,this.tipIcon.opacity=1,this._data.skill=t,u.default.instance.mapGridCrtl.creatArrow2(this._data);var e=(this._tempPos.y- -443)/430,o={type:5,pos:cc.v3(this.node.x,-443),skin:g[this._data.type],scal:cc.v3(1,e,1)};u.default.instance.mapGridCrtl.creatAnim(o)},e.prototype.checkAttObs2=function(){this.node.opacity=255,this.tipIcon.opacity=255},c([m({type:cc.Sprite})],e.prototype,"obsIcon",void 0),c([m({type:cc.Node})],e.prototype,"tipIcon",void 0),c([m({type:cc.Node})],e.prototype,"playerNode",void 0),c([m({type:cc.Node})],e.prototype,"animaNode",void 0),c([f],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBD2BossItem:[function(t,e,o){"use strict";cc._RF.push(e,"e3dc3HgSY9GDrVpBw2Fs+6D","BBD2BossItem");var i=t,n=e,a=o;cc._RF.push(n,"e3dc3HgSY9GDrVpBw2Fs+6D","BBD2BossItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("Utils"),d=i("BBD2_Configs"),h=i("BBD2GameEnumData"),f=i("BBD2_DataMgr"),m=i("BBD2_UIGame"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.body=null,e.hpProg=null,e._hp=0,e._hpMax=0,e}return s(e,t),e.prototype.onLoad=function(){this.loadBody(),this.restData()},e.prototype.onEnable=function(){p.EventMgr.getInstance().on(d.BBD2EventName.GameAttackDrog,this,this.attackDrag),p.EventMgr.getInstance().on(d.BBD2EventName.GameIceDrog,this,this.iceDrog),p.EventMgr.getInstance().on(d.BBD2EventName.GameDragAttack,this,this.attackDrag2)},e.prototype.onDisable=function(){p.EventMgr.getInstance().off(d.BBD2EventName.GameAttackDrog,this,this.attackDrag),p.EventMgr.getInstance().off(d.BBD2EventName.GameIceDrog,this,this.iceDrog)},e.prototype.restData=function(){this._hp=f.default.getInstance().getParam(h.enumBBD2GearParameterCfg.BOSSHp),this._hpMax=this._hp,this.refreshUI()},e.prototype.refreshUI=function(){this.hpProg.progress=this._hp/this._hpMax},e.prototype.attackDrag2=function(){l.AudioMgr.getInstance().playEffectFree(d.BBD2_AudioId.bossatk);var t=this.body;t&&t.skeletonData&&(t.setAnimation(0,d.BBD2AnimName.Attack,!1),t.setCompleteListener(function(){t.setAnimation(0,d.BBD2AnimName.Idle,!0),t.setCompleteListener(null)}))},e.prototype.getBossHp=function(){return this._hp/this._hpMax},e.prototype.attackDrag=function(t){var e=t.type,o=1,i=null;if(4==e)i=f.default.getInstance().checkBuffIsGet(10);else if(3==e){var n=f.default.getInstance().checkBuffIsGet(11);n&&u.Utils.randomRang(0,100)<=n.buffParametric&&m.default.instance.mapGridCrtl.checkIceBomb()}else 5==e?i=f.default.getInstance().checkBuffIsGet(12):2==e?i=f.default.getInstance().checkBuffIsGet(13):1==e&&(i=f.default.getInstance().checkBuffIsGet(14));i&&u.Utils.randomRang(0,100)<=i.buffParametric&&(o=2),this._hp-=o,l.AudioMgr.getInstance().playEffectFree(d.BBD2_AudioId.hitboss);var a=this.body;a.setAnimation(0,d.BBD2AnimName.Hit,!1),a.setCompleteListener(function(){a.setAnimation(0,d.BBD2AnimName.Idle,!0),a.setCompleteListener(null)}),this._hp<=0&&m.default.instance.openGameResultUI(!0),this.refreshUI()},e.prototype.iceDrog=function(t){void 0===t&&(t=!1);var e="#FFFFFF";t?(this.body.timeScale=0,e="#69C5FE"):this.body.timeScale=1,this.body.node.color=cc.color().fromHEX(e)},e.prototype.loadBody=function(){var t=this,e=this.body;e.skeletonData=null;var o=d.emBBD2Bundles.GameIcon;m.default.instance.loadResSkeleton(e.node,o,"anim/ppl_dragon/ppl_dragon",function(o){var i;(null===(i=t.node)||void 0===i?void 0:i.isValid)&&(e.skeletonData=o,e.setAnimation(0,d.BBD2AnimName.Idle,!0))})},e.prototype.start=function(){},c([v({type:sp.Skeleton})],e.prototype,"body",void 0),c([v({type:cc.ProgressBar})],e.prototype,"hpProg",void 0),c([y],e)}(cc.Component);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],BBD2GameData:[function(t,e,o){"use strict";cc._RF.push(e,"ae719jx1idMNo21KiNt5yDv","BBD2GameData");var i=e,n=o;cc._RF.push(i,"ae719jx1idMNo21KiNt5yDv","BBD2GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emBBD2GameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.characterCfg="characterCfg",t.GearParameterCfg="GearParameterCfg",t.dropCfg="dropCfg"}(n.emBBD2GameDataKeys||(n.emBBD2GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],BBD2GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"6cef9BgkxNISpxJSEzgh2au","BBD2GameEnumData");var i=e,n=o;cc._RF.push(i,"6cef9BgkxNISpxJSEzgh2au","BBD2GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBBD2GearParameterCfg=void 0,function(t){t[t.WeaponNum=1]="WeaponNum",t[t.BOSSHp=2]="BOSSHp",t[t.BallHp=3]="BallHp",t[t.WeaponAtk=4]="WeaponAtk",t[t.BoxHp=5]="BoxHp",t[t.BarHp=6]="BarHp",t[t.HookHp=7]="HookHp",t[t.BombHp=8]="BombHp",t[t.BossTime=9]="BossTime",t[t.AttackTime=10]="AttackTime",t[t.BombArea=11]="BombArea",t[t.FlashHp=12]="FlashHp",t[t.GuanyuCharge=13]="GuanyuCharge",t[t.ZixiaCharge=14]="ZixiaCharge",t[t.MonkeyCharge=15]="MonkeyCharge",t[t.FreezeTime=16]="FreezeTime",t[t.NeiProbability=17]="NeiProbability",t[t.belProbability=18]="belProbability",t[t.GrassHp=20]="GrassHp"}(n.enumBBD2GearParameterCfg||(n.enumBBD2GearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],BBD2GridItem:[function(t,e,o){"use strict";cc._RF.push(e,"f1a6a5gPKxJtKgns3bbOvkF","BBD2GridItem");var i=t,n=e,a=o;cc._RF.push(n,"f1a6a5gPKxJtKgns3bbOvkF","BBD2GridItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Utils"),p=i("BBD2_Configs"),u=i("BBD2_DataMgr"),d=i("BBD2_UIGame"),h=cc._decorator,f=h.ccclass,m=h.property,g={1:"skin4",2:"skin5",3:"skin3",4:"skin1",5:"skin2"},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsIcon=null,e._data=null,e._hp=0,e._hpMax=0,e._hpPro=null,e._moveState=!1,e._moveFun=null,e._moveFunArm=null,e._upY=0,e._isDiy=!1,e}return s(e,t),e.prototype.onEnable=function(){},e.prototype.init=function(t){this._data=t,this.loadIcon(),this._hp=d.default.instance.getObsHp(this._data.obsType),this._hpMax=this._hp,this._hpPro=this.node.getChildByName("prog").getComponent(cc.ProgressBar),this._hpPro.node.active=!1},e.prototype.getGridId=function(){return this._data.ID},e.prototype.getGridObsType=function(){return this._data.obsType},e.prototype.setGridSeletZindex=function(t){var e=this.node.getChildByName("selet");t.setParent(e)},e.prototype.loadIcon=function(){var t="type"+this._data.obsType+"_"+this._data.type;d.default.instance.loadIcon(this.obsIcon,t)},e.prototype.moveDownGrid=function(t){var e=this;if(void 0===t&&(t=!1),!this._isDiy){this._moveState=!0,cc.Tween.stopAllByTarget(this.node);var o=t?1:255;cc.tween(this.node).to(0,{opacity:o}).by(.2,{position:cc.v3(0,-p.BBD2GameData2.itemH,0),opacity:255}).call(function(){e._moveState=!1,e._moveFun&&(e._moveFun(),e._moveFun=null)}).start()}},e.prototype.moveUpGrid=function(t){var e=this;if(void 0===t&&(t=null),!this._isDiy){if(this._upY+=p.BBD2GameData2.itemH,this._moveState)return this._moveFunArm=t,void(this._moveFun=this.moveUpGrid);cc.Tween.stopAllByTarget(this.node);var o=0;t&&(o=-255),cc.tween(this.node).by(.2,{position:cc.v3(0,this._upY,0),opacity:o}).call(function(){e._upY=0}).start()}},e.prototype.moveUpPool=function(t){var e=this;if(!this._isDiy){this._isDiy=!0;var o=10-t;o=o>=0?o:0,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).by(.05*o,{position:cc.v3(0,-p.BBD2GameData2.itemH*o,0)}).call(function(){e.recycleGrid2(),e.recycleDownGrid3()}).start()}},e.prototype.attack=function(t){var e=t.type,o=this._data.obsType,i=this._data.type,n=t.num;if(o!=p.BBD2GameObsTypeHp.ord&&o!=p.BBD2GameObsTypeHp.obs&&o!=p.BBD2GameObsTypeHp.bomb&&o!=p.BBD2GameObsTypeHp.grass||e==i&&(n*=3),o==p.BBD2GameObsTypeHp.ord){var a=u.default.getInstance().checkBuffIsGet(9);a&&l.Utils.randomRang(0,100)<=a.buffParametric&&(n=9999)}this._hp-=n,this._hp<=0?(this.gridDiy(!0),this._hpPro.node.active=!1):(this._hpPro.node.active=!0,this._hpPro.progress=this._hp/this._hpMax)},e.prototype.gridDiy=function(t){if(void 0===t&&(t=!1),this._data.obsType==p.BBD2GameObsTypeHp.grass&&t){var e=d.default.instance.mapGridCrtl.getGridX_Y(this._data.ID);return d.default.instance.mapGridCrtl.gridDiy(this._data,e[0],e[1],t),void this.grassChangeType()}this.recycleGrid(t)},e.prototype.grassChangeType=function(){var t=this._data.obsType;if(t==p.BBD2GameObsTypeHp.grass){for(var e=l.Utils.randomRang(1,p.BBD2GameObsTypeNum[t]+1);e==this._data.type;)e=l.Utils.randomRang(1,p.BBD2GameObsTypeNum[t]+1);this._data.obsType=p.BBD2GameObsTypeHp.ord,this._data.type=e,this.init(this._data);var o={type:10,pos:this.node.getPosition()};d.default.instance.mapGridCrtl.creatAnim(o)}},e.prototype.recycleGrid=function(t){d.default.instance.mapGridCrtl.recycleGrid(this._data.ID,t),this.recycleGrid2()},e.prototype.recycleGrid2=function(){if(!this._data.isRecycle){var t=this.node.getChildByName("selet");if(t.children.length>0&&(t.children[0].parent=null),this._isDiy=!1,this._data.isRecycle=!0,d.default.instance.freePoolNode(p.BBD2PoolName.GridItem,this.node),this._data.obsType==p.BBD2GameObsTypeHp.ord||this._data.obsType==p.BBD2GameObsTypeHp.grass){var e={type:4,skin:g[this._data.type],pos:this.node.getPosition()};d.default.instance.mapGridCrtl.creatAnim(e)}}},e.prototype.recycleDownGrid3=function(){this._data.obsType==p.BBD2GameObsTypeHp.box?d.default.instance.mapGridCrtl.openBuffUI():this._data.obsType==p.BBD2GameObsTypeHp.back?d.default.instance.mapGridCrtl.backFun():this._data.obsType==p.BBD2GameObsTypeHp.bomb&&2==this._data.type&&d.default.instance.mapGridCrtl.iceBombFun()},e.prototype.onUpdate=function(){this._moveState},c([m({type:cc.Sprite})],e.prototype,"obsIcon",void 0),c([f],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBD2MapGrid:[function(t,e,o){"use strict";cc._RF.push(e,"f2705t8l6pPP568szlFbstN","BBD2MapGrid");var i=t,n=e,a=o;cc._RF.push(n,"f2705t8l6pPP568szlFbstN","BBD2MapGrid");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("EventMgr"),p=i("Utils"),u=i("BBD2_Configs"),d=i("BBD2GameEnumData"),h=i("BBD2_DataMgr"),f=i("BBD2_UIGame"),m=i("BBD2Anima"),g=i("BBD2ArrowItem"),y=i("BBD2ArrowItem2"),v=i("BBD2BossItem"),_=i("BBD2GridItem"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridParent=null,e.arrowItem=null,e.bossItem=null,e.startX=u.BBD2GameData2.startX,e.endX=275,e.startY=u.BBD2GameData2.startY,e.endY=-438,e.itemW=u.BBD2GameData2.itemW,e.itemH=u.BBD2GameData2.itemH,e._buffId19Num=0,e._iceTime=0,e._gridRestTimeMax=0,e._gridRestTime=0,e._moveState=0,e._creatGrid2=!1,e._initState=!1,e._mapGrid=[],e._ID=1,e._tempPos=cc.v3(),e._obsType=[u.BBD2GameObsTypeHp.ord,u.BBD2GameObsTypeHp.grass,u.BBD2GameObsTypeHp.obs],e._basrArr=[],e}return s(e,t),e.prototype.onLoad=function(){this._gridRestTimeMax=h.default.getInstance().getParam(d.enumBBD2GearParameterCfg.BossTime),this.endX=this.startX+this.itemW*u.BBD2GameData2.BaseRow-this.itemW/2,this.endX=this.startY+this.itemH*u.BBD2GameData2.BaseCol+this.itemH/2},e.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onClickTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onClickTouchMove,this),l.EventMgr.getInstance().on(u.BBD2EventName.GameCreatArrow,this,this.creatArrow),l.EventMgr.getInstance().on(u.BBD2EventName.GameArrowAttow,this,this.arrowAttack),l.EventMgr.getInstance().on(u.BBD2EventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().on(u.BBD2EventName.GameGetBuff,this,this.eventGetBuff)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClickTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onClickTouchMove,this),l.EventMgr.getInstance().off(u.BBD2EventName.GameCreatArrow,this,this.creatArrow),l.EventMgr.getInstance().off(u.BBD2EventName.GameArrowAttow,this,this.arrowAttack),l.EventMgr.getInstance().off(u.BBD2EventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().off(u.BBD2EventName.GameGetBuff,this,this.eventGetBuff)},e.prototype.start=function(){},e.prototype.eventGetBuff=function(t){if(19==t)this._buffId19Num=1;else if(20==t)this.buffSuprBomb();else if(21==t){this.creatAnim({type:2});var e=h.default.getInstance().getBuffDataIdData(t);this.checkIceBomb(e.buffParametric)}else 22==t&&this.backFun()},e.prototype.onClickTouchStart=function(t){var e=t.getLocation(),o=this.node.convertToNodeSpaceAR(cc.v3(e.x,e.y));o.x>=this.startX&&o.x<=this.endX&&o.y>=this.startY&&(o.y,this.endY),this.getPosIdx(o)},e.prototype.onClickTouchMove=function(t){var e=t.getLocation(),o=this.node.convertToNodeSpaceAR(cc.v3(e.x,e.y));this.getPosIdx(o,!1)},e.prototype.getPosIdx=function(t,e){void 0===e&&(e=!0);var o=(t.x-(this.startX-this.itemW/2))/this.itemW,i=-1*(t.y-(this.startY+this.itemH/2))/this.itemH,n=Math.floor(o);Math.floor(i),n=(n=n<0?0:n)>=8?7:n,l.EventMgr.getInstance().emit(u.BBD2EventName.GamePlayerMove,n,e)},e.prototype.checkIsStop=function(t){return this._iceTime>0&&(this._iceTime-=t,this._iceTime<=0&&l.EventMgr.getInstance().emit(u.BBD2EventName.GameIceDrog,!1),!0)},e.prototype.onUpdate=function(t){this._moveState>0||this.checkIsStop(t)||(this._gridRestTime-=t,this._gridRestTime<=0&&(this.refreshGrid(),l.EventMgr.getInstance().emit(u.BBD2EventName.GameDragAttack),this._gridRestTime=999999999999))},e.prototype.gragAttack=function(){var t=this;this._creatGrid2=!1,this._iceTime>0||(this._moveState>0?this._creatGrid2=!0:this.scheduleOnce(function(){t.refreshGrid(),l.EventMgr.getInstance().emit(u.BBD2EventName.GameDragAttack)},.5))},e.prototype.creatObs=function(t){var e=f.default.instance.getPoolNode(u.BBD2PoolName.GridItem);return e.parent=this.gridParent,e.setPosition(this._tempPos),e.getComponent(_.default).init(t),e},e.prototype.creatArrow=function(t){this.arrowItem.init(t,this._mapGrid)},e.prototype.creatArrow2=function(t){var e=this.node.parent.getChildByName("arrow2"),o=f.default.instance.getPoolNode(u.BBD2PoolName.ArrowItem);o.parent=e,o.setPosition(t.pos),o.getComponent(y.default).init(t,this._mapGrid)},e.prototype.creatAnim=function(t){var e=this.node.parent.getChildByName("anima"),o=f.default.instance.getPoolNode(u.BBD2PoolName.AnimItem);o.parent=e,o.getComponent(m.default).init(t)},e.prototype.arrowAttack=function(t){this.arrowItem.checkAttObs(t)},e.prototype.refreshGrid=function(){var t=this,e=this.creatGridData();this._mapGrid.splice(0,0,e);for(var o=0;o<this._mapGrid.length;o++)for(var i=this._mapGrid[o],n=0;n<i.length;n++){var a=i[n];if(a){var r=0==o;a.node.getComponent(_.default).moveDownGrid(r)}}this._mapGrid.length>=10?f.default.instance.openGameResultUI(!1):(this._buffId19Num>0&&this._mapGrid.length>=7&&(this._buffId19Num=0,this.checkIceBomb()),this._initState||(this._initState=!0,cc.tween(this.node).delay(.2).call(function(){t.refreshGrid()}).start()))},e.prototype.creatGridData=function(){var t=[];if(this._basrArr.length>0)t=this._basrArr.splice(this._basrArr.length-1,1)[0];else for(var e=0;e<8;e++)t[e]=this._creatGrid(e,t);return t},e.prototype._creatGrid=function(t,e){var o,i=100*this.bossItem.getBossHp(),n={obsType:(o=h.default.getInstance().getObsRangType(this._mapGrid[0],e,t,i))[0],type:o[1],node:null,ID:this._ID,isRecycle:!1};return this._ID++,this.getCreatPos(t),n.node=this.creatObs(n),n},e.prototype.getCreatPos=function(t){this._tempPos.x=u.BBD2GameData2.startX+u.BBD2GameData2.itemW*t,this._tempPos.y=u.BBD2GameData2.startY+u.BBD2GameData2.itemH},e.prototype.recycleGrid=function(t,e){void 0===e&&(e=!1);for(var o=!1,i=this._mapGrid.length-1;i>=0;i--){for(var n=this._mapGrid[i],a=0;a<n.length;a++){var r=n[a];if(r&&r.ID==t){var s=n[a];n[a]=null,this.gridDiy(s,i,a,e),o=!0;break}}if(o)break}o||console.log("\u51fa\u9519\u4e86")},e.prototype.checkBuff3Bomb=function(t){var e=this.getGridX_Y(t);if(e){var o=this._mapGrid[e[0]][e[1]].node.position;this.creatAnim({type:1,pos:o}),this.checkBomb(e[0],e[1])}},e.prototype.checkBuff4Bomb=function(){this.creatAnim({type:2}),this.checkIceBomb()},e.prototype.checkBuff5Light=function(t){var e=this.getGridX_Y(t);if(e){var o=this._mapGrid[e[0]][e[1]].node.position;this.creatAnim({type:3,pos:cc.v3(0,o.y)}),this.checkLight(e[0])}},e.prototype.getGridX_Y=function(t){for(var e=this._mapGrid.length-1;e>=0;e--)for(var o=this._mapGrid[e],i=0;i<o.length;i++){var n=o[i];if(n&&n.ID==t)return[e,i]}return null},e.prototype.buffSuprBomb=function(){this.creatAnim({type:1,pos:cc.v3(0,0,0)});for(var t=7;t>3;t--)if(this._mapGrid[t])for(var e=2;e<6;e++){var o=this._mapGrid[t][e];o&&o.node.getComponent(_.default).gridDiy()}},e.prototype.checkBomb=function(t,e){for(var o=-1;o<2;o++){var i=t+o,n=this._mapGrid[i];if(n)for(var a=-1;a<2;a++){var r=n[e+a];r&&r.node.getComponent(_.default).gridDiy()}}},e.prototype.checkIceBomb=function(t){void 0===t&&(t=null),this._iceTime=t||h.default.getInstance().getParam(d.enumBBD2GearParameterCfg.FreezeTime),l.EventMgr.getInstance().emit(u.BBD2EventName.GameIceDrog,!0)},e.prototype.checkBack=function(){for(var t=this._mapGrid.length-1;t>=0;t--)for(var e=this._mapGrid[t],o=0;o<e.length;o++){var i=e[o];if(i){var n=0==t;i.node.getComponent(_.default).moveUpGrid(n)}}},e.prototype.checkLight=function(t){for(var e=this._mapGrid[t],o=0;o<e.length;o++){var i=e[o];i&&i.node.getComponent(_.default).gridDiy()}},e.prototype.checkMapData=function(){for(var t=this._mapGrid.length-1;t>0;t--){for(var e=this._mapGrid[t],o=0,i=0;i<e.length;i++)if(e[i])return void o++;0==o&&this._mapGrid.splice(t,1)}},e.prototype.checkSeparateItem=function(){for(var t=this.findUnreachableOnes(),e=0;e<t.length;e++){var o=t[e],i=this._mapGrid[o[0]][o[1]];this._mapGrid[o[0]][o[1]]=null,i.node.getComponent(_.default).moveUpPool(o[0])}},e.prototype.findUnreachableOnes=function(){var t=this._mapGrid,e=t.length;if(0===e)return[];for(var o=t[0].length,i=Array.from({length:e},function(){return new Array(o).fill(!1)}),n=[],a=0;a<o;a++)null!=t[0][a]&&(n.push([0,a]),i[0][a]=!0);for(var r=[[1,0],[-1,0],[0,1],[0,-1]];n.length>0;)for(var s=n.shift(),c=s[0],l=(a=s[1],0),p=r;l<p.length;l++){var u=p[l],d=c+u[0],h=a+u[1];d>=0&&d<e&&h>=0&&h<o&&null!=t[d][h]&&!i[d][h]&&(i[d][h]=!0,n.push([d,h]))}var f=[];for(c=0;c<e;c++)for(a=0;a<o;a++)null==t[c][a]||i[c][a]||f.push([c,a]);return f},e.prototype.checkFall=function(t,e,o){for(var i,n,a=[[e-1,o],[e+1,o],[e,o-1],[e,o+1]],r=[[e,o]],s=[],c=function(t,e){for(var o=0;o<r.length;o++)if(r[o][0]==t&&r[o][1]==e)return!0;return!1},l=this._mapGrid,d=0,f=t.type;a.length>d;)i=a[d][0],n=a[d][1],i<0||i>=l.length||n>7||n<0||null!=l[i][n]&&(r.push([i,n]),this._obsType.indexOf(l[i][n].obsType)>=0&&l[i][n].type==t.type&&(s.push([i,n]),c(i-1,n)||a.push([i-1,n]),c(i+1,n)||a.push([i+1,n]),c(i,n+1)||a.push([i,n+1]),c(i,n-1)||a.push([i,n-1]))),d++;for(var m=0;m<s.length;m++){var g=l[s[m][0]][s[m][1]];if(g){var y=g.node;g.obsType!=u.BBD2GameObsTypeHp.grass?(l[s[m][0]][s[m][1]]=null,y.getComponent(_.default).recycleGrid2()):y.getComponent(_.default).grassChangeType()}}if(s.length>=2)if(3==f){var v=h.default.getInstance().checkBuffIsGet(16);v&&p.Utils.randomRang(0,100)<v.buffParametric&&this.checkIceBomb()}else if(5==f){var b=h.default.getInstance().checkBuffIsGet(17);b&&p.Utils.randomRang(0,100)<b.buffParametric&&this.buff17(e,o)}var B=h.default.getInstance().checkBuffIsGet(8);B&&s.length>=B.buffParametric&&this.checkBomb(e,o)},e.prototype.buff17=function(t,e){for(var o=2,i=-2;i<3;i++){var n=t+i,a=this._mapGrid[n];if(a)for(var r=-2;r<3;r++){var s=a[e+r];if(s){var c=s.node;if(c.getComponent(_.default).getGridObsType()==u.BBD2GameObsTypeHp.ord&&(c.getComponent(_.default).gridDiy(),--o<=0))return}}}},e.prototype.playSkill1=function(t){for(var e,o,i=0,n=this._mapGrid.length-1;n>=0;n--)if(null===(e=this._mapGrid[n][t])||void 0===e?void 0:e.node){i=n;break}var a=i-3;a=a>=0?a:-1;for(var r=i;r>a;r--){var s=this._mapGrid[r];(null===(o=s[t])||void 0===o?void 0:o.node)&&s[t].node.getComponent(_.default).attack({type:0,num:999})}i<2&&l.EventMgr.getInstance().emit(u.BBD2EventName.GameAttackDrog,!0)},e.prototype.playSkill2=function(t){for(var e,o=0,i=this._mapGrid.length-1;i>=0;i--)if(null===(e=this._mapGrid[i][t])||void 0===e?void 0:e.node){o=i+1;break}o<2&&l.EventMgr.getInstance().emit(u.BBD2EventName.GameAttackDrog,!0),this.checkBomb(o,t)},e.prototype.playSkill3=function(){for(var t=this,e=0,o=0;o<this._mapGrid.length;o++)for(var i=this._mapGrid[o],n=0;n<i.length;n++)i[n]&&e++;e=e>5?5:e;for(var a=this.randNumPos(e),r=function(e){cc.tween(s.node).delay(.1*e).call(function(){var o=a[e],i=o[1],n=o[0];t._mapGrid[n]&&t._mapGrid[n][i]&&t._mapGrid[n][i].node.getComponent(_.default).gridDiy()}).start()},s=this,c=0;c<a.length;c++)r(c)},e.prototype.randNumPos=function(t){for(var e=[];t>0;){var o=p.Utils.randomRang(0,8),i=p.Utils.randomRang(0,this._mapGrid.length);if(this._mapGrid[i][o]){for(var n=!0,a=0;a<e.length;a++){var r=e[a];if(r[0]==i&&r[1]==o){n=!1;break}}n&&(e.push([i,o]),t--)}}return e},e.prototype.backFun=function(){var t=this;if(!(this._moveState>0)){this._moveState++;var e={type:6,pos:cc.v3(0,1242,0),callback:function(){cc.tween(t.node).delay(.5).call(function(){t._moveState--,t._creatGrid2&&(t._creatGrid2=!1,t.gragAttack())}).start();for(var e=0;e<2;e++){t.checkBack();var o=t._mapGrid.splice(0,1)[0];if(o)for(var i=0;i<o.length;i++)if(o[i]){t._basrArr.push(o);break}}}};f.default.instance.mapGridCrtl.creatAnim(e)}},e.prototype.iceBombFun=function(){this.creatAnim({type:2}),this.checkIceBomb()},e.prototype.gridDiy=function(t,e,o,i){void 0===i&&(i=!1);var n=t.obsType;if(n==u.BBD2GameObsTypeHp.bomb)1==t.type?(this.creatAnim({type:1,pos:t.node.getPosition()}),this.checkBomb(e,o)):this.iceBombFun();else if(n==u.BBD2GameObsTypeHp.box)this.openBuffUI();else if(n==u.BBD2GameObsTypeHp.back)this.backFun();else if(n==u.BBD2GameObsTypeHp.light){this.checkLight(e);var a=t.node.getPosition();this.creatAnim({type:3,pos:cc.v3(0,a.y)})}else n!=u.BBD2GameObsTypeHp.ord&&n!=u.BBD2GameObsTypeHp.grass&&n!=u.BBD2GameObsTypeHp.obs||i&&this.checkFall(t,e,o);this.checkSeparateItem(),this.checkMapData()},e.prototype.openBuffUI=function(){f.default.instance.eventOpenBuffSelet(null)},c([I({type:cc.Node})],e.prototype,"gridParent",void 0),c([I(g.default)],e.prototype,"arrowItem",void 0),c([I(v.default)],e.prototype,"bossItem",void 0),c([B],e)}(cc.Component);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BBD2PlayerCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"74f60eaMd5E3qW2w82gx8uB","BBD2PlayerCtrl");var i=t,n=e,a=o;cc._RF.push(n,"74f60eaMd5E3qW2w82gx8uB","BBD2PlayerCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("PlatformSetting"),u=i("EventMgr"),d=i("SdkMgr"),h=i("Utils"),f=i("BBD2_Configs"),m=i("BBD2GameEnumData"),g=i("BBD2_DataMgr"),y=i("BBD2_UIGame"),v=cc._decorator,_=v.ccclass,b=v.property,B={1:m.enumBBD2GearParameterCfg.GuanyuCharge,2:m.enumBBD2GearParameterCfg.ZixiaCharge,3:m.enumBBD2GearParameterCfg.MonkeyCharge},I={1:"ppl_gy",2:"ppl_swk",3:"ppl_zx"},P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.body=null,e.playNode=null,e.attProg=null,e.attLab=null,e.skillSpr=null,e.skillSprMask=null,e.skillSprIcon=null,e.GmNode=null,e.nextArrowSpr=[],e._attNum=0,e._attMax=10,e._playType=3,e._isGm=!1,e._buffId18Time=null,e._spArrow=[],e._isGMState=!1,e._moveState=!1,e._nowPosIdx=4,e._nowPosX=0,e._direc=1,e._nowArrow=[],e._attackState=!1,e._attackCool=0,e._attackCoolMax=0,e._isRefreshArrow=!0,e._spareArrowArr=[],e._speed=9,e._playerPos=cc.v3(),e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.node.getPosition(this._playerPos),this._playType=h.Utils.randomRang(1,4),this._attMax=g.default.getInstance().getParam(B[this._playType]),this.loadBody(),this.refreshAttProgUI2(),this.refreshSpareArrows(!1),u.EventMgr.getInstance().on(f.BBD2EventName.GamePlayerMove,this,this.moveGrid),u.EventMgr.getInstance().on(f.BBD2EventName.GameUpdata,this,this.onUpdate),u.EventMgr.getInstance().on(f.BBD2EventName.GameGetBuff,this,this.eventGetBuff),u.EventMgr.getInstance().on(f.BBD2EventName.GamePlayerSkillEnd,this,this.GamePlayerSkillEnd),this.body.setEventListener(function(e,o){"atk"==o.data.name&&t.startAttck2()}),this._isGm=d.SdkMgr.getInstance().getCheckVersion(p.SwitchID.ShenHe_ABD)||p.PlatformSetting.currentPlatform==l.Platform.EDITOR||p.PlatformSetting.currentPlatform==l.Platform.WEB_LINK,this.GmNode.active=this._isGm,this.attProg.progress=1,this.skillSprIcon.node.active=!1},e.prototype.onDestroy=function(){u.EventMgr.getInstance().off(f.BBD2EventName.GamePlayerMove,this,this.moveGrid),u.EventMgr.getInstance().off(f.BBD2EventName.GameUpdata,this,this.onUpdate),u.EventMgr.getInstance().off(f.BBD2EventName.GameGetBuff,this,this.eventGetBuff),u.EventMgr.getInstance().off(f.BBD2EventName.GamePlayerSkillEnd,this,this.GamePlayerSkillEnd)},e.prototype.eventGetBuff=function(t){if(2==t)this.creatArrow();else if(18==t)this._buffId18Time=0;else if(3==t)this._spArrow.push(3),u.EventMgr.getInstance().emit(f.BBD2EventName.GameRestArrowIcon,this._spArrow[0]);else if(4==t)this._spArrow.push(4),u.EventMgr.getInstance().emit(f.BBD2EventName.GameRestArrowIcon,this._spArrow[0]);else if(5==t)this._spArrow.push(5),u.EventMgr.getInstance().emit(f.BBD2EventName.GameRestArrowIcon,this._spArrow[0]);else if(6==t){var e=g.default.getInstance().checkBuffIsGet(6);this._attMax=this._attMax-e.buffParametric}},e.prototype.start=function(){this.creatArrow()},e.prototype.init=function(){},e.prototype.loadBody=function(){var t,e=this;t="anim/"+I[this._playType]+"/"+I[this._playType];var o=this.body;o.skeletonData=null;var i=f.emBBD2Bundles.GameIcon;y.default.instance.loadResSkeleton(o.node,i,t,function(t){e.node&&(o.skeletonData=t,o.setAnimation(0,f.BBD2AnimName.Idle,!0))});var n="playIcon"+this._playType;y.default.instance.loadIcon(this.skillSpr,n);var a="banner"+this._playType;y.default.instance.loadIcon(this.skillSprIcon,a)},e.prototype.playPlayerAnim=function(t,e,o){void 0===e&&(e=!0);var i=this.body;i.skeletonData&&(i.setAnimation(0,t,e),i.setCompleteListener(null),i.setCompleteListener(function(){i.setCompleteListener(null),o&&o()}))},e.prototype.changeGMState=function(){this._isGm&&(this._isGMState=!this._isGMState)},e.prototype.refreshAttProgUI=function(){this.attProg.progress=1-this._attackCool/this._attackCoolMax,this.attLab.string=this._attNum+"/"+this._attMax},e.prototype.refreshAttProgUI2=function(){this.skillSprMask.fillRange=1-this._attNum/this._attMax},e.prototype.moveGrid=function(t,e){e&&this._nowPosIdx==t?this.startAttck():this._attackState||this._nowPosIdx!=t&&(this._nowPosIdx=t,this.moveStart(),this._nowPosX=f.BBD2GameData2.startX+this._nowPosIdx*f.BBD2GameData2.itemW,this._direc=this._nowPosX>this._playerPos.x?1:-1,this.playNode.setScale(this._direc,1,1))},e.prototype.startAttck=function(){var t=this;if(!this._moveState&&!(this._attackState||this._attackCool>0)){this._attNum++;var e=g.default.getInstance().getParam(m.enumBBD2GearParameterCfg.AttackTime),o=g.default.getInstance().checkBuffIsGet(1),i=0;o&&o.buffParametric&&(i=o.buffParametric),null!=this._buffId18Time&&this._buffId18Time<=5&&(i+=.5),this._isGMState?this._attackCool=.5:this._attackCool=e*(1-i/100),this._attackCoolMax=this._attackCool,this._attackState=!0,this._isRefreshArrow=!0,this._spArrow.length>0&&(this._isRefreshArrow=!1),this.playPlayerAnim(f.BBD2AnimName.Attack,!1,function(){t.playPlayerAnim(f.BBD2AnimName.Idle),t._attackState=!1,u.EventMgr.getInstance().emit(f.BBD2EventName.GameRestArrowIcon,t._spArrow[0])})}},e.prototype.startAttck2=function(){var t=null;this._spArrow.length>0&&(t={spType:this._spArrow.splice(0,1)[0]}),this._attNum>this._attMax&&(this._attNum=0,t||(t={}),t.skill=this._playType,this.skillSprIcon.node.active=!0),u.EventMgr.getInstance().emit(f.BBD2EventName.GameArrowAttow,t),this.refreshAttProgUI2()},e.prototype.GamePlayerSkillEnd=function(){this.skillSprIcon.node.active=!1},e.prototype.creatArrow=function(){if(!(this._spArrow.length>0)){var t=this._nowArrow.splice(0,1)[0],e=this.node.convertToWorldSpaceAR(cc.v3(0,0,0)),o={type:t,pos:this.node.parent.parent.convertToNodeSpaceAR(cc.v3(e)),idx:this._nowPosIdx,playType:this._playType};u.EventMgr.getInstance().emit(f.BBD2EventName.GameCreatArrow,o),this.refreshSpareArrows()}},e.prototype.refreshSpareArrows=function(t){void 0===t&&(t=!0);for(var e=0;e<2;e++){if(!this._nowArrow[e]){0==this._spareArrowArr.length&&(this._spareArrowArr=[1,2,3,4,5]);var o=h.Utils.randomRang(0,this._spareArrowArr.length);this._nowArrow[e]=this._spareArrowArr.splice(o,1)[0]}t&&this.loadIcon(this._nowArrow[e],this.nextArrowSpr[e])}},e.prototype.loadIcon=function(t,e){var o="arrow_"+t;y.default.instance.loadIcon(e,o)},e.prototype.moveStart=function(){this._moveState=!0,this.playPlayerAnim(f.BBD2AnimName.Run)},e.prototype.moveEnd=function(){this._moveState=!1,this.playPlayerAnim(f.BBD2AnimName.Idle)},e.prototype.checkNextPos=function(){var t=Math.abs(this._nowPosX-this._playerPos.x);return t<=this._speed?(this.moveEnd(),t):this._speed},e.prototype.onUpdate=function(t){this._attackCool>0&&(this._attackCool-=t,this.refreshAttProgUI(),this._attackCool<=0&&(this._isRefreshArrow&&this.creatArrow(),u.EventMgr.getInstance().emit(f.BBD2EventName.GameArrowAttow2))),null!=this._buffId18Time&&(this._buffId18Time+=t,this._buffId18Time>=20&&(this._buffId18Time=0)),this._moveState&&(this._playerPos.x+=this.checkNextPos()*this._direc,this.node.setPosition(this._playerPos))},c([b({type:sp.Skeleton})],e.prototype,"body",void 0),c([b({type:cc.Node})],e.prototype,"playNode",void 0),c([b({type:cc.ProgressBar})],e.prototype,"attProg",void 0),c([b({type:cc.Label})],e.prototype,"attLab",void 0),c([b({type:cc.Sprite})],e.prototype,"skillSpr",void 0),c([b({type:cc.Sprite})],e.prototype,"skillSprMask",void 0),c([b({type:cc.Sprite})],e.prototype,"skillSprIcon",void 0),c([b({type:cc.Node})],e.prototype,"GmNode",void 0),c([b({type:[cc.Sprite]})],e.prototype,"nextArrowSpr",void 0),c([_],e)}(cc.Component);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BBD2_APP:[function(t,e,o){"use strict";cc._RF.push(e,"2955659uZ5CS6LEdr5ODo8U","BBD2_APP");var i=t,n=e,a=o;cc._RF.push(n,"2955659uZ5CS6LEdr5ODo8U","BBD2_APP"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("BBD2_Configs"),p=i("BBD2_DataMgr"),u=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e;var n=function(){i._isInited=!0,s.UIMgr.getInstance().openUIOfCallback(l.BBD2_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.BBD2_AudioId.bgm,l.BBD2Config.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.BBD2_UICF),r.AudioMgr.getInstance().addAdConf(l.BBD2_AudioCF),p.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),s.UIMgr.getInstance().closeById(l.BBD2_UIID.UIGame),s.UIMgr.getInstance().closeById(l.BBD2_UIID.UIResult),s.UIMgr.getInstance().closeById(l.BBD2_UIID.UISetting),s.UIMgr.getInstance().closeById(l.BBD2_UIID.UIBuff),this._exitCall&&this._exitCall(),this._exitCall=null},t.prototype.removeTouchEvent=function(){},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],BBD2_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"149f6BkG39FdptwHUqY2M5S","BBD2_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"149f6BkG39FdptwHUqY2M5S","BBD2_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.BBD2AnimName=l.BBD2GameObsTypeHp=l.BBD2GameObsTypeNum=l.BBD2GameData2=l.BBD2PoolName=l.BBD2EventName=l.BBD2_AudioCF=l.BBD2_AudioId=l.BBD2Config=l.BBD2_UICF=l.emBBD2Bundles=l.BBD2_UIID=void 0,function(t){t.UIGame="BBD2_UIGame",t.UIResult="BBD2_UIResult",t.UISetting="BBD2_UISetting",t.UIBuff="BBD2_UIBuff"}(a=l.BBD2_UIID||(l.BBD2_UIID={})),function(t){t.prefabs="bbt2_prefabs",t.configs="bbt2_configs",t.audios="bbt2_audios",t.GameIcon="bbt2_gameIcon"}(r=l.emBBD2Bundles||(l.emBBD2Bundles={})),l.BBD2_UICF=((i={})[a.UIGame]={prefab:"ui/BBD2_UIGame",name:"BBD2_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/BBD2_UIResult",name:"BBD2_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/BBD2_UISetting",name:"BBD2_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIBuff]={prefab:"ui/BBD2_UIBuff",name:"BBD2_UIBuff",showTop:!0,showMult:!0,zIndex:1e3,bundleName:r.prefabs},i),l.BBD2Config={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},function(t){t.bgm="bgm",t.boom="boom",t.flsah="flsah",t.gySkill="gySkill",t.hit="hit",t.hook="hook",t.ppBomb="ppBomb",t.swkSkill="swkSkill",t.zxSkill="zxSkill",t.hitboss="hitboss",t.bossatk="bossatk",t.grassboom="grassboom"}(s=l.BBD2_AudioId||(l.BBD2_AudioId={})),l.BBD2_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.boom]={path:"boom",bundle:r.audios},n[s.flsah]={path:"flsah",bundle:r.audios},n[s.hit]={path:"hit",bundle:r.audios},n[s.gySkill]={path:"gySkill",bundle:r.audios},n[s.hook]={path:"hook",bundle:r.audios},n[s.ppBomb]={path:"ppBomb",bundle:r.audios},n[s.swkSkill]={path:"swkSkill",bundle:r.audios},n[s.zxSkill]={path:"zxSkill",bundle:r.audios},n[s.hitboss]={path:"hitboss",bundle:r.audios},n[s.bossatk]={path:"bossatk",bundle:r.audios},n[s.grassboom]={path:"grassboom",bundle:r.audios},n),function(t){t[t.GamePlayerMove="BBD2G_GamePlayerMove"]="GamePlayerMove",t[t.GameCreatArrow="BBD2G_GameCreatArrow"]="GameCreatArrow",t[t.GameArrowAttow="BBD2G_GameArrowAttow"]="GameArrowAttow",t[t.GameArrowAttow2="BBD2G_GameArrowAttow2"]="GameArrowAttow2",t[t.GameAttackDrog="BBD2G_GameAttackDrog"]="GameAttackDrog",t[t.GameIceDrog="BBD2G_GameIceDrog"]="GameIceDrog",t[t.GameUpdata="BBD2G_GameUpdata"]="GameUpdata",t[t.GameOver="BBD2G_GameOver"]="GameOver",t[t.GameGetBuff="BBD2G_GameGetBuff"]="GameGetBuff",t[t.GameCloseAlert="BBD2G_GameCloseAlert"]="GameCloseAlert",t[t.GameRestArrowIcon="BBD2G_GameRestArrowIcon"]="GameRestArrowIcon",t[t.GameDragAttack="BBD2G_GameDragAttack"]="GameDragAttack",t[t.GamePlayerSkillEnd="BBD2G_GamePlayerSkillEnd"]="GamePlayerSkillEnd"}(l.BBD2EventName||(l.BBD2EventName={})),function(t){t.GridItem="BBD2GGridItem",t.ArrowItem="BBD2GArrowItem",t.AnimItem="BBD2GAnimItem"}(l.BBD2PoolName||(l.BBD2PoolName={})),function(t){t[t.BaseRow=8]="BaseRow",t[t.BaseCol=10]="BaseCol",t[t.ArrowBaseSpeed=8]="ArrowBaseSpeed",t[t.PlayerRange=500]="PlayerRange",t[t.itemW=78]="itemW",t[t.itemH=81]="itemH",t[t.startX=-275]="startX",t[t.startY=290]="startY",t[t.obsType=6]="obsType",t[t.arrowType=5]="arrowType"}(l.BBD2GameData2||(l.BBD2GameData2={})),l.BBD2GameObsTypeNum={1:5,2:5,3:2,4:1,5:5,6:1,7:1},function(t){t[t.ord=1]="ord",t[t.obs=2]="obs",t[t.bomb=3]="bomb",t[t.box=4]="box",t[t.grass=5]="grass",t[t.back=6]="back",t[t.light=7]="light"}(l.BBD2GameObsTypeHp||(l.BBD2GameObsTypeHp={}));var p=function(){function t(){}return t.Attack="atk",t.Die="die",t.Hit="hit",t.Idle="idle",t.Run="run",t.Up="up",t}();l.BBD2AnimName=p,cc._RF.pop(),cc._RF.pop()},{}],BBD2_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"e1062sFn1JLXaFlzHqaC9cK","BBD2_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"e1062sFn1JLXaFlzHqaC9cK","BBD2_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("EventMgr"),l=i("HttpMgr"),p=i("PlatformManager"),u=i("ResourceMgr"),d=i("Utils"),h=i("BBD2_Configs"),f=i("BBD2GameEnumData"),m=cc._decorator,g=m.ccclass,y=(m.property,function(){function t(){this._isRemote=!1,this._seleteBuff=[1],this._weightNum=-9999,this._weightArr=[],this._obsType=[h.BBD2GameObsTypeHp.ord,h.BBD2GameObsTypeHp.grass,h.BBD2GameObsTypeHp.obs],this._bossHpState={nei:null,bel:null}}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){var e,o;if(!window||!window.location)return null;var i=null===(o=null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.search)||void 0===o?void 0:o.replace("?","");if(!i||""===i)return null;for(var n=i.split("&"),a=0;a<n.length;a++){var r=n[a].split("=");if(decodeURIComponent(r[0])===t)return decodeURIComponent(r[1])}return null},t.prototype.load=function(t){var e=this,o=this._isRemote;if(p.PlatformManager.currentPlatform==s.Platform.EDITOR){var i=this.getUrlParam("isRemote");i&&"1"==i&&(o=!0)}o?l.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"penglang/BBD_soilder/configs",fileName:"GameJsonCfg.json"},function(o,i){if(o&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(e.data=JSON.parse(n.data),console.log(e.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):u.ResourceMgr.getInstance().loadRes(h.emBBD2Bundles.configs,"GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.GearParameterCfg[t]?this.data.GearParameterCfg[t].value:0},t.prototype.getBuffDataIdData=function(t){for(var e=this.data.buffCfg,o=0;o<e.length;o++){var i=e[o];if(i.ID==t)return i}return null},t.prototype.getBuffDataId=function(t){for(var e=this.data.buffCfg,o=0;o<e.length;o++){var i=e[o];if(i.ID==t)return i}return{}},t.prototype.restBuff=function(){this._seleteBuff=[]},t.prototype.getSeleteBuff=function(t){this._seleteBuff.push(t),c.EventMgr.getInstance().emit(h.BBD2EventName.GameGetBuff,t)},t.prototype.checkBuffIsGet=function(t){return this._seleteBuff.indexOf(t)>=0?this.getBuffDataId(t):null},t.prototype.randomBuff=function(){for(var t=[],e=function(){var e=o._getSeleteBuff();t.find(function(t){return t.ID==e.ID})||t.push(e)},o=this;t.length<=3;)e();return t},t.prototype._getSeleteBuff=function(){for(var t=this.data.buffCfg,e=[],o=0,i=[],n=0;n<t.length;n++){var a=t[n],r=!0;1==a.buffTime&&this._seleteBuff.indexOf(a.ID)>=0&&(r=!1),r&&(e.push(a),o+=a.buffvalue,i.push(o))}for(var s=d.Utils.randomRang(0,o),c=0;c<i.length;c++)if(s<i[c])return e[c];return console.log("buff\u968f\u673a\u6709\u95ee\u9898"),e[0]},t.prototype.getObsRangType=function(t,e,o,i){var n=this.data.dropCfg;if(this._weightNum<0){this._weightNum=0;for(var a=0;a<n.length;a++){var r=n[a];this._weightNum+=r.value,this._weightArr.push(this._weightNum)}}for(var s=d.Utils.randomRang(0,this._weightNum),c=0,l=0;l<this._weightArr.length;l++)if(s<this._weightArr[l]){c=l;break}var p=n[c],u=d.Utils.randomRang(1,p.ItemNum+1);if(this._obsType.indexOf(p.id)>=0){var h=this.checkNeiProbability(e,p.id,o,i);(0!=h||0!=(h=this.checkBelProbability(t,p.id,o,i)))&&(u=h)}return[p.id,u]},t.prototype.checkNeiProbability=function(t,e,o,i){var n;if(0==o)return!1;if(!t[t.length-1])return!1;if((null===(n=t[t.length-1])||void 0===n?void 0:n.obsType)!=e)return!1;if(!this._bossHpState.nei){var a=this.getParam(f.enumBBD2GearParameterCfg.NeiProbability).split("|");this._bossHpState.nei=[];for(var r=0;r<a.length;r++){var s=(m=a[r]).split("_");this._bossHpState.nei.push([parseInt(s[0]),parseInt(s[1])])}}for(var c=d.Utils.randomRang(0,100),l=0,p=999999,u=this._bossHpState.nei,h=0;h<u.length;h++){var m;i<=(m=u[h])[0]&&p>m[0]&&(l=m[1],p=m[0])}return c<l&&t[t.length-1].type},t.prototype.checkBelProbability=function(t,e,o,i){if(!t)return!1;if(!t[o])return!1;if(t[o].obsType!=e)return!1;if(!this._bossHpState.bel){var n=this.getParam(f.enumBBD2GearParameterCfg.NeiProbability).split("|");this._bossHpState.bel=[];for(var a=0;a<n.length;a++){var r=(h=n[a]).split("_");this._bossHpState.bel.push([parseInt(r[0]),parseInt(r[1])])}}for(var s=d.Utils.randomRang(0,100),c=0,l=999999,p=this._bossHpState.bel,u=0;u<p.length;u++){var h;i<=(h=p[u])[0]&&l>h[0]&&(c=h[1],l=h[0])}return s<c&&t[o].type},e=r([g],t)}());a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBD2_UIBuff:[function(t,e,o){"use strict";cc._RF.push(e,"7bb8fpBiHZMH7D1lZfbpkLR","BBD2_UIBuff");var i=t,n=e,a=o;cc._RF.push(n,"7bb8fpBiHZMH7D1lZfbpkLR","BBD2_UIBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("EventMgr"),d=i("Utils"),h=i("BBD2_Configs"),f=i("BBD2_DataMgr"),m=i("BBD2_UIGame"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndItem=[],e._buffArr=[],e}return s(e,t),e.prototype.start=function(){var t=this,e=f.default.getInstance().randomBuff();this._buffArr=e;for(var o=function(o){var n=i.ndItem[o];i.restUI(n,e[o]),cc.tween(n).set({scale:0}).delay(.2+.1*o).set({scaleX:1.1,scaleY:.5}).to(.12,{scaleX:.9,scaleY:1.2}).to(.09,{scaleX:1.05,scaleY:.95}).to(.06,{scale:1}).start(),n.on(cc.Node.EventType.TOUCH_END,function(){p.AudioMgr.getInstance().playAudioButtonClicked(),t.clickItem(e[o].ID)},i)},i=this,n=0;n<this.ndItem.length;n++)o(n)},e.prototype.restUI=function(t,e){t.getChildByName("labName").getComponent(cc.Label).string=e.buffName,t.getChildByName("labText").getComponent(cc.RichText).string="<b><outline color=\u201c#000000\u201d width=4>"+d.Utils.StringFormat(e.buffCopy1,e.buffParametric)+"</outline></b>";var o=t.getChildByName("icon").getComponent(cc.Sprite),i=""+e.icon1;m.default.instance.loadIcon(o,i)},e.prototype.clickItem=function(t){f.default.getInstance().getSeleteBuff(t),u.EventMgr.getInstance().emit(h.BBD2EventName.GameCloseAlert),this.closeUI()},c([v([cc.Node])],e.prototype,"ndItem",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],BBD2_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"a3e27qr3/JNyK3/5g41T+4j","BBD2_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"a3e27qr3/JNyK3/5g41T+4j","BBD2_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("EventMgr"),h=i("PoolMgr"),f=i("UIMgr"),m=i("BBD2_APP"),g=i("BBD2_Configs"),y=i("BBD2GameEnumData"),v=i("BBD2MapGrid"),_=i("BBD2_DataMgr"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsItem=null,e.arrow2Item=null,e.animItem=null,e.stopNode=null,e.mapGridCrtl=null,e._gameOver=!1,e._seletState=0,e._seletBuff=[],e._openUIState=!1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,h.PoolMgr.getInstance().creatrePool(g.BBD2PoolName.GridItem,this.obsItem,5),h.PoolMgr.getInstance().creatrePool(g.BBD2PoolName.AnimItem,this.animItem,1),h.PoolMgr.getInstance().creatrePool(g.BBD2PoolName.ArrowItem,this.arrow2Item,2),this.weblinkLabel.active=!0,this.weblinkLabel2.active=l.Platform.WEB_LINK==u.PlatformSetting.currentPlatform},e.prototype.onEnable=function(){d.EventMgr.getInstance().on(g.BBD2EventName.GameGetBuff,this,this.eventGetBuff),this.addEvent(g.BBD2EventName.GameCloseAlert,this.changeSeletState.bind(this))},e.prototype.onDisable=function(){d.EventMgr.getInstance().off(g.BBD2EventName.GameGetBuff,this,this.eventGetBuff)},e.prototype.start=function(){},e.prototype.changeSeletState=function(){this._seletState--,this.OpenBuffSelet(),this._seletState<=0&&(this._seletState=0,this._openUIState=!1)},e.prototype.checkIsMove=function(){return!(this._gameOver||this._seletState>0)},e.prototype.eventOpenBuffSelet=function(t){this._seletState++,this.addUIAlert(g.BBD2_UIID.UIBuff,t)},e.prototype.addUIAlert=function(t,e){void 0===e&&(e=null);var o={UIID:t,data:e};this._seletBuff.push(o),this._openUIState||(this._openUIState=!0,this.OpenBuffSelet())},e.prototype.OpenBuffSelet=function(){this._seletBuff.length>0&&(this.openUI(this._seletBuff[0].UIID,this._seletBuff[0].data),this._seletBuff.splice(0,1))},e.prototype.openGameResultUI=function(t){var e=this;void 0===t&&(t=!0),this._gameOver=!0,this.scheduleOnce(function(){f.UIMgr.getInstance().closeById(g.BBD2_UIID.UIBuff),e.openUI(g.BBD2_UIID.UIResult,t)},1)},e.prototype.update=function(t){this.checkIsMove()&&d.EventMgr.getInstance().emit(g.BBD2EventName.GameUpdata,t)},e.prototype.getPoolNode=function(t){var e=h.PoolMgr.getInstance().getNode(t);return e.active=!0,e},e.prototype.freePoolNode=function(t,e){e.active=!1,h.PoolMgr.getInstance().freeNode(t,e)},e.prototype.loadIcon=function(t,e){var o=g.emBBD2Bundles.GameIcon,i="icon/"+e;this.loadSpriteFrame(o,i,function(e){cc.isValid(t)&&(t.spriteFrame=e)})},e.prototype.loadResSkeleton=function(t,e,o,i){this.loadResFromBundle(e,o,sp.SkeletonData,function(e){t&&(null==t?void 0:t.isValid)&&i(e)})},e.prototype.getObsHp=function(t){return t==g.BBD2GameObsTypeHp.ord?_.default.getInstance().getParam(y.enumBBD2GearParameterCfg.BallHp):t==g.BBD2GameObsTypeHp.obs?_.default.getInstance().getParam(y.enumBBD2GearParameterCfg.BarHp):t==g.BBD2GameObsTypeHp.bomb?_.default.getInstance().getParam(y.enumBBD2GearParameterCfg.BombHp):t==g.BBD2GameObsTypeHp.box?_.default.getInstance().getParam(y.enumBBD2GearParameterCfg.BoxHp):t==g.BBD2GameObsTypeHp.grass?_.default.getInstance().getParam(y.enumBBD2GearParameterCfg.GrassHp):t==g.BBD2GameObsTypeHp.back?_.default.getInstance().getParam(y.enumBBD2GearParameterCfg.HookHp):1},e.prototype.eventGetBuff=function(){},e.prototype.onClickOpenSet=function(){this._gameOver||(this._seletState++,this.stopNode.active=!0)},e.prototype.onClickCloseSet=function(){this._gameOver||(this._seletState--,this.stopNode.active=!1)},e.prototype.onClickExitApp=function(){this._gameOver||(this.closeUI(),m.default.instance.exit_App(0))},c([I({type:cc.Node,tooltip:""})],e.prototype,"obsItem",void 0),c([I({type:cc.Node,tooltip:""})],e.prototype,"arrow2Item",void 0),c([I({type:cc.Node,tooltip:""})],e.prototype,"animItem",void 0),c([I({type:cc.Node,tooltip:""})],e.prototype,"stopNode",void 0),c([I({type:v.default,tooltip:""})],e.prototype,"mapGridCrtl",void 0),c([I(cc.Node)],e.prototype,"weblinkLabel",void 0),c([I(cc.Node)],e.prototype,"weblinkLabel2",void 0),o=c([B],e)}(p.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BBD2_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"6e7cbuBlaJH7YFGukse+oLf","BBD2_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"6e7cbuBlaJH7YFGukse+oLf","BBD2_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("NodeLib"),u=i("BBD2_APP"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ndWin=null,e.pro_ndFail=null,e.pro_btn=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.initproperty=function(){this.pro_ndWin=p.default.findChildByName(this.node,"pro_ndWin"),this.pro_ndFail=p.default.findChildByName(this.node,"pro_ndFail"),this.pro_btn=p.default.findChildByName(this.node,"pro_btn")},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initView(),this.pro_btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.pro_ndFail.active=!this.isWin,this.pro_ndWin.active=this.isWin},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BBD2_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"1af3egaTSBLP6pmb/8m+tgq","BBD2_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"1af3egaTSBLP6pmb/8m+tgq","BBD2_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("NodeLib"),d=i("BBD2_APP"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_musicSlider=null,e.pro_effectSlider=null,e.pro_btnClose=null,e.pro_btnBackHome=null,e.pro_btnPlay=null,e.pro_gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.initproperty=function(){this.pro_musicSlider=u.default.findChildByName(this.node,"pro_musicSlider").getComponent(cc.Slider),this.pro_effectSlider=u.default.findChildByName(this.node,"pro_effectSlider").getComponent(cc.Slider),this.pro_btnClose=u.default.findChildByName(this.node,"pro_btnClose"),this.pro_btnBackHome=u.default.findChildByName(this.node,"pro_btnBackHome"),this.pro_btnPlay=u.default.findChildByName(this.node,"pro_btnPlay"),this.pro_gmNode=u.default.findChildByName(this.node,"pro_gmNode"),this.pro_musicSlider.progress=p.AudioMgr.getInstance().getMusicVolume(),this.pro_effectSlider.progress=p.AudioMgr.getInstance().getEffectVolume()},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.pro_musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.pro_effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.pro_musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.pro_effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.pro_musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),p.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.pro_gmNode.on(cc.Node.EventType.TOUCH_END,function(){}),this.pro_effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),p.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.pro_btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.pro_btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){d.default.instance.exit_App(0)}),this.pro_btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BBDAnima:[function(t,e,o){"use strict";cc._RF.push(e,"12c47aT4q1F3YgWpLzsiXyh","BBDAnima");var i=t,n=e,a=o;cc._RF.push(n,"12c47aT4q1F3YgWpLzsiXyh","BBDAnima");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("BBD_Configs"),u=i("BBD_UIGame"),d=cc._decorator,h=d.ccclass,f=d.property,m={1:{path:"ppl_boom",audio:p.BBD_AudioId.boom},2:{path:"ppl_iceboom"},3:{path:"ppl_flash",audio:p.BBD_AudioId.flsah},4:{path:"ppl_broken",audio:p.BBD_AudioId.ppBomb},5:{path:"ppl_fade",audio:p.BBD_AudioId.hit},6:{path:"ppl_hook",audio:p.BBD_AudioId.hook},7:{path:"ppl_gyskill",audio:p.BBD_AudioId.gySkill},8:{path:"ppl_wkskill",audio:p.BBD_AudioId.swkSkill},9:{path:"ppl_zxskill",audio:p.BBD_AudioId.zxSkill},10:{path:"PungFX",audio:p.BBD_AudioId.grassboom}},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animItem=null,e._hurtData=null,e}return s(e,t),e.prototype.init=function(t){var e=this;this._hurtData=t;var o=p.emBBDBundles.GameIcon,i="anim/"+m[t.type].path+"/"+m[t.type].path;t.pos?this.node.setPosition(t.pos):this.node.setPosition(cc.v3(0,0,0)),t.scal?this.node.setScale(t.scal):this.node.setScale(cc.v3(1,1,1)),m[t.type].audio&&l.AudioMgr.getInstance().playEffectFree(m[t.type].audio);var n=this.animItem;n.skeletonData=null,n.node.active=!1,u.default.instance.loadResSkeleton(this.node,o,i,function(o){n.node.active=!0,n.skeletonData=o;var i="animation";t.animaName&&(i=t.animaName),t.skin&&n.setSkin(t.skin),n.setAnimation(0,i,!1),n.setCompleteListener(null),n.setCompleteListener(function(){t.callback&&t.callback(),n.setCompleteListener(null),u.default.instance.freePoolNode(p.BBDPoolName.AnimItem,e.node)})})},c([f({type:sp.Skeleton,tooltip:""})],e.prototype,"animItem",void 0),c([h],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BBDArrowItem2:[function(t,e,o){"use strict";cc._RF.push(e,"3f7291wq+ZCGaacoG0Vo4kh","BBDArrowItem2");var i=t,n=e,a=o;cc._RF.push(n,"3f7291wq+ZCGaacoG0Vo4kh","BBDArrowItem2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("EventMgr"),p=i("BBD_Configs"),u=i("BBD_DataMgr"),d=i("BBD_UIGame"),h=i("BBDGridItem"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsIcon=null,e._tempPos=cc.v3(),e._data={type:0,idx:0,playType:0},e._mapdata=null,e.startX=p.BBDGameData.startX,e.itemW=p.BBDGameData.itemW,e._type=0,e._spData=null,e._nowIdx=-999,e._endPos=null,e._speed=24,e._attackNum=0,e}return s(e,t),e.prototype.onEnable=function(){l.EventMgr.getInstance().on(p.BBDEventName.GameUpdata,this,this.onUpdate)},e.prototype.onDisable=function(){l.EventMgr.getInstance().off(p.BBDEventName.GameUpdata,this,this.onUpdate)},e.prototype.init=function(t,e){this._data=t,this._mapdata=e,this._nowIdx=t.idx,this._type=t.type,this._spData=t.skill,this.loadIcon(this._data.playType)},e.prototype.loadIcon=function(t){var e="bullet"+t;d.default.instance.loadIcon(this.obsIcon,e)},e.prototype.refreshPos=function(){this.restPos()},e.prototype.restPos=function(){for(var t,e,o=null,i=this._mapdata.length-1;i>=0;i--){var n=this._mapdata[i];if(null===(t=n[this._nowIdx])||void 0===t?void 0:t.node){o=null===(e=n[this._nowIdx])||void 0===e?void 0:e.node,this._endPos=o;break}}},e.prototype.onUpdate=function(){this.refreshPos();var t=p.BBDGameData.startY+p.BBDGameData.itemH;this._endPos&&(t=this._endPos.y),t-this.node.y>this._speed?this.node.y+=this._speed:(this.checkAttObs2(),d.default.instance.freePoolNode(p.BBDPoolName.ArrowItem,this.node))},e.prototype.checkAttObs2=function(){for(var t,e=this._spData,o=null,i=this._mapdata.length-1;i>=0;i--){var n=this._mapdata[i];if(null===(t=n[this._nowIdx])||void 0===t?void 0:t.node){o=n[this._nowIdx].node;break}}if(o)if(e&&e.spType){var a=o.getComponent(h.default).getGridId();3==e.spType&&d.default.instance.mapGridCrtl.checkBuff3Bomb(a),4==e.spType&&d.default.instance.mapGridCrtl.checkBuff4Bomb(a),5==e.spType&&(d.default.instance.mapGridCrtl.creatAnim({type:1,pos:this.node.getPosition()}),d.default.instance.mapGridCrtl.checkBuff5Light(a))}else{var r={type:this._type,num:1},s=u.default.getInstance().checkBuffIsGet(7);s&&(this._attackNum++,this._attackNum>=s.buffParametric&&(r.num=999,this._attackNum=0)),o.getComponent(h.default).attack(r)}else l.EventMgr.getInstance().emit(p.BBDEventName.GameAttackDrog,!0);e&&e.skill&&this.checkPlayAttSkill(e,o)},e.prototype.checkPlayAttSkill=function(t){var e={};1==t.skill?(e.type=7,e.pos=cc.v3(this.node.x,0),e.callback=function(){l.EventMgr.getInstance().emit(p.BBDEventName.GamePlayerSkillEnd)},d.default.instance.mapGridCrtl.playSkill1(this._nowIdx)):2==t.skill?(e.type=8,e.pos=cc.v3(this.node.x,0),e.callback=function(){l.EventMgr.getInstance().emit(p.BBDEventName.GamePlayerSkillEnd)},d.default.instance.mapGridCrtl.playSkill2(this._nowIdx)):3==t.skill&&(e.type=9,e.callback=function(){l.EventMgr.getInstance().emit(p.BBDEventName.GamePlayerSkillEnd)},d.default.instance.mapGridCrtl.playSkill3(this._nowIdx)),d.default.instance.mapGridCrtl.creatAnim(e)},c([g({type:cc.Sprite})],e.prototype,"obsIcon",void 0),c([m],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBDArrowItem:[function(t,e,o){"use strict";cc._RF.push(e,"5fba1Qf7pNPD51tEmv9Lt/n","BBDArrowItem");var i=t,n=e,a=o;cc._RF.push(n,"5fba1Qf7pNPD51tEmv9Lt/n","BBDArrowItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("EventMgr"),p=i("BBD_Configs"),u=i("BBD_UIGame"),d=i("BBDGridItem"),h=cc._decorator,f=h.ccclass,m=h.property,g={1:"skin_4",2:"skin_5",3:"skin_3",4:"skin_2",5:"skin_1"},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsIcon=null,e.tipIcon=null,e.playerNode=null,e.animaNode=null,e._tempPos=cc.v3(),e._data=null,e._mapdata=null,e.startX=p.BBDGameData.startX,e.itemW=p.BBDGameData.itemW,e._speed=12,e._nowIdx=-999,e}return s(e,t),e.prototype.onEnable=function(){l.EventMgr.getInstance().on(p.BBDEventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().on(p.BBDEventName.GameRestArrowIcon,this,this.loadSpArrow),l.EventMgr.getInstance().on(p.BBDEventName.GameArrowAttow2,this,this.checkAttObs2)},e.prototype.onDisable=function(){l.EventMgr.getInstance().off(p.BBDEventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().off(p.BBDEventName.GameRestArrowIcon,this,this.loadSpArrow),l.EventMgr.getInstance().off(p.BBDEventName.GameArrowAttow2,this,this.checkAttObs2)},e.prototype.init=function(t,e){this._data=t,this._mapdata=e,this.loadIcon(this._data.type)},e.prototype.loadIcon=function(t){var e="arrow_"+t;this.loadIcon2(t),u.default.instance.loadIcon(this.obsIcon,e)},e.prototype.loadIcon2=function(t){for(var e="light"+t,o=0;o<this.tipIcon.children.length;o++){var i=this.tipIcon.children[o];u.default.instance.loadIcon(i.getComponent(cc.Sprite),e)}},e.prototype.loadSpArrow=function(t){if(t){var e="";3==t?e="type3_1":5==t?e="type7_1":4==t&&(e="type3_2"),u.default.instance.loadIcon(this.obsIcon,e)}else this.loadIcon(this._data.type)},e.prototype.refreshPos=function(){var t=(this.playerNode.position.x-(this.startX-this.itemW/2))/this.itemW,e=Math.floor(t);e=e<0?0:e,this._nowIdx!=e&&(this._nowIdx=e),this.restPos()},e.prototype.restPos=function(){for(var t,e,o,i=!1,n=null,a=this._mapdata.length-1;a>=0;a--){var r=this._mapdata[a];if(null===(t=r[this._nowIdx])||void 0===t?void 0:t.node){i=!0,n=null===(e=r[this._nowIdx])||void 0===e?void 0:e.node,null===(o=r[this._nowIdx])||void 0===o||o.node.getPosition(this._tempPos);break}}i?this._tempPos.y-=p.BBDGameData.itemH:(this._tempPos.x=p.BBDGameData.startX+p.BBDGameData.itemW*this._nowIdx,this._tempPos.y=p.BBDGameData.startY+p.BBDGameData.itemH),this.node.setPosition(cc.v3(this._tempPos.x,-430)),this.tipIcon.parent.setPosition(cc.v3(this._tempPos.x,this.node.y));var s=this._tempPos.y-this.node.y;s=36*Math.round(s/36),this.tipIcon.parent.height=s,this.refreshAnimaNode(n)},e.prototype.refreshAnimaNode=function(t){t?(this.animaNode.parent=t,t.getComponent(d.default).setGridSeletZindex(this.animaNode),this.animaNode.x=0,this.animaNode.y=0,this.animaNode.active=!0):this.animaNode.active=!1},e.prototype.onUpdate=function(){this.refreshPos()},e.prototype.playAnima=function(){},e.prototype.checkAttObs=function(t){this.playAnima(),this._data.idx=this._nowIdx,this._data.pos.x=this.node.x,this.node.opacity=1,this.tipIcon.opacity=1,this._data.skill=t,u.default.instance.mapGridCrtl.creatArrow2(this._data);var e=(this._tempPos.y- -443)/430,o={type:5,pos:cc.v3(this.node.x,-443),skin:g[this._data.type],scal:cc.v3(1,e,1)};u.default.instance.mapGridCrtl.creatAnim(o)},e.prototype.checkAttObs2=function(){this.node.opacity=255,this.tipIcon.opacity=255},c([m({type:cc.Sprite})],e.prototype,"obsIcon",void 0),c([m({type:cc.Node})],e.prototype,"tipIcon",void 0),c([m({type:cc.Node})],e.prototype,"playerNode",void 0),c([m({type:cc.Node})],e.prototype,"animaNode",void 0),c([f],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBDBossItem:[function(t,e,o){"use strict";cc._RF.push(e,"f5a61jClbhNWrrZMHX+RcBT","BBDBossItem");var i=t,n=e,a=o;cc._RF.push(n,"f5a61jClbhNWrrZMHX+RcBT","BBDBossItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("Utils"),d=i("BBD_Configs"),h=i("BBDGameEnumData"),f=i("BBD_DataMgr"),m=i("BBD_UIGame"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.body=null,e.hpProg=null,e._hp=0,e._hpMax=0,e}return s(e,t),e.prototype.onLoad=function(){this.loadBody(),this.restData()},e.prototype.onEnable=function(){p.EventMgr.getInstance().on(d.BBDEventName.GameAttackDrog,this,this.attackDrag),p.EventMgr.getInstance().on(d.BBDEventName.GameIceDrog,this,this.iceDrog),p.EventMgr.getInstance().on(d.BBDEventName.GameDragAttack,this,this.attackDrag2)},e.prototype.onDisable=function(){p.EventMgr.getInstance().off(d.BBDEventName.GameAttackDrog,this,this.attackDrag),p.EventMgr.getInstance().off(d.BBDEventName.GameIceDrog,this,this.iceDrog)},e.prototype.restData=function(){this._hp=f.default.getInstance().getParam(h.enumBBDGearParameterCfg.BOSSHp),this._hpMax=this._hp,this.refreshUI()},e.prototype.refreshUI=function(){this.hpProg.progress=this._hp/this._hpMax},e.prototype.attackDrag2=function(){l.AudioMgr.getInstance().playEffectFree(d.BBD_AudioId.bossatk);var t=this.body;t&&t.skeletonData&&(t.setAnimation(0,d.BBDAnimName.Attack,!1),t.setCompleteListener(function(){t.setAnimation(0,d.BBDAnimName.Idle,!0),t.setCompleteListener(null)}))},e.prototype.getBossHp=function(){return this._hp/this._hpMax},e.prototype.attackDrag=function(t){var e=t.type,o=1,i=null;if(4==e)i=f.default.getInstance().checkBuffIsGet(10);else if(3==e){var n=f.default.getInstance().checkBuffIsGet(11);n&&u.Utils.randomRang(0,100)<=n.buffParametric&&m.default.instance.mapGridCrtl.checkIceBomb()}else 5==e?i=f.default.getInstance().checkBuffIsGet(12):2==e?i=f.default.getInstance().checkBuffIsGet(13):1==e&&(i=f.default.getInstance().checkBuffIsGet(14));i&&u.Utils.randomRang(0,100)<=i.buffParametric&&(o=2),this._hp-=o,l.AudioMgr.getInstance().playEffectFree(d.BBD_AudioId.hitboss);var a=this.body;a.setAnimation(0,d.BBDAnimName.Hit,!1),a.setCompleteListener(function(){a.setAnimation(0,d.BBDAnimName.Idle,!0),a.setCompleteListener(null)}),this._hp<=0&&m.default.instance.openGameResultUI(!0),this.refreshUI()},e.prototype.iceDrog=function(t){void 0===t&&(t=!1);var e="#FFFFFF";t?(this.body.timeScale=0,e="#69C5FE"):this.body.timeScale=1,this.body.node.color=cc.color().fromHEX(e)},e.prototype.loadBody=function(){var t=this,e=this.body;e.skeletonData=null;var o=d.emBBDBundles.GameIcon;m.default.instance.loadResSkeleton(e.node,o,"anim/ppl_dragon/ppl_dragon",function(o){var i;(null===(i=t.node)||void 0===i?void 0:i.isValid)&&(e.skeletonData=o,e.setAnimation(0,d.BBDAnimName.Idle,!0))})},e.prototype.start=function(){},c([v({type:sp.Skeleton})],e.prototype,"body",void 0),c([v({type:cc.ProgressBar})],e.prototype,"hpProg",void 0),c([y],e)}(cc.Component);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],BBDGameData:[function(t,e,o){"use strict";cc._RF.push(e,"0c254e0Ff9JIbDRow2bbsCD","BBDGameData");var i=e,n=o;cc._RF.push(i,"0c254e0Ff9JIbDRow2bbsCD","BBDGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emBBDGameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.characterCfg="characterCfg",t.GearParameterCfg="GearParameterCfg",t.dropCfg="dropCfg"}(n.emBBDGameDataKeys||(n.emBBDGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],BBDGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"acaf55m/cJLSrUnYruploBX","BBDGameEnumData");var i=e,n=o;cc._RF.push(i,"acaf55m/cJLSrUnYruploBX","BBDGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBBDGearParameterCfg=void 0,function(t){t[t.WeaponNum=1]="WeaponNum",t[t.BOSSHp=2]="BOSSHp",t[t.BallHp=3]="BallHp",t[t.WeaponAtk=4]="WeaponAtk",t[t.BoxHp=5]="BoxHp",t[t.BarHp=6]="BarHp",t[t.HookHp=7]="HookHp",t[t.BombHp=8]="BombHp",t[t.BossTime=9]="BossTime",t[t.AttackTime=10]="AttackTime",t[t.BombArea=11]="BombArea",t[t.FlashHp=12]="FlashHp",t[t.GuanyuCharge=13]="GuanyuCharge",t[t.ZixiaCharge=14]="ZixiaCharge",t[t.MonkeyCharge=15]="MonkeyCharge",t[t.FreezeTime=16]="FreezeTime",t[t.NeiProbability=17]="NeiProbability",t[t.belProbability=18]="belProbability",t[t.DynDifficulty=19]="DynDifficulty",t[t.GrassHp=20]="GrassHp"}(n.enumBBDGearParameterCfg||(n.enumBBDGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],BBDGridItem:[function(t,e,o){"use strict";cc._RF.push(e,"bc21cmzNbNABqJsp4zT9Azr","BBDGridItem");var i=t,n=e,a=o;cc._RF.push(n,"bc21cmzNbNABqJsp4zT9Azr","BBDGridItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Utils"),p=i("BBD_Configs"),u=i("BBD_DataMgr"),d=i("BBD_UIGame"),h=cc._decorator,f=h.ccclass,m=h.property,g={1:"skin4",2:"skin5",3:"skin3",4:"skin1",5:"skin2"},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsIcon=null,e._data=null,e._hp=0,e._hpMax=0,e._hpPro=null,e._moveState=!1,e._moveFun=null,e._moveFunArm=null,e._upY=0,e._isDiy=!1,e}return s(e,t),e.prototype.onEnable=function(){},e.prototype.init=function(t){this._data=t,this.loadIcon(),this._hp=d.default.instance.getObsHp(this._data.obsType),this._hpMax=this._hp,this._hpPro=this.node.getChildByName("prog").getComponent(cc.ProgressBar),this._hpPro.node.active=!1},e.prototype.getGridId=function(){return this._data.ID},e.prototype.getGridObsType=function(){return this._data.obsType},e.prototype.setGridSeletZindex=function(t){var e=this.node.getChildByName("selet");t.setParent(e)},e.prototype.loadIcon=function(){var t="type"+this._data.obsType+"_"+this._data.type;d.default.instance.loadIcon(this.obsIcon,t)},e.prototype.moveDownGrid=function(t){var e=this;if(void 0===t&&(t=!1),!this._isDiy){this._moveState=!0,cc.Tween.stopAllByTarget(this.node);var o=t?1:255;cc.tween(this.node).to(0,{opacity:o}).by(.2,{position:cc.v3(0,-p.BBDGameData.itemH,0),opacity:255}).call(function(){e._moveState=!1,e._moveFun&&(e._moveFun(),e._moveFun=null)}).start()}},e.prototype.moveUpGrid=function(t){var e=this;if(void 0===t&&(t=null),!this._isDiy){if(this._upY+=p.BBDGameData.itemH,this._moveState)return this._moveFunArm=t,void(this._moveFun=this.moveUpGrid);cc.Tween.stopAllByTarget(this.node);var o=0;t&&(o=-255),cc.tween(this.node).by(.2,{position:cc.v3(0,this._upY,0),opacity:o}).call(function(){e._upY=0}).start()}},e.prototype.moveUpPool=function(t){var e=this;if(!this._isDiy){this._isDiy=!0;var o=10-t;o=o>=0?o:0,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).by(.05*o,{position:cc.v3(0,-p.BBDGameData.itemH*o,0)}).call(function(){e.recycleGrid2(),e.recycleDownGrid3()}).start()}},e.prototype.attack=function(t){var e=t.type,o=this._data.obsType,i=this._data.type,n=t.num;if(o!=p.BBDGameObsTypeHp.ord&&o!=p.BBDGameObsTypeHp.obs&&o!=p.BBDGameObsTypeHp.bomb&&o!=p.BBDGameObsTypeHp.grass||e==i&&(n*=3),o==p.BBDGameObsTypeHp.ord){var a=u.default.getInstance().checkBuffIsGet(9);a&&l.Utils.randomRang(0,100)<=a.buffParametric&&(n=9999)}this._hp-=n,this._hp<=0?(this.gridDiy(!0),this._hpPro.node.active=!1):(this._hpPro.node.active=!0,this._hpPro.progress=this._hp/this._hpMax)},e.prototype.gridDiy=function(t){if(void 0===t&&(t=!1),this._data.obsType==p.BBDGameObsTypeHp.grass&&t){var e=d.default.instance.mapGridCrtl.getGridX_Y(this._data.ID);return d.default.instance.mapGridCrtl.gridDiy(this._data,e[0],e[1],t),void this.grassChangeType()}this.recycleGrid(t)},e.prototype.grassChangeType=function(){var t=this._data.obsType;if(t==p.BBDGameObsTypeHp.grass){for(var e=l.Utils.randomRang(1,p.BBDGameObsTypeNum[t]+1);e==this._data.type;)e=l.Utils.randomRang(1,p.BBDGameObsTypeNum[t]+1);this._data.obsType=p.BBDGameObsTypeHp.ord,this._data.type=e,this.init(this._data);var o={type:10,pos:this.node.getPosition()};d.default.instance.mapGridCrtl.creatAnim(o)}},e.prototype.recycleGrid=function(t){d.default.instance.mapGridCrtl.recycleGrid(this._data.ID,t),this.recycleGrid2()},e.prototype.recycleGrid2=function(){if(!this._data.isRecycle){var t=this.node.getChildByName("selet");if(t.children.length>0&&(t.children[0].parent=null),this._isDiy=!1,this._data.isRecycle=!0,d.default.instance.freePoolNode(p.BBDPoolName.GridItem,this.node),this._data.obsType==p.BBDGameObsTypeHp.ord||this._data.obsType==p.BBDGameObsTypeHp.grass){var e={type:4,skin:g[this._data.type],pos:this.node.getPosition()};d.default.instance.mapGridCrtl.creatAnim(e)}}},e.prototype.recycleDownGrid3=function(){this._data.obsType==p.BBDGameObsTypeHp.box?d.default.instance.mapGridCrtl.openBuffUI():this._data.obsType==p.BBDGameObsTypeHp.back?d.default.instance.mapGridCrtl.backFun():this._data.obsType==p.BBDGameObsTypeHp.bomb&&2==this._data.type&&d.default.instance.mapGridCrtl.iceBombFun()},e.prototype.onUpdate=function(){this._moveState},c([m({type:cc.Sprite})],e.prototype,"obsIcon",void 0),c([f],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBDMapGrid:[function(t,e,o){"use strict";cc._RF.push(e,"4caf4aeeXhPj5EyMRe86iMW","BBDMapGrid");var i=t,n=e,a=o;cc._RF.push(n,"4caf4aeeXhPj5EyMRe86iMW","BBDMapGrid");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("EventMgr"),p=i("Utils"),u=i("BBD_Configs"),d=i("BBDGameEnumData"),h=i("BBD_DataMgr"),f=i("BBD_UIGame"),m=i("BBDAnima"),g=i("BBDArrowItem"),y=i("BBDArrowItem2"),v=i("BBDBossItem"),_=i("BBDGridItem"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridParent=null,e.arrowItem=null,e.bossItem=null,e.startX=u.BBDGameData.startX,e.endX=275,e.startY=u.BBDGameData.startY,e.endY=-438,e.itemW=u.BBDGameData.itemW,e.itemH=u.BBDGameData.itemH,e._buffId19Num=0,e._iceTime=0,e._bossHpState=null,e._gridRestTimeMax=0,e._gridRestTime=0,e._moveState=0,e._initState=!1,e._mapGrid=[],e._ID=1,e._tempPos=cc.v3(),e._obsType=[u.BBDGameObsTypeHp.ord,u.BBDGameObsTypeHp.grass,u.BBDGameObsTypeHp.obs],e._basrArr=[],e}return s(e,t),e.prototype.onLoad=function(){this._gridRestTimeMax=h.default.getInstance().getParam(d.enumBBDGearParameterCfg.BossTime),this.endX=this.startX+this.itemW*u.BBDGameData.BaseRow-this.itemW/2,this.endX=this.startY+this.itemH*u.BBDGameData.BaseCol+this.itemH/2},e.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onClickTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onClickTouchMove,this),l.EventMgr.getInstance().on(u.BBDEventName.GameCreatArrow,this,this.creatArrow),l.EventMgr.getInstance().on(u.BBDEventName.GameArrowAttow,this,this.arrowAttack),l.EventMgr.getInstance().on(u.BBDEventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().on(u.BBDEventName.GameGetBuff,this,this.eventGetBuff)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClickTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onClickTouchMove,this),l.EventMgr.getInstance().off(u.BBDEventName.GameCreatArrow,this,this.creatArrow),l.EventMgr.getInstance().off(u.BBDEventName.GameArrowAttow,this,this.arrowAttack),l.EventMgr.getInstance().off(u.BBDEventName.GameUpdata,this,this.onUpdate),l.EventMgr.getInstance().off(u.BBDEventName.GameGetBuff,this,this.eventGetBuff)},e.prototype.start=function(){},e.prototype.eventGetBuff=function(t){var e=this;if(19==t)this._buffId19Num=1;else if(20==t)this.buffSuprBomb();else if(21==t){this.creatAnim({type:2});var o=h.default.getInstance().getBuffDataIdData(t);this.checkIceBomb(o.buffParametric)}else if(22==t){this._moveState++;var i={type:6,pos:cc.v3(0,1242,0),callback:function(){cc.tween(e.node).delay(.5).call(function(){e._moveState--}).start();for(var t=0;t<2;t++){e.checkBack();var o=e._mapGrid.splice(0,1)[0];if(o)for(var i=0;i<o.length;i++)if(o[i]){e._basrArr.push(o);break}}}};f.default.instance.mapGridCrtl.creatAnim(i)}},e.prototype.onClickTouchStart=function(t){var e=t.getLocation(),o=this.node.convertToNodeSpaceAR(cc.v3(e.x,e.y));o.x>=this.startX&&o.x<=this.endX&&o.y>=this.startY&&(o.y,this.endY),this.getPosIdx(o)},e.prototype.onClickTouchMove=function(t){var e=t.getLocation(),o=this.node.convertToNodeSpaceAR(cc.v3(e.x,e.y));this.getPosIdx(o,!1)},e.prototype.getPosIdx=function(t,e){void 0===e&&(e=!0);var o=(t.x-(this.startX-this.itemW/2))/this.itemW,i=-1*(t.y-(this.startY+this.itemH/2))/this.itemH,n=Math.floor(o);Math.floor(i),n=(n=n<0?0:n)>=8?7:n,l.EventMgr.getInstance().emit(u.BBDEventName.GamePlayerMove,n,e)},e.prototype.checkIsStop=function(t){return this._iceTime>0&&(this._iceTime-=t,this._iceTime<=0&&l.EventMgr.getInstance().emit(u.BBDEventName.GameIceDrog,!1),!0)},e.prototype.checkBossAttackTime=function(){var t=100*this.bossItem.getBossHp();if(!this._bossHpState){var e=h.default.getInstance().getParam(d.enumBBDGearParameterCfg.DynDifficulty).split("|");this._bossHpState=[];for(var o=0;o<e.length;o++){var i=(r=e[o]).split("_");this._bossHpState.push([parseInt(i[0]),parseInt(i[1])])}}for(var n=this._gridRestTimeMax,a=0;a<this._bossHpState.length;a++){var r;t<=(r=this._bossHpState[a])[0]&&(n=r[1])}return n},e.prototype.onUpdate=function(t){this._moveState>0||this.checkIsStop(t)||(this._gridRestTime-=t,this._gridRestTime<=0&&(this.refreshGrid(),l.EventMgr.getInstance().emit(u.BBDEventName.GameDragAttack),this._gridRestTime=this.checkBossAttackTime()))},e.prototype.gragAttack=function(){},e.prototype.creatObs=function(t){var e=f.default.instance.getPoolNode(u.BBDPoolName.GridItem);return e.parent=this.gridParent,e.setPosition(this._tempPos),e.getComponent(_.default).init(t),e},e.prototype.creatArrow=function(t){this.arrowItem.init(t,this._mapGrid)},e.prototype.creatArrow2=function(t){var e=this.node.parent.getChildByName("arrow2"),o=f.default.instance.getPoolNode(u.BBDPoolName.ArrowItem);o.parent=e,o.setPosition(t.pos),o.getComponent(y.default).init(t,this._mapGrid)},e.prototype.creatAnim=function(t){var e=this.node.parent.getChildByName("anima"),o=f.default.instance.getPoolNode(u.BBDPoolName.AnimItem);o.parent=e,o.getComponent(m.default).init(t)},e.prototype.arrowAttack=function(t){this.arrowItem.checkAttObs(t)},e.prototype.refreshGrid=function(){var t=this,e=this.creatGridData();this._mapGrid.splice(0,0,e);for(var o=0;o<this._mapGrid.length;o++)for(var i=this._mapGrid[o],n=0;n<i.length;n++){var a=i[n];if(a){var r=0==o;a.node.getComponent(_.default).moveDownGrid(r)}}this._mapGrid.length>=10&&f.default.instance.openGameResultUI(!1),this._buffId19Num>0&&this._mapGrid.length>=7&&(this._buffId19Num=0,this.checkIceBomb()),this._initState||(this._initState=!0,cc.tween(this.node).delay(.2).call(function(){t.refreshGrid()}).start())},e.prototype.creatGridData=function(){var t=[];if(this._basrArr.length>0)t=this._basrArr.splice(this._basrArr.length-1,1)[0];else for(var e=0;e<8;e++)t[e]=this._creatGrid(e,t);return t},e.prototype._creatGrid=function(t,e){var o,i=100*this.bossItem.getBossHp(),n={obsType:(o=h.default.getInstance().getObsRangType(this._mapGrid[0],e,t,i))[0],type:o[1],node:null,ID:this._ID,isRecycle:!1};return this._ID++,this.getCreatPos(t),n.node=this.creatObs(n),n},e.prototype.getCreatPos=function(t){this._tempPos.x=u.BBDGameData.startX+u.BBDGameData.itemW*t,this._tempPos.y=u.BBDGameData.startY+u.BBDGameData.itemH},e.prototype.recycleGrid=function(t,e){void 0===e&&(e=!1);for(var o=!1,i=this._mapGrid.length-1;i>=0;i--){for(var n=this._mapGrid[i],a=0;a<n.length;a++){var r=n[a];if(r&&r.ID==t){var s=n[a];n[a]=null,this.gridDiy(s,i,a,e),o=!0;break}}if(o)break}o||console.log("\u51fa\u9519\u4e86")},e.prototype.checkBuff3Bomb=function(t){var e=this.getGridX_Y(t);if(e){var o=this._mapGrid[e[0]][e[1]].node.position;this.creatAnim({type:1,pos:o}),this.checkBomb(e[0],e[1])}},e.prototype.checkBuff4Bomb=function(){this.creatAnim({type:2}),this.checkIceBomb()},e.prototype.checkBuff5Light=function(t){var e=this.getGridX_Y(t);if(e){var o=this._mapGrid[e[0]][e[1]].node.position;this.creatAnim({type:3,pos:cc.v3(0,o.y)}),this.checkLight(e[0])}},e.prototype.getGridX_Y=function(t){for(var e=this._mapGrid.length-1;e>=0;e--)for(var o=this._mapGrid[e],i=0;i<o.length;i++){var n=o[i];if(n&&n.ID==t)return[e,i]}return null},e.prototype.buffSuprBomb=function(){this.creatAnim({type:1,pos:cc.v3(0,0,0)});for(var t=7;t>3;t--)if(this._mapGrid[t])for(var e=2;e<6;e++){var o=this._mapGrid[t][e];o&&o.node.getComponent(_.default).gridDiy()}},e.prototype.checkBomb=function(t,e){for(var o=-1;o<2;o++){var i=t+o,n=this._mapGrid[i];if(n)for(var a=-1;a<2;a++){var r=n[e+a];r&&r.node.getComponent(_.default).gridDiy()}}},e.prototype.checkIceBomb=function(t){void 0===t&&(t=null),this._iceTime=t||h.default.getInstance().getParam(d.enumBBDGearParameterCfg.FreezeTime),l.EventMgr.getInstance().emit(u.BBDEventName.GameIceDrog,!0)},e.prototype.checkBack=function(){for(var t=this._mapGrid.length-1;t>=0;t--)for(var e=this._mapGrid[t],o=0;o<e.length;o++){var i=e[o];if(i){var n=0==t;i.node.getComponent(_.default).moveUpGrid(n)}}},e.prototype.checkLight=function(t){for(var e=this._mapGrid[t],o=0;o<e.length;o++){var i=e[o];i&&i.node.getComponent(_.default).gridDiy()}},e.prototype.checkMapData=function(){for(var t=this._mapGrid.length-1;t>0;t--){for(var e=this._mapGrid[t],o=0,i=0;i<e.length;i++)if(e[i])return void o++;0==o&&this._mapGrid.splice(t,1)}},e.prototype.checkSeparateItem=function(){for(var t=this.findUnreachableOnes(),e=0;e<t.length;e++){var o=t[e],i=this._mapGrid[o[0]][o[1]];this._mapGrid[o[0]][o[1]]=null,i.node.getComponent(_.default).moveUpPool(o[0])}},e.prototype.findUnreachableOnes=function(){var t=this._mapGrid,e=t.length;if(0===e)return[];for(var o=t[0].length,i=Array.from({length:e},function(){return new Array(o).fill(!1)}),n=[],a=0;a<o;a++)null!=t[0][a]&&(n.push([0,a]),i[0][a]=!0);for(var r=[[1,0],[-1,0],[0,1],[0,-1]];n.length>0;)for(var s=n.shift(),c=s[0],l=(a=s[1],0),p=r;l<p.length;l++){var u=p[l],d=c+u[0],h=a+u[1];d>=0&&d<e&&h>=0&&h<o&&null!=t[d][h]&&!i[d][h]&&(i[d][h]=!0,n.push([d,h]))}var f=[];for(c=0;c<e;c++)for(a=0;a<o;a++)null==t[c][a]||i[c][a]||f.push([c,a]);return f},e.prototype.checkFall=function(t,e,o){for(var i,n,a=[[e-1,o],[e+1,o],[e,o-1],[e,o+1]],r=[[e,o]],s=[],c=function(t,e){for(var o=0;o<r.length;o++)if(r[o][0]==t&&r[o][1]==e)return!0;return!1},l=this._mapGrid,d=0,f=t.type;a.length>d;)i=a[d][0],n=a[d][1],i<0||i>=l.length||n>7||n<0||null!=l[i][n]&&(r.push([i,n]),this._obsType.indexOf(l[i][n].obsType)>=0&&l[i][n].type==t.type&&(s.push([i,n]),c(i-1,n)||a.push([i-1,n]),c(i+1,n)||a.push([i+1,n]),c(i,n+1)||a.push([i,n+1]),c(i,n-1)||a.push([i,n-1]))),d++;for(var m=0;m<s.length;m++){var g=l[s[m][0]][s[m][1]];if(g){var y=g.node;g.obsType!=u.BBDGameObsTypeHp.grass?(l[s[m][0]][s[m][1]]=null,y.getComponent(_.default).recycleGrid2()):y.getComponent(_.default).grassChangeType()}}if(s.length>=2)if(3==f){var v=h.default.getInstance().checkBuffIsGet(16);v&&p.Utils.randomRang(0,100)<v.buffParametric&&this.checkIceBomb()}else if(5==f){var b=h.default.getInstance().checkBuffIsGet(17);b&&p.Utils.randomRang(0,100)<b.buffParametric&&this.buff17(e,o)}var B=h.default.getInstance().checkBuffIsGet(8);B&&s.length>=B.buffParametric&&this.checkBomb(e,o)},e.prototype.buff17=function(t,e){for(var o=2,i=-2;i<3;i++){var n=t+i,a=this._mapGrid[n];if(a)for(var r=-2;r<3;r++){var s=a[e+r];if(s){var c=s.node;if(c.getComponent(_.default).getGridObsType()==u.BBDGameObsTypeHp.ord&&(c.getComponent(_.default).gridDiy(),--o<=0))return}}}},e.prototype.playSkill1=function(t){for(var e,o,i=0,n=this._mapGrid.length-1;n>=0;n--)if(null===(e=(r=this._mapGrid[n])[t])||void 0===e?void 0:e.node){i=n;break}var a=i-3;for(a=a>=0?a:-1,n=i;n>a;n--){var r;(null===(o=(r=this._mapGrid[n])[t])||void 0===o?void 0:o.node)&&r[t].node.getComponent(_.default).attack({type:0,num:999})}i<2&&l.EventMgr.getInstance().emit(u.BBDEventName.GameAttackDrog,!0)},e.prototype.playSkill2=function(t){for(var e,o=0,i=this._mapGrid.length-1;i>=0;i--)if(null===(e=this._mapGrid[i][t])||void 0===e?void 0:e.node){o=i+1;break}o<2&&l.EventMgr.getInstance().emit(u.BBDEventName.GameAttackDrog,!0),this.checkBomb(o,t)},e.prototype.playSkill3=function(){for(var t=this,e=0,o=0;o<this._mapGrid.length;o++)for(var i=this._mapGrid[o],n=0;n<i.length;n++)i[n]&&e++;e=e>5?5:e;for(var a=this.randNumPos(e),r=function(e){cc.tween(s.node).delay(.1*e).call(function(){var o=a[e],i=o[1],n=o[0];t._mapGrid[n]&&t._mapGrid[n][i]&&t._mapGrid[n][i].node.getComponent(_.default).gridDiy()}).start()},s=this,c=0;c<a.length;c++)r(c)},e.prototype.randNumPos=function(t){for(var e=[];t>0;){var o=p.Utils.randomRang(0,8),i=p.Utils.randomRang(0,this._mapGrid.length);if(this._mapGrid[i][o]){for(var n=!0,a=0;a<e.length;a++){var r=e[a];if(r[0]==i&&r[1]==o){n=!1;break}}n&&(e.push([i,o]),t--)}}return e},e.prototype.backFun=function(){var t=this;if(!(this._moveState>0)){this._moveState++;var e={type:6,pos:cc.v3(0,1242,0),callback:function(){t.checkBack(),cc.tween(t.node).delay(.2).call(function(){t._moveState--}).start();var e=t._mapGrid.splice(0,1)[0];if(e)for(var o=0;o<e.length;o++)if(e[o])return void t._basrArr.push(e)}};f.default.instance.mapGridCrtl.creatAnim(e)}},e.prototype.iceBombFun=function(){this.creatAnim({type:2}),this.checkIceBomb()},e.prototype.gridDiy=function(t,e,o,i){void 0===i&&(i=!1);var n=t.obsType;if(n==u.BBDGameObsTypeHp.bomb)1==t.type?(this.creatAnim({type:1,pos:t.node.getPosition()}),this.checkBomb(e,o)):this.iceBombFun();else if(n==u.BBDGameObsTypeHp.box)this.openBuffUI();else if(n==u.BBDGameObsTypeHp.back)this.backFun();else if(n==u.BBDGameObsTypeHp.light){this.checkLight(e);var a=t.node.getPosition();this.creatAnim({type:3,pos:cc.v3(0,a.y)})}else n!=u.BBDGameObsTypeHp.ord&&n!=u.BBDGameObsTypeHp.grass&&n!=u.BBDGameObsTypeHp.obs||i&&this.checkFall(t,e,o);this.checkSeparateItem(),this.checkMapData()},e.prototype.openBuffUI=function(){f.default.instance.eventOpenBuffSelet(null)},c([I({type:cc.Node})],e.prototype,"gridParent",void 0),c([I(g.default)],e.prototype,"arrowItem",void 0),c([I(v.default)],e.prototype,"bossItem",void 0),c([B],e)}(cc.Component);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BBDPlayerCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"ecf375C0jZLBIZuDnfhYrbz","BBDPlayerCtrl");var i=t,n=e,a=o;cc._RF.push(n,"ecf375C0jZLBIZuDnfhYrbz","BBDPlayerCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("PlatformSetting"),u=i("EventMgr"),d=i("SdkMgr"),h=i("Utils"),f=i("BBD_Configs"),m=i("BBDGameEnumData"),g=i("BBD_DataMgr"),y=i("BBD_UIGame"),v=cc._decorator,_=v.ccclass,b=v.property,B={1:m.enumBBDGearParameterCfg.GuanyuCharge,2:m.enumBBDGearParameterCfg.ZixiaCharge,3:m.enumBBDGearParameterCfg.MonkeyCharge},I={1:"ppl_gy",2:"ppl_swk",3:"ppl_zx"},P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.body=null,e.playNode=null,e.attProg=null,e.attLab=null,e.skillSpr=null,e.skillSprMask=null,e.skillSprIcon=null,e.GmNode=null,e.nextArrowSpr=[],e._attNum=0,e._attMax=10,e._playType=3,e._isGm=!1,e._buffId18Time=null,e._spArrow=[],e._isGMState=!1,e._moveState=!1,e._nowPosIdx=4,e._nowPosX=0,e._direc=1,e._nowArrow=[],e._attackState=!1,e._attackCool=0,e._attackCoolMax=0,e._isRefreshArrow=!0,e._spareArrowArr=[],e._speed=9,e._playerPos=cc.v3(),e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.node.getPosition(this._playerPos),this._playType=h.Utils.randomRang(1,4),this._attMax=g.default.getInstance().getParam(B[this._playType]),this.loadBody(),this.refreshAttProgUI2(),this.refreshSpareArrows(!1),u.EventMgr.getInstance().on(f.BBDEventName.GamePlayerMove,this,this.moveGrid),u.EventMgr.getInstance().on(f.BBDEventName.GameUpdata,this,this.onUpdate),u.EventMgr.getInstance().on(f.BBDEventName.GameGetBuff,this,this.eventGetBuff),u.EventMgr.getInstance().on(f.BBDEventName.GamePlayerSkillEnd,this,this.GamePlayerSkillEnd),this.body.setEventListener(function(e,o){"atk"==o.data.name&&t.startAttck2()}),this._isGm=d.SdkMgr.getInstance().getCheckVersion(p.SwitchID.ShenHe_ABD)||p.PlatformSetting.currentPlatform==l.Platform.EDITOR||p.PlatformSetting.currentPlatform==l.Platform.WEB_LINK,this.GmNode.active=this._isGm,this.attProg.progress=1,this.skillSprIcon.node.active=!1},e.prototype.onDestroy=function(){u.EventMgr.getInstance().off(f.BBDEventName.GamePlayerMove,this,this.moveGrid),u.EventMgr.getInstance().off(f.BBDEventName.GameUpdata,this,this.onUpdate),u.EventMgr.getInstance().off(f.BBDEventName.GameGetBuff,this,this.eventGetBuff),u.EventMgr.getInstance().off(f.BBDEventName.GamePlayerSkillEnd,this,this.GamePlayerSkillEnd)},e.prototype.eventGetBuff=function(t){if(2==t)this.creatArrow();else if(18==t)this._buffId18Time=0;else if(3==t)this._spArrow.push(3),u.EventMgr.getInstance().emit(f.BBDEventName.GameRestArrowIcon,this._spArrow[0]);else if(4==t)this._spArrow.push(4),u.EventMgr.getInstance().emit(f.BBDEventName.GameRestArrowIcon,this._spArrow[0]);else if(5==t)this._spArrow.push(5),u.EventMgr.getInstance().emit(f.BBDEventName.GameRestArrowIcon,this._spArrow[0]);else if(6==t){var e=g.default.getInstance().checkBuffIsGet(6);this._attMax=this._attMax-e.buffParametric}},e.prototype.start=function(){this.creatArrow()},e.prototype.init=function(){},e.prototype.loadBody=function(){var t,e=this;t="anim/"+I[this._playType]+"/"+I[this._playType];var o=this.body;o.skeletonData=null;var i=f.emBBDBundles.GameIcon;y.default.instance.loadResSkeleton(o.node,i,t,function(t){e.node&&(o.skeletonData=t,o.setAnimation(0,f.BBDAnimName.Idle,!0))});var n="playIcon"+this._playType;y.default.instance.loadIcon(this.skillSpr,n);var a="banner"+this._playType;y.default.instance.loadIcon(this.skillSprIcon,a)},e.prototype.playPlayerAnim=function(t,e,o){void 0===e&&(e=!0);var i=this.body;i.skeletonData&&(i.setAnimation(0,t,e),i.setCompleteListener(null),i.setCompleteListener(function(){i.setCompleteListener(null),o&&o()}))},e.prototype.changeGMState=function(){this._isGm&&(this._isGMState=!this._isGMState)},e.prototype.refreshAttProgUI=function(){this.attProg.progress=1-this._attackCool/this._attackCoolMax,this.attLab.string=this._attNum+"/"+this._attMax},e.prototype.refreshAttProgUI2=function(){this.skillSprMask.fillRange=1-this._attNum/this._attMax},e.prototype.moveGrid=function(t,e){e&&this._nowPosIdx==t?this.startAttck():this._attackState||this._nowPosIdx!=t&&(this._nowPosIdx=t,this.moveStart(),this._nowPosX=f.BBDGameData.startX+this._nowPosIdx*f.BBDGameData.itemW,this._direc=this._nowPosX>this._playerPos.x?1:-1,this.playNode.setScale(this._direc,1,1))},e.prototype.startAttck=function(){var t=this;if(!this._moveState&&!(this._attackState||this._attackCool>0)){this._attNum++;var e=g.default.getInstance().getParam(m.enumBBDGearParameterCfg.AttackTime),o=g.default.getInstance().checkBuffIsGet(1),i=o?o.buffParametric:0;null!=this._buffId18Time&&this._buffId18Time<=5&&(i+=.5),this._isGMState?this._attackCool=.5:this._attackCool=e*(1-i/100),this._attackCoolMax=this._attackCool,this._attackState=!0,this._isRefreshArrow=!0,this._spArrow.length>0&&(this._isRefreshArrow=!1),this.playPlayerAnim(f.BBDAnimName.Attack,!1,function(){t.playPlayerAnim(f.BBDAnimName.Idle),t._attackState=!1,u.EventMgr.getInstance().emit(f.BBDEventName.GameRestArrowIcon,t._spArrow[0])})}},e.prototype.startAttck2=function(){var t=null;this._spArrow.length>0&&(t={spType:this._spArrow.splice(0,1)[0]}),this._attNum>this._attMax&&(this._attNum=0,t||(t={}),t.skill=this._playType,this.skillSprIcon.node.active=!0),u.EventMgr.getInstance().emit(f.BBDEventName.GameArrowAttow,t),this.refreshAttProgUI2()},e.prototype.GamePlayerSkillEnd=function(){this.skillSprIcon.node.active=!1},e.prototype.creatArrow=function(){if(!(this._spArrow.length>0)){var t=this._nowArrow.splice(0,1)[0],e=this.node.convertToWorldSpaceAR(cc.v3(0,0,0)),o={type:t,pos:this.node.parent.parent.convertToNodeSpaceAR(cc.v3(e)),idx:this._nowPosIdx,playType:this._playType};u.EventMgr.getInstance().emit(f.BBDEventName.GameCreatArrow,o),this.refreshSpareArrows()}},e.prototype.refreshSpareArrows=function(t){void 0===t&&(t=!0);for(var e=0;e<2;e++){if(!this._nowArrow[e]){0==this._spareArrowArr.length&&(this._spareArrowArr=[1,2,3,4,5]);var o=h.Utils.randomRang(0,this._spareArrowArr.length);this._nowArrow[e]=this._spareArrowArr.splice(o,1)[0]}t&&this.loadIcon(this._nowArrow[e],this.nextArrowSpr[e])}},e.prototype.loadIcon=function(t,e){var o="arrow_"+t;y.default.instance.loadIcon(e,o)},e.prototype.moveStart=function(){this._moveState=!0,this.playPlayerAnim(f.BBDAnimName.Run)},e.prototype.moveEnd=function(){this._moveState=!1,this.playPlayerAnim(f.BBDAnimName.Idle)},e.prototype.checkNextPos=function(){var t=Math.abs(this._nowPosX-this._playerPos.x);return t<=this._speed?(this.moveEnd(),t):this._speed},e.prototype.onUpdate=function(t){this._attackCool>0&&(this._attackCool-=t,this.refreshAttProgUI(),this._attackCool<=0&&(this._isRefreshArrow&&this.creatArrow(),u.EventMgr.getInstance().emit(f.BBDEventName.GameArrowAttow2))),null!=this._buffId18Time&&(this._buffId18Time+=t,this._buffId18Time>=20&&(this._buffId18Time=0)),this._moveState&&(this._playerPos.x+=this.checkNextPos()*this._direc,this.node.setPosition(this._playerPos))},c([b({type:sp.Skeleton})],e.prototype,"body",void 0),c([b({type:cc.Node})],e.prototype,"playNode",void 0),c([b({type:cc.ProgressBar})],e.prototype,"attProg",void 0),c([b({type:cc.Label})],e.prototype,"attLab",void 0),c([b({type:cc.Sprite})],e.prototype,"skillSpr",void 0),c([b({type:cc.Sprite})],e.prototype,"skillSprMask",void 0),c([b({type:cc.Sprite})],e.prototype,"skillSprIcon",void 0),c([b({type:cc.Node})],e.prototype,"GmNode",void 0),c([b({type:[cc.Sprite]})],e.prototype,"nextArrowSpr",void 0),c([_],e)}(cc.Component);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BBD_APP:[function(t,e,o){"use strict";cc._RF.push(e,"3a856AqZtVCRLiAtAijwiUU","BBD_APP");var i=t,n=e,a=o;cc._RF.push(n,"3a856AqZtVCRLiAtAijwiUU","BBD_APP"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("BBD_Configs"),p=i("BBD_DataMgr"),u=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e;var n=function(){i._isInited=!0,s.UIMgr.getInstance().openUIOfCallback(l.BBD_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.BBD_AudioId.bgm,l.BBDConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.BBD_UICF),r.AudioMgr.getInstance().addAdConf(l.BBD_AudioCF),p.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),s.UIMgr.getInstance().closeById(l.BBD_UIID.UIGame),s.UIMgr.getInstance().closeById(l.BBD_UIID.UIResult),s.UIMgr.getInstance().closeById(l.BBD_UIID.UISetting),s.UIMgr.getInstance().closeById(l.BBD_UIID.UIBuff),this._exitCall&&this._exitCall(),this._exitCall=null},t.prototype.removeTouchEvent=function(){},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],BBD_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"bc5fc47i8xCCqzQobd4Xv1/","BBD_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"bc5fc47i8xCCqzQobd4Xv1/","BBD_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.BBDAnimName=l.BBDGameObsTypeHp=l.BBDGameObsTypeNum=l.BBDGameData=l.BBDPoolName=l.BBDEventName=l.BBD_AudioCF=l.BBD_AudioId=l.BBDConfig=l.BBD_UICF=l.emBBDBundles=l.BBD_UIID=void 0,function(t){t.UIGame="BBD_UIGame",t.UIResult="BBD_UIResult",t.UISetting="BBD_UISetting",t.UIBuff="BBD_UIBuff"}(a=l.BBD_UIID||(l.BBD_UIID={})),function(t){t.prefabs="bbt_prefabs",t.configs="bbt_configs",t.audios="bbt_audios",t.GameIcon="bbt_gameIcon"}(r=l.emBBDBundles||(l.emBBDBundles={})),l.BBD_UICF=((i={})[a.UIGame]={prefab:"ui/BBD_UIGame",name:"BBD_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/BBD_UIResult",name:"BBD_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/BBD_UISetting",name:"BBD_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIBuff]={prefab:"ui/BBD_UIBuff",name:"BBD_UIBuff",showTop:!0,showMult:!0,zIndex:1e3,bundleName:r.prefabs},i),l.BBDConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},function(t){t.bgm="bgm",t.boom="boom",t.flsah="flsah",t.gySkill="gySkill",t.hit="hit",t.hook="hook",t.ppBomb="ppBomb",t.swkSkill="swkSkill",t.zxSkill="zxSkill",t.hitboss="hitboss",t.bossatk="bossatk",t.grassboom="grassboom"}(s=l.BBD_AudioId||(l.BBD_AudioId={})),l.BBD_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.boom]={path:"boom",bundle:r.audios},n[s.flsah]={path:"flsah",bundle:r.audios},n[s.hit]={path:"hit",bundle:r.audios},n[s.gySkill]={path:"gySkill",bundle:r.audios},n[s.hook]={path:"hook",bundle:r.audios},n[s.ppBomb]={path:"ppBomb",bundle:r.audios},n[s.swkSkill]={path:"swkSkill",bundle:r.audios},n[s.zxSkill]={path:"zxSkill",bundle:r.audios},n[s.hitboss]={path:"hitboss",bundle:r.audios},n[s.bossatk]={path:"bossatk",bundle:r.audios},n[s.grassboom]={path:"grassboom",bundle:r.audios},n),function(t){t[t.GamePlayerMove="BBDG_GamePlayerMove"]="GamePlayerMove",t[t.GameCreatArrow="BBDG_GameCreatArrow"]="GameCreatArrow",t[t.GameArrowAttow="BBDG_GameArrowAttow"]="GameArrowAttow",t[t.GameArrowAttow2="BBDG_GameArrowAttow2"]="GameArrowAttow2",t[t.GameAttackDrog="BBDG_GameAttackDrog"]="GameAttackDrog",t[t.GameIceDrog="BBDG_GameIceDrog"]="GameIceDrog",t[t.GameUpdata="BBDG_GameUpdata"]="GameUpdata",t[t.GameOver="BBDG_GameOver"]="GameOver",t[t.GameGetBuff="BBDG_GameGetBuff"]="GameGetBuff",t[t.GameCloseAlert="BBDG_GameCloseAlert"]="GameCloseAlert",t[t.GameRestArrowIcon="BBDG_GameRestArrowIcon"]="GameRestArrowIcon",t[t.GameDragAttack="BBDG_GameDragAttack"]="GameDragAttack",t[t.GamePlayerSkillEnd="BBDG_GamePlayerSkillEnd"]="GamePlayerSkillEnd"}(l.BBDEventName||(l.BBDEventName={})),function(t){t.GridItem="BBDGGridItem",t.ArrowItem="BBDGArrowItem",t.AnimItem="BBDGAnimItem"}(l.BBDPoolName||(l.BBDPoolName={})),function(t){t[t.BaseRow=8]="BaseRow",t[t.BaseCol=10]="BaseCol",t[t.ArrowBaseSpeed=8]="ArrowBaseSpeed",t[t.PlayerRange=500]="PlayerRange",t[t.itemW=78]="itemW",t[t.itemH=81]="itemH",t[t.startX=-275]="startX",t[t.startY=290]="startY",t[t.obsType=6]="obsType",t[t.arrowType=5]="arrowType"}(l.BBDGameData||(l.BBDGameData={})),l.BBDGameObsTypeNum={1:5,2:5,3:2,4:1,5:5,6:1,7:1},function(t){t[t.ord=1]="ord",t[t.obs=2]="obs",t[t.bomb=3]="bomb",t[t.box=4]="box",t[t.grass=5]="grass",t[t.back=6]="back",t[t.light=7]="light"}(l.BBDGameObsTypeHp||(l.BBDGameObsTypeHp={}));var p=function(){function t(){}return t.Attack="atk",t.Die="die",t.Hit="hit",t.Idle="idle",t.Run="run",t.Up="up",t}();l.BBDAnimName=p,cc._RF.pop(),cc._RF.pop()},{}],BBD_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"e1fdcmLkLlCkKkW4NIYtiMG","BBD_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"e1fdcmLkLlCkKkW4NIYtiMG","BBD_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("EventMgr"),l=i("HttpMgr"),p=i("PlatformManager"),u=i("ResourceMgr"),d=i("Utils"),h=i("BBD_Configs"),f=i("BBDGameEnumData"),m=cc._decorator,g=m.ccclass,y=(m.property,function(){function t(){this._isRemote=!1,this._seleteBuff=[1],this._weightNum=-9999,this._weightArr=[],this._obsType=[h.BBDGameObsTypeHp.ord,h.BBDGameObsTypeHp.grass,h.BBDGameObsTypeHp.obs],this._bossHpState={nei:null,bel:null}}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){var e,o;if(!window||!window.location)return null;var i=null===(o=null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.search)||void 0===o?void 0:o.replace("?","");if(!i||""===i)return null;for(var n=i.split("&"),a=0;a<n.length;a++){var r=n[a].split("=");if(decodeURIComponent(r[0])===t)return decodeURIComponent(r[1])}return null},t.prototype.load=function(t){var e=this,o=this._isRemote;if(p.PlatformManager.currentPlatform==s.Platform.EDITOR){var i=this.getUrlParam("isRemote");i&&"1"==i&&(o=!0)}o?l.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"penglang/BBD_soilder/configs",fileName:"GameJsonCfg.json"},function(o,i){if(o&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(e.data=JSON.parse(n.data),console.log(e.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):u.ResourceMgr.getInstance().loadRes(h.emBBDBundles.configs,"GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.GearParameterCfg[t]?this.data.GearParameterCfg[t].value:0},t.prototype.getBuffDataIdData=function(t){for(var e=this.data.buffCfg,o=0;o<e.length;o++){var i=e[o];if(i.ID==t)return i}return console.log("\u67e5\u8be2buff\u6ca1\u6709"),null},t.prototype.getBuffDataId=function(t){for(var e=this.data.buffCfg,o=0;o<e.length;o++){var i=e[o];if(i.ID==t)return i}return console.log("\u67e5\u8be2buff\u4e0d\u5bf9"),{}},t.prototype.restBuff=function(){this._seleteBuff=[]},t.prototype.getSeleteBuff=function(t){this._seleteBuff.push(t),c.EventMgr.getInstance().emit(h.BBDEventName.GameGetBuff,t)},t.prototype.checkBuffIsGet=function(t){return this._seleteBuff.indexOf(t)>=0?this.getBuffDataId(t):null},t.prototype.randomBuff=function(){for(var t=[],e=function(){var e=o._getSeleteBuff();t.find(function(t){return t.ID==e.ID})||t.push(e)},o=this;t.length<=3;)e();return t},t.prototype._getSeleteBuff=function(){for(var t=this.data.buffCfg,e=[],o=0,i=[],n=0;n<t.length;n++){var a=t[n],r=!0;1==a.buffTime&&this._seleteBuff.indexOf(a.ID)>=0&&(r=!1),r&&(e.push(a),o+=a.buffvalue,i.push(o))}for(var s=d.Utils.randomRang(0,o),c=0;c<i.length;c++)if(s<i[c])return e[c];return console.log("buff\u968f\u673a\u6709\u95ee\u9898"),e[0]},t.prototype.getObsRangType=function(t,e,o,i){var n=this.data.dropCfg;if(this._weightNum<0){this._weightNum=0;for(var a=0;a<n.length;a++){var r=n[a];this._weightNum+=r.value,this._weightArr.push(this._weightNum)}}for(var s=d.Utils.randomRang(0,this._weightNum),c=0,l=0;l<this._weightArr.length;l++)if(s<this._weightArr[l]){c=l;break}var p=n[c],u=d.Utils.randomRang(1,p.ItemNum+1);if(this._obsType.indexOf(p.id)>=0){var h=this.checkNeiProbability(e,p.id,o,i);(0!=h||0!=(h=this.checkBelProbability(t,p.id,o,i)))&&(u=h)}return[p.id,u]},t.prototype.checkNeiProbability=function(t,e,o,i){var n;if(0==o)return!1;if(!t[t.length-1])return!1;if((null===(n=t[t.length-1])||void 0===n?void 0:n.obsType)!=e)return!1;if(!this._bossHpState.nei){var a=this.getParam(f.enumBBDGearParameterCfg.NeiProbability).split("|");this._bossHpState.nei=[];for(var r=0;r<a.length;r++){var s=(m=a[r]).split("_");this._bossHpState.nei.push([parseInt(s[0]),parseInt(s[1])])}}for(var c=d.Utils.randomRang(0,100),l=0,p=999999,u=this._bossHpState.nei,h=0;h<u.length;h++){var m;i<=(m=u[h])[0]&&p>m[0]&&(l=m[1],p=m[0])}return c<l&&t[t.length-1].type},t.prototype.checkBelProbability=function(t,e,o,i){if(!t)return!1;if(!t[o])return!1;if(t[o].obsType!=e)return!1;if(!this._bossHpState.bel){var n=this.getParam(f.enumBBDGearParameterCfg.NeiProbability).split("|");this._bossHpState.bel=[];for(var a=0;a<n.length;a++){var r=(h=n[a]).split("_");this._bossHpState.bel.push([parseInt(r[0]),parseInt(r[1])])}}for(var s=d.Utils.randomRang(0,100),c=0,l=999999,p=this._bossHpState.bel,u=0;u<p.length;u++){var h;i<=(h=p[u])[0]&&l>h[0]&&(c=h[1],l=h[0])}return s<c&&t[o].type},e=r([g],t)}());a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BBD_UIBuff:[function(t,e,o){"use strict";cc._RF.push(e,"03b82pJj8VFI6hRUIPcOSgs","BBD_UIBuff");var i=t,n=e,a=o;cc._RF.push(n,"03b82pJj8VFI6hRUIPcOSgs","BBD_UIBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("EventMgr"),d=i("Utils"),h=i("BBD_Configs"),f=i("BBD_DataMgr"),m=i("BBD_UIGame"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndItem=[],e._buffArr=[],e}return s(e,t),e.prototype.start=function(){var t=this,e=f.default.getInstance().randomBuff();this._buffArr=e;for(var o=function(o){var n=i.ndItem[o];i.restUI(n,e[o]),cc.tween(n).set({scale:0}).delay(.2+.1*o).set({scaleX:1.1,scaleY:.5}).to(.12,{scaleX:.9,scaleY:1.2}).to(.09,{scaleX:1.05,scaleY:.95}).to(.06,{scale:1}).start(),n.on(cc.Node.EventType.TOUCH_END,function(){p.AudioMgr.getInstance().playAudioButtonClicked(),t.clickItem(e[o].ID)},i)},i=this,n=0;n<this.ndItem.length;n++)o(n)},e.prototype.restUI=function(t,e){t.getChildByName("labName").getComponent(cc.Label).string=e.buffName,t.getChildByName("labText").getComponent(cc.RichText).string="<b><outline color=\u201c#000000\u201d width=4>"+d.Utils.StringFormat(e.buffCopy1,e.buffParametric)+"</outline></b>";var o=t.getChildByName("icon").getComponent(cc.Sprite),i=""+e.icon1;m.default.instance.loadIcon(o,i)},e.prototype.clickItem=function(t){f.default.getInstance().getSeleteBuff(t),u.EventMgr.getInstance().emit(h.BBDEventName.GameCloseAlert),this.closeUI()},c([v([cc.Node])],e.prototype,"ndItem",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],BBD_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"80fd6ohPfpBOJ95aQH5LOtv","BBD_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"80fd6ohPfpBOJ95aQH5LOtv","BBD_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("EventMgr"),h=i("PoolMgr"),f=i("BBD_Configs"),m=i("BBD_APP"),g=i("BBDGameEnumData"),y=i("BBDMapGrid"),v=i("BBD_DataMgr"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.obsItem=null,e.arrow2Item=null,e.animItem=null,e.stopNode=null,e.mapGridCrtl=null,e._gameOver=!1,e._seletState=0,e._seletBuff=[],e._openUIState=!1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,h.PoolMgr.getInstance().creatrePool(f.BBDPoolName.GridItem,this.obsItem,5),h.PoolMgr.getInstance().creatrePool(f.BBDPoolName.AnimItem,this.animItem,1),h.PoolMgr.getInstance().creatrePool(f.BBDPoolName.ArrowItem,this.arrow2Item,2),this.weblinkLabel.active=!0,this.weblinkLabel2.active=l.Platform.WEB_LINK==u.PlatformSetting.currentPlatform},e.prototype.onEnable=function(){d.EventMgr.getInstance().on(f.BBDEventName.GameGetBuff,this,this.eventGetBuff),this.addEvent(f.BBDEventName.GameCloseAlert,this.changeSeletState.bind(this))},e.prototype.onDisable=function(){d.EventMgr.getInstance().off(f.BBDEventName.GameGetBuff,this,this.eventGetBuff)},e.prototype.start=function(){},e.prototype.changeSeletState=function(){this._seletState--,this.OpenBuffSelet(),this._seletState<=0&&(this._seletState=0,this._openUIState=!1)},e.prototype.checkIsMove=function(){return!(this._gameOver||this._seletState>0)},e.prototype.eventOpenBuffSelet=function(t){this._seletState++,this.addUIAlert(f.BBD_UIID.UIBuff,t)},e.prototype.addUIAlert=function(t,e){void 0===e&&(e=null);var o={UIID:t,data:e};this._seletBuff.push(o),this._openUIState||(this._openUIState=!0,this.OpenBuffSelet())},e.prototype.OpenBuffSelet=function(){this._seletBuff.length>0&&(this.openUI(this._seletBuff[0].UIID,this._seletBuff[0].data),this._seletBuff.splice(0,1))},e.prototype.openGameResultUI=function(t){var e=this;void 0===t&&(t=!0),this._gameOver=!0,this.scheduleOnce(function(){e.openUI(f.BBD_UIID.UIResult,t)},1)},e.prototype.update=function(t){this.checkIsMove()&&d.EventMgr.getInstance().emit(f.BBDEventName.GameUpdata,t)},e.prototype.getPoolNode=function(t){var e=h.PoolMgr.getInstance().getNode(t);return e.active=!0,e},e.prototype.freePoolNode=function(t,e){e.active=!1,h.PoolMgr.getInstance().freeNode(t,e)},e.prototype.loadIcon=function(t,e){var o=f.emBBDBundles.GameIcon,i="icon/"+e;this.loadSpriteFrame(o,i,function(e){cc.isValid(t)&&(t.spriteFrame=e)})},e.prototype.loadResSkeleton=function(t,e,o,i){this.loadResFromBundle(e,o,sp.SkeletonData,function(e){t&&(null==t?void 0:t.isValid)&&i(e)})},e.prototype.getObsHp=function(t){return t==f.BBDGameObsTypeHp.ord?v.default.getInstance().getParam(g.enumBBDGearParameterCfg.BallHp):t==f.BBDGameObsTypeHp.obs?v.default.getInstance().getParam(g.enumBBDGearParameterCfg.BarHp):t==f.BBDGameObsTypeHp.bomb?v.default.getInstance().getParam(g.enumBBDGearParameterCfg.BombHp):t==f.BBDGameObsTypeHp.box?v.default.getInstance().getParam(g.enumBBDGearParameterCfg.BoxHp):t==f.BBDGameObsTypeHp.grass?v.default.getInstance().getParam(g.enumBBDGearParameterCfg.GrassHp):t==f.BBDGameObsTypeHp.back?v.default.getInstance().getParam(g.enumBBDGearParameterCfg.HookHp):1},e.prototype.eventGetBuff=function(){},e.prototype.onClickOpenSet=function(){this._gameOver||(this._seletState++,this.stopNode.active=!0)},e.prototype.onClickCloseSet=function(){this._gameOver||(this._seletState--,this.stopNode.active=!1)},e.prototype.onClickExitApp=function(){this._gameOver||(this.closeUI(),m.default.instance.exit_App(0))},c([B({type:cc.Node,tooltip:""})],e.prototype,"obsItem",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"arrow2Item",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"animItem",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"stopNode",void 0),c([B({type:y.default,tooltip:""})],e.prototype,"mapGridCrtl",void 0),c([B(cc.Node)],e.prototype,"weblinkLabel",void 0),c([B(cc.Node)],e.prototype,"weblinkLabel2",void 0),o=c([b],e)}(p.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],BBD_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"96eeaH3MthEhqE/JbFfhKnL","BBD_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"96eeaH3MthEhqE/JbFfhKnL","BBD_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("NodeLib"),u=i("BBD_APP"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ndWin=null,e.pro_ndFail=null,e.pro_btn=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.initproperty=function(){this.pro_ndWin=p.default.findChildByName(this.node,"pro_ndWin"),this.pro_ndFail=p.default.findChildByName(this.node,"pro_ndFail"),this.pro_btn=p.default.findChildByName(this.node,"pro_btn")},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initView(),this.pro_btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.pro_ndFail.active=!this.isWin,this.pro_ndWin.active=this.isWin},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BBD_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"f3ea6xezhVNQIe5j/+W6WZf","BBD_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"f3ea6xezhVNQIe5j/+W6WZf","BBD_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("NodeLib"),d=i("BBD_APP"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_musicSlider=null,e.pro_effectSlider=null,e.pro_btnClose=null,e.pro_btnBackHome=null,e.pro_btnPlay=null,e.pro_gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.initproperty=function(){this.pro_musicSlider=u.default.findChildByName(this.node,"pro_musicSlider").getComponent(cc.Slider),this.pro_effectSlider=u.default.findChildByName(this.node,"pro_effectSlider").getComponent(cc.Slider),this.pro_btnClose=u.default.findChildByName(this.node,"pro_btnClose"),this.pro_btnBackHome=u.default.findChildByName(this.node,"pro_btnBackHome"),this.pro_btnPlay=u.default.findChildByName(this.node,"pro_btnPlay"),this.pro_gmNode=u.default.findChildByName(this.node,"pro_gmNode"),this.pro_musicSlider.progress=p.AudioMgr.getInstance().getMusicVolume(),this.pro_effectSlider.progress=p.AudioMgr.getInstance().getEffectVolume()},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.pro_musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.pro_effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.pro_musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.pro_effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.pro_musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),p.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.pro_gmNode.on(cc.Node.EventType.TOUCH_END,function(){}),this.pro_effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),p.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.pro_btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.pro_btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){d.default.instance.exit_App(0)}),this.pro_btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BHD_APP:[function(t,e,o){"use strict";cc._RF.push(e,"0323dqn+e1Lt7ze2yCUbIKJ","BHD_APP");var i=t,n=e,a=o;cc._RF.push(n,"0323dqn+e1Lt7ze2yCUbIKJ","BHD_APP");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("AudioMgr"),c=i("UIMgr"),l=i("BHD_PoolMgr"),p=i("BHD_Config"),u=i("BHD_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isInited=!1,this._exitCall=null}var e;return e=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e,s.AudioMgr.getInstance().pauseAllMusic();var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(p.BHD_UIID.BHD_UIGame,p.BHD_UIID.BHD_UIGame,function(){t&&t()})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(p.BHD_UICF),s.AudioMgr.getInstance().addAdConf(p.BHD_Audio),u.default.getInstance().loadCfg(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),c.UIMgr.getInstance().closeById(p.BHD_UIID.BHD_UIGame),c.UIMgr.getInstance().closeById(p.BHD_UIID.BHD_UIPause),c.UIMgr.getInstance().closeById(p.BHD_UIID.BHD_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,l.default.getInstance().clear()},t._instance=null,e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_BoxInfoTipsBox:[function(t,e,o){"use strict";cc._RF.push(e,"7dfceoOFm9KrJcTBteaaC/W","BHD_BoxInfoTipsBox");var i=t,n=e,a=o;cc._RF.push(n,"7dfceoOFm9KrJcTBteaaC/W","BHD_BoxInfoTipsBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BHD_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtTips=null,e.levelBox=null,e.weaponIcon=null,e}return s(e,t),e.prototype.init=function(t,e,o){var i=this;this.txtTips.string=t,this.node.active=!0,cc.Tween.stopAllByTarget(this.node),this.node.opacity=0,cc.tween(this.node).to(.2,{opacity:255}).start();var n="roleBoxIcon/gezi_0"+o;this.loadSpriteFrame(p.BHD_BundleName.Sprite,n,function(t){i.levelBox.spriteFrame=t});var a="roleBoxIcon/tou_"+e;this.loadSpriteFrame(p.BHD_BundleName.Sprite,a,function(t){i.weaponIcon.spriteFrame=t})},e.prototype.die=function(){var t=this;this.node.active&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.active=!1}).start())},c([h(cc.RichText)],e.prototype,"txtTips",void 0),c([h(cc.Sprite)],e.prototype,"levelBox",void 0),c([h(cc.Sprite)],e.prototype,"weaponIcon",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_Btn_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"ccea9ulQM1JAJPd/IialEZN","BHD_Btn_Skills");var i=t,n=e,a=o;cc._RF.push(n,"ccea9ulQM1JAJPd/IialEZN","BHD_Btn_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("BHD_Config"),d=i("BHD_DataMgr"),h=i("BHD_GameMgr"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelBox=null,e.lockMack=null,e.skillIcon=null,e.isDie=!1,e.skillID=0,e.level=0,e.isSkillLock=!1,e.skillInterval=0,e.skillTime=0,e}return s(e,t),e.prototype.onLoad=function(){this.playBtnAnim()},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.btnAnimId)},e.prototype.init=function(t,e){var o=this;this.skillID=t,this.lockMack.node.active=!1,this.skillInterval=d.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime=this.skillInterval,this.updateLevel(e),this.node.on(cc.Node.EventType.TOUCH_END,this.playSkill,this);var i="skillsBtnIcon/"+d.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(u.BHD_BundleName.Sprite,i,function(t){o.skillIcon.spriteFrame=t})},e.prototype.update=function(t){h.default.Instance.isPause||h.default.Instance.isPrepare||this.isDie||this.isSkillLock&&(this.skillTime-=t,this.lockMack.progress=this.skillTime/this.skillInterval,this.skillTime<0&&(this.isSkillLock=!1,this.lockMack.node.active=!1,this.playBtnAnim()))},e.prototype.updateLevel=function(t){var e=this;if(this.level!=t){this.level=t;var o="skillsBtnIcon/guang_0"+this.level;this.loadSpriteFrame(u.BHD_BundleName.Sprite,o,function(t){e.levelBox.getComponent(cc.Sprite).spriteFrame=t})}},e.prototype.playSkill=function(){h.default.Instance.isPrepare||this.isSkillLock||(clearInterval(this.btnAnimId),this.btnAnimId=null,cc.Tween.stopAllByTarget(this.node),this.lockMack.node.active=!0,this.lockMack.progress=1,this.isSkillLock=!0,this.skillTime=this.skillInterval,h.default.Instance.playSkillsAtk(this.skillID),p.AudioMgr.getInstance().playEffectFree(d.default.getInstance().getSkillsCfg(this.skillID).mateSound))},e.prototype.playBtnAnim=function(){var t=this;clearInterval(this.btnAnimId),this.btnAnimId=null,cc.tween(this.levelBox).to(.65,{scale:1.04}).to(.65,{scale:1}).start(),this.btnAnimId=setInterval(function(){cc.tween(t.levelBox).to(.65,{scale:1.04}).to(.65,{scale:1}).start()},1300)},c([g(cc.Node)],e.prototype,"levelBox",void 0),c([g(cc.ProgressBar)],e.prototype,"lockMack",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BHD_Config:[function(t,e,o){"use strict";cc._RF.push(e,"9768a1uUb1Nb7HnoTOXdKD8","BHD_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"9768a1uUb1Nb7HnoTOXdKD8","BHD_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.BHD_RoleAsePath=l.BHD_EffAnimType=l.BHD_MoveBoxtate=l.BHD_AnimName=l.BHD_EventName=l.BHD_Audio=l.BHD_AudioId=l.BHD_UICF=l.BHD_UIID=l.BHD_BundleName=void 0,function(t){t.Prefabs="BHD_Prefabs",t.Sprite="BHD_Sprite",t.Audio="BHD_Audio",t.SpAnim="BHD_SpAnim"}(a=l.BHD_BundleName||(l.BHD_BundleName={})),function(t){t.BHD_UIGame="BHD_UIGame",t.BHD_UIGM="BHD_UIGM",t.BHD_UIPause="BHD_UIPause",t.BHD_UIGameOver="BHD_UIGameOver",t.BHD_UISelectBuff="BHD_UISelectBuff",t.BHD_UIBuffPro="BHD_UIBuffPro"}(r=l.BHD_UIID||(l.BHD_UIID={})),l.BHD_UICF=((i={})[r.BHD_UIGame]={prefab:"ui/BHD_UIGame",name:"BHD_UIGame",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.BHD_UIGM]={prefab:"ui/BHD_UIGM",name:"BHD_UIGM",showTop:!0,showMult:!1,zIndex:1002,bundleName:a.Prefabs},i[r.BHD_UIPause]={prefab:"ui/BHD_UIPause",name:"BHD_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.BHD_UIGameOver]={prefab:"ui/BHD_UIGameOver",name:"BHD_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.BHD_UISelectBuff]={prefab:"ui/BHD_UISelectBuff",name:"BHD_UISelectBuff",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.BHD_UIBuffPro]={prefab:"ui/BHD_UIBuffPro",name:"BHD_UIBuffPro",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i),function(t){t.baozha="baozha",t.shibai="shibai",t.dilie="dilie",t.fangrugezi="fangrugezi",t.shengji="shengji",t.siwang="siwang",t.attack2="attack2",t.bocijieshu="bocijieshu",t.kaishi="kaishi",t.mingzhong="mingzhong",t.tabaozha="tabaozha",t.tashouji="tashouji",t.zhizhusiwang="zhizhusiwang",t.summon="summon",t.cwsq="cwsq",t.jdqx="jdqx",t.sgml="sgml",t.zysq="zysq"}(s=l.BHD_AudioId||(l.BHD_AudioId={})),l.BHD_Audio=((n={})[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.baozha]={path:s.baozha,bundle:a.Audio},n[s.dilie]={path:s.dilie,bundle:a.Audio},n[s.fangrugezi]={path:s.fangrugezi,bundle:a.Audio},n[s.shengji]={path:s.shengji,bundle:a.Audio},n[s.siwang]={path:s.siwang,bundle:a.Audio},n[s.attack2]={path:s.attack2,bundle:a.Audio},n[s.bocijieshu]={path:s.bocijieshu,bundle:a.Audio},n[s.kaishi]={path:s.kaishi,bundle:a.Audio},n[s.mingzhong]={path:s.mingzhong,bundle:a.Audio},n[s.tabaozha]={path:s.tabaozha,bundle:a.Audio},n[s.tashouji]={path:s.tashouji,bundle:a.Audio},n[s.zhizhusiwang]={path:s.zhizhusiwang,bundle:a.Audio},n[s.summon]={path:s.summon,bundle:a.Audio},n[s.cwsq]={path:s.cwsq,bundle:a.Audio},n[s.jdqx]={path:s.jdqx,bundle:a.Audio},n[s.sgml]={path:s.sgml,bundle:a.Audio},n[s.zysq]={path:s.zysq,bundle:a.Audio},n),function(t){t.SetPause="BHD_SetPause",t.UpdateSceneAllBox="BHD_UpdateSceneAllBox",t.PlayGame="BHD_PlayGame",t.ActivateSkills="BHD_ActivateSkills",t.UpdateRolePro="BHD_updateRolePro",t.upTipsBox="BHD_upTipsBox",t.rolePlaySkill="BHD_rolePlaySkill",t.waveOver="BHD_waveOver",t.SetGoldNum="BHD_setGoldNum",t.GainTowerBackAtk="BHD_gainTowerBackAtk",t.TowerAddMaxHp="BHD_towerAddMaxHp"}(l.BHD_EventName||(l.BHD_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="run",t.animation="animation",t.skill="skill",t.skill2="skill2",t.die="die"}(l.BHD_AnimName||(l.BHD_AnimName={})),function(t){t[t.TouchStart=0]="TouchStart",t[t.TouchMove=1]="TouchMove",t[t.TouchEnd=2]="TouchEnd"}(l.BHD_MoveBoxtate||(l.BHD_MoveBoxtate={})),function(t){t.boxUpLevelEff="boxUpLevelEff",t.enemyDieEff="enemyDieEff"}(l.BHD_EffAnimType||(l.BHD_EffAnimType={})),l.BHD_RoleAsePath={1:{path:"soilder_3/soilder_3",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_3"},3:{path:"djdh_3/djdh_3",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_1"},4:{path:"djdh_4/djdh_4",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_1"},5:{path:"djdh_5/djdh_5",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_3"},6:{path:"djdh_6/djdh_6",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_2"},7:{path:"soilder_4/soilder_4",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_3"},8:{path:"djdh_8/djdh_8",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_1"},10:{path:"djdh_10/djdh_10",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_2"},11:{path:"soilder_1/soilder_1",bulletPath:"hdfs_bullte/hdfs_bullte",bulletSkill:"bullte"},17:{path:"djdh_17/djdh_17",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_2"}},cc._RF.pop(),cc._RF.pop()},{}],BHD_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"be643sr1vJCs4ZOZAlpd+6P","BHD_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"be643sr1vJCs4ZOZAlpd+6P","BHD_DataMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.loadCfg=function(t){var e=this;r.ResourceMgr.getInstance().loadRes("BHD_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getCfgByPrimaryKey2=function(t,e,o,i,n){if(t)for(var a=0;a<t.length;a++)if(t[a][i]==e&&t[a][n]==o)return t[a];return null},t.prototype.getBoxProInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.CharacterNum,t,e,"CharacterID","level")},t.prototype.getParameterCfg=function(t){return this.data.GearParameterCfg[t].value},t.prototype.getSkillsCfg=function(t){return this.getCfgByPrimaryKey(this.data.mateCfg,t,"mateID")},t.prototype.getEnemyInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.enemyCfg,t,e,"level","CharacterID")},t.prototype.getEnemyExp=function(t){return this.getCfgByPrimaryKey(this.data.enemyID,t,"ID")},t.prototype.getBuffCfg=function(t,e){return this.getCfgByPrimaryKey2(this.data.buffCfg,t,e,"ID","buffQuality")},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],BHD_EffDie:[function(t,e,o){"use strict";cc._RF.push(e,"45eb0HebLVLEL+aMUxxC9K7","BHD_EffDie");var i=t,n=e,a=o;cc._RF.push(n,"45eb0HebLVLEL+aMUxxC9K7","BHD_EffDie");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BHD_Config"),p=i("BHD_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name,l.BHD_AnimName.animation,p.default.getInstance().pushObj(t.node)})},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_EnemyRole:[function(t,e,o){"use strict";cc._RF.push(e,"93fd1RVxnxN2ICZqYxREilS","BHD_EnemyRole");var i=t,n=e,a=o;cc._RF.push(n,"93fd1RVxnxN2ICZqYxREilS","BHD_EnemyRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("AudioMgr"),d=i("BHD_Config"),h=i("BHD_DataMgr"),f=i("BHD_GameEnumData"),m=i("BHD_GameMgr"),g=i("BHD_PoolMgr"),y=cc._decorator,v=y.ccclass,_=y.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.die=2]="die"}(l||(l={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.boxCol=null,e.hpBG=null,e.hpBar=null,e.frozenPos=null,e.outWarn=null,e.sons=null,e.enemyType=0,e.targetTower=null,e.isDie=!1,e.enemyState=l.die,e.basicsMoveSpeed=80,e.moveSpeed=80,e.nowMovePos=cc.v2(),e.skillFrozen=!1,e.frozenCountTime=0,e.knockbackOffset=cc.Vec3.ZERO,e.isSpeedCut=!1,e.speCutTime=0,e.isTowerDie=!1,e.towerSpeed=1,e.towerCourseTime=2,e.towerTime=0,e.atkForce=1,e.maxHp=10,e.nowHp=0,e.isUnderHp=!1,e.addSpeedDouble=1.8,e.exp=0,e.isAtkCooling=!0,e.atkInterval=2.5,e.atkTime=0,e.atkAnimTimeSpeed=1,e.clipDuration=0,e.outPathIndex=0,e.outPaths=[],e.outPathPos=cc.v2(),e.outMoveSpeed=40,e.outPathIndexId=1,e.isOutPathCourse=!1,e.isSonEnemy=!1,e.loongPos=null,e.moveDistance=0,e.direction=null,e.move=null,e._frames=0,e.holeCenter=cc.v2(),e.holeRadius=205,e.lastDistToHole=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;this.addEvent(d.BHD_EventName.SetPause,this.setSpAnim),this.addEvent(d.BHD_EventName.rolePlaySkill,this.rolePlaySkill),this.spAnim.setCompleteListener(function(e){e.animation.name==d.BHD_AnimName.attack?(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.spAnim.setAnimation(0,d.BHD_AnimName.idle,!0)):e.animation.name==d.BHD_AnimName.die?g.default.getInstance().pushObj(t.node):e.animation.name==d.BHD_AnimName.skill2&&(m.default.Instance.addEnemyList(t.node),t.spAnim.setAnimation(0,d.BHD_AnimName.move,!0),t.isDie=!1,t.isOutPathCourse=!1,t.targetTower=m.default.Instance.getTowerNear(t.node),t.nowMovePos=t.targetTower.node.getPosition())}),this.spAnim.setEventListener(function(e,o){o.data.name==d.BHD_AnimName.attack&&t.attack()}),this.setSpAnimPlaySpeed();var e=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.EnemyMoveSpeed);this.basicsMoveSpeed=e[this.enemyType-1],this.moveSpeed=this.basicsMoveSpeed,this.exp=h.default.getInstance().getEnemyExp(this.enemyType).EXP,this.towerCourseTime=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.BoundSpeedTime)},e.prototype.init=function(t,e,o,i){void 0===i&&(i=!1),this.enemyState=l.move,this.atkTime=0,this.hpBG.active=!1,this.frozenPos.removeAllChildren(),this.frozenPos.active=!1,this.skillFrozen=!1,this.frozenCountTime=0,cc.Tween.stopAllByTarget(this.spAnim.node),cc.Tween.stopAllByTarget(this.knockbackOffset),cc.Tween.stopAllByTarget(this.hpBar),this.spAnim.node.color=cc.Color.WHITE,this.knockbackOffset=cc.Vec3.ZERO,this.hpBar.progress=1,this.moveSpeed=this.basicsMoveSpeed,this.isSpeedCut=!1,this.speCutTime=0,this.isUnderHp=!1,this.spAnim.paused=!1,this.node.scale=1,this.lastDistToHole=0,this.isDie=!1,this.isSonEnemy=i,this.outPathIndex=e,this.outPaths=o,this.outPathIndexId=1,this.outPathPos=this.outPaths[this.outPathIndexId].getPosition(),this.isOutPathCourse=!1;var n=h.default.getInstance().getEnemyInfo(t,this.enemyType);if(null!=n&&(this.maxHp=m.default.Instance.round(n.HP),this.nowHp=this.maxHp,this.atkForce=m.default.Instance.round(n.Atk),this.isSonEnemy)){var a=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.SpinderHp);this.maxHp=m.default.Instance.round(n.HP*a),this.nowHp=this.maxHp}if(this.isSonEnemy)this.spAnim.node.opacity=255,this.spAnim.node.scale=1,this.node.scale=.65,this.targetTower=m.default.Instance.getTowerNear(this.node),this.nowMovePos=this.targetTower.node.getPosition(),this.spAnim.setAnimation(0,d.BHD_AnimName.move,!0),m.default.Instance.addEnemyList(this.node);else{switch(this.isOutPathCourse=!0,this.enemyType){case 1:case 2:case 3:var r=!1;this.node.x>this.outPathPos.x?r=!1:this.node.x<this.outPathPos.x&&(r=!0);var s=r?1:-1;this.spAnim.setAnimation(0,d.BHD_AnimName.move,!0),this.spAnim.node.opacity=0,this.spAnim.node.scaleY=.4,this.spAnim.node.scaleX=r?.4:-.4,cc.tween(this.spAnim.node).to(.8,{opacity:255}).start(),cc.tween(this.spAnim.node).to(2,{scaleX:s,scaleY:1}).start();break;case 4:this.isDie=!0,this.outEnemy4()}1!=this.enemyType&&3!=this.enemyType||(e<=2?this.spAnim.node.angle=-80:e>2&&e<=5&&(this.spAnim.node.angle=80))}},e.prototype.outEnemy4=function(){var t=this;this.spAnim.node.active=!1,this.outWarn.active=!0,this.outWarn.opacity=0,cc.tween(this.outWarn).to(.2,{opacity:255}).to(.4,{opacity:50}).to(.2,{opacity:255}).to(.4,{opacity:50}).to(.2,{opacity:255}).to(.4,{opacity:50}).call(function(){t.outWarn.active=!1,t.spAnim.node.active=!0,u.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.dilie),t.spAnim.setAnimation(0,d.BHD_AnimName.skill2,!1)}).start()},e.prototype.update=function(t){if(!m.default.Instance.isPause&&!this.isDie)if(this.isOutPathCourse&&4!=this.enemyType){if(this.loongPos=this.node.getPosition(),this.moveDistance=this.outMoveSpeed*t,this.direction=this.outPathPos.sub(this.loongPos).normalize(),this.move=this.direction.mul(this.moveDistance),this.node.setPosition(this.loongPos.add(this.move)),this.outPathPos.sub(this.loongPos).mag()<this.moveDistance)if(this.node.setPosition(this.outPathPos),this.outPathIndexId==this.outPaths.length-1)if(this.isOutPathCourse=!1,m.default.Instance.addEnemyList(this.node),0==this.outPathIndex||5==this.outPathIndex){var e=[],o=m.default.Instance.towerDefenses;5==this.outPathIndex?(o[1].isDie||e.push(o[1]),o[3].isDie||e.push(o[3])):(o[0].isDie||e.push(o[0]),o[2].isDie||e.push(o[2])),e.length>0?(this.targetTower=e[m.default.Instance.random(0,e.length,!0)],this.nowMovePos=this.targetTower.node.getPosition()):(this.targetTower=m.default.Instance.getTowerNear(this.node),this.nowMovePos=this.targetTower.node.getPosition())}else this.targetTower=m.default.Instance.getTowerNear(this.node),this.nowMovePos=this.targetTower.node.getPosition();else this.outPathIndexId++,1!=this.enemyType&&3!=this.enemyType||this.outPathIndex<=5&&cc.tween(this.spAnim.node).to(1.2,{angle:0}).start(),this.outPathPos=this.outPaths[this.outPathIndexId].getPosition()}else{if(this.knockbackOffset!=cc.Vec3.ZERO){var i=this.node.position.add(this.knockbackOffset);this.node.setPosition(i)}if(this.isTowerDie&&(this.towerTime+=t,this.towerTime>this.towerCourseTime&&(this.towerTime=0,this.isTowerDie=!1,this.towerSpeed=1)),this.isSpeedCut&&(this.speCutTime-=t,this.speCutTime<0&&(this.isSpeedCut=!1,this.speCutTime=0,this.isUnderHp?this.moveSpeed=this.basicsMoveSpeed:this.moveSpeed=this.basicsMoveSpeed*this.addSpeedDouble,this.spAnim.animation!=d.BHD_AnimName.attack&&(this.spAnim.timeScale=1))),this.skillFrozen)return this.frozenCountTime-=t,void(this.frozenCountTime<0&&(this.frozenCountTime=0,this.skillFrozen=!1,this.setSpAnim(!1),this.frozenPos.active=!1));if(this._frames++>8){this._frames=0;var n=this.boxCol.getBoundingBoxToWorld(),a=!1;this.targetTower.isDie&&(this.targetTower=m.default.Instance.getTowerNear(this.node),this.nowMovePos=this.targetTower.node.getPosition(),this.towerTime=0,this.isTowerDie=!0,this.towerSpeed=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.BoundSpeed));var r=this.targetTower.boxCol.getBoundingBoxToWorld();cc.Intersection.rectRect(n,r)&&(a=!0),a?this.enemyState!=l.attack&&(this.enemyState=l.attack,this.spAnim.setAnimation(0,d.BHD_AnimName.idle,!0)):this.enemyState!=l.move&&(this.enemyState=l.move,this.isUnderHp?this.spAnim.setAnimation(0,d.BHD_AnimName.skill,!0):this.spAnim.setAnimation(0,d.BHD_AnimName.move,!0))}this.enemyState==l.move?(this.node.x>this.nowMovePos.x&&-1!=this.spAnim.node.scaleX?this.spAnim.node.scaleX=-1:this.node.x<this.nowMovePos.x&&1!=this.spAnim.node.scaleX&&(this.spAnim.node.scaleX=1),this.moveEnemy(t)):this.enemyState==l.attack&&(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,d.BHD_AnimName.attack,!1)))}},e.prototype.moveEnemy=function(t){var e=this.node.getPosition(),o=this.moveSpeed*this.towerSpeed*t,i=this.nowMovePos.sub(e).normalize(),n=e.sub(this.holeCenter).mag(),a=i.mul(o);if(n<this.holeRadius&&n<this.lastDistToHole){var r=this.holeCenter.sub(e).normalize(),s=cc.v2(-r.y,r.x),c=cc.v2(r.y,-r.x);a=(i=(i=s.dot(i)>c.dot(i)?s:c).normalize()).mul(o);var l=this.holeRadius-n;if(l>0){var p=r.mul(-l);a=a.add(p)}}this.lastDistToHole=n,this.node.setPosition(e.add(a))},e.prototype.attack=function(){m.default.Instance.isPause||this.isDie||(this.targetTower.attackEd(this.atkForce),0!=m.default.Instance.towerBackAtk&&this.attackEd(m.default.Instance.towerBackAtk,!1))},e.prototype.rolePlaySkill=function(t,e){if(!m.default.Instance.isPause&&!this.isOutPathCourse&&!this.isDie){switch(t){case 8:this.frozenEd(3)}this.attackEd(e,!1)}},e.prototype.attackEd=function(t,e){m.default.Instance.isPause||this.isOutPathCourse||this.isDie||(this.nowHp-=t,m.default.Instance.playHarmEff(t,e,this.node),this.nowHp<1?(this.isDie=!0,this.die()):(this.hpBG.active||(this.hpBG.active=!0),this.updeteHpBar(),cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.2,{color:cc.Color.WHITE}).start()))},e.prototype.knockback=function(t,e){var o=this;if(!this.isOutPathCourse&&!this.isDie&&!this.isDie&&t){var i=m.default.Instance.getWorldPosV2(this.node),n=m.default.Instance.getWorldPosV2(t),a=i.sub(n).normalize().mul(e);this.knockbackOffset=cc.v3(a.x,a.y,0),cc.Tween.stopAllByTarget(this.knockbackOffset),cc.tween(this.knockbackOffset).to(.15,{x:0,y:0,z:0}).call(function(){o.knockbackOffset=cc.Vec3.ZERO}).start()}},e.prototype.frozenEd=function(t){var e=this;this.isOutPathCourse||this.isDie||(this.setSpAnim(!0),t>this.frozenCountTime&&(this.frozenCountTime=t),this.skillFrozen=!0,this.frozenPos.active=!0,0==this.frozenPos.childrenCount&&this.loadPrefab(d.BHD_BundleName.Prefabs,"effAnim/frozen",function(t){var o=cc.instantiate(t);o.setParent(e.frozenPos),o.setPosition(cc.v2())}))},e.prototype.speedCut=function(t){if(!this.isOutPathCourse&&!this.isDie&&this.enemyState!=l.attack){var e=1-t;e<0&&(e=0),this.isSpeedCut=!0,this.speCutTime=2;var o=this.basicsMoveSpeed*e;o<this.moveSpeed&&(this.moveSpeed=o,this.spAnim.timeScale=1*e)}},e.prototype.setSpAnimPlaySpeed=function(){var t=this.spAnim.findAnimation(d.BHD_AnimName.attack);this.clipDuration=t.duration,this.atkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.atkInterval*1.05)},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start(),3!=this.enemyType&&4!=this.enemyType||t<.4&&!this.isUnderHp&&(this.isUnderHp=!0,this.spAnim.timeScale=1,this.moveSpeed=this.basicsMoveSpeed*this.addSpeedDouble,this.enemyState!=l.attack&&this.spAnim.setAnimation(0,d.BHD_AnimName.skill,!0))},e.prototype.die=function(){var t=this;this.isDie=!0,this.enemyState=l.die,m.default.Instance.addDropExp(this.exp);var e=function(){m.default.Instance.playEffAnim(t.node,d.BHD_EffAnimType.enemyDieEff,3),g.default.getInstance().pushObj(t.node)};if(4==this.enemyType)this.frozenPos.removeAllChildren(),this.frozenPos.active=!1,this.hpBG.active=!1,this.spAnim.paused=!1,this.spAnim.setAnimation(0,d.BHD_AnimName.die,!1),u.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.siwang);else if(1==this.enemyType){if(this.isSonEnemy)u.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.siwang);else{m.default.Instance.nowWaveAllNum+=this.sons.childrenCount;for(var i=function(e){g.default.getInstance().getObj("enemy/enemy_1",function(i){i.setParent(m.default.Instance.enemyBase);var n=e.convertToWorldSpaceAR(cc.v2(0,0)),a=i.parent.convertToNodeSpaceAR(n);i.setPosition(a),i.getComponent(o).init(m.default.Instance.nowMaxWave,0,t.outPaths,!0)})},n=0,a=this.sons.children;n<a.length;n++)i(a[n]);u.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.zhizhusiwang)}e()}else e(),u.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.siwang);m.default.Instance.removeEnemyList(this.node)},e.prototype.setSpAnim=function(t){this.isDie||this.skillFrozen||(this.spAnim.paused=t)},c([_(sp.Skeleton)],e.prototype,"spAnim",void 0),c([_(cc.Node)],e.prototype,"boxCol",void 0),c([_(cc.Node)],e.prototype,"hpBG",void 0),c([_(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([_(cc.Node)],e.prototype,"frozenPos",void 0),c([_(cc.Node)],e.prototype,"outWarn",void 0),c([_(cc.Node)],e.prototype,"sons",void 0),c([_(cc.Integer)],e.prototype,"enemyType",void 0),o=c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BHD_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"99c592zJ99I0LeSYmH5vQx5","BHD_GameData");var i=e,n=o;cc._RF.push(i,"99c592zJ99I0LeSYmH5vQx5","BHD_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emBHD_GameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.mateCfg="mateCfg",t.GearParameterCfg="GearParameterCfg",t.enemyCfg="enemyCfg",t.enemyID="enemyID",t.waveCfg="waveCfg",t.CharacterCfg="CharacterCfg",t.CharacterNum="CharacterNum"}(n.emBHD_GameDataKeys||(n.emBHD_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],BHD_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"0fc8cOCVYNKVpuImIMKyg/q","BHD_GameEnumData");var i=e,n=o;cc._RF.push(i,"0fc8cOCVYNKVpuImIMKyg/q","BHD_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.BHD_enumGearParameterCfg=void 0,function(t){t[t.StarHeathy=1]="StarHeathy",t[t.StarMoveSpeed=2]="StarMoveSpeed",t[t.BOXEXP=3]="BOXEXP",t[t.EnemyMoveSpeed=4]="EnemyMoveSpeed",t[t.Refreshprice=5]="Refreshprice",t[t.StarGold=6]="StarGold",t[t.RepairPrice=7]="RepairPrice",t[t.SpinderHp=8]="SpinderHp",t[t.BoundSpeed=9]="BoundSpeed",t[t.BoundSpeedTime=10]="BoundSpeedTime"}(n.BHD_enumGearParameterCfg||(n.BHD_enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],BHD_GameMgr:[function(t,e,o){"use strict";cc._RF.push(e,"1715eT5dxxDhrWDAEwbYrYA","BHD_GameMgr");var i=t,n=e,a=o;cc._RF.push(n,"1715eT5dxxDhrWDAEwbYrYA","BHD_GameMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("BHD_Config"),h=i("BHD_DataMgr"),f=i("BHD_GameEnumData"),m=i("BHD_HarmEff"),g=i("BHD_Skills"),y=i("BHD_TowerGoldAnim"),v=i("BHD_PoolMgr"),_=i("BHD_EnemyRole"),b=i("BHD_RoleBox"),B=i("BHD_RoleFieldAtk"),I=i("BHD_TowerDefense"),P=cc._decorator,C=P.ccclass,D=P.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameTopRoot=null,e.boxInfoTips=null,e.boxSpare=null,e.towerRoleBox=null,e.mapTowersList=[],e.enemyBase=null,e.roleBulletBase=null,e.skillsBase=null,e.skillRoleBase=null,e.harmEffBase=null,e.shopBoxRoot=null,e.towerDefenses=[],e.birthEnemBase=null,e.btn_PlayGo=null,e.buffBoxIcon=null,e.buffBoxLevelIcon=null,e.buffBoxExpBar=null,e.txtLevel=null,e.levelBar=null,e.goldRoot=null,e.txtGoldNum=null,e.btnUpdateSpare=null,e.txtSpareGold=null,e.birthEnemPos=[],e.towerBoxList={},e.towerBoxlength=0,e.isPause=!1,e.isfight=!1,e.isPrepare=!0,e.pitchBox=null,e.boxSpareAll=[],e.sceneAllBox=[],e.nowMaxWave=0,e.nowminWave=0,e.outWaveTime=0,e.waveInterval=0,e.isCanWave=!1,e.enemyTypeNum={},e.outEnemyInterval=.2,e.outEnemyTime=0,e.isWaveGameOver=!1,e.isWaveOver=!1,e.nowWaveAllNum=0,e.waveEnemySum=0,e.enemyAllLsit=[],e.dropLevel=0,e.dropUpLevelExp=0,e.dropNowExp=0,e.towerBackAtk=0,e.roleMateTips=null,e.tipsBoxInfo=null,e.goldNum=0,e.updateSpareGold=[],e.updateSpareNum=0,e.waveGoldNum=0,e.easterTowerGold=[],e.easterTowerNum=0,e.moveAnimTime=.2,e._StepEnemy=0,e.lastOutPathId=[],e.color_Green=cc.color().fromHEX("#08f61b"),e.color_Red=cc.color().fromHEX("#ff4a4a"),e.lastGoldNum=0,e.lastmMinDisPath=null,e.solderGainIDs=[],e.activateSkills=[],e.mateCfgs=[],e.activateSkillAtks=[],e.buffDatas=[],e.buffSelectionCount={},e.buffsPerRefresh=3,e.roleBoxBuffAtk={},e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this)},e.prototype.start=function(){this.initTowerBoxList(this.towerRoleBox.getChildByName("1").children,0),this.initTowerBoxList(this.towerRoleBox.getChildByName("2").children,1),this.initTowerBoxList(this.towerRoleBox.getChildByName("3").children,2),this.initTowerBoxList(this.towerRoleBox.getChildByName("4").children,3),this.birthEnemPos=this.node.getChildByName("birthEnemPos").children,this.btn_PlayGo.on(cc.Node.EventType.TOUCH_END,this.playGame,this),this.btnUpdateSpare.on(cc.Node.EventType.TOUCH_END,this.btnUpdateSpareCall,this),this.initData(),this.updateBoxSpare(),this.initFieldRole()},e.prototype.onDestroy=function(){o.Instance=null,clearInterval(this.upMaxLevelDropBoxId)},e.prototype.initData=function(){this.characterCfg=JSON.parse(JSON.stringify(h.default.getInstance().data.CharacterCfg)),this.waveCfg=h.default.getInstance().data.waveCfg,this.mateCfgs=h.default.getInstance().data.mateCfg,this.buffDatas=h.default.getInstance().data.buffCfg,this.dropUpLevelExp=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.BOXEXP)[0],this.goldNum=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.StarGold),this.updateSpareGold=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.Refreshprice),this.easterTowerGold=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.RepairPrice),this.txtGoldNum.string=""+this.goldNum,this.lastGoldNum=this.goldNum,this.setUpdateSpareGold()},e.prototype.initTowerBoxList=function(t,e){for(var o=0,i=t;o<i.length;o++){var n=i[o];this.towerBoxList[this.towerBoxlength]={box:n,index:e,roleSp:null},this.towerBoxlength++}},e.prototype.initFieldRole=function(){var t=this,e=0,o=this.randomBoxs(4);this.loadPrefab(d.BHD_BundleName.Prefabs,"roleBox/roleBox",function(i){for(var n=0,a=o;n<a.length;n++){var r=a[n],s=3*e,c=t.towerBoxList[s].box,l=cc.instantiate(i);l.setParent(c),l.setPosition(cc.v2());var p=l.getComponent(b.default);p.init(r.CharacterID,r.grade),p.upBoxEnter(s,c,t.towerBoxList[s].index),p.unLockRole(),t.towerBoxList[s].roleSp=p,t.sceneAllBox.push(p),4==++e&&(t.sendEvent(d.BHD_EventName.UpdateSceneAllBox,t.sceneAllBox),t.updateSolderID())}})},e.prototype.setPause=function(t){this.isPause=t,this.sendEvent(d.BHD_EventName.SetPause,this.isPause)},e.prototype.isUpBoxFight=function(){for(var t in this.towerBoxList)if(null!=this.towerBoxList[t].roleSp)return!0;return!1},e.prototype.playGame=function(){null==this.pitchBox?this.isUpBoxFight()?(this.isPrepare=!1,this.playMoveAnim(!0),this.sendEvent(d.BHD_EventName.PlayGame),this.updateEnemyMaxWave(),this.isfight=!0,p.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.kaishi)):this.upTipsBox("\u8bf7\u5148\u4e0a\u9635\u89d2\u8272"):this.upTipsBox("\u8bf7\u677e\u5f00\u683c\u5b50\u540e\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c")},e.prototype.waveOver=function(){this.updateSpareNum=0,this.txtLevel.string="\u7b2c"+(this.nowMaxWave+1)+"/20\u6ce2",this.isfight=!1,this.sendEvent(d.BHD_EventName.waveOver);var t=this.round(this.saveTowerNum()*this.waveGoldNum);this.setGoldNum(t),this.setUpdateSpareGold(),this.playMoveAnim(!1),this.upAddBoxWeight(),this.updateBoxSpare(),cc.Tween.stopAllByTarget(this.levelBar),this.levelBar.progress=0,p.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.bocijieshu)},e.prototype.playMoveAnim=function(t){var e=this,o=cc.v3(),i=0;t?(i=0,o=cc.v3(0,this.shopBoxRoot.y-600)):(o=cc.v3(0,this.shopBoxRoot.y+600),i=255),cc.tween(this.shopBoxRoot).to(this.moveAnimTime,{position:o}).call(function(){t||(e.isPrepare=!0)}).start(),cc.tween(this.towerRoleBox).to(this.moveAnimTime,{opacity:i}).start()},e.prototype.saveTowerNum=function(){for(var t=0,e=0,o=this.towerDefenses;e<o.length;e++)o[e].isDie||t++;return t},e.prototype.update=function(t){if(!this.isPause&&this.isfight)if(this._StepEnemy++>20&&(this._StepEnemy=0,this.tierBoxLList(this.enemyBase)),!this.isWaveOver&&this.isCanWave)this.outWaveTime+=t,this.outWaveTime>this.waveInterval&&(this.nowminWave++,this.updateEnemyMinWave());else if(this.outEnemyTime+=t,this.outEnemyTime>this.outEnemyInterval){this.outEnemyTime=0;var e=Object.keys(this.enemyTypeNum);if(0===e.length)return void(this.isCanWave=!0);this.isCanWave=!1;var o=Number(e[Math.floor(Math.random()*e.length)]);this.enemyTypeNum[o],this.outEnemy(o),this.enemyTypeNum[o]-=1,0==this.enemyTypeNum[o]&&delete this.enemyTypeNum[o],0===Object.keys(this.enemyTypeNum).length?this.isCanWave=!0:this.isCanWave=!1}},e.prototype.updateEnemyMaxWave=function(){this.nowMaxWave++,this.nowMaxMonsterInfo=[],this.waveEnemySum=0,this.nowWaveAllNum=0,this.waveGoldNum=0;for(var t=0;t<this.waveCfg.length;t++)this.waveCfg[t].id==this.nowMaxWave&&(this.nowMaxMonsterInfo.push(this.waveCfg[t]),this.nowWaveAllNum+=this.waveCfg[t].MonsterSum,this.waveGoldNum+=this.round(this.waveCfg[t].Golden),t==this.waveCfg.length-1&&(this.isWaveGameOver=!0));this.nowminWave=0,this.isWaveOver=!1,this.updateEnemyMinWave()},e.prototype.updateEnemyMinWave=function(){if(!(this.nowminWave>this.nowMaxMonsterInfo.length-1)){this.enemyTypeNum=[],this.outWaveTime=0,this.waveInterval=this.nowMaxMonsterInfo[this.nowminWave].FirstInterval;for(var t=this.nowMaxMonsterInfo[this.nowminWave].MonsterSum,e=0;e<this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++){var o=this.nowMaxMonsterInfo[this.nowminWave].Monster[e][0];this.enemyTypeNum[o]=1}for(e=0;e<t-this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++)this.addOutEnemyQueue(this.nowMaxMonsterInfo[this.nowminWave].Monster);this.nowminWave==this.nowMaxMonsterInfo.length-1&&(this.isWaveOver=!0),this.isCanWave=!1}},e.prototype.addOutEnemyQueue=function(t){var e=this.random(0,t.length,!0),o=t[e][0];this.enemyTypeNum[o]==t[e][1]?this.addOutEnemyQueue(t):this.enemyTypeNum[o]+=1},e.prototype.outEnemy=function(t){var e=this,o=this.getOutEnemyPathId(t),i="enemy/enemy_"+t;v.default.getInstance().getObj(i,function(i){4!=t?(i.setParent(e.birthEnemBase),e.tierBoxLList(e.birthEnemBase)):i.setParent(e.enemyBase);var n=e.birthEnemPos[o].children;4==t?i.setPosition(e.enemyRandomPosInCircle()):i.setPosition(n[0].getPosition()),i.getComponent(_.default).init(e.nowMaxWave,o,n)})},e.prototype.getOutEnemyPathId=function(t){var e=this;this.lastOutPathId.length>9&&this.lastOutPathId.shift();var o=[],i=(o=1==t||3==t?[0,1,2,3,4,5,10,11,12,13]:[0,1,2,3,4,5,6,7,8,9]).filter(function(t){return!e.lastOutPathId.includes(t)});0===i.length&&(console.log("\u8def\u7ebf\uff0c\u5168\u90e8\u7528\u8fc7\u4e86\uff0c\u91cd\u7f6e available"),i=o.slice(),this.lastOutPathId=[]);var n=i[Math.floor(Math.random()*i.length)];return this.lastOutPathId.push(n),n},e.prototype.enemyRandomPosInCircle=function(){var t=this.random(225,320),e=this.enemyBase.convertToWorldSpaceAR(cc.v2(0,0)),o=360*Math.random()*Math.PI/180,i=e.x+Math.cos(o)*t,n=e.y+Math.sin(o)*t,a=cc.v2(i,n),r=this.enemyBase.convertToNodeSpaceAR(a),s=r.y;return s<100&&s>-100&&(r.y=s>0?this.random(100,280):-this.random(100,280)),r},e.prototype.addEnemyList=function(t){this.enemyAllLsit.push(t),t.setParent(this.enemyBase)},e.prototype.removeEnemyList=function(t){var e=this.enemyAllLsit.indexOf(t);this.enemyAllLsit.splice(e,1),this.waveEnemySum++,this.updateLevelBar(),this.waveEnemySum>=this.nowWaveAllNum&&0==this.enemyAllLsit.length&&(this.isfight=!1,this.isWaveGameOver?(this.setPause(!0),u.UIMgr.getInstance().openUI(d.BHD_UIID.BHD_UIGameOver,1,!0)):this.waveOver())},e.prototype.getEnemyNear=function(t,e,o){for(var i=t.convertToWorldSpaceAR(cc.v2(0,0)),n=[],a=0,r=this.enemyAllLsit;a<r.length;a++){var s=r[a];if(s.active){var c=s.convertToWorldSpaceAR(cc.v2(0,0)),l=c.x-i.x,p=c.y-i.y,u=l*l+p*p;u<o&&n.push({enemy:s,sqrDist:u})}}return n.sort(function(t,e){return t.sqrDist-e.sqrDist}),n.slice(0,e).map(function(t){return t.enemy})},e.prototype.getCollisionBullet=function(t){for(var e=t.getBoundingBoxToWorld(),o=0,i=this.enemyAllLsit;o<i.length;o++){var n=i[o],a=n.getComponent(_.default).boxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(e,a))return n}return null},e.prototype.getBlastCollisionBullet=function(t){for(var e=[],o=t.getBoundingBoxToWorld(),i=0,n=this.enemyAllLsit;i<n.length;i++){var a=n[i],r=a.getComponent(_.default).boxCol.getBoundingBoxToWorld();cc.Intersection.rectRect(o,r)&&e.push(a)}return e},e.prototype.updateLevelBar=function(){var t=this.waveEnemySum/this.nowWaveAllNum;cc.Tween.stopAllByTarget(this.levelBar),cc.tween(this.levelBar).to(.1,{progress:t}).start()},e.prototype.getTowerNear=function(t){for(var e=t.convertToWorldSpaceAR(cc.v2(0,0)),o=this.towerDefenses[0],i=Number.MAX_SAFE_INTEGER,n=0,a=this.towerDefenses;n<a.length;n++){var r=a[n];if(!r.isDie){var s=r.node.convertToWorldSpaceAR(cc.v2(0,0)),c=s.x-e.x,l=s.y-e.y,p=c*c+l*l;p<i&&(i=p,o=r)}}return o},e.prototype.isGameOver=function(){for(var t=!0,e=0,o=this.towerDefenses;e<o.length;e++)if(!o[e].isDie){t=!1;break}t&&(this.setPause(!0),u.UIMgr.getInstance().openUI(d.BHD_UIID.BHD_UIGameOver,1,!1),p.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.shibai))},e.prototype.getEasterTowerGold=function(){return this.easterTowerGold[this.easterTowerNum]||this.easterTowerGold[this.easterTowerGold.length-1]},e.prototype.playSkillsAtk=function(t){var e,o,i=this,n=0,a=7;for(var r in this.towerBoxList)if(null!=this.towerBoxList[r].roleSp){var s=this.towerBoxList[r].roleSp;s.skillID==t&&s.level<a&&(n=s.typeID,a=s.level)}e=h.default.getInstance().getBoxProInfo(n,a).Atk,o=h.default.getInstance().getSkillsCfg(t).mateSkillATK;var c=this.round(o*e);if(7==t)this.loadPrefab(d.BHD_BundleName.Prefabs,"role/roleFieldSkill",function(t){var e=cc.instantiate(t);e.setParent(i.skillRoleBase),e.getComponent(B.default).summonSkill(c)});else{var l="skills/skill_"+t;this.loadPrefab(d.BHD_BundleName.Prefabs,l,function(e){var o=cc.instantiate(e);o.setParent(i.skillsBase),o.setPosition(cc.v3()),o.getComponent(g.default).init(c,t)})}},e.prototype.addDropExp=function(t){var e=this;if(this.dropNowExp+=t,this.dropNowExp>=this.dropUpLevelExp&&this.dropLevel<4){this.dropLevel++;var o=this.dropNowExp-this.dropUpLevelExp;this.dropNowExp=o;var i=this.dropNowExp/this.dropUpLevelExp;this.buffBoxExpBar.progress=0,clearInterval(this.upMaxLevelDropBoxId),this.upMaxLevelDropBoxId=null,cc.Tween.stopAllByTarget(this.buffBoxIcon),cc.tween(this.buffBoxIcon).to(.5,{scale:1.2}).to(.5,{scale:1}).start(),this.upMaxLevelDropBoxId=setInterval(function(){cc.tween(e.buffBoxIcon).to(.5,{scale:1.2}).to(.5,{scale:1}).start()},1e3),this.loadSpriteFrame(d.BHD_BundleName.Sprite,"buffBoxIcon/box_0"+this.dropLevel,function(t){e.buffBoxIcon.getComponent(cc.Sprite).spriteFrame=t});var n="";this.dropLevel<4?(n="buffBoxIcon/jb_0"+this.dropLevel,this.dropUpLevelExp=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.BOXEXP)[this.dropLevel]):(n="buffBoxIcon/max",i=1),this.buffBoxLevelIcon.node.active=!0,this.loadSpriteFrame(d.BHD_BundleName.Sprite,n,function(t){e.buffBoxLevelIcon.spriteFrame=t}),this.playEffAnim(this.buffBoxIcon,d.BHD_EffAnimType.boxUpLevelEff,1),cc.Tween.stopAllByTarget(this.buffBoxExpBar),cc.tween(this.buffBoxExpBar).to(.1,{progress:i}).start();var a=this.showBuffSelection(this.dropLevel);u.UIMgr.getInstance().openUI(d.BHD_UIID.BHD_UISelectBuff,1,a),this.setPause(!0)}else{if(4==this.dropLevel)return;i=this.dropNowExp/this.dropUpLevelExp,cc.Tween.stopAllByTarget(this.buffBoxExpBar),cc.tween(this.buffBoxExpBar).to(.1,{progress:i}).start()}},e.prototype.openBuffBox=function(t){var e=this;void 0===t&&(t=!1),0!=this.dropLevel&&(t||(this.dropLevel=0),this.dropNowExp=0,this.buffBoxLevelIcon.node.active=!1,this.buffBoxExpBar.progress=0,this.dropUpLevelExp=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.BOXEXP)[this.dropLevel],this.loadSpriteFrame(d.BHD_BundleName.Sprite,"buffBoxIcon/box_0"+this.dropLevel,function(t){e.buffBoxIcon.getComponent(cc.Sprite).spriteFrame=t}),clearInterval(this.upMaxLevelDropBoxId),this.upMaxLevelDropBoxId=null,cc.Tween.stopAllByTarget(this.buffBoxIcon),this.buffBoxIcon.scale=1)},e.prototype.btnUpdateSpareCall=function(){if(null==this.pitchBox){var t=this.updateSpareGold[this.updateSpareNum]||this.updateSpareGold[this.updateSpareGold.length-1];this.isGoldEnough(t)?(this.updateSpareNum++,this.setGoldNum(-t),this.updateBoxSpare()):this.upTipsBox("\u91d1\u5e01\u4e0d\u8db3")}else this.upTipsBox("\u8bf7\u677e\u5f00\u683c\u5b50\u540e\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c")},e.prototype.setUpdateSpareGold=function(){var t=this.updateSpareGold[this.updateSpareNum]||this.updateSpareGold[this.updateSpareGold.length-1],e=this.isGoldEnough(t);this.txtSpareGold.string=""+t,this.txtSpareGold.node.color=e?cc.Color.WHITE:this.color_Red},e.prototype.setGoldNum=function(t){var e=this;t=this.round2(t),this.goldNum+=t,this.txtGoldNum.node.color=this.goldNum>this.lastGoldNum?this.color_Green:this.color_Red,this.txtGoldNum.string=""+this.goldNum,cc.Tween.stopAllByTarget(this.goldRoot),cc.tween(this.goldRoot).to(.1,{scale:1.3}).to(.1,{scale:1}).call(function(){e.txtGoldNum.node.color=cc.Color.WHITE}).start(),this.lastGoldNum=this.goldNum,this.sendEvent(d.BHD_EventName.SetGoldNum),this.setUpdateSpareGold()},e.prototype.isGoldEnough=function(t){return t=this.round2(t),this.goldNum-t>=0},e.prototype.updateBoxSpare=function(){for(var t=this,e=0,o=this.boxSpareAll;e<o.length;e++){var i=o[e],n=this.sceneAllBox.indexOf(i.getComponent(b.default));this.sceneAllBox.splice(n,1)}this.boxSpare.removeAllChildren(),this.boxSpareAll=[];for(var a=0,r=this.randomBoxs(3),s=function(e){c.loadPrefab(d.BHD_BundleName.Prefabs,"roleBox/roleBox",function(o){var i=cc.instantiate(o);i.setParent(t.boxSpare);var n=i.getComponent(b.default);n.init(e.CharacterID,e.grade),t.boxSpareAll.push(i),t.sceneAllBox.push(n),3==++a&&(t.calculateLayout(-1,!0),t.sendEvent(d.BHD_EventName.UpdateSceneAllBox,t.sceneAllBox))})},c=this,l=0,p=r;l<p.length;l++)s(p[l])},e.prototype.randomBoxs=function(t){for(var e=this.characterCfg.filter(function(t){return t.weight>0}),o=[],i=[],n=0,a=0,r=e;a<r.length;a++)n+=r[a].weight,i.push(n);for(var s=n,c=0;c<t;c++)for(var l=Math.random()*s,p=0;p<i.length;p++)if(l<i[p]){o.push(e[p]);break}return o},e.prototype.upAddBoxWeight=function(){for(var t=0,e=this.characterCfg;t<e.length;t++){var o=e[t];o.weight+=o.weightUp}},e.prototype.moveRoleBox=function(t,e){if(t==d.BHD_MoveBoxtate.TouchStart){if(this.setParentPos(e.node,this.gameTopRoot),this.boxSpareAll.includes(e.node)){var o=this.boxSpareAll.indexOf(e.node);this.boxSpareAll.splice(o,1),this.calculateLayout()}-1!=e.mapKey&&(this.towerBoxList[e.mapKey].roleSp=null)}var i=-1,n=null,a=this.getWorldPosV2(e.node),r=Number.MAX_SAFE_INTEGER;for(var s in this.towerBoxList){var c=Number(s),l=this.towerBoxList[c].box;if(l.activeInHierarchy){var p=cc.Vec2.distance(a,this.getWorldPosV2(l));p<r&&(r=p,p<65&&(i=c,n=this.towerBoxList[c]))}}null!=this.lastmMinDisPath&&r>=65&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1),this.lastmMinDisPath=null),null!=n&&n!=this.lastmMinDisPath&&(null!=this.lastmMinDisPath&&this.playMoveBoxAnim(this.lastmMinDisPath,!1),this.playMoveBoxAnim(n,!0),this.lastmMinDisPath=n),t==d.BHD_MoveBoxtate.TouchEnd&&(null!=this.lastmMinDisPath&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1),this.lastmMinDisPath=null),this.endroleBox(e,i))},e.prototype.playMoveBoxAnim=function(t,e){var o=e?1.18:1,i=e?cc.Color.GREEN:cc.Color.WHITE,n=e?.06:.15,a=t.box;cc.Tween.stopAllByTarget(a),cc.tween(a).to(n,{scale:o,color:i}).start()},e.prototype.endroleBox=function(t,e){var o=this;if(-1!=e){if(t.isLock){if(!this.isGoldEnough(t.lockGold))return this.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"),void this.insertRoleBoxSpare(t);this.setGoldNum(-t.lockGold),t.unLockRole()}if(null!=this.towerBoxList[e].roleSp){var i=this.towerBoxList[e].roleSp;if(i.typeID==t.typeID&&i.level==t.level&&i.level<5){var n=i.node.convertToWorldSpaceAR(cc.v3(0,0)),a=t.node.parent.convertToNodeSpaceAR(n);return cc.Tween.stopAllByTarget(t.node),void cc.tween(t.node).to(.07,{position:a}).call(function(){i.upBoxLevel();var e=o.sceneAllBox.indexOf(t);o.sceneAllBox.splice(e,1),o.sendEvent(d.BHD_EventName.UpdateSceneAllBox,o.sceneAllBox),t.die(),o.updateSolderID()}).start()}}if(-1!=t.mapKey&&null!=this.towerBoxList[e].roleSp){var r=this.towerBoxList[t.mapKey];this.towerBoxList[e].roleSp.downBoxEnter(),this.towerBoxList[e].roleSp.upBoxEnter(t.mapKey,r.box,r.index),this.towerBoxList[t.mapKey].roleSp=this.towerBoxList[e].roleSp}else null!=this.towerBoxList[e].roleSp&&this.insertRoleBoxSpare(this.towerBoxList[e].roleSp);p.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.fangrugezi),t.upBoxEnter(e,this.towerBoxList[e].box,this.towerBoxList[e].index),this.towerBoxList[e].roleSp=t}else{for(var s=this.getWorldPosV2(t.node),c=function(e){var i=l.getWorldPosV2(e);if(cc.Vec2.distance(s,i)<60){var n=e.getComponent(b.default);if(n.typeID==t.typeID&&n.level==t.level&&n.level<5&&!n.isLock){if(t.isLock){if(!l.isGoldEnough(t.lockGold))return l.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"),l.insertRoleBoxSpare(t),{value:void 0};l.setGoldNum(-t.lockGold),t.unLockRole()}var a=n.node.convertToWorldSpaceAR(cc.v3(0,0)),r=t.node.parent.convertToNodeSpaceAR(a);return cc.Tween.stopAllByTarget(t.node),cc.tween(t.node).to(.07,{position:r}).call(function(){n.upBoxLevel();var e=o.sceneAllBox.indexOf(t);o.sceneAllBox.splice(e,1),o.sendEvent(d.BHD_EventName.UpdateSceneAllBox,o.sceneAllBox),t.die()}).start(),{value:void 0}}}},l=this,u=0,h=this.boxSpareAll;u<h.length;u++){var f=c(h[u]);if("object"==typeof f)return f.value}this.insertRoleBoxSpare(t)}this.updateSolderID()},e.prototype.insertRoleBoxSpare=function(t){t.downBoxEnter(),this.setParentPos(t.node,this.boxSpare);var e=this.findPosIndex(t.node);e<this.boxSpare.childrenCount&&this.boxSpare.insertChild(t.node,e),e>this.boxSpareAll.length?this.boxSpareAll.push(t.node):this.boxSpareAll.splice(e,0,t.node),this.calculateLayout(e)},e.prototype.findPosIndex=function(t){if(0==this.boxSpareAll.length)return 0;for(var e=0,o=Number.MAX_SAFE_INTEGER,i=this.getWorldPosV2(t),n=0;n<this.boxSpareAll.length;n++){var a=cc.Vec2.distance(i,this.getWorldPosV2(this.boxSpareAll[n]));a<o&&(o=a,e=n)}return this.getWorldPosV2(this.boxSpareAll[e]).x>i.x?e:e+1},e.prototype.calculateLayout=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=this.boxSpareAll;if(!(o.length<1)){var i=this.boxSpare.width-20,n=o.reduce(function(t,e){return t+e.width},0),a=[];if(n<=i)for(var r=-i/2+(p=(i-n)/(o.length+1)),s=0,c=o;s<c.length;s++){var l=c[s];a.push(cc.v3(r+l.width/2,0)),r+=l.width+p}else for(var p=(i-n)/(o.length-1),u=(r=-i/2,0),d=o;u<d.length;u++)l=d[u],a.push(cc.v3(r+l.width/2,0)),r+=l.width+p;for(var h=0;h<o.length;h++){var f=h,m=o[f];cc.Tween.stopAllByTarget(m),t==f||e?cc.tween(m).to(.2,{position:a[f],angle:this.random(0,1)>.5?7:-7},{easing:"quadOut"}).start():cc.tween(m).to(.2,{position:a[f]},{easing:"quadOut"}).start()}}},e.prototype.getFieldPos=function(t){for(var e=this.mapTowersList[t].children,o=e.length-1;o>=0;o--)if(0==e[o].childrenCount)return e[o];return null},e.prototype.setTowerRoleActive=function(t,e){if(e)this.sceneAllBox.push(t),this.sendEvent(d.BHD_EventName.UpdateSceneAllBox,this.sceneAllBox),this.towerBoxList[t.mapKey].roleSp=t;else{var o=this.sceneAllBox.indexOf(t);this.sceneAllBox.splice(o,1),this.towerBoxList[t.mapKey].roleSp=null}this.updateSolderID()},e.prototype.updateSolderID=function(){for(var t in this.solderGainIDs=[],this.activateSkillAtks=[],this.towerBoxList)if(null!=this.towerBoxList[t].roleSp){var e=this.towerBoxList[t].roleSp;this.solderGainIDs.includes(e.typeID)||this.solderGainIDs.push(e.typeID),(null==this.activateSkillAtks[e.skillID]||e.level<this.activateSkillAtks[e.skillID])&&(this.activateSkillAtks[e.skillID]=e.level)}this.getActivatedMateIDs()},e.prototype.getActivatedMateIDs=function(){var t=this;this.activateSkills=[];for(var e=function(e){for(var i=0,n=o.mateCfgs;i<n.length;i++){var a=n[i];o.activateSkills.includes(a.mateID)||a.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).includes(e)})&&a.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).every(function(e){return t.solderGainIDs.includes(e)})})&&o.activateSkills.push(a.mateID)}},o=this,i=0,n=this.solderGainIDs;i<n.length;i++)e(n[i]);this.sendEvent(d.BHD_EventName.ActivateSkills,this.activateSkills,this.activateSkillAtks)},e.prototype.showBuffSelection=function(t){var e=this.getAvailableBuffs(t);return this.getRandomBuffs(e,this.buffsPerRefresh)},e.prototype.onBuffSelected=function(t){this.buffSelectionCount[t]=(this.buffSelectionCount[t]||0)+1},e.prototype.getAvailableBuffs=function(t){var e=this;return this.buffDatas.filter(function(o){if(o.buffQuality==t)return(e.buffSelectionCount[o.ID]||0)<o.buffNum})},e.prototype.getRandomBuffs=function(t,e){if(t.length<=e)return t;for(var o=[],i=t,n=0;n<e;n++){for(var a=0,r=0,s=i;r<s.length;r++)a+=s[r].buffweight;for(var c=Math.random()*a,l=-1,p=0;p<i.length;p++)if((c-=i[p].buffweight)<0){l=p;break}l>=0&&(o.push(i[l]),i.splice(l,1))}return o},e.prototype.selectBuff=function(t,e){e=this.round2(e),9006==t?this.setGoldNum(e):(null==this.roleBoxBuffAtk[t]?this.roleBoxBuffAtk[t]=e:this.roleBoxBuffAtk[t]+=e,9005==t?(this.towerBackAtk+=e,this.sendEvent(d.BHD_EventName.GainTowerBackAtk)):9004==t&&this.sendEvent(d.BHD_EventName.TowerAddMaxHp,this.roleBoxBuffAtk[t]),this.sendEvent(d.BHD_EventName.UpdateRolePro))},e.prototype.tierBoxLList=function(t){var e=t.children;e.length<2||(e.sort(function(t,e){return e.y-t.y}),e.forEach(function(t,e){t.setSiblingIndex(e)}))},e.prototype.playEffAnim=function(t,e,o){var i=this.gameTopRoot;switch(o){case 1:i=this.gameTopRoot;break;case 3:i=this.enemyBase}var n=t.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/"+e,function(t){t.setParent(i);var e=t.parent.convertToNodeSpaceAR(n);t.setPosition(e)})},e.prototype.playOutRoleEff=function(t,e,o){var i=o?"outRoleEff":"dieRoleEff",n=t.convertToWorldSpaceAR(cc.v2(0,0)),a=e.getChildByName("eff");v.default.getInstance().getObj("effAnim/"+i,function(t){t.setParent(a);var e=t.parent.convertToNodeSpaceAR(n);t.setPosition(e)})},e.prototype.playHarmEff=function(t,e,o){var i=this,n=o.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/harmEff",function(o){o.setParent(i.harmEffBase);var a=o.parent.convertToNodeSpaceAR(n);a.y+=50,o.setPosition(a),o.getComponent(m.default).init(i.round(t),e)})},e.prototype.playTowerGoldAnim=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/towerGoldAnim",function(t){t.setParent(e.skillsBase);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i),t.getComponent(y.default).init(e.waveGoldNum)})},e.prototype.upTipsBox=function(t){this.sendEvent(d.BHD_EventName.upTipsBox,t)},e.prototype.getWorldPosV2=function(t){return t.parent.convertToWorldSpaceAR(t.getPosition())},e.prototype.getWorldPosV3=function(t){return t.parent.convertToWorldSpaceAR(t.position)},e.prototype.setParentPos=function(t,e){var o=this.getWorldPosV3(t);t.setParent(e);var i=e.convertToNodeSpaceAR(o);t.setPosition(i)},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.prototype.round2=function(t){return Math.round(100*t)/100},e.Instance=null,c([D(cc.Node)],e.prototype,"gameTopRoot",void 0),c([D(cc.Node)],e.prototype,"boxInfoTips",void 0),c([D(cc.Node)],e.prototype,"boxSpare",void 0),c([D(cc.Node)],e.prototype,"towerRoleBox",void 0),c([D(cc.Node)],e.prototype,"mapTowersList",void 0),c([D(cc.Node)],e.prototype,"enemyBase",void 0),c([D(cc.Node)],e.prototype,"roleBulletBase",void 0),c([D(cc.Node)],e.prototype,"skillsBase",void 0),c([D(cc.Node)],e.prototype,"skillRoleBase",void 0),c([D(cc.Node)],e.prototype,"harmEffBase",void 0),c([D(cc.Node)],e.prototype,"shopBoxRoot",void 0),c([D(I.default)],e.prototype,"towerDefenses",void 0),c([D(cc.Node)],e.prototype,"birthEnemBase",void 0),c([D(cc.Node)],e.prototype,"btn_PlayGo",void 0),c([D(cc.Node)],e.prototype,"buffBoxIcon",void 0),c([D(cc.Sprite)],e.prototype,"buffBoxLevelIcon",void 0),c([D(cc.ProgressBar)],e.prototype,"buffBoxExpBar",void 0),c([D(cc.Label)],e.prototype,"txtLevel",void 0),c([D(cc.ProgressBar)],e.prototype,"levelBar",void 0),c([D(cc.Node)],e.prototype,"goldRoot",void 0),c([D(cc.Label)],e.prototype,"txtGoldNum",void 0),c([D(cc.Node)],e.prototype,"btnUpdateSpare",void 0),c([D(cc.Label)],e.prototype,"txtSpareGold",void 0),o=c([C],e)}(l.default);a.default=T,cc._RF.pop(),cc._RF.pop()},{}],BHD_HarmEff:[function(t,e,o){"use strict";cc._RF.push(e,"ab2d8YJZElDjKW+HqseCoSx","BHD_HarmEff");var i=t,n=e,a=o;cc._RF.push(n,"ab2d8YJZElDjKW+HqseCoSx","BHD_HarmEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BHD_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconCritical=null,e.txtHarm=null,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.iconCritical.active=e,this.node.opacity=255,this.txtHarm.string=""+t;var i=this.node.position.clone();i.y+=40,cc.tween(this.node).to(.3,{position:i}).call(function(){i.y+=40}).to(.3,{position:i,opacity:0}).call(function(){o.die()}).start()},e.prototype.die=function(){p.default.getInstance().pushObj(this.node)},c([h(cc.Node)],e.prototype,"iconCritical",void 0),c([h(cc.Label)],e.prototype,"txtHarm",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"80d4euVuKRKSY0qu3mvjABe","BHD_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"80d4euVuKRKSY0qu3mvjABe","BHD_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=i("BHD_Config"),l=cc._decorator.ccclass,p=function(){function t(){this.poolMap={},this.poolRoot=null;var t=new cc.Node("BHD_PoolRoot"),e=cc.find("uiRoot");t.setParent(e),e.insertChild(t,0),this.poolRoot=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e){var o=t.replace(/\//g,"_");this.poolMap[o]&&this.poolMap[o].poolList.length>0?e(this.poolMap[o].getObj()):s.ResourceMgr.getInstance().loadRes(c.BHD_BundleName.Prefabs,t,cc.Prefab,function(t){var i=cc.instantiate(t);i.name=o,e(i)})},t.prototype.pushObj=function(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new u(t,this.poolRoot);this.poolMap[e]=o}},t.prototype.clear=function(){this.poolMap={},this.poolRoot.removeAllChildren()},e=r([l],t)}();a.default=p;var u=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],BHD_RoleBox:[function(t,e,o){"use strict";cc._RF.push(e,"2117eML/qFLXbOo9nX4K5S8","BHD_RoleBox");var i=t,n=e,a=o;cc._RF.push(n,"2117eML/qFLXbOo9nX4K5S8","BHD_RoleBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("BHD_Config"),d=i("BHD_DataMgr"),h=i("BHD_GameMgr"),f=i("BHD_BoxInfoTipsBox"),m=i("BHD_RoleMateTips"),g=i("BHD_PoolMgr"),y=i("BHD_RoleFieldAtk"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelBox=null,e.levelIcon=null,e.roleIcon=null,e.tipsUpLevel=null,e.lockRoot=null,e.txtLockGold=null,e.tipsUpLevelInitPos=null,e.skillID=0,e.typeID=0,e.level=0,e.mapKey=-1,e.mapTowerIndex=-1,e.boxCfg=null,e.isLock=!0,e.lockGold=0,e.atkForce=1,e.criticalChance=0,e.criticalForce=0,e.bulletEffect=0,e.bulletPro=1,e.atkInterval=1,e.roleField=null,e.isTapTouchStart=!1,e.deviationOnStart=null,e.color_Red=cc.color().fromHEX("#ff4a4a"),e.upEnterCourse=!1,e.animIndexID=null,e}return s(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.tipsUpLevelInitPos=this.tipsUpLevel.position.clone(),this.addEvent(u.BHD_EventName.UpdateSceneAllBox,this.updateAllBoxAccord),this.addEvent(u.BHD_EventName.PlayGame,this.closeBoxUpTips),this.addEvent(u.BHD_EventName.UpdateRolePro,this.updateRolePro),this.addEvent(u.BHD_EventName.SetGoldNum,this.setGoldNum)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.animIndexID)},e.prototype.init=function(t,e){this.typeID=t,this.level=e,this.updateBoxPro(!0)},e.prototype.onTouchStart=function(t){if(!this.upEnterCourse&&h.default.Instance.isPrepare&&null==h.default.Instance.pitchBox){h.default.Instance.pitchBox=this.node,this.isTapTouchStart=!0,this.playTipsInfo(!0),cc.Tween.stopAllByTarget(this.node),this.node.angle=0,this.node.setScale(1);var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.deviationOnStart=this.node.getPosition().subtract(e),this.updateTouchPos(t.getLocation()),h.default.Instance.moveRoleBox(u.BHD_MoveBoxtate.TouchStart,this)}},e.prototype.onTouchMove=function(t){this.isTapTouchStart&&(this.updateTouchPos(t.getLocation()),h.default.Instance.moveRoleBox(u.BHD_MoveBoxtate.TouchMove,this))},e.prototype.onTouchEnd=function(t){this.isTapTouchStart&&(this.isTapTouchStart=!1,h.default.Instance.pitchBox=null,this.playTipsInfo(!1),this.updateTouchPos(t.getLocation()),h.default.Instance.moveRoleBox(u.BHD_MoveBoxtate.TouchEnd,this))},e.prototype.updateTouchPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t).add(this.deviationOnStart);this.node.setPosition(e)},e.prototype.playTipsInfo=function(t){var e=this;if(t){var o="",i="#5bfe1b";switch(this.level){case 1:i="#5bfe1b";break;case 2:i="#1bc1fe";break;case 3:i="#e11bfe";break;case 4:i="#ffdb14";break;case 5:i="#ff2371"}switch(this.typeID){case 1:o="<b><outline color=black width=4>\u609f\u7a7a\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u51fb\u9000</color>\u654c\u4eba\uff0c</outline></b>";break;case 3:o="<b><outline color=black width=4>\u5ae6\u5a25\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u51bb\u7ed3</color>\u654c\u4eba<color="+i+">"+this.bulletPro+"\u79d2</color></outline></b>";break;case 4:o="<b><outline color=black width=4>\u5218\u5907\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u7a7f\u900f"+(this.bulletPro-1)+"\u540d</color>\u654c\u4eba</outline></b>";break;case 5:o="<b><outline color=black width=4>\u8bf8\u845b\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u53d1\u5c04<color="+i+">"+this.bulletPro+"\u9897</color>\u5b50\u5f39</outline></b>";break;case 6:o="<b><outline color=black width=4>\u4e54\u5e2e\u4e3b\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u7206\u70b8</color>\u5c0f\u8303\u56f4\u4f24\u5bb3</outline></b>";break;case 7:o="<b><outline color=black width=4>\u7d2b\u971e\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u5b50\u5f39<color="+i+">\u5206\u88c2"+this.bulletPro+"\u6b21</color></outline></b>";break;case 8:o="<b><outline color=black width=4>\u5173\u7fbd\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u53d1\u5c04<color="+i+">"+this.bulletPro+"\u9897\u6247\u5f62</color>\u5b50\u5f39</outline></b>";break;case 10:o="<b><outline color=black width=4>\u900d\u9065\u50e7\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u56de\u65cb</color>\u5b50\u5f39</outline></b>";break;case 11:o="<b><outline color=black width=4>\u516b\u6212\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u51cf\u4f4e<color="+i+">"+this.round2(100*this.bulletPro)+"%</color>\u79fb\u901f<color="+i+">2\u79d2</color></outline></b>";break;case 17:o="<b><outline color=black width=4>\u5b59\u5c1a\u9999\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u5b50\u5f39<color="+i+">\u5f39\u5c04"+(this.bulletPro-1)+"\u6b21</color></outline></b>"}null==h.default.Instance.tipsBoxInfo?g.default.getInstance().getObj("tipsBox/boxInfoTipsBox",function(t){t.setParent(h.default.Instance.boxInfoTips),h.default.Instance.tipsBoxInfo=t.getComponent(f.default),h.default.Instance.tipsBoxInfo.init(o,e.typeID,e.level)}):h.default.Instance.tipsBoxInfo.init(o,this.typeID,this.level),null==h.default.Instance.roleMateTips?g.default.getInstance().getObj("tipsBox/roleMateTips",function(t){t.setParent(h.default.Instance.boxInfoTips),h.default.Instance.roleMateTips=t.getComponent(m.default),h.default.Instance.roleMateTips.init(e.skillID)}):h.default.Instance.roleMateTips.init(this.skillID)}else null!=h.default.Instance.tipsBoxInfo&&h.default.Instance.tipsBoxInfo.die(),null!=h.default.Instance.roleMateTips&&h.default.Instance.roleMateTips.die()},e.prototype.setTowerActive=function(t){h.default.Instance.setTowerRoleActive(this,t),this.roleField.setTowerActive(t)},e.prototype.setGoldNum=function(){if(this.isLock){var t=h.default.Instance.goldNum>=this.lockGold;this.txtLockGold.node.color=t?cc.Color.WHITE:this.color_Red}},e.prototype.unLockRole=function(){this.isLock=!1,this.lockRoot.active=!1},e.prototype.upBoxEnter=function(t,e,o){var i=this;this.upEnterCourse=!0,this.mapKey=t,cc.Tween.stopAllByTarget(this.node),h.default.Instance.setParentPos(this.node,e),this.node.angle=0,cc.tween(this.node).to(.1,{position:cc.v3()}).call(function(){cc.Tween.stopAllByTarget(i.node),i.node.scale=.1,cc.tween(i.node).to(.12,{scale:1}).call(function(){i.upEnterCourse=!1}).start()}).start(),this.mapTowerIndex!=o&&(null!=this.roleField&&(this.roleField.die(),this.roleField=null),this.loadPrefab(u.BHD_BundleName.Prefabs,"role/roleFieldAtk",function(t){var e=cc.instantiate(t);e.setParent(h.default.Instance.getFieldPos(i.mapTowerIndex)),i.roleField=e.getComponent(y.default);var o={typeID:i.typeID,level:i.level,atkForce:i.atkForce,criticalChance:i.criticalChance,criticalForce:i.criticalForce,bulletEffect:i.bulletEffect,bulletPro:i.bulletPro,dir:null,isSplitBullet:!1,atkInterval:i.atkInterval};i.roleField.init(o)})),this.mapTowerIndex=o},e.prototype.downBoxEnter=function(){null!=this.roleField&&(this.roleField.die(),this.roleField=null),this.mapKey=-1,this.mapTowerIndex=-1},e.prototype.updateAllBoxAccord=function(t){for(var e=!1,o=0;o<t.length;o++)if(t[o]!=this){var i=t[o];if(i.typeID==this.typeID&&i.level==this.level&&this.level<5){e=!0;break}}e?this.openBoxUpTips():this.closeBoxUpTips()},e.prototype.openBoxUpTips=function(){var t=this;this.tipsUpLevel.active=!0,this.tipsUpLevel.setPosition(this.tipsUpLevelInitPos),clearInterval(this.animIndexID),this.animIndexID=null;var e=this.tipsUpLevelInitPos.clone();e.y+=7,cc.Tween.stopAllByTarget(this.tipsUpLevel),cc.tween(this.tipsUpLevel).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).start(),this.animIndexID=setInterval(function(){cc.tween(t.tipsUpLevel).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).start()},1200)},e.prototype.closeBoxUpTips=function(){this.tipsUpLevel.active&&(this.tipsUpLevel.active=!1,clearInterval(this.animIndexID),this.animIndexID=null)},e.prototype.upBoxLevel=function(){this.level>=5||(this.level++,this.updateBoxPro(),h.default.Instance.playEffAnim(this.node,u.BHD_EffAnimType.boxUpLevelEff,1),p.AudioMgr.getInstance().playEffectFree(u.BHD_AudioId.shengji))},e.prototype.updateBoxPro=function(t){var e=this;void 0===t&&(t=!1);var o="roleBoxIcon/gezi_0"+this.level;this.loadSpriteFrame(u.BHD_BundleName.Sprite,o,function(t){e.levelBox.spriteFrame=t});var i="roleBoxIcon/tb_0"+this.level;if(this.loadSpriteFrame(u.BHD_BundleName.Sprite,i,function(t){e.levelIcon.spriteFrame=t}),t){var n="roleBoxIcon/tou_"+this.typeID;this.loadSpriteFrame(u.BHD_BundleName.Sprite,n,function(t){e.roleIcon.spriteFrame=t})}this.boxCfg=d.default.getInstance().getBoxProInfo(this.typeID,this.level),this.skillID=this.boxCfg.mate,this.updateRolePro(),this.isLock&&(this.lockGold=this.round(this.boxCfg.StoreCost),this.txtLockGold.string=""+this.lockGold,this.setGoldNum())},e.prototype.updateRolePro=function(){var t=h.default.Instance.roleBoxBuffAtk[this.typeID],e=0;null!=t&&(e=this.round(this.boxCfg.Atk*t));var o=h.default.Instance.roleBoxBuffAtk[9001]||0,i=h.default.Instance.roleBoxBuffAtk[9002]||0,n=h.default.Instance.roleBoxBuffAtk[9003]||0;if(this.atkForce=this.round(this.boxCfg.Atk+e),this.criticalChance=this.round2(this.boxCfg.CriticPro+i),this.criticalForce=this.round2(this.boxCfg.CriticProDamage+n),this.atkInterval=this.round2(this.boxCfg.AtkSpeed),this.bulletEffect=this.boxCfg.BulletEffect[0],this.bulletPro=this.round2(this.boxCfg.BulletEffect[1]),o>0&&(this.atkInterval=this.round2(this.atkInterval/(1+o))),null!=this.roleField){var a={typeID:this.typeID,level:this.level,atkForce:this.atkForce,criticalChance:this.criticalChance,criticalForce:this.criticalForce,bulletEffect:this.bulletEffect,bulletPro:this.bulletPro,dir:null,isSplitBullet:!1,atkInterval:this.atkInterval};this.roleField.updateRolePro(a)}},e.prototype.die=function(){null!=this.roleField&&(this.roleField.die(),this.roleField=null),this.node.destroy()},e.prototype.round2=function(t){return Math.round(100*t)/100},e.prototype.round=function(t){return Math.round(t)},c([b(cc.Sprite)],e.prototype,"levelBox",void 0),c([b(cc.Sprite)],e.prototype,"levelIcon",void 0),c([b(cc.Sprite)],e.prototype,"roleIcon",void 0),c([b(cc.Node)],e.prototype,"tipsUpLevel",void 0),c([b(cc.Node)],e.prototype,"lockRoot",void 0),c([b(cc.Label)],e.prototype,"txtLockGold",void 0),c([_],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],BHD_RoleBullet:[function(t,e,o){"use strict";cc._RF.push(e,"e8341EgWddEsbS1LZQbe8ws","BHD_RoleBullet");var i=t,n=e,a=o;cc._RF.push(n,"e8341EgWddEsbS1LZQbe8ws","BHD_RoleBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("BHD_Config"),d=i("BHD_GameMgr"),h=i("BHD_PoolMgr"),f=i("BHD_EnemyRole"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.boxCol=null,e.blastCol=null,e.fieldBullet=null,e.typeID=0,e.isDie=!1,e.moveDir=cc.v2(),e.moveSpeed=750,e.dieTime=0,e.atkForce=0,e.criticalForce=0,e.criticalChance=0,e.bulletEffect=0,e.bulletPro=1,e.atkList=[],e.lastEnemy=null,e.isSplitBullet=!1,e.isSpinBullet=!1,e.spinBulletTime=0,e.isSpinTurnto=!1,e}var o;return s(e,t),o=e,e.prototype.init=function(t){var e=this;if(this.isDie=!1,this.typeID=t.typeID,this.atkForce=t.atkForce,this.criticalChance=t.criticalChance,this.criticalForce=t.criticalForce,this.bulletEffect=t.bulletEffect,this.bulletPro=t.bulletPro,this.moveDir=t.dir,this.isSplitBullet=t.isSplitBullet,this.isSpinBullet=7==this.bulletEffect,this.isSpinTurnto=!1,this.spinBulletTime=0,10==this.typeID?this.moveSpeed=600:this.moveSpeed=750,this.atkList=[],this.lastEnemy=null,-1==this.typeID)this.fieldBullet.active=!0,this.spAnim.node.active=!1;else{this.fieldBullet.active=!1,this.spAnim.node.active=!0;var o=""+u.BHD_RoleAsePath[this.typeID].bulletPath;this.loadResFromBundle(u.BHD_BundleName.SpAnim,o,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,u.BHD_RoleAsePath[e.typeID].bulletSkill,!0)})}},e.prototype.update=function(t){d.default.Instance.isPause||this.isDie||(this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t,this.checkCollisionEnemy(),this.isSpinBullet&&(this.spinBulletTime+=t,this.spinBulletTime>.6&&(this.spinBulletTime=0,this.isSpinTurnto?this.die():(this.atkList=[],this.moveDir.x=-this.moveDir.x,this.moveDir.y=-this.moveDir.y,this.node.angle+=180),this.isSpinTurnto=!0)),this.dieTime+=t,5!=this.bulletEffect&&7!=this.bulletEffect?this.dieTime>2&&this.die():this.dieTime>8&&this.die())},e.prototype.checkCollisionEnemy=function(){var t=this,e=d.default.Instance.getCollisionBullet(this.boxCol);if(e){var i=e.getComponent(f.default);if(i.isDie)return;if(3==this.bulletEffect){p.AudioMgr.getInstance().playEffectFree(u.BHD_AudioId.baozha);var n=this.blastCol.convertToWorldSpaceAR(cc.v2(0,0));h.default.getInstance().getObj("effAnim/bulletBlast",function(t){t.setParent(d.default.Instance.roleBulletBase);var e=t.parent.convertToNodeSpaceAR(n);t.setPosition(e)});for(var a=0,r=d.default.Instance.getBlastCollisionBullet(this.blastCol);a<r.length;a++){var s=(v=r[a]).getComponent(f.default);s.isDie||s.attackEd(d.default.Instance.round(this.atkForce),!1)}this.die()}else{if(5!=this.bulletEffect){if(this.atkList.includes(e))return}else if(null!=this.lastEnemy&&this.lastEnemy==e)return;this.atkList.push(e);var c=this.atkForce,l=Math.random()<this.criticalChance;switch(l&&(c=this.atkForce*this.criticalForce),c=d.default.Instance.round(c),i.attackEd(c,l),this.bulletEffect){case 1:this.atkList.length>=this.bulletPro&&this.die();break;case 2:i.knockback(this.node,5),this.die();break;case 4:i.frozenEd(this.bulletPro),this.die();break;case 5:if(this.lastEnemy=e,this.atkList.length>=this.bulletPro)this.die();else{for(var m=null,g=0,y=I=d.default.Instance.getEnemyNear(this.node,2,2e6);g<y.length;g++){var v=y[g];if(this.lastEnemy!=v){m=v;break}}if(null!=m){var _=this.node.convertToWorldSpaceAR(cc.v2(0,0)),b=m.convertToWorldSpaceAR(cc.v2(0,0)).sub(_).normalize(),B=180*Math.atan2(b.y,b.x)/Math.PI-90;this.node.angle=B,this.moveDir=b}}break;case 9:var I;if(!this.isSplitBullet&&(this.lastEnemy=e,(I=d.default.Instance.getEnemyNear(this.node,this.bulletPro+1,2e6)).length>0)){_=this.node.convertToWorldSpaceAR(cc.v2(0,0));for(var P=this.node.convertToWorldSpaceAR(cc.v2(0,0)),C=function(e){if(I[e]==D.lastEnemy)return"continue";var i=I[e].convertToWorldSpaceAR(cc.v2(0,0)).sub(_).normalize(),n=180*Math.atan2(i.y,i.x)/Math.PI-90;h.default.getInstance().getObj("bullet/roleBullet",function(e){e.setParent(d.default.Instance.roleBulletBase);var a=e.parent.convertToNodeSpaceAR(P);e.setPosition(a),e.angle=n;var r=e.getComponent(o),s={typeID:t.typeID,level:1,atkForce:t.atkForce,criticalChance:t.criticalChance,criticalForce:t.criticalForce,bulletEffect:t.bulletEffect,bulletPro:t.bulletPro,dir:i,isSplitBullet:!0,atkInterval:0};r.init(s),r.atkList=t.atkList})},D=this,T=0;T<I.length;T++)C(T)}this.die();break;case 10:i.speedCut(this.bulletPro),this.die();break;case 7:break;default:this.die()}}}},e.prototype.die=function(){this.isDie=!0,this.moveDir=cc.v2(),this.dieTime=0,h.default.getInstance().pushObj(this.node)},c([y(sp.Skeleton)],e.prototype,"spAnim",void 0),c([y(cc.Node)],e.prototype,"boxCol",void 0),c([y(cc.Node)],e.prototype,"blastCol",void 0),c([y(cc.Node)],e.prototype,"fieldBullet",void 0),o=c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],BHD_RoleFieldAtk:[function(t,e,o){"use strict";cc._RF.push(e,"f68b56xcKVA+qZ2buIGk+px","BHD_RoleFieldAtk");var i=t,n=e,a=o;cc._RF.push(n,"f68b56xcKVA+qZ2buIGk+px","BHD_RoleFieldAtk");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("BHD_Config"),d=i("BHD_GameMgr"),h=i("BHD_PoolMgr"),f=i("BHD_RoleBullet"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkPos=null,e.isDie=!1,e.skillRole=!1,e.typeID=0,e.level=0,e.atkType=0,e.bulletStepX=15,e.bulletEffect=0,e.bulletPro=1,e.atkDis=15e4,e.atkForce=1,e.criticalChance=0,e.criticalForce=0,e.isAtkCooling=!0,e.atkInterval=1,e.atkTime=0,e.atkAnimTimeSpeed=1,e}return s(e,t),e.prototype.onLoad=function(){this.addEvent(u.BHD_EventName.SetPause,this.setPause)},e.prototype.start=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==u.BHD_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.spAnim.setAnimation(0,u.BHD_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==u.BHD_AnimName.attack&&t.attack()})},e.prototype.init=function(t){var e=this;this.typeID=t.typeID,this.level=t.level,this.atkForce=t.atkForce,this.criticalChance=t.criticalChance,this.criticalForce=t.criticalForce,this.bulletEffect=t.bulletEffect,this.bulletPro=t.bulletPro,this.atkInterval=t.atkInterval,this.isDie=!1;var o=""+u.BHD_RoleAsePath[this.typeID].path;this.loadResFromBundle(u.BHD_BundleName.SpAnim,o,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,u.BHD_AnimName.idle,!0),e.setSpAnimPlaySpeed()}),d.default.Instance.playOutRoleEff(this.node,this.node.parent.parent.parent,!0)},e.prototype.updateRolePro=function(t){this.typeID=t.typeID,this.level=t.level,this.atkForce=t.atkForce,this.criticalChance=t.criticalChance,this.criticalForce=t.criticalForce,this.bulletEffect=t.bulletEffect,this.bulletPro=t.bulletPro,this.atkInterval=t.atkInterval},e.prototype.summonSkill=function(t){var e=this;this.atkForce=t,this.isDie=!0,this.skillRole=!0,this.atkInterval=.22,this.typeID=-1,this.level=1,this.criticalChance=0,this.criticalForce=1,this.bulletPro=0,this.atkDis=1e6,this.addEvent(u.BHD_EventName.waveOver,this.dieSkillRole),this.node.scaleX=-.7,cc.tween(this.node).to(.4,{position:cc.v3(272,225)}).call(function(){e.isDie=!1}).start()},e.prototype.dieSkillRole=function(){var t=this;this.node.scaleX=.7,cc.tween(this.node).to(.4,{position:cc.v3(500,225)}).call(function(){t.die()}).start()},e.prototype.update=function(t){d.default.Instance.isPrepare||d.default.Instance.isPause||this.isDie||(this.isAtkCooling?(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.isAtkCooling=!1)):this.skillRole?(this.attack(),this.isAtkCooling=!0):this.isPlayAtkAnim())},e.prototype.isPlayAtkAnim=function(){d.default.Instance.getEnemyNear(this.node,1,this.atkDis).length>0&&(this.setDir(),p.AudioMgr.getInstance().playEffectFree(u.BHD_AudioId.attack2),this.isAtkCooling=!0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,u.BHD_AnimName.attack,!1))},e.prototype.attack=function(){switch(this.setDir(),this.bulletEffect){case 6:var t=d.default.Instance.getEnemyNear(this.node,1,this.atkDis);t.length>0&&this.shootBullets(t[0],this.bulletPro);break;case 8:this.sendBullets(this.bulletPro);break;default:this.sendBullets(1)}},e.prototype.sendBullets=function(t){var e=this,o=d.default.Instance.getEnemyNear(this.node,t,this.atkDis);if(o.length>0)for(var i=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),a=function(t){var a=t,r=o[a].convertToWorldSpaceAR(cc.v2(0,0)).sub(i).normalize(),s=180*Math.atan2(r.y,r.x)/Math.PI-90;setTimeout(function(){h.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(d.default.Instance.roleBulletBase);var o=t.parent.convertToNodeSpaceAR(n);t.setPosition(o),t.angle=s;var i={typeID:e.typeID,level:e.level,atkForce:e.atkForce,criticalChance:e.criticalChance,criticalForce:e.criticalForce,bulletEffect:e.bulletEffect,bulletPro:e.bulletPro,dir:r,isSplitBullet:!1,atkInterval:e.atkInterval};t.getComponent(f.default).init(i)})},70*a)},r=0;r<o.length;r++)a(r)},e.prototype.shootBullets=function(t,e,o){var i=this;void 0===e&&(e=3),void 0===o&&(o=10);for(var n=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),a=t.convertToWorldSpaceAR(cc.v2(0,0)).sub(n).normalize(),r=180*Math.atan2(a.y,a.x)/Math.PI-90,s=Math.floor(e/2),c=function(t){var e=r+(t-s)*o,n=(e+90)*Math.PI/180,a=cc.v2(Math.cos(n),Math.sin(n)).normalize();h.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(d.default.Instance.roleBulletBase);var o=i.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=t.parent.convertToNodeSpaceAR(o);t.setPosition(n),t.angle=e;var r={typeID:i.typeID,level:i.level,atkForce:i.atkForce,criticalChance:i.criticalChance,criticalForce:i.criticalForce,bulletEffect:i.bulletEffect,bulletPro:i.bulletPro,dir:a,isSplitBullet:!1,atkInterval:i.atkInterval};t.getComponent(f.default).init(r)})},l=0;l<e;l++)c(l)},e.prototype.setDir=function(){if(!this.skillRole){var t=d.default.Instance.getEnemyNear(this.node,1,this.atkDis);if(t.length>0){var e=t[0].convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.parent.convertToNodeSpaceAR(e);this.node.x>o.x?this.node.scaleX=-1:this.node.x<o.x&&(this.node.scaleX=1)}}},e.prototype.setTowerActive=function(t){var e=this;if(t){this.spAnim.skeletonData=null;var o=""+u.BHD_RoleAsePath[this.typeID].path;this.loadResFromBundle(u.BHD_BundleName.SpAnim,o,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,u.BHD_AnimName.idle,!0)})}},e.prototype.isSkeletonData=function(){var t=this,e=""+u.BHD_RoleAsePath[this.typeID].path;this.loadResFromBundle(u.BHD_BundleName.SpAnim,e,sp.SkeletonData,function(e){t.spAnim.skeletonData=null,t.spAnim.skeletonData=e,t.spAnim.setAnimation(0,u.BHD_AnimName.idle,!0)})},e.prototype.die=function(){this.isDie||(this.isDie=!0,this.skillRole||d.default.Instance.playOutRoleEff(this.node,this.node.parent.parent.parent,!1),this.node.setParent(null),this.node.destroy())},e.prototype.setPause=function(t){this.isDie||(this.spAnim.paused=t)},e.prototype.setSpAnimPlaySpeed=function(){var t=this.spAnim.findAnimation(u.BHD_AnimName.attack).duration;this.atkInterval<t&&(this.atkAnimTimeSpeed=t/this.atkInterval*1.05)},c([y(sp.Skeleton)],e.prototype,"spAnim",void 0),c([y(cc.Node)],e.prototype,"atkPos",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],BHD_RoleMateTips:[function(t,e,o){"use strict";cc._RF.push(e,"0f109IqAuVFO6InrNMBrQA9","BHD_RoleMateTips");var i=t,n=e,a=o;cc._RF.push(n,"0f109IqAuVFO6InrNMBrQA9","BHD_RoleMateTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BHD_Config"),u=i("BHD_PoolMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtTips=null,e.weaponIcon1=null,e.weaponIcon2=null,e.mateCfg={7:{role:[6,10],name:"\u5929\u9f99\u516b\u90e8"},8:{role:[3,11],name:"\u5c18\u5916\u53cc\u6e05"},9:{role:[1,7],name:"\u5251\u80c6\u7434\u5fc3"},10:{role:[4,5],name:"\u4e09\u987e\u8305\u5e90"},11:{role:[8,17],name:"\u667a\u52c7\u53cc\u5168"}},e}return s(e,t),e.prototype.init=function(t){var e=this,o=this.mateCfg[t];if(null!=o){this.node.active=!0,cc.Tween.stopAllByTarget(this.node),this.node.opacity=0,cc.tween(this.node).to(.2,{opacity:255}).start();var i="roleBoxIcon/tou_"+o.role[0];this.loadSpriteFrame(p.BHD_BundleName.Sprite,i,function(t){e.weaponIcon1.spriteFrame=t}),this.weaponIcon2.node.parent.active=!0;var n="roleBoxIcon/tou_"+o.role[1];this.loadSpriteFrame(p.BHD_BundleName.Sprite,n,function(t){e.weaponIcon2.spriteFrame=t});var a="";switch(t){case 7:a="<b><outline color=black width=4>\u4e54\u5e2e\u4e3b&\u900d\u9065\u50e7\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 8:a="<b><outline color=black width=4>\u5ae6\u5a25&\u516b\u6212\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 9:a="<b><outline color=black width=4>\u609f\u7a7a&\u7d2b\u971e\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 10:a="<b><outline color=black width=4>\u5218\u5907&\u8bf8\u845b\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 11:a="<b><outline color=black width=4>\u5173\u7fbd&\u5b59\u5c1a\u9999\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>"}this.txtTips.string=a}else this.node.active=!1,console.error(t+" ID\uff0c\u914d\u7f6e\u4e3a\u7a7a\uff0c\u5173\u95ed\u7f81\u7eca\u63d0\u793a"),cc.Tween.stopAllByTarget(this.node),u.default.getInstance().pushObj(this.node)},e.prototype.die=function(){var t=this;this.node.active&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.active=!1}).start())},c([f(cc.RichText)],e.prototype,"txtTips",void 0),c([f(cc.Sprite)],e.prototype,"weaponIcon1",void 0),c([f(cc.Sprite)],e.prototype,"weaponIcon2",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BHD_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"79b394JvShMI4yk1pe9WOqq","BHD_Skills");var i=t,n=e,a=o;cc._RF.push(n,"79b394JvShMI4yk1pe9WOqq","BHD_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BHD_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkForce=0,e.skillID=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==p.BHD_AnimName.animation&&t.die()}),this.spAnim.setEventListener(function(e,o){switch(o.data.name){case p.BHD_AnimName.attack:case"hit":t.sendEvent(p.BHD_EventName.rolePlaySkill,t.skillID,t.atkForce)}}),this.addEvent(p.BHD_EventName.SetPause,this.setGameState)},e.prototype.init=function(t,e){var o=this;this.atkForce=t,this.skillID=e,this.spAnim.setAnimation(0,p.BHD_AnimName.animation,!1),6==this.skillID&&setTimeout(function(){o.sendEvent(p.BHD_EventName.rolePlaySkill,o.skillID,o.atkForce)},300)},e.prototype.setGameState=function(t){this.spAnim.paused=t},e.prototype.die=function(){this.node.destroy()},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_TowerDefense:[function(t,e,o){"use strict";cc._RF.push(e,"32f4ctb5ttOJIvlAX0e0YUR","BHD_TowerDefense");var i=t,n=e,a=o;cc._RF.push(n,"32f4ctb5ttOJIvlAX0e0YUR","BHD_TowerDefense");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("AudioMgr"),d=i("BHD_Config"),h=i("BHD_DataMgr"),f=i("BHD_GameEnumData"),m=i("BHD_GameMgr"),g=i("BHD_RoleBox"),y=cc._decorator,v=y.ccclass,_=y.property;!function(t){t.explosion="explosion",t.idle2="idle2",t.repair="repair"}(l||(l={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.towerSpr=null,e.towerRoleBox=null,e.hpBar=null,e.boxCol=null,e.btnEasterTower=null,e.txtEasterGold=null,e.spAnim=null,e.goldPos=null,e.isDie=!1,e.basicsHp=0,e.maxHp=10,e.nowHp=0,e.isGainBackAtk=!1,e.lastHpBar=0,e.color_Red=cc.color().fromHEX("#ff4a4a"),e}return s(e,t),e.prototype.start=function(){var t=this;this.spAnim.setCompleteListener(function(e){if(e.animation.name==l.explosion)t.spAnim.setAnimation(0,l.idle2,!0);else if(e.animation.name==l.repair){t.towerSpr.enabled=!0,t.towerRoleBox.active=!0,t.nowHp=t.maxHp,t.hpBar.progress=1,t.setTowerSp(),t.setThisRoleBox(!0);for(var o=0,i=t.node.children;o<i.length;o++)i[o].active=!0;t.btnEasterTower.active=!1,t.spAnim.node.active=!1}}),this.btnEasterTower.on(cc.Node.EventType.TOUCH_END,this.easterTower,this),this.basicsHp=h.default.getInstance().getParameterCfg(f.BHD_enumGearParameterCfg.StarHeathy),this.maxHp=this.basicsHp,this.nowHp=this.maxHp,this.addEvent(d.BHD_EventName.GainTowerBackAtk,this.gainTowerBackAtk),this.addEvent(d.BHD_EventName.TowerAddMaxHp,this.towerAddMaxHp),this.addEvent(d.BHD_EventName.SetGoldNum,this.setTxtEasterGold),this.addEvent(d.BHD_EventName.waveOver,this.waveOver),this.addEvent(d.BHD_EventName.PlayGame,this.playGame)},e.prototype.gainTowerBackAtk=function(){var t=this;this.isGainBackAtk||(this.isGainBackAtk=!0,this.loadSpriteFrame(d.BHD_BundleName.Sprite,"tower/taAtk1",function(e){t.towerSpr.spriteFrame=e}),this.loadResFromBundle(d.BHD_BundleName.SpAnim,"hdfx_ta2/hdfx_ta2",sp.SkeletonData,function(e){t.spAnim.skeletonData=e,t.isDie&&(t.spAnim.node.active=!0,t.spAnim.setAnimation(0,l.idle2,!0))}))},e.prototype.attackEd=function(t){m.default.Instance.isPause||this.isDie||(this.nowHp-=t,this.nowHp<=0?(this.die(),u.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.tabaozha)):(this.updeteHpBar(),u.AudioMgr.getInstance().playEffectFree(d.BHD_AudioId.tashouji)),this.setTowerSp())},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.setTowerSp=function(){var t=this,e=this.nowHp/this.maxHp,o=!1;e>=.5?1!=this.lastHpBar&&(this.lastHpBar=1,o=!0):e<.5&&e>.01?2!=this.lastHpBar&&(this.lastHpBar=2,o=!0):3!=this.lastHpBar&&(this.lastHpBar=3,o=!0);var i=this.isGainBackAtk?"taAtk":"ta";if(o){var n="tower/"+i+this.lastHpBar;this.loadSpriteFrame(d.BHD_BundleName.Sprite,n,function(e){t.towerSpr.spriteFrame=e})}},e.prototype.towerAddMaxHp=function(t){t=m.default.Instance.round2(t);var e=this.nowHp/this.maxHp;this.maxHp=m.default.Instance.round(this.basicsHp*(t+1)),this.nowHp=m.default.Instance.round(this.maxHp*e)},e.prototype.setTxtEasterGold=function(){if(this.isDie){var t=m.default.Instance.getEasterTowerGold(),e=m.default.Instance.goldNum>=t;this.txtEasterGold.node.color=e?cc.Color.WHITE:this.color_Red,this.txtEasterGold.string=""+t}},e.prototype.setThisRoleBox=function(t){for(var e=0,o=this.towerRoleBox.children;e<o.length;e++){var i=o[e];i.childrenCount>0&&i.children[0].getComponent(g.default).setTowerActive(t)}},e.prototype.roleIsSkeletonData=function(){if(!this.isDie)for(var t=0,e=this.towerRoleBox.children;t<e.length;t++){var o=e[t];o.childrenCount>0&&o.children[0].getComponent(g.default).roleField.isSkeletonData()}},e.prototype.easterTower=function(){if(this.isDie){var t=m.default.Instance.getEasterTowerGold();m.default.Instance.isGoldEnough(t)?(m.default.Instance.easterTowerNum++,m.default.Instance.setGoldNum(-t),this.isDie=!1,this.btnEasterTower.active=!1,this.spAnim.setAnimation(0,l.repair,!1)):m.default.Instance.upTipsBox("\u91d1\u5e01\u4e0d\u8db3")}},e.prototype.waveOver=function(){this.isDie?this.btnEasterTower.active=!0:m.default.Instance.playTowerGoldAnim(this.goldPos),this.roleIsSkeletonData()},e.prototype.playGame=function(){this.btnEasterTower.active&&(this.btnEasterTower.active=!1),this.roleIsSkeletonData()},e.prototype.die=function(){if(!this.isDie){this.isDie=!0,this.hpBar.progress=0,this.towerRoleBox.active=!1;for(var t=0,e=this.node.children;t<e.length;t++)e[t].active=!1;this.towerSpr.enabled=!1,this.spAnim.node.active=!0,this.spAnim.setAnimation(0,l.explosion,!1),this.setThisRoleBox(!1),m.default.Instance.isGameOver()}},c([_(cc.Sprite)],e.prototype,"towerSpr",void 0),c([_(cc.Node)],e.prototype,"towerRoleBox",void 0),c([_(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([_(cc.Node)],e.prototype,"boxCol",void 0),c([_(cc.Node)],e.prototype,"btnEasterTower",void 0),c([_(cc.Label)],e.prototype,"txtEasterGold",void 0),c([_(sp.Skeleton)],e.prototype,"spAnim",void 0),c([_(cc.Node)],e.prototype,"goldPos",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BHD_TowerGoldAnim:[function(t,e,o){"use strict";cc._RF.push(e,"89427RqeXRN+J1QabMi3MAG","BHD_TowerGoldAnim");var i=t,n=e,a=o;cc._RF.push(n,"89427RqeXRN+J1QabMi3MAG","BHD_TowerGoldAnim");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BHD_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e}return s(e,t),e.prototype.init=function(t){var e=this;t=Math.round(t),cc.Tween.stopAllByTarget(this.node),this.node.scale=0;var o=this.node.position.clone();o.y+=100,cc.tween(this.node).to(.2,{scale:1}).to(2,{position:o}).to(.2,{scale:0}).call(function(){p.default.getInstance().pushObj(e.node)}).start(),this.txt.string=""+t},c([h(cc.Label)],e.prototype,"txt",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_UIBuffPro:[function(t,e,o){"use strict";cc._RF.push(e,"bd372IQU5FIzrccdtjpeo0B","BHD_UIBuffPro");var i=t,n=e,a=o;cc._RF.push(n,"bd372IQU5FIzrccdtjpeo0B","BHD_UIBuffPro");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BHD_Config"),u=i("BHD_DataMgr"),d=i("BHD_GameMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.itemBuffInfo=null,e.itemBase=null,e.noTips=null,e.roleBuff={},e}return s(e,t),e.prototype.start=function(){for(var t=this,e=!0,o=0,i=Object.entries(JSON.parse(JSON.stringify(d.default.Instance.roleBoxBuffAtk)));o<i.length;o++){var n=i[o],a=n[0],r=n[1],s=Number(a);e=!1;var c=Math.floor(100*r),l=0,h=0,f=0,m=0;l=Math.floor(100*u.default.getInstance().getBuffCfg(s,1).buffParametric),h=Math.floor(100*u.default.getInstance().getBuffCfg(s,2).buffParametric),f=Math.floor(100*u.default.getInstance().getBuffCfg(s,3).buffParametric),m=Math.floor(100*u.default.getInstance().getBuffCfg(s,4).buffParametric),9005==s&&(c=Math.floor(c/100),l=Math.floor(l/100),h=Math.floor(h/100),f=Math.floor(f/100),m=Math.floor(m/100));var g=1;c<=l?g=1:c>l&&c<=h?g=2:c>h&&c<=f?g=3:c>f&&c<=m?g=4:c>m&&(g=5),this.roleBuff[s]={value:c,level:g}}if(!e){(g=Object.entries(this.roleBuff)).sort(function(t,e){return e[1].level-t[1].level});for(var y=function(t,e){var o=Number(t),i=v.round2(e.value),n="#5bfe1b";switch(e.level){case 1:n="#5bfe1b";break;case 2:n="#1bc1fe";break;case 3:n="#e11bfe";break;case 4:n="#ffdb14";break;case 5:n="#ff2371"}var a="";switch(o){case 1:a="<b><outline color=black width=4>\u609f\u7a7a\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 3:a="<b><outline color=black width=4>\u5ae6\u5a25\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 4:a="<b><outline color=black width=4>\u5218\u5907\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 5:a="<b><outline color=black width=4>\u8bf8\u845b\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 6:a="<b><outline color=black width=4>\u4e54\u5e2e\u4e3b\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 7:a="<b><outline color=black width=4>\u7d2b\u971e\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 8:a="<b><outline color=black width=4>\u5173\u7fbd\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 10:a="<b><outline color=black width=4>\u900d\u9065\u50e7\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 11:a="<b><outline color=black width=4>\u516b\u6212\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 17:a="<b><outline color=black width=4>\u5b59\u5c1a\u9999\uff0c\u653b\u51fb\u529b\u52a0<color="+n+">+"+i+"%</color></outline></b>";break;case 9001:a="<b><outline color=black width=4>\u5168\u4f53\u653b\u901f\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9002:a="<b><outline color=black width=4>\u5168\u4f53\u66b4\u51fb\u7387\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9003:a="<b><outline color=black width=4>\u5168\u4f53\u66b4\u51fb\u4f24\u5bb3\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9004:a="<b><outline color=black width=4>\u9632\u5fa1\u5854\u8840\u91cf\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9005:a="<b><outline color=black width=4>\u9632\u5fa1\u5854\u53cd\u5f39<color="+n+">"+i+"</color>\u70b9\u4f24\u5bb3</outline></b>"}var r=cc.instantiate(v.itemBuffInfo);r.active=!0,r.setParent(v.itemBase),r.getChildByName("proInfo").getComponent(cc.RichText).string=a;var s="roleIcon/tou_"+o;v.loadSpriteFrame(p.BHD_BundleName.Sprite,s,function(t){r.getChildByName("roleIcon").getComponent(cc.Sprite).spriteFrame=t})},v=this,_=0,b=g;_<b.length;_++){var B=b[_];y(a=B[0],B[1])}}this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),d.default.Instance.setPause(!1)},this),this.noTips.active=e},e.prototype.round2=function(t){return Math.round(100*t)/100},c([m(cc.Node)],e.prototype,"btnClose",void 0),c([m(cc.Node)],e.prototype,"itemBuffInfo",void 0),c([m(cc.Node)],e.prototype,"itemBase",void 0),c([m(cc.Node)],e.prototype,"noTips",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BHD_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"22da6+5ouFPnocBxBKACP5N","BHD_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"22da6+5ouFPnocBxBKACP5N","BHD_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BHD_GameMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.timeSpeed=null,e.txtTimeSpeed=null,e.isTimeSpeed=!0,e.upRoleBox=null,e.openBuffUI=null,e}return s(e,t),e.prototype.start=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.timeSpeed.on(cc.Node.EventType.TOUCH_END,function(){t.isTimeSpeed=!t.isTimeSpeed;var e=t.isTimeSpeed?1:2.5;t.txtTimeSpeed.string="\u500d\u901f\uff1a"+e},this),this.upRoleBox.on(cc.Node.EventType.TOUCH_END,function(){p.default.Instance.setGoldNum(100)},this),this.openBuffUI.on(cc.Node.EventType.TOUCH_END,function(){p.default.Instance.dropLevel++,p.default.Instance.dropLevel>4&&(p.default.Instance.dropLevel=1),p.default.Instance.openBuffBox(!0)},this)},c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"timeSpeed",void 0),c([h(cc.Label)],e.prototype,"txtTimeSpeed",void 0),c([h(cc.Node)],e.prototype,"upRoleBox",void 0),c([h(cc.Node)],e.prototype,"openBuffUI",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"391ceNI14dISZ+mGHqup2zo","BHD_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"391ceNI14dISZ+mGHqup2zo","BHD_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BHD_APP"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.win=null,e.fail=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this),this.win.active=this.isWin,this.fail.active=!this.isWin},c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"win",void 0),c([h(cc.Node)],e.prototype,"fail",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BHD_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"5a9abWxnRpAjYuUPN13Rwad","BHD_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"5a9abWxnRpAjYuUPN13Rwad","BHD_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("SdkMgr"),h=i("BHD_Config"),f=i("BHD_DataMgr"),m=i("BHD_GameMgr"),g=i("BHD_Btn_Skills"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lockTips=null,e.btnPause=null,e.btnShowBuffPro=null,e.skillBtnsBase=null,e.btn_Skills=null,e.skillTips=null,e.upTips=null,e.activateSkills=[],e}return s(e,t),e.prototype.start=function(){var t=this;(d.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR)&&this.lockTips.on(cc.Node.EventType.TOUCH_END,function(){m.default.Instance.setGoldNum(100)},this),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){m.default.Instance.setPause(!0),t.openUI(h.BHD_UIID.BHD_UIPause)},this),this.btnShowBuffPro.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.BHD_UIID.BHD_UIBuffPro)}),this.addEvent(h.BHD_EventName.upTipsBox,this.upTipsBox),this.addEvent(h.BHD_EventName.ActivateSkills,this.onRoleSkillAdded)},e.prototype.onRoleSkillAdded=function(t,e){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(null==this.activateSkills[n]){var a=cc.instantiate(this.btn_Skills);a.setParent(this.skillBtnsBase),a.active=!0,this.activateSkills[n]=a.getComponent(g.default),this.activateSkills[n].init(n,e[n]),this.playAddSkillTips(n)}else this.activateSkills[n].isDie=!1,this.activateSkills[n].node.active=!0,this.activateSkills[n].updateLevel(e[n])}for(var r=[],s=0,c=Object.entries(this.activateSkills);s<c.length;s++){var l=c[s],p=l[0],u=(l[1],Number(p));t.includes(u)||r.push(u)}for(var d=0,h=r;d<h.length;d++)n=h[d],this.activateSkills[n].isDie=!0,this.activateSkills[n].node.active=!1},e.prototype.playAddSkillTips=function(t){var e=cc.instantiate(this.skillTips);e.setParent(this.skillTips.parent),e.active=!0,e.getChildByName("tipsName").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).mateName,e.getChildByName("info").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).introduce;var o="skillsBtnIcon/"+f.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(h.BHD_BundleName.Sprite,o,function(t){e.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),e.setPosition(0,400),e.setScale(0);var i=e.position.clone();i.y+=300,cc.tween(e).to(.2,{scale:1}).to(2,{}).to(.4,{position:i}).call(function(){e.destroy()}).start()},e.prototype.upTipsBox=function(t){var e=32*t.length+30,o=cc.instantiate(this.upTips);o.setParent(this.upTips.parent),o.active=!0,o.width=e,o.getChildByName("txtTips").getComponent(cc.Label).string=t,o.scale=0;var i=o.position.clone();i.y+=300,cc.tween(o).to(.2,{scale:1}).to(1.2,{scale:1}).to(.5,{position:i,opacity:.3}).call(function(){o.destroy()}).start()},c([_(cc.Node)],e.prototype,"lockTips",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"btnShowBuffPro",void 0),c([_(cc.Node)],e.prototype,"skillBtnsBase",void 0),c([_(cc.Node)],e.prototype,"btn_Skills",void 0),c([_(cc.Node)],e.prototype,"skillTips",void 0),c([_(cc.Node)],e.prototype,"upTips",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BHD_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"03740VYpIlFYIjOQqoCMZ/6","BHD_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"03740VYpIlFYIjOQqoCMZ/6","BHD_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BHD_APP"),u=i("BHD_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.setPause(!1),t.closeUI()},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0),t.closeUI()},this)},c([f(cc.Node)],e.prototype,"btnResume",void 0),c([f(cc.Node)],e.prototype,"btnClose",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BHD_UISelectBuff:[function(t,e,o){"use strict";cc._RF.push(e,"a631dW2G79M9IriG/xSKBg6","BHD_UISelectBuff");var i=t,n=e,a=o;cc._RF.push(n,"a631dW2G79M9IriG/xSKBg6","BHD_UISelectBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BHD_Config"),u=i("BHD_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.itemBuff=null,e.btnClose=null,e.randomBuffs=[],e.isSelected=!1,e}return s(e,t),e.prototype.init=function(t){this.randomBuffs=t},e.prototype.start=function(){this.isSelected=!1,this.showBuffSelection()},e.prototype.showBuffSelection=function(){for(var t=this,e=!0,o=function(o){4==o.buffQuality&&(e=!1);var n=cc.instantiate(i.itemBuff);n.setParent(i.itemBase),n.active=!0,n.on(cc.Node.EventType.TOUCH_END,function(){t.onBuffSelected(o.ID,o.buffParametric)},i),n.getChildByName("buffName").getComponent(cc.Label).string=o.buffName,n.getChildByName("buffInfo").getComponent(cc.RichText).string=o.buffCopy1;var a,r=n.getChildByName("buffIcon");a="roleIcon/tou_"+o.ID,r.setScale(.87),i.loadSpriteFrame(p.BHD_BundleName.Sprite,a,function(t){r.getComponent(cc.Sprite).spriteFrame=t});var s="buffBG/buffLevel"+o.buffQuality;i.loadSpriteFrame(p.BHD_BundleName.Sprite,s,function(t){n.getComponent(cc.Sprite).spriteFrame=t})},i=this,n=0,a=this.randomBuffs;n<a.length;n++)o(a[n]);this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),u.default.Instance.setPause(!1)},this),this.btnClose.active=e},e.prototype.onBuffSelected=function(t,e){this.isSelected||(this.isSelected=!0,u.default.Instance.selectBuff(t,e),u.default.Instance.onBuffSelected(t),u.default.Instance.openBuffBox(),this.closeUI(),u.default.Instance.setPause(!1))},c([f(cc.Node)],e.prototype,"itemBase",void 0),c([f(cc.Node)],e.prototype,"itemBuff",void 0),c([f(cc.Node)],e.prototype,"btnClose",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BKT_APP:[function(t,e,o){"use strict";cc._RF.push(e,"23aad/5XvZEiYIxsmBWRlW1","BKT_APP");var i=t,n=e,a=o;cc._RF.push(n,"23aad/5XvZEiYIxsmBWRlW1","BKT_APP");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("AudioMgr"),l=i("UIMgr"),p=i("BKT_PoolMgr"),u=i("BKT_Config"),d=i("BKT_DataMgr"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isInited=!1,e._exitCall=null,e}return s(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!0,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,this._exitCall=e,c.AudioMgr.getInstance().pauseAllMusic();var n=function(){i._isInited=!0,l.UIMgr.getInstance().openUIOfCallback(u.BKT_UIID.BKT_UIGame,u.BKT_UIID.BKT_UIGame,function(){t&&t()})};this._isInited?n():(l.UIMgr.getInstance().addUICnf(u.BKT_UICF),c.AudioMgr.getInstance().addAdConf(u.BKT_Audio),d.default.getInstance().loadCfg(function(){n()}))},e.prototype.exit_App=function(t){void 0===t&&(t=0),cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!1,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,cc.systemEvent.clear(),l.UIMgr.getInstance().closeById(u.BKT_UIID.BKT_UIGame),l.UIMgr.getInstance().closeById(u.BKT_UIID.BKT_UIPause),l.UIMgr.getInstance().closeById(u.BKT_UIID.BKT_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,p.default.getInstance().clear()},e._instance=null,e}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],BKT_Btn_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"9ef0aEyX8BPdYBxRnlmeQSR","BKT_Btn_Skills");var i=t,n=e,a=o;cc._RF.push(n,"9ef0aEyX8BPdYBxRnlmeQSR","BKT_Btn_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("BKT_Config"),d=i("BKT_DataMgr"),h=i("BKT_GameManager"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skillName=null,e.lockMack=null,e.skillIcon=null,e.isDie=!1,e.skillID=0,e.level=0,e.isSkillLock=!1,e.skillInterval=0,e.skillTime=0,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.skillID=t,this.lockMack.node.active=!1,this.skillName.string=d.default.getInstance().getSkillsCfg(t).introduce,this.skillInterval=d.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime=this.skillInterval,this.updateLevel(e),this.node.on(cc.Node.EventType.TOUCH_END,this.playSkill,this),this.node.setScale(0);var i="skillsBtnIcon/"+d.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(u.BKT_BundleName.Sprite,i,function(t){o.skillIcon.spriteFrame=t,cc.tween(o.node).to(.2,{scale:1}).start()})},e.prototype.update=function(t){h.default.Instance.gameState!=u.BKT_GameState.pause&&h.default.Instance.isfight&&(this.isDie||this.isSkillLock&&(this.skillTime-=t,this.lockMack.progress=this.skillTime/this.skillInterval,this.skillTime<0&&(this.isSkillLock=!1,this.lockMack.node.active=!1)))},e.prototype.updateLevel=function(t){var e=this;if(this.level!=t){this.level=t;var o="skillsBtnIcon/kuang_0"+this.level;this.loadSpriteFrame(u.BKT_BundleName.Sprite,o,function(t){e.node.getComponent(cc.Sprite).spriteFrame=t})}},e.prototype.playSkill=function(){if(h.default.Instance.isfight&&!this.isSkillLock){switch(this.lockMack.node.active=!0,this.lockMack.progress=1,this.isSkillLock=!0,this.skillTime=this.skillInterval,this.skillID){case 1:case 2:case 3:case 4:case 6:case 8:case 9:case 10:case 11:h.default.Instance.playSkillsAtk(this.skillID);break;case 5:this.sendEvent(u.BKT_EventName.SkillsAtkDouble);break;case 7:h.default.Instance.playSkillsRole(this.skillID)}p.AudioMgr.getInstance().playEffectFree(d.default.getInstance().getSkillsCfg(this.skillID).mateSound),this.sendEvent(u.BKT_EventName.PlaySkillBanner,this.skillID)}},c([g(cc.Label)],e.prototype,"skillName",void 0),c([g(cc.ProgressBar)],e.prototype,"lockMack",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BKT_Config:[function(t,e,o){"use strict";cc._RF.push(e,"6650c7xuadLOKZs5aDC2xbX","BKT_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"6650c7xuadLOKZs5aDC2xbX","BKT_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.BKT_RoleAsePath=l.BKT_RoleType=l.BKT_GameState=l.BKT_MoveRoleState=l.BKT_AnimName=l.BKT_EventName=l.BKT_Audio=l.BKT_AudioId=l.BKT_UICF=l.BKT_UIID=l.BKT_BundleName=void 0,function(t){t.Prefabs="BKT_Prefabs",t.Sprite="BKT_Sprite",t.Audio="BKT_Audio",t.SpAnim="BKT_SpAnim"}(a=l.BKT_BundleName||(l.BKT_BundleName={})),function(t){t.BKT_UIGame="BKT_UIGame",t.BKT_UIGM="BKT_UIGM",t.BKT_UIPause="BKT_UIPause",t.BKT_UIGameOver="BKT_UIGameOver"}(r=l.BKT_UIID||(l.BKT_UIID={})),l.BKT_UICF=((i={})[r.BKT_UIGame]={prefab:"ui/BKT_UIGame",name:"BKT_UIGame",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.BKT_UIGM]={prefab:"ui/BKT_UIGM",name:"BKT_UIGM",showTop:!0,showMult:!1,zIndex:1002,bundleName:a.Prefabs},i[r.BKT_UIPause]={prefab:"ui/BKT_UIPause",name:"BKT_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.BKT_UIGameOver]={prefab:"ui/BKT_UIGameOver",name:"BKT_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i),function(t){t.dragonHit="dragonHit",t.gongji="gongji",t.shibai="shibai",t.shengji="shengji",t.shitou="shitou",t.kaishi="kaishi",t.fangrugezi="fangrugezi",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.moonGod="moonGod",t.boom="boom",t.summon="summon",t.cwsq="cwsq",t.jdqx="jdqx",t.sgml="sgml",t.zysq="zysq"}(s=l.BKT_AudioId||(l.BKT_AudioId={})),l.BKT_Audio=((n={})[s.dragonHit]={path:s.dragonHit,bundle:a.Audio},n[s.gongji]={path:s.gongji,bundle:a.Audio},n[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.shengji]={path:s.shengji,bundle:a.Audio},n[s.shitou]={path:s.shitou,bundle:a.Audio},n[s.kaishi]={path:s.kaishi,bundle:a.Audio},n[s.fangrugezi]={path:s.fangrugezi,bundle:a.Audio},n[s.lotus]={path:s.lotus,bundle:a.Audio},n[s.goldGod]={path:s.goldGod,bundle:a.Audio},n[s.classic]={path:s.classic,bundle:a.Audio},n[s.swordHit]={path:s.swordHit,bundle:a.Audio},n[s.moonGod]={path:s.moonGod,bundle:a.Audio},n[s.boom]={path:s.boom,bundle:a.Audio},n[s.summon]={path:s.summon,bundle:a.Audio},n[s.cwsq]={path:s.cwsq,bundle:a.Audio},n[s.jdqx]={path:s.jdqx,bundle:a.Audio},n[s.sgml]={path:s.sgml,bundle:a.Audio},n[s.zysq]={path:s.zysq,bundle:a.Audio},n),function(t){t.SetGameState="BTK_SetGameState",t.UpdateWaveUI="BTK_UpdateWaveUI",t.UpdateWaveBarUI="BTK_UpdateWaveBarUI",t.PlaySkillsAtk="BTK_PlaySkillsAtk",t.SkillsAtkDouble="BTK_SkillsAtkDouble",t.WaveOver="BTK_WaveOver",t.ActivateSkills="BTK_ActivateSkills",t.ActivateRoleSkills="BTK_ActivateRoleSkills",t.PlaySkillBanner="BTK_PlaySkillBanner",t.PlayStoneAtkEnAnim="BTK_PlayStoneAtkEnAnim",t.PlayGame="BTK_PlayGame",t.BoxTouchState="BTK_BoxTouchState",t.UpdateAllBoxAccord="BTK_UpdateAllBoxAccord",t.PlayTips="BTK_PlayTips"}(l.BKT_EventName||(l.BKT_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="move",t.animation="animation"}(l.BKT_AnimName||(l.BKT_AnimName={})),function(t){t[t.TouchStart=0]="TouchStart",t[t.TouchMove=1]="TouchMove",t[t.TouchEnd=2]="TouchEnd"}(l.BKT_MoveRoleState||(l.BKT_MoveRoleState={})),function(t){t[t.playing=0]="playing",t[t.pause=1]="pause"}(l.BKT_GameState||(l.BKT_GameState={})),function(t){t[t._Null=0]="_Null",t[t.Role_1=1]="Role_1",t[t.Role_3=3]="Role_3",t[t.Role_4=4]="Role_4",t[t.Role_5=5]="Role_5",t[t.Role_6=6]="Role_6",t[t.Role_7=7]="Role_7",t[t.Role_8=8]="Role_8",t[t.Role_10=10]="Role_10",t[t.Role_11=11]="Role_11",t[t.Role_17=17]="Role_17"}(l.BKT_RoleType||(l.BKT_RoleType={})),l.BKT_RoleAsePath={1:{path:"soilder_3/soilder_3",ID:1,bullet:"hero1_bullet1"},3:{path:"djdh_3/djdh_3",ID:3,bullet:"hero3_bullet1"},4:{path:"djdh_4/djdh_4",ID:4,bullet:"hero4_bullet1"},5:{path:"djdh_5/djdh_5",ID:5,bullet:"hero16_bullet1"},6:{path:"djdh_6/djdh_6",ID:6,bullet:"hero6_bullet1"},7:{path:"soilder_4/soilder_4",ID:7,bullet:"hero7_bullet1"},8:{path:"djdh_8/djdh_8",ID:8,bullet:"hero8_bullet1"},10:{path:"djdh_10/djdh_10",ID:10,bullet:"hero6_bullet1"},11:{path:"soilder_1/soilder_1",ID:11,bullet:"hero11_bullet1"},17:{path:"djdh_17/djdh_17",ID:17,bullet:"hero17_bullet1"}},cc._RF.pop(),cc._RF.pop()},{}],BKT_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"d54ea37i41E+aWdjAM2Cteb","BKT_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"d54ea37i41E+aWdjAM2Cteb","BKT_DataMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.getData=function(){return this.data},t.prototype.loadCfg=function(t){var e=this;r.ResourceMgr.getInstance().loadRes("BKT_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getCfgByPrimaryKey2=function(t,e,o,i,n){if(t)for(var a=0;a<t.length;a++)if(t[a][i]==e&&t[a][n]==o)return t[a];return null},t.prototype.getParameterCfg=function(t){return this.data.GearParameterCfg[t].value},t.prototype.getEnemyInfo=function(t){return this.getCfgByPrimaryKey(this.data.HealthyCfg,t,"level")},t.prototype.getRoleInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.CharacterNum,t,e,"level","CharacterID")},t.prototype.getSkillsCfg=function(t){return this.getCfgByPrimaryKey(this.data.mateCfg,t,"mateID")},t.prototype.getEnemyExp=function(t){return this.getCfgByPrimaryKey(this.data.monsterID,t,"ID")},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],BKT_EffDie:[function(t,e,o){"use strict";cc._RF.push(e,"04425EJssZMF7veaBODoygK","BKT_EffDie");var i=t,n=e,a=o;cc._RF.push(n,"04425EJssZMF7veaBODoygK","BKT_EffDie");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BKT_Config"),p=i("BKT_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==l.BKT_AnimName.animation&&p.default.getInstance().PushObj(t.node)})},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BKT_Enemy:[function(t,e,o){"use strict";cc._RF.push(e,"4f1f5b1hG9AZKmgwITmtT5e","BKT_Enemy");var i=t,n=e,a=o;cc._RF.push(n,"4f1f5b1hG9AZKmgwITmtT5e","BKT_Enemy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("AudioMgr"),u=i("BKT_Config"),d=i("BKT_DataMgr"),h=i("BKT_GameEnumData"),f=i("BKT_GameManager"),m=i("BKT_PoolMgr"),g=i("BKT_RoleBase"),y=cc._decorator,v=y.ccclass,_=y.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.die=2]="die"}(l||(l={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemyType=0,e.hpBG=null,e.hpBar=null,e.boxCol=null,e.towerCol=null,e.enemyState=null,e.isDie=!1,e.moveSpeed=40,e.moveSpeedPro=100,e.maxHp=10,e.nowHp=0,e.exp=0,e.immune=!1,e.immuneTime=0,e.isSkillsStasis=!1,e.skillsStasisTime=0,e.speedY={speed:10},e.maxY=Number.MAX_SAFE_INTEGER,e.isCut=!1,e.initScale=1,e.isPlus=!1,e.isBehind=0,e.swerveHeight=100,e.nowNobePos=cc.v2(),e.harmEffFew=0,e}return s(e,t),e.prototype.start=function(){this.exp=d.default.getInstance().getEnemyExp(this.enemyType).experience,this.getAtkAnimSpeed(),this.setSpAnimPlaySpeed(),this.addEvent(u.BKT_EventName.PlaySkillsAtk,this.playSkillsAtk)},e.prototype.init=function(t,e){void 0===e&&(e=0),0==t&&(t=1),this.hpBG.active=!1,this.hpBar.progress=1,this.isDie=!1,this.enemyState=l.move,this.spAnim.paused=!1,this.spAnim.setAnimation(0,u.BKT_AnimName.move,!0),this.harmEffFew=0,this.immune=!0,this.immuneTime=0,this.spAnim.node.color=cc.Color.WHITE,this.isBehind=e,this.moveSpeed=d.default.getInstance().getParameterCfg(h.BKT_enumGearParameterCfg.EnemySpeed)[this.enemyType-1],this.moveSpeedPro=this.moveSpeed*d.default.getInstance().getParameterCfg(h.BKT_enumGearParameterCfg.EnemySpeedPro),1==this.isBehind?(this.node.angle=-20,this.moveSpeed*=.65):2==this.isBehind&&(this.node.angle=20,this.moveSpeed*=.65);var o=this.node.convertToWorldSpaceAR(cc.v2(0,0)),i=f.default.Instance.towerRoleBoxCol.convertToWorldSpaceAR(cc.v2(0,0));switch(o.x>i.x?(this.node.setScale(-this.initScale,this.initScale),this.isPlus=!1):(this.node.setScale(this.initScale,this.initScale),this.isPlus=!0),this.isCut=!1,this.enemyType){case 1:this.maxHp=d.default.getInstance().getEnemyInfo(t).ZombieHp,this.atkForce=d.default.getInstance().getEnemyInfo(t).ZombieAtk,this.swerveHeight=95,2==this.isBehind&&(this.swerveHeight-=14);break;case 2:this.maxHp=d.default.getInstance().getEnemyInfo(t).MiniBossHp,this.atkForce=d.default.getInstance().getEnemyInfo(t).MiniBossAtk,this.swerveHeight=102,2==this.isBehind&&(this.swerveHeight-=14);break;case 3:this.maxHp=d.default.getInstance().getEnemyInfo(t).OilHp,this.atkForce=d.default.getInstance().getEnemyInfo(t).OilAtk,this.swerveHeight=102,2==this.isBehind&&(this.swerveHeight-=14);break;case 4:this.maxHp=d.default.getInstance().getEnemyInfo(t).BallHP,this.atkForce=d.default.getInstance().getEnemyInfo(t).BallAtk,this.swerveHeight=93,2==this.isBehind&&(this.swerveHeight-=14)}this.nowHp=this.maxHp},e.prototype.update=function(t){if(f.default.Instance.gameState!=u.BKT_GameState.pause&&!this.getIsDie()){if(this.immune&&(this.immuneTime+=t,this.immuneTime>.2&&(this.immune=!1)),this.isSkillsStasis)return this.skillsStasisTime+=t,void(this.skillsStasisTime>3&&(this.skillsStasisTime=0,this.isSkillsStasis=!1,this.setGameState(u.BKT_GameState.playing)));var e=this.towerCol.getBoundingBoxToWorld(),o=f.default.Instance.towerRoleBoxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(e,o)?this.enemyState!=l.attack&&(this.enemyState=l.attack,this.spAnim.setAnimation(0,u.BKT_AnimName.attack,!1)):this.enemyState!=l.move&&(this.enemyState=l.move,this.spAnim.setAnimation(0,u.BKT_AnimName.move,!0)),this.enemyState==l.move)switch(this.isBehind){case 0:var i=this.node.getPosition(),n=this.moveSpeed*t,a=f.default.Instance.towerRoleBoxCol.getPosition(),r=a.sub(i).normalize().mul(n);this.node.setPosition(i.add(r));var s=a.sub(i).mag(),c=this.mapToRange(s,10,500,.7,1.5,2.2),p=this.initScale*c,d=this.isPlus?p:-p,h=p;this.node.setScale(d,h);break;case 1:this.nowNobePos=this.node.getPosition(),this.node.setPosition(this.nowNobePos.x-this.moveSpeed*t,this.nowNobePos.y+this.moveSpeed*t*.85),this.node.position.y>this.swerveHeight&&(this.isBehind=0,this.node.setParent(f.default.Instance.enemyBase),f.default.Instance.tierEnemyList(),cc.tween(this.node).to(5,{angle:0}).start());break;case 2:this.nowNobePos=this.node.getPosition(),this.node.setPosition(this.nowNobePos.x+this.moveSpeed*t,this.nowNobePos.y+this.moveSpeed*t*.85),this.node.position.y>this.swerveHeight&&(this.isBehind=0,this.node.setParent(f.default.Instance.enemyBase),f.default.Instance.tierEnemyList(),cc.tween(this.node).to(5,{angle:0}).start())}else this.enemyState==l.attack&&(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,u.BKT_AnimName.attack,!1)))}},e.prototype.mapToRange=function(t,e,o,i,n,a){void 0===a&&(a=1);var r=((t=Math.max(e,Math.min(o,t)))-e)/(o-e);return i+(n-i)*Math.pow(r,a)},e.prototype.attack=function(){var t=Math.floor(this.atkForce);f.default.Instance.attackEd(t)},e.prototype.setGameState=function(t){if(!this.isSkillsStasis)switch(t){case u.BKT_GameState.pause:this.spAnim.paused=!0;break;case u.BKT_GameState.playing:this.spAnim.paused=!1}},e.prototype.playSkillsAtk=function(t,e){f.default.Instance.gameState!=u.BKT_GameState.pause&&(this.getIsDie()||(3==t&&(this.setGameState(u.BKT_GameState.pause),this.isSkillsStasis=!0,this.skillsStasisTime=0),this.attackEd(e,!1)))},e.prototype.attackEd=function(t,e){var o=this;f.default.Instance.gameState!=u.BKT_GameState.pause&&(this.getIsDie()||this.immune||(p.AudioMgr.getInstance().playEffectFree(u.BKT_AudioId.dragonHit),this.nowHp-=t,this.harmEffFew<3&&(this.harmEffFew++,setTimeout(function(){o.harmEffFew--},110),f.default.Instance.playHarmEff(this.node,this.harmEffFew,t,e)),cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.2,{color:cc.Color.WHITE}).start(),this.hpBG.active||(this.hpBG.active=!0),this.updeteHpBar(),this.nowHp<1&&(this.isDie=!0,this.enemyState=l.die,this.die())))},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.getIsDie=function(){return this.isDie||this.nowHp<1},e.prototype.die=function(){this.node.angle=0,this.node.setScale(this.initScale,this.initScale),cc.Tween.stopAllByTarget(this.spAnim.node),cc.Tween.stopAllByTarget(this.node),f.default.Instance.addDropExp(this.exp),f.default.Instance.playDieEff(this.node),f.default.Instance.removeEnemyList(this.node),m.default.getInstance().PushObj(this.node)},c([_(cc.Integer)],e.prototype,"enemyType",void 0),c([_(cc.Node)],e.prototype,"hpBG",void 0),c([_(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([_(cc.Node)],e.prototype,"boxCol",void 0),c([_(cc.Node)],e.prototype,"towerCol",void 0),c([_(cc.Float)],e.prototype,"initScale",void 0),c([v],e)}(g.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BKT_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"3ad136g8sdPxYrQsQ9QetdH","BKT_GameData");var i=e,n=o;cc._RF.push(i,"3ad136g8sdPxYrQsQ9QetdH","BKT_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emBKT_GameDataKeys=void 0,function(t){t.mateCfg="mateCfg",t.GearParameterCfg="GearParameterCfg",t.BoxCfg="BoxCfg",t.waveCfg="waveCfg",t.HealthyCfg="HealthyCfg",t.monsterID="monsterID",t.CharacterCfg="CharacterCfg",t.CharacterNum="CharacterNum"}(n.emBKT_GameDataKeys||(n.emBKT_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],BKT_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"cef75+TZSJKt7sdOsLnIEBN","BKT_GameEnumData");var i=e,n=o;cc._RF.push(i,"cef75+TZSJKt7sdOsLnIEBN","BKT_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.BKT_enumGearParameterCfg=void 0,function(t){t[t.CloudHP=1]="CloudHP",t[t.ShopNum=2]="ShopNum",t[t.CloundAtk=3]="CloundAtk",t[t.EnemySpeed=4]="EnemySpeed",t[t.EnemySpeedPro=5]="EnemySpeedPro",t[t.duanyuAtkSpeed=6]="duanyuAtkSpeed",t[t.BoxNumber=7]="BoxNumber",t[t.ProWeight=8]="ProWeight",t[t.BoxHate=9]="BoxHate",t[t.AppearPro=10]="AppearPro"}(n.BKT_enumGearParameterCfg||(n.BKT_enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],BKT_GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"1ec79KI3FJN9LLGeW3GDUPc","BKT_GameManager");var i=t,n=e,a=o;cc._RF.push(n,"1ec79KI3FJN9LLGeW3GDUPc","BKT_GameManager");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("BKT_Config"),h=i("BKT_DataMgr"),f=i("BKT_GameEnumData"),m=i("BKT_HarmEff"),g=i("BKT_Skills"),y=i("BKT_PoolMgr"),v=i("BKT_Enemy"),_=i("BKT_RoleBox"),b=i("BKT_RoleField"),B=i("BKT_UIGame"),I=cc._decorator,P=I.ccclass,C=I.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boxFrame=null,e.gameTopUI=null,e.boxMatrix=null,e.boxMatrixArray=[],e.roleBoxSpare=null,e.roleBoxSpareAll=[],e.roleBoxField=null,e.roleBoxFieldAll=[],e.useRoleFieldBoxInfo=new Map,e.sceneAllRoleBoxs=[],e.towerRolePoss=[],e.towerRoleBoxCol=null,e.moveNode=null,e.fieldScale=null,e.btn_PlayGo=null,e.fieldRoles=new Map,e.enemyBase=null,e.roleBulletBase=null,e.harmEffBase=null,e.skillsBase=null,e.skillRolePos=null,e.roleAtkScope=null,e.roleAtkScopeArray=[],e.nightMap=[],e.mapTree=null,e.enemyMapMssk=null,e.behindWeight=0,e.behinEnemyRightPos=null,e.behinEnemyLeftPos=null,e.gameState=d.BKT_GameState.playing,e.isfight=!1,e.roleFieldScale=.67,e.pitchRoleBox=null,e.nowMaxWave=0,e.nowminWave=0,e.outWaveTime=0,e.waveInterval=0,e.isCanWave=!1,e.enemyTypeNum={},e.outEnemyInterval=.2,e.outEnemyTime=0,e.enemyAllArray=[],e.isWaveOver=!1,e.isWaveGameOver=!1,e.waveOverSumUI=0,e.waveOverNum=0,e.spareRoleBoxNumScope=3,e.isYesWaveOver=!1,e.txtAtk=null,e.hpBar=null,e.txtHp=null,e.maxHp=0,e.nowHp=0,e.secondAtkIcon=null,e.hpTxtIcon=null,e.roleBulletSpriteFrame=[],e.roleBulletCfg={},e.harmCritical=[],e.harmOrdinary=[],e.dropBox=null,e.dropBoxIcon=null,e.dropBoxBar=null,e.dropLevelIcon=null,e.dropLevel=0,e.dropUpLevelExp=0,e.dropNowExp=0,e.dropExpAll=0,e.dropBoxWeightCfg=[],e.changeDirection=!1,e.radius=450,e.minDeg=190,e.maxDeg=350,e.lastNowHp=100,e.color_Green=cc.color().fromHEX("#08f61b"),e.color_Red=cc.color().fromHEX("#f85454"),e.lastAllAtk=0,e.nearestBoxs=[],e.solderGainIDs=[],e.activateSkills=[],e.mateCfgs=[],e.mateKeyNum=[],e.activateSkillAtks=[],e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this)},e.prototype.start=function(){for(var t=0,e=this.boxMatrix.children;t<e.length;t++){var o=e[t];this.boxMatrixArray.push(o)}for(var i=0,n=this.roleAtkScope.children;i<n.length;i++)o=n[i],this.roleAtkScopeArray.push(o.getBoundingBoxToWorld());for(var a=0,r=this.roleBulletSpriteFrame;a<r.length;a++){var s=r[a];this.roleBulletCfg[s.name]=s}this.btn_PlayGo.on(cc.Node.EventType.TOUCH_END,this.playGame,this),this.dropBoxIcon.node.on(cc.Node.EventType.TOUCH_END,this.openDropBox,this),this.dropLevelIcon.node.active=!1,this.towerRolePoss[3].parent.parent.active=!1,this.towerRolePoss[6].parent.parent.active=!1,this.towerRolePoss[9].parent.parent.active=!1,this.initData(),this.updateRoleBoxSpare(),this.setGameState(d.BKT_GameState.playing)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),o.Instance=null,clearInterval(this.upMaxLevelDropBoxId)},e.prototype.initData=function(){this.characterCfg=[];for(var t=0,e=JSON.parse(JSON.stringify(h.default.getInstance().data.CharacterCfg));t<e.length;t++){var o=e[t];this.characterCfg.push(o)}this.waveCfg=h.default.getInstance().data.waveCfg,this.dropUpLevelExp=h.default.getInstance().getParameterCfg(f.BKT_enumGearParameterCfg.BoxNumber)[this.dropLevel],this.dropBoxWeightCfg=h.default.getInstance().data.BoxCfg,this.mateCfgs=h.default.getInstance().data.mateCfg,this.spareRoleBoxNumScope=h.default.getInstance().getParameterCfg(f.BKT_enumGearParameterCfg.ShopNum),this.behindWeight=h.default.getInstance().getParameterCfg(f.BKT_enumGearParameterCfg.AppearPro),this.maxHp=h.default.getInstance().getParameterCfg(f.BKT_enumGearParameterCfg.CloudHP),this.nowHp=this.maxHp,this.updeteHpBar()},e.prototype.setGameState=function(t){this.gameState=t,this.sendEvent(d.BKT_EventName.SetGameState,this.gameState)},e.prototype.playGame=function(){if(!this.isfight)if(0!=this.fieldRoles.size){if(null!=this.pitchRoleBox){for(var t=0,e=this.nearestBoxs;t<e.length;t++){var o=e[t];cc.Tween.stopAllByTarget(o),o.color=cc.Color.WHITE}var i=this.sceneAllRoleBoxs.indexOf(this.pitchRoleBox.getComponent(_.default));this.sceneAllRoleBoxs.splice(i,1),this.sendEvent(d.BKT_EventName.UpdateAllBoxAccord,this.sceneAllRoleBoxs),this.downFieldRole(this.pitchRoleBox.getComponent(_.default)),this.pitchRoleBox.destroy(),this.pitchRoleBox=null}var n=this.moveNode.position.clone();n.y-=400,cc.Tween.stopAllByTarget(this.moveNode),cc.tween(this.moveNode).to(.2,{position:n}).start();var a=this.boxFrame.position.clone();a.y-=280,cc.Tween.stopAllByTarget(this.boxFrame),cc.tween(this.boxFrame).to(.2,{position:a}).start();var r=this.fieldScale.position.clone();r.y+=60,cc.Tween.stopAllByTarget(this.fieldScale),cc.tween(this.fieldScale).to(.2,{position:r,scale:.8}).start(),cc.Tween.stopAllByTarget(this.dropBox),cc.tween(this.dropBox).to(.2,{position:cc.v3(-290,-310)}).start();for(var s=0,c=this.nightMap;s<c.length;s++){var l=c[s];cc.Tween.stopAllByTarget(l),cc.tween(l).to(.5,{opacity:255}).start()}cc.Tween.stopAllByTarget(this.mapTree),cc.tween(this.mapTree).to(.5,{opacity:0}).start(),this.isfight=!0,this.updateEnemyMaxWave(),this.sendEvent(d.BKT_EventName.PlayGame),p.AudioMgr.getInstance().playEffectFree(d.BKT_AudioId.kaishi)}else this.sendEvent(d.BKT_EventName.PlayTips,"\u8bf7\u5148\u4e0a\u9635\u89d2\u8272")},e.prototype.waveOver=function(){var t=this.moveNode.position.clone();t.y+=400,cc.Tween.stopAllByTarget(this.moveNode),cc.tween(this.moveNode).to(.2,{position:t}).start();var e=this.boxFrame.position.clone();e.y+=280,cc.Tween.stopAllByTarget(this.boxFrame),cc.tween(this.boxFrame).to(.2,{position:e}).start();var o=this.fieldScale.position.clone();o.y-=60,cc.Tween.stopAllByTarget(this.fieldScale),cc.tween(this.fieldScale).to(.2,{position:o,scale:1}).start(),cc.Tween.stopAllByTarget(this.dropBox),cc.tween(this.dropBox).to(.2,{position:cc.v3(-240,-644.5)}).start();for(var i=0,n=this.nightMap;i<n.length;i++){var a=n[i];cc.Tween.stopAllByTarget(a),cc.tween(a).to(.5,{opacity:0}).start()}cc.Tween.stopAllByTarget(this.mapTree),cc.tween(this.mapTree).to(.5,{opacity:255}).start(),this.isfight=!1,this.addWeightUp(),this.updateRoleBoxSpare(),this.sendEvent(d.BKT_EventName.UpdateWaveUI,this.nowMaxWave+1),this.sendEvent(d.BKT_EventName.UpdateWaveBarUI,0,10),this.sendEvent(d.BKT_EventName.WaveOver)},e.prototype.update=function(t){if(this.gameState!=d.BKT_GameState.pause&&this.isfight)if(!this.isWaveOver&&this.isCanWave)this.outWaveTime+=t,this.outWaveTime>this.waveInterval&&(this.nowminWave++,this.updateEnemyMinWave());else if(this.outEnemyTime+=t,this.outEnemyTime>this.outEnemyInterval){this.outEnemyTime=0;var e=Object.keys(this.enemyTypeNum);if(0===e.length)return void(this.isCanWave=!0);this.isCanWave=!1;var o=Number(e[Math.floor(Math.random()*e.length)]);this.enemyTypeNum[o],this.outEnemy(o),this.enemyTypeNum[o]-=1,0==this.enemyTypeNum[o]&&delete this.enemyTypeNum[o],0===Object.keys(this.enemyTypeNum).length?this.isCanWave=!0:this.isCanWave=!1}},e.prototype.updateEnemyMaxWave=function(){this.isYesWaveOver=!1,this.nowMaxWave++,this.nowMaxMonsterInfo=[],this.waveOverNum=0;for(var t=0;t<this.waveCfg.length;t++)this.waveCfg[t].id==this.nowMaxWave&&(this.nowMaxMonsterInfo.push(this.waveCfg[t]),this.waveOverNum+=this.waveCfg[t].MonsterSum,t==this.waveCfg.length-1&&(this.isWaveGameOver=!0));this.waveOverSumUI=this.waveOverNum,this.nowminWave=0,this.updateEnemyMinWave(),this.isWaveOver=!1},e.prototype.updateEnemyMinWave=function(){this.enemyTypeNum=[],this.outWaveTime=0,this.waveInterval=this.nowMaxMonsterInfo[this.nowminWave].FirstInterval;for(var t=this.nowMaxMonsterInfo[this.nowminWave].MonsterSum,e=0;e<this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++){var o=this.nowMaxMonsterInfo[this.nowminWave].Monster[e][0];this.enemyTypeNum[o]=1}for(e=0;e<t-this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++)this.addOutEnemyQueue(this.nowMaxMonsterInfo[this.nowminWave].Monster);this.nowminWave==this.nowMaxMonsterInfo.length-1&&(this.isWaveOver=!0),this.isCanWave=!1},e.prototype.addOutEnemyQueue=function(t){var e=this.random(0,t.length,!0),o=t[e][0];this.enemyTypeNum[o]==t[e][1]?this.addOutEnemyQueue(t):this.enemyTypeNum[o]+=1},e.prototype.outEnemy=function(t){var e=this,o="enemy/enemy_"+t;y.default.getInstance().getObj(o,function(t){if(Math.random()<e.behindWeight)if(e.changeDirection=!e.changeDirection,t.setParent(e.enemyMapMssk),e.changeDirection){t.setParent(e.enemyMapMssk);var o=e.behinEnemyRightPos.convertToWorldSpaceAR(cc.v2(0,0)),i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i),t.getComponent(v.default).init(e.nowMaxWave,1)}else t.setParent(e.enemyMapMssk),o=e.behinEnemyLeftPos.convertToWorldSpaceAR(cc.v2(0,0)),i=t.parent.convertToNodeSpaceAR(o),t.setPosition(i),t.getComponent(v.default).init(e.nowMaxWave,2);else{t.setParent(e.enemyBase);var n=e.enemyRandomPosInArc();t.setPosition(n),t.getComponent(v.default).init(e.nowMaxWave,0)}e.addEnemyList(t)})},e.prototype.enemyRandomPosInArc=function(){var t=this.towerRoleBoxCol.convertToWorldSpaceAR(cc.v2(0,0)),e=(this.minDeg+Math.random()*(this.maxDeg-this.minDeg))*Math.PI/180,o=t.x+Math.cos(e)*this.radius,i=t.y+Math.sin(e)*this.radius,n=cc.v2(o,i);return this.enemyBase.convertToNodeSpaceAR(n)},e.prototype.addEnemyList=function(t){this.enemyAllArray.push(t),this.tierEnemyList()},e.prototype.removeEnemyList=function(t){var e=this.enemyAllArray.indexOf(t);this.enemyAllArray.splice(e,1),this.waveOverNum--,this.sendEvent(d.BKT_EventName.UpdateWaveBarUI,this.waveOverSumUI-this.waveOverNum,this.waveOverSumUI),0==this.waveOverNum&&(this.isYesWaveOver=!0,this.isWaveGameOver?(this.setGameState(d.BKT_GameState.pause),u.UIMgr.getInstance().openUI(d.BKT_UIID.BKT_UIGameOver,1,!0)):this.waveOver())},e.prototype.tierEnemyList=function(){var t=this.enemyBase,e=this.enemyAllArray.filter(function(e){return e.parent===t});0!==e.length&&(e.sort(function(t,e){return e.y-t.y}),e.forEach(function(t,e){t.setSiblingIndex(e)}))},e.prototype.getEnemyNear=function(t){for(var e=t.convertToWorldSpaceAR(cc.v2(0,0)),o=null,i=Number.POSITIVE_INFINITY,n=0,a=this.enemyAllArray;n<a.length;n++){var r=a[n];if(r.active){var s=r.convertToWorldSpaceAR(cc.v2(0,0)),c=s.x-e.x,l=s.y-e.y,p=c*c+l*l;if(p<i)for(var u=r.getComponent(v.default).boxCol.getBoundingBoxToWorld(),d=0,h=this.roleAtkScopeArray;d<h.length;d++){var f=h[d];if(cc.Intersection.rectRect(f,u)){i=p,o=r;break}}}}return o},e.prototype.getCollisionBullet=function(t){for(var e=t.boxCol.getBoundingBoxToWorld(),o=0,i=this.enemyAllArray;o<i.length;o++){var n=i[o],a=n.getComponent(v.default).boxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(e,a))return n}return null},e.prototype.getBulletImg=function(t){return this.roleBulletCfg[t]},e.prototype.getWorldAngle=function(t){var e=new cc.Mat4;t.getWorldMatrix(e);var o=e.m[0],i=e.m[1];return Math.atan2(i,o)*(180/Math.PI)},e.prototype.playSkillsRole=function(t){var e=this,o={};o[B.BKT_MateSkills[t].id1]={roleID:B.BKT_MateSkills[t].id1,level:6,atk:0,mateRate:0},o[B.BKT_MateSkills[t].id2]={roleID:B.BKT_MateSkills[t].id2,level:6,atk:0,mateRate:0},this.fieldRoles.forEach(function(e){e.skillID==t&&o[B.BKT_MateSkills[t].id1].roleID==e.roleID&&e.level<o[B.BKT_MateSkills[t].id1].level?(o[B.BKT_MateSkills[t].id1].level=e.level,o[B.BKT_MateSkills[t].id1].atk=e.atkForce,o[B.BKT_MateSkills[t].id1].mateRate=e.mateRate):e.skillID==t&&o[B.BKT_MateSkills[t].id2].roleID==e.roleID&&e.level<o[B.BKT_MateSkills[t].id2].level&&(o[B.BKT_MateSkills[t].id2].level=e.level,o[B.BKT_MateSkills[t].id2].atk=e.atkForce,o[B.BKT_MateSkills[t].id2].mateRate=e.mateRate)});var i=o[B.BKT_MateSkills[t].id1].atk,n=o[B.BKT_MateSkills[t].id2].atk,a=this.round(i>n?n:i),r=o[B.BKT_MateSkills[t].id1].mateRate,s=o[B.BKT_MateSkills[t].id2].mateRate,c=r>s?s:r;this.loadPrefab(d.BKT_BundleName.Prefabs,"role/roleFieldSkill",function(t){var o=cc.instantiate(t);o.setParent(e.skillRolePos);var i=e.round(c*a);o.getComponent(b.default).summonSkill(i)})},e.prototype.playSkillsAtk=function(t){var e=this,o={};o[B.BKT_MateSkills[t].id1]={roleID:B.BKT_MateSkills[t].id1,level:6,atk:0,mateRate:0},o[B.BKT_MateSkills[t].id2]={roleID:B.BKT_MateSkills[t].id2,level:6,atk:0,mateRate:0},this.fieldRoles.forEach(function(e){e.skillID==t&&o[B.BKT_MateSkills[t].id1].roleID==e.roleID&&e.level<o[B.BKT_MateSkills[t].id1].level?(o[B.BKT_MateSkills[t].id1].level=e.level,o[B.BKT_MateSkills[t].id1].atk=e.atkForce,o[B.BKT_MateSkills[t].id1].mateRate=e.mateRate):e.skillID==t&&o[B.BKT_MateSkills[t].id2].roleID==e.roleID&&e.level<o[B.BKT_MateSkills[t].id2].level&&(o[B.BKT_MateSkills[t].id2].level=e.level,o[B.BKT_MateSkills[t].id2].atk=e.atkForce,o[B.BKT_MateSkills[t].id2].mateRate=e.mateRate)});var i=o[B.BKT_MateSkills[t].id1].atk,n=o[B.BKT_MateSkills[t].id2].atk,a=this.round(i>n?n:i),r=o[B.BKT_MateSkills[t].id1].mateRate,s=o[B.BKT_MateSkills[t].id2].mateRate,c=r>s?s:r,l="skills/skill_"+t;this.loadPrefab(d.BKT_BundleName.Prefabs,l,function(o){var i=cc.instantiate(o);i.setParent(e.skillsBase),i.setPosition(cc.v3());var n=e.round(c*a);i.getComponent(g.default).init(n,t)})},e.prototype.attackEd=function(t){this.gameState!=d.BKT_GameState.pause&&(this.nowHp-=t,this.updeteHpBar(),this.nowHp<1&&(u.UIMgr.getInstance().openUI(d.BKT_UIID.BKT_UIGameOver,1,!1),this.setGameState(d.BKT_GameState.pause),p.AudioMgr.getInstance().playEffectFree(d.BKT_AudioId.shibai)))},e.prototype.updeteHpBar=function(){var t=this;this.txtHp.string=""+this.nowHp,this.lastNowHp!=this.nowHp&&(this.txtHp.node.color=this.nowHp>this.lastNowHp?this.color_Green:this.color_Red,cc.Tween.stopAllByTarget(this.hpTxtIcon),cc.tween(this.hpTxtIcon).to(.1,{scale:1.6}).to(.1,{scale:1.2}).call(function(){t.txtHp.node.color=cc.Color.WHITE}).start()),this.lastNowHp=this.nowHp;var e=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.15,{progress:e}).start()},e.prototype.updeteProperty=function(){var t=this,e=this.nowHp/this.maxHp;this.maxHp=h.default.getInstance().getParameterCfg(f.BKT_enumGearParameterCfg.CloudHP);var o=0;this.fieldRoles.forEach(function(e){t.maxHp+=e.hp,o+=e.secondAtk}),this.maxHp=this.round(this.maxHp),this.nowHp=this.round(this.maxHp*e),o=this.round(o),this.txtAtk.string=""+o,this.lastAllAtk!=o&&(this.txtAtk.node.color=o>this.lastAllAtk?this.color_Green:this.color_Red,cc.Tween.stopAllByTarget(this.secondAtkIcon),cc.tween(this.secondAtkIcon).to(.1,{scale:1.6}).to(.1,{scale:1.2}).call(function(){t.txtAtk.node.color=cc.Color.WHITE}).start()),this.lastAllAtk=o,this.updeteHpBar()},e.prototype.addDropExp=function(t){var e=this;if(this.dropNowExp+=t,this.dropExpAll+=t,this.dropNowExp>=this.dropUpLevelExp&&this.dropLevel<4){var o=this.dropNowExp-this.dropUpLevelExp;this.dropLevel++,this.dropNowExp=o;var i=this.dropNowExp/this.dropUpLevelExp;this.dropBoxBar.progress=0,clearInterval(this.upMaxLevelDropBoxId),this.upMaxLevelDropBoxId=null,cc.Tween.stopAllByTarget(this.dropBoxIcon.node),cc.tween(this.dropBoxIcon.node).to(.5,{scale:1.5}).to(.5,{scale:1.2}).start(),this.upMaxLevelDropBoxId=setInterval(function(){cc.Tween.stopAllByTarget(e.dropBoxIcon.node),cc.tween(e.dropBoxIcon.node).to(.5,{scale:1.5}).to(.5,{scale:1.2}).start()},1e3),this.loadSpriteFrame(d.BKT_BundleName.Sprite,"dropBoxIcon/box_0"+this.dropLevel,function(t){e.dropBoxIcon.spriteFrame=t});var n="";this.dropLevel<4?(n="roleLevelIcon/jb_0"+this.dropLevel,this.dropUpLevelExp=h.default.getInstance().getParameterCfg(f.BKT_enumGearParameterCfg.BoxNumber)[this.dropLevel]):(n="roleLevelIcon/max",i=1),this.dropLevelIcon.node.active=!0,this.loadSpriteFrame(d.BKT_BundleName.Sprite,n,function(t){e.dropLevelIcon.spriteFrame=t}),this.playUpLevelEff(this.dropBoxIcon.node.parent),cc.Tween.stopAllByTarget(this.dropBoxBar),cc.tween(this.dropBoxBar).to(.1,{progress:i}).start()}else{if(4==this.dropLevel)return;i=this.dropNowExp/this.dropUpLevelExp,cc.Tween.stopAllByTarget(this.dropBoxBar),cc.tween(this.dropBoxBar).to(.1,{progress:i}).start()}},e.prototype.openDropBox=function(){var t=this;if(this.dropLevel>0&&!this.isfight){p.AudioMgr.getInstance().playEffectFree(d.BKT_AudioId.shengji);var e=this.randomDropBoxRole(1,this.dropLevel);this.dropLevelIcon.node.active=!1,this.dropExpAll=0,this.dropNowExp=this.dropExpAll,this.dropLevel=0,this.dropBoxBar.progress=0,this.dropUpLevelExp=h.default.getInstance().getParameterCfg(f.BKT_enumGearParameterCfg.BoxNumber)[this.dropLevel],this.loadSpriteFrame(d.BKT_BundleName.Sprite,"dropBoxIcon/box_0"+this.dropLevel,function(e){t.dropBoxIcon.spriteFrame=e}),clearInterval(this.upMaxLevelDropBoxId),this.upMaxLevelDropBoxId=null,cc.Tween.stopAllByTarget(this.dropBoxIcon.node),this.dropBoxIcon.node.setScale(1.3),this.addDropExp(0);for(var o=function(e){var o="roleBox/roleBox_"+e.CharacterID,n=i.dropBoxIcon.node.convertToWorldSpaceAR(cc.v2(0,0));i.loadPrefab(d.BKT_BundleName.Prefabs,o,function(o){var i=cc.instantiate(o);i.setParent(t.roleBoxSpare);var a=i.parent.convertToNodeSpaceAR(n);i.setPosition(a),i.getComponent(_.default).init(e.grade),t.roleBoxSpareAll.push(i),t.sceneAllRoleBoxs.push(i.getComponent(_.default)),t.calculateLayout(-1,!0),t.sendEvent(d.BKT_EventName.UpdateAllBoxAccord,t.sceneAllRoleBoxs)})},i=this,n=0,a=e;n<a.length;n++)o(a[n])}},e.prototype.randomDropBoxRole=function(t,e){for(var o=[],i=[],n=0,a=this.dropBoxWeightCfg;n<a.length;n++)(p=a[n]).BoxLevel==e&&o.push(p);for(var r=[],s=0,c=0,l=o;c<l.length;c++){var p;s+=(p=l[c]).weight,r.push(s)}for(var u=s,d=0;d<t;d++)for(var h=Math.random()*u,f=0;f<r.length;f++)if(h<r[f]){i.push(o[f]);break}return i},e.prototype.updateRoleBoxSpare=function(){for(var t=this,e=0,o=this.roleBoxSpareAll;e<o.length;e++){var i=o[e],n=this.sceneAllRoleBoxs.indexOf(i.getComponent(_.default));this.sceneAllRoleBoxs.splice(n,1)}this.roleBoxSpare.removeAllChildren(),this.roleBoxSpareAll=[];for(var a=0,r=this.randomRoles(this.spareRoleBoxNumScope),s=function(e){var o="roleBox/roleBox_"+e.CharacterID;c.loadPrefab(d.BKT_BundleName.Prefabs,o,function(o){var i=cc.instantiate(o);i.setParent(t.roleBoxSpare),i.getComponent(_.default).init(e.grade),t.roleBoxSpareAll.push(i),t.sceneAllRoleBoxs.push(i.getComponent(_.default)),++a==t.spareRoleBoxNumScope&&(t.calculateLayout(-1,!0),t.sendEvent(d.BKT_EventName.UpdateAllBoxAccord,t.sceneAllRoleBoxs))})},c=this,l=0,p=r;l<p.length;l++)s(p[l])},e.prototype.randomRoles=function(t){for(var e=this.characterCfg.filter(function(t){return t.weight>0}),o=[],i=[],n=0,a=0,r=e;a<r.length;a++)n+=r[a].weight,i.push(n);for(var s=n,c=0;c<t;c++)for(var l=Math.random()*s,p=0;p<i.length;p++)if(l<i[p]){o.push(e[p]);break}return o},e.prototype.addWeightUp=function(){for(var t=0,e=this.characterCfg;t<e.length;t++){var o=e[t];o.grade>=4?this.nowMaxWave>=4&&(o.weight+=o.weightUp):o.weight+=o.weightUp}},e.prototype.moveRoleBox=function(t,e){if(t!=d.BKT_MoveRoleState.TouchStart){this.nearestBoxs=[];for(var o=0,i=this.boxMatrixArray;o<i.length;o++)i[o].color=cc.Color.WHITE;for(var n=0,a=e.boxPosArray;n<a.length;n++){for(var r=a[n],s=null,c=Number.MAX_SAFE_INTEGER,l=this.getWorldPosV2(r),p=0,u=this.boxMatrixArray;p<u.length;p++){var h=u[p],f=cc.Vec2.distance(l,this.getWorldPosV2(h));f<c&&(c=f,s=h)}c<65&&!this.nearestBoxs.includes(s)&&this.nearestBoxs.push(s)}var m=this.nearestBoxs.length==e.boxPosArray.length;if(m)for(var g=0,y=this.nearestBoxs;g<y.length;g++){var v=y[g];if(this.useRoleFieldBoxInfo.has(v)){var b=this.useRoleFieldBoxInfo.get(v).getComponent(_.default);e.roleType==b.roleType&&e.level==b.level&&e.level<4||(m=!1)}else m=!1}for(var B=!1,I=function(t){P.useRoleFieldBoxInfo.forEach(function(e,o){o!=t||(B=!0)})},P=this,C=0,D=this.nearestBoxs;C<D.length;C++)I(v=D[C]);for(var T=this.nearestBoxs.length==e.boxPosArray.length,S=0,A=this.nearestBoxs;S<A.length;S++)(v=A[S]).color=m?cc.Color.GREEN:T?B?cc.Color.RED:cc.Color.GREEN:cc.Color.GRAY;t==d.BKT_MoveRoleState.TouchEnd&&this.endRoleBox(e)}else{if(this.setParentPos(e.node,this.gameTopUI),this.roleBoxSpareAll.includes(e.node)){var k=this.roleBoxSpareAll.indexOf(e.node);this.roleBoxSpareAll.splice(k,1),this.calculateLayout()}this.roleBoxFieldAll.includes(e.node)&&(k=this.roleBoxFieldAll.indexOf(e.node),this.roleBoxFieldAll.splice(k,1),this.removeRoleFieldBoxInfo(e.node))}},e.prototype.endRoleBox=function(t){for(var e=this,o=0,i=this.nearestBoxs;o<i.length;o++){var n=i[o];cc.Tween.stopAllByTarget(n),cc.tween(n).to(.15,{color:cc.Color.WHITE}).start()}if(!this.isUpRoleLevel(t,this.roleBoxFieldAll)&&!this.isUpRoleLevel(t,this.roleBoxSpareAll))if(this.nearestBoxs.length==t.boxPosArray.length){this.setParentPos(t.node,this.roleBoxField),this.roleBoxFieldAll.push(t.node),p.AudioMgr.getInstance().playEffectFree(d.BKT_AudioId.fangrugezi);var a=this.getWorldPosV3(this.nearestBoxs[0]),r=this.getWorldPosV3(t.boxPosArray[0]),s=a.subtract(r);t.upRoleMatrix(s);for(var c=[],l=0,u=this.nearestBoxs;l<u.length;l++){var h=u[l];this.useRoleFieldBoxInfo.has(h)&&(c.includes(this.useRoleFieldBoxInfo.get(h))||c.push(this.useRoleFieldBoxInfo.get(h)),this.useRoleFieldBoxInfo.delete(h)),this.useRoleFieldBoxInfo.set(h,t.node)}for(var f=this.getWorldPosV2(t.node),m=function(t){var o=t.getComponent(_.default);g.downFieldRole(o);var i=g.roleBoxFieldAll.indexOf(o.node);g.roleBoxFieldAll.splice(i,1),g.removeRoleFieldBoxInfo(t);var n=.8*(o.node.width+t.width)/2;g.getWorldPosV2(t).x<f.x&&(n=-n);var a=cc.v3(t.x+n,t.y+30);cc.Tween.stopAllByTarget(t),cc.tween(t).to(.15,{position:a}).call(function(){e.insertRoleBoxSpare(o)}).start()},g=this,y=0,v=c;y<v.length;y++)m(h=v[y]);this.upFieldRole(t)}else this.downFieldRole(t),this.insertRoleBoxSpare(t)},e.prototype.isUpRoleLevel=function(t,e){for(var o=this,i=this.getWorldPosV3(t.node),n=function(e){var n=a.getWorldPosV3(e),r=e.getComponent(_.default);if(cc.Vec2.distance(i,n)<47.8&&r.roleType==t.roleType&&r.level==t.level&&t.level<5&&r!=t){var s=t.node.parent.convertToNodeSpaceAR(n);return cc.Tween.stopAllByTarget(t.node),cc.tween(t.node).to(.15,{position:s}).call(function(){o.downFieldRole(t),r.upRoleLevel(),o.fieldRoles.has(r)&&(o.fieldRoles.get(r).upRoleLevel(),o.updeteProperty(),o.updateSolderID()),p.AudioMgr.getInstance().playEffectFree(d.BKT_AudioId.shengji),o.playUpLevelEff(e);var i=o.sceneAllRoleBoxs.indexOf(t);o.sceneAllRoleBoxs.splice(i,1),o.sendEvent(d.BKT_EventName.UpdateAllBoxAccord,o.sceneAllRoleBoxs),t.die()}).start(),{value:!0}}},a=this,r=0,s=e;r<s.length;r++){var c=n(s[r]);if("object"==typeof c)return c.value}return!1},e.prototype.removeRoleFieldBoxInfo=function(t){var e=[];this.useRoleFieldBoxInfo.forEach(function(o,i){o==t&&e.push(i)});for(var o=0,i=e;o<i.length;o++){var n=i[o];this.useRoleFieldBoxInfo.delete(n)}},e.prototype.insertRoleBoxSpare=function(t){this.setParentPos(t.node,this.roleBoxSpare);var e=this.findPosIndex(t.node);e<this.roleBoxSpare.childrenCount&&this.roleBoxSpare.insertChild(t.node,e),e>this.roleBoxSpareAll.length?this.roleBoxSpareAll.push(t.node):this.roleBoxSpareAll.splice(e,0,t.node),this.calculateLayout(e)},e.prototype.findPosIndex=function(t){if(0==this.roleBoxSpareAll.length)return 0;for(var e=0,o=Number.MAX_SAFE_INTEGER,i=this.getWorldPosV2(t),n=0;n<this.roleBoxSpareAll.length;n++){var a=cc.Vec2.distance(i,this.getWorldPosV2(this.roleBoxSpareAll[n]));a<o&&(o=a,e=n)}return this.getWorldPosV2(this.roleBoxSpareAll[e]).x>i.x?e:e+1},e.prototype.calculateLayout=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=this.roleBoxSpareAll;if(!(o.length<1)){var i=this.roleBoxSpare.width-20,n=o.reduce(function(t,e){return t+e.width},0),a=[];if(n<=i)for(var r=-i/2+(p=(i-n)/(o.length+1)),s=0,c=o;s<c.length;s++){var l=c[s];a.push(cc.v3(r+l.width/2,0)),r+=l.width+p}else for(var p=(i-n)/(o.length-1),u=(r=-i/2,0),d=o;u<d.length;u++)l=d[u],a.push(cc.v3(r+l.width/2,0)),r+=l.width+p;for(var h=0;h<o.length;h++){var f=h,m=o[f];cc.Tween.stopAllByTarget(m),t==f||e?cc.tween(m).to(.2,{position:a[f],angle:this.random(0,1)>.5?10:-10},{easing:"quadOut"}).start():cc.tween(m).to(.2,{position:a[f]},{easing:"quadOut"}).start()}}},e.prototype.upFieldRole=function(t){var e=this;this.fieldRoles.has(t)||y.default.getInstance().getObj("role/roleField",function(o){var i=o.getComponent(b.default);i.init(t.roleType,t.level),e.fieldRoles.set(t,i);var n=e.fieldRoles.size;n>3&&!e.towerRolePoss[3].parent.parent.active&&(e.towerRolePoss[3].parent.parent.active=!0),n>6&&!e.towerRolePoss[6].parent.parent.active&&(e.towerRolePoss[6].parent.parent.active=!0),n>9&&!e.towerRolePoss[9].parent.parent.active&&(e.towerRolePoss[9].parent.parent.active=!0);for(var a=0,r=e.towerRolePoss;a<r.length;a++){var s=r[a];if(0==s.childrenCount){o.setParent(s),o.setPosition(cc.v2()),o.setScale(0);var c=e.towerRolePoss.indexOf(s),l=e.roleFieldScale;switch(c){case 1:case 4:case 7:case 10:l=-l}cc.tween(o).to(.15,{scaleX:l,scaleY:e.roleFieldScale}).start();break}}e.updeteProperty(),e.updateSolderID()})},e.prototype.downFieldRole=function(t){if(this.fieldRoles.has(t)){var e=this.fieldRoles.get(t);this.fieldRoles.delete(t);var o=e.node.parent,i=this.towerRolePoss.indexOf(o);this.setParentPos(e.node,e.node.parent.parent),cc.Tween.stopAllByTarget(e.node),cc.tween(e.node).to(.15,{scaleX:0,scaleY:0}).call(function(){e.die()}).start();for(var n=this.towerRolePoss.length-1;n>=0&&!(i>n);n--)if(0!=this.towerRolePoss[n].childrenCount){var a=this.towerRolePoss[n].children[0];a.setParent(o),a.setScale(0),a.setPosition(cc.v2());var r=this.roleFieldScale;switch(i){case 1:case 4:case 7:case 10:r=-r}cc.tween(a).to(.15,{scaleX:r,scaleY:this.roleFieldScale}).start();break}var s=this.fieldRoles.size;s<4&&this.towerRolePoss[4].parent.parent.active&&(this.towerRolePoss[4].parent.parent.active=!1),s<7&&this.towerRolePoss[7].parent.parent.active&&(this.towerRolePoss[7].parent.parent.active=!1),s<10&&this.towerRolePoss[10].parent.parent.active&&(this.towerRolePoss[10].parent.parent.active=!1),this.updeteProperty(),this.updateSolderID()}},e.prototype.updateSolderID=function(){var t=this;this.solderGainIDs=[],this.mateKeyNum=[],this.activateSkillAtks=[],this.fieldRoles.forEach(function(e){if(!t.solderGainIDs.includes(e.roleID)){t.solderGainIDs.push(e.roleID);for(var o=0,i=e.mate;o<i.length;o++){var n=i[o];null==t.mateKeyNum[n]?t.mateKeyNum[n]=1:t.mateKeyNum[n]+=1}}(null==t.activateSkillAtks[e.skillID]||e.level<t.activateSkillAtks[e.skillID])&&(t.activateSkillAtks[e.skillID]=e.level)}),this.getActivatedMateIDs()},e.prototype.getActivatedMateIDs=function(){var t=this;this.activateSkills=[];for(var e=function(e){for(var i=0,n=o.mateCfgs;i<n.length;i++){var a=n[i];o.activateSkills.includes(a.mateID)||a.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).includes(e)})&&a.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).every(function(e){return t.solderGainIDs.includes(e)})})&&o.activateSkills.push(a.mateID)}},o=this,i=0,n=this.solderGainIDs;i<n.length;i++)e(n[i]);this.sendEvent(d.BKT_EventName.ActivateSkills,this.activateSkills,this.solderGainIDs,this.activateSkillAtks)},e.prototype.playUpLevelEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));y.default.getInstance().getObj("effAnim/roleUpLevelEff",function(t){t.setParent(e.gameTopUI);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playDieEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));y.default.getInstance().getObj("effAnim/dieEff",function(t){t.setParent(e.roleBulletBase);var i=t.parent.convertToNodeSpaceAR(o);i.y-=25,t.setPosition(i)})},e.prototype.playHarmEff=function(t,e,o,i){var n=this,a=t.convertToWorldSpaceAR(cc.v2(0,0));y.default.getInstance().getObj("effAnim/harmEff",function(t){t.setParent(n.harmEffBase);var r=t.parent.convertToNodeSpaceAR(a);r.x+=30*e,r.y+=30*e,n.harmEffBase.insertChild(t,0),t.setPosition(r),t.getComponent(m.default).init(o,i)})},e.prototype.getHarmIcon=function(t,e){return e?this.harmCritical[t]:this.harmOrdinary[t]},e.prototype.getWorldPosV2=function(t){return t.parent.convertToWorldSpaceAR(t.getPosition())},e.prototype.getWorldPosV3=function(t){return t.parent.convertToWorldSpaceAR(t.position)},e.prototype.setParentPos=function(t,e){var o=this.getWorldPosV3(t);t.setParent(e);var i=e.convertToNodeSpaceAR(o);t.setPosition(i)},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.Instance=null,c([C(cc.Node)],e.prototype,"boxFrame",void 0),c([C(cc.Node)],e.prototype,"gameTopUI",void 0),c([C(cc.Node)],e.prototype,"boxMatrix",void 0),c([C(cc.Node)],e.prototype,"roleBoxSpare",void 0),c([C(cc.Node)],e.prototype,"roleBoxField",void 0),c([C(cc.Node)],e.prototype,"towerRolePoss",void 0),c([C(cc.Node)],e.prototype,"towerRoleBoxCol",void 0),c([C(cc.Node)],e.prototype,"moveNode",void 0),c([C(cc.Node)],e.prototype,"fieldScale",void 0),c([C(cc.Node)],e.prototype,"btn_PlayGo",void 0),c([C(cc.Node)],e.prototype,"enemyBase",void 0),c([C(cc.Node)],e.prototype,"roleBulletBase",void 0),c([C(cc.Node)],e.prototype,"harmEffBase",void 0),c([C(cc.Node)],e.prototype,"skillsBase",void 0),c([C(cc.Node)],e.prototype,"skillRolePos",void 0),c([C(cc.Node)],e.prototype,"roleAtkScope",void 0),c([C(cc.Node)],e.prototype,"nightMap",void 0),c([C(cc.Node)],e.prototype,"mapTree",void 0),c([C(cc.Node)],e.prototype,"enemyMapMssk",void 0),c([C(cc.Node)],e.prototype,"behinEnemyRightPos",void 0),c([C(cc.Node)],e.prototype,"behinEnemyLeftPos",void 0),c([C(cc.Label)],e.prototype,"txtAtk",void 0),c([C(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([C(cc.Label)],e.prototype,"txtHp",void 0),c([C(cc.Node)],e.prototype,"secondAtkIcon",void 0),c([C(cc.Node)],e.prototype,"hpTxtIcon",void 0),c([C(cc.SpriteFrame)],e.prototype,"roleBulletSpriteFrame",void 0),c([C(cc.SpriteFrame)],e.prototype,"harmCritical",void 0),c([C(cc.SpriteFrame)],e.prototype,"harmOrdinary",void 0),c([C(cc.Node)],e.prototype,"dropBox",void 0),c([C(cc.Sprite)],e.prototype,"dropBoxIcon",void 0),c([C(cc.ProgressBar)],e.prototype,"dropBoxBar",void 0),c([C(cc.Sprite)],e.prototype,"dropLevelIcon",void 0),o=c([P],e)}(l.default);a.default=D,cc._RF.pop(),cc._RF.pop()},{}],BKT_HarmEff:[function(t,e,o){"use strict";cc._RF.push(e,"708a6D43aBCPJkxJK8a9fHp","BKT_HarmEff");var i=t,n=e,a=o;cc._RF.push(n,"708a6D43aBCPJkxJK8a9fHp","BKT_HarmEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BKT_GameManager"),u=i("BKT_PoolMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ordinaryRoot=null,e.criticalRoot=null,e.critical=null,e.criticalIcon=null,e.ordinary=null,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.node.opacity=255;var i=t.toString().split("").map(Number);this.ordinaryRoot.removeAllChildren(),this.criticalRoot.removeAllChildren(),this.ordinaryRoot.active=!e,this.criticalRoot.active=e,e?(this.criticalIcon.setParent(this.criticalRoot),this.criticalIcon.active=!0):this.criticalIcon.active=!1;for(var n=0;n<i.length;n++){var a=e?cc.instantiate(this.critical):cc.instantiate(this.ordinary),r=e?this.criticalRoot:this.ordinaryRoot;a.setParent(r),a.active=!0,a.getComponent(cc.Sprite).spriteFrame=p.default.Instance.getHarmIcon(i[n],e)}var s=this.node.position.clone();s.y+=40,cc.tween(this.node).to(.2,{position:s}).call(function(){s.y+=40}).to(.2,{position:s,opacity:0}).call(function(){o.die()}).start()},e.prototype.die=function(){this.criticalIcon.setParent(this.node),u.default.getInstance().PushObj(this.node)},c([f(cc.Node)],e.prototype,"ordinaryRoot",void 0),c([f(cc.Node)],e.prototype,"criticalRoot",void 0),c([f(cc.Node)],e.prototype,"critical",void 0),c([f(cc.Node)],e.prototype,"criticalIcon",void 0),c([f(cc.Node)],e.prototype,"ordinary",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BKT_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"f3c4d7zJ1dDHJbdpqC7dsq+","BKT_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"f3c4d7zJ1dDHJbdpqC7dsq+","BKT_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=i("BKT_Config"),l=cc._decorator.ccclass,p=function(){function t(){this.poolMap={},this.poolRoot=null;var t=new cc.Node("poolRoot"),e=cc.find("uiRoot");t.setParent(e),e.insertChild(t,0),this.poolRoot=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e){var o=t.replace(/\//g,"_");this.poolMap[o]&&this.poolMap[o].poolList.length>0?e(this.poolMap[o].getObj()):s.ResourceMgr.getInstance().loadRes(c.BKT_BundleName.Prefabs,t,cc.Prefab,function(t){var i=cc.instantiate(t);i.name=o,e(i)})},t.prototype.PushObj=function(t){if(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new u(t,this.poolRoot);this.poolMap[e]=o}}},t.prototype.clear=function(){this.poolMap={},this.poolRoot.removeAllChildren()},e=r([l],t)}();a.default=p;var u=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],BKT_RoleBase:[function(t,e,o){"use strict";cc._RF.push(e,"6d696qqd+hHraJqqQj6CYZM","BKT_RoleBase");var i=t,n=e,a=o;cc._RF.push(n,"6d696qqd+hHraJqqQj6CYZM","BKT_RoleBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BKT_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkInterval=1,e.atkTime=0,e.atkForce=1,e.isAtkCooling=!0,e.clipDuration=null,e.atkAnimTimeSpeed=1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.isAtkCooling=!0,this.spAnim.setCompleteListener(function(e){e.animation.name==p.BKT_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.isAtkCooling=!0,t.spAnim.setAnimation(0,p.BKT_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==p.BKT_AnimName.attack&&t.attack()}),this.addEvent(p.BKT_EventName.SetGameState,this.setGameState)},e.prototype.setGameState=function(t){switch(t){case p.BKT_GameState.pause:this.spAnim.paused=!0;break;case p.BKT_GameState.playing:this.spAnim.paused=!1}},e.prototype.getAtkAnimSpeed=function(){var t=this.spAnim.findAnimation(p.BKT_AnimName.attack);this.clipDuration=t.duration},e.prototype.setSpAnimPlaySpeed=function(){this.atkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.atkInterval*1.05)},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BKT_RoleBox:[function(t,e,o){"use strict";cc._RF.push(e,"bdf0dr/D91BArmeGHUQP5t6","BKT_RoleBox");var i=t,n=e,a=o;cc._RF.push(n,"bdf0dr/D91BArmeGHUQP5t6","BKT_RoleBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BKT_Config"),u=i("BKT_GameManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleType=p.BKT_RoleType._Null,e.roleIcon=null,e.boxPos=null,e.boxPosArray=[],e.levelIcon=null,e.level=1,e.isTapTouchStart=!1,e.deviationOnStart=null,e.isAccord=!1,e.animIndexID=null,e}return s(e,t),e.prototype.start=function(){for(var t=0,e=this.boxPos.children;t<e.length;t++){var o=e[t];this.boxPosArray.push(o)}this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),clearInterval(this.animIndexID)},e.prototype.init=function(t){this.level=t,this.updateIconLevel(),this.addEvent(p.BKT_EventName.UpdateAllBoxAccord,this.updateAllBoxAccord),this.addEvent(p.BKT_EventName.PlayGame,this.closeBoxUpTips)},e.prototype.onTouchStart=function(t){if(null==u.default.Instance.pitchRoleBox&&!u.default.Instance.isfight){u.default.Instance.pitchRoleBox=this.node,this.isTapTouchStart=!0,this.node.angle=0,cc.Tween.stopAllByTarget(this.node),cc.Tween.stopAllByTarget(this.roleIcon.node),clearInterval(this.animIndexID),this.animIndexID=null,this.roleIcon.node.angle=0;var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.deviationOnStart=this.node.getPosition().subtract(e),this.updateTouchPos(t.getLocation()),u.default.Instance.moveRoleBox(p.BKT_MoveRoleState.TouchStart,this)}},e.prototype.onTouchMove=function(t){this.isTapTouchStart&&(this.updateTouchPos(t.getLocation()),u.default.Instance.moveRoleBox(p.BKT_MoveRoleState.TouchMove,this))},e.prototype.onTouchEnd=function(t){this.isTapTouchStart&&(this.isTapTouchStart=!1,u.default.Instance.pitchRoleBox=null,this.isAccord&&this.openBoxUpTips(),this.updateTouchPos(t.getLocation()),u.default.Instance.moveRoleBox(p.BKT_MoveRoleState.TouchEnd,this))},e.prototype.updateTouchPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t).add(this.deviationOnStart);this.node.setPosition(e)},e.prototype.upRoleMatrix=function(t){this.node.angle=0;var e=this.node.position.add(t);cc.tween(this.node).to(.15,{position:e},{easing:"bounceOut"}).start()},e.prototype.updateAllBoxAccord=function(t){for(var e=!1,o=0;o<t.length;o++)if(t[o]!=this){var i=t[o];if(i.roleType==this.roleType&&i.level==this.level&&this.level<5){e=!0;break}}e?this.openBoxUpTips():this.closeBoxUpTips()},e.prototype.openBoxUpTips=function(){var t=this;this.isAccord=!0,clearInterval(this.animIndexID),this.animIndexID=null,cc.Tween.stopAllByTarget(this.roleIcon.node),cc.tween(this.roleIcon.node).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.1,{angle:10}).to(.2,{angle:-10}).to(.3,{angle:0}).start(),this.animIndexID=setInterval(function(){cc.tween(t.roleIcon.node).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.07,{angle:10}).to(.14,{angle:-10}).to(.2,{angle:0}).to(.1,{angle:10}).to(.2,{angle:-10}).to(.3,{angle:0}).start()},1420)},e.prototype.closeBoxUpTips=function(){this.isAccord&&this.roleIcon.node&&(cc.Tween.stopAllByTarget(this.roleIcon.node),cc.tween(this.roleIcon.node).to(.02,{angle:0}).start(),clearInterval(this.animIndexID),this.animIndexID=null),this.isAccord=!1},e.prototype.upRoleLevel=function(){this.level>=5||(this.level++,this.updateIconLevel())},e.prototype.updateIconLevel=function(){var t=this,e="roleBox/roleBox"+this.roleType+"_"+this.level;this.loadSpriteFrame(p.BKT_BundleName.Sprite,e,function(e){t.roleIcon.spriteFrame=e});var o="roleLevelIcon/jb_0"+this.level;this.loadSpriteFrame(p.BKT_BundleName.Sprite,o,function(e){t.levelIcon.spriteFrame=e})},e.prototype.die=function(){clearInterval(this.animIndexID),this.animIndexID=null,this.node.destroy()},c([f({type:cc.Enum(p.BKT_RoleType)})],e.prototype,"roleType",void 0),c([f(cc.Sprite)],e.prototype,"roleIcon",void 0),c([f(cc.Node)],e.prototype,"boxPos",void 0),c([f(cc.Sprite)],e.prototype,"levelIcon",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BKT_RoleBullet:[function(t,e,o){"use strict";cc._RF.push(e,"9e8dcCAclNIdqVAFgRBrSsC","BKT_RoleBullet");var i=t,n=e,a=o;cc._RF.push(n,"9e8dcCAclNIdqVAFgRBrSsC","BKT_RoleBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BKT_Config"),u=i("BKT_GameManager"),d=i("BKT_PoolMgr"),h=i("BKT_Enemy"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.boxCol=null,e.atkForce=0,e.moveSpeed=1e3,e.moveDir=cc.v2(0,1),e.atkList=[],e.criticalForce=0,e.criticalChance=0,e.dieTime=0,e.isDie=!1,e}return s(e,t),e.prototype.init=function(t,e,o,i,n){this.atkForce=e,this.criticalChance=i,this.criticalForce=n,this.icon.spriteFrame=u.default.Instance.getBulletImg(t),this.isDie=!1,this.moveDir=o},e.prototype.update=function(t){u.default.Instance.gameState!=p.BKT_GameState.pause&&(this.isDie||(this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t,this.checkCollisionEnemy(),this.dieTime+=t,this.dieTime>2&&this.die()))},e.prototype.checkCollisionEnemy=function(){var t=u.default.Instance.getCollisionBullet(this);if(t){var e=t.getComponent(h.default);if(e.getIsDie())return;var o=this.atkForce,i=Math.random()<this.criticalChance;i&&(o=this.atkForce*this.criticalForce),o=Math.floor(o),u.default.Instance.round(o),e.attackEd(o,i),this.die()}},e.prototype.die=function(){this.isDie=!0,this.moveDir=cc.v2(),this.atkList=[],this.dieTime=0,d.default.getInstance().PushObj(this.node)},c([g(cc.Sprite)],e.prototype,"icon",void 0),c([g(cc.Node)],e.prototype,"boxCol",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BKT_RoleField:[function(t,e,o){"use strict";cc._RF.push(e,"a3907rGiG5FnJwgeRPoXsbB","BKT_RoleField");var i=t,n=e,a=o;cc._RF.push(n,"a3907rGiG5FnJwgeRPoXsbB","BKT_RoleField");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("BKT_Config"),u=i("BKT_DataMgr"),d=i("BKT_GameEnumData"),h=i("BKT_GameManager"),f=i("BKT_PoolMgr"),m=i("BKT_RoleBase"),g=i("BKT_RoleBullet"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.qualityAnim=null,e.levelIcon=null,e.atkPos=null,e.skillsAnim=null,e.isSkillsAtkDouble=!1,e.skillsAtkDoubleTime=0,e.roleFieldScale=.67,e.isSkillRole=!1,e.skillRoleTime=0,e.mate=[],e.skillID=0,e.mateRate=0,e.isDie=!1,e.isPoolDie=!1,e.level=1,e.hp=0,e.bulletPath="",e.bulletTrajectory=1,e.bulletStepX=15,e.criticalForce=0,e.criticalChance=0,e.secondAtk=0,e.atkTarget=null,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.addEvent(p.BKT_EventName.SkillsAtkDouble,this.skillsAtkDouble),this.addEvent(p.BKT_EventName.WaveOver,this.waveOver)},e.prototype.init=function(t,e){var o=this;this.roleID=t,this.level=e,this.bulletPath=p.BKT_RoleAsePath[t].bullet;var i=p.BKT_RoleAsePath[t].path;this.roleFieldScale=h.default.Instance.roleFieldScale,this.loadResFromBundle(p.BKT_BundleName.SpAnim,i,sp.SkeletonData,function(t){o.spAnim.skeletonData=t,o.spAnim.setAnimation(0,p.BKT_AnimName.idle,!0),o.getAtkAnimSpeed(),o.setSpAnimPlaySpeed()}),this.isSkillsAtkDouble=!1,this.skillsAnim.node.active=!1,this.isDie=!1,this.isPoolDie=!1,this.updateAnimLevel(),this.updateProperty()},e.prototype.summonSkill=function(t){var e=this;this.node.setScale(-1,1),this.isSkillRole=!0,this.skillRoleTime=0,this.atkForce=t,this.atkInterval=u.default.getInstance().getParameterCfg(d.BKT_enumGearParameterCfg.duanyuAtkSpeed),this.isDie=!0,this.bulletPath="hero8_bullet1",cc.tween(this.node).to(.5,{position:cc.v3()}).call(function(){e.isDie=!1}).start()},e.prototype.waveOver=function(){var t=this;if(!this.isPoolDie)if(this.isSkillRole){this.node.setScale(1,1);var e=this.node.position;e.x+=400,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.5,{position:e}).call(function(){t.node.destroy()}).start()}else this.isSkillsAtkDouble=!1,this.skillsAnim.node.active=!1},e.prototype.skillsAtkDouble=function(){this.isPoolDie||(this.isSkillsAtkDouble=!0,this.skillsAtkDoubleTime=0,this.skillsAnim.node.active=!0,this.skillsAnim.setAnimation(0,p.BKT_AnimName.animation,!0))},e.prototype.setAtkStone=function(t){t?this.spAnim.node.setScale(1,1):this.spAnim.node.setScale(-1,1)},e.prototype.update=function(t){var e=this;if(h.default.Instance.gameState!=p.BKT_GameState.pause&&h.default.Instance.isfight&&!this.isDie&&(this.isSkillsAtkDouble&&(this.skillsAtkDoubleTime+=t,this.skillsAtkDoubleTime>15&&(this.isSkillsAtkDouble=!1,this.skillsAtkDoubleTime=0,this.skillsAnim.node.active=!1)),this.isAtkCooling?(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.isAtkCooling=!1)):this.isSkillRole?(this.attack(),this.isAtkCooling=!0):this.isPlayAtkAnim(),this.isSkillRole&&(this.skillRoleTime+=t,this.skillRoleTime>30))){this.skillRoleTime=0,this.isSkillRole=!1,this.isDie=!0,this.node.setScale(1,1);var o=this.node.position;o.x+=400,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.5,{position:o}).call(function(){e.node.destroy()}).start()}},e.prototype.isPlayAtkAnim=function(){if(this.atkTarget=h.default.Instance.getEnemyNear(this.node),this.atkTarget){this.isAtkCooling=!0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,p.BKT_AnimName.attack,!1),l.AudioMgr.getInstance().playEffectFree(p.BKT_AudioId.gongji);var t=this.node.convertToWorldSpaceAR(cc.v2(0,0)),e=this.atkTarget.convertToWorldSpaceAR(cc.v2(0,0));t.x>e.x?this.node.setScale(this.roleFieldScale,this.roleFieldScale):this.node.setScale(-this.roleFieldScale,this.roleFieldScale)}},e.prototype.attack=function(){var t=this;if(null==this.atkTarget&&(this.atkTarget=h.default.Instance.getEnemyNear(this.node)),null!=this.atkTarget){var e=this.atkForce;if(this.isSkillsAtkDouble&&(e=2*this.atkForce),this.atkTarget.parent){var o=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),i=this.atkTarget.convertToWorldSpaceAR(cc.v2(0,0)).sub(o).normalize(),n=180*Math.atan2(i.y,i.x)/Math.PI-90;this.atkTarget=null;for(var a=h.default.Instance.random(-15,15),r=function(o){f.default.getInstance().getObj("bullet/roleBullet",function(r){r.setParent(h.default.Instance.roleBulletBase);var s=t.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),c=t.bulletTrajectory,l=-t.bulletStepX*(c-1)/2+o*t.bulletStepX,p=i.x>0?l:-l;s.x+=p,s.y+=a;var u=r.parent.convertToNodeSpaceAR(s);r.setPosition(u),r.angle=n,r.getComponent(g.default).init(t.bulletPath,e,i,t.criticalChance,t.criticalForce)})},s=0;s<this.bulletTrajectory;s++)r(s)}}},e.prototype.upRoleLevel=function(){this.level>=5||(this.level++,this.updateAnimLevel(),this.updateProperty())},e.prototype.updateAnimLevel=function(){var t=this,e="roleLevelIcon/jb_0"+this.level;this.loadSpriteFrame(p.BKT_BundleName.Sprite,e,function(e){t.levelIcon.spriteFrame=e})},e.prototype.updateProperty=function(){var t=u.default.getInstance().getRoleInfo(this.level,this.roleID);this.hp=t.HP,this.atkForce=t.Atk,this.bulletTrajectory=t.Bullet,this.atkInterval=t.AtkSpeed,this.criticalChance=t.CriticPro,this.criticalForce=t.CriticProDamage,this.skillID=t.mate,this.secondAtk=t.BattleNumber,this.mateRate=t.MateRate,this.setSpAnimPlaySpeed()},e.prototype.die=function(){this.isPoolDie=!0,f.default.getInstance().PushObj(this.node)},c([_(sp.Skeleton)],e.prototype,"qualityAnim",void 0),c([_(cc.Sprite)],e.prototype,"levelIcon",void 0),c([_(cc.Node)],e.prototype,"atkPos",void 0),c([_(sp.Skeleton)],e.prototype,"skillsAnim",void 0),c([v],e)}(m.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BKT_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"4d1adJ04itIy6mjAiss9R0A","BKT_Skills");var i=t,n=e,a=o;cc._RF.push(n,"4d1adJ04itIy6mjAiss9R0A","BKT_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BKT_Config"),u=i("BKT_GameManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkForce=0,e.skillID=0,e.clipDuration=0,e.time=0,e.isDie=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==p.BKT_AnimName.animation&&t.node.destroy()}),this.spAnim.setEventListener(function(e,o){if(6!=t.skillID)switch(o.data.name){case p.BKT_AnimName.attack:case"hit":t.sendEvent(p.BKT_EventName.PlaySkillsAtk,t.skillID,t.atkForce)}}),this.addEvent(p.BKT_EventName.SetGameState,this.setGameState);var e=this.spAnim.findAnimation(p.BKT_AnimName.animation);this.clipDuration=.65*e.duration},e.prototype.update=function(t){u.default.Instance.gameState!=p.BKT_GameState.pause&&(this.isDie||6!=this.skillID&&4!=this.skillID||(this.time+=t,this.time>this.clipDuration&&(this.isDie=!0,this.time=0,this.sendEvent(p.BKT_EventName.PlaySkillsAtk,this.skillID,this.atkForce))))},e.prototype.init=function(t,e){var o=this;this.atkForce=t,this.skillID=e,this.isDie=!1,this.spAnim.setAnimation(0,p.BKT_AnimName.animation,!1),6==this.skillID&&(this.id=setTimeout(function(){o.sendEvent(p.BKT_EventName.PlaySkillsAtk,o.skillID,o.atkForce)},300))},e.prototype.setGameState=function(t){switch(t){case p.BKT_GameState.pause:this.spAnim.paused=!0;break;case p.BKT_GameState.playing:this.spAnim.paused=!1}},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearTimeout(this.id)},c([f(sp.Skeleton)],e.prototype,"spAnim",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BKT_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"34223VAOlVA3Ls1MHTwtHfn","BKT_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"34223VAOlVA3Ls1MHTwtHfn","BKT_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("BKT_Config"),d=i("BKT_DataMgr"),h=i("BKT_GameManager"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.btnAddRoleBox=null,e.btnPlaySkill=null,e.skillID=0,e.skillIDs=[7,8,9,10,11],e}return s(e,t),e.prototype.start=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.btnAddRoleBox.on(cc.Node.EventType.TOUCH_END,function(){h.default.Instance.updateRoleBoxSpare()},this),this.btnPlaySkill.on(cc.Node.EventType.TOUCH_END,function(){switch(t.skillIDs[t.skillID]){case 1:case 2:case 3:case 4:case 6:case 8:case 9:case 10:case 11:h.default.Instance.playSkillsAtk(t.skillIDs[t.skillID]);break;case 5:t.sendEvent(u.BKT_EventName.SkillsAtkDouble);break;case 7:h.default.Instance.playSkillsRole(t.skillIDs[t.skillID])}p.AudioMgr.getInstance().playEffectFree(d.default.getInstance().getSkillsCfg(t.skillIDs[t.skillID]).mateSound),t.sendEvent(u.BKT_EventName.PlaySkillBanner,t.skillIDs[t.skillID]),t.skillID++,t.skillID>=t.skillIDs.length&&(t.skillID=1)},this)},c([g(cc.Node)],e.prototype,"btnClose",void 0),c([g(cc.Node)],e.prototype,"btnAddRoleBox",void 0),c([g(cc.Node)],e.prototype,"btnPlaySkill",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],BKT_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"24545k/Vm1Bl7fPZ90k2GQj","BKT_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"24545k/Vm1Bl7fPZ90k2GQj","BKT_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BKT_APP"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.win=null,e.fail=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this),this.win.active=this.isWin,this.fail.active=!this.isWin},c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"win",void 0),c([h(cc.Node)],e.prototype,"fail",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BKT_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"38072iBLE5BjaQPRywacYxM","BKT_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"38072iBLE5BjaQPRywacYxM","BKT_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.BKT_MateSkills=void 0;var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("SdkMgr"),h=i("BKT_Config"),f=i("BKT_DataMgr"),m=i("BKT_GameManager"),g=i("BKT_Btn_Skills"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnPause=null,e.lockTips=null,e.txtLevel=null,e.levelBar=null,e.skillBtnsBase=null,e.btn_Skills=null,e.playSkillTips=null,e.toolTips=null,e.mateSillks=null,e.sillkLayout=null,e.keyInfo=null,e.mateKeyNumInfo=[],e.activateSkills=[],e.isSkillTipsUnder=!1,e.skillTipsQueue=[],e}return s(e,t),e.prototype.start=function(){var t=this;(d.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR)&&this.lockTips.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.BKT_UIID.BKT_UIGM)},this),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.BKT_UIID.BKT_UIPause),m.default.Instance.setGameState(h.BKT_GameState.pause)},this),this.skillBtnsBase.opacity=0,this.initMateSkillsList(),this.addEvent(h.BKT_EventName.UpdateWaveUI,this.updateWaveUI),this.addEvent(h.BKT_EventName.UpdateWaveBarUI,this.updateWaveBarUI),this.addEvent(h.BKT_EventName.ActivateSkills,this.onSkillAdded),this.addEvent(h.BKT_EventName.PlaySkillBanner,this.playSkillBanner),this.addEvent(h.BKT_EventName.PlayGame,this.playGame),this.addEvent(h.BKT_EventName.WaveOver,this.waveOver),this.addEvent(h.BKT_EventName.PlayTips,this.playTips),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),clearTimeout(this.playTipsID),clearTimeout(this.playAddSkillTipsID)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.space:this.openUI(h.BKT_UIID.BKT_UIPause),m.default.Instance.setGameState(h.BKT_GameState.pause)}},e.prototype.initMateSkillsList=function(){for(var t=function(t,o){var i=Number(t);if(null==e.mateKeyNumInfo[i]){var n=cc.instantiate(e.keyInfo);n.setParent(e.sillkLayout),n.active=!0;var a="skillsBtnIcon/"+f.default.getInstance().getSkillsCfg(i).mateIconRes;e.loadSpriteFrame(h.BKT_BundleName.Sprite,a,function(t){n.getChildByName("skillsIcon").getComponent(cc.Sprite).spriteFrame=t});var r=n.getChildByName("roleIcon1"),s=n.getChildByName("roleIcon2"),c="skillsRoleIcon/"+o.id1;e.loadSpriteFrame(h.BKT_BundleName.Sprite,c,function(t){r.getComponent(cc.Sprite).spriteFrame=t}),c="skillsRoleIcon/"+o.id2,e.loadSpriteFrame(h.BKT_BundleName.Sprite,c,function(t){s.getComponent(cc.Sprite).spriteFrame=t}),r.color=cc.Color.GRAY,s.color=cc.Color.GRAY,n.getChildByName("skillsIcon").color=cc.Color.GRAY,e.mateKeyNumInfo[i]={node:n}}},e=this,o=0,i=Object.entries(a.BKT_MateSkills);o<i.length;o++){var n=i[o];t(n[0],n[1])}},e.prototype.onSkillAdded=function(t,e,o){for(var i=0,n=Object.entries(this.mateKeyNumInfo);i<n.length;i++){var r=n[i],s=r[0];if(P=r[1]){for(var c=Number(s),l=P.node.children,p=0,u=l;p<u.length;p++)u[p].color=cc.Color.GRAY;if(e.includes(a.BKT_MateSkills[c].id1)&&e.includes(a.BKT_MateSkills[c].id2))for(var d=0,h=l;d<h.length;d++)h[d].color=cc.Color.WHITE;else(e.includes(a.BKT_MateSkills[c].id1)||e.includes(a.BKT_MateSkills[c].id2))&&(e.includes(a.BKT_MateSkills[c].id1)&&(P.node.getChildByName("roleIcon1").color=cc.Color.WHITE),e.includes(a.BKT_MateSkills[c].id2)&&(P.node.getChildByName("roleIcon2").color=cc.Color.WHITE))}}for(var f=0,m=t;f<m.length;f++){var y=m[f];if(null==this.activateSkills[y]){var v=cc.instantiate(this.btn_Skills);v.setParent(this.skillBtnsBase),v.active=!0,this.activateSkills[y]=v.getComponent(g.default),this.activateSkills[y].init(y,o[y]),this.skillTipsQueue.push(y)}else this.activateSkills[y].isDie?(this.activateSkills[y].isDie=!1,this.activateSkills[y].node.active=!0,this.activateSkills[y].updateLevel(o[y])):this.activateSkills[y].updateLevel(o[y])}this.playAddSkillTips();for(var _=[],b=0,B=Object.entries(this.activateSkills);b<B.length;b++){var I=B[b],P=(s=I[0],I[1]),C=Number(s);t.includes(C)||_.push(C)}for(var D=0,T=_;D<T.length;D++)c=T[D],this.activateSkills[c].isDie=!0,this.activateSkills[c].node.active=!1},e.prototype.playGame=function(){var t=this.mateSillks.position.clone();t.x-=320,cc.Tween.stopAllByTarget(this.mateSillks),cc.tween(this.mateSillks).to(.2,{position:t}).start(),cc.Tween.stopAllByTarget(this.skillBtnsBase),cc.tween(this.skillBtnsBase).to(.2,{opacity:255}).start()},e.prototype.waveOver=function(){var t=this.mateSillks.position.clone();t.x+=320,cc.Tween.stopAllByTarget(this.mateSillks),cc.tween(this.mateSillks).to(.2,{position:t}).start(),cc.Tween.stopAllByTarget(this.skillBtnsBase),cc.tween(this.skillBtnsBase).to(.2,{opacity:0}).start()},e.prototype.playAddSkillTips=function(){var t=this;if(0!=this.skillTipsQueue.length&&!this.isSkillTipsUnder){var e=this.skillTipsQueue.shift();this.isSkillTipsUnder=!0;var o=cc.instantiate(this.toolTips);o.setParent(this.toolTips.parent),o.active=!0,o.getChildByName("tipsName").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(e).mateName,o.getChildByName("info").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(e).introduce;var i="skillsBtnIcon/"+f.default.getInstance().getSkillsCfg(e).mateIconRes;this.loadSpriteFrame(h.BKT_BundleName.Sprite,i,function(t){o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),o.setScale(0),cc.tween(o).to(.2,{scale:1}).start(),o.setPosition(0,400),clearTimeout(this.playAddSkillTipsID),this.playAddSkillTipsID=setTimeout(function(){t.node.active&&t.skillTipsQueue.length>0&&t.playAddSkillTips(),t.isSkillTipsUnder=!1;var e=o.position.clone();e.y+=300,cc.tween(o).to(.4,{position:e}).call(function(){o.destroy()}).start()},2100)}},e.prototype.playSkillBanner=function(t){var e=this,o=cc.instantiate(this.toolTips);o.setParent(this.toolTips.parent),o.active=!0,o.getChildByName("tipsName").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).mateName,o.getChildByName("info").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).introduce;var i="skillsBtnIcon/"+f.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(h.BKT_BundleName.Sprite,i,function(t){o.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),o.setScale(0),cc.tween(o).to(.2,{scale:1}).start(),o.setPosition(0,470),setTimeout(function(){e.isSkillTipsUnder=!1,e.playAddSkillTips();var t=o.position.clone();t.y+=300,cc.tween(o).to(.4,{position:t}).call(function(){o.destroy()}).start()},2100)},e.prototype.playTips=function(t){var e=this,o=cc.instantiate(this.toolTips);o.setParent(this.toolTips.parent),o.active=!0,o.getChildByName("tipsName").active=!1,o.getChildByName("icon").active=!1;var i=o.getChildByName("info");i.getComponent(cc.Label).string=t,i.setPosition(cc.v2(0,i.y)),cc.tween(o).to(.2,{scale:1}).start(),o.setPosition(0,470),clearTimeout(this.playTipsID),this.playTipsID=setTimeout(function(){e.isSkillTipsUnder=!1,e.playAddSkillTips();var t=o.position.clone();t.y+=300,cc.tween(o).to(.4,{position:t}).call(function(){o.destroy()}).start()},1300)},e.prototype.updateWaveUI=function(t){this.txtLevel.string="\u7b2c"+t+"/20\u6ce2"},e.prototype.updateWaveBarUI=function(t,e){var o=t/e;cc.Tween.stopAllByTarget(this.levelBar),cc.tween(this.levelBar).to(.1,{progress:o}).start()},c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"lockTips",void 0),c([_(cc.Label)],e.prototype,"txtLevel",void 0),c([_(cc.ProgressBar)],e.prototype,"levelBar",void 0),c([_(cc.Node)],e.prototype,"skillBtnsBase",void 0),c([_(cc.Node)],e.prototype,"btn_Skills",void 0),c([_(cc.Node)],e.prototype,"playSkillTips",void 0),c([_(cc.Node)],e.prototype,"toolTips",void 0),c([_(cc.Node)],e.prototype,"mateSillks",void 0),c([_(cc.Node)],e.prototype,"sillkLayout",void 0),c([_(cc.Node)],e.prototype,"keyInfo",void 0),c([v],e)}(p.default);a.default=b,a.BKT_MateSkills={7:{id1:6,id2:10},8:{id1:3,id2:11},9:{id1:1,id2:7},10:{id1:4,id2:5},11:{id1:8,id2:17}},cc._RF.pop(),cc._RF.pop()},{}],BKT_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"a85c8cPmZxAyISoygBaV0Dk","BKT_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"a85c8cPmZxAyISoygBaV0Dk","BKT_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BKT_APP"),u=i("BKT_Config"),d=i("BKT_GameManager"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),d.default.Instance.setGameState(u.BKT_GameState.playing)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0),t.closeUI()},this)},c([m(cc.Node)],e.prototype,"btnResume",void 0),c([m(cc.Node)],e.prototype,"btnClose",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BTYGameData:[function(t,e,o){"use strict";cc._RF.push(e,"0d0e4owZUlKebWPalEvH/9R","BTYGameData");var i=e,n=o;cc._RF.push(i,"0d0e4owZUlKebWPalEvH/9R","BTYGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emBTYGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffTypeCfg="buffTypeCfg",t.carCfg="carCfg",t.characterCfg="characterCfg",t.enemyCfg="enemyCfg",t.levelCfg="levelCfg",t.mateCfg="mateCfg",t.wordsCfg="wordsCfg"}(n.emBTYGameDataKeys||(n.emBTYGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],BTYGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"ae7b1KR2HZMb5c9TiEWr+ql","BTYGameEnumData");var i=e,n=o;cc._RF.push(i,"ae7b1KR2HZMb5c9TiEWr+ql","BTYGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.enemyMove=15]="enemyMove",t[t.wallHp=16]="wallHp",t[t.wordsTime=17]="wordsTime",t[t.wordShow=18]="wordShow",t[t.dieWordDistance=19]="dieWordDistance"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],BTY_App:[function(t,e,o){"use strict";cc._RF.push(e,"efbbcdZ4jBPJ5cilHqtnQp1","BTY_App");var i=t,n=e,a=o;cc._RF.push(n,"efbbcdZ4jBPJ5cilHqtnQp1","BTY_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("BTY_Configs"),p=i("BTY_DataMgr"),u=i("BTY_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),l.Global.isDirect=o,this.addTouchEvent(),this._exitCall=e;var n=function(){i._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.BTY_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.BTY_AudioId.bgm,l.BTYConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.BTY_UICF),r.AudioMgr.getInstance().addAdConf(l.BTY_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){n()})}))},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.BTY_UIID.UIGame),s.UIMgr.getInstance().closeById(l.BTY_UIID.UIResult),s.UIMgr.getInstance().closeById(l.BTY_UIID.UISetting),l.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],BTY_BeautyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e7b2a01r1JE85AqtjL3qFSA","BTY_BeautyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e7b2a01r1JE85AqtjL3qFSA","BTY_BeautyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseUI"),u=i("AudioMgr"),d=i("BTY_Configs"),h=i("BTYGameEnumData"),f=i("BTY_DataMgr"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.banner=null,e.label=null,e.text="hello",e.isDangerous=!1,e.gapTime=0,e.nowGapTime=0,e.showTime=0,e.state="idle",e}var o;return s(e,t),o=e,e.prototype.showBanner=function(t){var e=this;this.banner.active=!0,this.label.string=t,this.unschedule(this.hideBanner),this.scheduleOnce(function(){e.state==l.die&&e.openUI(d.BTY_UIID.UIResult),e.hideBanner()},this.showTime)},e.prototype.hideBanner=function(){this.banner.active=!1},e.prototype.doDangerous=function(){this.state=l.dangerous,this.showBanner(this.getStr().wordContent)},e.prototype.beIdle=function(){this.state=l.idle},e.prototype.doIdle=function(t){this.nowGapTime-=t,this.nowGapTime<=0&&(this.nowGapTime=this.gapTime,this.showBanner(this.getStr().wordContent))},e.prototype.doDie=function(){this.state=l.die,this.sendEvent(d.emBTYEventName.pause),u.AudioMgr.getInstance().playEffect(d.BTY_AudioId.girlDie),d.Global.gameOver||(this.showBanner(this.getStr().wordContent),d.Global.gameOver=!0)},e.prototype.getStr=function(){var t=f.default.getInstance().getWordCfg();return this.state==l.idle?t[Math.floor(4*Math.random())]:this.state==l.dangerous?t[4]:this.state==l.die?t[5]:void 0},e.prototype.onLoad=function(){o.script=this,this.showTime=f.default.getInstance().getParam(h.enumBasicParaCfg.wordsTime),this.nowGapTime=this.showTime,this.gapTime=f.default.getInstance().getParam(h.enumBasicParaCfg.wordShow)},e.prototype.start=function(){},e.prototype.update=function(t){this.state==l.idle&&this.doIdle(t)},c([y(cc.Node)],e.prototype,"banner",void 0),c([y(cc.Label)],e.prototype,"label",void 0),c([y],e.prototype,"text",void 0),o=c([g],e)}(p.default);a.default=v,function(t){t.idle="idle",t.dangerous="dangerous",t.die="die"}(l||(l={})),cc._RF.pop(),cc._RF.pop()},{}],BTY_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"faa8egpkgNFl4esrLhViE5T","BTY_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"faa8egpkgNFl4esrLhViE5T","BTY_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Utils"),u=i("BTY_Configs"),d=function(t,e){this.flag=t,this.num=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useState=!1,e.bloodArr=[],e.limitTime=3,e.showNum=10,e}return s(e,t),e.prototype.isCirt=function(t,e){t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e+""):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e+""),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=p.Utils.randomRang(-30,30),o=p.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){l.PoolMgr.getInstance().freeNode(u.poolName.blood,t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.x=0,this.node.y=0,this.node.opacity=255},e.prototype.inUse=function(){return this.useState},e.prototype.pushBlood=function(t,e){var o=new d(t,e);this.bloodArr.push(o)},e.prototype.showBlood=function(){for(var t=this.bloodArr.splice(0,this.showNum),e=0;e<t.length;e++){var o=t[e];this.isCirt(o.flag,o.num)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){(this.nowTime<0||!this.nowTime)&&(this.nowTime=this.limitTime,this.showBlood()),this.nowTime--},e.prototype.onDestroy=function(){this.bloodArr=[]},c([m(cc.Node)],e.prototype,"isCritState",void 0),c([m(cc.Label)],e.prototype,"critLabel",void 0),c([m(cc.Label)],e.prototype,"commonLabel",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BTY_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"85a15Z3T/tAqYW27KpQPyOg","BTY_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"85a15Z3T/tAqYW27KpQPyOg","BTY_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("BTY_Configs"),d=i("BTYGameEnumData"),h=i("BTY_DataMgr"),f=i("BTY_UIGame"),m=i("BTY_Hero"),g=i("BTY_HeroCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.nodeObj1=new b,e.nodeObj2=new b,e.lock=!0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(t){this.node.active=!1;var e=h.default.getInstance().getLevelCfgByID(t);if(e){if(e.buffType)if(1==e.buffType){var o=this.getResult(),i=this.getResult(),n=this.getPropertyResultArr(o,i,e);(0==o||1==o||2==o)&&this.initPropertyNode(o,n[0],this.node1,this.nodeObj1),(0==i||1==i||2==i)&&this.initPropertyNode(i,n[1],this.node2,this.nodeObj2)}else if(2==e.buffType){if(0==(o=this.getResult())){var a=this.getPropertyResult(e.buff1,o);this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)}else 1==o?(a=this.getPropertyResult(e.buff2?e.buff2:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)):2==o&&(a=this.getPropertyResult(e.buff3?e.buff3:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1));var r=this.getNewRole();this.initNewNode(r[0],this.node2,this.nodeObj2)}else r=this.getNewRole(2),this.initNewNode(r[0],this.node1,this.nodeObj1),this.initNewNode(r[1],this.node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=u.Global.heroID.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getResult=function(){return Math.floor(Math.random()*u.Global.heroID.length)},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t));if(u.Global.heroID[e].node.getComponent(m.default).getAttackSpeedState())for(var i=0;i<o.length;i++)if(o[i].includes("speed")){o.splice(i,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=h.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);for(var i in u.Global.heroID){var n=o.indexOf(u.Global.heroID[i].id);-1!=n&&o.splice(n,1)}for(var a=Object.keys(o),r=[];t--;)i=Math.floor(Math.random()*a.length),r.push(o[a[i]]),a.splice(i,1);return r},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=u.Global.heroID[t].id;this.loadSpriteFrame(u.emBTYBundles.imgs,"js_b/tx_"+a,function(r){n.initPropertyView(o,r,e,a),n.lock=!1,n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=h.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=u.Global.heroID[t].node,c.buffType==u.emBTYBuffType.speedPlus?i.type=1:c.buffType==u.emBTYBuffType.ATKmul||c.buffType==u.emBTYBuffType.ATKplus?i.type=2:c.buffType==u.emBTYBuffType.penetratePlus?i.type=3:c.buffType==u.emBTYBuffType.bulletPlus?i.type=4:c.buffType==u.emBTYBuffType.critPlus?i.type=5:c.buffType==u.emBTYBuffType.skillMul&&(i.type=6)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=h.default.getInstance().getCharacterByID(i).characterName,p=h.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon");this.loadSpriteFrame(u.emBTYBundles.imgs,"js_b/tx_"+t,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.lock=!1,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=h.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffectFree(u.BTY_AudioId.buff),g.default.script.checkCollider()?this.nodeObj1.isNew?g.default.script.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?g.default.script.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.destroy()},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;1==o?e.getComponent(m.default).addAttackSpeed(t.addType,t.addNum):2==o?e.getComponent(m.default).addAttackPower(t.addType,t.addNum):3==o?e.getComponent(m.default).addAttackPenerate(t.addType,t.addNum):4==o?e.getComponent(m.default).addBulletCount(t.addType,t.addNum):5==o?e.getComponent(m.default).addCritChance(t.addType,t.addNum):6==o&&e.getComponent(m.default).addSkill(t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){o.script=this,this.addEvent(u.emBTYEventName.pause,this.stop),this.addEvent(u.emBTYEventName.resume,this.resume)},e.prototype.stop=function(){this.lock=!0},e.prototype.resume=function(){this.lock=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.lock||(this.node.y-=h.default.getInstance().getParam(d.enumBasicParaCfg.buffMove)*t*100,f.default.script.checkReWardLayer(this.node.y)&&this.doReward())},c([_(cc.Node)],e.prototype,"node1",void 0),c([_(cc.Node)],e.prototype,"node2",void 0),c([_(cc.SpriteFrame)],e.prototype,"sp",void 0),o=c([v],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],BTY_Bullet2:[function(t,e,o){"use strict";cc._RF.push(e,"886b6DRB4pP2L6lFw32rVPt","BTY_Bullet2");var i=t,n=e,a=o;cc._RF.push(n,"886b6DRB4pP2L6lFw32rVPt","BTY_Bullet2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("BTY_Configs"),d=i("BTY_enemyCtrl"),h=function(t,e,o){this.damage=t,this.isCrit=e,this.pos=o};a.damageObj=h;var f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDestory=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e}return s(e,t),e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,h){void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===h&&(h=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDestory=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.initNodeView(a,r,s),this.createNeedCheckY()},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=d.default.script.getEnemyPosY(this.node.getPosition())-this.node.y-100},e.prototype.update=function(t){if(this.active&&!this.isDestory){var e=this.flySpeed*t*100;if(this.node.y+=e,this.range-=e,this.needCheckY-=e,this.range<=0&&this.removeNode(),this.needCheckY<=0){var o=this.hit(),i=d.default.script.checkCollider(this.node.getPosition(),o.damage,o.isCrit,this.lastAttackID);if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(u.emBTYEventName.GAD_Show_Hit_Effect,n),this.lastAttackID=i,this.onDie()}}}},e.prototype.hit=function(){return this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new h(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition())},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDestory=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)p.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start()},e.prototype.render=function(){},e.prototype.stop=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BTY_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"dc790dhPmhHk6E3X1y/Re8W","BTY_BulletEffect");var i=e,n=o;cc._RF.push(i,"dc790dhPmhHk6E3X1y/Re8W","BTY_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.show()},e.prototype.hide=function(){this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.node.active=!1,t.resetSystem()})},e.prototype.show=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],BTY_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"a61e8PNgvhEGINi5Em/dCJU","BTY_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"a61e8PNgvhEGINi5Em/dCJU","BTY_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.emBTYHitState=l.poolName=l.emBTYBuffType=l.emBTYGameState=l.emBTYRoleState=l.emBTYRoleType=l.emBTYEventName=l.BTY_AudioCF=l.BTY_AudioId=l.BTY_UICF=l.BTYConfig=l.emBTYBundles=l.BTY_UIID=void 0,function(t){t.UIGame="BTY_UIGame",t.UIResult="BTY_UIResult",t.UISetting="BTY_UISetting"}(a=l.BTY_UIID||(l.BTY_UIID={})),function(t){t.prefabs="bty_prefabs",t.audios="bty_audios",t.imgs="bty_imgs",t.configs="bty_configs",t.configsB="bty_configsB"}(r=l.emBTYBundles||(l.emBTYBundles={})),l.BTYConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.BTY_UICF=((i={})[a.UIGame]={prefab:"ui/BTY_UIGame",name:"BTY_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/BTY_UIResult",name:"BTY_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/BTY_UISetting",name:"BTY_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.doubleSword="doubleSword",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.btygonHit="btygonHit",t.rake="rake",t.typhoon="typhoon",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.carBack="carBack",t.carDie="carDie",t.carHit="carHit",t.enemyAttack="enemyAttack",t.enemyDie="enemyDie",t.enemyHit="enemyHit",t.girlDie="girlDie"}(s=l.BTY_AudioId||(l.BTY_AudioId={})),l.BTY_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.btygonHit]={path:"btygonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.carBack]={path:"carBack",bundle:r.audios},n[s.carDie]={path:"carDie",bundle:r.audios},n[s.carHit]={path:"carHit",bundle:r.audios},n[s.enemyAttack]={path:"enemyAttack",bundle:r.audios},n[s.enemyDie]={path:"enemyDie",bundle:r.audios},n[s.enemyHit]={path:"enemyHit",bundle:r.audios},n[s.girlDie]={path:"girlDie",bundle:r.audios},n),function(t){t.GAD_Player_Die="bty_gad_player_die",t.GAD_Shoot_Bullet="bty_gad_shoot_bullet",t.GAD_Show_Hit_Text="bty_gad_show_hit_text",t.GAD_Show_Warn="bty_gad_show_warn",t.GAD_Bubble_Buf="bty_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="bty_gad_hit_effect",t.GAD_Show_Buff_Tip="bty_gad_show_buff_tip",t.GAD_Setting_Back="bty_gad_setting_back",t.pause="bty_pause",t.resume="bty_resume",t.skillPause="bty_skillPause",t.skillResume="bty_skillResume",t.buff="bty_buff",t.blood="bty_blood",t.newTarm="bty_newTarm",t.wallBlood="bty_wallBlood"}(l.emBTYEventName||(l.emBTYEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emBTYRoleType||(l.emBTYRoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emBTYRoleState||(l.emBTYRoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emBTYGameState||(l.emBTYGameState={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emBTYBuffType||(l.emBTYBuffType={})),function(t){t.blood="bty_blood",t.destroy="bty_destroy",t.effect="bty_effect",t.box="bty_box",t.body="bty_body",t.bty_item="bty_item",t.bty_bullet="bty_bullet"}(l.poolName||(l.poolName={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emBTYHitState||(l.emBTYHitState={}));var p=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t.gameOver=!1,t}();l.Global=p,cc._RF.pop(),cc._RF.pop()},{}],BTY_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"31de0hoy/lIuIL1y8OqXO3D","BTY_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"31de0hoy/lIuIL1y8OqXO3D","BTY_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("BTY_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}e?i?c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"qiujiayu/BraveTower/configsB",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emBTYBundles.configsB,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()}):i?c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"qiujiayu/beauty/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emBTYBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getEnemyByType=function(t){var e=this.data.enemyCfg;for(var o in e)if(e[o].id==t)return e[o]},t.prototype.getCarByRound=function(t){var e=this.data.carCfg;for(var o in e)if(e[o].roundCar==t)return e[o]},t.prototype.getCarCfgLength=function(){return this.data.carCfg.length},t.prototype.getWordCfg=function(){return this.data.wordsCfg},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BTY_EnemyVehicle:[function(t,e,o){"use strict";cc._RF.push(e,"bb4de98XqdMsYRZLBd+nQ+d","BTY_EnemyVehicle");var i=t,n=e,a=o;cc._RF.push(n,"bb4de98XqdMsYRZLBd+nQ+d","BTY_EnemyVehicle");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseUI"),u=i("AudioMgr"),d=i("Utils"),h=i("BTY_Configs"),f=i("BTYGameEnumData"),m=i("BTY_DataMgr"),g=i("BTY_UIGame"),y=i("BTY_BeautyCtrl"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpProgress=null,e.lblHp=null,e.ndCollider=null,e.nowhp=0,e.maxhp=0,e.attack=0,e.moveSpeed=0,e.moveDistance=0,e.isDangerous=!1,e}return s(e,t),e.prototype.initNode=function(t,e){this.monsterID=e,this.round=t,this.state=l.move,this.refreshParam()},e.prototype.refreshParam=function(){var t=m.default.getInstance().getCarByRound(this.round);this.round>m.default.getInstance().getCarCfgLength()?this.checkWin():(this.moveSpeed=t.moveSpeed,this.maxhp=t.HpCar,this.nowhp=this.maxhp,this.lblHp.string=this.nowhp+"",this.stepback=t.stepback)},e.prototype.checkCollider=function(t,e,o,i){return this.state!=l.die&&i!=this.monsterID&&!!this.isInRange(t)&&(this.handleDamage(e,t,o),u.AudioMgr.getInstance().playEffect(h.BTY_AudioId.carHit),!0)},e.prototype.checkSkillCollider=function(t,e){this.state!=l.die&&t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.handleDamage=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=!1);var i=t;this.nowhp-=i,performance.now(),this.doDamage(t,this.getPos(e),o),this.lblHp.string=this.nowhp+"",this.nowhp<=0&&(this.round++,this.refreshParam(),g.default.script.onScreenShake(),u.AudioMgr.getInstance().playEffect(h.BTY_AudioId.carBack),this.state=l.beAttack)},e.prototype.getPos=function(t){var e=d.Utils.randomRang(-30,30),o=d.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(h.emBTYEventName.blood,t,e,o,i)},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.checkLose=function(){this.judgeDistance()&&y.default.script.doDie()},e.prototype.checkWin=function(){this.sendEvent(h.emBTYEventName.pause),h.Global.gameOver||(this.openUI(h.BTY_UIID.UIResult,!0),h.Global.gameOver=!0),u.AudioMgr.getInstance().playEffect(h.BTY_AudioId.carDie),this.hpProgress.node.active=!1,this.state=l.die},e.prototype.doBeAttack=function(){var t=this;this.state=l.idle,cc.tween(this.node).to(1,{position:cc.v3(this.node.x,this.node.y+this.stepback,0)},{easing:"sineOut"}).call(function(){t.state=l.move}).start()},e.prototype.contrlBeauty=function(){this.isDangerous&&!this.inDangerous()?(this.isDangerous=!1,y.default.script.beIdle()):!this.isDangerous&&this.inDangerous()&&(this.isDangerous=!0,y.default.script.doDangerous())},e.prototype.inDangerous=function(){return this.dangerousLength||(this.dangerousLength=m.default.getInstance().getParam(f.enumBasicParaCfg.dieWordDistance)),this.judgeDistance(this.dangerousLength)},e.prototype.judgeDistance=function(t){return void 0===t&&(t=0),this.node.y<g.default.script.getBeatyY()+130+t},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.state==l.move?(this.node.y-=this.moveSpeed*t,this.checkLose(),this.contrlBeauty()):this.state==l.beAttack&&this.doBeAttack()},c([b(cc.Sprite)],e.prototype,"hpProgress",void 0),c([b(cc.Label)],e.prototype,"lblHp",void 0),c([b(cc.Node)],e.prototype,"ndCollider",void 0),c([_],e)}(p.default);a.default=B,function(t){t.move="move",t.attack="attack",t.die="die",t.beAttack="beAttack",t.idle="idle"}(l||(l={})),cc._RF.pop(),cc._RF.pop()},{}],BTY_Enemy:[function(t,e,o){"use strict";cc._RF.push(e,"f8a89+hKuVNq66qqOfaH/72","BTY_Enemy");var i=t,n=e,a=o;cc._RF.push(n,"f8a89+hKuVNq66qqOfaH/72","BTY_Enemy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseUI"),u=i("AudioMgr"),d=i("Utils"),h=i("BTY_Configs"),f=i("BTYGameEnumData"),m=i("BTY_DataMgr"),g=i("BTY_UIGame"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ske_die=null,e.ske_stu=null,e.ani=null,e.ndShadow=null,e.spIcon=null,e.bubble=null,e.lblHP=null,e.ndCollider=null,e.spArr=[],e.hp=0,e.attack=0,e.moveSpeed=0,e.moveDistance=0,e}return s(e,t),e.prototype.initNode=function(t,e,o){this.monsterID=o;var i=t.split(","),n=Number(i[0]),a=Number(i[1]);this.round=e;var r=m.default.getInstance().getEnemyByType(n);this.initParam(r,a),this.initView(r,n),i.length>=3?this.bubble.active=!0:this.bubble.active=!1},e.prototype.initParam=function(t,e){this.hp=e,this.attack=t.atk,this.moveSpeed=m.default.getInstance().getParam(f.enumBasicParaCfg.enemyMove),this.moveDistance=cc.winSize.height/2-g.default.script.getWallPosY()},e.prototype.initView=function(t,e){var o=t.size,i=t.shadowSize;this.spIcon.node.scale=o,this.ndShadow.scale=i,this.lblHP.node.y=t.HPheight,this.bubble.y=this.lblHP.node.y+85,this.lblHP.string=this.hp+"",this.ani.play("pbt_enemy_move"),this.state=l.move,this.spIcon.spriteFrame=this.spArr[e]},e.prototype.checkCollider=function(t,e,o,i){return this.state!=l.die&&i!=this.monsterID&&!!this.isInRange(t)&&(this.handleDamage(e,t,o),u.AudioMgr.getInstance().playEffect(h.BTY_AudioId.enemyHit),!0)},e.prototype.checkSkillCollider=function(t,e){this.state!=l.die&&t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.ndCollider.parent.convertToWorldSpaceAR(this.ndCollider.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.handleDamage=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=!1);var i=t;this.hp-=i,performance.now(),this.doDamage(t,this.getPos(e),o),this.hp<=0&&this.doDie()},e.prototype.getPos=function(t){var e=d.Utils.randomRang(-30,30),o=d.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(h.emBTYEventName.blood,t,e,o,i),this.lblHP.string=Math.max(this.hp,0).toString()},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.doAttack=function(){var t=this;this.state==l.move&&(this.sendEvent(h.emBTYEventName.GAD_Show_Warn),this.state=l.attack,this.ani.play("pbt_enemy_attack"),this.lblHP.node.active=!1,this.ndCollider.active=!1,this.ndShadow.active=!1,this.sendEvent(h.emBTYEventName.wallBlood,this.attack),g.default.script.onScreenShake(),this.spIcon.node.runAction(cc.fadeOut(.2)),this.scheduleOnce(function(){t.node.destroy()},.2),this.state=l.die)},e.prototype.doDie=function(){var t=this;this.lblHP.node.active=!1,this.ske_die.node.active=!0,this.ndCollider.active=!1,this.bubble.active&&(this.bubble.active=!1,this.sendEvent(h.emBTYEventName.buff,this.round)),u.AudioMgr.getInstance().playEffect(h.BTY_AudioId.enemyDie),this.ske_die.setAnimation(0,Math.random()<.5?"animation":"animation2",!1),this.ske_die.setCompleteListener(function(){t.node.destroy()}),this.ndShadow.active=!1,this.spIcon.node.runAction(cc.fadeOut(.2)),this.state=l.die},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.state==l.move&&(this.node.y-=this.moveSpeed*t,this.moveDistance-=this.moveSpeed*t,this.moveDistance<=0&&this.doAttack())},c([_(sp.Skeleton)],e.prototype,"ske_die",void 0),c([_(sp.Skeleton)],e.prototype,"ske_stu",void 0),c([_(cc.Animation)],e.prototype,"ani",void 0),c([_(cc.Node)],e.prototype,"ndShadow",void 0),c([_(cc.Sprite)],e.prototype,"spIcon",void 0),c([_(cc.Node)],e.prototype,"bubble",void 0),c([_(cc.Label)],e.prototype,"lblHP",void 0),c([_(cc.Node)],e.prototype,"ndCollider",void 0),c([_(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([v],e)}(p.default);a.default=b,function(t){t.move="move",t.attack="attack",t.die="die",t.idle="idle"}(l||(l={})),cc._RF.pop(),cc._RF.pop()},{}],BTY_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f49363JvGdI0LeGydYiFOP0","BTY_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f49363JvGdI0LeGydYiFOP0","BTY_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BTY_Configs"),u=i("BTY_Hero"),d=i("BTY_Target"),h=i("BTY_TarmCtrl"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t,e){this.id=t,this.node=e},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;o.script=this,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.heroRoot.x+=o})},e.prototype.heroMove=function(t){this.heroRoot.x+=t},e.prototype.test=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPower(1,1e3);else if("speed"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackSpeed(1,4);else if("penerate"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPenerate(1,1);else if("skill"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addskillInterval(1,5)}else this.addHero(Number(e))},e.prototype.addHero=function(t){var e=this;if(p.Global.heroID.length>=3)console.error("\u4e0d\u5141\u8bb8\u52a0\u5165\u8d85\u8fc7\u4e09\u4e2a\u82f1\u96c4");else{p.Global.heroID||(p.Global.heroID=[]),this.node.getComponent(h.default).pushCard(t);var o=cc.instantiate(this.heorNode);o.active=!0,o.parent=this.node;var i=new y(t,o);p.Global.heroID.push(i),o.getComponent(u.default).initHero(t),this.scheduleOnce(function(){e.checkOverSide()},.01)}},e.prototype.clearHero=function(){p.Global.heroID=[]},e.prototype.getMaxDamage=function(t,e){var o=0;for(var i in p.Global.heroID)p.Global.heroID[i].id!=t&&p.Global.heroID[i].id!=e||(o=Math.max(p.Global.heroID[i].node.getComponent(u.default).getAttackPower(),o));return o},e.prototype.checkOverSide=function(){this.heroRoot.x+this.node.width/2>cc.winSize.width/2?this.heroRoot.x=cc.winSize.width/2-this.node.width/2:this.heroRoot.x-this.node.width/2<-cc.winSize.width/2&&(this.heroRoot.x=-cc.winSize.width/2+this.node.width/2)},e.prototype.checkCollider=function(){return this.node.x<0},e.prototype.start=function(){},e.prototype.createTarget=function(){new d.Target(100)},c([g(cc.Node)],e.prototype,"heroRoot",void 0),c([g(cc.Node)],e.prototype,"heorNode",void 0),o=c([m],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],BTY_Hero:[function(t,e,o){"use strict";cc._RF.push(e,"33cabavEaBEsKvNT4dOGHBg","BTY_Hero");var i=t,n=e,a=o;cc._RF.push(n,"33cabavEaBEsKvNT4dOGHBg","BTY_Hero");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("BTY_Configs"),h=i("BTYGameEnumData"),f=i("BTY_DataMgr"),m=i("BTY_UIGame"),g=i("BTY_Bullet2"),y=i("BTY_BulletEffect"),v=i("BTY_SkillCtrl"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.firing=!1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.bullets=[],e.skillTimer=0,e.skillMultiplier=0,e.attackGap=1,e.maxSpeed=12,e.noInFactSpeed=5,e.lastFireTime=0,e.fireCooldown=.5,e}return s(e,t),e.prototype.initHero=function(t){this.initParm(t),this.initView(t),this.heroIndex=t,this.addEvent(d.emBTYEventName.pause,this.doPause),this.addEvent(d.emBTYEventName.resume,this.doResume)},e.prototype.initParm=function(t){1==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.basicATK):2==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.secondCharATK):3==d.Global.heroID.length&&(this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.thirdCharATK)),this.attackSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.basicASPD),this.bulletCount=f.default.getInstance().getParam(h.enumBasicParaCfg.basicBullet),this.penetrate=f.default.getInstance().getParam(h.enumBasicParaCfg.basicPenetrate),this.flySpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.bulletFlySpeed),this.critChance=f.default.getInstance().getParam(h.enumBasicParaCfg.basicCrit),this.critMultiplier=f.default.getInstance().getParam(h.enumBasicParaCfg.critDamage);var e=f.default.getInstance().getCharacterByID(t);this.skillInterval=e.skillCDtime,this.skillMultiplier=e.skillATK,this.skillEffect=e.skillSound},e.prototype.initView=function(t){var e=this;this.loadPrefab(d.emBTYBundles.prefabs,"bullets/BTY_Bullet_"+t,function(o){e.poolName="bullet"+t,u.PoolMgr.getInstance().creatrePool(e.poolName,cc.instantiate(o)),e.bulletPrefab=o,e.startFiring()});var o=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emBTYBundles.imgs,"backs/"+o.cardColor,function(t){e.itemBg.spriteFrame=t}),this.loadSpriteFrame(d.emBTYBundles.imgs,"js/js_"+t,function(t){e.itemIcon.spriteFrame=t}),this.loadSpriteFrame(d.emBTYBundles.imgs,"skill/"+o.skillIcon,function(t){e.itemSkill.spriteFrame=t}),this.loadPrefab(d.emBTYBundles.prefabs,"skills/CardSkill"+t,function(o){e.heroSkill=cc.instantiate(o),11==t&&e.loadPrefab(d.emBTYBundles.prefabs,"skills/CardSkill"+t,function(){})}),this.itemName.string=o.characterName},e.prototype.startFiring=function(){this.firing=!0},e.prototype.stopFiring=function(){this.firing=!1},e.prototype.useSkill=function(){var t=m.default.script.getSkillLayer(),e=this.bulletPos.getPosition(),o=this.bulletPos.convertToWorldSpaceAR(e);return e=t.convertToNodeSpaceAR(o),v.default.script.useSkill(this.heroIndex,this.attackPower*this.skillMultiplier,this.heroSkill,e)},e.prototype.addAttackPower=function(t,e){this.addBuffTween(),1==t?this.attackPower+=e:this.attackPower*=e},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.addAttackSpeed=function(t,e){this.addBuffTween(),this.attackSpeedMultiplier+=e/f.default.getInstance().getParam(h.enumBasicParaCfg.speedPlusTimes)},e.prototype.getAttackSpeedState=function(){return this.attackSpeedMultiplier>=this.maxSpeed},e.prototype.addAttackPenerate=function(t,e){this.addBuffTween(),1==t?this.penetrate+=e:this.penetrate*=e},e.prototype.addskillInterval=function(t,e){this.addBuffTween(),1==t?this.penetrate-=e:this.penetrate/=e},e.prototype.addCritChance=function(t,e){this.addBuffTween(),1==t?this.critChance+=e:this.critChance*=e},e.prototype.addSkill=function(t,e){this.addBuffTween(),1==t?this.skillMultiplier+=e:this.skillMultiplier*=e},e.prototype.addBulletCount=function(t,e){this.addBuffTween(),1==t?this.bulletCount+=e:this.bulletCount*=e},e.prototype.addBuffTween=function(){var t=this;this.addBuffSp.opacity=255,this.addBuffSp.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.addBuffSp.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.addBuffSp.opacity=0},.1)})},e.prototype.showAttack=function(){console.log(this.getAttackSpeed()*this.attackPower)},e.prototype.getAttackSpeed=function(){return this.attackSpeed/this.attackSpeedMultiplier},e.prototype.updateSkillView=function(){this.skillPercent.fillRange=this.skillTimer/this.skillInterval},e.prototype.update=function(t){var e=this;this.firing&&(this.nowAttackTime+=t,this.skillTimer+=t,this.updateSkillView(),this.skillTimer>=this.skillInterval&&this.useSkill()&&(this.skillSp.opacity=255,p.AudioMgr.getInstance().playEffect(this.skillEffect,this.skillEffect),this.skillSp.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.skillSp.getComponent(sp.Skeleton).setCompleteListener(function(){e.scheduleOnce(function(){e.skillSp.opacity=0},.1)}),this.skillTimer=0),this.attackGap-=t,this.nowAttackTime-this.lastAttackTime>this.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime,this.attackGap=1))},e.prototype.fireBullets=function(){var t=performance.now()/1e3;t-this.lastFireTime>=this.fireCooldown&&(p.AudioMgr.getInstance().playEffectFree(d.BTY_AudioId.bullet),this.lastFireTime=t);var e=m.default.script.getBulletLayer(this.heroIndex),o=this.bulletPos.getPosition();this.creatInfactBullet(e,o)},e.prototype.creatInfactBullet=function(t,e){for(var o=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,i=0;i<this.bulletCount;i++){var n=new cc.Vec2(e.x-o,e.y);o+=30;var a=this.bulletPos.convertToWorldSpaceAR(n);n=t.convertToNodeSpaceAR(a);var r=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab);(u.PoolMgr.getInstance().getNode(d.poolName.bty_bullet)||cc.instantiate(this.bullet)).getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,n,r,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier)}},e.prototype.creatNoInfactBullet=function(t,e){for(var o=[],i=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,n=0;n<this.bulletCount;n++){var a=new cc.Vec2(0-i,0);i+=30,o.push(a)}var r=u.PoolMgr.getInstance().getNode(d.poolName.bty_bullet)||cc.instantiate(this.bullet),s=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab),c=this.bulletPos.convertToWorldSpaceAR(e),l=t.convertToNodeSpaceAR(c);r.getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,l,s,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier,this.bulletCount,o)},e.prototype.pushBullet=function(t){t.getComponent(y.default).hide(),this.bullets.push(t)},e.prototype.doPause=function(){this.stopFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).stop()},e.prototype.doResume=function(){this.startFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).resume()},c([B(cc.Prefab)],e.prototype,"bullet",void 0),c([B(cc.Node)],e.prototype,"bulletPos",void 0),c([B(cc.Node)],e.prototype,"skillSp",void 0),c([B(cc.Node)],e.prototype,"addBuffSp",void 0),c([B(cc.Label)],e.prototype,"itemName",void 0),c([B(cc.Sprite)],e.prototype,"itemBg",void 0),c([B(cc.Sprite)],e.prototype,"itemIcon",void 0),c([B(cc.Sprite)],e.prototype,"itemSkill",void 0),c([B(cc.Sprite)],e.prototype,"skillPercent",void 0),c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],BTY_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"5ea2f1vs9lE0pX419Xh76LG","BTY_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"5ea2f1vs9lE0pX419Xh76LG","BTY_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("BTY_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],BTY_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"88c793+4rhD+5XCWSEEwDr7","BTY_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"88c793+4rhD+5XCWSEEwDr7","BTY_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BTY_Configs"),u=i("BTY_Skill"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){return!this.isSkill&&(this.isSkill=!0,this.showBanner(t),o.parent=this.node,o.getComponent(u.default).useSkill(i,e,t),!0)},e.prototype.showBanner=function(t){var e=this;this.loadSpriteFrame(p.emBTYBundles.imgs,"banner/banner"+t,function(t){e.banner.getComponent(cc.Sprite).spriteFrame=t,e.banner.active=!0}),cc.tween(this.banner).by(.5,{x:this.banner.width}).delay(.5).by(.5,{x:-this.banner.width}).call(function(){e.isSkill=!1,e.banner.active=!1}).start()},e.prototype.onLoad=function(){o.script=this,this.banner.x=-cc.winSize.width/2-this.banner.width/2},e.prototype.start=function(){},e.prototype.update=function(){},c([f(cc.Label)],e.prototype,"label",void 0),c([f(cc.Node)],e.prototype,"banner",void 0),c([f],e.prototype,"text",void 0),o=c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],BTY_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"7dc2fHx6QZIc4tdBdl2jXpe","BTY_Skill");var i=t,n=e,a=o;cc._RF.push(n,"7dc2fHx6QZIc4tdBdl2jXpe","BTY_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BTY_enemyCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e.range=1500,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){"attack"==o.data.name&&(t.animationDuration=e.animation.duration)})},e.prototype.useSkill=function(t,e,o){var i=this;if(this.index=o,this.skillSpeed=this.speed,this.range=1500,1==o){this.canMove=!1,this.node.setPosition(0,l.default.script.getEnemyPosY(t)-300),this.spAni.setAnimation(0,"hit",!1);var n=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){i.doAttack()},n-.65),this.offHeight=300}else 6==o?(this.canMove=!1,this.node.setPosition(t.x,l.default.script.getEnemyPosY(t)),this.spAni.setAnimation(0,"hit",!1),n=this.spAni.getCurrent(0).animation.duration,this.scheduleOnce(function(){i.doAttack()},n-.6)):8==o?(this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)):11==o?(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!1),this.sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)):(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0));this.damage=e,this.flyDis=l.default.script.getEnemyPosY(t)-this.node.y},e.prototype.update=function(t){var e=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed*t*85,this.flyDis-=this.skillSpeed*t*85,this.range-=this.skillSpeed*t*85,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){e.sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),e.sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.spAni.setAnimation(0,"hit",!1),this.doAttack()))},e.prototype.doAttack=function(){l.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([d({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([d({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([d({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],BTY_Target:[function(t,e,o){"use strict";cc._RF.push(e,"185c1tyIJpPG54i6kbMwbZV","BTY_Target");var i=e,n=o;cc._RF.push(i,"185c1tyIJpPG54i6kbMwbZV","BTY_Target"),Object.defineProperty(n,"__esModule",{value:!0}),n.Target=void 0;var a=function(){function t(t){this.health=t}return t.prototype.takeDamage=function(t){this.health-=t,console.log("Target takes "+t+" damage! Remaining health: "+this.health),this.health<=0&&this.destroy()},t.prototype.destroy=function(){console.log("Target destroyed!")},t}();n.Target=a,cc._RF.pop(),cc._RF.pop()},{}],BTY_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"36eefw5qJtNjLXas0q7K0jU","BTY_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"36eefw5qJtNjLXas0q7K0jU","BTY_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("BTY_Configs"),u=i("BTY_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tarmMap=new Map,e.isTureTarmMap=new Map,e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.sendEvent(p.emBTYEventName.newTarm,e[0],this.delayTime),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BTY_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"487d5/vpQlHHb4H+6yyxYq7","BTY_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"487d5/vpQlHHb4H+6yyxYq7","BTY_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("UIMgr"),h=i("Config"),f=i("BTY_Configs"),m=i("BTY_BloodCtrl"),g=i("BTY_BuffCtrl"),y=i("BTY_mateCtrl"),v=i("BTYGameEnumData"),_=i("BTY_DataMgr"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.buffLayer=null,e.bloodLayer=null,e.hitLayer=null,e.blood=null,e.pauseLayer=null,e.closeNode=null,e.skillLayer=null,e.banner=null,e.bannerSp=[],e.maxLength=50,e.hpIndex=0,e.hpArr=[],e.hpProgress=null,e.tipPools=[],e.maxEffect=20,e.maxShowCount=50,e.lastShowTime=0,e.throttleTime=.2,e}return s(e,t),e.prototype.onLoad=function(){u.PoolMgr.getInstance().creatrePool(f.poolName.effect,this.hitEffect,5),u.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2),this.createHpArr(this.maxLength),this.maxHp=_.default.getInstance().getParam(v.enumBasicParaCfg.wallHp),this.nowHp=this.maxHp,this.hpProgress.fillRange=this.nowHp/this.maxHp,this.initSystemListen(),this.ndWarn.opacity=0},e.prototype.createHpArr=function(t){for(;t--;){var e=u.PoolMgr.getInstance().getNode(f.poolName.blood)||cc.instantiate(this.blood);this.hpArr.push(e)}},e.prototype.initSystemListen=function(){var t=this;f.Global.isDirect||cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){t.pauseLayer&&e.keyCode==cc.macro.KEY.space&&(t.pauseLayer.active?(t.pauseLayer.active=!1,t.sendEvent(f.emBTYEventName.resume)):(t.pauseLayer.active=!0,t.sendEvent(f.emBTYEventName.pause)))})},e.prototype.start=function(){var t=this;this.addEvent(f.emBTYEventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(f.emBTYEventName.GAD_Show_Warn,this.playWarn),this.addEvent(f.emBTYEventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(f.emBTYEventName.buff,this.showBuff),this.addEvent(f.emBTYEventName.blood,this.showLoseLabel),this.addEvent(f.emBTYEventName.newTarm,this.showNewTarm),this.addEvent(f.emBTYEventName.wallBlood,this.loseWallBlood),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(f.emBTYEventName.pause),f.Global.isDirect?d.UIMgr.getInstance().openUI(f.BTY_UIID.UISetting,h.UIID.UINONE,function(e){e&&t.sendEvent(f.emBTYEventName.resume)}):t.pauseLayer.active=!0}),this.pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active&&(t.sendEvent(f.emBTYEventName.resume),t.pauseLayer.active=!1)}),this.closeNode.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active=!1,d.UIMgr.getInstance().openUI(f.BTY_UIID.UISetting,h.UIID.UINONE,function(e){e&&t.sendEvent(f.emBTYEventName.resume)})})},e.prototype.onShowHitText=function(t,e){var o,i=this;(o=this.tipPools.length>0?this.tipPools.pop():cc.instantiate(this.ndTipRoot.children[0])).parent=this.ndTipRoot,o.active=!0,o.getComponent(cc.Label).string=(t>0?"+":"")+t,o.color=t>0?cc.color().fromHEX("#0bff16"):cc.color().fromHEX("#ff4e49");var n=this.ndTipRoot.convertToNodeSpaceAR(cc.v2(e.x,e.y));o.setPosition(n.x,n.y),o.opacity=255,cc.tween(o).by(.3,{y:80}).to(.1,{opacity:0}).call(function(){o.removeFromParent(),i.tipPools.push(o)}).start()},e.prototype.playWarn=function(){var t=this;this.ndWarn.active||(cc.Tween.stopAllByTarget(this.ndWarn),p.AudioMgr.getInstance().playEffect(f.BTY_AudioId.enemyAttack),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.2,{opacity:255}).to(.2,{opacity:0}).call(function(){t.ndWarn.active=!1}).start())},e.prototype.showHitEffect=function(t){if(!(this.hitLayer.children.length>=this.maxEffect)){var e=this.node.convertToNodeSpaceAR(t),o=u.PoolMgr.getInstance().getNode(f.poolName.effect)||cc.instantiate(this.hitEffect);o.parent=this.hitLayer,o.setPosition(e),o.active=!0,o.opacity=255,o.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.active=!1,u.PoolMgr.getInstance().freeNode("pbt_hit_effect",o)})}},e.prototype.showBuff=function(t){var e=this;this.loadPrefab(f.emBTYBundles.prefabs,"item/buff",function(o){var i=cc.instantiate(o);i.parent=e.buffLayer,i.getComponent(g.default).initNode(t)})},e.prototype.loseWallBlood=function(t){this.nowHp-=t,this.hpProgress.fillRange=this.nowHp/this.maxHp,this.nowHp<=0&&!f.Global.gameOver&&(this.sendEvent(f.emBTYEventName.pause),d.UIMgr.getInstance().openUI(f.BTY_UIID.UIResult,-1),f.Global.gameOver=!0)},e.prototype.showLoseLabel=function(t,e,o,i){if(void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),!(this.bloodLayer.children.length>=this.maxShowCount)||i){var n=cc.director.getTotalTime();if(!(n-this.lastShowTime<this.throttleTime)||i){this.lastShowTime=n;var a=u.PoolMgr.getInstance().getNode(f.poolName.blood);a.parent||(a.parent=this.bloodLayer);var r=a.getComponent(m.default);r.resumeNode(),a.setPosition(e.x,e.y+40),r.isCirt(o,t)}}},e.prototype.showNewTarm=function(t,e){var o=this;this.loadPrefab(f.emBTYBundles.prefabs,"item/mateIcon",function(e){var i=cc.instantiate(e);i.parent=o.skillLayer,i.getComponent(y.default).initNode(t)}),this.showBanner(t,e)},e.prototype.showBanner=function(t,e){var o=this;this.banner.getComponent(cc.Sprite).spriteFrame=this.bannerSp[t],cc.tween(this.banner).by(e/2,{x:this.banner.width}).delay(e/2).call(function(){o.banner.x=-cc.winSize.width/2-o.banner.width/2}).start()},c([I(cc.Node)],e.prototype,"ndTipRoot",void 0),c([I(cc.Node)],e.prototype,"ndWarn",void 0),c([I(cc.Node)],e.prototype,"btnPause",void 0),c([I(cc.Node)],e.prototype,"hitEffect",void 0),c([I(cc.Node)],e.prototype,"ndBuffImg",void 0),c([I(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([I(cc.Sprite)],e.prototype,"spBack",void 0),c([I(cc.Node)],e.prototype,"buffLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"hitLayer",void 0),c([I(cc.Node)],e.prototype,"blood",void 0),c([I(cc.Node)],e.prototype,"pauseLayer",void 0),c([I(cc.Node)],e.prototype,"closeNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"banner",void 0),c([I(cc.SpriteFrame)],e.prototype,"bannerSp",void 0),c([I(cc.Sprite)],e.prototype,"hpProgress",void 0),c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BTY_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"1777ctsIMJIzIu4E0VgI2+5","BTY_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"1777ctsIMJIzIu4E0VgI2+5","BTY_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("AudioMgr"),d=i("BTY_HeroCtrl"),h=i("BTY_Configs"),f=i("BTY_DataMgr"),m=i("BTYGameEnumData"),g=i("BTY_enemyCtrl"),y=i("SdkMgr"),v=i("PlatformSetting"),_=i("BasePlatform"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.sprBgSup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.heroRoot=null,e.ndFence=null,e.content=null,e.item=null,e.bulletLayer=null,e.rewardLayer=null,e.bloodLayer=null,e.destroyLayer=null,e.startNode=null,e.skillLayer=null,e.dieLayer=null,e.enemyCtrl=null,e.beautyNode=null,e.gmNode=null,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){h.Global.canAttack=!1,h.Global.bulletID=0,h.Global.gameOver=!1,o.script=this,this.createNodePool(),this.doStart()},e.prototype.doStart=function(){var t=this;u.AudioMgr.getInstance().playEffectFree(h.BTY_AudioId.mission),this.startNode.active=!0,this.startNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1);var e=this.ndCardGroup.getComponent(d.default);e.clearHero(),e.addHero(this.getNewRole()),this.enemyCtrl.startCreate(),this.startNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.startNode.active=!1},.1)})},e.prototype.setGmNode=function(){(y.SdkMgr.getInstance().getCheckVersion(v.SwitchID.ShenHe_ABD)||v.PlatformSetting.currentPlatform==_.Platform.EDITOR||v.PlatformSetting.currentPlatform==_.Platform.WEB_LINK)&&(this.gmNode.active=!0)},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=f.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);return o[Math.floor(Math.random()*o.length)]},e.prototype.getWallPosY=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.y},e.prototype.getWallPos=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.getPosition()},e.prototype.getBeatyY=function(){return this.beautyNode.getComponent(cc.Widget).updateAlignment(),this.beautyNode.y},e.prototype.start=function(){this.initEvents()},e.prototype.createNodePool=function(){this.loadPrefab(h.emBTYBundles.prefabs,"item/blood",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.blood,e)}),this.loadPrefab(h.emBTYBundles.prefabs,"item/destroy",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.destroy,e)}),this.loadPrefab(h.emBTYBundles.prefabs,"item/bty_item",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.bty_item,e)}),this.loadPrefab(h.emBTYBundles.prefabs,"item/bty_bullet",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.bty_bullet,e)})},e.prototype.initEvents=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.ndCardGroup.getComponent(d.default).heroMove(o)})},e.prototype.getBulletLayer=function(t){var e="layer"+t;return this.bulletLayer.getChildByName(e)},e.prototype.getAllBullet=function(){var t=[];for(var e in this.bulletLayer.children)for(var o in this.bulletLayer.children[e].children)t.push(this.bulletLayer.children[e].children[o])},e.prototype.getDestroyLayer=function(){return this.destroyLayer},e.prototype.getSkillLayer=function(){return this.skillLayer},e.prototype.checkReWardLayer=function(t){return this.rewardLayer.y>t},e.prototype.addHero=function(){},e.prototype.update=function(){},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.sprBgSup);var t=f.default.getInstance().getParam(m.enumBasicParaCfg.quake);cc.tween(this.sprBgSup).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-1*t,-1*t)}).by(.05,{position:cc.v3(2*t,1*t)}).by(.05,{position:cc.v3(-2*t,0*t)}).by(.05,{position:cc.v3(2*t,-1*t)}).by(.05,{position:cc.v3(-1*t,1*t)}).set({position:cc.v3(0,0)}).start()},c([I(cc.Node)],e.prototype,"ndCardGroup",void 0),c([I(cc.Node)],e.prototype,"sprBgSup",void 0),c([I(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([I(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([I(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([I(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([I(cc.Node)],e.prototype,"heroRoot",void 0),c([I(cc.Node)],e.prototype,"ndFence",void 0),c([I(cc.Node)],e.prototype,"content",void 0),c([I(cc.Node)],e.prototype,"item",void 0),c([I(cc.Node)],e.prototype,"bulletLayer",void 0),c([I(cc.Node)],e.prototype,"rewardLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"destroyLayer",void 0),c([I(cc.Node)],e.prototype,"startNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"dieLayer",void 0),c([I(g.default)],e.prototype,"enemyCtrl",void 0),c([I(cc.Node)],e.prototype,"beautyNode",void 0),c([I(cc.Node)],e.prototype,"gmNode",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],BTY_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"e0584rl67VEmqxbfYLXCUee","BTY_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"e0584rl67VEmqxbfYLXCUee","BTY_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BTY_App"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e.isDirect=null,e.unDirect=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([h(cc.Label)],e.prototype,"lblBar",void 0),c([h(cc.Sprite)],e.prototype,"spBar",void 0),c([h(cc.Node)],e.prototype,"ndWin",void 0),c([h(cc.Node)],e.prototype,"ndFail",void 0),c([h(cc.Node)],e.prototype,"ndTop",void 0),c([h(cc.Node)],e.prototype,"ndBar",void 0),c([h(cc.Node)],e.prototype,"btn",void 0),c([h(cc.Node)],e.prototype,"btnPlay",void 0),c([h(cc.Label)],e.prototype,"lblRwd",void 0),c([h(cc.Node)],e.prototype,"isDirect",void 0),c([h(cc.Node)],e.prototype,"unDirect",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BTY_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"02321dC8TpCuoaqDNmpT1ex","BTY_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"02321dC8TpCuoaqDNmpT1ex","BTY_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("BTY_Configs"),d=i("BTY_App"),h=i("BTY_UIGame"),f=i("SdkMgr"),m=i("PlatformSetting"),g=i("BasePlatform"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e.gmButton=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t,this.isDirect.active=u.Global.isDirect,this.unDirect.active=!u.Global.isDirect},e.prototype.onEnable=function(){this.musicSlider.progress=p.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=p.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),p.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){(f.SdkMgr.getInstance().getCheckVersion(m.SwitchID.ShenHe_ABD)||m.PlatformSetting.currentPlatform==g.Platform.EDITOR||m.PlatformSetting.currentPlatform==g.Platform.WEB_LINK)&&h.default.script.setGmNode()}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),p.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){d.default.instance.exit_App(0)}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([_(cc.Slider)],e.prototype,"musicSlider",void 0),c([_(cc.Slider)],e.prototype,"effectSlider",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([_(cc.Node)],e.prototype,"btnBackHome",void 0),c([_(cc.Node)],e.prototype,"isDirect",void 0),c([_(cc.Node)],e.prototype,"unDirect",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Node)],e.prototype,"gmNode",void 0),c([_(cc.Node)],e.prototype,"gmButton",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],BTY_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"2a8acHcArlA25L+8p0dt2Lg","BTY_UserData");var i=t,n=e,a=o;cc._RF.push(n,"2a8acHcArlA25L+8p0dt2Lg","BTY_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"bty_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],BTY_enemyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"36a396k5nhO+JaemBSXeuPp","BTY_enemyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"36a396k5nhO+JaemBSXeuPp","BTY_enemyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BTY_Configs"),u=i("BTYGameEnumData"),d=i("BTY_DataMgr"),h=i("BTY_Enemy"),f=i("BTY_EnemyVehicle"),m=function(t,e){this.node=t,this.idx=e},g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemy=null,e.vehicle=null,e.createDistance=0,e.nowLevel=1,e.isPause=!0,e.enemyMove=0,e.posArr=[],e.enemyList1=[],e.enemyList2=[],e.enemyList3=[],e.monsterID=99999,e.vehicleID=0,e.skillPause=!1,e.leftLimit=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.script=this,this.initPosArr(),this.enemyMove=d.default.getInstance().getParam(u.enumBasicParaCfg.enemyMove),this.initVehicle(),this.addEvent(p.emBTYEventName.pause,this.pause),this.addEvent(p.emBTYEventName.resume,this.resume),this.addEvent(p.emBTYEventName.skillPause,this.doSkillPause),this.addEvent(p.emBTYEventName.skillResume,this.doSkillResume)},e.prototype.initVehicle=function(){this.vehicleID=this.monsterID,this.vehicle.getComponent(f.default).initNode(1,this.monsterID--),this.vehicle.y=cc.winSize.height/2},e.prototype.initPosArr=function(){var t=cc.winSize.height/2;this.leftLimit=50;for(var e=-1;e<=1;e++){var o=130*e-180;this.posArr.push(new cc.Vec2(o,t))}},e.prototype.startCreate=function(){this.isPause=!1},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.doSkillPause=function(){this.skillPause=!0},e.prototype.doSkillResume=function(){this.skillPause=!1},e.prototype.createEnemy=function(){if(this.createDistance<=0){var t=d.default.getInstance().getLevelCfgByID(this.nowLevel);this.createDistance=t.roundDistance,t.position1&&this.createByPos(t.position1,t.round,0),t.position2&&this.createByPos(t.position2,t.round,1),t.position3&&this.createByPos(t.position3,t.round,2),this.nowLevel++}},e.prototype.createByPos=function(t,e,o){var i=cc.instantiate(this.enemy);i.parent=this.node;var n=new m(i,this.monsterID);i.zIndex=this.monsterID-9e4,i.getComponent(h.default).initNode(t,e,this.monsterID--),i.setPosition(this.posArr[o]),0==o?this.enemyList1.push(n):1==o?this.enemyList2.push(n):2==o&&this.enemyList3.push(n)},e.prototype.doEnemyMove=function(t){this.createDistance-=this.enemyMove*t,this.enemyList1.forEach(function(e){cc.isValid(e.node)&&e.node.getComponent(h.default).onUpdate(t)}),this.enemyList2.forEach(function(e){cc.isValid(e.node)&&e.node.getComponent(h.default).onUpdate(t)}),this.enemyList3.forEach(function(e){cc.isValid(e.node)&&e.node.getComponent(h.default).onUpdate(t)}),cc.isValid(this.vehicle)&&this.vehicle.getComponent(f.default).onUpdate(t)},e.prototype.getEnemyPosY=function(t){if(t.x>=this.leftLimit)return this.vehicle.y;var e=this.getEnemyList(t);for(var o in e){var i=e[o];if(cc.isValid(i.node))return i.node.y}},e.prototype.getAllFirstY=function(){var t=this.vehicle.y;for(var e in this.enemyList1)if(cc.isValid(this.enemyList1[e].node)){this.enemyList1[e].node.y<t&&(t=this.enemyList1[e].node.y);break}for(var e in this.enemyList2)if(cc.isValid(this.enemyList2[e].node)){this.enemyList2[e].node.y<t&&(t=this.enemyList2[e].node.y);break}for(var e in this.enemyList3)if(cc.isValid(this.enemyList3[e].node)){this.enemyList3[e].node.y<t&&(t=this.enemyList3[e].node.y);break}return t},e.prototype.checkCollider=function(t,e,o,i){if(t.x>=this.leftLimit){if(cc.isValid(this.vehicle)&&this.vehicle.getComponent(f.default).checkCollider(t,e,o,i))return this.vehicleID}else{var n=this.getEnemyList(t);for(var a in n){var r=n[a];if(cc.isValid(r.node)&&r.node.getComponent(h.default).checkCollider(t,e,o,i))return r.idx}}return-1},e.prototype.checkSkillCollider=function(t,e){this.enemyList1.forEach(function(o){cc.isValid(o.node)&&o.node.getComponent(h.default).checkSkillCollider(t,e)}),this.enemyList2.forEach(function(o){cc.isValid(o.node)&&o.node.getComponent(h.default).checkSkillCollider(t,e)}),this.enemyList3.forEach(function(o){cc.isValid(o.node)&&o.node.getComponent(h.default).checkSkillCollider(t,e)}),cc.isValid(this.vehicle)&&this.vehicle.getComponent(f.default).checkSkillCollider(t,e)},e.prototype.getEnemyList=function(t){var e=9999,o=Math.abs(t.x-this.posArr[0].x),i=Math.abs(t.x-this.posArr[1].x),n=Math.abs(t.x-this.posArr[2].x);return e=Math.min(o,e),e=Math.min(i,e),o==(e=Math.min(n,e))?this.enemyList1:i==e?this.enemyList2:n==e?this.enemyList3:[]},e.prototype.start=function(){},e.prototype.update=function(t){this.isPause||this.skillPause||(this.createEnemy(t),this.doEnemyMove(t))},e.prototype.onDestroy=function(){this.enemyList1=[],this.enemyList2=[],this.enemyList3=[]},c([v(cc.Prefab)],e.prototype,"enemy",void 0),c([v(cc.Node)],e.prototype,"vehicle",void 0),o=c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],BTY_mateCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"04a590pPzFOB5VDF2923Mg3","BTY_mateCtrl");var i=t,n=e,a=o;cc._RF.push(n,"04a590pPzFOB5VDF2923Mg3","BTY_mateCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Config"),u=i("BTY_Configs"),d=i("BTY_DataMgr"),h=i("BTY_HeroCtrl"),f=i("BTY_mateSkillCtrl"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e.maxCDTime=0,e.cdTime=0,e.mateSkillAttack=1,e.mateID=1,e.isPause=!1,e}return s(e,t),e.prototype.initNode=function(t){this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=this,e=d.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=e.mateCDtime,this.mateSkillAttack=e.mateSkillATK,this.loadPrefab(u.emBTYBundles.prefabs,"skills/mateSkill"+this.mateID,function(e){t.skillNode=cc.instantiate(e)})},e.prototype.initView=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID);this.skillLabel.string=t.mateName,this.cdPercent.fillRange=0,this.skillIcon.spriteFrame=this.getSpriteByName(),this.cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){if(this.cdTime<=0){var t=d.default.getInstance().getMateCfgByID(this.mateID),e=Number(t.mateRole.split(",")[0]),o=Number(t.mateRole.split(",")[1]);f.default.script.useSkill(this.mateID,h.default.script.getMaxDamage(e,o)*t.mateSkillATK,this.skillNode,new cc.Vec2(0,0))&&this.initStartUseSkill()}else this.openUI(p.UIID.UITips,"\u6280\u80fd\u6b63\u5728cd")},e.prototype.initStartUseSkill=function(){this.cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.cdLabel.string=this.cdTime+"",this.cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.cdLabel.node.active=!1,this.spNode.node.active=!0,this.spNode.setAnimation(0,"animation",!1),this.spNode.setCompleteListener(function(){e.spNode.node.active=!1})):this.cdLabel.string=this.cdTime.toFixed(0)},e.prototype.getSpriteByName=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID).mateIconRes;for(var e in this.spArr)if(t==this.spArr[e].name)return this.spArr[e]},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.onLoad=function(){this.addEvent(u.emBTYEventName.pause,this.pause),this.addEvent(u.emBTYEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.cdTime>0&&!this.isPause&&this.refreshSkillView(t)},c([y(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([y(cc.Label)],e.prototype,"cdLabel",void 0),c([y(cc.Label)],e.prototype,"skillLabel",void 0),c([y(cc.Sprite)],e.prototype,"cdPercent",void 0),c([y(cc.Sprite)],e.prototype,"skillIcon",void 0),c([y(sp.Skeleton)],e.prototype,"spNode",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],BTY_mateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"7877cI9tQVBNpf3sFqpOx64","BTY_mateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"7877cI9tQVBNpf3sFqpOx64","BTY_mateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BTY_mateSkill"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){var n=this;return!this.isSkill&&(this.isSkill=!0,this.scheduleOnce(function(){n.isSkill=!1},.5),o.parent=this.node,o.getComponent(p.default).useSkill(i,e,t),!0)},e.prototype.onLoad=function(){o.script=this},e.prototype.start=function(){},e.prototype.update=function(){},c([h(cc.Label)],e.prototype,"label",void 0),c([h(cc.Node)],e.prototype,"banner",void 0),c([h],e.prototype,"text",void 0),o=c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BTY_mateSkill:[function(t,e,o){"use strict";cc._RF.push(e,"1a04flW349HpajTwPfEtvIA","BTY_mateSkill");var i=t,n=e,a=o;cc._RF.push(n,"1a04flW349HpajTwPfEtvIA","BTY_mateSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("BTY_Configs"),d=i("BTY_DataMgr"),h=i("BTY_enemyCtrl"),f=i("BTY_Hero"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){if("attack"==o.data.name){var i=d.default.getInstance().getMateCfgByID(t.index);if(3==t.index)p.EventMgr.getInstance().emit(u.emBTYEventName.skillPause),t.scheduleOnce(function(){p.EventMgr.getInstance().emit(u.emBTYEventName.skillResume)},Number(i.matePara));else if(1==t.index)for(var n in u.Global.heroID)1!=u.Global.heroID[n].id&&7!=u.Global.heroID[n].id||u.Global.heroID[n].node.getComponent(f.default).addAttackSpeed(1,Number(i.matePara));t.doAttack()}})},e.prototype.useSkill=function(t,e,o){var i=d.default.getInstance().getMateCfgByID(o);l.AudioMgr.getInstance().playEffect(i.mateSound),this.index=o,this.spAni.setAnimation(0,"animation",!1),this.node.setPosition(t.x,h.default.script.getAllFirstY()),this.damage=e},e.prototype.update=function(){},e.prototype.doAttack=function(){h.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([y({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([y({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([y({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([y({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([y({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([g],e)}(cc.Component);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],BaseButton:[function(t,e,o){"use strict";cc._RF.push(e,"08526eaTJpCXYM9VKuRXAnP","BaseButton");var i=t,n=e,a=o;cc._RF.push(n,"08526eaTJpCXYM9VKuRXAnP","BaseButton");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.BaseButton=void 0;var l=i("AudioMgr"),p=cc._decorator,u=p.ccclass,d=p.property,h=p.menu,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.invertTime=1,e.touched=!1,e.touchmil=0,e}return s(e,t),e.prototype._onTouchBegan=function(e){if(this.interactable&&this.enabledInHierarchy)return this.touched?(this.node.pauseSystemEvents(!0),void this._resetState()):void t.prototype._onTouchBegan.call(this,e)},e.prototype._onTouchEnded=function(e){if(this.interactable&&this.enabledInHierarchy){if(this.touched)return this.node.pauseSystemEvents(!0),void this._resetState();l.AudioMgr.getInstance().playAudioButtonClicked(),this.touched=!0,this.touchmil=0,t.prototype._onTouchEnded.call(this,e)}},e.prototype.update=function(e){t.prototype.update.call(this,e),this.touched&&(this.touchmil=this.touchmil+e,this.touchmil>this.invertTime&&(this.touchmil=0,this.touched=!1,this.node.resumeSystemEvents(!0)))},e.prototype.onDestroy=function(){this.touched=!1},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),this.touched=!1},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.touched=!1},c([d],e.prototype,"invertTime",void 0),c([u,h("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/BaseButton")],e)}(cc.Button);a.BaseButton=f,cc.Class.Attr.setClassAttr(f,"normalColor","visible",function(){return this.transition===cc.Button.Transition.COLOR}),cc.Class.Attr.setClassAttr(f,"pressedColor","visible",function(){return this.transition===cc.Button.Transition.COLOR}),cc.Class.Attr.setClassAttr(f,"hoverColor","visible",function(){return this.transition===cc.Button.Transition.COLOR}),cc.Class.Attr.setClassAttr(f,"disabledColor","visible",function(){return this.transition===cc.Button.Transition.COLOR}),cc.Class.Attr.setClassAttr(f,"duration","visible",function(){return this.transition===cc.Button.Transition.COLOR||this.transition===cc.Button.Transition.SPRITE||this.transition===cc.Button.Transition.SCALE}),cc.Class.Attr.setClassAttr(f,"normalSprite","visible",function(){return this.transition===cc.Button.Transition.SPRITE}),cc.Class.Attr.setClassAttr(f,"pressedSprite","visible",function(){return this.transition===cc.Button.Transition.SPRITE}),cc.Class.Attr.setClassAttr(f,"hoverSprite","visible",function(){return this.transition===cc.Button.Transition.SPRITE}),cc.Class.Attr.setClassAttr(f,"disabledSprite","visible",function(){return this.transition===cc.Button.Transition.SPRITE}),cc.Class.Attr.setClassAttr(f,"zoomScale","visible",function(){return this.transition===cc.Button.Transition.SCALE}),cc.Class.Attr.setClassAttr(f,"normalMaterial","visible",function(){return!0===this.enableAutoGrayEffect}),cc.Class.Attr.setClassAttr(f,"grayMaterial","visible",function(){return!0===this.enableAutoGrayEffect}),cc._RF.pop(),cc._RF.pop()},{}],BaseCardCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"48f87jVngNOB46luCK0N3eG","BaseCardCtrl");var i=t,n=e,a=o;cc._RF.push(n,"48f87jVngNOB46luCK0N3eG","BaseCardCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.GameCardInfo=void 0;var l=i("BaseCtrl"),p=i("LogMgr"),u=i("Utils"),d=i("GameEnumData"),h=i("DataMgr"),f=i("PlayerMgr"),m=i("BraveTowerEnum"),g=i("GameCtrl"),y=i("ItemCardBullt"),v=i("ItemEnemyBase"),_=i("BaseCardSkillCtrl"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(){this.Atk=0,this.AtkSpeed=0,this.crit=0,this.critDmg=0};a.GameCardInfo=P;var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprBg=null,e.sprIcon=null,e.sprPro=null,e.lblName=null,e.lblAtk=null,e.lblStar=null,e.prefabBullet=null,e.prefabSkill=null,e.baseInfo=new P,e.starInfo=new P,e.awakList=[],e.buffNum=0,e.bulletList=[],e.outBulletList=[],e.skillList=[],e.doSkillList=[],e}return s(e,t),e.prototype.init=function(t){this.cardId=t,this.initData(),this.initView(!0)},e.prototype.initData=function(){this.cfg=h.DataMgr.getInstance().getCardCfg(this.cardId),this.atktime=0,this.skilltime=0,this.baseInfo.Atk=f.PlayerMgr.getInstance().getCardAttack(this.cfg.id),this.baseInfo.AtkSpeed=this.cfg.attSpeed,this.baseInfo.skilltime=this.cfg.chillDown,this.baseInfo.crit=0,this.baseInfo.critDmg=m.BraveTowerParameter.CriticalDamage;var t=f.PlayerMgr.getInstance().getUserData().getCardById(this.cardId);this.awakList=[];for(var e=0;e<this.cfg.CardSkillCfg.length;e++){for(var o=this.cfg.CardSkillCfg[e],i=0,n=0;n<o.UnlockLevel.length&&!(o.UnlockLevel[n]>t.level);n++)i=n;this.awakList.push({cfg:o,index:i,val:o.vaule[i]})}this.buffNum=0},e.prototype.initView=function(t){var e=this;if(t){var o=h.DataMgr.getInstance().getCardCfg(this.cardId);this.loadSpriteFrame(m.BraveTowerBundelName.Icon,u.Utils.StringFormat(m.BraveTowerImgName.CardQuality,o.quality),function(t){e.sprBg.spriteFrame=t}),this.loadSpriteFrame(m.BraveTowerBundelName.IconCard,o.icon,function(t){e.sprIcon.spriteFrame=t,e.sprIcon.node.scale=.8}),this.sprPro.fillRange=0,this.lblName.string=this.T(o.name)}else this.lblStar.string=""+this.starNum,this.lblAtk.string=m.BraveTowerGameUtils.numberFomat(Math.ceil(this.getDamage()))},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+g.default.instance.getCardBuffTime(this.cardId,g.CardBuffAddType.Attack);this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+g.default.instance.getCardBuffTime(this.cardId,g.CardBuffAddType.AttackSpeed),this.starInfo.AtkSpeed=t*e,(t=1-g.default.instance.getCardBuffTime(this.cardId,g.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=g.default.instance.getCardBuffTime(this.cardId,g.CardBuffAddType.Crit),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=g.default.instance.getCardBuffTime(this.cardId,g.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo),this.initView(!1)},e.prototype.setLevel=function(t){if(this.starNum=t,this.upData(),this.starNum==m.BraveTowerParameter.SkillUnlockStar1){var e=this.node.convertToWorldSpaceAR(cc.v3(0,0,0));g.default.instance.ctrEffect.showSkill(this.cardId,1,e)}this.starNum==m.BraveTowerParameter.SkillUnlockStar2&&(e=this.node.convertToWorldSpaceAR(cc.v3(0,0,0)),g.default.instance.ctrEffect.showSkill(this.cardId,2,e))},e.prototype.getOutPos=function(){return this.node.convertToWorldSpaceAR(cc.v3(0,150,0))},e.prototype.getSkillPos=function(){return this.node.convertToWorldSpaceAR(cc.v3(0,100,0))},e.prototype.doAttackStart=function(t){this.atktime=0,t.addTag(this.uuid);var e,o=t.getWpos(),i=this.bulletList.shift();i?e=i.node:((e=cc.instantiate(this.prefabBullet)).setParent(g.default.instance.ndArrow),i=e.getComponent(y.default)),e.active=!0;var n=this.getOutPos(),a=g.default.instance.ndArrow.convertToNodeSpaceAR(n);e.setPosition(a),g.default.instance.gameData.playerBullets.push(i),i.initData(o,this,t)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=this.getDamage(),o=Math.random(),i=this.getCrit();o<i&&(e*=this.getCritDmg(),this.doCrit()),e=t.onAttacked(e,this.uuid),g.default.instance.addCardDamge(this.cardId,e),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var n=t.getWpos();return g.default.instance.ctrEffect.showBulletHit(n),g.default.instance.ctrEffect.showDamageNum(n,e,o<i?1:0),!0}return!1},e.prototype.doAttackEnd=function(t){g.default.instance.gameData.delPlayerBullet(t),t.node.active=!1,this.bulletList.push(t)},e.prototype.doSkillStart=function(){var t=g.default.instance.getRandomEnemy();if(!t)return!1;g.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(g.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(_.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),!0},e.prototype.doSkillEnd=function(t){for(var e=0;e<this.doSkillList.length;e++)if(this.doSkillList[e].uuid==t.uuid){this.doSkillList.splice(e,1);break}var o=t.node;t.node.active=!1,this.skillList.push(o)},e.prototype.addDie=function(t,e){if(g.default.instance.gameTrammel.addTies10(),g.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06)){var o=g.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID52);o&&o.time++}var i=e.getGold(),n=g.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties08),a=g.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID58);n&&a&&(i+=a.value[0]),g.default.instance.addGoldNum(i)},e.prototype.addBuff=function(t,e){if(e){var o=g.default.instance.getCardBuffTime(this.cardId,g.CardBuffAddType.Stun);o>0&&e.addBuff(v.Buff.stun,o);var i=g.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID70);i&&g.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties14)&&e.addBuff(v.Buff.damageDown3,-1,i.value[0])}if(1==t&&1==m.BraveTowerSwitch.SkillTYpe()){var n=g.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties08),a=g.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID57);n&&a&&g.default.instance.subGoldNum(a.value[1])}},e.prototype.getStarNum=function(){return this.starNum},e.prototype.getDamage=function(){return this.starInfo.Atk},e.prototype.getAtkSpeed=function(){return this.starInfo.AtkSpeed},e.prototype.getCrit=function(){return this.starInfo.crit},e.prototype.getCritDmg=function(){return this.starInfo.critDmg},e.prototype.doCrit=function(){g.default.instance.gameSkillBuff.addBuffSkill21(),p.LogMgr.getInstance().info("\u89e6\u53d1\u66b4\u51fb",this.cardId)},e.prototype.onSell=function(){},e.prototype.getSellPrice=function(){for(var t=this.cfg.price*this.starNum*.5,e=1,o=g.default.instance.gameBuff.getBuffList(d.BraveTowerEnumBuffType.BuffType13),i=0;i<o.length;i++)e+=o[i].value[0];return Math.round(t*e)},e.prototype.onUpdate=function(t,e){switch(e){case 1:this.skilltime+=t;break;case 2:this.atktime+=t*this.getAtkSpeed()}},e.prototype.onDestroy=function(){this.bulletList.forEach(function(t){var e,o;null===(o=null===(e=g.default.instance)||void 0===e?void 0:e.gameData)||void 0===o||o.delPlayerBullet(t),t.node.active=!1,t.node.destroy()}),this.bulletList=[],this.doSkillList.forEach(function(t){t.onFree()}),this.doSkillList=[],this.skillList.forEach(function(t){return t.destroy()}),this.skillList=[],t.prototype.onDestroy.call(this)},c([I({type:cc.Sprite,tooltip:"\u80cc\u666f"})],e.prototype,"sprBg",void 0),c([I({type:cc.Sprite,tooltip:"\u80cc\u666f"})],e.prototype,"sprIcon",void 0),c([I({type:cc.Sprite,tooltip:"\u80cc\u666f"})],e.prototype,"sprPro",void 0),c([I({type:cc.Label,tooltip:"\u540d\u5b57"})],e.prototype,"lblName",void 0),c([I({type:cc.Label,tooltip:"\u653b\u51fb\u529b"})],e.prototype,"lblAtk",void 0),c([I({type:cc.Label,tooltip:"\u661f\u7ea7"})],e.prototype,"lblStar",void 0),c([I({type:cc.Prefab,tooltip:"\u5b50\u5f39"})],e.prototype,"prefabBullet",void 0),c([I({type:cc.Prefab,tooltip:"\u6280\u80fd"})],e.prototype,"prefabSkill",void 0),c([B],e)}(l.default);a.default=C,cc._RF.pop(),cc._RF.pop()},{}],BaseCardSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1a041rj8O9HqZT0o7b3WDG5","BaseCardSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1a041rj8O9HqZT0o7b3WDG5","BaseCardSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("GameCtrl");!function(t){t[t.Normal=0]="Normal",t[t.Wait=1]="Wait",t[t.Dead=2]="Dead"}(l||(l={}));var u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.status=l.Normal,e.ctrPar=null,e.tagWpos=cc.v2(),e.speed=2e3,e.vec_1=cc.v2(),e.vec_2=cc.v2(),e.keeptime=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(){var e;null===(e=t.ctrPar)||void 0===e||e.doSkill(t)}),this.spAni.setCompleteListener(function(e){"hit"==e.animation.name&&t.onDie()})},e.prototype.setParent=function(t){this.ctrPar=t,this.status=l.Normal;var e=this.ctrPar.getOutPos(),o=p.default.instance.ndSkill.convertToNodeSpaceAR(e);this.node.setPosition(o),this.node.active=!0},e.prototype.setTag=function(t,e){if(this.spAni.timeScale=p.default.instance.getSpeed(),e){this.spAni.setAnimation(0,"bullet",!0),this.tagWpos=cc.v2(t.x,t.y),this.vec_1=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),cc.Vec2.subtract(this.vec_2,this.tagWpos,this.vec_1),cc.Vec2.normalize(this.vec_2,this.vec_2);var o=Math.atan2(this.vec_2.y,this.vec_2.x);this.node.angle=180*o/Math.PI-90,p.default.instance.gameData.playerSkillList.push(this)}else{var i=p.default.instance.ndSkill.convertToNodeSpaceAR(t);this.node.setPosition(i),this.onWait()}},e.prototype.getWpos=function(){return this.node.convertToWorldSpaceAR(cc.Vec2.ZERO)},e.prototype.onUpdate=function(t){switch(this.status){case l.Normal:this.vec_1=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),cc.Vec2.subtract(this.vec_2,this.tagWpos,this.vec_1);var e=Math.min(this.speed*t,this.vec_2.len());if(0==e)return void this.onWait();cc.Vec2.normalize(this.vec_2,this.vec_2),cc.Vec2.multiplyScalar(this.vec_2,this.vec_2,e),cc.Vec2.add(this.vec_1,this.vec_1,this.vec_2),this.vec_2=this.node.parent.convertToNodeSpaceAR(this.vec_1),this.node.setPosition(this.vec_2)}},e.prototype.onWait=function(){this.status=l.Wait,this.node.angle=0,this.spAni.setAnimation(0,"hit",!1);for(var t=p.default.instance.gameData.playerSkillList,e=0;e<t.length;e++)if(t[e].uuid==this.uuid){p.default.instance.gameData.playerSkillList.splice(e,1);break}},e.prototype.onDie=function(){var t;this.status=l.Dead,this.node.active=!1,null===(t=this.ctrPar)||void 0===t||t.doSkillEnd(this)},e.prototype.onFree=function(){var t;this.status=l.Dead,this.node.active=!1;var e=null===(t=p.default.instance.gameData)||void 0===t?void 0:t.playerSkillList;if(e)for(var o=0;o<e.length;o++)if(e[o].uuid==this.uuid){e.splice(o,1);break}this.node.destroy()},e.prototype.onRelease=function(){this.status=l.Dead,this.node.destroy()},e.prototype.isColl=function(t){if(this.colBox){var e=this.colBox.node.convertToNodeSpaceAR(t),o=this.colBox.offset,i=this.colBox.size;return e.x>o.x-i.width/2&&e.x<o.x+i.width/2&&e.y>o.y-i.height/2&&e.y<o.y+i.height/2}if(this.colCircle){e=this.colCircle.node.convertToNodeSpaceAR(t),o=this.colCircle.offset;var n=this.colCircle.radius;return Math.sqrt(Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2))<n}return console.error("\u6ca1\u6709\u78b0\u649e\u4f53"),!1},c([h({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([h({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([h({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],BaseCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"de51cCKuzdF55057kR0mitQ","BaseCtrl");var i=t,n=e,a=o;cc._RF.push(n,"de51cCKuzdF55057kR0mitQ","BaseCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("EventMgr"),p=i("LanguageMgr"),u=i("ResCacheMgr"),d=i("ResourceMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cache=!1,e.resArray=[],e.eventList=[],e.isDestroy=!1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.addEvent=function(t,e){l.EventMgr.getInstance().on(t,this,e);var o=new Map;o.set(t,e),this.eventList.push(o)},e.prototype.sendEvent=function(t,e,o,i,n,a){l.EventMgr.getInstance().emit(t,e,o,i,n,a)},e.prototype.loadSpriteFrame=function(t,e,o,i,n){var a=this;void 0===i&&(i=!0),void 0===n&&(n=10),d.ResourceMgr.getInstance().loadSpriteframe(t,e,function(n){i&&a.addRes(t,e,cc.SpriteFrame),a.isDestroy||o(n)},i,n)},e.prototype.loadRemoteSpriteFrame=function(t,e,o,i){var n=this;void 0===o&&(o=!0),void 0===i&&(i=10),d.ResourceMgr.getInstance().loadRemoteSpriteFrame(t,function(i){o&&n.addRes("",t,cc.SpriteFrame),n.isDestroy||e(i)},o,i)},e.prototype.loadPrefab=function(t,e,o,i,n){var a=this;void 0===i&&(i=!0),void 0===n&&(n=10),d.ResourceMgr.getInstance().loadRes(t,e,cc.Prefab,function(n){i&&a.addRes(t,e,cc.Prefab),a.isDestroy||o(n)},i,n)},e.prototype.loadTexture2D=function(t,e,o,i,n){var a=this;void 0===i&&(i=!0),void 0===n&&(n=10),d.ResourceMgr.getInstance().loadRes(t,e,cc.Texture2D,function(n){i&&a.addRes(t,e,cc.Texture2D),a.isDestroy||o(n)},i,n)},e.prototype.loadResFromBundle=function(t,e,o,i,n,a){var r=this;void 0===n&&(n=!0),void 0===a&&(a=10),d.ResourceMgr.getInstance().loadRes(t,e,o,function(a){n&&r.addRes(t,e,o),r.isDestroy||i(a)},n,a)},e.prototype.loadFromRes=function(t,e,o,i){var n=this;void 0===i&&(i=10),d.ResourceMgr.getInstance().loadFromRes(t,e,function(i){n.addRes("",t,e),n.isDestroy||o(i)})},e.prototype.addRes=function(t,e,o){if(this.resArray){var i=u.ResCacheMgr.getInstance().isExistKey(t+"/"+e,o.name,this.resArray);if(-1!=i)this.resArray[i].defCount||(this.resArray[i].defCount=0),this.resArray[i].defCount++;else{var n=new d.ResCacheKey(t,e,o);this.resArray.push(n)}}},e.prototype.release=function(){!this.cache&&this.resArray&&(u.ResCacheMgr.getInstance().refreshTime(this.resArray),this.resArray=[])},e.prototype.setListenerUI=function(){},e.prototype.onDestroy=function(){var t=this;if(this.eventList&&this.eventList.length>0){for(var e=0;e<this.eventList.length;e++)this.eventList[e].forEach(function(e,o){l.EventMgr.getInstance().off(o,t,e)});this.eventList=null}this.isDestroy=!0,this.release()},e.prototype.T=function(t){return p.LanguageMgr.getInstance().T(t)},e.prototype.getImgstr=function(t){return p.LanguageMgr.getInstance().getImgstr(t)},c([m({displayName:"\u662f\u5426\u9700\u8981\u7f13\u5b58\u8d44\u6e90"})],e.prototype,"cache",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],BaseData:[function(t,e,o){"use strict";cc._RF.push(e,"49fe1VrQRREfYC23YMs7HGr","BaseData");var i=t,n=e,a=o;cc._RF.push(n,"49fe1VrQRREfYC23YMs7HGr","BaseData"),Object.defineProperty(a,"__esModule",{value:!0}),a.BaseData=void 0;var r=i("CacheUtils"),s=i("Config"),c=i("EventMgr"),l=i("PlatformManager"),p=i("ServerDataMgr"),u=i("Utils"),d=i("BasePlatform"),h=function(){function t(){this.pwd="SFPLAY",this.isneedSave=!1,this.pause=!1,this.invertTime=l.PlatformManager.currentPlatform==d.Platform.WECHAT?30:10,this.savetimeKey="sft",this.preTime=0}return t.prototype.getData=function(){var t=this;if(l.PlatformManager.currentPlatform==d.Platform.WEB_LINK&&(this.gameKey=this.gameKey.replace(s.GameConfig.AppCacheName,s.GameConfig.WebCacheName)),null==this.data){c.EventMgr.getInstance().on("CLEARDATA",this,function(e){t.pause=e}),setInterval(function(){if(t.isneedSave&&t.data){var e=t.preTime,o=Number(((new Date).getTime()/1e3).toFixed(0));e&&o-e>=t.invertTime&&t.UpdateData()}},1e3),cc.game.on(cc.game.EVENT_HIDE,function(){t.isneedSave&&t.data&&(t.preTime=0,t.UpdateData())},this);var e=p.ServerdataMgr.getDataByKey(this.gameKey);return this.loaddata(e,this.gameKey)}return this.data},t.prototype.loaddata=function(t,e,o){void 0===o&&(o=!0);var i=null,n=null,a=null,s=null,c=null;t&&(s=JSON.parse(t),s=u.Utils.restoreObjectKeys(s,this.aliseMap),!Array.isArray(s)&&s&&(n=s[this.savetimeKey]));var l=this.ecrypt?r.CacheUtils.getDataDecrypt(e,this.pwd):r.CacheUtils.getData(e);return l&&(c=JSON.parse(l),c=u.Utils.restoreObjectKeys(c,this.aliseMap),!Array.isArray(c)&&c&&(a=c[this.savetimeKey])),a&&n&&a>n?(i=c,o&&(this.data=i,this.initData(!1))):s?(i=s,o&&(this.data=i,this.initData(!1))):c?(i=c,o&&(this.data=i,this.initData(!1))):(i=this.createData(),o&&(this.data=i,this.initData(!0))),i},t.prototype.initData=function(){},t.prototype.saveData=function(){if(!this.pause){this.data[this.savetimeKey]=Number(((new Date).getTime()/1e3).toFixed(0));var t=JSON.stringify(u.Utils.renameObjectKeys(this.data,this.aliseMap));l.PlatformManager.currentPlatform==d.Platform.WEB_LINK&&(this.gameKey=this.gameKey.replace(s.GameConfig.AppCacheName,s.GameConfig.WebCacheName)),this.ecrypt?r.CacheUtils.saveDataEncrypt(this.gameKey,t,this.pwd):r.CacheUtils.saveData(this.gameKey,t),p.ServerdataMgr.getNeedSaveServer()&&this.UpdateData()}},t.prototype.UpdateData=function(){null==this.data&&(this.data=new Object);var t=Number(((new Date).getTime()/1e3).toFixed(0)),e=this.preTime;if(e&&t-e<this.invertTime)this.isneedSave=!0;else{this.isneedSave=!1,this.preTime=t;var o=JSON.stringify(this.data);p.ServerdataMgr.saveData(this.gameKey,o,function(){})}},t.prototype.clearData=function(){localStorage.removeItem(this.gameKey)},t}();a.BaseData=h,cc._RF.pop(),cc._RF.pop()},{}],BaseMgr:[function(t,e,o){"use strict";cc._RF.push(e,"9b26fp4xRlDqIrlgM98Byc9","BaseMgr");var i=t,n=e,a=o;cc._RF.push(n,"9b26fp4xRlDqIrlgM98Byc9","BaseMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("EventMgr"),s=function(){function t(){this.resArray=[],this.eventList=[],this.isDestroy=!1}return t.prototype.addEvent=function(t,e){r.EventMgr.getInstance().on(t,this,e);var o=new Map;o.set(t,e),this.eventList.push(o)},t.prototype.sendEvent=function(t,e,o,i,n,a){r.EventMgr.getInstance().emit(t,e,o,i,n,a)},t.prototype.addRes=function(){},t.prototype.release=function(){},t.prototype.setListenerUI=function(){},t.prototype.offEvents=function(){var t=this;if(this.eventList&&this.eventList.length>0){for(var e=0;e<this.eventList.length;e++)this.eventList[e].forEach(function(e,o){r.EventMgr.getInstance().off(o,t,e)});this.eventList=null}},t.prototype.onDestroy=function(){this.isDestroy=!0,this.release()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],BasePlatform:[function(t,e,o){"use strict";cc._RF.push(e,"99a91f+tQxEWIiBgY/dL3bP","BasePlatform");var i=e,n=o;cc._RF.push(i,"99a91f+tQxEWIiBgY/dL3bP","BasePlatform"),Object.defineProperty(n,"__esModule",{value:!0}),n.Platform=void 0,function(t){t.EDITOR="editor",t.KUAIKAN="h5_kuaikan",t.WECHAT="h5_wechat",t.BYTEDANCE="h5_bytedance",t.VIVO="h5_vivo",t.BAIDU="h5_baidu",t.OPPO="h5_oppo",t.QQ="h5_qq",t.ANDROID_233="android_233",t.ANDROID_XIAOMI="android_xiaomi",t.ANDROID_VIVO="android_vivo",t.ANDROID_OPPO="android_oppo",t.ANDROID_oyahoo="android_ohayoo",t.ANDROID_MMY="android_mmy",t.ANDROID_4399="android_4399",t.ANDROID_DOUYIN="android_bytedance",t.GOOGLE="Google",t.Ios="ios",t.KuaiShou="kuaishou",t.HUAWEI_QUICK="huawei",t.Implode="Implode",t.WEB_LINK="weblink"}(n.Platform||(n.Platform={})),cc._RF.pop(),cc._RF.pop()},{}],BaseServer:[function(t,e,o){"use strict";cc._RF.push(e,"026d06IdJ5HVo79bosAjZML","BaseServer");var i=e,n=o;cc._RF.push(i,"026d06IdJ5HVo79bosAjZML","BaseServer"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop(),cc._RF.pop()},{}],BaseUI:[function(t,e,o){"use strict";cc._RF.push(e,"aaf34+Thw5BRKGowfSnf24h","BaseUI");var i=t,n=e,a=o;cc._RF.push(n,"aaf34+Thw5BRKGowfSnf24h","BaseUI");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.OpenAin=void 0;var l,p=i("EventMgr"),u=i("LanguageMgr"),d=i("PlatformManager"),h=i("ResCacheMgr"),f=i("ResourceMgr"),m=i("TweenMgr"),g=i("UIMgr"),y=i("ArgsParseUtils"),v=i("BasePlatform"),_=cc._decorator,b=_.ccclass,B=_.property;(function(t){t[t.None=0]="None",t[t.Pop=1]="Pop"})(l=a.OpenAin||(a.OpenAin={})),cc.Enum(l);var I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cache=!1,e.openAniType=l.None,e.bgOpacity=200,e.uid="UINone",e.resArray=[],e.eventList=[],e.isclose=!1,e.fromId="UINone",e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.refreshUI=function(){},e.prototype.init=function(){this.isclose=!1},e.prototype.onOpen=function(){},e.prototype.onClose=function(){},e.prototype.onToggleHide=function(){},e.prototype.onToggleShow=function(){},e.prototype.addEvent=function(t,e){p.EventMgr.getInstance().on(t,this,e);var o=new Map;o.set(t,e),this.eventList.push(o)},e.prototype.sendEvent=function(t,e,o,i,n,a){p.EventMgr.getInstance().emit(t,e,o,i,n,a)},e.prototype.getUid=function(){return this.uid},e.prototype.onOpened=function(){this.isclose=!1},e.prototype.setUid=function(t){this.uid=t},e.prototype.openAni=function(t){var e=this;if(this.openAniType==l.Pop){this.node.active=!0;var o=this.node.getChildByName("bg");o&&(o.opacity=0,cc.tween(o).to(.2,{opacity:this.bgOpacity}).start());var i=this.node.getChildByName("root");if(i){var n=i.scale,a=m.TweenMgr.getInstance().getTween(i),r=i.getComponent(cc.Widget);i.scale=0,r&&r.updateAlignment(),m.TweenMgr.getInstance().popOpenAin(a,function(){i.scale!=n&&cc.tween(i).to(.15,{scale:n}).start(),e.onOpen(),t&&t()})}else this.node.active=!0,this.onOpen(),t&&t()}else this.node.active=!0,this.onOpen(),t&&t()},e.prototype.closeAni=function(t){if(this.openAniType==l.None)t();else if(this.openAniType==l.Pop){var e=this.node.getChildByName("bg");e&&(e.opacity=this.bgOpacity,cc.tween(e).to(.4,{opacity:0}).start());var o=this.node.getChildByName("root");if(o){var i=m.TweenMgr.getInstance().getTween(o);m.TweenMgr.getInstance().popCloseAin(i,function(){t()})}else t()}},e.prototype.openUI=function(t,e,o,i,n,a){g.UIMgr.getInstance().openUI(t,this.uid,e,o,i,n,a)},e.prototype.openUICallBack=function(t,e,o,i,n,a,r){g.UIMgr.getInstance().openUIOfCallback(t,this.uid,e,o,i,n,a,r)},e.prototype.closeUI=function(t,e,o,i,n){var a=this;if(this.eventList&&this.eventList.length>0)for(var r=0;r<this.eventList.length;r++)this.eventList[r].forEach(function(t,e){p.EventMgr.getInstance().off(e,a,t)});this.isclose=!0,this.release(),this.scheduleOnce(function(){g.UIMgr.getInstance().closeUI(a.node,t,e,o,i,n)})},e.prototype.closeNotAni=function(t,e,o,i,n){this.openAniType=l.None,this.closeUI(t,e,o,i,n)},e.prototype.loadSpriteFrame=function(){var t=this,e=y.ArgsParseUtils._makeloadSpriteFrameResrgs.apply(this,arguments),o=e.bundle,i=e.path,n=e.callback,a=!0,r=e.saveKey;i.startsWith("http")?d.PlatformManager.currentPlatform==v.Platform.BYTEDANCE?(console.log("\u8fdb\u6765\u4e86\u5934\u50cf\uff1a",i),cc.assetManager.loadRemote(i,{ext:".head"},function(e,o){if(!t.isclose&&!e){console.log("\u5934\u50cf\u4e0b\u8f7d\u6210\u529f\uff1a",i);var a=new cc.SpriteFrame(o);n(a)}})):cc.assetManager.loadRemote(i,function(e,o){if(!t.isclose&&!e){var i=new cc.SpriteFrame(o);n(i)}}):f.ResourceMgr.getInstance().loadSpriteframe(o,i,function(e){a&&t.addRes(o,i,cc.SpriteFrame),t.isclose||n(e)},a,e.cacheTme,r)},e.prototype.loadRemoteSpriteFrame=function(t,e,o,i){var n=this;void 0===o&&(o=!0),void 0===i&&(i=10),f.ResourceMgr.getInstance().loadRemoteSpriteFrame(t,function(i){o&&n.addRes("",t,cc.SpriteFrame),n.isclose||e(i)},o,i)},e.prototype.loadPrefab=function(t,e,o,i,n){var a=this;void 0===i&&(i=!0),void 0===n&&(n=10),f.ResourceMgr.getInstance().loadRes(t,e,cc.Prefab,function(n){i&&a.addRes(t,e,cc.Prefab),a.isclose||o(n)},i,n)},e.prototype.loadTexture2D=function(t,e,o,i,n){var a=this;void 0===i&&(i=!0),void 0===n&&(n=10),f.ResourceMgr.getInstance().loadRes(t,e,cc.Texture2D,function(n){i&&a.addRes(t,e,cc.Texture2D),a.isclose||o(n)},i,n)},e.prototype.loadResFromBundle=function(){var t=this,e=y.ArgsParseUtils._makeLoadResArgs.apply(this,arguments),o=e.bundle,i=e.path,n=e.callback,a=!0,r=e.type;f.ResourceMgr.getInstance().loadRes(o,i,r,function(e){a&&t.addRes(o,i,r),t.isclose||n(e)},a,e.cacheTme,e.saveKey)},e.prototype.loadFromRes=function(t,e,o,i){var n=this;void 0===i&&(i=10),f.ResourceMgr.getInstance().loadFromRes(t,e,function(i){n.addRes("",t,e),n.isclose||o(i)})},e.prototype.addRes=function(t,e,o){if(this.resArray){var i=h.ResCacheMgr.getInstance().isExistKey(t+"/"+e,o.name,this.resArray);if(-1!=i)this.resArray[i].defCount||(this.resArray[i].defCount=0),this.resArray[i].defCount++;else{var n=new f.ResCacheKey(t,e,o);this.resArray.push(n)}}},e.prototype.release=function(){!this.cache&&this.resArray&&(h.ResCacheMgr.getInstance().refreshTime(this.resArray),this.resArray=[])},e.prototype.setListenerUI=function(){},e.prototype.onDestroy=function(){var t=this;if(this.eventList&&this.eventList.length>0){for(var e=0;e<this.eventList.length;e++)this.eventList[e].forEach(function(e,o){p.EventMgr.getInstance().off(o,t,e)});this.eventList=null}this.isclose=!0,this.release()},e.prototype.T=function(t){return u.LanguageMgr.getInstance().T(t)},e.prototype.getImgstr=function(t){return u.LanguageMgr.getInstance().getImgstr(t)},c([B({displayName:"\u662f\u5426\u9700\u8981\u7f13\u5b58"})],e.prototype,"cache",void 0),c([B({type:l,tooltip:"\u6ce8\u610f\uff1a\u4e3b\u8282\u70b9\u4e0b\u53ea\u9700bg \u548c root",displayName:"\u6253\u5f00\u52a8\u753b"})],e.prototype,"openAniType",void 0),c([b],e)}(cc.Component);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],BezierCurve:[function(t,e,o){"use strict";cc._RF.push(e,"32960yjCctN6pBRbDKLXLXg","BezierCurve");var i=e,n=o;cc._RF.push(i,"32960yjCctN6pBRbDKLXLXg","BezierCurve"),Object.defineProperty(n,"__esModule",{value:!0}),n.BezierCurve=void 0;var a=function(){function t(t){this.points=t}return t.prototype.approximateLength=function(t){for(var e=0,o=0;o<t;o++){var i=o/(t-1),n=(o+1)/(t-1),a=this.getPoint(i);e+=this.getPoint(n).sub(a).mag()}return e},t.prototype.getPoint=function(t){if(this.points.length<2)throw new Error("\u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u70b9\u6765\u5b9a\u4e49\u8d1d\u585e\u5c14\u66f2\u7ebf");for(var e=new cc.Vec2,o=0;o<this.points.length;o++){var i=this.points[o],n=this.binomialCoefficient(this.points.length-1,o)*Math.pow(t,o)*Math.pow(1-t,this.points.length-1-o);e.x+=i.x*n,e.y+=i.y*n}return e},t.prototype.binomialCoefficient=function(t,e){e>t-e&&(e=t-e);for(var o=1,i=0;i<e;i++)o*=t-i,o/=i+1;return o},t}();n.BezierCurve=a,cc._RF.pop(),cc._RF.pop()},{}],Binary:[function(t,e,o){"use strict";cc._RF.push(e,"745d9e0FutE0JU3/UU7ViFj","Binary");var i=e,n=o;cc._RF.push(i,"745d9e0FutE0JU3/UU7ViFj","Binary"),Object.defineProperty(n,"__esModule",{value:!0}),n.protoToJson=n.registerProtoMap=n.registerProto=n.decode=n.encode=n.Type=n.singleArray=void 0;var a=function(){function t(t){this.buffer=null,this.view=null,this.index=0,this.buffer=new ArrayBuffer(t),this.view=new DataView(this.buffer),this.index=0}return t.prototype.setInt8=function(t){return u(t)||(t=0),this.view.setInt8(this.index++,t)},t.prototype.setUint8=function(t){return u(t)||(t=0),this.view.setUint8(this.index++,t)},t.prototype.setInt16=function(t){u(t)||(t=0);var e=this.view.setInt16(this.index,t);return this.index+=2,e},t.prototype.setUint16=function(t){u(t)||(t=0);var e=this.view.setUint16(this.index,t);return this.index+=2,e},t.prototype.setInt32=function(t){u(t)||(t=0);var e=this.view.setInt32(this.index,t);return this.index+=4,e},t.prototype.setUint32=function(t){u(t)||(t=0);var e=this.view.setUint32(this.index,t);return this.index+=4,e},t.prototype.setFloat32=function(t){u(t)||(t=0);var e=this.view.setFloat32(this.index,t);return this.index+=4,e},t.prototype.setFloat64=function(t){u(t)||(t=0);var e=this.view.setFloat64(this.index,t);return this.index+=8,e},t.prototype.setBoolean=function(t){return this.setUint8(t?1:0)},t.prototype.setString=function(t,e){if(void 0===e&&(e=1),p(t)||(t=""),this.setUint16(t.length),4==e)for(var o=0,i=t.length;o<i;o++)this.setUint32(t.charCodeAt(o));else if(2==e)for(o=0,i=t.length;o<i;o++)this.setUint16(t.charCodeAt(o));else for(o=0,i=t.length;o<i;o++)this.setUint8(t.charCodeAt(o))},t.prototype.setString8=function(t){this.setString(t,1)},t.prototype.setString16=function(t){this.setString(t,2)},t.prototype.setString32=function(t){this.setString(t,4)},t.prototype.setArray=function(t,e){return void 0===e&&(e=1),c(t)&&!d(t)?this.setString(JSON.stringify(t),e):this.setString("",e)},t.prototype.setArray8=function(t){return this.setArray(t,1)},t.prototype.setArray16=function(t){return this.setArray(t,2)},t.prototype.setArray32=function(t){return this.setArray(t,4)},t.prototype.setObject=function(t,e){return void 0===e&&(e=1),l(t)&&!d(t)?this.setString(JSON.stringify(t),e):this.setString("",e)},t.prototype.setObject8=function(t){return this.setObject(t,1)},t.prototype.setObject16=function(t){return this.setObject(t,2)},t.prototype.setObject32=function(t){return this.setObject(t,4)},t.prototype.getBuffer=function(){return this.buffer},t}(),r=function(){function t(t){this.view=null,this.index=0,this.view=new DataView(t),this.index=0}return t.prototype.getInt8=function(){return this.view.getInt8(this.index++)},t.prototype.getUint8=function(){return this.view.getUint8(this.index++)},t.prototype.getInt16=function(){var t=this.view.getInt16(this.index);return this.index+=2,t},t.prototype.getUint16=function(){var t=this.view.getUint16(this.index);return this.index+=2,t},t.prototype.getInt32=function(){var t=this.view.getInt32(this.index);return this.index+=4,t},t.prototype.getUint32=function(){var t=this.view.getUint32(this.index);return this.index+=4,t},t.prototype.getFloat32=function(){var t=this.view.getFloat32(this.index);return this.index+=4,t},t.prototype.getFloat64=function(){var t=this.view.getFloat64(this.index);return this.index+=8,t},t.prototype.getBoolean=function(){return!!this.getUint8()},t.prototype.getString=function(t){void 0===t&&(t=1);var e=this.getUint16(),o="";if(4==t)for(var i=0;i<e;i++)o+=String.fromCharCode(this.getUint32());else if(2==t)for(i=0;i<e;i++)o+=String.fromCharCode(this.getUint16());else for(i=0;i<e;i++)o+=String.fromCharCode(this.getUint8());return o},t.prototype.getString8=function(){return this.getString(1)},t.prototype.getString16=function(){return this.getString(2)},t.prototype.getString32=function(){return this.getString(4)},t.prototype.getArray=function(t){void 0===t&&(t=1);var e=this.getString(t);return e?JSON.parse(e):[]},t.prototype.getArray8=function(){return this.getArray(1)},t.prototype.getArray16=function(){return this.getArray(2)},t.prototype.getArray32=function(){return this.getArray(4)},t.prototype.getObject=function(t){void 0===t&&(t=1);var e=this.getString(t);return e?JSON.parse(e):{}},t.prototype.getObject8=function(){return this.getObject(1)},t.prototype.getObject16=function(){return this.getObject(2)},t.prototype.getObject32=function(){return this.getObject(4)},t}(),s=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},c=function(t){return"array"===s(t)},l=function(t){return"object"===s(t)},p=function(t){return"string"===s(t)},u=function(t){return"number"===s(t)};function d(t){if(c(t))return!t.length;if(l(t))for(var e in t)return!1;return!0}function h(t,e){if(t===e)return 0;for(var o=Math.max(t.length,e.length),i=0,n=0,a=0;i<o;i++){if(t.length<=i)return-1;if(e.length<=i)return 1;if((n=t.charCodeAt(i))>(a=e.charCodeAt(i)))return 1;if(n<a)return-1}return 0}function f(t){if(l(t)){var e=0,o=[];for(var i in t){for(e=o.length-1;e>=0&&!(h(i,o[e])>=0);e--);e===o.length-1?o.push(i):o.splice(e+1,0,i)}return o}return c(t)?t.map(function(t,e){return e}):[]}function m(t){return c(t)||l(t)?t:b[t]||t}var g="SingleArray";function y(t){return p(t)&&0===t.indexOf(g)}function v(t){var e=t.slice(g.length+1,-1);return JSON.parse(e)}n.singleArray=function(t){return g+"("+JSON.stringify(t)+")"};var _={Int8:1,Uint8:1,Int16:2,Uint16:2,Int32:4,Uint32:4,Float32:4,Float64:8,BigInt64:8,BigUint64:8,Boolean:1,String8:1,String16:2,String32:4,Array8:1,Array16:2,Array32:4,Object8:1,Object16:2,Object32:4};n.Type={Int8:"Int8",Uint8:"Uint8",Uint8Clamped:"Uint8",Int16:"Int16",Uint16:"Uint16",Int32:"Int32",Uint32:"Uint32",Float32:"Float32",Float64:"Float64",BigInt64:"BigInt64",BigUint64:"BigUint64",Boolean:"Boolean",String:"String8",String8:"String8",String16:"String16",String32:"String32",Array:"Array8",Array8:"Array8",Array16:"Array16",Array32:"Array32",Object:"Object8",Object8:"Object8",Object16:"Object16",Object32:"Object32"},n.encode=function(t,e){var o=b[e];if(o){var i=function t(e,o){o=m(o);var i=0;if(l(o))for(var n in l(e)||(e={}),o)i+=t(e[n],o[n]);else if(c(o))c(e)||(e=[]),o.forEach(function(o,n){i+=t(e[n],o)});else if(y(o))i+=2,c(e)||(e=[]),o=m(v(o)),e.forEach(function(e){i+=t(e,o)});else{if(!_[o])throw new Error("'proto' is bad");var a=_[o];0===o.indexOf("String")?(i+=2,p(e)&&(i+=e.length*a)):0===o.indexOf("Object")||0===o.indexOf("Array")?(i+=2,d(e)||(i+=JSON.stringify(e).length*a)):i+=a}return i}(t,o),n=new a(i+2);return n.setUint16(Number(e)),function t(e,o,i){i=m(i),l(i)?(l(o)||(o={}),f(i).forEach(function(n){t(e,o[n],i[n])})):c(i)?(c(o)||(o=[]),i.forEach(function(i,n){t(e,o[n],i)})):y(i)?(c(o)||(o=[]),e.setUint16(o.length),i=m(v(i)),o.forEach(function(o){t(e,o,i)})):e["set"+i](o)}(n,t,o),n.getBuffer()}throw new Error("encode error: 'id' is bad")},n.decode=function(t){var e=new r(t),o=e.getUint16(),i=b[o];if(i)return function t(e,o){if(o=m(o),l(o)){var i={};return f(o).forEach(function(n){i[n]=t(e,o[n])}),i}if(c(o))return o.map(function(o){return t(e,o)});if(y(o)){var n=[],a=e.getUint16();o=m(v(o));for(var r=0;r<a;r++)n.push(t(e,o));return n}return e["get"+o]()}(e,i);throw new Error("decode error: 'buffer' is bad")};var b={};n.registerProto=function(t,e){if("string"==typeof t&&(t=Number(t)),!(u(t)&&Math.floor(t)===t&&t>=0&&t<=65535)||n.Type[t])throw new Error("registerProto error: 'id' is bad");b[t]=e},n.registerProtoMap=function(t){if(!l(t))throw new Error("registerProtoMap error: 'protoMap' is bad");for(var e in t)n.registerProto(e,t[e])},n.protoToJson=function(){return JSON.stringify(b)},cc._RF.pop(),cc._RF.pop()},{}],BraveTowerEnum:[function(t,e,o){"use strict";cc._RF.push(e,"f4c40heoyBJ35/uqrhlxSL6","BraveTowerEnum");var i=t,n=e,a=o;cc._RF.push(n,"f4c40heoyBJ35/uqrhlxSL6","BraveTowerEnum"),Object.defineProperty(a,"__esModule",{value:!0}),a.BraveTowerSwitch=a.TimeByKey=a.BraveTowerTaskType=a.BraveTowerGameMode=a.BraveTowerGameStage=a.BraveTowerPoolName=a.BraveTowerPrefabName=a.BraveTowerImgName=a.BraveTowerBundelName=a.BraveTowerParameter=a.BraveTowerEventName=a.BraveTowerGameUtils=void 0;var r=i("PlayerMgr"),s=function(){function t(){}return t.numberFomat=function(t){for(var e,o=["","\u4e07","\u4ebf","\u5146","\u4eac","\u5793","\u79ed","\u7a70","\u6c9f","\u6da7","\u6b63","\u8f7d","\u6781","\u6052","\u6cb3\u6c99","\u963f\u50e7\u7947","\u90a3\u7531\u4ed6","\u4e0d\u53ef\u601d\u8bae","\u65e0\u91cf\u5927\u6570"],i=0,n=t,a=0;Math.abs(n)>=1e4;)a=Math.floor(n%1e4),n=Math.floor(n/1e4),i++;switch(i){case 0:e=n.toString();break;default:e=0==a?n.toString()+o[i]:(n+a/1e4).toFixed(2).replace(/\.?0*$/,"")+o[i]}return e},t.compareIsToday2=function(t){var e=new Date(t),o=e.getFullYear(),i=e.getUTCMonth(),n=e.getUTCDay(),a=new Date,r=a.getFullYear(),s=a.getUTCMonth(),c=a.getUTCDay();return o==r&&i==s&&n==c},t.rollNumLabelAtlas=function(t,e,o,i,n,a){void 0===n&&(n=3);var r=o-e;cc.Tween.stopAllByTarget(t),cc.tween(t).to(n,{},{onUpdate:function(t,o){var i=e+o*r;a?a(Math.ceil(i)):t.string=Math.ceil(i).toString()}}).call(function(){i&&i()}).start()},t.aniAngle=function(t){var e=this,o=function(t){e.twenMap.has(t.uuid)&&function(t){e.twenMap.has(t.uuid)&&(e.twenMap.get(t.uuid).stop(),e.twenMap.delete(t.uuid))}(t);var o=cc.tween(t);return e.twenMap.set(t.uuid,o),o}(t);o.set({angle:0}).to(8,{angle:360}).union().repeatForever(),o.start()},t.SecondToHours=function(t){var e=t%60;e=Math.floor(e/10).toString()+e%10;var o=Math.floor(t/60)%60;o=Math.floor(o/10).toString()+o%10;var i=Math.floor(t/60/60);return("00"==(i=Math.floor(i/10).toString()+i%10)?"":i+":")+o+":"+e},t.twenMap=new Map,t}();a.BraveTowerGameUtils=s,function(t){t.SpeedChange="SpeedChange",t.GameSuspend="GameSuspend",t.GameOver="GameOver",t.GameRestart="GameRestart",t.GamePass="GamePass",t.ScreenShake="ScreenShake",t.ShowTop="ShowTop",t.UpdateRedPoint="UpdateRedPoint",t.UpdateGameUI="UpdateGameUI",t.UpdateFuncRedPoint="UpdateFuncRedPoint",t.UpdateAllShard="UpdateAllShard",t.SwitchTab="SwitchTab",t.UpdateShop="UpdateShop",t.TimeUpdate="TimeUpdate"}(a.BraveTowerEventName||(a.BraveTowerEventName={}));var c=function(){function t(){}return t.MaxDeckNum=6,t.BaseY=-240,t.ForceSplitLine=200,t.CriticalDamage=1.5,t.SkillUnlockStar1=3,t.SkillUnlockStar2=5,t.SpeedUp=2,t.BaseHp=100,t.BGMusic="BraveTowerBG",t.isTest=!1,t}();a.BraveTowerParameter=c;var l=function(){function t(){}return t.Audio="BraveTowerAudio",t.GameCard="BraveTowerGameCard",t.Effect="BraveTowerEffect",t.Enemy="BraveTowerEnemy",t.Map="BraveTowerMap",t.Icon="BraveTowerIcon",t.IconBuff="BraveTowerIconBuff",t.IconCard="BraveTowerIconCard",t.IconCardHead="BraveTowerIconHead",t.IconSkill="BraveTowerIconSkill",t.IconTies="BraveTowerIconTies",t}();a.BraveTowerBundelName=l;var p=function(){function t(){}return t.CardQuality="yz_kz_kpd{0}",t.BuffQuality="yz_zy_pzd{0}",t.CardSkillAni="cardSkill/CardSkill{0}",t}();a.BraveTowerImgName=p;var u=function(){function t(){}return t.ItemGood="ItemGood",t.ItemHp="ItemHp",t.EffectHit="EnemyHit",t.EffectDie="EnemyDie",t.EffectStun="EnemyStun",t.EffectSlow="EnemySlow",t.EffectRecovery="Recovery",t.EffectTies13="Ties13",t}();a.BraveTowerPrefabName=u;var d=function(){function t(){}return t.ItemGood="BraveTowerItemGood",t.ItemHp="BraveTowerItemHp",t.EnemyName="BraveTowerEnemy",t.CardBulletName="BraveTowerCardBullet",t.EffectEnemyHitName="BraveTowerEffectEnemyHit",t.EffectEnemyDeadName="BraveTowerEffectEnemyDead",t.EffectStunName="BraveTowerEnemyStun",t.EffectSlowName="BraveTowerEffectSlow",t.EffectRecoveryName="BraveTowerEffectRecovery",t.EffectTies13Name="BraveTowerEffectTies13",t}();a.BraveTowerPoolName=d,function(t){t[t.Preparation=1]="Preparation",t[t.GameIng=2]="GameIng",t[t.Suspend=3]="Suspend",t[t.GameOver=4]="GameOver"}(a.BraveTowerGameStage||(a.BraveTowerGameStage={})),function(t){t[t.Normal=1]="Normal",t[t.Boss=2]="Boss"}(a.BraveTowerGameMode||(a.BraveTowerGameMode={})),function(t){t[t.LoginDays=1]="LoginDays",t[t.DailyTaskNum=2]="DailyTaskNum",t[t.MainMapNum=3]="MainMapNum",t[t.MainMapProgress=4]="MainMapProgress",t[t.CardNum=5]="CardNum",t[t.CardLevel=6]="CardLevel",t[t.DailyMapNum=7]="DailyMapNum",t[t.RecruitNum=8]="RecruitNum",t[t.GetGold=9]="GetGold",t[t.CoreCombatKillNum=10]="CoreCombatKillNum",t[t.CoreCombatBuyCardNum=11]="CoreCombatBuyCardNum",t[t.CoreCombatGetCoinNum=12]="CoreCombatGetCoinNum",t[t.CoreCombatRefreshCardNum=13]="CoreCombatRefreshCardNum",t[t.AdNum=14]="AdNum"}(a.BraveTowerTaskType||(a.BraveTowerTaskType={})),function(t){t.OnLineTime="OnLineTime",t.AddDeck="AddDeck"}(a.TimeByKey||(a.TimeByKey={}));var h=function(){function t(){}return t.BuffAll=function(){return!0},t.VideoUnlockGridNum=function(){return 1},t.BuyCoinBubble=function(){return!0},t.ForceTiesCard=function(){return!0},t.CardRefreshType=function(){return 2},t.BuffRefreshType=function(){return 2},t.SkillTYpe=function(){return"B"==r.PlayerMgr.getInstance().getAbType()?2:1},t}();a.BraveTowerSwitch=h,cc._RF.pop(),cc._RF.pop()},{}],BtnPress:[function(t,e,o){"use strict";cc._RF.push(e,"413e3HtmatAPJVt2j3U6+xJ","BtnPress");var i=t,n=e,a=o;cc._RF.push(n,"413e3HtmatAPJVt2j3U6+xJ","BtnPress");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("AudioMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=u.requireComponent,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprNormal=null,e.sprPressed=null,e.numDev=0,e.callBack=null,e}return s(e,t),e.prototype.start=function(){var t=this;this.node.children.forEach(function(t){var e;t.attr(((e={})[l.ChilidPos]=t.getPosition().clone(),e))}),this.node.on(cc.Node.EventType.TOUCH_START,function(){p.AudioMgr.getInstance().playAudioButtonClicked(),t.node.getComponent(cc.Sprite).spriteFrame=t.sprPressed,t.node.children.forEach(function(e){var o=e[l.ChilidPos];e.setPosition(o.x,o.y+t.numDev)})},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.node.getComponent(cc.Sprite).spriteFrame=t.sprNormal,t.node.children.forEach(function(t){var e=t[l.ChilidPos];t.setPosition(e)}),t.callBack&&t.callBack(!1)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.node.getComponent(cc.Sprite).spriteFrame=t.sprNormal,t.node.children.forEach(function(t){var e=t[l.ChilidPos];t.setPosition(e)}),t.callBack&&t.callBack(!0)},this)},e.prototype.init=function(t){this.callBack=t},c([h(cc.SpriteFrame)],e.prototype,"sprNormal",void 0),c([h(cc.SpriteFrame)],e.prototype,"sprPressed",void 0),c([h(Number)],e.prototype,"numDev",void 0),c([d,f(cc.Sprite)],e)}(cc.Component);a.default=m,(l||(l={})).ChilidPos="ChilidPos",cc._RF.pop(),cc._RF.pop()},{}],BuildCustomEvent:[function(t,e,o){"use strict";cc._RF.push(e,"1fb7aG/GlVG/Z3KSCRaZp8f","BuildCustomEvent");var i=t,n=e,a=o;cc._RF.push(n,"1fb7aG/GlVG/Z3KSCRaZp8f","BuildCustomEvent"),Object.defineProperty(a,"__esModule",{value:!0}),i("BasePlatform"),i("Appcfg"),i("PlatformConfig"),i("PlatformSetting"),cc._RF.pop(),cc._RF.pop()},{}],ButtonCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"cc124IrOZZNKIbnCYwx33YC","ButtonCtrl");var i=t,n=e,a=o;cc._RF.push(n,"cc124IrOZZNKIbnCYwx33YC","ButtonCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("WeaponCtrl"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.start=function(){var t=this.node.getChildByName("btnAdd"),e=this.node.getChildByName("btnDel");t.on(cc.Node.EventType.TOUCH_START,function(){l.default.instance.addWeapon(1)}),e.on(cc.Node.EventType.TOUCH_START,function(){l.default.instance.delWeapon()})},c([u],e)}(cc.Component));a.default=d,cc._RF.pop(),cc._RF.pop()},{}],ByteDanceManager:[function(t,e,o){"use strict";cc._RF.push(e,"8689fthaktNl4kLM0x7QkR+","ByteDanceManager");var i=t,n=e,a=o;cc._RF.push(n,"8689fthaktNl4kLM0x7QkR+","ByteDanceManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.BytedanceManager=a.registerHeadImgLoader=a.headImgExt=void 0;var r=i("BasePlatform"),s=i("TimeUtils"),c=i("Config"),l=i("Appcfg"),p=i("PlatformConfig"),u=i("PlatformSetting"),d=i("EventMgr"),h=i("LogMgr"),f=i("CacheUtils");function m(){cc.assetManager.downloader.register(a.headImgExt,function(t,e,o){o(null,t)}),cc.assetManager.parser.register(a.headImgExt,cc.assetManager.downloader.downloadDomImage),cc.assetManager.factory.register(a.headImgExt,function(t,e,o,i){var n=null,a=null;try{(n=new cc.Texture2D)._uuid=t,n._nativeUrl=t,n._nativeAsset=e}catch(t){a=t}i&&i(a,n)})}a.headImgExt=".head",a.registerHeadImgLoader=m;var g=["021036","021001","011004","101001","021003","061001","061004"],y=function(){function t(){this.videoAd=null,this.BannerAd=null,this.InterstitialAd=null,this.BannerAdHight=0,this.BannerAdWight=0,this.showInsertTime=0,this.isLogin=!1,this.videpPath=null,this.preTime=-1,this.isLoginByte=!1,this.loginState=!1}return t.prototype.getLauchParams=function(){if(!this._systemInfo||!this.launchOpt){this._systemInfo=tt.getSystemInfoSync(),this.launchOpt=tt.getLaunchOptionsSync();var t,e=this.launchOpt.ad_params;if(e&&e.length>0){var o=JSON.parse(e);t=o.clickid,o.projectid,this.clickId=t}this.launchOpt.query&&(null!=this.clickId&&""!=this.clickId||(this.clickId=this.launchOpt.query.clickid));var i=localStorage.getItem("igame_clickid");null!=i&&""!=i&&(this.clickId=i)}},t.prototype.getIsZhiTouUser=function(){return this.getLauchParams(),null!=this.clickId&&""!=this.clickId},t.prototype.initSdk=function(){tt.sffile={};var t=tt.getFileSystemManager();try{t.accessSync("ttfile://user/data.json");var e=t.readFileSync("ttfile://user/data.json","utf-8");tt.sffile=JSON.parse(e)}catch(e){tt.downloadFile({url:"https://game.sfplay.net/data.json",success:function(e){t.saveFileSync(e.tempFilePath,"ttfile://user/data.json")},fail:function(){}})}m(),this._systemInfo=tt.getSystemInfoSync(),this._systemInfo.windowWidth,this._systemInfo.windowHeight,this.videoAd=tt.createRewardedVideoAd({adUnitId:p.AdConfig[u.PlatformSetting.currentApp][r.Platform.BYTEDANCE].videoId}),this.onshow()},t.prototype.onshow=function(){var t=this;tt.onShow(function(e){t.query=e.query,d.EventMgr.getInstance().emit(l.BaseEventName.onShow,e)})},t.prototype.getLaunchOptionsSync=function(t){var e=tt.getLaunchOptionsSync();console.log("this RoomID ========options=======",e),t&&t(e.query)},t.prototype.shareVideo=function(t,e){var o=t,i=this;if(null!=o&&0!=o.length&&null!=o){var n=p.AdConfig[u.PlatformSetting.currentApp][r.Platform.BYTEDANCE].appTitle;tt.shareAppMessage({channel:"video",query:"",templateId:"kb0faho0bc3179g6j2",title:n,desc:n,extra:{videoPath:o,videoTopics:n,withVideoId:!0},success:function(){i.videpPath=null,tt.showToast({title:"\u5206\u4eab\u89c6\u9891\u6210\u529f",duration:2e3,success:function(){},fail:function(){}}),e&&e()},fail:function(){tt.showToast({title:"\u5206\u4eab\u89c6\u9891\u5931\u8d25",duration:2e3,success:function(){},fail:function(){}})}})}else tt.showToast({title:"\u8fd8\u6ca1\u6709\u5206\u4eab\u5185\u5bb9",duration:2e3,success:function(){},fail:function(){}})},t.prototype.shareImg=function(t,e){var o=Math.floor(3*Math.random());tt.shareAppMessage({title:["\u5e2e\u6211\u770b\u770b\u54ea\u4e2a\u5b57\u9519\u4e86\uff1f","\u4f60\u662f\u9003\u4e0d\u8fc7\u6211\u7684\u773c\u775b\u7684\uff01","\u5e2e\u6211\u770b\u770b\u54ea\u4e00\u53ea\u4e0d\u662f\u4f01\u9e45"][o],desc:"",imageUrl:"https://game2.sfplay.net/werid_assets/wechat/shareIcon/"+["1.jpeg","2.jpeg","3.jpeg"][o],query:"",success:function(){e&&e(),console.log("\u5206\u4eab\u6210\u529f")},fail:function(){console.log("\u5206\u4eab\u5931\u8d25")}})},t.prototype.checkShortcut=function(t,e){"ios"!=this._systemInfo.platform?tt.checkShortcut({success:function(t){t.status.exist?e&&e(!0):e&&e(!1)},fail:function(){e&&e(!0)}}):e&&e("1"==f.CacheUtils.getData("SHORT_CUT_KEY"))},t.prototype.addShortcut=function(t,e){tt.addShortcut({success:function(){e&&e("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u6210\u529f"),f.CacheUtils.saveData("SHORT_CUT_KEY","1")},fail:function(){e&&e("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u5931\u8d25")}})},t.prototype.hasVerify=function(){return!1},t.prototype.getUserInfo=function(t){tt.login({force:!1,success:function(){console.log("\u767b\u5f55\u6210\u529f"),tt.getUserInfo({success:function(e){"getUserInfo:ok"==e.errMsg?t(e.userInfo.nickName,e.userInfo.avatarUrl):t(null,null)},fail:function(){t(null,null)}})}})},t.prototype.showGamePortalAd=function(t,e){tt.onMoreGamesModalClose(function(){}),tt.onNavigateToMiniGameBox(function(){}),"ios"!==this._systemInfo.platform&&tt.showMoreGamesModal?tt.showMoreGamesModal({appLaunchOptions:[{appId:"ttd63da0804905658f02"},{appId:"tt3b934d2ea4ab8a8202"},{appId:"tta7dcd16138e7e202"},{appId:"tt9325e5980c1e8576"},{appId:"ttf1bf87026e84c9f9"},{appId:"tt93c9e5740cf268b9"},{appId:"ttf21484a96d2f6816"},{appId:"tt6a4c1cf1f5761949"},{appId:"tt0c7a7ac793413665"},{appId:"tt914ae7f70e72364302"}],success:function(){},fail:function(){e&&e("error")}}):e&&e(null)},t.prototype.canShare=function(){return!0},t.prototype.pauseRecord=function(){tt.getGameRecorderManager().pause()},t.prototype.resumeRecord=function(){tt.getGameRecorderManager().resume()},t.prototype.youmengTrack=function(t,e,o){e&&o?"userA"==e?tt.uma.trackEvent(t,{userA:o}):"userB"==e?tt.uma.trackEvent(t,{userB:o}):"userD"==e?tt.uma.trackEvent(t,{userD:o}):tt.uma.trackEvent(t,{userC:o}):tt.uma.trackEvent(t),sfdata.SfTrackData.instance.trackEvent(t,e,o)},t.prototype.recordVideo=function(){var t=tt.getGameRecorderManager();t&&(this.videpPath=null,t.onStart(function(){console.log("\u5f55\u5c4f\u5f00\u59cb")}),t.start({duration:300,isMarkOpen:!1}))},t.prototype.showVideoAd=function(t,e,o){var i=this;tt.showLoading({title:"\u8bf7\u6c42\u4e2d\uff0c\u8bf7\u7a0d\u540e...",success:function(t){console.log(""+t)},fail:function(){console.log("showLoading\u8c03\u7528\u5931\u8d25")}}),this.videoAd.show().then(function(){}).catch(function(t){console.log("\u5e7f\u544a\u7ec4\u4ef6\u51fa\u73b0\u95ee\u9898",t),i.videoAd.load().then(function(){return console.log("\u624b\u52a8\u52a0\u8f7d\u6210\u529f"),i.videoAd.show()})});var n=this;this.videoAd.onClose(function t(a){if(tt.hideLoading(),a&&a.isEnded){var r=!0,s=(new Date).getTime();-1==i.preTime?r=!0:s-i.preTime<1e4&&(r=!1),i.preTime=s,r?e&&e():o()}else o();n.videoAd.offClose(t),n.videoAd.load()}),this.videoAd.onError(function(t,e){e&&e.length>0?o(e):o("\u6682\u65e0\u5e7f\u544a")})},t.prototype.setLanguage=function(){return""},t.prototype.stopRecorderManager=function(t,e,o){var i=this,n=tt.getGameRecorderManager();n.onStop(function(n){e&&e(n.videoPath),t&&setTimeout(function(){i.shareVideo(n.videoPath,o)},.1)}),n.stop()},t.prototype.getAppName=function(){return this._systemInfo.appName},t.prototype.login=function(t,e){if(this.isLoginByte)e(this.loginState);else{var o=this;tt.login({force:!1,success:function(t){o.isLoginByte=!0,o.loginState=t.isLogin,e(t.isLogin)}})}},t.prototype.pay=function(){},t.prototype.showBanner=function(){null!=this.BannerAd&&this._systemInfo.appName!==c.ByteAppName.XiGua&&this.BannerAd.show()},t.prototype.hideBanner=function(){null==this.BannerAd&&this._systemInfo.appName!==c.ByteAppName.XiGua||this.BannerAd.hide()},t.prototype.showInsertAd=function(t,e){var o=this;if(s.TimeUtils.GetTimeBySecond()-this.showInsertTime>=31){var i=this._systemInfo.appName;i!=c.ByteAppName.Toutiao&&i!=c.ByteAppName.Douyin||(this.InterstitialAd&&(this.InterstitialAd.destroy(),this.InterstitialAd=null),this.InterstitialAd=tt.createInterstitialAd({adUnitId:p.AdConfig[u.PlatformSetting.currentApp][r.Platform.BYTEDANCE].insertId}),this.InterstitialAd.load().then(function(){o.InterstitialAd.show().then(function(){o.showInsertTime=s.TimeUtils.GetTimeBySecond(),e&&e()}).catch(function(){e&&e()})}).catch(function(){e&&e()}))}},t.prototype.playMultitonVideo=function(t,e,o,i,n){var a=tt.createRewardedVideoAd({adUnitId:p.AdConfig[u.PlatformSetting.currentApp][r.Platform.BYTEDANCE].multitonVideoId,multiton:!0,multitonRewardMsg:t,multitonRewardTimes:e,progressTip:o});a.show().then(function(){}).catch(function(t){console.log("\u5e7f\u544a\u7ec4\u4ef6\u51fa\u73b0\u95ee\u9898",t),a.load().then(function(){return console.log("\u624b\u52a8\u52a0\u8f7d\u6210\u529f"),a.show()})}),a.onClose(function t(e){e&&e.isEnded?(i&&i(e.count),console.log("\u6b63\u5e38\u64ad\u653e\u7ed3\u675f\uff0c\u53ef\u4ee5\u4e0b\u53d1\u6e38\u620f\u5956\u52b1")):(n&&n(),console.log("\u64ad\u653e\u4e2d\u9014\u9000\u51fa\uff0c\u4e0d\u4e0b\u53d1\u6e38\u620f\u5956\u52b1")),a.destory(),a.offClose(t),a.load()}),a.onError(function(t,e){e&&e.length>0?n&&n(e):n&&n("\u6682\u65e0\u5e7f\u544a")})},t.prototype.canCare=function(){return this._systemInfo.appName==c.ByteAppName.Douyin},t.prototype.otherFun=function(t,e){this._systemInfo.appName==c.ByteAppName.Douyin?tt.login({force:!1,success:function(t){console.log("\u767b\u5f55\u6210\u529f"),t.isLogin?tt.openAwemeUserProfile?(tt.openAwemeUserProfile(),setTimeout(function(){e&&e()},3500)):tt.showToast({title:"\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd",duration:2e3,success:function(){},fail:function(){}}):tt.showToast({title:"\u8bf7\u5148\u767b\u5f55",duration:2e3,success:function(){},fail:function(){}})}}):tt.showToast({title:"\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd",duration:2e3,success:function(){},fail:function(){}})},t.prototype.homeToBackgroud=function(){},t.prototype.backgroudToHome=function(){},t.prototype.openNotify=function(){},t.prototype.registerNotify=function(){},t.prototype.deleteNotify=function(){},t.prototype.shark=function(t){1==t?tt.vibrateLong():tt.vibrateShort()},t.prototype.openShare=function(){},t.prototype.compareVersion=function(t,e){t=t.split("."),e=e.split(".");for(var o=Math.max(t.length,e.length);t.length<o;)t.push("0");for(;e.length<o;)e.push("0");for(var i=0;i<o;i++){var n=parseInt(t[i]),a=parseInt(e[i]);if(n>a)return 1;if(n<a)return-1}return 0},t.prototype.share=function(){},t.prototype.getCode=function(){return"134"},t.prototype.verifyKey=function(){},t.prototype.toAppStore=function(){},t.prototype.getSystem=function(){return this._systemInfo.platform},t.prototype.checkCanOpenSideBar=function(t){this._systemInfo.appName==c.ByteAppName.Douyin||this._systemInfo.appName==c.ByteAppName.douyin_lite?tt.checkScene?tt.checkScene({scene:"sidebar",success:function(e){t(e.isExist)},complete:function(){},fail:function(){t(!1)}}):t(!1):(console.log("--\u5e73\u53f0\u9519\u8bef-------"),t(!1))},t.prototype.openSideBar=function(t){this._systemInfo.appName==c.ByteAppName.Douyin||this._systemInfo.appName==c.ByteAppName.douyin_lite?tt.navigateToScene?tt.navigateToScene({scene:"sidebar",success:function(){t&&t(!0)},complete:function(){},fail:function(){t&&t(!1)}}):t&&t(!1):(t&&t(!1),h.LogMgr.getInstance().error("\u5e73\u53f0\u9519\u8bef"))},t.prototype.isFromBroadside=function(t){for(var e,o,i=tt.getLaunchOptionsSync(),n=0;n<g.length;n++)if(g[n]==i.scene){e=!0;break}return o=t&&"homepage"==t.launch_from&&"sidebar_card"==t.location,e||o},t}();a.BytedanceManager=y,cc._RF.pop(),cc._RF.pop()},{}],ByteDanceServerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a13a7jOzf9IQKzhhKYM4K4Z","ByteDanceServerMgr");var i=t,n=e,a=o;cc._RF.push(n,"a13a7jOzf9IQKzhhKYM4K4Z","ByteDanceServerMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.ByteDanceServerMgr=void 0;var r=i("Config"),s=i("Appcfg"),c=i("EventMgr"),l=i("SfSendQueue"),p=function(){function t(t,e,o){this.platform=1,this.isOpened=!1,this.openIdKey="igame_openId",this.canUpdate=!0,this.isClear=!1,this.isLoaded=!1,this.isneeduid=!1,this.isonHide=!1,this.url=t,this.isOpened=o,this.appId=e}return t.prototype.init=function(t){var e=this;this.isOpened?(this.getOpenId(function(){t&&t()}),this.isonHide||(this.isonHide=!0,tt.onHide(function(){e.isClear||c.EventMgr.getInstance().emit(s.BaseEventName.onHide)}))):t&&t()},t.prototype.getNeedSaveServer=function(){return this.isOpened},t.prototype.clearDataByKey=function(t,e){this.isOpened?(this.isClear=!0,t=(t=t.replace(r.GameConfig.AppCacheName,"")).trim(),this.saveData(t,"{}",e)):e&&e()},t.prototype.getDataByKey=function(t){return this.isOpened?(t=(t=t.replace(r.GameConfig.AppCacheName,"")).trim(),this.data?"undefined"==this.data[t]||"{}"==this.data[t]?null:this.data[t]:null):null},t.prototype.getOpenId=function(t,e){if(void 0===e&&(e=!1),this.isOpened||e)if(this.openId=window.openId,this.openId)t(this.openId);else{var o=this,i=localStorage.getItem(this.openIdKey);if(i)return this.openId=i,window.openId=this.openId,void t(this.openId);if(i=localStorage.getItem("um_od"))return this.openId=i,window.openId=this.openId,void t(this.openId);tt.login({force:!1,success:function(e){if(e.code){var i={appId:o.appId,code:e.code,platform:o.platform};l.SfTrackHttp.httpGet(o.url+"/getOpenId",i,function(e){0==e.code?(o.openId=e.data.openid,localStorage.setItem(o.openIdKey,o.openId),t&&t(o.openId)):t&&t()})}else console.log("\u8bf7\u6c42\u767b\u5f55\u5931\u8d25="+e.errMsg),t&&t()},fail:function(e){console.log("login\u767b\u5f55\u5931\u8d25="+JSON.stringify(e)),t&&t()}})}else t&&t(null)},t.prototype.loadData=function(t){var e=this;if(this.isOpened){var o=this,i=tt.getLaunchOptionsSync(),n={appId:o.appId,thirdId:o.openId,platform:o.platform,appGameId:i.extra.appId};l.SfTrackHttp.httpGet(o.url+"/loginData",n,function(i){null!=i?0==i.code?(l.SfTrackHttp.TOKEN=i.token,e.data=i.data,t&&t(i.data)):-2==i.code?(o.canUpdate=!1,tt.showModal({title:"\u63d0\u793a",content:"\u4ee3\u7801\u4fee\u6539\u6b63\u786e\u7684appid",success:function(t){t.confirm?console.log("\u7528\u6237\u70b9\u51fb\u786e\u5b9a"):t.cancel&&console.log("\u7528\u6237\u70b9\u51fb\u53d6\u6d88")}})):t&&t(null):t&&t(null)})}else t&&t(null)},t.prototype.checkLogin=function(t){this.isOpened?this.openId?t():this.getOpenId(function(){t()}):t&&t(null)},t.prototype.saveData=function(t,e,o){var i=this;if(this.isOpened)if(this.canUpdate){t=(t=t.replace(r.GameConfig.AppCacheName,"")).trim();var n=this;this.checkLogin(function(){var a=new l.SendConfig;a.callback=function(t){0==t.code?o&&o(t.data):-10==t.code?(i.isOpened=!1,tt.showModal({title:"\u8b66\u544a",showCancel:!1,content:"\u8d26\u53f7\u5728\u5176\u4ed6\u8bbe\u5907\u767b\u5f55\uff0c\u6b64\u8bbe\u5907\u5c06\u5f3a\u5236\u4e0b\u7ebf",success:function(t){(t.confirm||t.cancel)&&tt.exitMiniProgram({})}})):(console.error(t),o&&o(null))};var r={appId:n.appId,thirdId:n.openId,platform:n.platform,key:t,value:e};l.SendQueue.enqueue(r,n.url+"/saveData",a)})}else o&&o(null);else o&&o(null)},t.prototype.clearAllData=function(t){var e={appId:this.appId,thirdId:this.openId,platform:this.platform};l.SfTrackHttp.httpGet(this.url+"/remove",e,function(e){null!=e?0==e.code?tt.restartMiniProgramSync():t&&t(!1):t&&t(null)})},t}();a.ByteDanceServerMgr=p,cc._RF.pop(),cc._RF.pop()},{}],COMMON_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"fb161mjxetGh6s2sui2XHlP","COMMON_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"fb161mjxetGh6s2sui2XHlP","COMMON_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Utils"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentCtrl=null,e}return s(e,t),e.prototype.isCirt=function(t,e,o){this.parentCtrl||(this.parentCtrl=o),t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e.toString()):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e.toString()),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=l.Utils.randomRang(-30,30),o=l.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){t.parentCtrl.recycleBlood(t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.opacity=255},e.prototype.onLoad=function(){},e.prototype.start=function(){},c([d(cc.Node)],e.prototype,"isCritState",void 0),c([d(cc.Label)],e.prototype,"critLabel",void 0),c([d(cc.Label)],e.prototype,"commonLabel",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],COMMON_BloodLayerCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"b1ce3y1tpNKfpKZljIcekqD","COMMON_BloodLayerCtrl");var i=t,n=e,a=o;cc._RF.push(n,"b1ce3y1tpNKfpKZljIcekqD","COMMON_BloodLayerCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("NodeLib"),u=i("common_Configs"),d=i("COMMON_BloodCtrl"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_blood=null,e.bloodArr=[],e}return s(e,t),e.prototype.initProperty=function(){this.pro_blood=p.default.findChildByName(this.node,"blood")},e.prototype.initPool=function(){l.PoolMgr.getInstance().creatrePool(u.Common_PoolName.com_blood,this.pro_blood)},e.prototype.createBlood=function(t,e,o){var i=this.bloodArr.pop();i||((i=l.PoolMgr.getInstance().getNode(u.Common_PoolName.com_blood)).parent=this.node);var n=i.getComponent(d.default);i.setPosition(o),n.resumeNode(),n.isCirt(e,t,this)},e.prototype.recycleBlood=function(t){this.bloodArr.push(t)},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.initPool()},c([f],e)}(cc.Component));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],COMMON_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"7761aoGysdLq7Yt2dF0jn8e","COMMON_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"7761aoGysdLq7Yt2dF0jn8e","COMMON_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("NodeLib"),h=i("common_Configs"),f=i("COMMON_BloodLayerCtrl"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgTexture=null,e.pro_bg=null,e.pro_layer=null,e.pro_bloodLayerCtrl=null,e.pro_beginNode=null,e.pro_weblinkLabel=null,e.pro_btn_pause=null,e.pro_pauseLayer=null,e.pro_heroBaneer=null,e.pro_mateBanner=null,e.pro_fence=null,e.pro_hit=null,e.pro_warn=null,e}var o;return s(e,t),o=e,e.prototype.init=function(t){this.bgTexture=t},e.prototype.initListenEvent=function(){this.addEvent(h.Common_EventName.common_loseBlood,this.showLoseLabel),this.addEvent(h.Common_EventName.common_screenShake,this.onScreenShake),this.addEvent(h.Common_EventName.common_warn,this.playWarn)},e.prototype.initProperty=function(){this.pro_bg=d.default.findChildByName(this.node,"pro_bg"),this.pro_layer=d.default.findChildByName(this.node,"layer"),this.pro_bloodLayerCtrl=d.default.findChildByName(this.pro_layer,"bloodLayer").getComponent(f.default),this.pro_beginNode=d.default.findChildByName(this.node,"beginNode"),this.pro_weblinkLabel=d.default.findChildByName(this.node,"weblinkLabel"),this.pro_btn_pause=d.default.findChildByName(this.node,"btn_pause"),this.pro_pauseLayer=d.default.findChildByName(this.node,"pauseLayer"),this.pro_heroBaneer=d.default.findChildByName(this.node,"heroBaneer"),this.pro_mateBanner=d.default.findChildByName(this.node,"mateBanner"),this.pro_fence=d.default.findChildByName(this.node,"fence");var t=d.default.findChildByName(this.node,"item");this.pro_hit=d.default.findChildByName(t,"hit"),this.pro_warn=d.default.findChildByName(t,"warn")},e.prototype.getLayer=function(){},e.prototype.initview=function(){this.pro_bg.getComponent(cc.Sprite).spriteFrame=this.bgTexture,this.pro_weblinkLabel.active=l.Platform.WEB_LINK==u.PlatformSetting.currentPlatform},e.prototype.showLoseLabel=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=!1);var i=this.pro_bloodLayerCtrl.node.convertToNodeSpaceAR(e);this.pro_bloodLayerCtrl.createBlood(t,o,i)},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.pro_warn),this.pro_warn.active=!0,cc.tween(this.pro_warn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.pro_warn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.pro_warn),t.pro_warn.active=!1}).start()},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.pro_bg),cc.tween(this.pro_bg).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-5,-5)}).by(.05,{position:cc.v3(10,5)}).by(.05,{position:cc.v3(-10,0)}).by(.05,{position:cc.v3(10,-5)}).by(.05,{position:cc.v3(-5,5)}).set({position:cc.v3(0,0)}).start()},e.prototype.onLoad=function(){o.instance=this,this.initProperty()},e.prototype.start=function(){this.initview(),this.initListenEvent()},o=c([g],e)}(p.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],COMMON_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"c0a20L6MtRFULze+PJU/ibr","COMMON_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"c0a20L6MtRFULze+PJU/ibr","COMMON_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.onEnable=function(){this.musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||(u.PlatformSetting.currentPlatform,l.Platform.WEB_LINK)}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([g(cc.Slider)],e.prototype,"musicSlider",void 0),c([g(cc.Slider)],e.prototype,"effectSlider",void 0),c([g(cc.Node)],e.prototype,"btnClose",void 0),c([g(cc.Node)],e.prototype,"btnBackHome",void 0),c([g(cc.Node)],e.prototype,"isDirect",void 0),c([g(cc.Node)],e.prototype,"unDirect",void 0),c([g(cc.Node)],e.prototype,"btnPlay",void 0),c([g(cc.Node)],e.prototype,"gmNode",void 0),c([m],e)}(p.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],COMMON_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"76260deylROgIMTlGUChOl9","COMMON_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"76260deylROgIMTlGUChOl9","COMMON_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndWin=null,e.ndFail=null,e.btn=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([d(cc.Node)],e.prototype,"ndWin",void 0),c([d(cc.Node)],e.prototype,"ndFail",void 0),c([d(cc.Node)],e.prototype,"btn",void 0),c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],CacheUtils:[function(t,e,o){"use strict";cc._RF.push(e,"10a38ih4QhFgKSieTDoZOM5","CacheUtils");var i=t,n=e,a=o;cc._RF.push(n,"10a38ih4QhFgKSieTDoZOM5","CacheUtils"),Object.defineProperty(a,"__esModule",{value:!0}),a.CacheUtils=void 0;var r=i("BasePlatform"),s=i("PlatformManager"),c=i("ServerDataMgr"),l=i("Utils"),p=function(){function t(){}return t.saveData=function(t,e){if(s.PlatformManager.currentPlatform==r.Platform.BYTEDANCE){var o=tt.getFileSystemManager();try{tt.sffile[t]=e,o.writeFileSync("ttfile://user/data.json",JSON.stringify(tt.sffile),"utf8")}catch(t){console.error("\u5b58\u50a8\u5230\u6587\u4ef6\u5931\u8d25\uff1a",JSON.stringify(t))}}else if(s.PlatformManager.currentPlatform==r.Platform.WECHAT){o=wx.getFileSystemManager();try{wx.sffile[t]=e,o.writeFileSync(wx.env.USER_DATA_PATH+"/data.json",JSON.stringify(wx.sffile),"utf8")}catch(t){console.error("\u5b58\u50a8\u5230\u6587\u4ef6\u5931\u8d25\uff1a",JSON.stringify(t))}}try{localStorage.setItem(t,e)}catch(t){console.error("\u5b58\u50a8\u5230\u7f13\u5b58\u5931\u8d25\uff1a",JSON.stringify(t))}},t.clearAll=function(t){var e=localStorage.getItem("um_od"),o=localStorage.getItem("igame_openId"),i=localStorage.getItem("igame_openId2"),n=new Map;if(t)for(var a=0;a<t.length;a++){var c=t[a],l=localStorage.getItem(c);l&&n.set(c,l)}if(localStorage.clear(),e&&localStorage.setItem("um_od",e),o&&localStorage.setItem("igame_openId",o),i&&localStorage.setItem("igame_openId2",i),n.forEach(function(t,e){localStorage.setItem(e,t)}),s.PlatformManager.currentPlatform==r.Platform.BYTEDANCE){var p=tt.getFileSystemManager();try{p.writeFileSync("ttfile://user/data.json","{}","utf8")}catch(t){}}else if(s.PlatformManager.currentPlatform==r.Platform.WECHAT){p=wx.getFileSystemManager();try{p.writeFileSync(wx.env.USER_DATA_PATH+"/data.json","{}","utf8")}catch(t){}}},t.getData=function(t){if(s.PlatformManager.currentPlatform==r.Platform.BYTEDANCE){if((e=tt.sffile[t])&&e.length>2)return e}else if(s.PlatformManager.currentPlatform==r.Platform.WECHAT){var e;if((e=wx.sffile[t])&&e.length>2)return e}return localStorage.getItem(t)},t.getServerData=function(t){return c.ServerdataMgr.getDataByKey(t)},t.setServerData=function(t,e,o){c.ServerdataMgr.saveData(t,e,function(t){o&&o(t)})},t.saveDataEncrypt=function(t,e,o){var i=l.Utils.encrypt(e,o);this.saveData(t,i)},t.getDataDecrypt=function(t,e){var o=this.getData(t);return l.Utils.decrypt(o,e)},t.canPlayMusin=function(){var t=this.getData("MUSIC");return!t||"0"!=t},t.canPlayEffect=function(){var t=this.getData("EFFECT");return!t||"0"!=t},t.setPlayMusic=function(t){t?this.saveData("MUSIC","1"):this.saveData("MUSIC","0")},t.setPlayEffect=function(t){t?this.saveData("EFFECT","1"):this.saveData("EFFECT","0")},t}();a.CacheUtils=p,cc._RF.pop(),cc._RF.pop()},{}],CameraCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"dc1bd526Q1PQ45gqqSRoUhl","CameraCtrl");var i=e,n=o;cc._RF.push(i,"dc1bd526Q1PQ45gqqSRoUhl","CameraCtrl");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragonAction=!1,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){o.instance=this},e.prototype.moveCamera=function(t){this.dragonAction||this.node.setPosition(t)},e.prototype.getCameraBounds=function(){var t=cc.view.getVisibleSize(),e=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),o=t.width/2,i=t.height/2;return{min:cc.v2(e.x-o,e.y-i),max:cc.v2(e.x+o,e.y+i)}},o=s([l],e)}(cc.Component));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],CardBullt10:[function(t,e,o){"use strict";cc._RF.push(e,"a12c1mYHHVLsog1o8+Q29qy","CardBullt10");var i=t,n=e,a=o;cc._RF.push(n,"a12c1mYHHVLsog1o8+Q29qy","CardBullt10");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("GameCtrl"),u=i("ItemCardBullt"),d=cc._decorator,h=d.ccclass;d.property,function(t){t[t.Normal=0]="Normal",t[t.Wait=1]="Wait",t[t.Dead=2]="Dead"}(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctrParent=null,e.buff=!1,e.list=[],e}return s(e,t),e.prototype.setBuff=function(t){this.buff=t,this.list=[],this.buff&&(this.vec_1=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),cc.Vec2.subtract(this.vec_2,this.tagWpos,this.vec_1),cc.Vec2.normalize(this.tagWpos,this.vec_2))},e.prototype.onUpdate=function(t){switch(this.status){case l.Normal:if(this.vec_1=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),this.buff)if(cc.Vec2.multiplyScalar(this.vec_2,this.tagWpos,this.speed*t),cc.Vec2.add(this.vec_1,this.vec_1,this.vec_2),this.vec_2=this.node.parent.convertToNodeSpaceAR(this.vec_1),this.node.setPosition(this.vec_2),this.vec_1.x<0||this.vec_1.x>cc.winSize.width||this.vec_1.y<0||this.vec_1.y>cc.winSize.height)this.onWait();else for(var e=p.default.instance.gameData.enemyList,o=0;o<e.length;o++){var i=e[o];if(!i.isDead()&&!this.list.includes(i.uuid)){var n=i.getWpos();cc.Vec2.subtract(this.vec_2,n,this.vec_1),this.vec_2.len()<50&&(this.list.push(i.uuid),this.ctrParent.doAttack(i,this.buff))}}else{cc.Vec2.subtract(this.vec_2,this.tagWpos,this.vec_1);var a=Math.min(this.speed*t,this.vec_2.len());if(0==a)return this.ctrParent.doAttack(this.tag,this.buff),void this.onWait();cc.Vec2.normalize(this.vec_2,this.vec_2),cc.Vec2.multiplyScalar(this.vec_2,this.vec_2,a),cc.Vec2.add(this.vec_1,this.vec_1,this.vec_2),this.vec_2=this.node.parent.convertToNodeSpaceAR(this.vec_1),this.node.setPosition(this.vec_2)}break;case l.Wait:this.keeptime-=t,this.keeptime<=0&&this.onDie()}},e.prototype.onWait=function(){this.status=l.Wait,this.ndBullet.active=!1,this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.stopSystem()}),this.keeptime=this.numKeepTime,this.buff||this.ctrParent.doAttack(this.tag)},c([h],e)}(u.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl01:[function(t,e,o){"use strict";cc._RF.push(e,"635fc3L7q1FUZ5TKqEhOIoa","CardCtrl01");var i=t,n=e,a=o;cc._RF.push(n,"635fc3L7q1FUZ5TKqEhOIoa","CardCtrl01");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("ItemEnemyBase"),g=i("BaseCardCtrl"),y=i("BaseCardSkillCtrl"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.killNum=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.killNum=0},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);e+=this.awakList[2].val[0]*this.buffNum,this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(e+=this.awakList[1].val[0]),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),e+=this.awakList[2].val[1]*this.buffNum,this.starInfo.critDmg=t+e,this.initView(!1),p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo,this.buffNum)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack1)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=1,o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties07);o&&t.hp/t.hpMax>=o[this.cardId][0]&&(e+=o[this.cardId][1]);var i=this.getDamage()*e,n=Math.random(),a=this.getCrit();n<a&&(i*=this.getCritDmg(),this.doCrit()),i=t.onAttacked(i,this.uuid),f.default.instance.addCardDamge(this.cardId,i),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var r=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(r),f.default.instance.ctrEffect.showDamageNum(r,i,n<a?1:0),!0}return!1},e.prototype.doSkillStart=function(){var t=f.default.instance.getNearestEnemy();if(!t)return!1;f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(y.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!1),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=this.awakList[0].val[0],r=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties01);p.LogMgr.getInstance().debug("\u7f81\u7ecacardId: "+this.cardId,"\u7f81\u7eca killNum: "+this.killNum),r&&this.killNum>=r[this.cardId][0]&&(a+=this.awakList[0].val[1]),this.killNum=0;for(var s=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties07),c=0;c<e.length;c++){var l=e[c],u=l.getWpos();if(t.isColl(u)){s&&l.hp/l.hpMax>=s[this.cardId][0]&&(a+=s[this.cardId][1]);var h=o*a,m=Math.random();m<i&&(h*=n,this.doCrit()),h=l.onAttacked(h,this.uuid),f.default.instance.addCardDamge(this.cardId,h),l.isDead()&&this.addDie(2,l),this.addBuff(2,l),f.default.instance.ctrEffect.showDamageNum(u,h,m<i?1:0)}}},e.prototype.addBuff=function(e,o){t.prototype.addBuff.call(this,e,o),2==e&&(o.addBuff(m.Buff.stun,this.awakList[0].val[1]),f.default.instance.gameSkillBuff.addBuffSkill21());var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties07);i&&Math.random()<i.val[0]&&o.addBuff(m.Buff.stun,i.val[1])},e.prototype.doCrit=function(){if(t.prototype.doCrit.call(this),this.starNum>=h.BraveTowerParameter.SkillUnlockStar2){this.buffNum++;var e=this.awakList[2].val[2];this.buffNum>=e&&(this.buffNum=e),this.upData()}p.LogMgr.getInstance().debug("cardId: "+this.cardId,this.buffNum)},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o),f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties01)&&this.killNum++;var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID40);i&&(p.LogMgr.getInstance().debug("buff39",this.cardId,this.starInfo.skilltime*i.value[0]),this.skilltime+=this.starInfo.skilltime*i.value[0])},c([_],e)}(g.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl02:[function(t,e,o){"use strict";cc._RF.push(e,"2b52empCmBF5Lmd9cFj5luA","CardCtrl02");var i=t,n=e,a=o;cc._RF.push(n,"2b52empCmBF5Lmd9cFj5luA","CardCtrl02");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("ItemEnemyBase"),g=i("BaseCardCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.killNum=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.killNum=0,this.buff42=null,this.buff43=null},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack1)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=this.getDamage(),o=Math.random(),i=this.getCrit();o<i&&(e*=this.getCritDmg(),this.doCrit());var n=t.getBuff(m.Buff.slow),a=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties09);if(a&&n&&(e+=e*a[this.cardId][0]),this.buff42&&this.buff42.isget&&(this.buff42.isget=!1,e*=2,p.LogMgr.getInstance().debug("buff42",this.cardId)),e=t.onAttacked(e,this.uuid),f.default.instance.addCardDamge(this.cardId,e),t.isDead()&&(this.addDie(1,t),n)){var r=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID60),s=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties09);r&&s&&(f.default.instance.addGoldNum(r.value[0]),p.LogMgr.getInstance().debug("buff60",r.value[0]))}this.addBuff(1,t);var c=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(c),f.default.instance.ctrEffect.showDamageNum(c,e,o<i?1:0),!0}return!1},e.prototype.doSkillStart=function(){if(!t.prototype.doSkillStart.call(this))return!1;l.AudioMgr.getInstance().playEffect(u.AudioId.skill);var e=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID42);e&&(this.buff42||(this.buff42={time:0,isget:!1}),this.buff42.time++,this.buff42.time>=e.value[0]&&(this.buff42.isget=!0,this.buff42.time=0));var o=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID43);return o&&(this.buff43||(this.buff43={time:0,isget:!1}),this.buff43.time++,this.buff43.time>=o.value[0]&&(this.buff43.isget=!0,this.buff43.time=0)),!0},e.prototype.doSkill=function(t){var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=this.awakList[0].val[0];this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(a+=this.awakList[2].val[0]*this.buffNum);var r=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties02);if(r){a+=r.date*r.val[0];var s=Math.min(Math.floor(this.killNum/r[this.cardId][0]),r[this.cardId][2]);p.LogMgr.getInstance().debug("\u7f81\u7ecacardId: "+this.cardId,r,"\u7f81\u7eca killNum: "+this.killNum,s),a+=r[this.cardId][1]*s}for(var c=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties09),l=0;l<e.length;l++){var u=e[l],g=u.getWpos();if(t.isColl(g)){var y=u.getBuff(m.Buff.slow);c&&y&&(a+=c[this.cardId][0]);var v=o*a,_=Math.random();if(_<i&&(v*=n,this.doCrit()),v=u.onAttacked(v,this.uuid),f.default.instance.addCardDamge(this.cardId,v),this.addBuff(2,u),u.isDead()&&(this.addDie(2,u),y)){var b=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID60),B=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties09);b&&B&&(f.default.instance.addGoldNum(b.value[0]),p.LogMgr.getInstance().debug("buff60",b.value[0]))}f.default.instance.ctrEffect.showDamageNum(g,v,_<i?1:0)}}this.buffNum=0},e.prototype.addBuff=function(e,o){if(t.prototype.addBuff.call(this,e,o),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&o.addBuff(m.Buff.slow,this.awakList[1].val[1],this.awakList[1].val[0]),1==e&&(this.buffNum++,p.LogMgr.getInstance().debug("cardId: "+this.cardId,this.buffNum),this.buff43&&this.buff43.isget)){this.buff43.isget=!1;var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID43);i&&o.addBuff(m.Buff.slow,i.value[2],i.value[1])}},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o),f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties02)&&this.killNum++},c([v],e)}(g.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl03:[function(t,e,o){"use strict";cc._RF.push(e,"8296aMY/M5N7Kb2Z9xy2MFS","CardCtrl03");var i=t,n=e,a=o;cc._RF.push(n,"8296aMY/M5N7Kb2Z9xy2MFS","CardCtrl03");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameTram"),g=i("ItemEnemyBase"),y=i("BaseCardCtrl"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attTiesNum=0,e.buffTies=!1,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.attTiesNum=0,this.buffTies=!1},e.prototype.upData=function(){var t=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties08),e=0;if(t){var o=f.default.instance.getGoldNum(),i=Math.floor(o*t.val[0]);e=Math.min(i,t.val[1])}i=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]);var n=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);n+=e,this.starInfo.Atk=i*n,i=this.baseInfo.AtkSpeed,n=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),n+=e,this.starInfo.AtkSpeed=i*n,(i=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(i=.1),this.starInfo.skilltime=this.baseInfo.skilltime*i,i=this.baseInfo.crit,n=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starInfo.crit=i+n,i=this.baseInfo.critDmg,n=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=i+n,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo),this.initView(!1)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack1)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=this.getDamage(),o=Math.random(),i=this.getCrit();if(this.buffTies&&f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID45)&&(i=1),o<i&&(e*=this.getCritDmg(),this.doCrit()),this.buffTies){this.buffTies=!1,e*=2;var n=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties03);n&&f.default.instance.gameTrammel.setTiesBuffTime(m.TiesBuffType.Ties03,n.val[1],n.val[2],[this.cardId])}e=t.onAttacked(e,this.uuid),f.default.instance.addCardDamge(this.cardId,e),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var a=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(a),f.default.instance.ctrEffect.showDamageNum(a,e,o<i?1:0),!0}return!1},e.prototype.doSkillStart=function(){return!!t.prototype.doSkillStart.call(this)&&(l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0)},e.prototype.doSkill=function(){},e.prototype.doSkill2=function(t){var e=this.getDamage(),o=this.getCrit(),i=this.getCritDmg(),n=e*this.awakList[0].val[0],a=Math.random();a<o&&(n*=i,this.doCrit());var r=t.getWpos();if(n=t.onAttacked(n,this.uuid),f.default.instance.addCardDamge(this.cardId,n),this.addBuff(2,t),t.isDead()){this.addDie(2,t);var s=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties08),c=0;s&&(c=s[this.cardId][0]),f.default.instance.addGoldNum(this.awakList[0].val[1]+c),p.LogMgr.getInstance().debug("\u6708\u534e\u51fb\u6740",this.awakList[0].val[1]+c)}f.default.instance.ctrEffect.showDamageNum(r,n,a<o?1:0)},e.prototype.addBuff=function(e,o){t.prototype.addBuff.call(this,e,o);var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties03);if(i&&1==e){this.attTiesNum++;var n=i.val[0];f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID46)&&(n/=2),this.attTiesNum>=n&&(this.attTiesNum=0,this.buffTies=!0)}this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&o.addBuff(g.Buff.vertigo,-1,{addNum:this.awakList[1].val,buff:this.starNum>=h.BraveTowerParameter.SkillUnlockStar2?this.awakList[2].val:null,timeMax:i?i[this.cardId][1]:-1,attNum:i?Math.round(i[this.cardId][0]*this.getDamage()):-1})},c([_],e)}(y.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl04:[function(t,e,o){"use strict";cc._RF.push(e,"df174MXR4NIO61+HlIjP+fv","CardCtrl04");var i=t,n=e,a=o;cc._RF.push(n,"df174MXR4NIO61+HlIjP+fv","CardCtrl04");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Utils"),d=i("Config"),h=i("GameEnumData"),f=i("BraveTowerEnum"),m=i("GameCtrl"),g=i("GameSkillBuff"),y=i("GameTram"),v=i("BaseCardCtrl"),_=i("BaseCardSkillCtrl"),b=cc._decorator,B=b.ccclass,I=(b.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffMax=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.buffMax=this.awakList[1].val[2]},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(d.AudioId.attack1)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=1;if(m.default.instance.gameTrammel.getTies(h.BraveTowerEnumTiesCfg.Ties04)){var o=m.default.instance.gameBuff.getBuff(h.BraveTowerEnumBuffID.BuffID48);o&&t.hp/t.hpMax<=o.value[0]&&(e+=o.value[1]);var i=m.default.instance.gameBuff.getBuff(h.BraveTowerEnumBuffID.BuffID49);i&&t.hp/t.hpMax>=i.value[0]&&(e+=i.value[1])}var n=this.getDamage()*e,a=Math.random(),r=this.getCrit();a<r&&(n*=this.getCritDmg(),this.doCrit()),n=t.onAttacked(n,this.uuid),m.default.instance.addCardDamge(this.cardId,n),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var s=t.getWpos();return m.default.instance.ctrEffect.showBulletHit(s),m.default.instance.ctrEffect.showDamageNum(s,n,a<r?1:0),!0}return!1},e.prototype.doSkillStart=function(){var t=m.default.instance.getRandomEnemy();if(!t)return!1;m.default.instance.gameTrammel.addSkill(this.cardId),this.tagSkill=t,this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(m.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(_.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),l.AudioMgr.getInstance().playEffect(d.AudioId.skill),!0},e.prototype.doSkill=function(){if(this.tagSkill&&!this.tagSkill.isDead()){var t=this.getDamage(),e=this.getCrit(),o=this.getCritDmg(),i=this.awakList[0].val[0];if(m.default.instance.gameTrammel.getTies(h.BraveTowerEnumTiesCfg.Ties04)){var n=m.default.instance.gameBuff.getBuff(h.BraveTowerEnumBuffID.BuffID48);n&&this.tagSkill.hp/this.tagSkill.hpMax<=n.value[0]&&(i+=n.value[1]);var a=m.default.instance.gameBuff.getBuff(h.BraveTowerEnumBuffID.BuffID49);a&&this.tagSkill.hp/this.tagSkill.hpMax>=a.value[0]&&(i+=a.value[1])}var r=t*i,s=Math.random();s<e&&(r*=o,this.doCrit()),r=this.tagSkill.onAttacked(r,this.uuid),m.default.instance.addCardDamge(this.cardId,r),this.addBuff(2,this.tagSkill),this.tagSkill.isDead()&&this.addDie(2,this.tagSkill),m.default.instance.ctrEffect.showDamageNum(this.tagSkill.getWpos(),r,s<e?1:0)}},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o),2==e&&(this.buffMax+=this.awakList[0].val[1],p.LogMgr.getInstance().debug("cardId2: "+this.cardId,this.buffMax));var i=m.default.instance.gameTrammel.getTies(h.BraveTowerEnumTiesCfg.Ties04);if(i){var n=0,a=m.default.instance.gameBuff.getBuff(h.BraveTowerEnumBuffID.BuffID47);a&&(n=a.value[0]),m.default.instance.gameTrammel.setTiesBuffTime(y.TiesBuffType.Ties041,i.val[0],i.val[1]+n,[this.cardId]),m.default.instance.gameTrammel.setTiesBuffTime(y.TiesBuffType.Ties042,i.val[0],i.val[2]+n,[this.cardId])}if(this.starNum>=f.BraveTowerParameter.SkillUnlockStar1){this.buffNum++,this.buffNum>this.buffMax&&(this.buffNum=this.buffMax);var r=this.awakList[1].val[0];i&&(r*=2),p.LogMgr.getInstance().debug("cardId3: "+this.cardId,r),m.default.instance.addGoldNum(r),m.default.instance.gameSkillBuff.setCardBuffTime(g.CardBuffType.Skill11,-1,this.awakList[1].val[1]*this.buffNum,[this.cardId]),this.upData()}p.LogMgr.getInstance().debug("cardId1: "+this.cardId,this.buffNum,this.buffMax)},e.prototype.onSell=function(){if(this.starNum>=f.BraveTowerParameter.SkillUnlockStar2){for(var t=m.default.instance.ctrUI.cardItemList,e=[],o=0;o<t.length;o++){var i=t[o];0!==i.cardId&&-1!==i.cardId&&i.cardId!==this.cardId&&e.push(i)}var n=this.awakList[2].val[0],a=[];for(o=0;o<n;o++){var r=u.Utils.randomRang(0,e.length),s=e[r];if(a.push(s.cardId),e.splice(r,1),0===e.length)break}m.default.instance.gameSkillBuff.setCardBuffTime(g.CardBuffType.Skill11,-1,this.awakList[1].val[1]*this.buffNum,a)}},e.prototype.getSellPrice=function(){var t=this.cfg.price*this.starNum*.5,e=m.default.instance.gameTrammel.getTies(h.BraveTowerEnumTiesCfg.Ties05);e&&(t+=t*e[this.cardId][0]);for(var o=1,i=m.default.instance.gameBuff.getBuffList(h.BraveTowerEnumBuffType.BuffType13),n=0;n<i.length;n++)o+=i[n].value[0];return Math.round(t*o)},c([B],e)}(v.default));a.default=I,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl05:[function(t,e,o){"use strict";cc._RF.push(e,"9ad12B3/jtOYqyyg2FjaGuM","CardCtrl05");var i=t,n=e,a=o;cc._RF.push(n,"9ad12B3/jtOYqyyg2FjaGuM","CardCtrl05");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("GameCtrl"),f=i("GameSkillBuff"),m=i("ItemEnemyBase"),g=i("BaseCardCtrl"),y=i("BaseCardSkillCtrl"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.killNum=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.killNum=0},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+h.default.instance.getCardBuffTime(this.cardId,h.CardBuffAddType.Attack);this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+h.default.instance.getCardBuffTime(this.cardId,h.CardBuffAddType.AttackSpeed);var o=h.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID61);o&&(e+=o.value[0]*this.killNum),this.starInfo.AtkSpeed=t*e,(t=1-h.default.instance.getCardBuffTime(this.cardId,h.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=h.default.instance.getCardBuffTime(this.cardId,h.CardBuffAddType.Crit),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=h.default.instance.getCardBuffTime(this.cardId,h.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo),this.initView(!1)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack1)},e.prototype.doSkillStart=function(){var t=h.default.instance.getNearestEnemy();if(!t)return!1;h.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(h.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(y.default);this.doSkillList.push(i),i.setParent(this),i.setTag(o,!1);var n=h.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties05);return e.scale=n?2:1,l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){var e=h.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=this.awakList[0].val[0],r=h.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties10);r&&h.default.instance.gameSkillBuff.hasCardBuff(f.CardBuffType.Skill14)&&(a+=r[this.cardId][0]),o*=a;for(var s=0;s<e.length;s++){var c=e[s],l=c.getWpos();if(t.isColl(l)){var p=o,u=Math.random();u<i&&(p*=n,this.doCrit()),p=c.onAttacked(p,this.uuid),h.default.instance.addCardDamge(this.cardId,p),this.addBuff(2,c),c.isDead()&&this.addDie(2,c),h.default.instance.ctrEffect.showDamageNum(l,p,u<i?1:0)}}},e.prototype.addBuff=function(e,o){t.prototype.addBuff.call(this,e,o),2==e&&o.addBuff(m.Buff.weak,this.awakList[0].val[2],this.awakList[0].val[1])},e.prototype.onSell=function(){h.default.instance.gameSkillBuff.delCardBuff(f.CardBuffType.Skill15)},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o);var i=h.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID61);i&&(this.killNum++,this.killNum>i.value[1]&&(this.killNum=i.value[1]),this.upData())},c([_],e)}(g.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl06:[function(t,e,o){"use strict";cc._RF.push(e,"3bf16XA2H1AUqy+u0DV6Q7c","CardCtrl06");var i=t,n=e,a=o;cc._RF.push(n,"3bf16XA2H1AUqy+u0DV6Q7c","CardCtrl06");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("BaseCardCtrl"),g=i("BaseCardSkillCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.killNum=0,e.killBuff71Num=0,e.isCri=!1,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.killNum=0,this.killBuff71Num=0},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack),o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06);if(o){var i=1-f.default.instance.gamePlayInfo.hp/f.default.instance.gamePlayInfo.hpMax;e+=Math.floor(i/o[this.cardId][0])*o[this.cardId][1]}var n=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID71);n&&(e+=n.value[0]*this.killBuff71Num),this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo),this.initView(!1)},e.prototype.doAttackStart=function(e){var o=this,i=this.buffNum+1;if(this.isCri=!1,this.starNum>=h.BraveTowerParameter.SkillUnlockStar2){var n=Math.random(),a=0,r=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties15);r&&(a=r[this.cardId][0]),p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u53d1\u52a8\u6280\u80fd1006003\u6982\u7387",this.awakList[2].val[0]+a),n<this.awakList[2].val[0]+a&&(i*=this.awakList[2].val[1],i=Math.ceil(i),p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u53d1\u52a8\u6280\u80fd1006003",this.buffNum),this.isCri=!0)}var s=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06);if(s){s.date==this.cardId&&(i+=s.val[0]);var c=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID52);c&&(c.time++,c.time>=c.value[0]&&(i+=c.value[1]))}var m=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID53);if(m&&this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(i+=m.value[0]),1==i)l.AudioMgr.getInstance().playEffect(u.AudioId.attack1),t.prototype.doAttackStart.call(this,e);else for(var g=f.default.instance.getEnemysByWeight(i),y=function(e){v.scheduleOnce(function(){g[e].isDead()||(l.AudioMgr.getInstance().playEffect(u.AudioId.attack1),t.prototype.doAttackStart.call(o,g[e]))},.1*e)},v=this,_=0;_<g.length;_++)y(_)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=this.getDamage(),o=Math.random(),i=this.getCrit();(o<i||this.isCri)&&(e*=this.getCritDmg(),this.doCrit());var n=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties15);n&&t.hp/t.hpMax<n.val[0]&&(e+=e*n.val[0]),e=t.onAttacked(e,this.uuid),f.default.instance.addCardDamge(this.cardId,e),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var a=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(a),f.default.instance.ctrEffect.showDamageNum(a,e,o<i||this.isCri?1:0),!0}return!1},e.prototype.doSkillStart=function(){var t=f.default.instance.getNearestEnemy();if(!t)return!1;f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(g.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!1),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){for(var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=this.awakList[0].val[0],r=0,s=0;s<e.length;s++){var c=e[s],l=c.getWpos();if(t.isColl(l)){var u=void 0,h=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties15);u=h&&c.hp/c.hpMax<h.val[0]?o*(a+h.val[1]):o*a;var m=Math.random();m<i&&(u*=n,this.doCrit()),u=c.onAttacked(u,this.uuid),f.default.instance.addCardDamge(this.cardId,u),this.addBuff(2,c),c.isDead()&&(this.addDie(2,c),r++),f.default.instance.ctrEffect.showDamageNum(l,u,m<i?1:0)}}r>this.awakList[0].val[2]&&(r=this.awakList[0].val[2]),p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u6280\u80fd1006001",this.killNum,"\u51fb\u6740\u654c\u4eba\u6570\u91cf: "+r,"\u6280\u80fd\u65f6\u95f4: ",this.starInfo.skilltime,r*this.awakList[0].val[1]),this.skilltime+=this.starInfo.skilltime*r*this.awakList[0].val[1]},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(this.killNum++,this.killNum%this.awakList[1].val[0]==0&&(this.buffNum+=this.awakList[1].val[1],this.buffNum>this.awakList[1].val[2]&&(this.buffNum=this.awakList[1].val[2]),p.LogMgr.getInstance().debug("cardId: "+this.cardId,this.buffNum)));var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID71);i&&(this.killBuff71Num++,this.killBuff71Num>i.value[1]&&(this.killBuff71Num=i.value[1]),this.upData())},c([v],e)}(m.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl07:[function(t,e,o){"use strict";cc._RF.push(e,"f3739uk7ztLK4mZDeTVmfvK","CardCtrl07");var i=t,n=e,a=o;cc._RF.push(n,"f3739uk7ztLK4mZDeTVmfvK","CardCtrl07");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameSkillBuff"),g=i("GameTram"),y=i("ItemEnemyBase"),v=i("BaseCardCtrl"),_=i("BaseCardSkillCtrl"),b=cc._decorator,B=b.ccclass,I=(b.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCri=!1,e.attSkillNum=0,e.attTiesNum=0,e.buffTies=!1,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.attSkillNum=0,this.buffTies=!1},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack2),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(this.attSkillNum++,this.attSkillNum>=this.awakList[1].val[0]&&(this.attSkillNum=0,this.isCri=!0,p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u89e6\u53d1\u66b4\u51fb")))},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=1*this.getDamage(),o=Math.random(),i=this.getCrit();if(this.buffTies&&f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID45)&&(i=1),(o<i||this.isCri)&&(e*=this.getCritDmg(),this.doCrit()),this.buffTies){this.buffTies=!1;var n=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties03);n?(e*=2+n[this.cardId][0],p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u89e6\u53d1\u7f81\u7eca",2+n[this.cardId][0]),f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties03,n.val[1],n.val[2],[this.cardId])):e*=2}e=t.onAttacked(e,this.uuid),f.default.instance.addCardDamge(this.cardId,e),this.addBuff(1,t),this.isCri&&(t.addBuff(y.Buff.stun,this.awakList[1].val[1]),f.default.instance.gameSkillBuff.addBuffSkill21()),t.isDead()&&this.addDie(1,t);var a=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(a),f.default.instance.ctrEffect.showDamageNum(a,e,o<i||this.isCri?1:0),this.isCri=!1,!0}return!1},e.prototype.doSkillStart=function(){var t=f.default.instance.getNearestEnemy();if(!t)return!1;f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(_.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){for(var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=(f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties07),0);a<e.length;a++){var r=e[a],s=r.getWpos();if(t.isColl(s)){var c=this.awakList[0].val[0];r.getBuff(y.Buff.stun)&&(c+=this.awakList[0].val[1]);var l=o*c,p=Math.random();p<i&&(l*=n,this.doCrit()),l=r.onAttacked(l,this.uuid),f.default.instance.addCardDamge(this.cardId,l),this.addBuff(2,r),r.isDead()&&this.addDie(2,r),f.default.instance.ctrEffect.showDamageNum(s,l,p<i?1:0)}}},e.prototype.onSell=function(){f.default.instance.gameSkillBuff.delCardBuff(m.CardBuffType.Skill21)},e.prototype.addBuff=function(e,o){t.prototype.addBuff.call(this,e,o);var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties03);if(i&&1==e){this.attTiesNum++;var n=i.val[0];f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID46)&&(n/=2),this.attTiesNum>=n&&(this.attTiesNum=0,this.buffTies=!0)}var a=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties07);a&&((n=Math.random())<a.val[0]&&o.addBuff(y.Buff.stun,a.val[1]),2==e&&o.addBuff(y.Buff.jumpBack,-1,a[this.cardId][0]))},c([B],e)}(v.default));a.default=I,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl08:[function(t,e,o){"use strict";cc._RF.push(e,"826f6N0roVDGqoHujmacLGr","CardCtrl08");var i=t,n=e,a=o;cc._RF.push(n,"826f6N0roVDGqoHujmacLGr","CardCtrl08");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameSkillBuff"),g=i("GameTram"),y=i("BaseCardCtrl"),v=i("BaseCardSkillCtrl"),_=cc._decorator,b=_.ccclass,B=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.killBuff71Num=0,e.buffMax=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.buffMax=this.awakList[1].val[2],this.killBuff71Num=0},e.prototype.upData=function(){var t=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties04),e=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),o=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);o+=this.awakList[1].val[0]*this.buffNum,t&&this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(o+=t[this.cardId][0]);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID71);i&&(o+=i.value[0]*this.killBuff71Num),this.starInfo.Atk=e*o,e=this.baseInfo.AtkSpeed,o=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),t&&this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(o+=t[this.cardId][0]),this.starInfo.AtkSpeed=e*o,(e=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(e=.1),this.starInfo.skilltime=this.baseInfo.skilltime*e,e=this.baseInfo.crit,o=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),t&&this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(o+=t[this.cardId][0]),this.starInfo.crit=e+o,e=this.baseInfo.critDmg,o=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=e+o,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo,this.buffNum),this.initView(!1)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack2)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=1;if(f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties04)){var o=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID48);o&&t.hp/t.hpMax<=o.value[0]&&(e+=o.value[1]);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID49);i&&t.hp/t.hpMax>=i.value[0]&&(e+=i.value[1])}var n=this.getDamage()*e,a=Math.random(),r=this.getCrit();a<r&&(n*=this.getCritDmg(),this.doCrit());var s=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties15);s&&t.hp/t.hpMax<s.val[0]&&(n+=n*s.val[0]),n=t.onAttacked(n,this.uuid),f.default.instance.addCardDamge(this.cardId,n),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var c=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(c),f.default.instance.ctrEffect.showDamageNum(c,n,a<r?1:0),!0}return!1},e.prototype.doSkillStart=function(){var t=f.default.instance.getNearestEnemy();if(!t)return!1;f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(v.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){for(var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=this.awakList[0].val[0],r=[],s=0;s<e.length;s++){var c=(g=e[s]).getWpos();t.isColl(c)&&r.push(g)}this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill24,this.awakList[2].val[1],this.awakList[2].val[0],[this.cardId],[]),p.LogMgr.getInstance().debug("cardId3: "+this.cardId,"\u52a0\u653b\u901f"));var l=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties04),u=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties15);for(s=0;s<r.length;s++){c=(g=r[s]).getWpos();var g,y=a;if(l){var v=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID48);v&&g.hp/g.hpMax<=v.value[0]&&(y+=v.value[1]);var _=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID49);_&&g.hp/g.hpMax>=_.value[0]&&(y+=_.value[1])}u&&g.hp/g.hpMax<u.val[0]&&(y+=u.val[1]),(r.length<this.awakList[0].val[1]||u)&&(y+=this.awakList[0].val[2]);var b=o*y,B=Math.random();B<i&&(b*=n,this.doCrit()),b=g.onAttacked(b,this.uuid),f.default.instance.addCardDamge(this.cardId,b),this.addBuff(2,g),g.isDead()&&this.addDie(2,g),f.default.instance.ctrEffect.showDamageNum(c,b,B<i?1:0)}},e.prototype.addDie=function(e,o){if(t.prototype.addDie.call(this,e,o),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1){if(this.buffNum++,this.buffNum>this.buffMax&&(this.buffNum=this.buffMax),p.LogMgr.getInstance().debug("cardId1: "+this.cardId,this.buffNum,this.buffMax),Math.random()<this.awakList[1].val[1]){var i=this.skilltime;this.doSkillStart(),this.skilltime=i,p.LogMgr.getInstance().debug("cardId2: "+this.cardId,"\u989d\u5916\u6280\u80fd")}this.upData()}var n=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties04);if(n){var a=0,r=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID47);r&&(a=r.value[0]),f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties041,n.val[0],n.val[1]+a,[this.cardId]),f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties042,n.val[0],n.val[2]+a,[this.cardId])}var s=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID71);s&&(this.killBuff71Num++,this.killBuff71Num>s.value[1]&&(this.killBuff71Num=s.value[1]),this.upData())},c([b],e)}(y.default));a.default=B,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl09:[function(t,e,o){"use strict";cc._RF.push(e,"533b58UzTJLyLPr0wLRr6ST","CardCtrl09");var i=t,n=e,a=o;cc._RF.push(n,"533b58UzTJLyLPr0wLRr6ST","CardCtrl09");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameSkillBuff"),g=i("GameTram"),y=i("ItemEnemyBase"),v=i("BaseCardCtrl"),_=i("BaseCardSkillCtrl"),b=cc._decorator,B=b.ccclass,I=(b.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tiesKill1=0,e.tiesKill2=0,e.tagID=null,e.tiesKill3=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.tiesKill1=0,this.tiesKill1=0,this.tagID=null,this.tiesKill3=0,this.buff42=null,this.buff43=null},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);e+=this.awakList[2].val[0]*this.buffNum,this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&f.default.instance.gameSkillBuff.hasCardBuff(m.CardBuffType.Skill251)&&(t+=this.awakList[2].val[0]);var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11);o&&(e+=o.val[1]*this.tiesKill2),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,this.initView(!1),p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo,this.buffNum)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack2)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=1;this.tiesKill3++,this.tagID!=t.uuid&&(this.tagID=t.uuid,this.tiesKill3=0);var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11);if(o){e+=o[this.cardId][0]*this.tiesKill3,p.LogMgr.getInstance().debug("\u8fde\u7eed\u653b\u51fb\u6b21\u6570",this.cardId,this.tiesKill3);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID64);i&&t.hp/t.hpMax<=i.value[0]&&(e+=i.value[1])}var n=this.getDamage()*e,a=Math.random(),r=this.getCrit();a<r&&(n*=this.getCritDmg(),this.doCrit()),this.buff42&&this.buff42.isget&&(this.buff42.isget=!1,n*=2,p.LogMgr.getInstance().debug("buff42",this.cardId)),n=t.onAttacked(n,this.uuid),f.default.instance.addCardDamge(this.cardId,n),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var s=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(s),f.default.instance.ctrEffect.showDamageNum(s,n,a<r?1:0),!0}return!1},e.prototype.doSkillStart=function(){f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var t=this.skillList.shift();t||(t=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var e=this.getOutPos(),o=t.getComponent(_.default);this.doSkillList.push(o),o.setParent(this),o.setTag(e,!1);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID42);i&&(this.buff42||(this.buff42={time:0,isget:!1}),this.buff42.time++,this.buff42.time>=i.value[0]&&(this.buff42.isget=!0,this.buff42.time=0));var n=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID43);return n&&(this.buff43||(this.buff43={time:0,isget:!1}),this.buff43.time++,this.buff43.time>=n.value[0]&&(this.buff43.isget=!0,this.buff43.time=0)),l.AudioMgr.getInstance().playEffectFree(u.AudioId.support),!0},e.prototype.doSkill=function(){f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill251,this.awakList[0].val[2],this.awakList[0].val[0],[this.cardId]),f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill252,this.awakList[0].val[2],this.awakList[0].val[1],null,[this.cardId]);var t=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties02);t&&f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties02,this.awakList[0].val[2],t[this.cardId][0],[this.cardId]),this.upData(),p.LogMgr.getInstance().debug("\u5361\u724cbuff\u6dfb\u52a0\u6210\u529f",this.cardId)},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o);var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11);i?(this.tiesKill1++,this.tiesKill1>=i.val[0]&&(this.tiesKill1=0,this.tiesKill2++,this.tiesKill2>i.val[2]&&(this.tiesKill2=i.val[2]),this.upData())):(this.tiesKill1=0,this.tiesKill1=0),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(this.skilltime+=this.starInfo.skilltime*this.awakList[1].val[0])},e.prototype.addBuff=function(e,o){if(t.prototype.addBuff.call(this,e,o),1==e&&this.buff43&&this.buff43.isget){this.buff43.isget=!1;var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID43);i&&o.addBuff(y.Buff.slow,i.value[2],i.value[1])}},c([B],e)}(v.default));a.default=I,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl10:[function(t,e,o){"use strict";cc._RF.push(e,"50fa5s0nGdOXryoVnNoPoCs","CardCtrl10");var i=t,n=e,a=o;cc._RF.push(n,"50fa5s0nGdOXryoVnNoPoCs","CardCtrl10");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameSkillBuff"),g=i("CardBullt10"),y=i("BaseCardCtrl"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletList=[],e}return s(e,t),e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),this.starInfo.AtkSpeed=t*e,t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD);var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties14);o&&f.default.instance.gamePlayInfo.hp>=f.default.instance.gamePlayInfo.hpMax&&(t-=o[this.cardId][0]),t<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo),this.initView(!1)},e.prototype.doAttackStart=function(t){var e=this,o=!1;f.default.instance.gameSkillBuff.hasCardBuff(m.CardBuffType.Skill28)&&(o=!0);var i=function(t){e.atktime=0,t.addTag(e.uuid);var i,n=t.getWpos(),a=e.bulletList.shift();a?i=a.node:((i=cc.instantiate(e.prefabBullet)).setParent(f.default.instance.ndArrow),a=i.getComponent(g.default)),i.active=!0;var r=e.getOutPos(),s=f.default.instance.ndArrow.convertToNodeSpaceAR(r);i.setPosition(s),f.default.instance.gameData.playerBullets.push(a),a.initData(n,e,t),a.setBuff(o),l.AudioMgr.getInstance().playEffect(u.AudioId.attack2)},n=1;if(this.starNum>=h.BraveTowerParameter.SkillUnlockStar1){var a=Math.random();a<this.awakList[1].val[2]?(n+=this.awakList[1].val[3],p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u53d1\u52a8\u6280\u80fd1010002",2)):a<this.awakList[1].val[0]&&(n+=this.awakList[1].val[1],p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u53d1\u52a8\u6280\u80fd1010002",1))}var r=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06);if(r){r.date==this.cardId&&(n+=r.val[0]);var s=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID52);s&&(s.time++,s.time>=s.value[0]&&(n+=s.value[1]))}var c=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID53);if(c&&this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(n+=c.value[0]),1==n)i(t);else for(var y=f.default.instance.getEnemysByWeight(n),v=function(t){_.scheduleOnce(function(){y[t].isDead()||i(y[t])},.1*t)},_=this,b=0;b<y.length;b++)v(b)},e.prototype.doAttack=function(t,e){void 0===e&&(e=!1);var o=this.getDamage();e&&(o*=1-this.awakList[0].val[0]);var i=Math.random(),n=this.getCrit();i<n&&(o*=this.getCritDmg(),this.doCrit()),o=t.onAttacked(o,this.uuid),f.default.instance.addCardDamge(this.cardId,o),this.addBuff(1,t),t.isDead()&&this.addDie(1,t);var a=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(a),f.default.instance.ctrEffect.showDamageNum(a,o,i<n?1:0),!0},e.prototype.doSkillStart=function(){return f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0,this.addBuff(2,null),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(){},e.prototype.addBuff=function(e,o){if(t.prototype.addBuff.call(this,e,o),1==e){var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties14);if(i){var n=Math.random(),a=0,r=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID69);r&&(a=r.value[0]),p.LogMgr.getInstance().info("\u89e6\u53d114\u7f81\u7eca\u6982\u7387",this.cardId,i.val[0]+a),n<i.val[0]+a&&f.default.instance.gamePlayInfo.addHp(i.val[1])}}if(2==e){var s=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06),c=0;s&&(c=s[this.cardId][0]),f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill28,this.awakList[0].val[1]+c,this.awakList[0].val[0],[this.cardId]),p.LogMgr.getInstance().debug("cardId: "+this.cardId,"\u6dfb\u52a0buff28",this.awakList[0].val[1]+c)}},c([_],e)}(y.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl11:[function(t,e,o){"use strict";cc._RF.push(e,"fbbe9+xkMlEkpTBsYvESS8A","CardCtrl11");var i=t,n=e,a=o;cc._RF.push(n,"fbbe9+xkMlEkpTBsYvESS8A","CardCtrl11");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("BaseCardCtrl"),g=i("BaseCardSkillCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffMax=0,e.ties13=null,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.buffMax=this.awakList[1].val[2],this.ties13=null},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);e+=this.awakList[1].val[0]*this.buffNum,this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),this.ties13&&(e+=this.ties13.val),this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),e+=this.awakList[1].val[1]*this.buffNum,this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo,this.buffNum),this.initView(!1)},e.prototype.doAttackStart=function(e){var o=this,i=1,n=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID67);if(n&&(i+=n.value[0]),1==i)t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack2);else for(var a=f.default.instance.getEnemysByWeight(i),r=function(e){s.scheduleOnce(function(){a[e].isDead()||(t.prototype.doAttackStart.call(o,a[e]),l.AudioMgr.getInstance().playEffect(u.AudioId.attack2))},.1*e)},s=this,c=0;c<a.length;c++)r(c)},e.prototype.doSkillStart=function(){var t=f.default.instance.getNearestEnemy();if(!t)return!1;f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(g.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg();o*=this.awakList[0].val[0];for(var a=0;a<e.length;a++){var r=e[a],s=r.getWpos();if(t.isColl(s)){var c=o,l=Math.random();l<i&&(c*=n,this.doCrit()),c=r.onAttacked(c,this.uuid),f.default.instance.addCardDamge(this.cardId,c),this.addBuff(2,r),f.default.instance.ctrEffect.showDamageNum(s,c,l<i?1:0)}}},e.prototype.onUpdate=function(t,e){switch(e){case 1:this.skilltime+=t,this.ties13&&(this.ties13.time-=t,this.ties13.time<=0&&(this.ties13=null,this.upData()));break;case 2:this.atktime+=t*this.getAtkSpeed()}},e.prototype.doCrit=function(){t.prototype.doCrit.call(this);var e=!1;this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(this.buffNum++,this.buffNum>this.buffMax&&(this.buffNum=this.buffMax),e=!0);var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties13);o&&(this.ties13={time:o[this.cardId][0],val:o[this.cardId][1]},e=!0),e&&this.upData()},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID40);i&&(p.LogMgr.getInstance().debug("buff39",this.cardId,this.starInfo.skilltime*i.value[0]),this.skilltime+=this.starInfo.skilltime*i.value[0])},c([v],e)}(m.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl12:[function(t,e,o){"use strict";cc._RF.push(e,"bd665m/sRdKZ5Bwpr+jbfBd","CardCtrl12");var i=t,n=e,a=o;cc._RF.push(n,"bd665m/sRdKZ5Bwpr+jbfBd","CardCtrl12");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("ItemEnemyBase"),g=i("BaseCardCtrl"),y=i("BaseCardSkillCtrl"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack2)},e.prototype.doSkillStart=function(){f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var t=this.skillList.shift();t||(t=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var e=this.getOutPos(),o=t.getComponent(y.default);return this.doSkillList.push(o),o.setParent(this),o.setTag(e,!1),l.AudioMgr.getInstance().playEffectFree(u.AudioId.support),!0},e.prototype.doSkill=function(){f.default.instance.gamePlayInfo.addHp(this.awakList[0].val[0]),this.addBuff(2,null),p.LogMgr.getInstance().debug("doSkill",this.cardId,this.awakList[0].val[0])},e.prototype.addBuff=function(e,o){var i=this;t.prototype.addBuff.call(this,e,o);var n=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties14);if(1==e&&n){var a=Math.random(),r=0,s=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID69);s&&(r=s.value[0]),p.LogMgr.getInstance().info("\u89e6\u53d114\u7f81\u7eca\u6982\u7387",this.cardId,n.val[0]+r),a<n.val[0]+r&&f.default.instance.gamePlayInfo.addHp(n.val[1])}2==e&&this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(f.default.instance.gameData.enemyList.forEach(function(t){t.addBuff(m.Buff.stun,i.awakList[1].val[0]),n&&t.addBuff(m.Buff.slow,i.awakList[1].val[0]+n[i.cardId][1],n[i.cardId][0])}),f.default.instance.gameSkillBuff.addBuffSkill21());var c=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties01);c&&(null==o||o.addBuff(m.Buff.damageDown2,-1,c[this.cardId][0]))},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID40);i&&(p.LogMgr.getInstance().debug("buff39",this.cardId,this.starInfo.skilltime*i.value[0]),this.skilltime+=this.starInfo.skilltime*i.value[0])},c([_],e)}(g.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl13:[function(t,e,o){"use strict";cc._RF.push(e,"f2285XISU5G6a7MpT/pkRSR","CardCtrl13");var i=t,n=e,a=o;cc._RF.push(n,"f2285XISU5G6a7MpT/pkRSR","CardCtrl13");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("DataMgr"),f=i("BraveTowerEnum"),m=i("GameCtrl"),g=i("GameTram"),y=i("ItemEnemyBase"),v=i("BaseCardCtrl"),_=i("BaseCardSkillCtrl"),b=cc._decorator,B=b.ccclass,I=(b.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attTiesNum=0,e.buffTies=!1,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.attTiesNum=0,this.buffTies=!1},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=this.getDamage(),o=Math.random(),i=this.getCrit(),n=t.getBuff(y.Buff.slow);if(this.buffTies&&m.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID45)&&(i=1),o<i&&(e*=this.getCritDmg(),this.doCrit()),this.buffTies){this.buffTies=!1,e*=2;var a=m.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties03);a&&m.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties03,a.val[1],a.val[2],[this.cardId])}if(e=t.onAttacked(e,this.uuid),m.default.instance.addCardDamge(this.cardId,e),t.isDead()&&(this.addDie(1,t),n)){var r=m.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID60),s=m.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties09);r&&s&&(m.default.instance.addGoldNum(r.value[0]),p.LogMgr.getInstance().debug("buff60",r.value[0]))}this.addBuff(1,t);var c=t.getWpos();return m.default.instance.ctrEffect.showBulletHit(c),m.default.instance.ctrEffect.showDamageNum(c,e,o<i?1:0),!0}return!1},e.prototype.doSkillStart=function(){var t=m.default.instance.getNearestEnemy();if(!t)return!1;m.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(m.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(_.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){var e=m.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=this.awakList[0].val[0],r=m.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties03);if(r){for(var s=0,c=m.default.instance.ctrUI.getAllCardList(),l=0;l<c.length;l++){var u=c[l];2==h.DataMgr.getInstance().getCardCfg(u.cardId).Gender&&s++}a+=s*r[this.cardId][0],p.LogMgr.getInstance().debug("\u6768\u8d35\u5983\u6280\u80fd\u52a0\u6210",s,s*r[this.cardId][0],a)}for(o*=a,l=0;l<e.length;l++){var f=(u=e[l]).getWpos();if(t.isColl(f)){var g=o;(s=Math.random())<i&&(g*=n,this.doCrit());var v=u.getBuff(y.Buff.slow);if(g=u.onAttacked(g,this.uuid),m.default.instance.addCardDamge(this.cardId,g),this.addBuff(2,u),u.isDead()&&(this.addDie(2,u),v)){var _=m.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID60),b=m.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties09);_&&b&&(m.default.instance.addGoldNum(_.value[0]),p.LogMgr.getInstance().debug("buff60",_.value[0]))}m.default.instance.ctrEffect.showDamageNum(f,g,s<i?1:0)}}},e.prototype.addBuff=function(e,o){t.prototype.addBuff.call(this,e,o);var i=m.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties03);if(i&&1==e){this.attTiesNum++;var n=i.val[0];m.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID46)&&(n/=2),this.attTiesNum>=n&&(this.attTiesNum=0,this.buffTies=!0)}2==e&&o.addBuff(y.Buff.slow,this.awakList[0].val[2],this.awakList[0].val[1])},e.prototype.doCrit=function(){var e=this;if(t.prototype.doCrit.call(this),this.starNum>=f.BraveTowerParameter.SkillUnlockStar1){this.buffNum+=this.awakList[1].val[0];var o=m.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties09),i=0;o&&(i=o[this.cardId][0]),p.LogMgr.getInstance().debug("\u89e6\u53d1\u66b4\u51fb",this.cardId,this.buffNum,this.awakList[1].val[1],i),this.buffNum>=this.awakList[1].val[1]-i&&(this.buffNum=0,m.default.instance.gameData.enemyList.forEach(function(t){t.addBuff(y.Buff.slow,e.awakList[1].val[3],e.awakList[1].val[2])}))}},c([B],e)}(v.default));a.default=I,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl14:[function(t,e,o){"use strict";cc._RF.push(e,"086f7K1faNNv4mmnyA+Jg/2","CardCtrl14");var i=t,n=e,a=o;cc._RF.push(n,"086f7K1faNNv4mmnyA+Jg/2","CardCtrl14");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("BaseCardCtrl"),g=i("BaseCardSkillCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tiesKill1=0,e.tiesKill2=0,e.tiesKill3=0,e.tiesKill4=0,e.buffNum1=0,e.buffNum2=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.buffNum1=0,this.buffNum2=0,this.tiesKill1=0,this.tiesKill1=0,this.tiesKill3=0,this.tiesKill4=0},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);e+=this.awakList[2].val[1]*this.buffNum2,this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),e+=this.awakList[1].val[1]*this.buffNum1,this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit);var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11);o&&(e+=o.val[1]*this.tiesKill2,e+=o[this.cardId][1]*this.tiesKill4),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("info",this.cardId,this.starInfo,this.buffNum,this.buffNum1,this.buffNum2),this.initView(!1)},e.prototype.doAttackStart=function(e){var o=this,i=1,n=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06);if(n){n.date==this.cardId&&(i+=n.val[0]);var a=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID52);a&&(a.time++,a.time>=a.value[0]&&(i+=a.value[1]))}var r=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID53);if(r&&this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(i+=r.value[0]),1==i)t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3);else for(var s=f.default.instance.getEnemysByWeight(i),c=function(e){p.scheduleOnce(function(){s[e].isDead()||(t.prototype.doAttackStart.call(o,s[e]),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3))},.1*e)},p=this,m=0;m<s.length;m++)c(m)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=1,o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06);if(o&&t.hp/t.hpMax<=o[this.cardId][0]&&(e+=o[this.cardId][1]),f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11)){var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID64);i&&t.hp/t.hpMax<=i.value[0]&&(e+=i.value[1])}var n=this.getDamage()*e,a=Math.random(),r=this.getCrit();a<r&&(n*=this.getCritDmg(),this.doCrit()),n=t.onAttacked(n,this.uuid),f.default.instance.addCardDamge(this.cardId,n),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var s=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(s),f.default.instance.ctrEffect.showDamageNum(s,n,a<r?1:0),!0}return!1},e.prototype.doSkillStart=function(){var t=f.default.instance.getNearestEnemy();if(!t)return!1;f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(g.default);return this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),l.AudioMgr.getInstance().playEffect(u.AudioId.skill),!0},e.prototype.doSkill=function(t){for(var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg(),a=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties06),r=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11),s=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID64),c=0;c<e.length;c++){var l=e[c],p=l.getWpos();if(t.isColl(p)){var u=this.awakList[0].val[0];a&&l.hp/l.hpMax<=a[this.cardId][0]&&(u+=a[this.cardId][1]),r&&s&&l.hp/l.hpMax<=s.value[0]&&(u+=s.value[1]);var h=o*u,m=Math.random();m<i&&(h*=n,this.doCrit()),h=l.onAttacked(h,this.uuid),f.default.instance.addCardDamge(this.cardId,h),this.addBuff(2,l),l.isDead()&&this.addDie(2,l),f.default.instance.ctrEffect.showDamageNum(p,h,m<i?1:0)}}},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o),this.buffNum++,this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&this.buffNum%this.awakList[1].val[0]==0&&(this.buffNum1++,this.buffNum1>=this.awakList[1].val[2]&&(this.buffNum1=0),this.upData()),this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&this.buffNum%this.awakList[2].val[0]==0&&(this.buffNum2++,this.buffNum2>=this.awakList[2].val[2]&&(this.buffNum2=0),this.upData());var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11);if(i){var n=!1;this.tiesKill1++,this.tiesKill1>=i.val[0]&&(this.tiesKill1=0,this.tiesKill2++,this.tiesKill2>i.val[2]&&(this.tiesKill2=i.val[2]),n=!0),this.tiesKill3++,this.tiesKill3>=i[this.cardId][0]&&(this.tiesKill3=0,this.tiesKill4++,this.tiesKill4>i[this.cardId][2]&&(this.tiesKill4=0),n=!0),n&&this.upData()}else this.tiesKill1=0,this.tiesKill2=0,this.tiesKill3=0,this.tiesKill4=0},c([v],e)}(m.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl15:[function(t,e,o){"use strict";cc._RF.push(e,"ff630A/VyFDdKOwtJBFKRE3","CardCtrl15");var i=t,n=e,a=o;cc._RF.push(n,"ff630A/VyFDdKOwtJBFKRE3","CardCtrl15");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("BaseCardCtrl"),g=i("BaseCardSkillCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tiesTime08=0,e.tiesTime13=0,e.time1=0,e.time2=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.time1=0,this.time2=0,this.tiesTime08=0,this.tiesTime13=0},e.prototype.upData=function(){var t=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties08),e=0;if(t){var o=f.default.instance.getGoldNum(),i=Math.floor(o*t.val[0]);e=Math.min(i,t.val[1])}i=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]);var n=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);n+=e,this.starInfo.Atk=i*n,i=this.baseInfo.AtkSpeed,n=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),n+=e,this.starInfo.AtkSpeed=i*n,(i=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(i=.1),this.starInfo.skilltime=this.baseInfo.skilltime*i,i=this.baseInfo.crit,n=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starInfo.crit=i+n,i=this.baseInfo.critDmg,n=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=i+n,p.LogMgr.getInstance().debug("\u5f53\u524d\u5c5e\u6027",this.cardId,this.starInfo),this.initView(!1)},e.prototype.doAttackStart=function(e){var o=this,i=1,n=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID67);if(n&&(i+=n.value[0]),1==i)t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3);else for(var a=f.default.instance.getEnemysByWeight(i),r=function(e){s.scheduleOnce(function(){a[e].isDead()||(t.prototype.doAttackStart.call(o,a[e]),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3))},.1*e)},s=this,c=0;c<a.length;c++)r(c)},e.prototype.doSkillStart=function(){var t=f.default.instance.getNearestEnemy();if(!t)return!1;f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var e=this.skillList.shift();e||(e=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var o=t.getWpos(),i=e.getComponent(g.default);if(this.doSkillList.push(i),i.setParent(this),i.setTag(o,!0),1==h.BraveTowerSwitch.SkillTYpe()){var n=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties08);n&&(this.tiesTime08++,this.tiesTime08>=n[this.cardId][0]&&(this.tiesTime08=0,f.default.instance.addGoldNum(n[this.cardId][1])),p.LogMgr.getInstance().debug("cardId:",this.cardId+"\u6280\u80fd\u6b21\u6570",this.tiesTime08,n[this.cardId]))}l.AudioMgr.getInstance().playEffect(u.AudioId.skill)},e.prototype.doSkill=function(t){var e=f.default.instance.gameData.enemyList,o=this.getDamage(),i=this.getCrit(),n=this.getCritDmg();o*=this.awakList[0].val[0];for(var a=0;a<e.length;a++){var r=e[a],s=r.getWpos();if(t.isColl(s)){var c=o,l=Math.random();l<i&&(c*=n,this.doCrit()),c=r.onAttacked(c,this.uuid),f.default.instance.addCardDamge(this.cardId,c),this.addBuff(2,r),r.isDead()&&(this.addDie(2,r),p.LogMgr.getInstance().debug("cardId:",this.cardId+" kill enemy:",this.awakList[0].val[1]),f.default.instance.addGoldNum(this.awakList[0].val[1])),f.default.instance.ctrEffect.showDamageNum(s,c,l<i?1:0)}}},e.prototype.onUpdate=function(t,e){switch(e){case 1:this.skilltime+=t,this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(this.time1+=t,this.time1>=this.awakList[1].val[0]&&(this.time1=0,p.LogMgr.getInstance().debug("cardId:",this.cardId+"\u6280\u80fd1",this.awakList[0].val[1]),f.default.instance.addGoldNum(this.awakList[1].val[1]))),this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(this.time2+=t,this.time2>=this.awakList[2].val[0]&&(this.time2=0,p.LogMgr.getInstance().debug("cardId:",this.cardId+"\u6280\u80fd2"),this.buffNum+=this.awakList[2].val[1]));var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties13);if(o){if(this.tiesTime13+=t,this.tiesTime13>=o[this.cardId][0]){this.tiesTime13=0;var i=f.default.instance.gamePlayInfo.hpMax;f.default.instance.gamePlayInfo.addHp(i*o[this.cardId][1]),p.LogMgr.getInstance().debug("cardId:",this.cardId+"\u56de\u8840",i*o[this.cardId][1])}}else this.tiesTime13=0;break;case 2:this.atktime+=t*this.getAtkSpeed()}},e.prototype.getSellPrice=function(){var t=this.cfg.price*this.starNum*.5;p.LogMgr.getInstance().debug("cardId:",this.cardId+"\u6280\u80fd2",this.buffNum),t+=Math.floor(this.awakList[2].val[1]*this.buffNum);for(var e=1,o=f.default.instance.gameBuff.getBuffList(d.BraveTowerEnumBuffType.BuffType13),i=0;i<o.length;i++)e+=o[i].value[0];return Math.round(t*e)},c([v],e)}(m.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl16:[function(t,e,o){"use strict";cc._RF.push(e,"22a6f23G0lHWK6kDVxzsrGD","CardCtrl16");var i=t,n=e,a=o;cc._RF.push(n,"22a6f23G0lHWK6kDVxzsrGD","CardCtrl16");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameSkillBuff"),g=i("GameTram"),y=i("ItemEnemyBase"),v=i("BaseCardCtrl"),_=i("BaseCardSkillCtrl"),b=cc._decorator,B=b.ccclass,I=(b.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);e+=this.awakList[2].val[0]*this.buffNum,this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed),this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),t+=this.buffNum*this.awakList[2].val[1],this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("info",this.cardId,this.starInfo,this.buffNum),this.initView(!1)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=1;if(f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties04)){var o=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID48);o&&t.hp/t.hpMax<=o.value[0]&&(e+=o.value[1]);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID49);i&&t.hp/t.hpMax>=i.value[0]&&(e+=i.value[1])}var n=this.getDamage()*e,a=Math.random(),r=this.getCrit();if(a<r){var s=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID65);s&&t.hp/t.hpMax<=s.value[0]?n*=this.getCritDmg()+s.value[1]:n*=this.getCritDmg(),this.doCrit()}n=t.onAttacked(n,this.uuid),f.default.instance.addCardDamge(this.cardId,n),this.addBuff(1,t),t.isDead()&&this.addDie(1,t);var c=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(c),f.default.instance.ctrEffect.showDamageNum(c,n,a<r?1:0),!0}return!1},e.prototype.doSkillStart=function(){f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var t=this.skillList.shift();t||(t=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var e=this.getOutPos(),o=t.getComponent(_.default);return this.doSkillList.push(o),o.setParent(this),o.setTag(e,!1),l.AudioMgr.getInstance().playEffectFree(u.AudioId.support),!0},e.prototype.doSkill=function(){var t=this;f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill46,this.awakList[0].val[1],this.awakList[0].val[0]);var e=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties04);e&&f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties04_1016,this.awakList[0].val[1],e[this.cardId][0]);var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties12);o&&Math.random()<o[this.cardId][0]&&f.default.instance.gameData.enemyList.forEach(function(e){return e.addBuff(y.Buff.stun,o[t.cardId][1])}),this.addBuff(2,null)},e.prototype.addBuff=function(e,o){t.prototype.addBuff.call(this,e,o),2===e&&(this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill47,this.awakList[0].val[1],this.awakList[1].val[0]),this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(this.buffNum++,this.buffNum>this.awakList[2].val[2]&&(this.buffNum=this.awakList[2].val[2]),this.upData()))},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o);var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties04);if(i){var n=0,a=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID47);a&&(n=a.value[0]),f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties041,i.val[0],i.val[1]+n,[this.cardId]),f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties042,i.val[0],i.val[2]+n,[this.cardId])}var r=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID66);r&&f.default.instance.addGoldNum(r.value[0])},c([B],e)}(v.default));a.default=I,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl17:[function(t,e,o){"use strict";cc._RF.push(e,"ed74dWB9xVEFK9SCG02PPCc","CardCtrl17");var i=t,n=e,a=o;cc._RF.push(n,"ed74dWB9xVEFK9SCG02PPCc","CardCtrl17");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameSkillBuff"),g=i("GameTram"),y=i("BaseCardCtrl"),v=i("BaseCardSkillCtrl"),_=cc._decorator,b=_.ccclass,B=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tiesKill1=0,e.tiesKill2=0,e.killNum=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.tiesKill1=0,this.tiesKill1=0,this.killNum=0},e.prototype.upData=function(){var t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed)>0&&(e+=this.awakList[1].val[0]),this.starInfo.Atk=t*e,t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed);var o=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID61);o&&(e+=o.value[0]*this.killNum),this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed)>0&&(t+=this.awakList[1].val[1]);var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11);i&&(e+=i.val[1]*this.tiesKill2),this.starInfo.crit=t+e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("info",this.cardId,this.starInfo,this.buffNum),this.initView(!1)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3)},e.prototype.doAttack=function(t){var e=this,o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11),i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID64),n=function(n){if(n.canAttack(e.uuid)){var a=1;o&&i&&t.hp/t.hpMax<=i.value[0]&&(a+=i.value[1]);var r=e.getDamage()*a,s=Math.random(),c=e.getCrit();s<c&&(r*=e.getCritDmg(),e.doCrit()),r=n.onAttacked(r,e.uuid),f.default.instance.addCardDamge(e.cardId,r),n.isDead()&&e.addDie(1,n),e.addBuff(1,n);var l=n.getWpos();return f.default.instance.ctrEffect.showBulletHit(l),f.default.instance.ctrEffect.showDamageNum(l,r,s<c?1:0),!0}return!1};if(this.starNum>=h.BraveTowerParameter.SkillUnlockStar2){if(n(t)){var a=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties10),r=0;a&&(r=a[this.cardId][0]);var s=Math.random();if(p.LogMgr.getInstance().debug("1017 \u5b59\u5c1a\u9999 \u7206\u70b8\u6982\u7387",this.awakList[2].val[0]+r),s<this.awakList[2].val[0]+r){p.LogMgr.getInstance().debug("1017 \u5b59\u5c1a\u9999 \u7206\u70b8\u4f24\u5bb3",this.cardId,this.awakList[2].val[0]);for(var c=f.default.instance.gameData.enemyList,l=cc.v2(0,0),u=t.getWpos(),m=this.getCrit(),g=this.getCritDmg(),y=0;y<c.length;y++){var v=c[y];if(v.uuid!=t.uuid&&!v.isDead()){var _=v.getWpos();if(cc.Vec2.subtract(l,u,_),l.len()<=70){var b=1;o&&i&&t.hp/t.hpMax<=i.value[0]&&(b+=i.value[1]);var B=this.getDamage()*b;Math.random()<m&&(B*=g,this.doCrit()),B=v.onAttacked(B,this.uuid),f.default.instance.addCardDamge(this.cardId,B),this.addBuff(1,v),v.isDead()&&this.addDie(2,v),f.default.instance.ctrEffect.showDamageNum(_,B,s<m?1:0)}}}}return!0}return!1}return n(t)},e.prototype.doSkillStart=function(){f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var t=this.skillList.shift();t||(t=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var e=this.getOutPos(),o=t.getComponent(v.default);return this.doSkillList.push(o),o.setParent(this),o.setTag(e,!1),l.AudioMgr.getInstance().playEffectFree(u.AudioId.support),!0},e.prototype.doSkill=function(){f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill49,this.awakList[0].val[1],this.awakList[0].val[0]),f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11)&&f.default.instance.gameTrammel.setTiesBuffTime(g.TiesBuffType.Ties11_1017,this.awakList[0].val[1],this.awakList[0].val[0])},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o);var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties11);i?(this.tiesKill1++,this.tiesKill1>=i.val[0]&&(this.tiesKill1=0,this.tiesKill2++,this.tiesKill2>i.val[2]&&(this.tiesKill2=i.val[2]),this.upData())):(this.tiesKill1=0,this.tiesKill1=0);var n=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID61);n&&(this.killNum++,this.killNum>n.value[1]&&(this.killNum=n.value[1]),this.upData())},c([b],e)}(y.default));a.default=B,cc._RF.pop(),cc._RF.pop()},{}],CardCtrl18:[function(t,e,o){"use strict";cc._RF.push(e,"4b481C4K+NGkq4aOxBDQCph","CardCtrl18");var i=t,n=e,a=o;cc._RF.push(n,"4b481C4K+NGkq4aOxBDQCph","CardCtrl18");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("GameSkillBuff"),g=i("BaseCardCtrl"),y=i("BaseCardSkillCtrl"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.criTime=0,e}return s(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.criTime=0},e.prototype.upData=function(){var t=this.baseInfo.AtkSpeed,e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.AttackSpeed);this.starInfo.AtkSpeed=t*e,(t=1-f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.SkillCD))<.1&&(t=.1),this.starInfo.skilltime=this.baseInfo.skilltime*t,t=this.baseInfo.crit,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Crit),this.starNum>=h.BraveTowerParameter.SkillUnlockStar1&&(e+=this.awakList[1].val[0]),this.starInfo.crit=t+e,t=this.baseInfo.Atk*(1+this.cfg.starAtk[this.starNum-1]),e=1+f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.Attack);var o=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties14);o&&this.starInfo.crit>=o[this.cardId][0]&&(e+=o[this.cardId][1]),this.starInfo.Atk=t*e,t=this.baseInfo.critDmg,e=f.default.instance.getCardBuffTime(this.cardId,f.CardBuffAddType.CritDamage),e+=this.buffNum*this.awakList[2].val[1],this.starInfo.critDmg=t+e,p.LogMgr.getInstance().debug("info",this.cardId,this.starInfo),this.initView(!1)},e.prototype.doAttackStart=function(e){t.prototype.doAttackStart.call(this,e),l.AudioMgr.getInstance().playEffect(u.AudioId.attack3)},e.prototype.doAttack=function(t){if(t.canAttack(this.uuid)){var e=this.getDamage(),o=Math.random(),i=this.getCrit();if(o<i){var n=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID65);n&&t.hp/t.hpMax<=n.value[0]?e*=this.getCritDmg()+n.value[1]:e*=this.getCritDmg(),this.doCrit()}e=t.onAttacked(e,this.uuid),f.default.instance.addCardDamge(this.cardId,e),t.isDead()&&this.addDie(1,t),this.addBuff(1,t);var a=t.getWpos();return f.default.instance.ctrEffect.showBulletHit(a),f.default.instance.ctrEffect.showDamageNum(a,e,o<i?1:0),!0}return!1},e.prototype.doSkillStart=function(){f.default.instance.gameTrammel.addSkill(this.cardId),this.skilltime=0;var t=this.skillList.shift();t||(t=cc.instantiate(this.prefabSkill)).setParent(f.default.instance.ndSkill);var e=this.getOutPos(),o=t.getComponent(y.default);return this.doSkillList.push(o),o.setParent(this),o.setTag(e,!1),l.AudioMgr.getInstance().playEffectFree(u.AudioId.support),!0},e.prototype.doSkill=function(){var t=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties12),e=0;t&&(e=t[this.cardId][0]),f.default.instance.gameSkillBuff.setCardBuffTime(m.CardBuffType.Skill52,this.awakList[0].val[1],this.awakList[0].val[0]+e),this.addBuff(2,null)},e.prototype.doCrit=function(){t.prototype.doCrit.call(this),this.starNum>=h.BraveTowerParameter.SkillUnlockStar2&&(this.criTime++,this.criTime>=this.awakList[2].val[0]&&(this.criTime=0,this.buffNum++,this.buffNum>this.awakList[2].val[2]&&(this.buffNum=this.awakList[2].val[2]),this.upData()))},e.prototype.addDie=function(e,o){t.prototype.addDie.call(this,e,o);var i=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID66);i&&f.default.instance.addGoldNum(i.value[0])},e.prototype.addBuff=function(e,o){if(t.prototype.addBuff.call(this,e,o),1==e){var i=f.default.instance.gameTrammel.getTies(d.BraveTowerEnumTiesCfg.Ties14);if(i){var n=Math.random(),a=0,r=f.default.instance.gameBuff.getBuff(d.BraveTowerEnumBuffID.BuffID69);r&&(a=r.value[0]),p.LogMgr.getInstance().info("\u89e6\u53d114\u7f81\u7eca\u6982\u7387",this.cardId,i.val[0]+a),n<i.val[0]+a&&f.default.instance.gamePlayInfo.addHp(i.val[1])}}},c([_],e)}(g.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],CardSkill03:[function(t,e,o){"use strict";cc._RF.push(e,"81d96AAmFJOf5xAn/njnlc/","CardSkill03");var i=t,n=e,a=o;cc._RF.push(n,"81d96AAmFJOf5xAn/njnlc/","CardSkill03");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("GameCtrl"),u=i("BaseCardSkillCtrl"),d=cc._decorator,h=d.ccclass;d.property,function(t){t[t.Normal=0]="Normal",t[t.Wait=1]="Wait",t[t.Dead=2]="Dead"}(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctrPar=null,e.tagWpos=cc.v2(),e.attList=[],e}return s(e,t),e.prototype.setTag=function(t,e){if(this.spAni.timeScale=p.default.instance.getSpeed(),e){this.spAni.setAnimation(0,"bullet",!0);var o=this.getWpos();cc.Vec2.subtract(this.tagWpos,t,o),cc.Vec2.normalize(this.tagWpos,this.tagWpos);var i=Math.atan2(this.tagWpos.y,this.tagWpos.x);this.node.angle=180*i/Math.PI-90,p.default.instance.gameData.playerSkillList.push(this)}else{var n=p.default.instance.ndSkill.convertToNodeSpaceAR(t);this.node.setPosition(n),this.onWait()}this.attList=[]},e.prototype.onUpdate=function(t){switch(this.status){case l.Normal:if(this.vec_1=this.getWpos(),cc.Vec2.multiplyScalar(this.vec_2,this.tagWpos,this.speed*t),cc.Vec2.add(this.vec_1,this.vec_1,this.vec_2),this.vec_2=this.node.parent.convertToNodeSpaceAR(this.vec_1),this.node.setPosition(this.vec_2),this.vec_1.x<0||this.vec_1.x>cc.winSize.width||this.vec_1.y<0||this.vec_1.y>cc.winSize.height)this.onWait();else for(var e=p.default.instance.gameData.enemyList,o=0;o<e.length;o++){var i=e[o];if(!i.isDead()&&!this.attList.includes(i.uuid)){var n=i.getWpos();cc.Vec2.subtract(this.vec_2,n,this.vec_1),this.vec_2.len()<50&&(this.attList.push(i.uuid),this.ctrPar.doSkill2(i))}}break;case l.Wait:}},e.prototype.onWait=function(){this.status=l.Wait,this.node.angle=0,this.spAni.setAnimation(0,"hit",!1);for(var t=p.default.instance.gameData.playerSkillList,e=0;e<t.length;e++)if(t[e].uuid==this.uuid){p.default.instance.gameData.playerSkillList.splice(e,1);break}},c([h],e)}(u.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],CityMgr:[function(t,e,o){"use strict";cc._RF.push(e,"b39c9FYOklMSYxKAdaKEyOo","CityMgr");var i=t,n=e,a=o;cc._RF.push(n,"b39c9FYOklMSYxKAdaKEyOo","CityMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.CityMgr=void 0;var r=i("HttpMgr"),s=i("LogMgr"),c=function(){function t(){this.firstCity=CC_WECHATGAME?["\u5317\u4eac","\u4e0a\u6d77","\u5e7f\u5dde","\u6df1\u5733"]:[],this.isget=!1,this.isFirstCity=!0}return t.getInstance=function(){return null==this.instance&&(this.instance=new t,this.instance.init()),this.instance},t.prototype.init=function(){this.parseIp()},t.prototype.parseIp=function(){var t=this;CC_WECHATGAME||r.HttpMgr.getInstance().httpGet("https://yuema.sfplay.net:9090/getIpInfo",null,function(e,o){if(s.LogMgr.getInstance().debug("res: ",o),e){t.isget=!0;for(var i=0;i<t.firstCity.length;i++)if(o.match(t.firstCity[i])){t.isFirstCity=!1;break}}})},t.prototype.getIsFirstCity=function(){return this.isget||this.parseIp(),this.isFirstCity},t}();a.CityMgr=c,cc._RF.pop(),cc._RF.pop()},{}],Common_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"6ff68SvFPJF2Y7AIoQwiTPi","Common_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"6ff68SvFPJF2Y7AIoQwiTPi","Common_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("SubGameData"),s=function(){function t(){this.isLoaded=!1}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.preload=function(){this.isLoaded||(this.isLoaded=!0,this._userData=new r.subgameData,this._userData.getData())},t.prototype.getSubUserData=function(){return this._userData},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],Config:[function(t,e,o){"use strict";cc._RF.push(e,"eebb8XKHHVJirIvdjyt6Bjr","Config");var i,n,a=t,r=e,s=o;cc._RF.push(r,"eebb8XKHHVJirIvdjyt6Bjr","Config"),Object.defineProperty(s,"__esModule",{value:!0}),s.GameConfig=s.ByteAppName=s.OnShowOptions=s.SystemPlatform=s.EventName=s.AudioCF=s.AudioId=s.UICF=s.UIID=void 0;var c,l,p=a("Appcfg"),u=a("BraveTowerEnum");(function(t){t[t.UINONE=-1]="UINONE",t[t.UIHome=0]="UIHome",t[t.UITop=1]="UITop",t[t.UITips=2]="UITips",t[t.UITouch=3]="UITouch",t[t.UIGuide=4]="UIGuide",t[t.UICacheExample=5]="UICacheExample",t[t.UIRealName=6]="UIRealName",t[t.UIGameExist=7]="UIGameExist",t[t.UISideBoard=8]="UISideBoard",t[t.UISetting=9]="UISetting",t[t.UIReportTop=10]="UIReportTop",t[t.UIReport=11]="UIReport",t[t.UIGame=12]="UIGame",t[t.UIGameCardSell=13]="UIGameCardSell",t[t.UIGamePause=14]="UIGamePause",t[t.UISelectBuff=15]="UISelectBuff",t[t.UIGameTiesInfo=16]="UIGameTiesInfo",t[t.UIGameResult=17]="UIGameResult",t[t.UISign=18]="UISign",t[t.UITaskAndAchieve=19]="UITaskAndAchieve",t[t.UIAchieveBox=20]="UIAchieveBox",t[t.UIReward=21]="UIReward",t[t.UIRewardCard=22]="UIRewardCard",t[t.UIShopBox=23]="UIShopBox",t[t.UITiesInfo=24]="UITiesInfo",t[t.UICardInfo=25]="UICardInfo",t[t.UICardLock=26]="UICardLock",t[t.UIOnlineReward=27]="UIOnlineReward",t[t.UIAddGold=28]="UIAddGold",t[t.UIAddCoin=29]="UIAddCoin",t[t.UIExchangeCode=30]="UIExchangeCode",t[t.UISubEnter=31]="UISubEnter",t[t.PopUserPrivacy=32]="PopUserPrivacy",t[t.UIShopOdds=33]="UIShopOdds"})(c=s.UIID||(s.UIID={})),s.UICF=((i={})[c.UIHome]={prefab:"ui/UIHome",name:"UIHome",showTop:!0,showMult:!1,zIndex:p.OrderLayer.main,bundleName:"BraveTowerPrefab"},i[c.UITop]={prefab:"ui/UITop",name:"UITop",showTop:!0,showMult:!1,zIndex:999,bundleName:"BraveTowerPrefab"},i[c.UITips]={prefab:"ui/UITips",name:"UITips",showTop:!0,zIndex:p.OrderLayer.tip,bundleName:"BraveTowerPrefab"},i[c.UITouch]={prefab:"ui/UITouch",name:"UITouch",showTop:!0,zIndex:p.OrderLayer.touch,bundleName:"BraveTowerPrefab"},i[c.UIGuide]={prefab:"ui/UIGuide",name:"UIGuide",showTop:!0,zIndex:p.OrderLayer.guide,bundleName:"BraveTowerPrefab"},i[c.UIRealName]={prefab:"UIRealName",name:"UIRealName",showTop:!1,showMult:!1,zIndex:p.OrderLayer.main,bundleName:"BraveTowerPrefab"},i[c.UIGameExist]={prefab:"UIGameExist",name:"UIGameExist",showTop:!1,showMult:!1,zIndex:p.OrderLayer.touch,bundleName:"BraveTowerPrefab"},i[c.UICacheExample]={prefab:"ui/UICacheExample",name:"UICacheExample",showTop:!1,showMult:!1,zIndex:p.OrderLayer.touch,bundleName:"BraveTowerPrefab"},i[c.UISideBoard]={prefab:"ui/UISideBoard",name:"UISideBoard",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UISetting]={prefab:"ui/UISetting",name:"UISetting",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIReportTop]={prefab:"ui/UIReportTop",name:"UIReportTop",showTop:!1,showMult:!1,zIndex:p.OrderLayer.touch,bundleName:"BraveTowerPrefab"},i[c.UIReport]={prefab:"ui/UIReport",name:"UIReport",showTop:!1,showMult:!1,zIndex:p.OrderLayer.touch,bundleName:"BraveTowerPrefab"},i[c.UIExchangeCode]={prefab:"ui/UIExchangeCode",name:"UIExchangeCode",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIOnlineReward]={prefab:"ui/UIOnlineReward",name:"UIOnlineReward",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UISubEnter]={prefab:"ui/UISubEnter",name:"UISubEnter",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop2,bundleName:"BraveTowerPrefab"},i[c.UISign]={prefab:"pop/UISign",name:"UISign",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UITaskAndAchieve]={prefab:"pop/UITaskAndAchieve",name:"UITaskAndAchieve",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIAchieveBox]={prefab:"pop/UIAchieveBox",name:"UIAchieveBox",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop2,bundleName:"BraveTowerPrefab"},i[c.UITiesInfo]={prefab:"pop/UITiesInfo",name:"UITiesInfo",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop2,bundleName:"BraveTowerPrefab"},i[c.UICardInfo]={prefab:"pop/UICardInfo",name:"UICardInfo",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIReward]={prefab:"pop/UIReward",name:"UIReward",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIRewardCard]={prefab:"pop/UIRewardCard",name:"UIRewardCard",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIShopBox]={prefab:"pop/UIShopBox",name:"UIShopBox",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UICardLock]={prefab:"pop/UICardLock",name:"UICardLock",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIAddGold]={prefab:"commer/UIAddGold",name:"UIAddGold",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop2,bundleName:"BraveTowerPrefab"},i[c.UIAddCoin]={prefab:"commer/UIAddCoin",name:"UIAddCoin",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop2,bundleName:"BraveTowerPrefab"},i[c.UIGame]={prefab:"game/UIGame",name:"UIGame",showTop:!1,showMult:!1,zIndex:p.OrderLayer.main,bundleName:"BraveTowerPrefab"},i[c.UIGameCardSell]={prefab:"game/UIGameCardSell",name:"UIGameCardSell",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIGamePause]={prefab:"game/UIGamePause",name:"UIGamePause",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UISelectBuff]={prefab:"game/UISelectBuff",name:"UISelectBuff",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIGameResult]={prefab:"game/UIGameResult",name:"UIGameResult",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIGameTiesInfo]={prefab:"game/UIGameTiesInfo",name:"UIGameTiesInfo",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop,bundleName:"BraveTowerPrefab"},i[c.UIShopOdds]={prefab:"pop/UIShopOdds",name:"UIShopOdds",showTop:!1,showMult:!1,zIndex:p.OrderLayer.pop2,bundleName:"BraveTowerPrefab"},i[c.PopUserPrivacy]={prefab:"ui/PopUserPrivacy",name:"PopUserPrivacy",showTop:!0,showMult:!1,zIndex:950,bundleName:"BraveTowerPrefab"},i),function(t){t.btnClick="btnClick",t.main="main",t.Levels="Levels",t.Cards="Cards",t.Draw="Draw",t.victory="victory",t.fail="fail",t.attack1="attack1",t.attack2="attack2",t.attack3="attack3",t.Bonds="Bonds",t.reward="reward",t.skill="skill",t.strike="strike",t.support="support",t.treasure="treasure",t.impact="impact",t.bajie="bajie",t.dialogue="dialogue"}(l=s.AudioId||(s.AudioId={})),s.AudioCF=((n={})[l.btnClick]={path:"btnclick",bundle:u.BraveTowerBundelName.Audio},n[l.main]={path:"main",bundle:u.BraveTowerBundelName.Audio},n[l.Levels]={path:"Levels",bundle:u.BraveTowerBundelName.Audio},n[l.Cards]={path:"Cards",bundle:u.BraveTowerBundelName.Audio},n[l.Draw]={path:"Draw",bundle:u.BraveTowerBundelName.Audio},n[l.victory]={path:"victory",bundle:u.BraveTowerBundelName.Audio},n[l.fail]={path:"fail",bundle:u.BraveTowerBundelName.Audio},n[l.attack1]={path:"attack1",bundle:u.BraveTowerBundelName.Audio},n[l.attack2]={path:"attack2",bundle:u.BraveTowerBundelName.Audio},n[l.attack3]={path:"attack3",bundle:u.BraveTowerBundelName.Audio},n[l.Bonds]={path:"Bonds",bundle:u.BraveTowerBundelName.Audio},n[l.reward]={path:"reward",bundle:u.BraveTowerBundelName.Audio},n[l.skill]={path:"skill",bundle:u.BraveTowerBundelName.Audio},n[l.strike]={path:"strike",bundle:u.BraveTowerBundelName.Audio},n[l.support]={path:"support",bundle:u.BraveTowerBundelName.Audio},n[l.treasure]={path:"treasure",bundle:u.BraveTowerBundelName.Audio},n[l.impact]={path:"impact",bundle:u.BraveTowerBundelName.Audio},n[l.bajie]={path:"bajie",bundle:u.BraveTowerBundelName.Audio},n[l.dialogue]={path:"dialogue",bundle:u.BraveTowerBundelName.Audio},n),function(t){t.RefreshGold="RefreshGold",t.RefreshDiamond="RefreshDiamond",t.AniGold="AniGold",t.AniDiamond="AniDiamond",t.showText="showText"}(s.EventName||(s.EventName={})),function(t){t.IOS="ios",t.ANDROID="android",t.UNKNOWN="unknown"}(s.SystemPlatform||(s.SystemPlatform={})),s.OnShowOptions=function(){},function(t){t.Toutiao="Toutiao",t.Douyin="Douyin",t.news_article_lite="news_article_lite",t.live_stream="live_stream",t.XiGua="XiGua",t.PPX="PPX",t.douyin_lite="douyin_lite",t.live_stream_lite="live_stream_lite",t.novel_fm="novel_fm",t.novelapp="novelapp"}(s.ByteAppName||(s.ByteAppName={}));var d=function(){function t(){}return t.AppCacheName="BraveTower:",t.WebCacheName="BraveTower:",t.splitCount="|",t.splitNum=";",t.PreBundle=[],t.PreBundleList=[],t.ecrypt=!1,t}();s.GameConfig=d,cc._RF.pop(),cc._RF.pop()},{}],CoronaCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c294a/BaqBAoYXfW82csWMm","CoronaCtrl");var i=e,n=o;cc._RF.push(i,"c294a/BaqBAoYXfW82csWMm","CoronaCtrl");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handle=null,e}return r(e,t),e.prototype.start=function(){},e.prototype.handleListener=function(){},s([p(cc.Node)],e.prototype,"handle",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],DARGameData:[function(t,e,o){"use strict";cc._RF.push(e,"cef9afiyktPiZJX6yIEJTIs","DARGameData");var i=e,n=o;cc._RF.push(i,"cef9afiyktPiZJX6yIEJTIs","DARGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emDARGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.levelCfg="levelCfg",t.mateCfg="mateCfg"}(n.emDARGameDataKeys||(n.emDARGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],DARGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"33575Tur4VHRp8cILMipKSK","DARGameEnumData");var i=e,n=o;cc._RF.push(i,"33575Tur4VHRp8cILMipKSK","DARGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],DBGameData:[function(t,e,o){"use strict";cc._RF.push(e,"4751962edNMYoOgye2JCPVk","DBGameData");var i=e,n=o;cc._RF.push(i,"4751962edNMYoOgye2JCPVk","DBGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emDBGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffOddsCfg="buffOddsCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.dragonBallShowCfg="dragonBallShowCfg",t.dragonBallCfg="dragonBallCfg",t.levelBlueCfg="levelBlueCfg",t.levelCfg="levelCfg",t.mateOddsCfg="mateOddsCfg",t.mateCfg="mateCfg"}(n.emDBGameDataKeys||(n.emDBGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],DBGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"79d50d6rzZD26L2YYFMOFr4","DBGameEnumData");var i=e,n=o;cc._RF.push(i,"79d50d6rzZD26L2YYFMOFr4","DBGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.girlMoveSpeed=15]="girlMoveSpeed",t[t.wordsTime=16]="wordsTime",t[t.wordShow=17]="wordShow",t[t.dieWordDistance=18]="dieWordDistance",t[t.girlPosition=19]="girlPosition",t[t.dragonMoveAmniTime=20]="dragonMoveAmniTime",t[t.tipsStayTime=21]="tipsStayTime",t[t.ballFlySpeed=22]="ballFlySpeed",t[t.changeLimit=23]="changeLimit",t[t.sunsxLimit=24]="sunsxLimit",t[t.moveSpeedBlue=25]="moveSpeedBlue",t[t.dragonMoveAmniBlue=26]="dragonMoveAmniBlue",t[t.dragonMoveAmniTimeBlue=27]="dragonMoveAmniTimeBlue",t[t.lightdragonBallGetWord=28]="lightdragonBallGetWord",t[t.lightdragonBalldebuff=29]="lightdragonBalldebuff"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],DBS_APP:[function(t,e,o){"use strict";cc._RF.push(e,"198ecLlOHJJp4PD3YexOrS1","DBS_APP");var i=t,n=e,a=o;cc._RF.push(n,"198ecLlOHJJp4PD3YexOrS1","DBS_APP"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("PoolMgr"),c=i("ResourceMgr"),l=i("UIMgr"),p=i("DBS_DataMgr"),u=i("DBS_Config"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e,r.AudioMgr.getInstance().pauseAllMusic();var n=function(){i._isInited=!0,l.UIMgr.getInstance().openUIOfCallback(u.DBS_UIID.DBS_UIGame_WEBLINK,u.DBS_UIID.DBS_UIGame_WEBLINK,function(){t&&t(),i.removeTouchEvent()})};this._isInited?n():(l.UIMgr.getInstance().addUICnf(u.DBS_UICF),r.AudioMgr.getInstance().addAdConf(u.DBS_Audio),p.default.getInstance().loadCfg(function(){n()})),c.ResourceMgr.getInstance().loadRes(u.DBS_BundleName.Prefabs,"bullet/roleBullet",cc.Prefab,function(t){var e=cc.instantiate(t);s.PoolMgr.getInstance().creatrePool(u.DBS_PoolKeyName.roleBullet,e)}),c.ResourceMgr.getInstance().loadRes(u.DBS_BundleName.Prefabs,"effAnim/dieEff",cc.Prefab,function(t){var e=cc.instantiate(t);s.PoolMgr.getInstance().creatrePool(u.DBS_PoolKeyName.dieEff,e)}),c.ResourceMgr.getInstance().loadRes(u.DBS_BundleName.Prefabs,"effAnim/criticalEff",cc.Prefab,function(t){var e=cc.instantiate(t);s.PoolMgr.getInstance().creatrePool(u.DBS_PoolKeyName.criticalEff,e)});for(var a=function(t){var e="enemyRole_"+t;c.ResourceMgr.getInstance().loadRes(u.DBS_BundleName.Prefabs,"enemyRole/"+e,cc.Prefab,function(t){var o=cc.instantiate(t);s.PoolMgr.getInstance().creatrePool(e,o)})},d=1;d<5;d++)a(d)},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),l.UIMgr.getInstance().closeById(u.DBS_UIID.DBS_UIGame),l.UIMgr.getInstance().closeById(u.DBS_UIID.DBS_UIPause),l.UIMgr.getInstance().closeById(u.DBS_UIID.DBS_UIGameOver),l.UIMgr.getInstance().closeById(u.DBS_UIID.DBS_UIGame_WEBLINK),this._exitCall&&this._exitCall(),this._exitCall=null,s.PoolMgr.getInstance().clearPool(u.DBS_PoolKeyName.roleBullet),s.PoolMgr.getInstance().clearPool(u.DBS_PoolKeyName.dieEff),s.PoolMgr.getInstance().clearPool(u.DBS_PoolKeyName.criticalEff);for(var e=1;e<5;e++){var o="enemyRole_"+e;s.PoolMgr.getInstance().clearPool(o)}},t.prototype.removeTouchEvent=function(){},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],DBS_AddBuffTakeGain:[function(t,e,o){"use strict";cc._RF.push(e,"7e9f9lbQ4dMgbbtGj2zXC7d","DBS_AddBuffTakeGain");var i=t,n=e,a=o;cc._RF.push(n,"7e9f9lbQ4dMgbbtGj2zXC7d","DBS_AddBuffTakeGain");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DBS_Config"),u=i("DBS_GameManager"),d=i("DBS_TakeGain"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layerID=0,e.takeParent=null,e.isTakeLock=!1,e.takeName="takeGain",e.indexes=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.takeName="takeGain_WEBLINK",this.node.on(cc.Node.EventType.TOUCH_END,function(){var e="takeGain/"+t.takeName;t.loadPrefab(p.DBS_BundleName.Prefabs,e,function(e){var o=cc.instantiate(e);o.setParent(t.takeParent),o.setPosition(cc.v3()),o.getComponent(d.default).init(t.layerID,u.default.Instance.takeGainSendFew),t.sendEvent(p.DBS_EventName.AddBuffTakeGain,!1),u.default.Instance.setGameState(p.DBS_GameState.playing),t.node.destroy()})},this)},e.prototype.start=function(){var t=this;cc.tween(this.node).to(.4,{scale:1.3}).to(.4,{scale:1}).start(),this.indexes=setInterval(function(){cc.tween(t.node).to(.4,{scale:1.3}).to(.4,{scale:1}).start()},800),this.isTakeLock&&(this.showAddBuffTakeGain(),this.addEvent(p.DBS_EventName.AddBuffTakeGain,this.showAddBuffTakeGain))},e.prototype.showAddBuffTakeGain=function(){this.node.active=u.default.Instance.isTakeLock},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.indexes)},c([m(Number)],e.prototype,"layerID",void 0),c([m(cc.Node)],e.prototype,"takeParent",void 0),c([m(Boolean)],e.prototype,"isTakeLock",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DBS_Config:[function(t,e,o){"use strict";cc._RF.push(e,"e3266d95ERMYb8U6ghOd/3y","DBS_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"e3266d95ERMYb8U6ghOd/3y","DBS_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.DBS_PoolKeyName=l.DBS_RoleAsePath=l.DBS_ColliderName=l.DBS_GameState=l.DBS_AtkState=l.DBS_AnimName=l.DBS_EventName=l.DBS_Audio=l.DBS_AudioId=l.DBS_UICF=l.DBS_UIID=l.DBS_BundleName=void 0,function(t){t.Prefabs="DBS_Prefabs",t.Sprite="DBS_Sprite",t.Audio="DBS_Audio",t.SpAnim="DBS_SpAnim"}(a=l.DBS_BundleName||(l.DBS_BundleName={})),function(t){t.DBS_UIGame="DBS_UIGame",t.DBS_UIGame_WEBLINK="DBS_UIGame_WEBLINK",t.DBS_UIPause="DBS_UIPause",t.DBS_UIGameOver="DBS_UIGameOver",t.DBS_UISelectBuff="DBS_UISelectBuff",t.DBS_UISelectSolderRole="DBS_UISelectSolderRole",t.DBS_UIGM="DBS_UIGM",t.DBS_UIToolTips="DBS_UIToolTips"}(r=l.DBS_UIID||(l.DBS_UIID={})),l.DBS_UICF=((i={})[r.DBS_UIGame]={prefab:"ui/DBS_UIGame",name:"DBS_UIGame",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.DBS_UIGame_WEBLINK]={prefab:"ui/DBS_UIGame_WEBLINK",name:"DBS_UIGame_WEBLINK",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.DBS_UIPause]={prefab:"ui/DBS_UIPause",name:"DBS_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.DBS_UIGameOver]={prefab:"ui/DBS_UIGameOver",name:"DBS_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.DBS_UISelectBuff]={prefab:"ui/DBS_UISelectBuff",name:"DBS_UISelectBuff",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.DBS_UISelectSolderRole]={prefab:"ui/DBS_UISelectSolderRole",name:"DBS_UISelectSolderRole",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.DBS_UIGM]={prefab:"ui/DBS_UIGM",name:"DBS_UIGM",showTop:!0,showMult:!1,zIndex:1005,bundleName:a.Prefabs},i[r.DBS_UIToolTips]={prefab:"ui/DBS_UIToolTips",name:"DBS_UIToolTips",showTop:!0,showMult:!1,zIndex:1015,bundleName:a.Prefabs},i),function(t){t.fanbei="fanbei",t.gongji="gongji",t.huode="huode",t.shibai="shibai",t.shouji="shouji",t.siwang="siwang",t.tiezhen="tiezhen",t.shengji="shengji",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.moonGod="moonGod",t.boom="boom",t.summon="summon"}(s=l.DBS_AudioId||(l.DBS_AudioId={})),l.DBS_Audio=((n={})[s.fanbei]={path:s.fanbei,bundle:a.Audio},n[s.gongji]={path:s.gongji,bundle:a.Audio},n[s.huode]={path:s.huode,bundle:a.Audio},n[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.shouji]={path:s.shouji,bundle:a.Audio},n[s.siwang]={path:s.siwang,bundle:a.Audio},n[s.tiezhen]={path:s.tiezhen,bundle:a.Audio},n[s.shengji]={path:s.shengji,bundle:a.Audio},n[s.lotus]={path:s.lotus,bundle:a.Audio},n[s.goldGod]={path:s.goldGod,bundle:a.Audio},n[s.classic]={path:s.classic,bundle:a.Audio},n[s.swordHit]={path:s.swordHit,bundle:a.Audio},n[s.moonGod]={path:s.moonGod,bundle:a.Audio},n[s.boom]={path:s.boom,bundle:a.Audio},n[s.summon]={path:s.summon,bundle:a.Audio},n),function(t){t.TouchMove="DBS_TouchMove",t.AddRoleBullet="DBS_AddRoleBullet",t.AttackPlayer="DBS_AttackPlayer",t.SetGameState="DBS_SetGameState",t.PlayBulletLevelUp="DBS_PlayBulletLevelUp",t.TimeLevelUp="DBS_TimeLevelUp",t.UpdateUIShowPlayTime="DBS_UpdateUIShowPlayTime",t.ObtainBuff="DBS_ObtainBuff",t.AddBuffTakeGain="DBS_AddBuffTakeGain",t.OursideUpdateInfo="DBS_OursideUpdateInfo",t.SkillsAtkDouble="DBS_ShillsAtkDouble",t.PlaySkillsAtk="DBS_playSkillsAtk",t.ActivateSkills="DBS_ActivateSkills",t.GMPlaySkills="DBS_GMPlaySkills",t.BulletAddForce="DBS_BulletAddForce"}(l.DBS_EventName||(l.DBS_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="move",t.animation="animation"}(l.DBS_AnimName||(l.DBS_AnimName={})),function(t){t[t.cooling=0]="cooling",t[t.ready=1]="ready",t[t.underway=2]="underway"}(l.DBS_AtkState||(l.DBS_AtkState={})),function(t){t[t.playing=0]="playing",t[t.pause=1]="pause"}(l.DBS_GameState||(l.DBS_GameState={})),function(t){t[t.right_Trigger=1]="right_Trigger",t[t.left_Trigger=2]="left_Trigger",t[t.deopBullet=3]="deopBullet",t[t.pickUp_Trigger=4]="pickUp_Trigger",t[t.left_Force=5]="left_Force",t[t.entrance_Trigger=6]="entrance_Trigger",t[t.entranceTakeGain_Trigger=7]="entranceTakeGain_Trigger",t[t.take_Trigger=99]="take_Trigger",t[t.enemy=10]="enemy",t[t.ourside=11]="ourside"}(l.DBS_ColliderName||(l.DBS_ColliderName={})),l.DBS_RoleAsePath={11:{path:"soilder_1/soilder_1",ID:11},1:{path:"soilder_3/soilder_3",ID:1},7:{path:"soilder_4/soilder_4",ID:7},3:{path:"djdh_3/djdh_3",ID:3},4:{path:"djdh_4/djdh_4",ID:4},6:{path:"djdh_6/djdh_6",ID:6},8:{path:"djdh_8/djdh_8",ID:8},10:{path:"djdh_10/djdh_10",ID:10},17:{path:"djdh_17/djdh_17",ID:17}},function(t){t.roleBullet="roleBullet",t.dieEff="dieEff",t.criticalEff="criticalEff"}(l.DBS_PoolKeyName||(l.DBS_PoolKeyName={})),cc._RF.pop(),cc._RF.pop()},{}],DBS_CriticalEff:[function(t,e,o){"use strict";cc._RF.push(e,"7343d48MTdGqbP21mjEo0Z4","DBS_CriticalEff");var i=t,n=e,a=o;cc._RF.push(n,"7343d48MTdGqbP21mjEo0Z4","DBS_CriticalEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("DBS_Config"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e}return s(e,t),e.prototype.onLoad=function(){this.txt=cc.find("txt",this.node).getComponent(cc.Label)},e.prototype.init=function(t){var e=this;this.txt.string=t.toString();var o=this.node.position.clone();o.y+=50,cc.tween(this.node).to(.2,{position:o}).call(function(){o.y+=20}).to(.5,{position:o}).call(function(){e.die()}).start()},e.prototype.die=function(){p.PoolMgr.getInstance().freeNode(u.DBS_PoolKeyName.criticalEff,this.node)},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DBS_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"949d1vDv9hLwYMYRlQeSTBg","DBS_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"949d1vDv9hLwYMYRlQeSTBg","DBS_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=i("DBS_GameManager"),l=cc._decorator,p=l.ccclass,u=(l.property,function(){function t(){}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getData=function(){return this.data},t.prototype.loadCfg=function(t){var e=this;s.ResourceMgr.getInstance().loadRes("DBS_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getBuffCfg=function(){return this.data.buffCfg||null},t.prototype.getAtk=function(){var t=c.default.Instance.playBulletLevel;return t>5&&(t=5),t+=9e3,this.getCfgByPrimaryKey(this.data.WeaponCfg,t,"id")},t.prototype.getDropCfg=function(t){return this.getCfgByPrimaryKey(this.data.DropCfg,t,"ID")},t.prototype.getEnemyWaveCfg=function(){return this.data.EnemyWave||null},t.prototype.getEnemyHpCfg=function(){var t=Math.floor(c.default.Instance.playInsistTime/60);return t<1&&(t=1),t>12&&(t=12),this.getCfgByPrimaryKey(this.data.HealthyCfg,t,"level")},t.prototype.getParameterCfg=function(t){return this.data&&this.data.GearParameterCfg&&this.data.GearParameterCfg[t]||null},t.prototype.getSolderRole=function(t){return this.getCfgByPrimaryKey(this.data.characterCfg,t,"characterID")},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getSkillsCfg=function(t){return this.getCfgByPrimaryKey(this.data.mateCfg,t,"mateID")},t.prototype.getMateOddsCfg=function(){return this.data.mateOddsCfg},e=r([p],t)}());a.default=u,cc._RF.pop(),cc._RF.pop()},{}],DBS_DeopBulletCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"192feDaXMlE+o6bVUMlEHGc","DBS_DeopBulletCtrl");var i=t,n=e,a=o;cc._RF.push(n,"192feDaXMlE+o6bVUMlEHGc","DBS_DeopBulletCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("DBS_Config"),d=i("DBS_GameEnumData"),h=i("DBS_DataMgr"),f=i("DBS_GameManager"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt_BulletFew=null,e.spAnim=null,e.bulletFew=200,e.basicSendBulletInterval=1,e.addBulletInterval=0,e.nowSendBulletInterval=0,e.sendBulletTime=0,e.clipDuration=null,e.isPlayAniming=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.txt_BulletFew=cc.find("txt_BulletFew",this.node).getComponent(cc.Label),this.spAnim=cc.find("spAnim",this.node).getComponent(sp.Skeleton),this.txt_BulletFew.string="\xd7"+this.bulletFew,this.spAnim.setCompleteListener(function(e){e.animation.name==u.DBS_AnimName.animation&&(t.isPlayAniming=!1)}),this.spAnim.setEventListener(function(e,o){"atk"==o.data.name&&t.sendBullet()}),this.spAnim.setAnimation(0,u.DBS_AnimName.animation,!1);var e=this.spAnim.findAnimation(u.DBS_AnimName.animation);this.clipDuration=e.duration,this.bulletFew=h.default.getInstance().getParameterCfg(d.DBS_EnumGearParameterCfg.IronNum).value,this.basicSendBulletInterval=h.default.getInstance().getParameterCfg(d.DBS_EnumGearParameterCfg.IronAtk).value,this.nowSendBulletInterval=this.basicSendBulletInterval,this.setSpAnimPlaySpeed()},e.prototype.start=function(){this.addEvent(u.DBS_EventName.TouchMove,this.playerMove),this.addEvent(u.DBS_EventName.ObtainBuff,this.obtainBuff)},e.prototype.update=function(t){f.default.Instance.gameState!=u.DBS_GameState.pause&&(this.sendBulletTime+=t,this.sendBulletTime>this.nowSendBulletInterval&&this.bulletFew>0&&(this.isPlayAniming||(this.sendBulletTime=0,this.isPlayAniming=!0,this.spAnim.setAnimation(0,u.DBS_AnimName.animation,!1))))},e.prototype.setSpAnimPlaySpeed=function(){if(this.nowSendBulletInterval<this.clipDuration){var t=this.clipDuration/this.nowSendBulletInterval;this.spAnim.timeScale=t}},e.prototype.sendBullet=function(){p.AudioMgr.getInstance().playEffectFree(u.DBS_AudioId.tiezhen),f.default.Instance.sendBullet(this.node.position),this.bulletFew--,this.txt_BulletFew.string="\xd7"+this.bulletFew},e.prototype.playerMove=function(t){if(f.default.Instance.gameState!=u.DBS_GameState.pause){var e=this.node.x+t;e<-273||e>273||(this.node.x=e)}},e.prototype.obtainBuff=function(t,e){switch(t){case 9004:case 9013:case 9023:case 9033:this.bulletFew+=e,this.txt_BulletFew.string="\xd7"+this.bulletFew;break;case 9006:case 9016:case 9025:case 9036:this.addBulletInterval+=e,this.nowSendBulletInterval=this.basicSendBulletInterval/(1+this.addBulletInterval),this.setSpAnimPlaySpeed()}},c([g],e)}(l.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DBS_DropBullet:[function(t,e,o){"use strict";cc._RF.push(e,"57907ENu+xBzI2XPs5EGbrC","DBS_DropBullet");var i=t,n=e,a=o;cc._RF.push(n,"57907ENu+xBzI2XPs5EGbrC","DBS_DropBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("BasePlatform"),d=i("PlatformSetting"),h=i("DBS_Config"),f=i("DBS_GameManager"),m=cc._decorator,g=m.ccclass;m.property,function(t){t[t.null=0]="null",t[t.right=1]="right",t[t.left=2]="left",t[t.left_Force=3]="left_Force"}(l||(l={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rig=null,e.trigState=l.null,e.spr=null,e.horizontalSpeed=150,e.usedLayerID=0,e.addForceMax=5,e.addForceMin=0,e.tweenPoss=[],e.nowNobePos=cc.v2(),e.onTime=0,e.isOnEntrance_Trigger=!1,e.isOnEntranceTakeGain_Trigger=!1,e.isDis=!1,e}return s(e,t),e.prototype.onLoad=function(){this.rig=this.node.getComponent(cc.RigidBody),this.spr=cc.find("icon",this.node).getComponent(cc.Sprite),d.PlatformSetting.currentPlatform==u.Platform.WEB_LINK?(this.addForceMax=140,this.addForceMin=70):(this.addForceMax=110,this.addForceMin=70)},e.prototype.start=function(){this.addEvent(h.DBS_EventName.PlayBulletLevelUp,this.updateSpr)},e.prototype.init=function(t,e,o){void 0===e&&(e=0),this.rig.linearVelocity=t,this.usedLayerID=e,this.tweenPoss=o,this.updateSpr()},e.prototype.updateSpr=function(){this.spr.spriteFrame=f.default.Instance.getBulletImg()},e.prototype.update=function(t){f.default.Instance.gameState!=h.DBS_GameState.pause&&(this.trigState==l.right?(this.nowNobePos=this.node.getPosition(),this.node.setPosition(this.nowNobePos.x-this.horizontalSpeed*t,this.nowNobePos.y)):this.trigState==l.left&&(this.nowNobePos=this.node.getPosition(),this.node.setPosition(this.nowNobePos.x+this.horizontalSpeed*t,this.nowNobePos.y)),this.isOnEntrance_Trigger&&(this.onTime+=t,this.onTime>.5&&(this.onTime=0,this.addRigForce(0,250))))},e.prototype.onBeginContact=function(t,e,o){var i=this;if(1!=this.isDis)switch(o.tag){case h.DBS_ColliderName.right_Trigger:this.trigState=l.right,0==this.node.angle&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.22,{angle:90}).start());break;case h.DBS_ColliderName.left_Trigger:if(this.trigState=l.left,0==this.node.angle){cc.Tween.stopAllByTarget(this.node);var n=this.node.angle-90;cc.tween(this.node).to(.22,{angle:n}).start()}break;case h.DBS_ColliderName.pickUp_Trigger:this.isDis=!0,this.rig.gravityScale=0,this.node.getComponent(cc.PhysicsCollider).sensor=!0;var a=f.default.Instance.img_Bullet.node.position.clone();cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.25,{position:a,scale:.3}).call(function(){i.sendEvent(h.DBS_EventName.AddRoleBullet),i.dis()}).start();break;case h.DBS_ColliderName.left_Force:var r=f.default.Instance.random(this.addForceMin,this.addForceMax);this.addRigForce(r,0,!0);break;case h.DBS_ColliderName.entrance_Trigger:this.isOnEntrance_Trigger=!0,this.onTime=0;break;case h.DBS_ColliderName.entranceTakeGain_Trigger:this.isOnEntranceTakeGain_Trigger=!0,this.onTime=0,this.addRigForce(400,350)}},e.prototype.addRigForce=function(t,e,o){void 0===o&&(o=!1);var i=cc.v2(t,e),n=cc.v2(this.node.position.x,this.node.position.y);this.rig.applyLinearImpulse(i,n,!0),this.rig.angularVelocity=o?-4*t:0},e.prototype.onEndContact=function(t,e,o){if(1!=this.isDis)switch(o.tag){case h.DBS_ColliderName.right_Trigger:case h.DBS_ColliderName.left_Trigger:this.trigState=l.null;break;case 0:-1.7!=this.rig.gravityScale&&(this.rig.gravityScale=-1.7);break;case h.DBS_ColliderName.entrance_Trigger:this.isOnEntrance_Trigger=!1;break;case h.DBS_ColliderName.entranceTakeGain_Trigger:this.isOnEntranceTakeGain_Trigger=!1}},e.prototype.getRigFallV=function(){return this.rig.linearVelocity},e.prototype.getUsedTake=function(t){return t>this.usedLayerID},e.prototype.setUsedTake=function(t){t>this.usedLayerID&&(this.usedLayerID=t)},e.prototype.dis=function(){this.node.destroy()},c([g],e)}(p.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DBS_EffAnimDie:[function(t,e,o){"use strict";cc._RF.push(e,"2946cmjPJhMGpCT7tAPeZPk","DBS_EffAnimDie");var i=t,n=e,a=o;cc._RF.push(n,"2946cmjPJhMGpCT7tAPeZPk","DBS_EffAnimDie");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("DBS_Config"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim=this.node.getComponent(sp.Skeleton),this.spAnim.setCompleteListener(function(e){e.animation.name==u.DBS_AnimName.animation&&p.PoolMgr.getInstance().freeNode(u.DBS_PoolKeyName.dieEff,t.node)})},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DBS_EnemyRole:[function(t,e,o){"use strict";cc._RF.push(e,"dbee2EqYhNBr4WeMMV6HJvc","DBS_EnemyRole");var i=t,n=e,a=o;cc._RF.push(n,"dbee2EqYhNBr4WeMMV6HJvc","DBS_EnemyRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("AudioMgr"),u=i("PoolMgr"),d=i("DBS_Config"),h=i("DBS_DataMgr"),f=i("DBS_GameManager"),m=i("DBS_RoleBase"),g=cc._decorator,y=g.ccclass,v=g.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.die=2]="die"}(l||(l={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpBG=null,e.hpBar=null,e.ID=1,e.enemyState=null,e.moveSpeed=70,e.maxHp=10,e.nowHp=0,e.atkForce=1,e.isSkillsStasis=!1,e.skillsStasisTime=0,e.nowNobePos=cc.v2(),e}return s(e,t),e.prototype.onLoad=function(){switch(t.prototype.onLoad.call(this),this.hpBG=cc.find("hp",this.node),this.hpBar=cc.find("hp/hpBar",this.node).getComponent(cc.ProgressBar),this.hpBG.active=!1,this.basicAtkInterval=.5,this.enemyState=l.move,this.spAnim.setAnimation(0,d.DBS_AnimName.move,!0),this.ID){case 1:this.maxHp=h.default.getInstance().getEnemyHpCfg().ZombieHp,this.atkForce=h.default.getInstance().getEnemyHpCfg().ZombieAtk;break;case 2:this.maxHp=h.default.getInstance().getEnemyHpCfg().MiniBossHp,this.atkForce=h.default.getInstance().getEnemyHpCfg().MiniBossAtk;break;case 3:this.maxHp=h.default.getInstance().getEnemyHpCfg().OilHp,this.atkForce=h.default.getInstance().getEnemyHpCfg().OilAtk;break;case 4:this.maxHp=h.default.getInstance().getEnemyHpCfg().BallHP,this.atkForce=h.default.getInstance().getEnemyHpCfg().BallAtk}this.nowHp=this.maxHp,this.addEvent(d.DBS_EventName.TimeLevelUp,this.updateHpCfg),this.addEvent(d.DBS_EventName.PlaySkillsAtk,this.playSkillsAtk)},e.prototype.init=function(){this.hpBG.active=!1,this.hpBar.progress=1,this.nowHp=this.maxHp,this.updateHpCfg(),this.enemyState=l.move,this.spAnim.setAnimation(0,d.DBS_AnimName.move,!0),this.spAnim.paused=!1},e.prototype.update=function(t){if(f.default.Instance.gameState!=d.DBS_GameState.pause&&!this.getIsDie())return this.isSkillsStasis?(this.skillsStasisTime+=t,void(this.skillsStasisTime>3&&(this.skillsStasisTime=0,this.isSkillsStasis=!1,this.setGameState(d.DBS_GameState.playing)))):void(this.enemyState==l.move?(this.nowNobePos=this.node.getPosition(),this.node.setPosition(this.nowNobePos.x-this.moveSpeed*t,this.nowNobePos.y)):this.enemyState==l.attack&&this.atkState==d.DBS_AtkState.cooling&&(this.atkTime+=t,this.atkTime>this.basicAtkInterval&&(this.atkTime=0,this.atkState=d.DBS_AtkState.ready,this.isPlayAtkAnim())))},e.prototype.updateHpCfg=function(){var t=this.nowHp/this.maxHp;switch(this.ID){case 1:this.maxHp=h.default.getInstance().getEnemyHpCfg().ZombieHp;break;case 2:this.maxHp=h.default.getInstance().getEnemyHpCfg().MiniBossHp;break;case 3:this.maxHp=h.default.getInstance().getEnemyHpCfg().OilHp;break;case 4:this.maxHp=h.default.getInstance().getEnemyHpCfg().BallHP}this.nowHp=Math.floor(this.maxHp*t)},e.prototype.isPlayAtkAnim=function(){this.getIsDie()||this.atkState==d.DBS_AtkState.ready&&(this.atkState=d.DBS_AtkState.underway,this.spAnim.setAnimation(0,d.DBS_AnimName.attack,!1))},e.prototype.attack=function(){this.getIsDie()||this.sendEvent(d.DBS_EventName.AttackPlayer,this.atkForce)},e.prototype.playSkillsAtk=function(t,e,o){if(!this.getIsDie())switch(t){case 2:var i=o.parent.convertToWorldSpaceAR(o.getPosition()).x,n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());Math.abs(n.x-i)<200&&this.attackEd(e);break;case 3:this.setGameState(d.DBS_GameState.pause),this.isSkillsStasis=!0,this.skillsStasisTime=0,this.attackEd(e);break;default:this.attackEd(e)}},e.prototype.setGameState=function(t){if(!this.isSkillsStasis)switch(t){case d.DBS_GameState.pause:this.spAnim.paused=!0;break;case d.DBS_GameState.playing:this.spAnim.paused=!1}},e.prototype.attackEd=function(t){f.default.Instance.gameState!=d.DBS_GameState.pause&&(this.getIsDie()||(this.nowHp-=t,cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.15,{color:cc.Color.WHITE}).start(),this.hpBG.active||(this.hpBG.active=!0),this.updeteHpBar(),this.nowHp<1&&(this.enemyState=l.die,this.die())))},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.getIsDie=function(){return this.enemyState==l.die},e.prototype.die=function(){p.AudioMgr.getInstance().playEffectFree(d.DBS_AudioId.siwang);var t=this.node.position.clone(),e=this.node.parent;f.default.Instance.playDieAnim(t,e),f.default.Instance.removeEnemyList(this.node),cc.Tween.stopAllByTarget(this.spAnim.node),this.spAnim.node.color=cc.Color.WHITE,u.PoolMgr.getInstance().freeNode(this.node.name,this.node)},e.prototype.onCollisionEnter=function(t){this.enemyState==l.move&&t.tag==d.DBS_ColliderName.ourside&&(this.enemyState=l.attack,this.atkState=d.DBS_AtkState.ready,this.isPlayAtkAnim())},c([v(Number)],e.prototype,"ID",void 0),c([y],e)}(m.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DBS_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"23bb7fbi/ZJlqdW9eAiQmRU","DBS_GameData");var i=e,n=o;cc._RF.push(i,"23bb7fbi/ZJlqdW9eAiQmRU","DBS_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emDBS_GameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.DropCfg="DropCfg",t.mateOddsCfg="mateOddsCfg",t.mateCfg="mateCfg",t.GearParameterCfg="GearParameterCfg",t.WeaponCfg="WeaponCfg",t.EnemyWave="EnemyWave",t.HealthyCfg="HealthyCfg",t.characterCfg="characterCfg"}(n.emDBS_GameDataKeys||(n.emDBS_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],DBS_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"57cfaYhmnROIrfYKlQIAIjW","DBS_GameEnumData");var i=e,n=o;cc._RF.push(i,"57cfaYhmnROIrfYKlQIAIjW","DBS_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.DBS_EnumGearParameterCfg=void 0,function(t){t[t.AllTime=2]="AllTime",t[t.Character2Atk=4]="Character2Atk",t[t.Character3Atk=5]="Character3Atk",t[t.IronAtk=6]="IronAtk",t[t.PlayerAtkSpeed=7]="PlayerAtkSpeed",t[t.CharacterAtkSpeed=8]="CharacterAtkSpeed",t[t.IronNum=9]="IronNum",t[t.LockNum=10]="LockNum",t[t.CriticalChance=11]="CriticalChance",t[t.CriticalAtk=12]="CriticalAtk",t[t.Healthy=13]="Healthy"}(n.DBS_EnumGearParameterCfg||(n.DBS_EnumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],DBS_GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"0ff9cqJP5FAmrfCzA9YflP4","DBS_GameManager");var i=t,n=e,a=o;cc._RF.push(n,"0ff9cqJP5FAmrfCzA9YflP4","DBS_GameManager");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("DBS_DropBullet"),h=i("DBS_Config"),f=i("DBS_CriticalEff"),m=i("DBS_Skills"),g=i("DBS_EnemyRole"),y=i("DBS_LordRole"),v=i("DBS_OursideRole"),_=i("DBS_DataMgr"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.deopBulletsBase=null,e.oursideBase=null,e.enemyBase=null,e.roleBulletBase=null,e.birthEnemyPos=null,e.skillsBase=null,e.img_Bullet=null,e.txt_bulletFew=null,e.hpBar=null,e.gameState=h.DBS_GameState.pause,e.allEnemyList=[],e.buffDatas=[],e.buffSelectionCount={},e.currentBuffQuality=1,e.maxBuffQuality=4,e.buffsPerRefresh=3,e.takeGainSendFew=0,e.isTakeLock=!1,e.playInsistTime=0,e.playBulletLevel=1,e.enemyWave=[],e.nowWave=0,e.outWaveTime=0,e.mouseNum=0,e.snackNum=0,e.pigNum=0,e.bearNum=0,e.outEnemyInterval=.2,e.outEnemyTime=0,e.oursides=[],e.solderAsePaths=[],e.solderGainIDs=[],e.roleAsePathlength=0,e.mateCfgs=[],e.activateSkills=[],e.lordRoleGainID=0,e.mateOddsCfg=[],e.lordRole=null,e.skillsOusidePos=null,e.bulletImgs2=[],e.deopBulletType="deopBullet",e.tweenPoss=[],e.second=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this),this.deopBulletsBase=cc.find("deopBulletsBase",this.node),this.oursideBase=cc.find("oursideBase",this.node),this.enemyBase=cc.find("enemyBase",this.node),this.roleBulletBase=cc.find("roleBulletBase",this.node),this.birthEnemyPos=cc.find("birthEnemyPos",this.node).position.clone(),this.skillsOusidePos=cc.find("oursideBase/skillsOusidePos",this.node),this.skillsBase=cc.find("skillsBase",this.node),this.img_Bullet=cc.find("statusBar/img_Bullet",this.node).getComponent(cc.Sprite),this.txt_bulletFew=cc.find("statusBar/txt_bulletFew",this.node).getComponent(cc.Label),this.hpBar=cc.find("statusBar/hp_bg/hpBar",this.node).getComponent(cc.ProgressBar),this.initData(),this.setGameState(h.DBS_GameState.playing),this.roleAsePathlength=Object.keys(h.DBS_RoleAsePath).length-1,this.currentBuffQuality=1,this.deopBulletType="deopBullet_WEBLINK"},e.prototype.start=function(){var t=this;this.loadPrefab(h.DBS_BundleName.Prefabs,"ourside/lordRole",function(e){var o=cc.instantiate(e);o.setParent(t.oursides[t.solderGainIDs.length]),o.setPosition(cc.v3());var i=[11,1,7,3,4,6,8,10,17],n=i[t.random(0,i.length,!0)];t.solderAsePaths.push(n),t.solderGainIDs.push(h.DBS_RoleAsePath[n].ID),t.lordRoleGainID=n,t.lordRole=o.getComponent(y.default),t.lordRole.init(n)}),this.addEvent(h.DBS_EventName.ObtainBuff,this.obtainBuff)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),o.Instance=null},e.prototype.update=function(t){this.gameState!=h.DBS_GameState.pause&&(this.outWaveTime+=t,this.outWaveTime>this.enemyWave[this.nowWave].Interval&&(this.outWaveTime=0,this.mouseNum+=this.enemyWave[this.nowWave].MouseNum,this.snackNum+=this.enemyWave[this.nowWave].SnackNum,this.pigNum+=this.enemyWave[this.nowWave].PigNum,this.bearNum+=this.enemyWave[this.nowWave].BearNum,this.nowWave++),this.outEnemyTime+=t,this.outEnemyTime>this.outEnemyInterval&&(this.outEnemyTime=0,this.mouseNum>0?(this.mouseNum--,this.outEnemy(1)):this.snackNum>0?(this.snackNum--,this.outEnemy(2)):this.pigNum>0?(this.pigNum--,this.outEnemy(3)):this.bearNum>0&&(this.bearNum--,this.outEnemy(4))),this.updatePlayTime(t))},e.prototype.initData=function(){this.buffDatas=_.default.getInstance().getBuffCfg(),this.enemyWave=_.default.getInstance().getEnemyWaveCfg(),this.mateCfgs=_.default.getInstance().getMateCfg(),this.mateOddsCfg=_.default.getInstance().getMateOddsCfg()},e.prototype.getSolderSpAnimIds=function(){var t=new Set(this.solderAsePaths),e=this.lordRoleGainID,o=this.mateOddsCfg.find(function(t){return t.characterID===e});if(!o)return cc.error("\u627e\u4e0d\u5230\u4e3b\u89d2ID "+e+" \u7684 mateOdds \u914d\u7f6e"),[];var i=o.mateOdds.split("|").map(function(t){var e=t.split(","),o=e[0],i=e[1];return[parseInt(o,10),parseFloat(i)]}).filter(function(o){var i=o[0],n=o[1];return i!==e&&n>0&&!t.has(i)});if(0===i.length)return[];for(var n=[],a=0,r=0,s=i;r<s.length;r++){var c=s[r],l=c[0],p=c[1];a+=p,n.push([l,a])}for(var u=[],d=function(){var t=Math.random()*a,e=n.findIndex(function(e){var o=e[1];return t<=o});if(-1===e)return"break";var o=n[e],i=o[0];o[1],u.push(i);var r=0===e?n[0][1]:n[e][1]-n[e-1][1];a-=r,n.splice(e,1);for(var s=e;s<n.length;s++)n[s][1]-=r},h=0;h<2&&n.length>0&&"break"!==d();h++);return u},e.prototype.pickupSolderRole=function(t,e){var o=this;if(!(this.solderGainIDs.length>=3)){var i=this.solderGainIDs.length;this.loadPrefab(h.DBS_BundleName.Prefabs,"ourside/oursideRole",function(t){var n=cc.instantiate(t);n.setParent(o.oursides[i]),n.setPosition(cc.v3()),n.getComponent(v.default).init(e,i,o.lordRole.nowAtkForce,o.lordRole.nowAtkInterval)}),this.solderAsePaths.push(e),this.getActivatedMateIDs(t)}},e.prototype.getActivatedMateIDs=function(t){var e=this;this.solderGainIDs.push(t);for(var o=0,i=this.mateCfgs;o<i.length;o++){var n=i[o];this.activateSkills.includes(n.mateID)||n.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).includes(t)})&&n.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).every(function(t){return e.solderGainIDs.includes(t)})})&&(this.activateSkills.push(n.mateID),this.sendEvent(h.DBS_EventName.ActivateSkills,n.mateID))}},e.prototype.playSkillsAtk=function(t){var e=this,o="skills/skills_"+t;this.loadPrefab(h.DBS_BundleName.Prefabs,o,function(o){var i=cc.instantiate(o);i.setParent(e.skillsBase);var n=cc.v3();2==t&&(n.x=-80),i.setPosition(n),i.getComponent(m.default).init(t,_.default.getInstance().getSkillsCfg(t).mateSkillATK)})},e.prototype.playSkillsOuside=function(){var t=this;this.loadPrefab(h.DBS_BundleName.Prefabs,"ourside/oursideRole_Skills",function(e){var o=cc.instantiate(e);o.setParent(t.skillsOusidePos),o.setPosition(cc.v3()),o.getComponent(v.default).init(0,0,t.lordRole.nowAtkForce,t.lordRole.nowAtkInterval)})},e.prototype.updateStatusHpBar=function(t){this.hpBar.progress=t},e.prototype.updateStausBullet=function(t,e){this.txt_bulletFew.string=""+t,e&&(cc.Tween.stopAllByTarget(this.txt_bulletFew.node),cc.tween(this.txt_bulletFew.node).to(.1,{scale:.8}).to(.2,{scale:.5}).start())},e.prototype.setGameState=function(t){switch(this.gameState=t,this.sendEvent(h.DBS_EventName.SetGameState,this.gameState),this.gameState){case h.DBS_GameState.pause:cc.director.getPhysicsManager().enabled=!1,cc.director.getCollisionManager().enabled=!1;break;case h.DBS_GameState.playing:cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0}},e.prototype.getBulletImg=function(){return this.playBulletLevel<1&&(this.playBulletLevel=1),this.playBulletLevel>5&&(this.playBulletLevel=5),this.bulletImgs2[this.playBulletLevel-1]},e.prototype.sendBullet=function(t,e,o,i){var n=this;void 0===e&&(e=1),void 0===o&&(o=cc.v2(0,400)),void 0===i&&(i=0),this.loadPrefab(h.DBS_BundleName.Prefabs,"bullet/"+this.deopBulletType,function(a){for(var r=0;r<e;r++)n.scheduleOnce(function(){var e=cc.instantiate(a);e.setParent(n.deopBulletsBase),e.setPosition(t),e.getComponent(d.default).init(o,i,n.tweenPoss)},.001*r)})},e.prototype.playDieAnim=function(t,e){var o=u.PoolMgr.getInstance().getNode(h.DBS_PoolKeyName.dieEff);o.setParent(e),t.y-=30,o.setPosition(t)},e.prototype.playCriticalAnim=function(t,e){var o=u.PoolMgr.getInstance().getNode(h.DBS_PoolKeyName.criticalEff);o.setParent(this.roleBulletBase),o.setPosition(t),o.getComponent(f.default).init(e)},e.prototype.outEnemy=function(t){var e="enemyRole_"+t,o=u.PoolMgr.getInstance().getNode(e);o.setParent(this.enemyBase);var i=this.birthEnemyPos.clone();i.y+=this.random(-50,100),o.setPosition(i),o.getComponent(g.default).init(),this.addEnemyList(o)},e.prototype.addEnemyList=function(t){this.allEnemyList.push(t),this.tierEnemyList()},e.prototype.removeEnemyList=function(t){var e=this.allEnemyList.indexOf(t);-1!==e&&this.allEnemyList.splice(e,1)},e.prototype.tierEnemyList=function(){var t=this.allEnemyList;t.sort(function(t,e){return e.y-t.y}),t.forEach(function(t,e){t.setSiblingIndex(e)})},e.prototype.getEnemyNear=function(t,e){for(var o=t.parent.convertToWorldSpaceAR(t.getPosition()).x,i=null,n=Number.POSITIVE_INFINITY,a=0,r=this.allEnemyList;a<r.length;a++){var s=r[a];if(s.active){var c=s.parent.convertToWorldSpaceAR(s.getPosition()),l=Math.abs(c.x-o);l<e&&l<n&&(n=l,i=s)}}return i},e.prototype.getEnenyFew=function(){return this.allEnemyList.length},e.prototype.updatePlayTime=function(t){this.second+=t,this.second>1&&(this.second=0,this.playInsistTime++,this.sendEvent(h.DBS_EventName.UpdateUIShowPlayTime),this.playInsistTime%60==0&&this.sendEvent(h.DBS_EventName.TimeLevelUp))},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.prototype.obtainBuff=function(t,e){switch(t){case 9019:case 9026:if(this.playBulletLevel>=5)return;this.playBulletLevel+=e,this.playBulletLevel>5&&(this.playBulletLevel=5),this.sendEvent(h.DBS_EventName.PlayBulletLevelUp),this.img_Bullet.spriteFrame=this.getBulletImg(),p.AudioMgr.getInstance().playEffectFree(h.DBS_AudioId.shengji)}},e.prototype.showBuffSelection=function(){for(var t=this.getBackBuffs();0==t.length&&this.currentBuffQuality<=4;)this.currentBuffQuality++,t=this.getBackBuffs();return t},e.prototype.getBackBuffs=function(){var t=this.getBuffsByQuality(this.currentBuffQuality);return this.getRandomBuffs(t,this.buffsPerRefresh)},e.prototype.onBuffSelected=function(t){this.buffSelectionCount[t]=(this.buffSelectionCount[t]||0)+1,this.currentBuffQuality=1},e.prototype.getAvailableBuffs=function(){var t=this;return this.buffDatas.filter(function(e){return(t.buffSelectionCount[e.ID]||0)<e.buffNum})},e.prototype.getBuffsByQuality=function(t){return this.getAvailableBuffs().filter(function(e){return e.buffQuality===t})},e.prototype.getRandomBuffs=function(t,e){return t.length<e?t:t.sort(function(){return.5-Math.random()}).slice(0,e)},e.Instance=null,c([I(cc.Node)],e.prototype,"oursides",void 0),c([I(cc.SpriteFrame)],e.prototype,"bulletImgs2",void 0),c([I(cc.Node)],e.prototype,"tweenPoss",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],DBS_JoystickCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1eb82Jq6B1CS4uquO/G2A3U","DBS_JoystickCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1eb82Jq6B1CS4uquO/G2A3U","DBS_JoystickCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DBS_Config"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchId=-1,e}return s(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.onTouchMove=function(t){var e=t.getDeltaX();this.sendEvent(p.DBS_EventName.TouchMove,e)},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DBS_LordRole:[function(t,e,o){"use strict";cc._RF.push(e,"51518O+2CZCZYz2zvIKEJpK","DBS_LordRole");var i=t,n=e,a=o;cc._RF.push(n,"51518O+2CZCZYz2zvIKEJpK","DBS_LordRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("PoolMgr"),u=i("UIMgr"),d=i("DBS_RoleBullet"),h=i("DBS_Config"),f=i("DBS_GameEnumData"),m=i("DBS_DataMgr"),g=i("DBS_GameManager"),y=i("DBS_RoleBase"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aktPos=null,e.maxHp=100,e.nowHp=0,e.addHpRatio=0,e.addHpRatioTime=0,e.residueBulletFew=0,e.bulletTrajectory=1,e.bulletStepY=20,e.bulletPenetrateFew=1,e.basicAtkForce=10,e.nowAtkForce=0,e.criticalForce=0,e.criticalChance=0,e.addAtkForce=0,e.clipDuration=null,e.atkAnimTimeSpeed=1,e.bulletPath="",e.skillsAnim=null,e.isSkillsAtkDouble=!1,e.skillsAtkDoubleTime=0,e.roleAtkdistance=600,e.atkTarget=null,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.aktPos=cc.find("aktPos",this.node),this.skillsAnim=cc.find("skillsAnim",this.node).getComponent(sp.Skeleton),this.skillsAnim.node.active=!1,this.basicAtkForce=1.5*m.default.getInstance().getAtk().Attack,this.basicAtkInterval=m.default.getInstance().getParameterCfg(f.DBS_EnumGearParameterCfg.PlayerAtkSpeed).value,this.criticalChance=m.default.getInstance().getParameterCfg(f.DBS_EnumGearParameterCfg.CriticalChance).value,this.criticalForce=m.default.getInstance().getParameterCfg(f.DBS_EnumGearParameterCfg.CriticalAtk).value,this.maxHp=m.default.getInstance().getParameterCfg(f.DBS_EnumGearParameterCfg.Healthy).value,this.nowAtkForce=this.basicAtkForce,this.nowAtkInterval=this.basicAtkInterval,this.nowHp=this.maxHp,this.updateStatusBar(),g.default.Instance.updateStausBullet(this.residueBulletFew,!1)},e.prototype.start=function(){this.addEvent(h.DBS_EventName.AddRoleBullet,this.addBullet),this.addEvent(h.DBS_EventName.AttackPlayer,this.attackEd),this.addEvent(h.DBS_EventName.PlayBulletLevelUp,this.playBulletLevelUp),this.addEvent(h.DBS_EventName.ObtainBuff,this.obtainBuff),this.addEvent(h.DBS_EventName.SkillsAtkDouble,this.skillsAtkDouble)},e.prototype.init=function(t){var e=this;this.loadResFromBundle(h.DBS_BundleName.SpAnim,h.DBS_RoleAsePath[t].path,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,h.DBS_AnimName.idle,!0);var o=e.spAnim.findAnimation(h.DBS_AnimName.attack);e.clipDuration=o.duration,e.setSpAnimPlaySpeed()}),this.bulletPath=m.default.getInstance().getSolderRole(h.DBS_RoleAsePath[t].ID).bullet},e.prototype.update=function(t){if(g.default.Instance.gameState!=h.DBS_GameState.pause){if(this.isSkillsAtkDouble&&(this.skillsAtkDoubleTime+=t,this.skillsAtkDoubleTime>30&&(this.isSkillsAtkDouble=!1,this.skillsAtkDoubleTime=0,this.skillsAnim.node.active=!1)),0!=this.addHpRatio&&(this.addHpRatioTime+=t,this.addHpRatioTime>1&&!(this.nowHp>this.maxHp))){this.addHpRatioTime=0;var e=g.default.Instance.round(this.maxHp*this.addHpRatio);this.nowHp+=e,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.updateStatusBar()}this.atkState!=h.DBS_AtkState.ready?(this.atkTime+=t,this.atkTime>this.nowAtkInterval&&(this.atkTime=0,this.atkState=h.DBS_AtkState.ready)):this.atkState==h.DBS_AtkState.ready&&this.isPlayAtkAnim()}},e.prototype.skillsAtkDouble=function(){this.isSkillsAtkDouble=!0,this.skillsAtkDoubleTime=0,this.skillsAnim.node.active=!0,this.skillsAnim.setAnimation(0,h.DBS_AnimName.animation,!0)},e.prototype.isPlayAtkAnim=function(){this.residueBulletFew>0&&(this.atkTarget=g.default.Instance.getEnemyNear(this.node,this.roleAtkdistance),null!=this.atkTarget&&(this.atkState=h.DBS_AtkState.underway,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,h.DBS_AnimName.attack,!1)))},e.prototype.setSpAnimPlaySpeed=function(){this.nowAtkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.nowAtkInterval*1.1)},e.prototype.attack=function(){if(null!=this.atkTarget&&this.atkTarget.active||(this.atkTarget=g.default.Instance.getEnemyNear(this.node,this.roleAtkdistance)),null!=this.atkTarget&&this.atkTarget.active){this.reduceBullet();var t=this.nowAtkForce;this.isSkillsAtkDouble&&(t=2*this.nowAtkForce);var e=this.aktPos.convertToWorldSpaceAR(cc.v2(0,0)),o=this.atkTarget.convertToWorldSpaceAR(cc.v2(0,0)).sub(e).normalize(),i=180*Math.atan2(o.y,o.x)/Math.PI-90;this.atkTarget=null;for(var n=0;n<this.bulletTrajectory;n++){var a=p.PoolMgr.getInstance().getNode(h.DBS_PoolKeyName.roleBullet);a.setParent(g.default.Instance.roleBulletBase);var r=this.aktPos.convertToWorldSpaceAR(cc.v2(0,0)),s=this.bulletTrajectory,c=-this.bulletStepY*(s-1)/2+n*this.bulletStepY;r.y+=c;var l=a.parent.convertToNodeSpaceAR(r);a.setPosition(l),a.angle=i,a.getComponent(d.default).init(this.bulletPath,t,o,this.bulletPenetrateFew,this.criticalChance,this.criticalForce)}}},e.prototype.attackEd=function(t){this.nowHp-=t,this.updateStatusBar(),this.nowHp<0?(g.default.Instance.setGameState(h.DBS_GameState.pause),u.UIMgr.getInstance().openUI(h.DBS_UIID.DBS_UIGameOver,1,!1),l.AudioMgr.getInstance().playEffectFree(h.DBS_AudioId.shibai)):l.AudioMgr.getInstance().playEffectFree(h.DBS_AudioId.shouji)},e.prototype.addBullet=function(){this.residueBulletFew++,g.default.Instance.updateStausBullet(this.residueBulletFew,!0)},e.prototype.reduceBullet=function(){this.residueBulletFew--,g.default.Instance.updateStausBullet(this.residueBulletFew,!1)},e.prototype.updateStatusBar=function(){var t=this.nowHp/this.maxHp;g.default.Instance.updateStatusHpBar(t)},e.prototype.playBulletLevelUp=function(){this.basicAtkForce=m.default.getInstance().getAtk().Attack,this.nowAtkForce=this.basicAtkForce*(1+this.addAtkForce),this.sendEvent(h.DBS_EventName.OursideUpdateInfo,this.nowAtkForce,this.nowAtkInterval)},e.prototype.obtainBuff=function(t,e){switch(t){case 9001:case 9010:case 9020:case 9020:this.addAtkForce+=e,this.nowAtkForce=g.default.Instance.round(this.basicAtkForce*(1+this.addAtkForce));break;case 9002:case 9011:case 9021:case 9031:this.criticalForce+=e;break;case 9003:case 9012:case 9022:case 9032:this.criticalChance+=e;break;case 9005:var o=g.default.Instance.round(this.maxHp*e);this.nowHp+=o,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.updateStatusBar();break;case 9007:case 9017:this.addHpRatio+=e;break;case 9008:case 9018:case 9028:case 9035:this.addAtkInterval+=e,this.nowAtkInterval=this.basicAtkInterval/(1+this.addAtkInterval),this.setSpAnimPlaySpeed();break;case 9014:case 9029:this.bulletTrajectory+=e;break;case 9027:case 9037:this.bulletPenetrateFew+=e}this.sendEvent(h.DBS_EventName.OursideUpdateInfo,this.nowAtkForce,this.nowAtkInterval)},c([_],e)}(y.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],DBS_OursideRole:[function(t,e,o){"use strict";cc._RF.push(e,"3490642Lm1DP5yL+5A7AQdP","DBS_OursideRole");var i=t,n=e,a=o;cc._RF.push(n,"3490642Lm1DP5yL+5A7AQdP","DBS_OursideRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("DBS_RoleBullet"),u=i("DBS_Config"),d=i("DBS_GameEnumData"),h=i("DBS_DataMgr"),f=i("DBS_GameManager"),m=i("DBS_RoleBase"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSkills=!1,e.skillsTime=0,e.aktPos=null,e.oursideFew=0,e.atkForce=0,e.bulletPath="",e.clipDuration=null,e.atkAnimTimeSpeed=1,e.roleAtkdistance=678,e.atkTarget=null,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.aktPos=cc.find("aktPos",this.node),this.isSkills&&(this.roleAtkdistance=592)},e.prototype.init=function(t,e,o,i){var n=this;this.isSkills?this.bulletPath="hero8_bullet1":(this.oursideFew=e,this.loadResFromBundle(u.DBS_BundleName.SpAnim,u.DBS_RoleAsePath[t].path,sp.SkeletonData,function(t){n.spAnim.skeletonData=t,n.spAnim.setAnimation(0,u.DBS_AnimName.idle,!0);var e=n.spAnim.findAnimation(u.DBS_AnimName.attack);n.clipDuration=e.duration,n.setSpAnimPlaySpeed()}),this.bulletPath=h.default.getInstance().getSolderRole(u.DBS_RoleAsePath[t].ID).bullet),this.updateInfo(o,i),this.addEvent(u.DBS_EventName.OursideUpdateInfo,this.updateInfo)},e.prototype.updateInfo=function(t,e){if(this.isSkills)this.atkForce=h.default.getInstance().getSkillsCfg(7).mateSkillATK,this.nowAtkInterval=e/2;else{var o=.7;switch(this.oursideFew){case 1:o=h.default.getInstance().getParameterCfg(d.DBS_EnumGearParameterCfg.Character2Atk).value;break;case 2:o=h.default.getInstance().getParameterCfg(d.DBS_EnumGearParameterCfg.Character3Atk).value}this.atkForce=f.default.Instance.round(t*o),this.nowAtkInterval=e*h.default.getInstance().getParameterCfg(d.DBS_EnumGearParameterCfg.CharacterAtkSpeed).value}this.setSpAnimPlaySpeed()},e.prototype.update=function(t){f.default.Instance.gameState!=u.DBS_GameState.pause&&(this.isSkills?(this.skillsTime+=t,this.skillsTime>30&&this.node.destroy(),this.atkState!=u.DBS_AtkState.ready?(this.atkTime+=t,this.atkTime>this.nowAtkInterval&&(this.atkTime=0,this.atkState=u.DBS_AtkState.ready)):this.atkState==u.DBS_AtkState.ready&&this.attack()):this.atkState!=u.DBS_AtkState.ready?(this.atkTime+=t,this.atkTime>this.nowAtkInterval&&(this.atkTime=0,this.atkState=u.DBS_AtkState.ready)):this.atkState==u.DBS_AtkState.ready&&this.isPlayAtkAnim())},e.prototype.isPlayAtkAnim=function(){this.atkTarget=f.default.Instance.getEnemyNear(this.node,this.roleAtkdistance),null!=this.atkTarget&&(this.atkState=u.DBS_AtkState.underway,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,u.DBS_AnimName.attack,!1))},e.prototype.setSpAnimPlaySpeed=function(){this.nowAtkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.nowAtkInterval*1.1)},e.prototype.attack=function(){if(null!=this.atkTarget&&this.atkTarget.active||(this.atkTarget=f.default.Instance.getEnemyNear(this.node,this.roleAtkdistance)),null!=this.atkTarget&&this.atkTarget.active){this.atkState=u.DBS_AtkState.underway;var t=this.aktPos.convertToWorldSpaceAR(cc.v2(0,0)),e=t,o=this.atkTarget.convertToWorldSpaceAR(cc.v2(0,0)).sub(e).normalize(),i=180*Math.atan2(o.y,o.x)/Math.PI-90;this.atkTarget=null;var n=l.PoolMgr.getInstance().getNode(u.DBS_PoolKeyName.roleBullet);n.setParent(f.default.Instance.roleBulletBase);var a=n.parent.convertToNodeSpaceAR(t);n.setPosition(a),n.angle=i,n.getComponent(p.default).init(this.bulletPath,this.atkForce,o,1,0,1)}},c([v(Boolean)],e.prototype,"isSkills",void 0),c([y],e)}(m.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DBS_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"72ccakmmcRITrEzcRejxpQ3","DBS_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"72ccakmmcRITrEzcRejxpQ3","DBS_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=cc._decorator.ccclass,l=function(){function t(){this.poolMap={},this.poolObjBase=null;var t=new cc.Node("poolObjBase"),e=cc.find("uiRoot");t.setParent(e),this.poolObjBase=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e,o){var i=e.replace(/\//g,"_");this.poolMap[i]&&this.poolMap[i].poolList.length>0?o(this.poolMap[i].getObj()):s.ResourceMgr.getInstance().loadRes(t,e,cc.Prefab,function(t){var e=cc.instantiate(t);e.name=i,o(e)})},t.prototype.PushObj=function(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new p(t,this.poolObjBase);this.poolMap[e]=o}},e=r([c],t)}();a.default=l;var p=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],DBS_RoleBase:[function(t,e,o){"use strict";cc._RF.push(e,"a9afdh+mXhEtLOw3HuQVOGE","DBS_RoleBase");var i=t,n=e,a=o;cc._RF.push(n,"a9afdh+mXhEtLOw3HuQVOGE","DBS_RoleBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DBS_Config"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.basicAtkInterval=.15,e.nowAtkInterval=0,e.atkTime=0,e.addAtkInterval=0,e.atkState=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim=cc.find("spAnim",this.node).getComponent(sp.Skeleton),this.atkState=p.DBS_AtkState.cooling,this.spAnim.setCompleteListener(function(e){e.animation.name==p.DBS_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.atkState=p.DBS_AtkState.cooling,t.spAnim.setAnimation(0,p.DBS_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==p.DBS_AnimName.attack&&t.attack()}),this.addEvent(p.DBS_EventName.SetGameState,this.setGameState)},e.prototype.setGameState=function(t){switch(t){case p.DBS_GameState.pause:this.spAnim.paused=!0;break;case p.DBS_GameState.playing:this.spAnim.paused=!1}},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DBS_RoleBullet:[function(t,e,o){"use strict";cc._RF.push(e,"8e4526Aj+VF74z899vnmBvN","DBS_RoleBullet");var i=t,n=e,a=o;cc._RF.push(n,"8e4526Aj+VF74z899vnmBvN","DBS_RoleBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("DBS_Config"),d=i("DBS_GameManager"),h=i("DBS_EnemyRole"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spr=null,e.atkForce=0,e.moveSpeed=1e3,e.moveDir=cc.v2(0,1),e.atkList=[],e.bulletPenetrateFew=1,e.criticalForce=0,e.criticalChance=0,e.dieTime=0,e.isDie=!1,e}return s(e,t),e.prototype.onLoad=function(){this.spr=cc.find("icon",this.node).getComponent(cc.Sprite)},e.prototype.init=function(t,e,o,i,n,a){this.atkForce=e,this.bulletPenetrateFew=i,this.criticalChance=n,this.criticalForce=a,this.spr.spriteFrame=d.default.Instance.getBulletImg(),this.isDie=!1,this.moveDir=o},e.prototype.update=function(t){d.default.Instance.gameState!=u.DBS_GameState.pause&&(this.isDie||(this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t,this.dieTime+=t,this.dieTime>4&&this.die()))},e.prototype.onCollisionEnter=function(t){if(!this.isDie&&t.tag==u.DBS_ColliderName.enemy&&this.atkList.length<this.bulletPenetrateFew){var e=t.node.getComponent(h.default);if(e.getIsDie())return;this.atkList.push(t.node);var o=this.atkForce;if(Math.random()<this.criticalChance){o=d.default.Instance.round(this.atkForce*this.criticalForce);var i=t.node.position.clone();d.default.Instance.playCriticalAnim(i,o)}e.attackEd(o),this.atkList.length==this.bulletPenetrateFew&&this.die()}},e.prototype.die=function(){this.isDie=!0,this.moveDir=cc.v2(),this.atkList=[],this.dieTime=0,p.PoolMgr.getInstance().freeNode(u.DBS_PoolKeyName.roleBullet,this.node)},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DBS_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"dc767U172dMqrAVPryqMAvU","DBS_Skills");var i=t,n=e,a=o;cc._RF.push(n,"dc767U172dMqrAVPryqMAvU","DBS_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DBS_Config"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skillID=0,e.atkForce=0,e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim=cc.find("spAnim",this.node).getComponent(sp.Skeleton),this.spAnim.setCompleteListener(function(e){e.animation.name==p.DBS_AnimName.animation&&t.node.destroy()}),this.spAnim.setEventListener(function(e,o){o.data.name==p.DBS_AnimName.attack&&t.sendEvent(p.DBS_EventName.PlaySkillsAtk,t.skillID,t.atkForce,t.node)})},e.prototype.init=function(t,e){this.skillID=t,this.atkForce=e,this.spAnim.setAnimation(0,p.DBS_AnimName.animation,!1)},e.prototype.showDebugRect=function(){this.graphics=this.node.addComponent(cc.Graphics),this.graphics.lineWidth=4,this.graphics.strokeColor=cc.Color.RED,this.drawDebugRect(),this.scheduleOnce(this.clearDebugRect,3)},e.prototype.drawDebugRect=function(){this.graphics.rect(0,0,200,100),this.graphics.stroke()},e.prototype.clearDebugRect=function(){this.graphics.clear()},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DBS_TakeBase:[function(t,e,o){"use strict";cc._RF.push(e,"9fa97SONNNDOoyzMM83fKub","DBS_TakeBase");var i=t,n=e,a=o;cc._RF.push(n,"9fa97SONNNDOoyzMM83fKub","DBS_TakeBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.take_Txt=null,e.layerID=0,e.sendFew=2,e}return s(e,t),e.prototype.onLoad=function(){this.take_Txt=cc.find("take_Txt",this.node).getComponent(cc.Label)},e.prototype.playTxtAnim=function(){cc.Tween.stopAllByTarget(this.take_Txt.node),cc.tween(this.take_Txt.node).to(.1,{scale:.8}).to(.1,{scale:.5}).start()},c([d(Number)],e.prototype,"layerID",void 0),c([d(Number)],e.prototype,"sendFew",void 0),c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DBS_TakeBuff:[function(t,e,o){"use strict";cc._RF.push(e,"326e6czQ0FHILvamUmKH8Jl","DBS_TakeBuff");var i=t,n=e,a=o;cc._RF.push(n,"326e6czQ0FHILvamUmKH8Jl","DBS_TakeBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("UIMgr"),u=i("DBS_DropBullet"),d=i("DBS_Config"),h=i("DBS_DataMgr"),f=i("DBS_GameManager"),m=i("DBS_TakeBase"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openFew=1,e.lockFew=0,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.lockFew=h.default.getInstance().getDropCfg(this.openFew).Reward,this.take_Txt.string="\xd7"+this.lockFew},e.prototype.onBeginContact=function(t,e,o){if(f.default.Instance.gameState!=d.DBS_GameState.pause&&e.tag==d.DBS_ColliderName.take_Trigger)switch(o.tag){case d.DBS_ColliderName.deopBullet:this.playTxtAnim(),o.getComponent(u.default).dis(),this.lockFew--,this.take_Txt.string="\xd7"+this.lockFew,this.lockFew<=0&&(l.AudioMgr.getInstance().playEffectFree(d.DBS_AudioId.huode),f.default.Instance.setGameState(d.DBS_GameState.pause),p.UIMgr.getInstance().openUI(d.DBS_UIID.DBS_UISelectBuff,1,f.default.Instance.showBuffSelection()),this.openFew++,this.lockFew=h.default.getInstance().getDropCfg(this.openFew).Reward,this.take_Txt.string="\xd7"+this.lockFew)}},e.prototype.playTxtAnim=function(){cc.Tween.stopAllByTarget(this.take_Txt.node),cc.tween(this.take_Txt.node).to(.1,{scale:1}).to(.1,{scale:.7}).start()},c([y],e)}(m.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],DBS_TakeGain:[function(t,e,o){"use strict";cc._RF.push(e,"f9d25L2yu5Nu72rD2Rvtgb2","DBS_TakeGain");var i=t,n=e,a=o;cc._RF.push(n,"f9d25L2yu5Nu72rD2Rvtgb2","DBS_TakeGain");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("PlatformSetting"),u=i("AudioMgr"),d=i("DBS_DropBullet"),h=i("DBS_Config"),f=i("DBS_GameManager"),m=i("DBS_TakeBase"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTake200=!1,e.sendOff=!0,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.isTake200&&(p.PlatformSetting.currentPlatform==l.Platform.WEB_LINK?this.sendFew=49:this.sendFew=19)},e.prototype.init=function(t,e){this.layerID=t,this.take_Txt.string="\xd7"+e,this.sendFew=e-1},e.prototype.onBeginContact=function(t,e,o){var i=this;if(e.tag==h.DBS_ColliderName.take_Trigger)switch(o.tag){case h.DBS_ColliderName.deopBullet:var n=o.getComponent(d.default);if(n.getUsedTake(this.layerID))if(this.isTake200){if(this.sendOff){this.sendOff=!1,setTimeout(function(){i.sendOff=!0},500),n.setUsedTake(this.layerID);var a=n.node.position;(r=n.getRigFallV()).x,r.y,f.default.Instance.sendBullet(a,this.sendFew,r,this.layerID),this.playTxtAnim(),u.AudioMgr.getInstance().playEffectFree(h.DBS_AudioId.fanbei)}}else{n.setUsedTake(this.layerID),a=n.node.position;var r=n.getRigFallV();f.default.Instance.sendBullet(a,this.sendFew,r,this.layerID),this.playTxtAnim(),u.AudioMgr.getInstance().playEffectFree(h.DBS_AudioId.fanbei)}}},c([v(Boolean)],e.prototype,"isTake200",void 0),c([y],e)}(m.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DBS_TakeLock:[function(t,e,o){"use strict";cc._RF.push(e,"357bbxNGTRCFqP1Rq+rJg1n","DBS_TakeLock");var i=t,n=e,a=o;cc._RF.push(n,"357bbxNGTRCFqP1Rq+rJg1n","DBS_TakeLock");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DBS_DropBullet"),p=i("DBS_Config"),u=i("DBS_GameEnumData"),d=i("DBS_DataMgr"),h=i("DBS_GameManager"),f=i("DBS_TakeBase"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lockFew=50,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.lockFew=d.default.getInstance().getParameterCfg(u.DBS_EnumGearParameterCfg.LockNum).value,this.take_Txt.string="\xd7"+this.lockFew},e.prototype.onBeginContact=function(t,e,o){if(e.tag==p.DBS_ColliderName.take_Trigger)switch(o.tag){case p.DBS_ColliderName.deopBullet:this.playTxtAnim(),o.getComponent(l.default).dis(),this.lockFew--,this.take_Txt.string="\xd7"+this.lockFew,this.lockFew<=0&&(h.default.Instance.isTakeLock=!0,this.node.destroy())}},c([g],e)}(f.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DBS_TakeMove:[function(t,e,o){"use strict";cc._RF.push(e,"d91c6eGxkJKnbX4dvK5jNSt","DBS_TakeMove");var i=t,n=e,a=o;cc._RF.push(n,"d91c6eGxkJKnbX4dvK5jNSt","DBS_TakeMove");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DBS_DropBullet"),p=i("DBS_Config"),u=i("DBS_GameManager"),d=i("DBS_TakeBase"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDirection=!1,e.horizontalSpeed=170,e.isInitPos=!0,e.nowNobePos=cc.v2(),e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){},0),setTimeout(function(){t.node.setPosition(cc.v2(0,-496)),t.isInitPos=!1},20)},e.prototype.update=function(t){u.default.Instance.gameState!=p.DBS_GameState.pause&&(this.isInitPos?0!=this.node.x&&this.node.setPosition(cc.v2(0,-496)):(this.nowNobePos=this.node.getPosition(),this.isDirection?(this.node.setPosition(this.nowNobePos.x-this.horizontalSpeed*t,this.nowNobePos.y),this.node.x<-255&&(this.isDirection=!this.isDirection)):(this.node.setPosition(this.nowNobePos.x+this.horizontalSpeed*t,this.nowNobePos.y),this.node.x>255&&(this.isDirection=!this.isDirection))))},e.prototype.onBeginContact=function(t,e,o){if(e.tag==p.DBS_ColliderName.take_Trigger)switch(o.tag){case p.DBS_ColliderName.deopBullet:var i=o.getComponent(l.default);if(i.getUsedTake(this.layerID)){i.setUsedTake(this.layerID);var n=i.node.position,a=i.getRigFallV();u.default.Instance.sendBullet(n,this.sendFew,a,this.layerID),this.playTxtAnim()}}},c([f],e)}(d.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DBS_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"d8e415W/6RFE4I0CZE3Hk6I","DBS_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"d8e415W/6RFE4I0CZE3Hk6I","DBS_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DBS_Config"),u=i("DBS_GameManager"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.GM_Trajectoryv=null,e.GM_PenetrateFew=null,e.GM_RoleSpeed=null,e.GM_CriticalChance=null,e.GM_CriticalForce=null,e.GM_BulletFew=null,e.GM_BulletSpeed=null,e.GM_BulletLevelUp=null,e.GM_AddTakeGain=null,e.GM_SolderRole=null,e.GM_Buff=null,e.GM_Skills_1=null,e.GM_Skills_2=null,e.GM_Skills_3=null,e.GM_Skills_4=null,e.GM_Skills_5=null,e.GM_Skills_6=null,e.GM_Skills_7=null,e}return s(e,t),e.prototype.onLoad=function(){this.initGM()},e.prototype.initGM=function(){var t=this;this.btnClose=cc.find("btnClose",this.node),this.GM_Trajectoryv=cc.find("GM_Base/GM_Trajectoryv",this.node),this.GM_PenetrateFew=cc.find("GM_Base/GM_PenetrateFew",this.node),this.GM_RoleSpeed=cc.find("GM_Base/GM_RoleSpeed",this.node),this.GM_CriticalChance=cc.find("GM_Base/GM_CriticalChance",this.node),this.GM_CriticalForce=cc.find("GM_Base/GM_CriticalForce",this.node),this.GM_BulletFew=cc.find("GM_Base/GM_BulletFew",this.node),this.GM_BulletSpeed=cc.find("GM_Base/GM_BulletSpeed",this.node),this.GM_BulletLevelUp=cc.find("GM_Base/GM_BulletLevelUp",this.node),this.GM_AddTakeGain=cc.find("GM_Base/GM_AddTakeGain",this.node),this.GM_SolderRole=cc.find("GM_Base/GM_SolderRole",this.node),this.GM_Buff=cc.find("GM_Base/GM_Buff",this.node),this.GM_Skills_1=cc.find("GM_Base/GM_Skills_1",this.node),this.GM_Skills_2=cc.find("GM_Base/GM_Skills_2",this.node),this.GM_Skills_3=cc.find("GM_Base/GM_Skills_3",this.node),this.GM_Skills_4=cc.find("GM_Base/GM_Skills_4",this.node),this.GM_Skills_5=cc.find("GM_Base/GM_Skills_5",this.node),this.GM_Skills_6=cc.find("GM_Base/GM_Skills_6",this.node),this.GM_Skills_7=cc.find("GM_Base/GM_Skills_7",this.node),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.GM_Trajectoryv.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9014,1)},this),this.GM_PenetrateFew.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9027,1)},this),this.GM_RoleSpeed.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9008,.1)},this),this.GM_CriticalChance.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9003,.1)},this),this.GM_CriticalForce.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9002,.2)},this),this.GM_BulletFew.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9004,50)},this),this.GM_BulletSpeed.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9006,.1)},this),this.GM_BulletLevelUp.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.ObtainBuff,9019,1)},this),this.GM_AddTakeGain.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.setGameState(p.DBS_GameState.pause),u.default.Instance.takeGainSendFew=3,t.sendEvent(p.DBS_EventName.AddBuffTakeGain,!0)},this),this.GM_SolderRole.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.setGameState(p.DBS_GameState.pause),t.openUI(p.DBS_UIID.DBS_UISelectSolderRole,u.default.Instance.getSolderSpAnimIds())},this),this.GM_Buff.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.setGameState(p.DBS_GameState.pause),t.openUI(p.DBS_UIID.DBS_UISelectBuff,u.default.Instance.showBuffSelection())},this),this.GM_Skills_1.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.GMPlaySkills,1)},this),this.GM_Skills_2.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.GMPlaySkills,2)},this),this.GM_Skills_3.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.GMPlaySkills,3)},this),this.GM_Skills_4.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.GMPlaySkills,4)},this),this.GM_Skills_5.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.GMPlaySkills,5)},this),this.GM_Skills_6.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.GMPlaySkills,6)},this),this.GM_Skills_7.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.DBS_EventName.GMPlaySkills,7)},this)},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DBS_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"2aa83hMQVRJeaZgFsiLgsEr","DBS_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"2aa83hMQVRJeaZgFsiLgsEr","DBS_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DBS_APP"),u=i("DBS_GameEnumData"),d=i("DBS_DataMgr"),h=i("DBS_GameManager"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.win=null,e.fail=null,e.btnClose=null,e.txt_Tips=null,e.txt_Kill=null,e.isWin=!1,e.needInsistTime=720,e}return s(e,t),e.prototype.onLoad=function(){this.win=cc.find("root/win",this.node),this.fail=cc.find("root/fail",this.node),this.btnClose=cc.find("root/btnClose",this.node),this.txt_Tips=cc.find("root/txt_Tips",this.node).getComponent(cc.RichText),this.txt_Kill=cc.find("root/txt_Kill",this.node).getComponent(cc.RichText),this.needInsistTime=d.default.getInstance().getParameterCfg(u.DBS_EnumGearParameterCfg.AllTime).value,this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this)},e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){if(this.win.active=this.isWin,this.fail.active=!this.isWin,this.isWin)this.txt_Tips.string="<outline color=black width=3>\u6210\u529f\u51fb\u9000\u6240\u6709\u602a\u7269</color></outline>",this.txt_Kill.string="<outline color=black width=3><color=#eb64ff>100%</color>\u602a\u7269</outline>";else{var t=h.default.Instance.playInsistTime,e=Math.floor(t/60),o=(t%60).toString().padStart(2,"0");this.txt_Tips.string="<outline color=black width=3>\u575a\u6301\u4e86<color=#7cf84b>"+e+":"+o+"</color></outline>";var i=t/this.needInsistTime;i=Math.floor(100*i),this.txt_Kill.string="<outline color=black width=3>\u51fb\u8d25\u4e86<color=#eb64ff>"+i+"%</color>\u602a\u7269</outline>"}},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DBS_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"2a9daHqro9EYZuhHXpbBQOz","DBS_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"2a9daHqro9EYZuhHXpbBQOz","DBS_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("DBS_Config"),m=i("DBS_GameEnumData"),g=i("DBS_DataMgr"),y=i("DBS_GameManager"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn_Pause=null,e.txt_PlayTimeShadow=null,e.txt_PlayTime=null,e.txt_TipsBar2=null,e.timeBar=null,e.addBuffTakeGainBase=null,e.btn_Skills1=null,e.btn_Skills2=null,e.lockMack_1=null,e.lockMack_2=null,e.isSkillLock1=!1,e.isSkillLock2=!1,e.skillInterval1=0,e.skillInterval2=0,e.skillTime1=0,e.skillTime2=0,e.activateSkills=[],e.playSkillTips=null,e.needInsistTime=720,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btn_Pause=cc.find("ui_Top/btn_Pause",this.node),this.txt_PlayTimeShadow=cc.find("ui_Top/showTime/txt_PlayTimeShadow",this.node).getComponent(cc.RichText),this.txt_PlayTime=cc.find("ui_Top/showTime/txt_PlayTimeShadow/txt_PlayTime",this.node).getComponent(cc.RichText),this.txt_TipsBar2=cc.find("ui_Top/showTime/txt_TipsBar2",this.node).getComponent(cc.RichText),this.timeBar=cc.find("ui_Top/showTime/time/timeBar",this.node).getComponent(cc.ProgressBar),this.btn_Skills1=cc.find("ui_Top/skills/btn_Skills1",this.node),this.btn_Skills2=cc.find("ui_Top/skills/btn_Skills2",this.node),this.lockMack_1=cc.find("ui_Top/skills/btn_Skills1/lockMack_1",this.node).getComponent(cc.ProgressBar),this.lockMack_2=cc.find("ui_Top/skills/btn_Skills2/lockMack_2",this.node).getComponent(cc.ProgressBar),this.playSkillTips=cc.find("ui_Top/playSkillTips",this.node),this.addBuffTakeGainBase.active=!1,this.playSkillTips.active=!1,this.btn_Skills1.active=!1,this.btn_Skills2.active=!1,this.lockMack_1.node.active=!1,this.lockMack_2.node.active=!1,this.btn_Pause.on(cc.Node.EventType.TOUCH_END,function(){y.default.Instance.setGameState(f.DBS_GameState.pause),t.openUI(f.DBS_UIID.DBS_UIPause)},this),(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&this.txt_PlayTime.node.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(f.DBS_UIID.DBS_UIGM)},this),this.needInsistTime=g.default.getInstance().getParameterCfg(m.DBS_EnumGearParameterCfg.AllTime).value,this.btn_Skills1.on(cc.Node.EventType.TOUCH_END,function(){t.isSkillLock1||(t.lockMack_1.node.active=!0,t.lockMack_1.progress=1,t.isSkillLock1=!0,t.skillTime1=t.skillInterval1,t.playSkills(t.activateSkills[0]))},this),this.btn_Skills2.on(cc.Node.EventType.TOUCH_END,function(){t.isSkillLock2||(t.lockMack_2.node.active=!0,t.lockMack_2.progress=1,t.isSkillLock2=!0,t.skillTime2=t.skillInterval2,t.playSkills(t.activateSkills[1]))},this)},e.prototype.start=function(){this.updateShowPlayTime(),this.addEvent(f.DBS_EventName.UpdateUIShowPlayTime,this.updateShowPlayTime),this.addEvent(f.DBS_EventName.AddBuffTakeGain,this.showAddBuffTakeGain),this.addEvent(f.DBS_EventName.ActivateSkills,this.onSkillAdded),this.addEvent(f.DBS_EventName.GMPlaySkills,this.playSkills)},e.prototype.update=function(t){y.default.Instance.gameState!=f.DBS_GameState.pause&&(this.isSkillLock1&&(this.skillTime1-=t,this.lockMack_1.progress=this.skillTime1/this.skillInterval1,this.skillTime1<0&&(this.isSkillLock1=!1,this.lockMack_1.node.active=!1)),this.isSkillLock2&&(this.skillTime2-=t,this.lockMack_2.progress=this.skillTime2/this.skillInterval2,this.skillTime2<0&&(this.isSkillLock2=!1,this.lockMack_2.node.active=!1)))},e.prototype.playSkills=function(t){switch(t){case 1:case 2:case 3:case 4:y.default.Instance.playSkillsAtk(t);break;case 5:this.sendEvent(f.DBS_EventName.SkillsAtkDouble);break;case 6:this.sendEvent(f.DBS_EventName.ObtainBuff,9019,1);break;case 7:y.default.Instance.playSkillsOuside()}d.AudioMgr.getInstance().playEffectFree(g.default.getInstance().getSkillsCfg(t).mateSound);var e=this.playSkillTips.position.clone(),o=cc.instantiate(this.playSkillTips);o.active=!0,o.setParent(this.playSkillTips.parent),o.setPosition(e);var i="skillsBanner/"+g.default.getInstance().getSkillsCfg(t).mateBannerRes;this.loadSpriteFrame(f.DBS_BundleName.Sprite,i,function(t){o.getComponent(cc.Sprite).spriteFrame=t}),e.x+=400,cc.tween(o).to(.4,{position:e}).start(),setTimeout(function(){e.x-=400,cc.tween(o).to(.4,{position:e}).call(function(){o.destroy()}).start()},2400)},e.prototype.onSkillAdded=function(t){var e=this;if(!(this.activateSkills.length>=2)){if(this.activateSkills.push(t),1==this.activateSkills.length){this.btn_Skills1.active=!0,this.skillInterval1=g.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime1=this.skillInterval1;var o="skillsBtnIcon/"+g.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(f.DBS_BundleName.Sprite,o,function(o){e.btn_Skills1.getComponent(cc.Sprite).spriteFrame=o,e.btn_Skills1.setScale(0),cc.tween(e.btn_Skills1).to(.2,{scale:1}).start(),e.btn_Skills1.getChildByName("skillName").getComponent(cc.Label).string=g.default.getInstance().getSkillsCfg(t).mateName})}else 2==this.activateSkills.length&&(this.btn_Skills2.active=!0,this.skillInterval2=g.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime2=this.skillInterval2,o="skillsBtnIcon/"+g.default.getInstance().getSkillsCfg(t).mateIconRes,this.loadSpriteFrame(f.DBS_BundleName.Sprite,o,function(o){e.btn_Skills2.getComponent(cc.Sprite).spriteFrame=o,e.btn_Skills2.setScale(0),cc.tween(e.btn_Skills2).to(.2,{scale:1}).start(),e.btn_Skills2.getChildByName("skillName").getComponent(cc.Label).string=g.default.getInstance().getSkillsCfg(t).mateName}));this.openUI(f.DBS_UIID.DBS_UIToolTips,t)}},e.prototype.updateShowPlayTime=function(){var t=y.default.Instance.playInsistTime,e=Math.floor(t/60),o=(t%60).toString().padStart(2,"0");this.txt_PlayTime.string="<outline color=black width=3>\u575a\u6301\u4e86<color=#7cf84b>"+e+":"+o+"</color></outline>",this.txt_PlayTimeShadow.string="\u575a\u6301\u4e86"+e+":"+o;var i=t/this.needInsistTime;this.timeBar.progress=i,i=Math.floor(100*i),this.txt_TipsBar2.string="<outline color=black width=2><color=#eb64ff>"+i+"%</color>\u602a\u7269</outline>",t>=this.needInsistTime&&(y.default.Instance.setGameState(f.DBS_GameState.pause),this.openUI(f.DBS_UIID.DBS_UIGameOver,!0))},e.prototype.showAddBuffTakeGain=function(t){this.addBuffTakeGainBase.active=t},c([b(cc.Node)],e.prototype,"addBuffTakeGainBase",void 0),c([_],e)}(p.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],DBS_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"d08d2SHV+ZODqHpd5s2KlgB","DBS_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"d08d2SHV+ZODqHpd5s2KlgB","DBS_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DBS_APP"),u=i("DBS_Config"),d=i("DBS_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBack=null,e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnBack=cc.find("root/btnBack",this.node),this.btnResume=cc.find("root/btnResume",this.node),this.btnClose=cc.find("root/btnClose",this.node),this.btnBack.on(cc.Node.EventType.TOUCH_END,function(){d.default.Instance.setGameState(u.DBS_GameState.playing),t.closeUI()},this),this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){d.default.Instance.setGameState(u.DBS_GameState.playing),t.closeUI()},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0),t.closeUI()},this)},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DBS_UISelectBuff:[function(t,e,o){"use strict";cc._RF.push(e,"231d05TCodEN7OP6IE99Hsn","DBS_UISelectBuff");var i=t,n=e,a=o;cc._RF.push(n,"231d05TCodEN7OP6IE99Hsn","DBS_UISelectBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DBS_Config"),u=i("DBS_GameManager"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.itemBuff=null,e.btnClose=null,e.randomBuffs=[],e.isSelected=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.itemBase=cc.find("root/ItemBase",this.node),this.itemBuff=cc.find("root/ltemBuff",this.node),this.btnClose=cc.find("root/btnClose",this.node),this.itemBuff.active=!1,this.btnClose.active=u.default.Instance.currentBuffQuality<4,this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.backUI()},this)},e.prototype.init=function(t){this.randomBuffs=t},e.prototype.start=function(){this.isSelected=!1,this.showBuffSelection()},e.prototype.showBuffSelection=function(){for(var t=this,e=function(e){var i=cc.instantiate(o.itemBuff);i.setParent(o.itemBase),i.active=!0,i.on(cc.Node.EventType.TOUCH_END,function(){t.onBuffSelected(e.ID,e.buffParametric)},o),i.getChildByName("buffName").getComponent(cc.Label).string=e.buffName,i.getChildByName("buffInfo").getComponent(cc.RichText).string=e.buffCopy1;var n="buffIcon/"+e.icon1,a="buffBG/buffLevel"+e.buffQuality;o.loadSpriteFrame(p.DBS_BundleName.Sprite,n,function(t){i.getChildByName("buffIcon").getComponent(cc.Sprite).spriteFrame=t}),o.loadSpriteFrame(p.DBS_BundleName.Sprite,a,function(t){i.getComponent(cc.Sprite).spriteFrame=t})},o=this,i=0,n=this.randomBuffs;i<n.length;i++)e(n[i])},e.prototype.onBuffSelected=function(t,e){if(!this.isSelected){switch(this.isSelected=!0,t){case 9015:case 9024:case 9034:u.default.Instance.takeGainSendFew=e,this.sendEvent(p.DBS_EventName.AddBuffTakeGain,!0);break;case 9009:this.openUI(p.DBS_UIID.DBS_UISelectSolderRole,u.default.Instance.getSolderSpAnimIds());break;default:u.default.Instance.setGameState(p.DBS_GameState.playing),this.sendEvent(p.DBS_EventName.ObtainBuff,t,e)}u.default.Instance.onBuffSelected(t),this.closeUI()}},e.prototype.backUI=function(){this.isSelected||(this.isSelected=!0,u.default.Instance.currentBuffQuality++,u.default.Instance.setGameState(p.DBS_GameState.playing),this.closeUI())},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DBS_UISelectSolderRole:[function(t,e,o){"use strict";cc._RF.push(e,"c46b7CvCdZER6cw2ZMzOdrI","DBS_UISelectSolderRole");var i=t,n=e,a=o;cc._RF.push(n,"c46b7CvCdZER6cw2ZMzOdrI","DBS_UISelectSolderRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DBS_Config"),u=i("DBS_DataMgr"),d=i("DBS_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.ltemRole=null,e.roleSolderInfo=null,e.headBase=null,e.headinfo=null,e.headIcon=null,e.solderID=[],e.pathID=[],e.isSelected=!1,e}return s(e,t),e.prototype.onLoad=function(){this.itemBase=cc.find("root/ItemBase",this.node),this.ltemRole=cc.find("root/ltemRole",this.node),this.roleSolderInfo=cc.find("root/roleSolderInfo",this.node),this.headBase=cc.find("root/headBase",this.node),this.headinfo=cc.find("root/headinfo",this.node),this.headIcon=cc.find("root/headIcon",this.node),this.ltemRole.active=!1,this.roleSolderInfo.active=!1,this.headinfo.active=!1,this.headIcon.active=!1},e.prototype.init=function(t){this.pathID=t,this.solderID[0]=p.DBS_RoleAsePath[this.pathID[0]].ID,this.solderID[1]=p.DBS_RoleAsePath[this.pathID[1]].ID},e.prototype.start=function(){var t=this;this.isSelected=!1;for(var e=function(e){var i=e,n=cc.instantiate(o.ltemRole);n.setParent(o.itemBase),n.active=!0,n.on(cc.Node.EventType.TOUCH_END,function(){t.selected(i)},o),n.getChildByName("roleName").getComponent(cc.Label).string=u.default.getInstance().getSolderRole(o.solderID[i]).characterName;var a=n.getChildByName("infoBase");if(u.default.getInstance().getSolderRole(o.solderID[i]).characterintr1){var r=cc.instantiate(o.roleSolderInfo);r.setParent(a),r.active=!0,r.getChildByName("txt").getComponent(cc.RichText).string=u.default.getInstance().getSolderRole(o.solderID[i]).characterintr1;var s="solderIcon/"+u.default.getInstance().getSolderRole(o.solderID[i]).icon1;o.loadSpriteFrame(p.DBS_BundleName.Sprite,s,function(t){r.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}if(u.default.getInstance().getSolderRole(o.solderID[i]).characterintr2){var c=cc.instantiate(o.roleSolderInfo);c.setParent(a),c.active=!0,c.getChildByName("txt").getComponent(cc.RichText).string=u.default.getInstance().getSolderRole(o.solderID[i]).characterintr2,s="solderIcon/"+u.default.getInstance().getSolderRole(o.solderID[i]).icon2,o.loadSpriteFrame(p.DBS_BundleName.Sprite,s,function(t){c.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}o.loadResFromBundle(p.DBS_BundleName.SpAnim,p.DBS_RoleAsePath[o.pathID[i]].path,sp.SkeletonData,function(t){n.getChildByName("roleSpIcon").getComponent(sp.Skeleton).skeletonData=t,n.getChildByName("roleSpIcon").getComponent(sp.Skeleton).setAnimation(0,p.DBS_AnimName.idle,!0)})},o=this,i=0;i<2;i++)e(i);var n=d.default.Instance.solderGainIDs,a=function(t){var e=t,o=cc.instantiate(r.headinfo);o.setParent(r.headBase),o.setPosition(cc.v3()),o.active=!0;var i="head/"+u.default.getInstance().getSolderRole(n[e]).image;r.loadSpriteFrame(p.DBS_BundleName.Sprite,i,function(t){o.getComponent(cc.Sprite).spriteFrame=t});var a=o.getChildByName("headSolderBase");if(u.default.getInstance().getSolderRole(n[e]).icon1){var s=cc.instantiate(r.headIcon);s.setParent(a),s.setPosition(cc.v3()),s.active=!0;var c="solderIcon/"+u.default.getInstance().getSolderRole(n[e]).icon1;r.loadSpriteFrame(p.DBS_BundleName.Sprite,c,function(t){s.getComponent(cc.Sprite).spriteFrame=t})}if(u.default.getInstance().getSolderRole(n[e]).icon2){var l=cc.instantiate(r.headIcon);l.setParent(a),l.setPosition(cc.v3()),l.active=!0,c="solderIcon/"+u.default.getInstance().getSolderRole(n[e]).icon2,r.loadSpriteFrame(p.DBS_BundleName.Sprite,c,function(t){l.getComponent(cc.Sprite).spriteFrame=t})}},r=this;for(i=0;i<n.length;i++)a(i)},e.prototype.selected=function(t){this.isSelected||(this.isSelected=!0,d.default.Instance.pickupSolderRole(this.solderID[t],this.pathID[t]),d.default.Instance.setGameState(p.DBS_GameState.playing),this.closeUI())},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DBS_UIToolTips:[function(t,e,o){"use strict";cc._RF.push(e,"43972MeChZKEKzc8JqVnrqO","DBS_UIToolTips");var i=t,n=e,a=o;cc._RF.push(n,"43972MeChZKEKzc8JqVnrqO","DBS_UIToolTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DBS_Config"),u=i("DBS_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.skname=null,e.info=null,e.tipsID=0,e}return s(e,t),e.prototype.onLoad=function(){this.icon=cc.find("skill/icon",this.node).getComponent(cc.Sprite),this.skname=cc.find("skill/name",this.node).getComponent(cc.Label),this.info=cc.find("skill/info",this.node).getComponent(cc.Label)},e.prototype.init=function(t){this.tipsID=t},e.prototype.start=function(){var t=this;this.skname.string=u.default.getInstance().getSkillsCfg(this.tipsID).mateName,this.info.string=u.default.getInstance().getSkillsCfg(this.tipsID).introduce;var e="skillsBtnIcon/"+u.default.getInstance().getSkillsCfg(this.tipsID).mateIconRes;this.loadSpriteFrame(p.DBS_BundleName.Sprite,e,function(e){t.icon.spriteFrame=e}),this.node.setPosition(0,400),setTimeout(function(){var e=t.node.position.clone();e.y+=300,cc.tween(t.node).to(.4,{position:e}).call(function(){t.closeUI()}).start()},2400)},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DB_App:[function(t,e,o){"use strict";cc._RF.push(e,"e4bf44iT2VMxrn6gItj2Va5","DB_App");var i=t,n=e,a=o;cc._RF.push(n,"e4bf44iT2VMxrn6gItj2Va5","DB_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("DB_Configs"),p=i("DB_DataMgr"),u=i("DB_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;if(void 0===o&&(o=!1),l.Global.isDirect=o,l.Global.blueDragonState=!1,l.Global.redDragonState=!1,l.Global.coolHeroTimer=1,this.addTouchEvent(),this._exitCall=e,o)s.UIMgr.getInstance().addUICnf(l.DB_UICF),r.AudioMgr.getInstance().addAdConf(l.DB_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){s.UIMgr.getInstance().openUIOfCallback(l.DB_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.DB_AudioId.bgm,l.DBConfig.BgMusic)})})},!0);else{var n=function(){i._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.DB_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.DB_AudioId.bgm,l.DBConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.DB_UICF),r.AudioMgr.getInstance().addAdConf(l.DB_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){n()})}))}},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.DB_UIID.UIGame),s.UIMgr.getInstance().closeById(l.DB_UIID.UIResult),s.UIMgr.getInstance().closeById(l.DB_UIID.UISetting),l.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],DB_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"2f1feuGtXVJXpXVo3626sWE","DB_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"2f1feuGtXVJXpXVo3626sWE","DB_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Utils"),u=i("DB_Configs"),d=function(t,e){this.flag=t,this.num=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useState=!1,e.bloodArr=[],e.limitTime=3,e.showNum=10,e}return s(e,t),e.prototype.isCirt=function(t,e){t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e+""):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e+""),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=p.Utils.randomRang(-30,30),o=p.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){l.PoolMgr.getInstance().freeNode(u.poolName.blood,t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.x=0,this.node.y=0,this.node.opacity=255},e.prototype.inUse=function(){return this.useState},e.prototype.pushBlood=function(t,e){var o=new d(t,e);this.bloodArr.push(o)},e.prototype.showBlood=function(){for(var t=this.bloodArr.splice(0,this.showNum),e=0;e<t.length;e++){var o=t[e];this.isCirt(o.flag,o.num)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){(this.nowTime<0||!this.nowTime)&&(this.nowTime=this.limitTime,this.showBlood()),this.nowTime--},e.prototype.onDestroy=function(){this.bloodArr=[]},c([m(cc.Node)],e.prototype,"isCritState",void 0),c([m(cc.Label)],e.prototype,"critLabel",void 0),c([m(cc.Label)],e.prototype,"commonLabel",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DB_Body:[function(t,e,o){"use strict";cc._RF.push(e,"50db6Lkd7hApJqNeXbhidl4","DB_Body");var i=t,n=e,a=o;cc._RF.push(n,"50db6Lkd7hApJqNeXbhidl4","DB_Body");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("DB_Configs"),d=i("DBGameEnumData"),h=i("DB_DataMgr"),f=i("DB_UIGame"),m=i("DB_ball"),g=i("DB_bodyCtrl"),y=i("DB_boxCtrl"),v=i("DB_ballCtrl"),_=i("DB_fireNode"),b=i("AudioMgr"),B=cc._decorator,I=B.ccclass,P=B.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.playerParent=null,e.box=null,e.hpParent=null,e.pathRed=new Array,e.pathBlue=new Array,e.gapY=100,e.gapX=50,e.ballpState=!1,e.skillState=!1,e.redNowIndex=0,e.bluNowIndex=0,e.redMoveWidth=300,e.blueMoveWidth=300,e.colliderArr=[],e.width=35,e.lastTime=0,e.bodyArr=[],e.animationIndex=1,e.gapTime=0,e.nowTime=0,e.iceState=!1,e.fireState=!1,e.fireNum=0,e.vagueNum=1,e.canResumeWind=!1,e.onceTime=1,e.fireTime=0,e.haveFireNode=0,e.fireNodeArr=[],e.fireNodePos=[],e.redAnimationGapTime=.3,e.blueAnimationGapTime=.3,e.redNum=0,e.redIsLast=!1,e.blueIsLast=!1,e.redBoxTemp=null,e.redNeedDoAnimationTime=0,e.blueNum=0,e.blueBoxTemp=null,e.blueNeedDoAnimationTime=0,e.testDie=!1,e.ballIndex=100001,e.fireIndex=100002,e.dragonNum=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.script=this,this.createRedPath(),this.creatBluePath(),this.ballCtrl=new v.default(this,this.pathRed,this.pathBlue),this.redLastNode=this.headRed,this.blueLastNode=this.headBlue,this.addEvent(u.emDBEventName.pause,this.stop),this.addEvent(u.emDBEventName.skillPause,this.skillPause),this.addEvent(u.emDBEventName.skillResume,this.skillResume),this.addEvent(u.emDBEventName.resume,this.resume),this.redMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed),this.blueMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeedBlue),this.gapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniTime),this.gapTime=.1,this.nowTime=this.gapTime,this.shouldMove=this.width,this.redMoveWidth=this.shouldMove,this.blueMoveWidth=this.shouldMove,this.lastTime=Date.now(),this.initBodyGapTime()},e.prototype.doBallSkill=function(t,e,o){if(e.dragonBallID==m.ballID.iceBall)this.iceState=!0,this.stopAnimation();else if(e.dragonBallID==m.ballID.fireBall)if(t==m.ballState.dragon){var i=h.default.getInstance().getRedLevelCfgByID(this.redNowIndex);o==u.DragonColor.blue&&(i=h.default.getInstance().getBlueLevelCfgByID(this.bluNowIndex)),this.createFireNode(e.dragonGetPara1*i.dragonHp,e.dragonGetPara2)}else this.fireState=!0,this.fireNum=e.playerGetPara1,this.changeFire();else e.dragonBallID==m.ballID.thunderBall||(e.dragonBallID==m.ballID.windBall?(!this.cooldownTime||this.cooldownTime<.5)&&(this.redMoveSpeed=e.dragonGetPara1,this.blueMoveSpeed=e.dragonGetPara1,this.canResumeWind=!0):e.dragonBallID==m.ballID.vagueBall&&(this.vagueNum=e.dragonGetPara1));this.showBuff(e.dragonBallID)},e.prototype.changeFire=function(){for(var t in this.bodyArr)this.bodyArr[t].getComponent(g.default).changeFireState()},e.prototype.showBuff=function(t){if(t==m.ballID.iceBall){this.iceNode.active=!0;var e=this.iceNode.getComponent(sp.Skeleton);e.setAnimation(0,"dj_1",!1),e.setCompleteListener(function(){e.setAnimation(0,"dj_2",!0)})}else if(t==m.ballID.vagueBall){this.shieldNode.active=!0;var o=f.default.script.getWallPosY()+225;this.shieldNode.y=this.headRed.y-200<o?o:this.headRed.y-200,this.shieldNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!0)}},e.prototype.resumeBuff=function(t){var e=this;if(t==m.ballID.iceBall){var o=this.iceNode.getComponent(sp.Skeleton);o.setAnimation(0,"dj_3",!1),o.setCompleteListener(function(){e.iceNode.active=!1})}else t==m.ballID.vagueBall&&(this.shieldNode.active=!1)},e.prototype.resumeBallSkill=function(t){t==m.ballID.iceBall?(this.iceState=!1,this.resumeAnimation()):t==m.ballID.fireBall?(this.fireState=!1,this.changeFire()):t==m.ballID.windBall?this.canResumeWind&&(this.redMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed),this.blueMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeedBlue),this.canResumeWind=!1):t==m.ballID.vagueBall&&(this.vagueNum=1),this.resumeBuff(t)},e.prototype.doFireLose=function(t){if(this.fireTime-=t,this.fireTime<0)for(var e in this.fireTime=this.onceTime,this.colliderArr)this.colliderArr[e].getComponent(y.default).doFireDamage(this.fireNum*this.vagueNum)},e.prototype.createFireNode=function(t,e){this.fireNodeArr=[],this.fireNodePos=[];var o=cc.winSize.height/2+this.fireNode.height/2+50,i=this.fireNode.width-100,n=this.fireNode.height;this.haveFireNode=3;for(var a=-1;a<=1;a++)this.fireNodePos.push(new cc.Vec2(i*a+0,n*Math.abs(a)+o));for(this.fireNodePos[2].y-=100,a=0;a<this.fireNodePos.length;a++){var r=cc.instantiate(this.fireNode);r.parent=this.fireNode.parent,r.setPosition(this.fireNodePos[a]),r.getComponent(_.default).initParam(t,e),this.fireNodeArr.push(r)}},e.prototype.fireNodeDestroy=function(){this.haveFireNode--},e.prototype.skillPause=function(){this.skillState=!0},e.prototype.skillResume=function(){this.skillState=!1},e.prototype.stop=function(){this.ballpState=!0,this.stopAnimation()},e.prototype.stopAnimation=function(){for(var t in this.headRed.getComponent(g.default).stop(),this.bodyArr)this.bodyArr[t].getComponent(g.default)&&this.bodyArr[t].getComponent(g.default).stop()},e.prototype.resumeAnimation=function(){if(!this.iceState)for(var t in this.headRed.getComponent(g.default).resume(),this.bodyArr)this.bodyArr[t].getComponent(g.default)&&this.bodyArr[t].getComponent(g.default).resume()},e.prototype.resume=function(){this.ballpState=!1,this.lastTime=Date.now(),this.resumeAnimation()},e.prototype.getTurn=function(){return new cc.Vec2(200,this.gapY/2)},e.prototype.initBanner=function(t){var e=this;this.ballBanner.active=!0,this.ballBanner.getComponentInChildren(cc.Label).string=t+"\u5df2\u51fa\u73b0\uff0c\u5f00\u59cb\u62a2\u593a\uff01",this.bannerGapTime||(this.bannerGapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.tipsStayTime)),this.scheduleOnce(function(){e.ballBanner.active=!1},this.bannerGapTime)},e.prototype.creatBluePath=function(){for(var t in this.pathRed){var e=this.pathRed[t].x,o=this.pathRed[t].y;this.pathBlue.push(new cc.Vec2(-e,o))}},e.prototype.createRedPath=function(){for(var t=cc.winSize.height/2-100,e=-this.bgNode.width/2+50,o=f.default.script.getWallPosY(),i=this.bgNode.height/2+o,n=-this.bgNode.height/2+i,a=0;t>n;a++){var r=void 0,s=void 0;a%2==0?(r=e,s=-100,this.gapX=Math.abs(this.gapX)):(r=-100,s=e,this.gapX=-Math.abs(this.gapX));for(var c=0;c<3;c++){var l,p=2==c?this.gapY/2:0,u=void 0;if(0==c?u=r:1==c?u=s:2==c&&(u=s+this.gapX),l=new cc.Vec2(u,t-p),Math.abs(l.y-o)<=100){for(;this.pathRed.length<3*a+c+1;)this.pathRed.push(new cc.Vec2(0,o));return void(this.pathRed[this.pathRed.length-1]=new cc.Vec2(0,o))}this.pathRed.push(l)}t-=this.gapY}this.pathRed[this.pathRed.length-1]=new cc.Vec2(0,o)},e.prototype.changeSpeed=function(t,e){var o=Number(e);o<0?this.ballCtrl.test():this.redMoveSpeed=o},e.prototype.start=function(){this.headRed.zIndex=1e3,this.headRed.setPosition(this.pathRed[0].x-200,this.pathRed[0].y),this.headRed.getComponent(g.default).startRun(this.pathRed,this.pathBlue,-1,0,0,u.DragonColor.red),this.bodyArr.push(this.headRed),this.headBlue.zIndex=1e3,this.headBlue.setPosition(this.pathBlue[0].x+200,this.pathBlue[0].y),this.headBlue.getComponent(g.default).startRun(this.pathRed,this.pathBlue,-1,0,0,u.DragonColor.blue),this.bodyArr.push(this.headBlue)},e.prototype.getHeadY=function(t){var e=u.Global.redDragonState?999999:Math.abs(this.headRed.x-t),o=u.Global.blueDragonState?999999:Math.abs(this.headBlue.x-t),i=Math.abs(this.ballNode.x-t),n=Math.abs(this.fireNode.x-t);return e<=o&&e<=i&&e<=n?this.headRed.y:o<=e&&o<=i&&o<=n?this.headBlue.y:i<=e&&i<=o&&i<=n?this.ballNode.y:this.fireNode.y},e.prototype.getHeadNode=function(t){return t==u.DragonColor.red?this.headRed:this.headBlue},e.prototype.initBodyGapTime=function(){this.redAnimationGapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniTime),this.blueAnimationGapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniBlue)},e.prototype.createNode=function(t){this.redIsLast||(this.redMoveWidth-=this.redMoveSpeed*t,this.redMoveWidth<=0&&(this.redMoveWidth+=this.shouldMove,this.createRedBody())),this.blueIsLast||(this.blueMoveWidth-=this.blueMoveSpeed*t,this.blueMoveWidth<=0&&(this.blueMoveWidth+=this.shouldMove,this.createBlueBody()))},e.prototype.createRedBody=function(){this.redNum>=9&&!u.Global.canAttack&&(u.Global.canAttack=!0),this.redNum%8==0&&(this.redFirstAnimationTime=Number((Date.now()/1e3).toFixed(2)),this.redNeedDoAnimationTime=0,this.redBoxTemp&&this.redBoxTemp.getComponent(y.default).setCanBeAttack(),this.redBoxTemp=p.PoolMgr.getInstance().getNode(u.poolName.box),this.redBoxTemp||(this.redBoxTemp=cc.instantiate(this.boxNode)),this.redNowIndex++,this.redBoxTemp.parent=this.hpParent,this.redBoxTemp.active=!0);var t=this.redNowIndex%4;this.checkRedLength()&&(t=4,this.redIsLast=!0);var e=this.redBoxTemp.getComponent(y.default),o=h.default.getInstance().getRedLevelCfgByID(this.redNowIndex),i=p.PoolMgr.getInstance().getNode(u.poolName.body);i||(i=cc.instantiate(this.player)),i.active=!0,i.parent=this.playerParent,this.bodyArr.push(i);var n=i.getComponent(g.default);n.setPreNode(this.redLastNode,this.shouldMove,u.DragonColor.red),this.fireState&&n.changeFireState();var a=this.redLastNode.getComponent(g.default).getIndex();n.startRun(this.pathRed,this.pathBlue,t,0,a,u.DragonColor.red);var r=Number((Date.now()/1e3).toFixed(2));this.redNeedDoAnimationTime+=this.redAnimationGapTime;var s=this.redNeedDoAnimationTime-(r-this.redFirstAnimationTime);n.doAnimation(s,u.DragonColor.red),this.redLastNode=i,e.addOtherNode(i),this.redNum%4==0&&this.redNum%8!=0&&(this.checkRedLength(1)?e.initNode(i,o.dragonHp,this.redNowIndex,!0,u.DragonColor.red):e.initNode(i,o.dragonHp,this.redNowIndex,!1,u.DragonColor.red),this.colliderArr.push(this.redBoxTemp)),i.zIndex=2e3-this.redNum++},e.prototype.createBlueBody=function(){this.blueNum>=9&&!u.Global.canAttack&&(u.Global.canAttack=!0),this.blueNum%8==0&&(this.blueFirstAnimationTime=Number((Date.now()/1e3).toFixed(2)),this.blueNeedDoAnimationTime=0,this.blueBoxTemp&&this.blueBoxTemp.getComponent(y.default).setCanBeAttack(),this.blueBoxTemp=p.PoolMgr.getInstance().getNode(u.poolName.box),this.blueBoxTemp||(this.blueBoxTemp=cc.instantiate(this.boxNode)),this.bluNowIndex++,this.blueBoxTemp.parent=this.hpParent,this.blueBoxTemp.active=!0);var t=this.bluNowIndex%4;this.checkBlueLength()&&(t=4,this.blueIsLast=!0);var e=this.blueBoxTemp.getComponent(y.default),o=h.default.getInstance().getBlueLevelCfgByID(this.bluNowIndex),i=p.PoolMgr.getInstance().getNode(u.poolName.body);i||(i=cc.instantiate(this.player)),i.active=!0,i.parent=this.playerParent,this.bodyArr.push(i);var n=i.getComponent(g.default);n.setPreNode(this.blueLastNode,this.shouldMove,u.DragonColor.blue),this.fireState&&n.changeFireState();var a=this.blueLastNode.getComponent(g.default).getIndex();n.startRun(this.pathRed,this.pathBlue,t,0,a,u.DragonColor.blue);var r=Number((Date.now()/1e3).toFixed(2));this.blueNeedDoAnimationTime+=this.blueAnimationGapTime;var s=this.blueNeedDoAnimationTime-(r-this.blueFirstAnimationTime);n.doAnimation(s,u.DragonColor.blue),this.blueLastNode=i,e.addOtherNode(i),this.blueNum%4==0&&this.blueNum%8!=0&&(this.checkBlueLength(1)?e.initNode(i,o.dragonHp,this.bluNowIndex,!0,u.DragonColor.blue):e.initNode(i,o.dragonHp,this.bluNowIndex,!1,u.DragonColor.blue),this.colliderArr.push(this.blueBoxTemp)),i.zIndex=2e3-this.blueNum++},e.prototype.checkRedLength=function(t){void 0===t&&(t=0);var e=0;return this.testDie&&(e=h.default.getInstance().getLevelCfg().length-4),this.redNowIndex>=h.default.getInstance().getLevelCfg().length-t-e},e.prototype.checkBlueLength=function(t){void 0===t&&(t=0);var e=0;return this.testDie&&(e=h.default.getInstance().getBlueLevelCfg().length-4),this.bluNowIndex>=h.default.getInstance().getBlueLevelCfg().length-t-e},e.prototype.checkCollider=function(t,e,o){var i=null,n=-1;for(var a in e!=this.ballIndex&&-1==n&&this.ballNode.getComponent(m.default).checkCollider(t)&&(i=this.ballNode.getComponent(m.default),n=this.ballIndex),this.fireNodeArr){if(-1!=n)break;var r=this.fireIndex+Number(a),s=this.fireNodeArr[a];e!=r&&s.getComponent(_.default).checkCollider(t)&&(i=s.getComponent(_.default),n=r)}for(var a in this.colliderArr){if(-1!=n)break;if(Number(a)!=e){var c=this.colliderArr[a].getComponent(y.default);c.checkCollider(t)&&(i=c,n=Number(a))}}return-1!=n&&this.handleAttack(o,i),n},e.prototype.handleAttack=function(t,e){var o=t.getDamageProperty(),i=Math.floor(o.damage*this.vagueNum);e.handleDamage(i,o.pos,o.isCrit,o.timer,o.timer>1)},e.prototype.checkSkillCollider=function(t,e){for(var o in e*=this.vagueNum,e=Math.floor(e),this.ballNode.getComponent(m.default).checkSkillCollider(t,e),this.fireNodeArr)this.fireNodeArr[o].getComponent(_.default).checkSkillCollider(t,e);for(var o in this.colliderArr)this.colliderArr[o].getComponent(y.default).checkSkillCollider(t,e)},e.prototype.doCoolBall=function(){var t=this;this.canResumeWind&&(this.canResumeWind=!1),this.dragonNum++;var e=h.default.getInstance().getParam(d.enumBasicParaCfg.lightdragonBalldebuff).split(","),o=Number(e[0]);this.cooldownTime=Number(e[1]),u.Global.coolHeroTimer=Number(e[2]),this.redMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed)*o,this.blueMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeedBlue)*o,this.coolNode.active=!0,this.coolNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!0);var i=h.default.getInstance().getParam(d.enumBasicParaCfg.lightdragonBallGetWord);if(1==this.dragonNum&&(b.AudioMgr.getInstance().playEffect(u.DB_AudioId.lightDragonBall,u.DB_AudioId.lightDragonBall),this.sendEvent(u.emDBEventName.db_ball_tips,this.dragonLabelNode,i)),this.dragonNum>=2){if(this.sendEvent(u.emDBEventName.pause),cc.winSize.height>1334){var n=cc.winSize.height/1334;this.loseNode.scale=n}this.loseNode.active=!0,this.loseNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),b.AudioMgr.getInstance().playEffect(u.DB_AudioId.over,u.DB_AudioId.over),this.loseNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.openUI(u.DB_UIID.UIResult)},.2)})}},e.prototype.resumeCoolBall=function(t){this.cooldownTime-=t,this.cooldownTime<=0&&(this.redMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed),this.blueMoveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeedBlue))},e.prototype.moveBody=function(t){for(var e=0;e<this.bodyArr.length;e++){var o=this.bodyArr[e];o?o.getComponent(g.default).onUpdate(t,this.redMoveSpeed,this.blueMoveSpeed):(this.bodyArr.splice(e,1),e--)}},e.prototype.update=function(t){if(!this.ballpState){if(!this.skillState&&!this.iceState){if(this.haveFireNode)for(var e=0;e<this.fireNodeArr.length;e++)this.fireNodeArr[e].getComponent(_.default).onUpdate(t);this.createNode(t),this.moveBody(t)}this.fireState&&this.doFireLose(t),this.cooldownTime&&this.cooldownTime>0&&this.resumeCoolBall(t);var o=Date.now(),i=(o-this.lastTime)/1e3;this.ballCtrl.onUpdate(i),this.lastTime=o}},c([P(cc.Animation)],e.prototype,"animation",void 0),c([P(cc.Node)],e.prototype,"headRed",void 0),c([P(cc.Node)],e.prototype,"headBlue",void 0),c([P(cc.Node)],e.prototype,"playerParent",void 0),c([P(cc.Node)],e.prototype,"box",void 0),c([P(cc.Node)],e.prototype,"hpParent",void 0),c([P(cc.Node)],e.prototype,"boxNode",void 0),c([P(cc.Node)],e.prototype,"player",void 0),c([P(cc.Node)],e.prototype,"bgNode",void 0),c([P(cc.Node)],e.prototype,"ballNode",void 0),c([P(cc.Node)],e.prototype,"fireNode",void 0),c([P(cc.Node)],e.prototype,"ballBanner",void 0),c([P(cc.Node)],e.prototype,"iceNode",void 0),c([P(cc.Node)],e.prototype,"shieldNode",void 0),c([P(cc.Node)],e.prototype,"coolNode",void 0),c([P(cc.Node)],e.prototype,"dragonLabelNode",void 0),c([P(cc.Node)],e.prototype,"loseNode",void 0),c([P({tooltip:"\u4fe9\u6392\u9f99\u4e4b\u95f4\u7684\u95f4\u9694"})],e.prototype,"gapY",void 0),c([P({tooltip:"\u8f6c\u5f2f\u5904\u79bb\u5c4f\u5e55\u7684\u8ddd\u79bb"})],e.prototype,"gapX",void 0),o=c([I],e)}(l.default);a.default=C,cc._RF.pop(),cc._RF.pop()},{}],DB_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"d91b4SACuROtJdm+BnRWIbG","DB_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"d91b4SACuROtJdm+BnRWIbG","DB_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("Utils"),d=i("DB_Configs"),h=i("DBGameEnumData"),f=i("DB_DataMgr"),m=i("DB_UIGame"),g=i("DB_Hero"),y=i("DB_HeroCtrl"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t,e){this.name=t,this.weight=e},I=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.nodeObj1=new I,e.nodeObj2=new I,e.lock=!0,e}return s(e,t),e.prototype.initNode=function(t,e){var o;if(this.node.active=!1,o=e==d.DragonColor.red?f.default.getInstance().getRedLevelCfgByID(t):f.default.getInstance().getBlueLevelCfgByID(t)){if(o.buffType)if(1==o.buffType){var i=this.getResult(),n=this.getResult(),a=this.getPropertyResultArr(i,n,o);(0==i||1==i||2==i)&&this.initPropertyNode(i,a[0],this.node1,this.nodeObj1),(0==n||1==n||2==n)&&this.initPropertyNode(n,a[1],this.node2,this.nodeObj2)}else if(2==o.buffType){if(0==(i=this.getResult())){var r=this.getPropertyResult(o.buff1,i);this.initPropertyNode(i,r[0],this.node1,this.nodeObj1)}else 1==i?(r=this.getPropertyResult(o.buff2?o.buff2:o.buff1,i),this.initPropertyNode(i,r[0],this.node1,this.nodeObj1)):2==i&&(r=this.getPropertyResult(o.buff3?o.buff3:o.buff1,i),this.initPropertyNode(i,r[0],this.node1,this.nodeObj1));var s=this.getNewRole();this.initNewNode(s[0],this.node2,this.nodeObj2)}else s=this.getNewRole(2),this.initNewNode(s[0],this.node1,this.nodeObj1),this.initNewNode(s[1],this.node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=d.Global.heroID.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getResult=function(){var t=f.default.getInstance().getBuffOddsCfgByAmount(d.Global.heroID.length),e=[],o=t.buff1Odds+t.buff2Odds+t.buff3Odds;e.push(t.buff1Odds),e.push(t.buff2Odds),e.push(t.buff3Odds);for(var i=Math.random()*o,n=0;n<e.length;n++)if((i-=e[n])<=0)return n},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t)),i=d.Global.heroID[e].node;if(3==d.Global.heroID[e].id){for(var n=0;n<o.length;n++)if(o[n].includes("penetrate")){o.splice(n,1);break}}else if(i.getComponent(g.default).getAttackSpeedState())for(n=0;n<o.length;n++)if(o[n].includes("speed")){o.splice(n,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=[],o=d.Global.heroID[0].id,i=d.Global.heroID[1]?d.Global.heroID[1].id:-1;for(var n in d.Global.heroID){var a=d.Global.heroID[n].id,r=f.default.getInstance().getMateOddsCfgByID(a);e=e.concat(this.createRoleLottery(r.mateOdds.split("|"),o,i))}for(var s=[];t--;){var c=Number(u.Utils.weight_rand(e).name);for(n=0;n<e.length;n++)c==Number(e[n].name)&&(e.splice(n,1),n--);s.push(c)}return s},e.prototype.createRoleLottery=function(t,e,o){var i=[];for(var n in t){var a=t[n].split(","),r=Number(a[0]),s=Number(a[1]);if(e!=r&&r!=o){var c=new B(r.toString(),s);i.push(c)}}return i},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=d.Global.heroID[t].id,r=f.default.getInstance().getCharacterByID(a);this.loadSpriteFrame(d.emDBBundles.imgs,"js_b/"+r.image,function(r){n.initPropertyView(o,r,e,a),n.lock=!1,n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=f.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=d.Global.heroID[t].node,c.buffType==d.emDBBuffType.speedPlus?i.type=1:c.buffType==d.emDBBuffType.ATKmul||c.buffType==d.emDBBuffType.ATKplus?i.type=2:c.buffType==d.emDBBuffType.penetratePlus?i.type=3:c.buffType==d.emDBBuffType.bulletPlus?i.type=4:c.buffType==d.emDBBuffType.critPlus?i.type=5:c.buffType==d.emDBBuffType.skillMul&&(i.type=6)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=f.default.getInstance().getCharacterByID(i).characterName,p=f.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon"),s=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emDBBundles.imgs,"js_b/"+s.image,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.lock=!1,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=f.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffectFree(d.DB_AudioId.buff),y.default.script.checkCollider()?this.nodeObj1.isNew?y.default.script.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?y.default.script.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.destroy()},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;1==o?e.getComponent(g.default).addAttackSpeed(t.addType,t.addNum):2==o?e.getComponent(g.default).addAttackPower(t.addType,t.addNum):3==o?e.getComponent(g.default).addAttackPenerate(t.addType,t.addNum):4==o?e.getComponent(g.default).addBulletCount(t.addType,t.addNum):5==o?e.getComponent(g.default).addCritChance(t.addType,t.addNum):6==o&&e.getComponent(g.default).addSkill(t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){this.addEvent(d.emDBEventName.pause,this.dbp),this.addEvent(d.emDBEventName.resume,this.resume)},e.prototype.dbp=function(){this.lock=!0},e.prototype.resume=function(){this.lock=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.lock||(this.node.y-=f.default.getInstance().getParam(h.enumBasicParaCfg.buffMove)*t*100,m.default.script.checkReWardLayer(this.node.y)&&this.doReward())},c([b(cc.Node)],e.prototype,"node1",void 0),c([b(cc.Node)],e.prototype,"node2",void 0),c([b(cc.SpriteFrame)],e.prototype,"sp",void 0),c([_],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],DB_Bullet2V2:[function(t,e,o){"use strict";cc._RF.push(e,"ccd7ddaGahD6YlPAnDLf4F2","DB_Bullet2V2");var i,n=t,a=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var c=n("BaseUI"),l=n("PoolMgr"),p=n("DB_Configs"),u=n("DB_Body"),d=n("DB_Hero"),h=function(t,e,o,i){this.damage=t,this.isCrit=e,this.pos=o,this.timer=i};a.damageObj=h;var f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDedbry=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e.timer=0,e}var o;return r(e,t),o=e,e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,h,f){if(void 0===i&&(i=.2),void 0===n&&(n=2),void 0===h&&(h=1),void 0===f&&(f=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDedbry=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=h,this.initParm(t,e,o,i,n),this.heroCtrl=c.getComponent(d.default),this.timer>1)for(var m in f)r=cc.instantiate(r),this.initNodeView(a,r,s,f[m]);else this.initNodeView(a,r,s)},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=u.default.script.getHeadY(this.node.x)-this.node.y},e.prototype.update=function(t){if(this.active&&!this.isDedbry){var e=this.flySpeed*t*100;this.node.y+=e,this.range-=e,this.range<=0&&this.removeNode();var i=u.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(p.emDBEventName.GAD_Show_Hit_Effect,n),this.lastAttackID=i,this.onDie()}}},e.prototype.getDamageProperty=function(){return this.hit()},e.prototype.hit=function(){return this.damage=this.heroCtrl.getAttackPower(),this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new h(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition(),this.timer)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDedbry||(this.isDedbry=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)l.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start())},e.prototype.render=function(){},e.prototype.stop=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},o=s([m],e)}(c.default));a.default=g,cc._RF.pop()},{}],DB_Bullet2:[function(t,e,o){"use strict";cc._RF.push(e,"79bafDzhPlEhbeJjTj/nS+7","DB_Bullet2");var i=t,n=e,a=o;cc._RF.push(n,"79bafDzhPlEhbeJjTj/nS+7","DB_Bullet2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("DB_Configs"),d=i("DB_Body"),h=i("DB_Hero"),f=function(t,e,o,i){this.damage=t,this.isCrit=e,this.pos=o,this.timer=i};a.damageObj=f;var m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDedbry=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e.timer=0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,f){if(void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===f&&(f=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDedbry=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.heroCtrl=c.getComponent(h.default),this.timer>1)for(var m in f)r=cc.instantiate(r),this.initNodeView(a,r,s,f[m]);else this.initNodeView(a,r,s)},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=d.default.script.getHeadY(this.node.x)-this.node.y},e.prototype.update=function(t){if(this.active&&!this.isDedbry){var e=this.flySpeed*t*100;this.node.y+=e,this.range-=e,this.range<=0&&this.removeNode();var i=d.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(u.emDBEventName.GAD_Show_Hit_Effect,n),this.lastAttackID=i,this.onDie()}}},e.prototype.getDamageProperty=function(){return this.hit()},e.prototype.hit=function(){return this.damage=this.heroCtrl.getAttackPower(),this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new f(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition(),this.timer)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDedbry||(this.isDedbry=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)p.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start())},e.prototype.render=function(){},e.prototype.stop=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},o=c([g],e)}(l.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DB_Bullet3:[function(t,e,o){"use strict";cc._RF.push(e,"c67e8xwvwBJ2pgtSB5r+dzT","DB_Bullet3");var i=t,n=e,a=o;cc._RF.push(n,"c67e8xwvwBJ2pgtSB5r+dzT","DB_Bullet3");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("DB_Configs"),p=i("DB_UIGame"),u=i("DB_Body"),d=i("DB_Bullet2V2"),h=i("Utils"),f=i("DB_DataMgr");a.damageObj=function(t,e,o){this.damage=t,this.isCrit=e,this.pos=o};var m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.angle=0,e.degree=10,e.onlyWall=!1,e.needBounce=!1,e.basePenarate=0,e.disappearTime=0,e.readyBounce=!1,e}var o;return s(e,t),o=e,e.prototype.initNode=function(e,o,i,n,a,r,s,c,p,u,d,h,m,g){void 0===n&&(n=.2),void 0===a&&(a=2),void 0===m&&(m=1),void 0===g&&(g=[]),t.prototype.initNode.call(this,e,o,i,n,a,r,s,c,p,u,d,h,m,g);var y=Number(d.split("bullet")[1]);if(3!=y&&17!=y||(this.needBounce=!0),this.needBounce){this.initAngle(),this.lastDir=l.bulletDir.None;var v=f.default.getInstance().getCharacterByID(y);this.disappearTime=v.disappearTime,this.degree=v.hitTimes?v.hitTimes:10,this.flySpeed=v.bulletSpeed?v.bulletSpeed:o,3==y?this.onlyWall=!0:(this.onlyWall=!1,this.basePenarate=i)}},e.prototype.resume=function(){if(t.prototype.resume.call(this),this.needBounce&&!this.onlyWall)for(var e in this.prefab)this.prefab[e].children[0].getComponent(cc.Animation).resume()},e.prototype.dbp=function(){if(t.prototype.stop.call(this),this.needBounce&&!this.onlyWall)for(var e in this.prefab)this.prefab[e].children[0].getComponent(cc.Animation).pause()},e.prototype.initAngle=function(){var t=h.Utils.randomRang(-45,45);this.angle=t;var e=(t+90)*(Math.PI/180),o=new cc.Vec3(Math.cos(e),Math.sin(e),0);this.velocity=o.multiplyScalar(100*this.flySpeed),this.changeAngle()},e.prototype.changeAngle=function(){for(var t in this.lastAttackID=-1,this.prefab)this.prefab[t].angle=this.angle},e.prototype.onDie=function(){this.needBounce?(this.degree--,this.onlyWall||(this.penetrate--,this.penetrate<0&&this.bounceWithDragon()),this.degree>=0||this.removeNode()):t.prototype.onDie.call(this)},e.prototype.bounceWithDragon=function(){this.penetrate=this.heroCtrl.getPenetrate(),this.lastDir=l.bulletDir.None,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()},e.prototype.overSide=function(t,e){if(this.readyBounce){var o=!1;t.x<e.leftBoundary-100&&(o=!0),t.x>e.rightBoundary+100&&(o=!0),t.y<e.downBoundary-100&&(o=!0),t.y>e.upBoundary+100&&(o=!0),o&&this.removeNode()}},e.prototype.disAppearNode=function(t){this.disappearTime-=t,this.disappearTime<=0&&this.removeNode()},e.prototype.onLoad=function(){},e.prototype.update=function(e){if(this.needBounce){if(this.active&&!this.isDedbry){this.disAppearNode(e);var i=this.velocity.clone().multiplyScalar(e);this.node.setPosition(this.node.position.add(i));var n=p.default.script.getBulletBoundary(),a=this.node.position;a.y>n.downBoundary&&(this.readyBounce=!0),this.readyBounce&&(this.overSide(a,n),a.x<n.leftBoundary&&this.lastDir!=l.bulletDir.left&&(this.lastDir=l.bulletDir.left,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),a.x>n.rightBoundary&&this.lastDir!=l.bulletDir.right&&(this.lastDir=l.bulletDir.right,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),a.y<n.downBoundary&&this.lastDir!=l.bulletDir.down&&(this.lastDir=l.bulletDir.down,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()),a.y>n.upBoundary&&this.lastDir!=l.bulletDir.up&&(this.lastDir=l.bulletDir.up,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()));var r=u.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(r>=0){var s=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(l.emDBEventName.GAD_Show_Hit_Effect,s),this.lastAttackID=r,this.onDie()}}}else t.prototype.update.call(this,e)},o=c([g],e)}(d.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DB_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"096d8u3yMlMVaU0zpXdlsct","DB_BulletEffect");var i=e,n=o;cc._RF.push(i,"096d8u3yMlMVaU0zpXdlsct","DB_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.show()},e.prototype.hide=function(){this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.node.active=!1,t.resetSystem()})},e.prototype.show=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],DB_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"8b2e3K9w8dIlKNfsBRPvR5m","DB_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"8b2e3K9w8dIlKNfsBRPvR5m","DB_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.DragonColor=l.Global=l.bulletDir=l.emDBHitState=l.poolName=l.emDBBuffType=l.emDBGameState=l.emDBRoleState=l.emDBRoleType=l.emDBEventName=l.DB_AudioCF=l.DB_AudioId=l.DB_UICF=l.DBConfig=l.emDBBundles=l.DB_UIID=void 0,function(t){t.UIGame="DB_UIGame",t.UIResult="DB_UIResult",t.UISetting="DB_UISetting"}(a=l.DB_UIID||(l.DB_UIID={})),function(t){t.prefabs="db_prefabs",t.audios="db_audios",t.imgs="db_imgs",t.configs="db_configs",t.configsB="db_configsB"}(r=l.emDBBundles||(l.emDBBundles={})),l.DBConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.DB_UICF=((i={})[a.UIGame]={prefab:"ui/DB_UIGame",name:"DB_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/DB_UIResult",name:"DB_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/DB_UISetting",name:"DB_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.doubleSword="doubleSword",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.ballgonHit="dragonHit",t.rake="rake",t.typhoon="typhoon",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.barrier="barrier",t.dragonBallGet="dragonBallGet",t.dragonBallShow="dragonBallShow",t.electric="electric",t.fireball="fireball",t.ice="ice",t.icebreak="icebreak",t.lightningBullet="lightningBullet",t.magic="magic",t.wind="wind",t.moon="moon",t.boomerang="boomerang",t.boom="boom",t.moonGod="moonGod",t.lightDragonBall="lightDragonBall",t.over="over"}(s=l.DB_AudioId||(l.DB_AudioId={})),l.DB_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.ballgonHit]={path:"dragonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.dragonBallGet]={path:"dragonBallGet",bundle:r.audios},n[s.barrier]={path:"barrier",bundle:r.audios},n[s.dragonBallShow]={path:"dragonBallShow",bundle:r.audios},n[s.electric]={path:"electric",bundle:r.audios},n[s.fireball]={path:"fireball",bundle:r.audios},n[s.ice]={path:"ice",bundle:r.audios},n[s.icebreak]={path:"icebreak",bundle:r.audios},n[s.lightningBullet]={path:"lightningBullet",bundle:r.audios},n[s.magic]={path:"magic",bundle:r.audios},n[s.wind]={path:"wind",bundle:r.audios},n[s.moon]={path:"moon",bundle:r.audios},n[s.boomerang]={path:"boomerang",bundle:r.audios},n[s.boom]={path:"boom",bundle:r.audios},n[s.moonGod]={path:"moonGod",bundle:r.audios},n[s.lightDragonBall]={path:"lightDragonBall",bundle:r.audios},n[s.over]={path:"over",bundle:r.audios},n),function(t){t.GAD_Player_Die="db_gad_player_die",t.GAD_Shoot_Bullet="db_gad_shoot_bullet",t.GAD_Show_Hit_Text="db_gad_show_hit_text",t.GAD_Show_Warn="db_gad_show_warn",t.GAD_Bubble_Buf="db_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="db_gad_hit_effect",t.GAD_Show_Buff_Tip="db_gad_show_buff_tip",t.GAD_Setting_Back="db_gad_setting_back",t.pause="db_pause",t.resume="db_resume",t.skillPause="db_skillPause",t.skillResume="db_skillResume",t.buff="db_buff",t.blood="db_blood",t.newTarm="db_newTarm",t.db_loot="db_loot",t.db_ball_tips=" db_ball_tips"}(l.emDBEventName||(l.emDBEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emDBRoleType||(l.emDBRoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emDBRoleState||(l.emDBRoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emDBGameState||(l.emDBGameState={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emDBBuffType||(l.emDBBuffType={})),function(t){t.blood="db_blood",t.destroy="db_destroy",t.effect="db_effect",t.box="db_box",t.body="db_body",t.db_item="db_item",t.db_bullet="db_bullet",t.newdb_bullet="newdb_bullet",t.DB_Bullet_skill="DB_Bullet_skill"}(l.poolName||(l.poolName={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emDBHitState||(l.emDBHitState={})),function(t){t.None="None",t.up="up",t.down="down",t.left="left",t.right="right"}(l.bulletDir||(l.bulletDir={}));var p=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t.isBug=!1,t.redDragonState=!1,t.blueDragonState=!1,t.coolHeroTimer=1,t}();l.Global=p,function(t){t.red="red",t.blue="blue"}(l.DragonColor||(l.DragonColor={})),cc._RF.pop(),cc._RF.pop()},{}],DB_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"12be6YnlAZMOpyjS3qryUBA","DB_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"12be6YnlAZMOpyjS3qryUBA","DB_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("DB_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}e?i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_double/configsB",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emDBBundles.configsB,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()}):i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_double/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emDBBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getBlueLevelCfg=function(){return this.data.levelBlueCfg},t.prototype.getRedLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getBlueLevelCfgByID=function(t){var e=this.data.levelBlueCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getDragonBallShowCfg=function(){return this.data.dragonBallShowCfg},t.prototype.getDragonBallCfg=function(){return this.data.dragonBallCfg},t.prototype.getDragonBallCfgBYid=function(t){var e=this.data.dragonBallCfg;for(var o in e)if(e[o].dragonBallID==t)return e[o]},t.prototype.getMateOddsCfgByID=function(t){var e=this.data.mateOddsCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getBuffOddsCfgByAmount=function(t){var e=this.data.buffOddsCfg;for(var o in e)if(e[o].charAmount==t)return e[o]},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DB_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"a5ef6QtPFdG4Ivd+f0jkuat","DB_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"a5ef6QtPFdG4Ivd+f0jkuat","DB_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("DB_Configs"),d=i("DB_Hero"),h=i("DB_SkillCtrl"),f=i("DB_TarmCtrl"),m=i("DB_ball"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t,e){this.id=t,this.node=e},b=function(t,e){this.cfg=t,this.state=e},B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPuase=!1,e.isBallLock=!1,e.ballArr=[],e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;o.script=this,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.node.x+=o})},e.prototype.heroMove=function(t){this.node.x+=t},e.prototype.test=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(d.default).addAttackPower(2,5);else if("speed"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(d.default).addAttackSpeed(1,4);else if("penerate"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(d.default).addAttackPenerate(1,1);else if("fire"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(d.default).changeFire()}else this.addHero(Number(e))},e.prototype.doBallSkill=function(t,e){e.dragonBallID==m.ballID.iceBall?this.heroDoSkill(e):e.dragonBallID==m.ballID.thunderBall?(t==m.ballState.dragon&&(this.isBallLock=!0),this.heroDoSkill(e,t)):e.dragonBallID==m.ballID.windBall?this.heroDoSkill(e):e.dragonBallID==m.ballID.vagueBall&&(this.heroDoSkill(e),h.default.script.changeDelayTime(e.playerGetPara1));var o=new b(e,t);this.ballArr.push(o)},e.prototype.heroDoSkill=function(t,e){for(var o in void 0===e&&(e=m.ballState.None),u.Global.heroID)u.Global.heroID[o].node.getComponent(d.default).doBallSkill(t,e)},e.prototype.heroResumeSkill=function(t){t==m.ballID.thunderBall?(this.isBallLock=!1,p.AudioMgr.getInstance().playEffect(u.DB_AudioId.electric,"skillBuff")):t==m.ballID.vagueBall&&h.default.script.resumeDelayTime();for(var e=0;e<this.ballArr.length;e++)this.ballArr[e].cfg.dragonBallID==t&&(this.ballArr.splice(e,1),e--);for(var e in u.Global.heroID)u.Global.heroID[e].node.getComponent(d.default).resumeBallSkill(t)},e.prototype.getBallLock=function(){return this.isBallLock},e.prototype.getBallSkill=function(t){for(var e in this.ballArr)t.getComponent(d.default).doBallSkill(this.ballArr[e].cfg,this.ballArr[e].state)},e.prototype.addHero=function(t){var e=this;if(u.Global.heroID.length>=3)console.error("\u4e0d\u5141\u8bb8\u52a0\u5165\u8d85\u8fc7\u4e09\u4e2a\u82f1\u96c4");else{u.Global.heroID||(u.Global.heroID=[]),this.node.getComponent(f.default).pushCard(t);var o=cc.instantiate(this.heorNode);o.active=!0,o.parent=this.node;var i=new _(t,o);u.Global.heroID.push(i),o.getComponent(d.default).initHero(t),this.getBallSkill(o),this.scheduleOnce(function(){e.checkOverSide()},.01)}},e.prototype.clearHero=function(){u.Global.heroID=[]},e.prototype.getMaxDamage=function(t,e){var o=0;for(var i in u.Global.heroID)u.Global.heroID[i].id!=t&&u.Global.heroID[i].id!=e||(o=Math.max(u.Global.heroID[i].node.getComponent(d.default).getAttackPower(),o));return o},e.prototype.checkOverSide=function(){this.node.x+this.node.width/2>cc.winSize.width/2?this.node.x=cc.winSize.width/2-this.node.width/2:this.node.x-this.node.width/2<-cc.winSize.width/2&&(this.node.x=-cc.winSize.width/2+this.node.width/2)},e.prototype.checkCollider=function(){return this.node.x<0},e.prototype.start=function(){},c([v(cc.Node)],e.prototype,"heorNode",void 0),o=c([y],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],DB_Hero:[function(t,e,o){"use strict";cc._RF.push(e,"23ad9us/hlDKoxE640sGUfo","DB_Hero");var i=t,n=e,a=o;cc._RF.push(n,"23ad9us/hlDKoxE640sGUfo","DB_Hero");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("DB_Configs"),h=i("DBGameEnumData"),f=i("DB_DataMgr"),m=i("DB_UIGame"),g=i("DB_Bullet2"),y=i("DB_Bullet3"),v=i("DB_BulletEffect"),_=i("DB_SkillCtrl"),b=i("DB_ball"),B=i("DB_Body"),I=cc._decorator,P=I.ccclass,C=I.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.rawBulletCount=1,e.firing=!1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.bullets=[],e.skillTimer=0,e.bulletPrefabSkillName="DB_Bullet_skill",e.skillMultiplier=0,e.maxSpeed=12,e.ballSubSpeed=1,e.ballAddSpeed=1,e.ballSubSkillCD=-1,e.thunderLock=!1,e.thunderState=!1,e.noInFactSpeed=5,e.speedInfactTimer=1,e.maxBulletNum=99999,e.rawMaxBulletNum=99999,e.isNewHero=!1,e.lastFireTime=0,e.fireCooldown=.5,e.audioID=0,e}return s(e,t),e.prototype.initHero=function(t){this.initParm(t),this.initView(t),this.heroIndex=t,this.addEvent(d.emDBEventName.pause,this.doPause),this.addEvent(d.emDBEventName.resume,this.doResume)},e.prototype.initParm=function(t){1==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.basicATK):2==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.secondCharATK):3==d.Global.heroID.length&&(this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.thirdCharATK)),3==t?(this.maxBulletNum=f.default.getInstance().getParam(h.enumBasicParaCfg.changeLimit),this.isNewHero=!0):17==t?(this.maxBulletNum=f.default.getInstance().getParam(h.enumBasicParaCfg.sunsxLimit),this.isNewHero=!0):(this.maxBulletNum=99999,this.isNewHero=!1),this.rawMaxBulletNum=this.maxBulletNum,this.attackSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.basicASPD),this.bulletCount=f.default.getInstance().getParam(h.enumBasicParaCfg.basicBullet),this.penetrate=f.default.getInstance().getParam(h.enumBasicParaCfg.basicPenetrate),this.flySpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.bulletFlySpeed),this.critChance=f.default.getInstance().getParam(h.enumBasicParaCfg.basicCrit),this.critMultiplier=f.default.getInstance().getParam(h.enumBasicParaCfg.critDamage);var e=f.default.getInstance().getCharacterByID(t);this.skillInterval=e.skillCDtime,this.ballSubSkillCD=-1,this.skillMultiplier=e.skillATK,this.skillEffect=e.skillSound,this.speedInfactTimer=e.characterASPD,this.rawBulletCount=this.bulletCount},e.prototype.initView=function(t){var e=this;this.loadPrefab(d.emDBBundles.prefabs,"bullets/DB_Bullet_"+t,function(o){e.poolName="bullet"+t,u.PoolMgr.getInstance().creatrePool(e.poolName,cc.instantiate(o)),e.bulletPrefab=o,e.startFiring()}),this.bulletNodeSkill=u.PoolMgr.getInstance().getNode(d.poolName.DB_Bullet_skill);var o=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emDBBundles.imgs,"backs/"+o.cardColor,function(t){e.itemBg.spriteFrame=t}),this.loadSpriteFrame(d.emDBBundles.imgs,"js/js_"+t,function(t){e.itemIcon.spriteFrame=t}),this.loadSpriteFrame(d.emDBBundles.imgs,"skill/"+o.skillIcon,function(t){e.itemSkill.spriteFrame=t}),this.loadPrefab(d.emDBBundles.prefabs,"skills/"+o.skill,function(o){e.heroSkill=cc.instantiate(o),11==t&&e.loadPrefab(d.emDBBundles.prefabs,"skills/CardSkill"+t,function(){})}),this.itemName.string=o.characterName},e.prototype.startFiring=function(){this.firing=!0},e.prototype.ballpFiring=function(){this.firing=!1},e.prototype.changeFire=function(){this.firing=!this.firing},e.prototype.doBallSkill=function(t,e){void 0===e&&(e=b.ballState.None),t.dragonBallID!=b.ballID.thunderBall&&this.showBuff(t.dragonBallID),t.dragonBallID==b.ballID.iceBall?this.ballSubSpeed=t.dragonGetPara1:t.dragonBallID==b.ballID.thunderBall?e==b.ballState.dragon?(this.thunderLock=!0,this.showBuff(t.dragonBallID)):e==b.ballState.player&&(this.thunderState=!0):t.dragonBallID==b.ballID.windBall?(this.ballAddSpeed=t.playerGetPara1,this.maxBulletNum=2*this.rawMaxBulletNum):t.dragonBallID==b.ballID.vagueBall&&(this.ballSubSkillCD=t.playerGetPara1,this.isChangeCD())},e.prototype.resumeBallSkill=function(t){if(t==b.ballID.iceBall)this.ballSubSpeed=1;else if(t==b.ballID.thunderBall)this.thunderLock=!1,this.thunderState=!1;else if(t==b.ballID.windBall)this.ballAddSpeed=1,this.maxBulletNum=this.rawMaxBulletNum;else if(t==b.ballID.vagueBall){if(-1==this.ballSubSkillCD)return;this.ballSubSkillCD=-1,this.isChangeCD()}this.doResumeBuff(t)},e.prototype.isChangeCD=function(){var t=this.skillPercent.fillRange;this.skillTimer=this.infactCD*t},e.prototype.useSkill=function(){var t=m.default.script.getSkillLayer(),e=this.bulletPos.getPosition(),o=this.bulletPos.convertToWorldSpaceAR(e);return e=t.convertToNodeSpaceAR(o),_.default.script.useSkill(this.heroIndex,Math.floor(this.getAttackPower()*this.skillMultiplier),this.heroSkill,e)},e.prototype.addAttackPower=function(t,e){this.addBuffTween(),1==t?this.attackPower+=e:this.attackPower*=e},e.prototype.getAttackPower=function(){return Math.floor(this.attackPower/d.Global.coolHeroTimer)},e.prototype.changeSkillInterval=function(t,e){this.addBuffTween();var o=this.skillInterval*(1-t);(o=Number(o.toFixed(2)))<e&&(o=e),this.skillInterval=o,this.cdTime.getComponent(cc.Label).string=this.skillInterval+""},e.prototype.addAttackSpeed=function(t,e){this.addBuffTween(),this.getAttackSpeedState()||(this.attackSpeedMultiplier+=e/f.default.getInstance().getParam(h.enumBasicParaCfg.speedPlusTimes))},e.prototype.getAttackSpeedState=function(){return this.attackSpeedMultiplier>=this.maxSpeed},e.prototype.addAttackPenerate=function(t,e,o,i){this.addBuffTween(),1==t?this.penetrate+=e:2==t?this.penetrate*=e:3==t&&(this.penetrate+e>o?this.addAttackSpeed(1,i):this.penetrate+=e)},e.prototype.getPenetrate=function(){return this.penetrate},e.prototype.addCritChance=function(t,e){this.addBuffTween(),1==t?this.critChance+=e:2==t?this.critChance*=e:3==t&&(this.critChance>=1?this.addBulletCount(1,1):this.critChance+=e)},e.prototype.showBuff=function(t){var e;t==b.ballID.windBall?e=this.windSp:t==b.ballID.thunderBall?e=this.thunderSp:t==b.ballID.vagueBall?e=this.vagueSp:t==b.ballID.iceBall&&(e=this.iceSp),e&&this.doShowBuff(e)},e.prototype.doShowBuff=function(t){var e=t.getComponent(sp.Skeleton);t.active=!0,e&&e.setAnimation(0,"animation",!0)},e.prototype.doResumeBuff=function(t){var e;t==b.ballID.windBall?e=this.windSp:t==b.ballID.thunderBall?e=this.thunderSp:t==b.ballID.vagueBall?e=this.vagueSp:t==b.ballID.iceBall&&(e=this.iceSp),e&&(e.active=!1)},e.prototype.addSkill=function(t,e){this.addBuffTween(),1==t?this.skillMultiplier+=e:2==t?this.skillMultiplier*=e:3==t&&(this.critChance>=1?this.addBulletCount(1,1):this.critChance+=e)},e.prototype.addBulletCount=function(t,e){this.addBuffTween(),1==t?this.bulletCount+=e:this.bulletCount*=e,this.rawBulletCount=this.bulletCount},e.prototype.addBuffTween=function(){var t=this;this.addBuffSp.opacity=255,this.addBuffSp.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.addBuffSp.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.addBuffSp.opacity=0},.1)})},e.prototype.getAttackSpeed=function(){var t=this.attackSpeedMultiplier*this.ballAddSpeed/this.ballSubSpeed;return(t*=this.speedInfactTimer)<this.speedInfactTimer&&(t=this.speedInfactTimer),this.attackSpeed/t},e.prototype.updateSkillView=function(){this.skillPercent.fillRange=this.skillTimer/this.infactCD},Object.defineProperty(e.prototype,"infactCD",{get:function(){return-1==this.ballSubSkillCD?this.skillInterval:this.ballSubSkillCD},enumerable:!1,configurable:!0}),e.prototype.update=function(t){var e=this;this.firing&&d.Global.canAttack&&!this.thunderLock&&(this.nowAttackTime+=t,this.skillTimer+=t,this.updateSkillView(),this.skillTimer>=this.infactCD&&this.useSkill()&&(this.skillSp.opacity=255,p.AudioMgr.getInstance().playEffect(this.skillEffect,this.skillEffect),this.skillSp.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.skillSp.getComponent(sp.Skeleton).setCompleteListener(function(){e.scheduleOnce(function(){e.skillSp.opacity=0},.1)}),this.skillTimer=0),this.nowAttackTime-this.lastAttackTime>this.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime))},e.prototype.checkIsInfact=function(){return this.attackSpeedMultiplier<this.noInFactSpeed||1==this.bulletCount||3==this.heroIndex||17==this.heroIndex},e.prototype.fireBullets=function(){this.audioID=(this.audioID+1)%5;var t=m.default.script.getBulletLayer(this.heroIndex),e=this.bulletPos.getPosition();if(this.thunderState){var o=u.PoolMgr.getInstance().getNode(this.bulletPrefabSkillName)||cc.instantiate(this.bulletNodeSkill);this.doThunderBullet(o,t,e)}else{p.AudioMgr.getInstance().playEffect(d.DB_AudioId.bullet,"bullet"+this.heroIndex+this.audioID);for(var i=t.children.length+this.bulletCount-this.maxBulletNum,n=0;i>0;)t.children[n++].getComponent(y.default).removeNode(),i--;this.creatInfactBullet(t,e)}},e.prototype.doThunderBullet=function(t,e,o){var i=this;p.AudioMgr.getInstance().playEffect(d.DB_AudioId.lightningBullet,"bullet"+this.heroIndex+this.audioID);var n=this.bulletPos.convertToWorldSpaceAR(o);t.parent=m.default.script.getBulletSkill(),o=e.convertToNodeSpaceAR(n),t.setPosition(o),t.active=!0,B.default.script.checkSkillCollider(this.getWorldColldierRect(t,0,0),Math.floor(this.getAttackPower()*this.bulletCount)),t.getChildByName("bullet").getComponent(cc.Animation).play(),this.scheduleOnce(function(){t.active=!1,u.PoolMgr.getInstance().freeNode(i.bulletPrefabSkillName,t)},.07)},e.prototype.getWorldColldierRect=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var i=t.getAnchorPoint(),n=t.parent.convertToWorldSpaceAR(t.position),a=(t.width+e)*t.scaleX,r=(t.height+o)*t.scaleY;return cc.rect(n.x-i.x*a,n.y-i.y*r,a,r)},e.prototype.creatInfactBullet=function(t,e){this.isNewHero&&1!=this.ballAddSpeed?this.bulletCount=this.bulletCount>3?3:this.bulletCount:this.bulletCount=this.rawBulletCount;for(var o=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,i=0;i<this.bulletCount;i++){var n=new cc.Vec2(e.x-o,e.y);o+=30;var a=this.bulletPos.convertToWorldSpaceAR(n);n=t.convertToNodeSpaceAR(a);var r=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab);(u.PoolMgr.getInstance().getNode(d.poolName.newdb_bullet)||cc.instantiate(this.bullet)).getComponent(y.default).initNode(this.getAttackPower(),this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,n,r,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier)}},e.prototype.creatNoInfactBullet=function(t,e){for(var o=[],i=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,n=0;n<this.bulletCount;n++){var a=new cc.Vec2(0-i,0);i+=30,o.push(a)}var r=u.PoolMgr.getInstance().getNode(d.poolName.newdb_bullet)||cc.instantiate(this.bullet),s=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab),c=this.bulletPos.convertToWorldSpaceAR(e),l=t.convertToNodeSpaceAR(c);r.getComponent(y.default).initNode(this.getAttackPower(),this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,l,s,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier,this.bulletCount,o)},e.prototype.pushBullet=function(t){t.getComponent(v.default).hide(),this.bullets.push(t)},e.prototype.doPause=function(){this.ballpFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).stop()},e.prototype.doResume=function(){this.startFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).resume()},c([C(cc.Prefab)],e.prototype,"bullet",void 0),c([C(cc.Node)],e.prototype,"bulletPos",void 0),c([C(cc.Node)],e.prototype,"skillSp",void 0),c([C(cc.Node)],e.prototype,"addBuffSp",void 0),c([C(cc.Label)],e.prototype,"itemName",void 0),c([C(cc.Sprite)],e.prototype,"itemBg",void 0),c([C(cc.Sprite)],e.prototype,"itemIcon",void 0),c([C(cc.Sprite)],e.prototype,"itemSkill",void 0),c([C(cc.Sprite)],e.prototype,"skillPercent",void 0),c([C(cc.Node)],e.prototype,"windSp",void 0),c([C(cc.Node)],e.prototype,"thunderSp",void 0),c([C(cc.Node)],e.prototype,"vagueSp",void 0),c([C(cc.Node)],e.prototype,"iceSp",void 0),c([C(cc.Node)],e.prototype,"cdTime",void 0),c([P],e)}(l.default);a.default=D,cc._RF.pop(),cc._RF.pop()},{}],DB_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"67abflwnJxNFrc7U9naaEHX","DB_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"67abflwnJxNFrc7U9naaEHX","DB_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("DB_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],DB_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e1679/oPNNCwbeZDL/XgmVa","DB_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e1679/oPNNCwbeZDL/XgmVa","DB_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DB_Configs"),u=i("DB_Skill"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e.rawDelayTime=1.5,e.delayTime=1.5,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){return!this.isSkill&&(this.isSkill=!0,this.showBanner(t),o.parent=this.node,o.getComponent(u.default).useSkill(i,e,t),!0)},e.prototype.changeDelayTime=function(t){t/2<this.delayTime&&(this.delayTime=t/2-.15)},e.prototype.resumeDelayTime=function(){this.delayTime=this.rawDelayTime},e.prototype.showBanner=function(t){var e=this;this.loadSpriteFrame(p.emDBBundles.imgs,"banner/banner"+t,function(t){e.banner.getComponent(cc.Sprite).spriteFrame=t,e.banner.active=!0});var o=Number((this.delayTime/3).toFixed(1));cc.tween(this.banner).by(o,{x:this.banner.width}).delay(o).by(o,{x:-this.banner.width}).call(function(){e.isSkill=!1,e.banner.active=!1}).start()},e.prototype.onLoad=function(){o.script=this,this.banner.x=-cc.winSize.width/2-this.banner.width/2},e.prototype.start=function(){},e.prototype.update=function(){},c([f(cc.Label)],e.prototype,"label",void 0),c([f(cc.Node)],e.prototype,"banner",void 0),c([f],e.prototype,"text",void 0),o=c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DB_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"df333JPIXhL95PA9altk44E","DB_Skill");var i=t,n=e,a=o;cc._RF.push(n,"df333JPIXhL95PA9altk44E","DB_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DB_Body"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){"attack"==o.data.name&&(t.animationDuration=e.animation.duration)})},e.prototype.useSkill=function(t,e,o){this.index=o,this.skillSpeed=this.speed,this.damage=e,this["useSkill"+o](t),this.flyDis=l.default.script.getHeadY(t.x)-this.node.y},e.prototype.useSkill1=function(t){var e=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY(t.x)-300),this.spAni.setAnimation(0,"hit",!1);var o=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.65),this.offHeight=300},e.prototype.useSkill3=function(t){var e=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY(t.x)-100),this.spAni.setAnimation(0,"cedz",!1);var o=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.65)},e.prototype.useSkill4=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill6=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,l.default.script.getHeadY(t.x)),this.spAni.setAnimation(0,"hit",!1);var o=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill7=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill8=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill11=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!1),this.sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)},e.prototype.useSkill17=function(t){var e=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY(t.x)-100),this.spAni.setAnimation(0,"ssxdz",!1);var o=this.spAni.getCurrent(0).animation.duration;this.offHeight=100,this.scheduleOnce(function(){e.doAttack()},o-2)},e.prototype.update=function(){var t=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed,this.flyDis-=this.skillSpeed,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){t.sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),t.sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.spAni.setAnimation(0,"hit",!1),this.doAttack()))},e.prototype.doAttack=function(){l.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([d({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([d({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([d({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DB_Target:[function(t,e,o){"use strict";cc._RF.push(e,"1861cCd3tRPJY8gGnJZUidM","DB_Target");var i=e,n=o;cc._RF.push(i,"1861cCd3tRPJY8gGnJZUidM","DB_Target"),Object.defineProperty(n,"__esModule",{value:!0}),n.Target=void 0;var a=function(){function t(t){this.health=t}return t.prototype.takeDamage=function(t){this.health-=t,console.log("Target takes "+t+" damage! Remaining health: "+this.health),this.health<=0&&this.destroy()},t.prototype.destroy=function(){console.log("Target destroyed!")},t}();n.Target=a,cc._RF.pop(),cc._RF.pop()},{}],DB_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e0209cjjQhJdIuJBGXkHec6","DB_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e0209cjjQhJdIuJBGXkHec6","DB_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DB_Configs"),u=i("DB_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tarmMap=new Map,e.isTureTarmMap=new Map,e.delayTime=1,e.arr=[],e.isBanner=!1,e.isInit=!1,e}return s(e,t),e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.sendEvent(p.emDBEventName.newTarm,e[0],this.delayTime),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},e.prototype.onLoad=function(){},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DB_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"965342RrJRL5o9GIDEkqlpt","DB_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"965342RrJRL5o9GIDEkqlpt","DB_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("DB_Configs"),f=i("DB_BloodCtrl"),m=i("DB_BuffCtrl"),g=i("DB_mateCtrl"),y=i("DBGameEnumData"),v=i("DB_DataMgr"),_=function(t,e){this.index=t,this.dragonColor=e},b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.buffLayer=null,e.bloodLayer=null,e.hitLayer=null,e.blood=null,e.pauseLayer=null,e.closeNode=null,e.skillLayer=null,e.banner=null,e.bannerSp=[],e.isPause=!1,e.maxLength=50,e.hpIndex=0,e.hpArr=[],e.tipPools=[],e.gaptime=.5,e.nowTime=0,e.buffIndex=[],e.buffState=!1,e.maxShowCount=50,e.lastShowTime=0,e.throttleTime=.2,e}return s(e,t),e.prototype.onLoad=function(){p.PoolMgr.getInstance().creatrePool(h.poolName.effect,this.hitEffect,5),p.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2),this.createHpArr(this.maxLength),this.initSystemListen()},e.prototype.createHpArr=function(t){for(;t--;){var e=p.PoolMgr.getInstance().getNode(h.poolName.blood)||cc.instantiate(this.blood);this.hpArr.push(e)}},e.prototype.initSystemListen=function(){var t=this;h.Global.isDirect||cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){t.pauseLayer&&e.keyCode==cc.macro.KEY.space&&(t.pauseLayer.active?(t.pauseLayer.active=!1,t.sendEvent(h.emDBEventName.resume),t.isPause=!1):(t.pauseLayer.active=!0,t.sendEvent(h.emDBEventName.pause),t.isPause=!0))})},e.prototype.start=function(){var t=this;this.addEvent(h.emDBEventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(h.emDBEventName.GAD_Show_Warn,this.playWarn),this.addEvent(h.emDBEventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(h.emDBEventName.buff,this.showBuff),this.addEvent(h.emDBEventName.blood,this.showLoseLabel),this.addEvent(h.emDBEventName.newTarm,this.showNewTarm),this.addEvent(h.emDBEventName.db_ball_tips,this.showballBanner),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(h.emDBEventName.pause),t.isPause=!0,h.Global.isDirect?u.UIMgr.getInstance().openUI(h.DB_UIID.UISetting,d.UIID.UINONE,function(e){e&&t.sendEvent(h.emDBEventName.resume)}):t.pauseLayer.active=!0}),this.pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active&&(t.sendEvent(h.emDBEventName.resume),t.isPause=!1,t.pauseLayer.active=!1)}),this.closeNode.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active=!1,u.UIMgr.getInstance().openUI(h.DB_UIID.UISetting,d.UIID.UINONE,function(e){e&&(t.sendEvent(h.emDBEventName.resume),t.isPause=!1)})})},e.prototype.onShowHitText=function(){},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.ndWarn),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.ndWarn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.ndWarn),t.ndWarn.active=!1}).start()},e.prototype.showHitEffect=function(t){var e=this.node.convertToNodeSpaceAR(t),o=p.PoolMgr.getInstance().getNode(h.poolName.effect)||cc.instantiate(this.hitEffect);o.parent=this.hitLayer,o.setPosition(e),o.active=!0,o.opacity=255,this.scheduleOnce(function(){o.active=!1,p.PoolMgr.getInstance().freeNode("pbt_hit_effect",o)},.2)},e.prototype.update=function(t){var e=this;if(this.buffState&&!this.isPause&&(this.nowTime+=t,this.nowTime>this.gaptime)){var o,i;if(this.nowTime=0,this.buffIndex.length){var n=this.buffIndex.shift();o=n.index,i=n.dragonColor}else this.buffState=!1;this.buffState=0!=this.buffIndex.length,o&&this.loadPrefab(h.emDBBundles.prefabs,"item/buff",function(t){var n=cc.instantiate(t);n.parent=e.buffLayer,n.getComponent(m.default).initNode(o,i)})}},e.prototype.showBuff=function(t,e){var o=new _(t,e);this.buffIndex.push(o),this.buffState=!0},e.prototype.showLoseLabel=function(t,e,o,i){if(void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),!(this.bloodLayer.children.length>=this.maxShowCount)||i){var n=cc.director.getTotalTime();if(!(n-this.lastShowTime<this.throttleTime)||i){this.lastShowTime=n;var a=p.PoolMgr.getInstance().getNode(h.poolName.blood);a.parent||(a.parent=this.bloodLayer);var r=a.getComponent(f.default);r.resumeNode(),a.setPosition(e.x,e.y+40),r.isCirt(o,t)}}},e.prototype.showNewTarm=function(t,e){var o=this;this.loadPrefab(h.emDBBundles.prefabs,"item/mateIcon",function(e){var i=cc.instantiate(e);i.parent=o.skillLayer,i.getComponent(g.default).initNode(t)}),this.showBanner(t,e)},e.prototype.showballBanner=function(t,e){var o=v.default.getInstance().getParam(y.enumBasicParaCfg.tipsStayTime);t.active=!0;var i=e.split(","),n=t.getChildByName("label1").getComponent(cc.Label),a=t.getChildByName("label2").getComponent(cc.Label);n.string=i[0],a.string=i[1]?i[1]:"",this.scheduleOnce(function(){t.active=!1},o)},e.prototype.showBanner=function(t,e){var o=this;this.banner.getComponent(cc.Sprite).spriteFrame=this.bannerSp[t],cc.tween(this.banner).by(e/2,{x:this.banner.width}).delay(e/2).call(function(){o.banner.x=-cc.winSize.width/2-o.banner.width/2}).start()},c([I(cc.Node)],e.prototype,"ndTipRoot",void 0),c([I(cc.Node)],e.prototype,"ndWarn",void 0),c([I(cc.Node)],e.prototype,"btnPause",void 0),c([I(cc.Node)],e.prototype,"hitEffect",void 0),c([I(cc.Node)],e.prototype,"ndBuffImg",void 0),c([I(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([I(cc.Sprite)],e.prototype,"spBack",void 0),c([I(cc.Node)],e.prototype,"buffLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"hitLayer",void 0),c([I(cc.Node)],e.prototype,"blood",void 0),c([I(cc.Node)],e.prototype,"pauseLayer",void 0),c([I(cc.Node)],e.prototype,"closeNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"banner",void 0),c([I(cc.SpriteFrame)],e.prototype,"bannerSp",void 0),c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],DB_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"22eedCDDYVOO7NK854p03Yp","DB_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"22eedCDDYVOO7NK854p03Yp","DB_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.boundary=void 0;var l=i("BaseUI"),p=i("DB_Configs"),u=i("DB_DataMgr"),d=i("DB_HeroCtrl"),h=i("PoolMgr"),f=i("AudioMgr"),m=i("DBGameEnumData"),g=i("SdkMgr"),y=i("PlatformSetting"),v=i("BasePlatform"),_=function(){};a.boundary=_;var b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.sprBgSup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.heroRoot=null,e.ndFence=null,e.content=null,e.item=null,e.bulletLayer=null,e.rewardLayer=null,e.bloodLayer=null,e.destroyLayer=null,e.startNode=null,e.skillLayer=null,e.dieLayer=null,e.bulletSkill=null,e.gmNode=null,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this.ndCardGroup.getComponent(d.default);t.clearHero(),p.Global.canAttack=!1,p.Global.bulletID=0,t.addHero(this.getNewRole()),o.script=this,this.createNodePool(),this.doStart(),this.initBulletBoundary()},e.prototype.initBulletBoundary=function(){this.bulletBoundary=new _;var t=cc.winSize;this.bulletBoundary.upBoundary=t.height/2,this.bulletBoundary.leftBoundary=-t.width/2,this.bulletBoundary.rightBoundary=t.width/2,this.bulletBoundary.downBoundary=this.getWallPosY()+50},e.prototype.getBulletBoundary=function(){return this.bulletBoundary},e.prototype.setGmNode=function(){(g.SdkMgr.getInstance().getCheckVersion(y.SwitchID.ShenHe_ABD)||y.PlatformSetting.currentPlatform==v.Platform.EDITOR||y.PlatformSetting.currentPlatform==v.Platform.WEB_LINK)&&(this.gmNode.active=!0)},e.prototype.doStart=function(){var t=this;f.AudioMgr.getInstance().playEffectFree(p.DB_AudioId.mission),this.startNode.active=!0,this.startNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.startNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.startNode.active=!1},.1)})},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=u.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);return o[Math.floor(Math.random()*o.length)]},e.prototype.getWallPosY=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.y-50},e.prototype.getBulletSkill=function(){return this.bulletSkill},e.prototype.getWallPos=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.getPosition()},e.prototype.start=function(){this.initEvents()},e.prototype.createNodePool=function(){this.loadPrefab(p.emDBBundles.prefabs,"item/blood",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.blood,e)}),this.loadPrefab(p.emDBBundles.prefabs,"item/destroy",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.destroy,e)}),this.loadPrefab(p.emDBBundles.prefabs,"item/box",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.box,e)}),this.loadPrefab(p.emDBBundles.prefabs,"item/body",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.body,e)}),this.loadPrefab(p.emDBBundles.prefabs,"item/ball_item",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.db_item,e)}),this.loadPrefab(p.emDBBundles.prefabs,"item/ball_bullet",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.db_bullet,e)}),this.loadPrefab(p.emDBBundles.prefabs,"item/ball_bullet2",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.newdb_bullet,e)}),this.loadPrefab(p.emDBBundles.prefabs,"bullets/"+p.poolName.DB_Bullet_skill,function(t){h.PoolMgr.getInstance().creatrePool(p.poolName.DB_Bullet_skill,cc.instantiate(t))})},e.prototype.initEvents=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.ndCardGroup.getComponent(d.default).heroMove(o)})},e.prototype.getBulletLayer=function(t){var e="layer"+t;return this.bulletLayer.getChildByName(e)},e.prototype.getAllBullet=function(){var t=[];for(var e in this.bulletLayer.children)for(var o in this.bulletLayer.children[e].children)t.push(this.bulletLayer.children[e].children[o])},e.prototype.getDestroyLayer=function(){return this.destroyLayer},e.prototype.getSkillLayer=function(){return this.skillLayer},e.prototype.checkReWardLayer=function(t){return this.rewardLayer.y>t},e.prototype.addHero=function(){},e.prototype.update=function(){},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.sprBgSup);var t=u.default.getInstance().getParam(m.enumBasicParaCfg.quake);cc.tween(this.sprBgSup).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-1*t,-1*t)}).by(.05,{position:cc.v3(2*t,1*t)}).by(.05,{position:cc.v3(-2*t,0*t)}).by(.05,{position:cc.v3(2*t,-1*t)}).by(.05,{position:cc.v3(-1*t,1*t)}).set({position:cc.v3(0,0)}).start()},c([I(cc.Node)],e.prototype,"ndCardGroup",void 0),c([I(cc.Node)],e.prototype,"sprBgSup",void 0),c([I(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([I(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([I(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([I(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([I(cc.Node)],e.prototype,"heroRoot",void 0),c([I(cc.Node)],e.prototype,"ndFence",void 0),c([I(cc.Node)],e.prototype,"content",void 0),c([I(cc.Node)],e.prototype,"item",void 0),c([I(cc.Node)],e.prototype,"bulletLayer",void 0),c([I(cc.Node)],e.prototype,"rewardLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"destroyLayer",void 0),c([I(cc.Node)],e.prototype,"startNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"dieLayer",void 0),c([I(cc.Node)],e.prototype,"bulletSkill",void 0),c([I(cc.Node)],e.prototype,"gmNode",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],DB_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"bd5677oGLxNcIXO/QPWXgyC","DB_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"bd5677oGLxNcIXO/QPWXgyC","DB_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DB_Configs"),p=i("DB_App"),u=i("BaseUI"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e.isDirect=null,e.unDirect=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t,this.isDirect.active=l.Global.isDirect,this.unDirect.active=!l.Global.isDirect},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([f(cc.Label)],e.prototype,"lblBar",void 0),c([f(cc.Sprite)],e.prototype,"spBar",void 0),c([f(cc.Node)],e.prototype,"ndWin",void 0),c([f(cc.Node)],e.prototype,"ndFail",void 0),c([f(cc.Node)],e.prototype,"ndTop",void 0),c([f(cc.Node)],e.prototype,"ndBar",void 0),c([f(cc.Node)],e.prototype,"btn",void 0),c([f(cc.Node)],e.prototype,"btnPlay",void 0),c([f(cc.Label)],e.prototype,"lblRwd",void 0),c([f(cc.Node)],e.prototype,"isDirect",void 0),c([f(cc.Node)],e.prototype,"unDirect",void 0),c([h],e)}(u.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DB_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"9f4faCC9MVBvIwXmpf7jNya","DB_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"9f4faCC9MVBvIwXmpf7jNya","DB_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("DB_Configs"),m=i("DB_App"),g=i("DB_UIGame"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t,this.isDirect.active=f.Global.isDirect,this.unDirect.active=!f.Global.isDirect},e.prototype.onEnable=function(){this.musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&g.default.script.setGmNode()}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){m.default.instance.exit_App(0)}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([_(cc.Slider)],e.prototype,"musicSlider",void 0),c([_(cc.Slider)],e.prototype,"effectSlider",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([_(cc.Node)],e.prototype,"btnBackHome",void 0),c([_(cc.Node)],e.prototype,"isDirect",void 0),c([_(cc.Node)],e.prototype,"unDirect",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Node)],e.prototype,"gmNode",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],DB_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"ca71dWQxSdCdqLrv4MhLF/h","DB_UserData");var i=t,n=e,a=o;cc._RF.push(n,"ca71dWQxSdCdqLrv4MhLF/h","DB_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"gad_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],DB_ballCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"561dfZRnndLGKpE4fiNXDDf","DB_ballCtrl");var i=t,n=e,a=o;cc._RF.push(n,"561dfZRnndLGKpE4fiNXDDf","DB_ballCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("DB_Configs"),c=i("DB_DataMgr"),l=i("DB_ball"),p=i("DB_Body"),u=i("DB_bodyCtrl"),d=function(){function t(t,e,o){this.gameCtrl=null,this.redPathIndex=new Map,this.bluePathIndex=new Map,this.nowTime=0,this.showIndex=0,this.nextTime=-1,this.canCreate=!0,this.cfgArr=[],this.nowCfg=null,this.ballLottery=[],this.gameCtrl=t,this.redPath=e,this.bluePath=o,this.initParam()}return t.prototype.initParam=function(){this.cfgArr=c.default.getInstance().getDragonBallShowCfg(),this.initBallLottery(),this.refreshCfg(),this.bluePath=this.createPath(this.bluePathIndex,this.bluePath),this.redPath=this.createPath(this.redPathIndex,this.redPath)},t.prototype.initBallLottery=function(){var t=c.default.getInstance().getDragonBallCfg();for(var e in this.ballLottery=[],t)this.ballLottery.push(t[e])},t.prototype.refreshCfg=function(){this.nowCfg=this.cfgArr[this.showIndex],this.showIndex++},t.prototype.createBall=function(t){var e,o,i;r.AudioMgr.getInstance().playEffect(s.DB_AudioId.dragonBallShow,"dragonBallShow");var n=t.position;if(s.Global.redDragonState&&(n=s.DragonColor.blue),s.Global.blueDragonState&&(n=s.DragonColor.red),n==s.DragonColor.red?(e=this.gameCtrl.headRed.getComponent(u.default).getIndex(),o=this.redPathIndex,i=this.redPath):(e=this.gameCtrl.headBlue.getComponent(u.default).getIndex(),o=this.bluePathIndex,i=this.bluePath),e=o[e]+t.distance,n==s.DragonColor.red)for(;i[e]&&i[e].x<this.redPath[0].x;)e++;if(n==s.DragonColor.blue)for(;i[e]&&i[e].x>this.bluePath[0].x;)e++;if(!i[e]||e==i.length-1){if(e=i.length-3,n==s.DragonColor.red&&p.default.script.getHeadNode(n).x-30>i[e].x&&p.default.script.getHeadNode(n).y<i[e].y)return;if(n==s.DragonColor.blue&&p.default.script.getHeadNode(n).x+30<i[e].x&&p.default.script.getHeadNode(n).y<i[e].y)return}var a=i[e],c=Math.floor(Math.random()*this.ballLottery.length),d=this.ballLottery[c];this.ballLottery.splice(c,1),0==this.ballLottery.length&&this.initBallLottery(),this.gameCtrl.initBanner(d.dragonBallName),this.gameCtrl.ballNode.getComponent(l.default).initParam(t.dragonBallHp,d,a,this,n)},t.prototype.createPath=function(t,e){for(var o=Math.abs(e[1].x-e[0].x)/4,i=[],n=0,a=e[1].x<0?1:-1;n<e.length-1;){var r=e[n].x,s=e[n].y;if(Math.abs(e[n+1].y-e[n].y)<1e-6){t[n]=i.length;for(var c=5;c--;){var l=new cc.Vec2(r,s);i.push(l),r+=o*a}t[n+1]=i.length-1,n+=2,a*=-1}else l=new cc.Vec2(r,s),i.push(l),t[n]=i.length-1,n+=1}return i.push(e[e.length-1]),t[n]=i.length-1,i},t.prototype.getCommonElements=function(t,e){var o=this;return t.filter(function(t){return e.some(function(e){return o.areVec2Equal(t,e)})})},t.prototype.getUniqueElements=function(t,e){var o=this;return t.filter(function(t){return!e.some(function(e){return o.areVec2Equal(t,e)})})},t.prototype.areVec2Equal=function(t,e){return Math.abs(t.x-e.x)<=2&&Math.abs(t.y-e.y)<=2},t.prototype.test=function(){this.nowTime=this.nowCfg.showTime-1},t.prototype.reduceTime=function(t){this.nowCfg&&this.nowTime+t>this.nowCfg.showTime&&(this.nowTime-=t)},t.prototype.onUpdate=function(t){if(this.nowCfg&&(this.nowTime+=t,this.nowTime>=this.nowCfg.showTime)){var e=this.nowCfg;this.refreshCfg(),this.createBall(e)}},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],DB_ball:[function(t,e,o){"use strict";cc._RF.push(e,"030ceAHCNRBiJVQbyK1C2p+","DB_ball");var i=t,n=e,a=o;cc._RF.push(n,"030ceAHCNRBiJVQbyK1C2p+","DB_ball");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.ballID=a.ballState=void 0;var l,p,u=i("BaseCtrl"),d=i("AudioMgr"),h=i("Utils"),f=i("DB_Configs"),m=i("DBGameEnumData"),g=i("DB_DataMgr"),y=i("DB_HeroCtrl"),v=i("DB_Body"),_=function(t,e,o){this.time=t,this.state=e,this.cfg=o},b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpLabel=null,e.ballSprite=null,e.montionStreak=null,e.ballNode=null,e.dragonBallLabel=null,e.playerBallLabel=null,e.state=l.None,e.ballTimeArr=[],e.isPause=!1,e.dragonLimitY=700,e.playerLimitY=-300,e.step=0,e}return s(e,t),e.prototype.initParam=function(t,e,o,i,n){this.ballCtrlScript||(this.ballCtrlScript=i),this.ballSpeed||(this.ballSpeed=g.default.getInstance().getParam(m.enumBasicParaCfg.ballFlySpeed)),this.ballBelong=n,this.ballNode.y=0,this.ballNode.x=0,this.stopFloatEffect(),this.state=l.None,this.hpNum=Math.floor(t),this.cfg=e,this.montionStreak.node.active=!1,this.montionStreak.node.angle=0,this.initView(o)},e.prototype.initView=function(t){this.hpLabel.string=this.hpNum.toString(),this.hpLabel.node.active=!0,this.ballSprite.setAnimation(0,this.cfg.dragonBallImage,!0),this.node.setPosition(t),this.applyFloatEffect(this.ballNode)},e.prototype.initTest=function(){this.cfg=g.default.getInstance().getDragonBallCfgBYid(Math.ceil(5*Math.random()))},e.prototype.doDestroyTest=function(t,e){this.state=1==e?l.dragon:l.player,this.doItem(this.cfg,this.state)},e.prototype.applyFloatEffect=function(t,e,o){void 0===e&&(e=20),void 0===o&&(o=1.5);var i=t.position.clone();this.floatTween=cc.tween(t).to(o,{position:new cc.Vec3(i.x,i.y+e,i.z)}).to(o,{position:i}).union().repeatForever().start()},e.prototype.stopFloatEffect=function(){this.floatTween&&(this.floatTween.stop(),this.floatTween=null)},e.prototype.doDestroy=function(t){if(this.state==l.None){if(d.AudioMgr.getInstance().playEffect(f.DB_AudioId.dragonBallGet,"dragonBallShow"),this.stopFloatEffect(),this.state=t,t==l.player)this.montionStreak.node.scaleY=-1;else{var e=this.node.y+100;this.dragonLimitY=e,this.step=0,this.montionStreak.node.scaleY=1}this.montionStreak.node.angle=0,this.node.getChildByName("ball").y=0,this.montionStreak.node.active=!0,this.montionStreak.setAnimation(0,this.cfg.dragonBallImage,!0),this.hpLabel.node.active=!1,this.ballCtrlScript.reduceTime(6)}},e.prototype.doDestoryTween=function(t){if(this.state==l.player)this.node.y+=this.ballSpeed*t*-1,this.node.y<this.playerLimitY&&this.doDestroyTweenDown();else if(this.state==l.dragon)if(0==this.step){var e=this.ballSpeed*t;this.node.y+=e,this.node.y>=this.dragonLimitY&&(this.step=1)}else{var o=v.default.script.getHeadNode(this.ballBelong).getPosition(),i=o.sub(this.node.getPosition()),n=new cc.Vec2(1,0);this.montionStreak.node.angle=270-i.angle(n)/Math.PI*180,i.normalizeSelf(),this.node.x+=i.x*this.ballSpeed*3*t,this.node.y+=i.y*this.ballSpeed*3*t,o.fuzzyEquals(this.node.getPosition(),30)&&this.doDestroyTweenDown()}},e.prototype.doDestroyTweenDown=function(){this.doItem(this.cfg,this.state),this.node.y=5e3,this.node.x=5e3,this.state=l.None},e.prototype.doItem=function(t,e){var o=-1;t.dragonBallID==p.iceBall?(o=e==l.dragon?t.dragonGetPara2:t.playerGetPara1,d.AudioMgr.getInstance().playEffect(f.DB_AudioId.ice,"skillBuff")):t.dragonBallID==p.fireBall?e==l.dragon?this.getScript(t,e).doBallSkill(e,t,this.ballBelong):o=t.playerGetPara2:t.dragonBallID==p.thunderBall?o=e==l.dragon?t.dragonGetPara1:t.playerGetPara1:t.dragonBallID==p.windBall?(d.AudioMgr.getInstance().playEffect(f.DB_AudioId.wind,"skillBuff"),o=e==l.dragon?t.dragonGetPara2:t.playerGetPara2):t.dragonBallID==p.vagueBall&&(o=e==l.dragon?t.dragonGetPara2:t.playerGetPara2,e==l.dragon?d.AudioMgr.getInstance().playEffect(f.DB_AudioId.barrier,"skillBuff"):d.AudioMgr.getInstance().playEffect(f.DB_AudioId.magic,"skillBuff"));var i=e==l.dragon?t.dragonGetDes:t.playerGetDes,n=e==l.dragon?this.dragonBallLabel:this.playerBallLabel;if(this.sendEvent(f.emDBEventName.db_ball_tips,n,i),-1!=o){var a=new _(o,e,t);this.ballTimeArr.push(a),this.getScript(t,e).doBallSkill(e,t,this.ballBelong)}},e.prototype.getScript=function(t,e){return"player"==(e==l.dragon?t.dragonEffect:t.playerEffect)?y.default.script:v.default.script},e.prototype.checkSkillCollider=function(t,e){this.state==l.None&&t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.getPosition()),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.checkCollider=function(t){return this.state==l.None&&!!this.isInRange(t)},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=this.node.width/2&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hpNum-=Math.floor(s),this.hpNum<=0)this.sendEvent(f.emDBEventName.blood,t,this.getPos(e),o),this.doDestroy(l.player);else for(;r--;)this.doDamage(t,this.getPos(e),o,a)},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(f.emDBEventName.blood,t,e,o,i),this.hpLabel.string=Math.max(this.hpNum,0).toString()},e.prototype.getPos=function(t){var e=h.Utils.randomRang(-30,30),o=h.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.resumeItem=function(t){for(var e=0;e<this.ballTimeArr.length;e++)this.ballTimeArr[e].time-=t,this.ballTimeArr[e].time<0&&(this.ballTimeArr[e].cfg.dragonBallID==p.iceBall&&d.AudioMgr.getInstance().playEffect(f.DB_AudioId.icebreak,"skillBuff"),this.doResumeItemDown(this.ballTimeArr[e]),this.ballTimeArr.splice(e,1),e--)},e.prototype.doResumeItemDown=function(t){y.default.script.heroResumeSkill(t.cfg.dragonBallID),v.default.script.resumeBallSkill(t.cfg.dragonBallID)},e.prototype.checkDragon=function(){if(this.state==l.None){var t=v.default.script.getHeadNode(this.ballBelong).getPosition();this.areVec2ComponentsEqual(t,this.node.getPosition(),50,10)&&this.doDestroy(l.dragon)}},e.prototype.areVec2ComponentsEqual=function(t,e,o,i){var n=Math.abs(t.x-e.x)<o,a=Math.abs(t.y-e.y)<i;return n&&a},e.prototype.resume=function(){this.isPause=!1},e.prototype.pause=function(){this.isPause=!0},e.prototype.onLoad=function(){this.addEvent(f.emDBEventName.pause,this.pause),this.addEvent(f.emDBEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.isPause||(this.resumeItem(t),this.doDestoryTween(t),this.checkDragon())},c([I(cc.Label)],e.prototype,"hpLabel",void 0),c([I(sp.Skeleton)],e.prototype,"ballSprite",void 0),c([I(sp.Skeleton)],e.prototype,"montionStreak",void 0),c([I(cc.Node)],e.prototype,"ballNode",void 0),c([I(cc.Node)],e.prototype,"dragonBallLabel",void 0),c([I(cc.Node)],e.prototype,"playerBallLabel",void 0),c([B],e)}(u.default);a.default=P,function(t){t.None="None",t.player="player",t.dragon="dragon"}(l=a.ballState||(a.ballState={})),function(t){t[t.iceBall=1]="iceBall",t[t.fireBall=2]="fireBall",t[t.thunderBall=3]="thunderBall",t[t.windBall=4]="windBall",t[t.vagueBall=5]="vagueBall"}(p=a.ballID||(a.ballID={})),cc._RF.pop(),cc._RF.pop()},{}],DB_bodyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"713ee/fme9DDrzmCCDp1RBO","DB_bodyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"713ee/fme9DDrzmCCDp1RBO","DB_bodyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("DB_Configs"),d=i("DBGameEnumData"),h=i("DB_DataMgr"),f=i("DB_UIGame"),m=i("DB_Body"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStart=!1,e.index=0,e.ballgonSpeed=100,e.end=!1,e.sp=[],e.isDBgon=!1,e.isLast=!1,e.baseTime=.5,e.resumeTime=.5,e.damageState=!1,e.posNum=2,e}var o;return s(e,t),o=e,e.prototype.startRun=function(t,e,o,i,n,a){this.isDBgon=!1,4==o&&(this.isLast=!0),-1!=o?(a==u.DragonColor.blue&&(o+=5),this.changeSp(o),this.destroyNode=p.PoolMgr.getInstance().getNode(u.poolName.destroy)):this.isDBgon=!0,this.dragonColor=a,this.dragonColor==u.DragonColor.red?this.path=t:this.path=e,this.index=n,this.targetPos=this.path[this.index],this.isStart=!0,this.maxIndex=this.path.length-4,this.posNum=2},e.prototype.changeFireState=function(){this.isDBgon||this.isLast||(this.fireNode.active=!this.fireNode.active,this.fireNode.active&&this.fireNode.getComponent(sp.Skeleton).setAnimation(0,"fire",!0))},e.prototype.stop=function(){this.isStart=!1,this.isDBgon?this.node.getComponent(sp.Skeleton).clearTrack(0):this.spNode.getComponent(cc.Animation).pause()},e.prototype.resume=function(){this.isStart=!0,this.isDBgon?this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0):this.spNode.getComponent(cc.Animation).resume()},e.prototype.changeSp=function(t){this.spNode.getComponent(cc.Sprite).spriteFrame=this.sp[t]},e.prototype.doAnimation=function(t,e){var o=this;void 0===t&&(t=0),this.scheduleOnce(function(){var t=o.spNode.getComponent(cc.Animation);t.play("body");var i=t.getAnimationState("body");e==u.DragonColor.red?i.speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmni):i.speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniBlue)},t)},e.prototype.doDamage=function(){this.spNode.color=cc.color().fromHEX("#a60000"),this.resumeTime=this.baseTime,this.damageState=!0},e.prototype.reSumeDamage=function(){this.spNode.color=cc.Color.WHITE},e.prototype.resumeNode=function(t){0!=this.damageState&&(this.resumeTime-=t,this.resumeTime<0&&this.damageState&&(this.reSumeDamage(),this.damageState=!1))},e.prototype.informPre=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0),this.preNode&&(u.Global.isBug&&(this.node.active=!1),u.Global.isBug||(this.preNode=this.getInfactPre()),this.preNode.getComponent(o).setNodePosition(this.node.getPosition(),this.index))},e.prototype.getInfactPre=function(){for(var t=this.preNode;!t.active;)t.removeFromParent(),t=t.getComponent(o).preNode;return t},e.prototype.setNodePosition=function(t,e){var o=this;u.Global.isBug||this.informPre(t,e),this.index=e,this.targetPos=this.path[this.index],this.node.setPosition(t),u.Global.isBug&&this.informPre(t,e),this.isDBgon&&"die"!=this.node.getComponent(sp.Skeleton).animation&&(this.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1),this.node.getComponent(sp.Skeleton).setCompleteListener(function(){o.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}))},e.prototype.getIndex=function(){return this.index},e.prototype.playDeballry=function(){var t=this;f.default.script.onScreenShake();var e=p.PoolMgr.getInstance().getNode(u.poolName.destroy);e||(e=cc.instantiate(this.destroyNode)),e.parent=f.default.script.getDestroyLayer(),e.setPosition(this.node.getPosition()),e.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){e.destroy()},.1)})},e.prototype.setPreNode=function(t,e,o){var i=t.position;o==u.DragonColor.red?i.x-=e:i.x+=e,this.isLast&&(this.spNode.anchorX=.8,this.spNode.anchorY=.3),this.node.position=i,this.preNode=t},e.prototype.onLoad=function(){this.ballgonSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed)},e.prototype.start=function(){var t=this;cc.game.on("gameEnd",function(){t.isStart=!1})},e.prototype.update=function(t){this.isStart&&this.resumeNode(t)},e.prototype.onUpdate=function(t,e,o){if(this.node.active&&!this.end&&this.isStart&&!(this.dragonColor==u.DragonColor.red&&u.Global.redDragonState||this.dragonColor==u.DragonColor.blue&&u.Global.blueDragonState)){var i=this.targetPos,n=this.node.getPosition();if(null!=i&&null!=n){var a=i.sub(n).mag(),r=(this.dragonColor==u.DragonColor.blue?o:e)*t;r=Math.min(r,a);var s=i.sub(n).normalize().mul(r);this.node.setPosition(n.add(s)),(this.isDBgon||this.isLast)&&(s.x<0?this.node.scaleX=-1:s.x>0&&(this.node.scaleX=1)),a<=r&&(this.node.setPosition(i),this.index++,this.index>=this.path.length||(this.targetPos=this.path[this.index])),this.index>=this.maxIndex&&(this.endPos||(this.endPos=f.default.script.getWallPos()),this.node.getPosition().fuzzyEquals(this.endPos,50)&&(this.end=!0,this.dragonColor==u.DragonColor.red&&(u.Global.redDragonState=!0),this.dragonColor==u.DragonColor.blue&&(u.Global.blueDragonState=!0),m.default.script.doCoolBall()))}}},c([v(cc.SpriteFrame)],e.prototype,"sp",void 0),c([v(cc.Node)],e.prototype,"spNode",void 0),c([v(cc.Node)],e.prototype,"fireNode",void 0),o=c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DB_boxCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"3fd34p53DFIj4lt8WVSZKz+","DB_boxCtrl");var i=t,n=e,a=o;cc._RF.push(n,"3fd34p53DFIj4lt8WVSZKz+","DB_boxCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("Utils"),h=i("DB_Configs"),f=i("DB_DataMgr"),m=i("DB_bodyCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.boxSpArr=[],e.otherNodes=[],e.isDie=!1,e.lastAttackIndex=0,e.hp=2,e.isLast=!1,e.canBeAttack=!1,e.isCreate=!1,e}return s(e,t),e.prototype.start=function(){this.canBeAttack=!1},e.prototype.setCanBeAttack=function(){this.canBeAttack=!0},e.prototype.initNode=function(t,e,o,i,n){var a=this;void 0===i&&(i=!1),this.scheduleOnce(function(){a.boxSp.node.active=!0,a.label.node.active=!0},.1),this.isLast=i,this.targetNode=t,this.hp=e,this.boxIndex=o,this.label.string=e.toString(),this.dragonColor=n,this.initBox(),this.blood=u.PoolMgr.getInstance().getNode(h.poolName.blood)},e.prototype.initBox=function(){var t=f.default.getInstance().getRedLevelCfgByID(this.boxIndex);this.dragonColor==h.DragonColor.blue&&(t=f.default.getInstance().getBlueLevelCfgByID(this.boxIndex)),t.buffType&&(this.boxSp.spriteFrame=this.boxSpArr[1])},e.prototype.addOtherNode=function(t){this.otherNodes.push(t)},e.prototype.checkCollider=function(t){if((!h.Global.redDragonState||this.dragonColor!=h.DragonColor.red)&&(!h.Global.blueDragonState||this.dragonColor!=h.DragonColor.blue)&&(this.checkIsDie(),this.canBeAttack))return!this.isDie&&!!this.isInRange(t)},e.prototype.checkIsDie=function(){if(!this.isDie){var t=!1;for(var e in this.otherNodes)if(0==this.otherNodes[e].active){t=!0;break}t&&(this.node.active=!1),this.isDie=t}},e.prototype.checkSkillCollider=function(t,e){h.Global.redDragonState&&this.dragonColor==h.DragonColor.red||h.Global.blueDragonState&&this.dragonColor==h.DragonColor.blue||this.canBeAttack&&(this.isDie||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0))},e.prototype.doFireDamage=function(t){if(!(h.Global.redDragonState&&this.dragonColor==h.DragonColor.red||h.Global.blueDragonState&&this.dragonColor==h.DragonColor.blue||this.isDie)){var e=Math.ceil(this.hp*t);this.handleDamage(e,this.node.getPosition())}},e.prototype.isInRange=function(t){var e=this.targetNode.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){if(void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1),!(h.Global.redDragonState&&this.dragonColor==h.DragonColor.red||h.Global.blueDragonState&&this.dragonColor==h.DragonColor.blue)){var r=1,s=t;if(n&&(s=i*t,r=i),this.hp-=s,this.hp<=0)this.sendEvent(h.emDBEventName.blood,t,this.getPos(e),o),this.doDie();else for(;r--;)this.doDamage(t,this.getPos(e),o,a);p.AudioMgr.getInstance().playEffect(h.DB_AudioId.ballgonHit,h.DB_AudioId.ballgonHit)}},e.prototype.getPos=function(t){var e=d.Utils.randomRang(-30,30),o=d.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(h.emDBEventName.blood,t,e,o,i),this.label.string=Math.max(this.hp,0).toString(),this.otherNodes.forEach(function(t){t.getComponent(m.default).doDamage()})},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.doDie=function(){var t=this;p.AudioMgr.getInstance().playEffectFree(h.DB_AudioId.burn,6),this.isDie=!0,this.node.active=!1,h.Global.isBug?this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(),e.active=!1,o%2&&e.getComponent(m.default).playDeballry()},.05*o)}):this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(e.getPosition(),e.getComponent(m.default).getIndex()),e.active=!1},.05*(9-o)),t.scheduleOnce(function(){o%2&&e.getComponent(m.default).playDeballry()},.05*o)}),this.isLast&&(this.dragonColor,h.DragonColor.red,this.sendEvent(h.emDBEventName.pause),this.openUI(h.DB_UIID.UIResult,!0)),this.spawnBuffItem()},e.prototype.spawnBuffItem=function(){this.isCreate||(this.isCreate=!0,this.sendEvent(h.emDBEventName.buff,this.boxIndex,this.dragonColor))},e.prototype.update=function(){this.targetNode&&!this.isDie&&this.node.setPosition(this.targetNode.position)},c([v(cc.Label)],e.prototype,"label",void 0),c([v(cc.Sprite)],e.prototype,"boxSp",void 0),c([v(cc.SpriteFrame)],e.prototype,"boxSpArr",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DB_fireNode:[function(t,e,o){"use strict";cc._RF.push(e,"87fe8mlyaxA6ZdVg8gbIixH","DB_fireNode");var i=t,n=e,a=o;cc._RF.push(n,"87fe8mlyaxA6ZdVg8gbIixH","DB_fireNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("Utils"),d=i("DB_Configs"),h=i("DB_UIGame"),f=i("DB_Body"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aimY=0,e.nodeActive=!0,e.inDestroy=!1,e.fireEffectTime=3,e.nowTime=0,e}return s(e,t),e.prototype.initParam=function(t,e){this.inDestroy=!1,this.hpNum=Math.floor(t),this.speed=e,this.aimY=h.default.script.getWallPosY(),p.AudioMgr.getInstance().playEffect(d.DB_AudioId.fireball,"fireBall"),this.nodeActive=!0,this.initView()},e.prototype.initView=function(){this.node.getComponent(sp.Skeleton).setAnimation(0,"animation",!0),this.hpLabel.string=this.hpNum.toString()},e.prototype.doDestroy=function(){var t=this;f.default.script.fireNodeDestroy(),this.node.active=!1,this.nodeActive=!1,this.scheduleOnce(function(){t.node.removeFromParent()},1)},e.prototype.checkSkillCollider=function(t,e){this.hpNum<=0||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.getPosition()),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.checkCollider=function(t){return!(this.hpNum<=0||!this.isInRange(t))},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=150},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hpNum-=s,this.hpNum<=0)this.sendEvent(d.emDBEventName.blood,t,this.getPos(e),o),this.doDestroy();else for(;r--;)this.doDamage(t,this.getPos(e),o,a)},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(d.emDBEventName.blood,t,e,o,i),this.hpLabel.string=Math.max(this.hpNum,0).toString()},e.prototype.getPos=function(t){var e=u.Utils.randomRang(-30,30),o=u.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.node.y-=this.speed*t,this.nodeActive&&(this.nowTime+=t,this.nowTime>=this.fireEffectTime&&(this.nowTime=0,p.AudioMgr.getInstance().playEffect(d.DB_AudioId.fireball,"fireBall")),this.node.y-this.node.height/2<this.aimY&&(this.sendEvent(d.emDBEventName.pause),this.openUI(d.DB_UIID.UIResult)))},c([y(cc.Label)],e.prototype,"hpLabel",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],DB_mateCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"2b99bWR6WJLBaQQH27pgbPj","DB_mateCtrl");var i=t,n=e,a=o;cc._RF.push(n,"2b99bWR6WJLBaQQH27pgbPj","DB_mateCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DB_Configs"),u=i("DB_DataMgr"),d=i("DB_HeroCtrl"),h=i("DB_mateSkillCtrl"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e.maxCDTime=0,e.cdTime=0,e.mateSkillAttack=1,e.mateID=1,e.isPause=!1,e}return s(e,t),e.prototype.initNode=function(t){this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=this,e=u.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=e.mateCDtime,this.mateSkillAttack=e.mateSkillATK,this.loadPrefab(p.emDBBundles.prefabs,"skills/mateSkill"+this.mateID,function(e){t.skillNode=cc.instantiate(e)})},e.prototype.initView=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID);this.skillLabel.string=t.mateName,this.cdPercent.fillRange=0,this.skillIcon.spriteFrame=this.getSpriteByName(),this.cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){if(this.cdTime<=0){if(d.default.script.getBallLock())return;var t=u.default.getInstance().getMateCfgByID(this.mateID),e=Number(t.mateRole.split(",")[0]),o=Number(t.mateRole.split(",")[1]);h.default.script.useSkill(this.mateID,d.default.script.getMaxDamage(e,o)*t.mateSkillATK,this.skillNode,new cc.Vec2(0,0))&&this.initStartUseSkill()}},e.prototype.initStartUseSkill=function(){this.cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.cdLabel.string=this.cdTime+"",this.cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.cdLabel.node.active=!1,this.spNode.node.active=!0,this.spNode.setAnimation(0,"animation",!1),this.spNode.setCompleteListener(function(){e.spNode.node.active=!1})):this.cdLabel.string=this.cdTime.toFixed(0)},e.prototype.getSpriteByName=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID).mateIconRes;for(var e in this.spArr)if(t==this.spArr[e].name)return this.spArr[e]},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.onLoad=function(){this.addEvent(p.emDBEventName.pause,this.pause),this.addEvent(p.emDBEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.cdTime>0&&!this.isPause&&!d.default.script.getBallLock()&&this.refreshSkillView(t)},c([g(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([g(cc.Label)],e.prototype,"cdLabel",void 0),c([g(cc.Label)],e.prototype,"skillLabel",void 0),c([g(cc.Sprite)],e.prototype,"cdPercent",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([g(sp.Skeleton)],e.prototype,"spNode",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DB_mateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c0073WMgB9J5bKrnlb/9ywP","DB_mateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c0073WMgB9J5bKrnlb/9ywP","DB_mateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DB_mateSkill"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){var n=this;return!this.isSkill&&(this.isSkill=!0,this.scheduleOnce(function(){n.isSkill=!1},.5),o.parent=this.node,o.getComponent(p.default).useSkill(i,e,t),!0)},e.prototype.onLoad=function(){o.script=this},e.prototype.start=function(){},e.prototype.update=function(){},c([h(cc.Label)],e.prototype,"label",void 0),c([h(cc.Node)],e.prototype,"banner",void 0),c([h],e.prototype,"text",void 0),o=c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DB_mateSkill:[function(t,e,o){"use strict";cc._RF.push(e,"1c49eBupudPFLtIu9cglNoj","DB_mateSkill");var i=t,n=e,a=o;cc._RF.push(n,"1c49eBupudPFLtIu9cglNoj","DB_mateSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("DB_Configs"),d=i("DB_DataMgr"),h=i("DB_Body"),f=i("DB_Hero"),m=i("DB_HeroCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){var i=d.default.getInstance().getMateCfgByID(t.index),n=Number(i.mateRole.split(",")[0]),a=Number(i.mateRole.split(",")[1]),r=[];for(var s in u.Global.heroID)u.Global.heroID[s].id!=n&&u.Global.heroID[s].id!=a||r.push(u.Global.heroID[s].node.getComponent(f.default));"attack"==o.data.name&&(t.doMateSkillCtrl(t.index,r,i),t.doAttack())})},e.prototype.doMateSkillCtrl=function(t,e,o){1==t?this.doMateSkill1(e,o):2==t?this.doMateSkill2(e,o):3==t?this.doMateSkill3(e,o):4==t?this.doMateSkill4(e,o):5==t?this.doMateSkill5(e,o):6==t&&this.doMateSkill6(e,o)},e.prototype.doMateSkill1=function(t,e){for(var o in t)t[o].addAttackSpeed(1,Number(e.matePara))},e.prototype.doMateSkill2=function(t,e){var o=m.default.script.getMaxDamage(4,8),i=Math.floor(o*Number(e.matePara));for(var n in t)t[n].addAttackPower(1,i)},e.prototype.doMateSkill3=function(t,e){p.EventMgr.getInstance().emit(u.emDBEventName.skillPause),this.scheduleOnce(function(){p.EventMgr.getInstance().emit(u.emDBEventName.skillResume)},Number(e.matePara))},e.prototype.doMateSkill4=function(t,e){for(var o in t){var i=Math.floor(2*Math.random()),n=Number(e.matePara.split(",")[i]),a=t[o];n<1?a.addCritChance(3,n):a.addBulletCount(1,n)}},e.prototype.doMateSkill5=function(t,e){var o=Number(e.matePara.split(",")[0]),i=Number(e.matePara.split(",")[1]);for(var n in t)t[n].changeSkillInterval(o,i)},e.prototype.doMateSkill6=function(t,e){var o=Number(e.matePara.split(",")[0]),i=Number(e.matePara.split(",")[1]);for(var n in t)t[n].addAttackPenerate(3,o,5,i)},e.prototype.useSkill=function(t,e,o){var i=d.default.getInstance().getMateCfgByID(o);l.AudioMgr.getInstance().playEffect(i.mateSound,"mateSkill"),this.index=o,this.spAni.setAnimation(0,"animation",!1),this.node.setPosition(t.x,h.default.script.getHeadY(t.x)),this.damage=e},e.prototype.update=function(){},e.prototype.doAttack=function(){h.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([v({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([v({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([v({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([y],e)}(cc.Component);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DMDGameData:[function(t,e,o){"use strict";cc._RF.push(e,"9a9ddEc3ZdE3qFe9udK3okN","DMDGameData");var i=e,n=o;cc._RF.push(i,"9a9ddEc3ZdE3qFe9udK3okN","DMDGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emDMDGameDataKeys=void 0,function(t){t.GearParameterCfg="GearParameterCfg",t.ToolCfg="ToolCfg"}(n.emDMDGameDataKeys||(n.emDMDGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],DMDGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"905e6ihuudLb5HVa9k7ap6+","DMDGameEnumData");var i=e,n=o;cc._RF.push(i,"905e6ihuudLb5HVa9k7ap6+","DMDGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumDMDGearParameterCfg=void 0,function(t){t[t.BossHP=1]="BossHP",t[t.PlayerHP=2]="PlayerHP",t[t.MaxAmmoNum=3]="MaxAmmoNum",t[t.MinAmmoNum=4]="MinAmmoNum",t[t.tureAmmoAtk=5]="tureAmmoAtk",t[t.MaxToolNum=6]="MaxToolNum",t[t.MinToolNum=7]="MinToolNum",t[t.RushProbability=8]="RushProbability",t[t.CautionProbability=9]="CautionProbability",t[t.KnowProbability=10]="KnowProbability"}(n.enumDMDGearParameterCfg||(n.enumDMDGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],DMD_APP:[function(t,e,o){"use strict";cc._RF.push(e,"6acfdDww61Dp7vDNVV7vf/5","DMD_APP");var i=t,n=e,a=o;cc._RF.push(n,"6acfdDww61Dp7vDNVV7vf/5","DMD_APP"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("DMD_Configs"),p=i("DMD_DataMgr"),u=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e;var n=function(){i._isInited=!0,s.UIMgr.getInstance().openUIOfCallback(l.DMD_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.DMD_AudioId.bgm,l.DMDConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.DMD_UICF),r.AudioMgr.getInstance().addAdConf(l.DMD_AudioCF),p.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),s.UIMgr.getInstance().closeById(l.DMD_UIID.UIGame),s.UIMgr.getInstance().closeById(l.DMD_UIID.UIResult),this._exitCall&&this._exitCall(),this._exitCall=null},t.prototype.removeTouchEvent=function(){},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],DMD_AnimaItem:[function(t,e,o){"use strict";cc._RF.push(e,"72ab9Rbd0hOiJ/AU3Sz6z8b","DMD_AnimaItem");var i=t,n=e,a=o;cc._RF.push(n,"72ab9Rbd0hOiJ/AU3Sz6z8b","DMD_AnimaItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("DMD_Configs"),u=i("DMD_UIGame"),d=cc._decorator,h=d.ccclass,f=d.property,m={1:{path:"demon_hitfire"},2:{path:"demon_gunfire"},3:{path:"demon_prop"},4:{path:"demon_qianghuo"}},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animItem=null,e._hurtData=null,e}return s(e,t),e.prototype.init=function(t){var e=this;this._hurtData=t;var o=p.emDMDBundles.GameIcon,i="anim/"+m[t.type].path+"/"+m[t.type].path;t.pos?this.node.setPosition(t.pos):this.node.setPosition(cc.v3(0,0,0)),t.scal?(this.node.scaleX=t.scal.x,this.node.scaleY=t.scal.y):this.node.setScale(cc.v3(1,1,1)),t.anlge?this.node.angle=t.anlge:this.node.angle=0,m[t.type].audio&&l.AudioMgr.getInstance().playEffectFree(m[t.type].audio);var n=this.animItem;n.skeletonData=null,n.node.active=!1,u.default.instance.loadResSkeleton(this.node,o,i,function(o){n.node.active=!0,n.skeletonData=o;var i="animation";t.animaName&&"tongs"==(i=t.animaName)&&l.AudioMgr.getInstance().playEffectFree(p.DMD_AudioId.qianzi),t.skin&&n.setSkin(t.skin),n.setAnimation(0,i,!1),n.setCompleteListener(null),n.setCompleteListener(function(){t.callback&&t.callback(),n.setCompleteListener(null),u.default.instance.freePoolNode(p.DMDPoolName.AnimItem,e.node)})})},c([f({type:sp.Skeleton,tooltip:""})],e.prototype,"animItem",void 0),c([h],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DMD_BossCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f8a83Fe0VFPtr9149bjMwNc","DMD_BossCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f8a83Fe0VFPtr9149bjMwNc","DMD_BossCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("Utils"),d=i("DMD_Configs"),h=i("DMDGameEnumData"),f=i("DMD_DataMgr"),m=i("DMD_GameRoundBase"),g=cc._decorator,y=g.ccclass,v=g.property,_={0:{pos:cc.v3(168,d.DMData.rowH2),scal:cc.v3(d.DMData.row2,-d.DMData.row2)},1:{pos:cc.v3(112,d.DMData.rowH2),scal:cc.v3(d.DMData.row2,-d.DMData.row2)},2:{pos:cc.v3(136,d.DMData.rowH1),scal:cc.v3(d.DMData.row1,-d.DMData.row1)},3:{pos:cc.v3(92,d.DMData.rowH1),scal:cc.v3(d.DMData.row1,-d.DMData.row1)},4:{pos:cc.v3(-77,d.DMData.rowH2),scal:cc.v3(d.DMData.row2,-d.DMData.row2)},5:{pos:cc.v3(-129,d.DMData.rowH2),scal:cc.v3(d.DMData.row2,-d.DMData.row2)},6:{pos:cc.v3(-58,d.DMData.rowH1),scal:cc.v3(-d.DMData.row1,-d.DMData.row1)},7:{pos:cc.v3(-103,d.DMData.rowH1),scal:cc.v3(-d.DMData.row1,-d.DMData.row1)}},b={0:{action:["approach"]},1:{action:["gun1","reload","gun6"]},2:{action:["gun1","gun2","gun3","gun6"],camera:1},3:{action:["gun1","gun4","gun5","gun6"],camera:1}},B={1:{path:"demon_pistol"},2:{path:"demon_Goldenpistol"}},I={1001:{name:"magnifier",type:1},1004:{name:"medicine",type:1},1005:{name:"glove",type:1},1006:{name:null,type:2},1007:{name:null,type:4},1008:{name:null,type:3},1009:{name:"tongs",type:1},1010:{name:null,type:4},1011:{name:"syringe",type:1}},P={1:1004,2:1001,3:1006},C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bossAniam=null,e.bossAniamArr=[],e.maskIcon=null,e._bossType=1,e._animaType=-999,e._tempProp=[],e._playActionData=null,e._nowActionType=null,e._attackType=1,e.seletePlayRandm=70,e._attackPlay=0,e._isNowNextButtle=-1,e._usePropArr=[],e._useProp1008=!1,e}return s(e,t),e.prototype.onEnable=function(){var e=this;t.prototype.onEnable.call(this),p.EventMgr.getInstance().on(d.DMDEventName.GameBossLock,this,this.setLockStateAnima),this.bossAniam.setEventListener(function(t,o){var i;if("atk"==o.data.name){if(e.mapCtrl.UIGame.eventPlayerFire(),e.mapCtrl.getButtleHitNum()<=0)return;var n=t.animation.name,a="gun3"==n?cc.v3(-56,175):cc.v3(-66,226),r="gun3"==n?0:-80;e.mapCtrl.creatAnim({type:4,pos:a,parent:1,angle:r}),(null===(i=e._playActionData)||void 0===i?void 0:i.call)&&(e._playActionData.call(),e._playActionData.call=null)}})},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),p.EventMgr.getInstance().off(d.DMDEventName.GameBossLock,this,this.setLockStateAnima)},e.prototype.init=function(t){this.restProp(),this._hp=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.BossHP)[t],this._hpMax=this._hp,this._playerId=2,this._propPosArr=_,this.restHpUI(),this.loadBossIcon(t+1),this._bossType=t+1,1==this._bossType?this.seletePlayRandm=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.RushProbability):2==this._bossType?this.seletePlayRandm=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.CautionProbability):3==this._bossType&&(this.seletePlayRandm=50)},e.prototype.initMapCtrl=function(t){this.mapCtrl=t,this.loadGunSpine()},e.prototype.restProp=function(){this._propHave=[];for(var t=this._propParent.children;0<t.length;){var e=t[0];this.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e)}},e.prototype.loadGunSpine=function(t){void 0===t&&(t=1),this._animaType!=t&&(this._animaType=t,d.emDMDBundles.GameIcon,B[t].path,B[t].path,this.bossAniam.skeletonData=this.bossAniamArr[t-1],this.mapCtrl.startInit(),this.setLockStateAnima())},e.prototype.loadGunSpine2=function(){this._animaType=1,d.emDMDBundles.GameIcon,B[1].path,B[1].path,this.bossAniam.skeletonData=this.bossAniamArr[0],this.mapCtrl.init(),this.setLockStateAnima()},e.prototype.loadBossIcon=function(t){void 0===t&&(t=1);var e="boss"+t;this.mapCtrl.UIGame.loadIcon(this.maskIcon,e)},e.prototype.playHitAnim=function(){cc.tween(this.maskIcon.node).to(.2,{opacity:1}).to(.2,{opacity:255}).to(.2,{opacity:1}).to(.2,{opacity:255}).start()},e.prototype.playAnima=function(){var t=this;this.bossAniam.setCompleteListener(null);var e=this._playActionData.action,o=!0,i="";e.length>0&&(i=e[0],e.splice(0,1),o=!1);var n=this.mapCtrl.getTrueButtleNum();if("reload"==i){for(var a=0;a<n;a++)cc.tween(this.node).delay(.2*a).call(function(){l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.huandan)}).start();cc.tween(this.node).delay(.2*n).call(function(){l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.xuanzhuan)}).start()}var r=this.mapCtrl.getButtleHitNum();"gun3"!=i&&"gun5"!=i||this.mapCtrl.UIGame.eventGunFire(r>0),this.bossAniam.setCompleteListener(function(){var e;if(t.bossAniam.setCompleteListener(null),t._playActionData.action.length<=0)return t.mapCtrl.setGunSprActive(),(null===(e=t._playActionData)||void 0===e?void 0:e.call)&&(t._playActionData.call(),t._playActionData.call=null),void(t._nowActionType>=2&&t.mapCtrl.isCanJoin&&(0==r&&2==t._attackPlay?t.mapCtrl.showBossUsePropData2(function(){t.mapCtrl.endRound()}):t.mapCtrl.endRound()));t.playAnima()}),this.bossAniam.setAnimation(0,i,o)},e.prototype.setLockStateAnima=function(){this._isLock&&this.bossAniam.setAnimation(0,"handcuffs",!1)},e.prototype.extractProp=function(t){for(var e=this,o=0,i=0;i<8;i++)this._propHave[i]||o++;var n=Math.min(t,o);for(i=0;i<n;i++)cc.tween({}).delay(2*i).call(function(){var t=null;e._tempProp.length>0?(t=f.default.getInstance().extractProp2(e._tempProp[0]),e._tempProp.splice(0,1)):t=f.default.getInstance().extractProp(e._propHave),e.getProp(t)}).start();cc.tween({}).delay(2*n).call(function(){p.EventMgr.getInstance().emit(d.DMDEventName.GameFinishExtractProps)}).start()},e.prototype.getProp=function(t){for(var e=this,o=function(o){if(!i._propHave[o]){i._propHave[o]=t;var n=i.mapCtrl.UIGame.getPoolNode(d.DMDPoolName.PropItem);n.parent=i._propParent,n.active=!0,n.getComponent("DMD_PropItem").init(t);var a=i._propPosArr[o].pos,r=i._propPosArr[o].scal;return 1004==t.id&&(r.y=Math.abs(r.y)),cc.tween(n).to(0,{position:cc.v3(17,73),opacity:1,scale:.2}).to(.5,{opacity:255,scale:.5}).delay(1).to(.5,{position:a,scale:.2}).call(function(){n.setScale(r),n.parent=e._propParent,n.getComponent("DMD_PropItem").loadIcon2(t)}).start(),i._propHave[o].node=n,{value:!0}}},i=this,n=0;n<8;n++){var a=o(n);if("object"==typeof a)return a.value}return!1},e.prototype.playAction=function(t){this.mapCtrl.setGunSprActive(!1),this._playActionData={};var e=b[t.type].action,o=[];this._nowActionType=t.type;for(var i=0;i<e.length;i++){var n=e[i];o[i]=n}this._playActionData.action=o,this._playActionData.call=t.call,this.playAnima()},e.prototype.setActionState=function(t){var e=this;this.initData(),this._actionState=t,this._actionState&&(this._attackPlay=-1,this._usePropArr.length=0,this._isLock?(l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.shoukao2),this._isLock=!1,this.bossAniam.setAnimation(0,"idle",!1),this.scheduleOnce(function(){e.mapCtrl.endRound(!0)},1)):this.startGame(),console.log("\u73b0\u5728\u653b\u51fb\u7684\u662fBoss"))},e.prototype.initData=function(){var t=this.mapCtrl.getNowGunNum();null==this._isFuturePos[t]?this._isNowNextButtle=-1:this._isNowNextButtle=this._isFuturePos[t]},e.prototype.checkGunButtle=function(){if(0==this.mapCtrl.getEmptyButtle()){var t=this.mapCtrl.getNowGunNum();this._isFuturePos[t]=this.mapCtrl.checkGunButtleIsTrue(t)}},e.prototype.startGame=function(){if(this._usePropArr.length>0)this.playUsePropAnima();else{if(this._hp<=0)return this.diy(),void this.mapCtrl.endRound();var t=this.mapCtrl.getNowGunNum(),e=this.getIsProp(1005);if(e>=0&&this.mapCtrl.checkIsSneakProp(this._playerId))return this._usePropArr.push(this._propHave[e]),void this.useProp(e);if(this.checkGunButtle(),e=this.getIsProp(1001),5==t&&(this._isFuturePos[t]=this.mapCtrl.checkGunButtleIsTrue(t)),null==this._isFuturePos[t]){if(e>=0&&-1==this._isNowNextButtle)return this._usePropArr.push(this._propHave[e]),this.useProp(e),void this.playUsePropAnima()}else this._isNowNextButtle=this._isFuturePos[t];if(-1==this._isNowNextButtle&&(e=this.getIsProp(1007))>=0)return this._usePropArr.push(this._propHave[e]),this.useProp(e),void this.playUsePropAnima();for(;this._hp<this._hpMax;){if((e=this.getIsProp(1004))>=0){var o=this._propHave[e];return this.useProp(e),this._usePropArr.push(o),void this.playUsePropAnima()}if((e=this.getIsProp(1011))>=0)return o=this._propHave[e],this.useProp(e),this._usePropArr.push(o),void this.playUsePropAnima();break}if(this._isNowNextButtle<1&&5!=t){if((e=this.getIsProp(1009))>=0)return this._usePropArr.push(this._propHave[e]),this.useProp(e),void this.playUsePropAnima()}else if(e=this.getIsProp(1008),-1==this._isNowNextButtle&&e>=0&&!this._useProp1008&&e>=0)return this._useProp1008=!0,this._usePropArr.push(this._propHave[e]),this.useProp(e),void this.playUsePropAnima();if(!this.mapCtrl.getOtherStage(this._playerId)&&(e=this.getIsProp(1006))>=0)return this._usePropArr.push(this._propHave[e]),this.useProp(e),void this.playUsePropAnima();if(-1==this._attackPlay)if(-1!=this._isNowNextButtle)0==this._isNowNextButtle?this._attackPlay=2:this._attackPlay=1;else{var i=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.KnowProbability)[this._bossType-1],n=u.Utils.randomRang(1,101);n<=i?(this._isNowNextButtle=this.mapCtrl.getButtleHitNum()>0?1:0,0==this._isNowNextButtle?this._attackPlay=2:this._attackPlay=1):(n=u.Utils.randomRang(1,101))<this.seletePlayRandm?this._attackPlay=2:this._attackPlay=1}if((e=this.getIsProp(1010))>=0&&1==this._attackPlay&&!this.mapCtrl.getAddHitState())return this._usePropArr.push(this._propHave[e]),this.useProp(e),void this.playUsePropAnima();this.playUsePropAnima()}},e.prototype.playUsePropAnima=function(){var t=this;if(this._usePropArr.length>0){var e=this._usePropArr[0],o=I[e.id],i=o.type;this._usePropArr.splice(0,1),1==i?cc.tween(e.node).to(.5,{position:cc.v3(-36,95)}).call(function(){e.node&&t.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e.node),t.mapCtrl.creatAnim({type:3,animaName:o.name,callback:function(){1004==e.id||1011==e.id?t.mapCtrl.showBossUsePropData(e,t._useAddHpStr):t.mapCtrl.showBossUsePropData(e),t.restHpUI()}})}).start():2==i?cc.tween(e.node).to(.5,{position:cc.v3(0,-393)}).call(function(){e.node&&t.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e.node),1006==e&&l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.shoukao1),p.EventMgr.getInstance().emit(d.DMDEventName.GamePlayerLock),t.mapCtrl.showBossUsePropData(e)}).start():3==i?cc.tween(e.node).to(.5,{position:cc.v3(17,73),opacity:255,scale:.2}).call(function(){e.node.getComponent("DMD_PropItem").loadIcon3(),l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.kaiguan)}).delay(1).call(function(){e.node&&t.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e.node),t.mapCtrl.showBossUsePropData(e)}).start():4==i&&cc.tween(e.node).to(.5,{position:cc.v3(17,73),opacity:255,scale:.2}).to(.2,{opacity:1}).call(function(){e.node&&t.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e.node),t.mapCtrl.showBossUsePropData(e)}).start()}else{console.log("boss\u653b\u51fb\u8c01\uff1a",this._attackPlay);var n=1==this._attackPlay?2:3;this.playAction({type:n,call:function(){t.mapCtrl.startAttack(t._attackPlay)}})}},e.prototype.useProp1001=function(){this._isNowNextButtle=this.mapCtrl.checkGunButtleIsTrue(),console.log("\u67aa\u91cc\u7684\u4e0b\u4e00\u53d1\uff1a",this._isNowNextButtle)},e.prototype.useProp1004=function(){var t=u.Utils.randomRang(1,100);this._useAddHpStr="",t<=50?(this.setHp(2,!1),this._useAddHpStr="\u6076\u9b54\u4f7f\u7528\u8fc7\u671f\u836f\u54c1\uff0c\u8840\u91cf+2"):t<=100&&t>50&&(this.setHp(-1,!1),this._useAddHpStr="\u6076\u9b54\u4f7f\u7528\u8fc7\u671f\u836f\u54c1\uff0c\u8840\u91cf-1"),l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.chiyao)},e.prototype.useProp1011=function(){this._useAddHpStr="\u6076\u9b54\u4f7f\u7528\u9488\u7b52\uff0c\u8840\u91cf+1",l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.dazhen),this.setHp(1)},e.prototype.sneakProp=function(t){var e=this;void 0===t&&(t=null);for(var o=[],i=0;i<this._propHave.length;i++){var n=this._propHave[i];if(n&&1005!=n.id&&(o.push(n),o.length>=4))break}var a={arr:o,call:function(o){for(var i=0;i<e._propHave.length;i++){var n=e._propHave[i];if(n&&n.id==o.id){e.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e._propHave[i].node),e._propHave[i]=null;break}}t&&t(o)}};this.mapCtrl.UIGame.onOpenUIGlove(a)},e.prototype.useProp1005=function(){var t=this;if(this._usePropArr.length>0){var e=this._usePropArr[0],o=I[e.id],i=o.type;this._usePropArr.splice(0,1),1==i&&cc.tween(e.node).to(.5,{position:cc.v3(-36,95)}).call(function(){e.node&&t.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e.node),t.mapCtrl.creatAnim({type:3,animaName:o.name,callback:function(){if(1005==e.id){var o=t.mapCtrl.playerCtrl.sneakProp(P[t._bossType]);t.mapCtrl.showBossUsePropData(e),t.useProp2(o.id),t._usePropArr.push(o)}}})}).start()}},e.prototype.getIsProp=function(t){for(var e=-1,o=0;o<this._propHave.length;o++){var i=this._propHave[o];if(i&&i.id==t){e=o;break}}return e},e.prototype.beingBeaten=function(t,e){this._playerId==t&&this.setHp(-e,!1)},e.prototype.diy=function(){this._usePropArr.length>0||this.mapCtrl.passRound2()},c([v({type:sp.Skeleton,tooltip:""})],e.prototype,"bossAniam",void 0),c([v({type:sp.SkeletonData,tooltip:""})],e.prototype,"bossAniamArr",void 0),c([v({type:cc.Sprite,tooltip:""})],e.prototype,"maskIcon",void 0),c([y],e)}(m.default);a.default=C,cc._RF.pop(),cc._RF.pop()},{}],DMD_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"bd6164qtdpPaLEba0Ny/DLG","DMD_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"bd6164qtdpPaLEba0Ny/DLG","DMD_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.DMDAnimName=l.DMDGameObsTypeHp=l.DMDGameObsTypeNum=l.DMData=l.DMDPoolName=l.DMDEventName=l.DMD_AudioCF=l.DMD_AudioId=l.DMDConfig=l.DMD_UICF=l.emDMDBundles=l.DMD_UIID=void 0,function(t){t.UIGame="DMD_UIGame",t.UIResult="DMD_UIResult",t.UIGlove="DMD_UIGlove",t.UITips="DMD_UITips",t.UINextBoss="DMD_UINextBoss"}(a=l.DMD_UIID||(l.DMD_UIID={})),function(t){t.prefabs="dmd_prefabs",t.configs="dmd_configs",t.audios="dmd_audios",t.GameIcon="dmd_gameIcon"}(r=l.emDMDBundles||(l.emDMDBundles={})),l.DMD_UICF=((i={})[a.UIGame]={prefab:"ui/DMD_UIGame",name:"DMD_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIGlove]={prefab:"ui/DMD_UIGlove",name:"DMD_UIGlove",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UITips]={prefab:"ui/DMD_UITips",name:"DMD_UITips",showTop:!0,showMult:!0,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/DMD_UIResult",name:"DMD_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UINextBoss]={prefab:"ui/DMD_UINextBoss",name:"DMD_UINextBoss",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),l.DMDConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},function(t){t.bgm="BGM",t.chiyao="chiyao",t.dazhen="dazhen",t.fuhuo="fuhuo",t.huanBoss="huanBoss",t.huandan="huandan",t.jichui="jichui",t.jinsezuolun="jinsezuolun",t.kaiguan="kaiguan",t.kaiqiang="kaiqiang",t.kouxue="kouxue",t.kongqiang="kongqiang",t.qianzi="qianzi",t.shibai="shibai",t.shoukao1="shoukao1",t.shoukao2="shoukao2",t.xuanzhuan="xuanzhuan",t.zhitiao="zhitiao"}(s=l.DMD_AudioId||(l.DMD_AudioId={})),l.DMD_AudioCF=((n={})[s.bgm]={path:"BGM",bundle:r.audios},n[s.chiyao]={path:"chiyao",bundle:r.audios},n[s.dazhen]={path:"dazhen",bundle:r.audios},n[s.fuhuo]={path:"fuhuo",bundle:r.audios},n[s.huandan]={path:"huandan",bundle:r.audios},n[s.jichui]={path:"jichui",bundle:r.audios},n[s.jinsezuolun]={path:"jinsezuolun",bundle:r.audios},n[s.kaiguan]={path:"kaiguan",bundle:r.audios},n[s.kaiqiang]={path:"kaiqiang",bundle:r.audios},n[s.kongqiang]={path:"kongqiang",bundle:r.audios},n[s.kouxue]={path:"kouxue",bundle:r.audios},n[s.shibai]={path:"shibai",bundle:r.audios},n[s.shoukao1]={path:"shoukao1",bundle:r.audios},n[s.shoukao2]={path:"shoukao2",bundle:r.audios},n[s.xuanzhuan]={path:"xuanzhuan",bundle:r.audios},n[s.zhitiao]={path:"zhitiao",bundle:r.audios},n[s.qianzi]={path:"qianzi",bundle:r.audios},n[s.huanBoss]={path:"huanBoss",bundle:r.audios},n),function(t){t[t.GameUpdata="DMDG_GameUpdata"]="GameUpdata",t[t.GameJoinNextStage="DMDG_GameJoinNextStage"]="GameJoinNextStage",t[t.GameFinishExtractProps="DMDG_GameFinishExtractProps"]="GameFinishExtractProps",t[t.GameRefreshPropUI="DMDG_GameRefreshPropUI"]="GameRefreshPropUI",t[t.GameButtleHit="DMDG_GameButtleHit"]="GameButtleHit",t[t.GameWatchHp="DMDG_GameWatchHp"]="GameWatchHp",t[t.GameRestHp="DMDG_GameRestHp"]="GameRestHp",t[t.GameTrueButtle="DMDG_GameTrueButtle"]="GameTrueButtle",t[t.GameBossLock="DMDG_GameBossLock"]="GameBossLock",t[t.GamePlayerLock="DMDG_GamePlayerLock"]="GamePlayerLock",t[t.GameGunFire="DMDG_GameGunFire"]="GameGunFire",t[t.GameWacthButtle="DMDG_GameWacthButtle"]="GameWacthButtle"}(l.DMDEventName||(l.DMDEventName={})),function(t){t.PropItem="DMDPropItem",t.AnimItem="DMDAnimItem"}(l.DMDPoolName||(l.DMDPoolName={})),function(t){t[t.row1=.4]="row1",t[t.row2=.5]="row2",t[t.row3=.7]="row3",t[t.row4=1]="row4",t[t.rowH1=60]="rowH1",t[t.rowH2=25]="rowH2",t[t.rowH3=-91]="rowH3",t[t.rowH4=-205]="rowH4"}(l.DMData||(l.DMData={})),l.DMDGameObsTypeNum={1:5,2:5,3:2,4:1,5:5,6:1,7:1},function(t){t[t.ord=1]="ord",t[t.obs=2]="obs",t[t.bomb=3]="bomb",t[t.box=4]="box",t[t.grass=5]="grass",t[t.back=6]="back",t[t.light=7]="light"}(l.DMDGameObsTypeHp||(l.DMDGameObsTypeHp={}));var p=function(){function t(){}return t.Attack="atk",t.Die="die",t.Hit="hit",t.Idle="idle",t.Run="run",t.Up="up",t}();l.DMDAnimName=p,cc._RF.pop(),cc._RF.pop()},{}],DMD_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"5aec05BUgRKMacT/arf5jv3","DMD_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"5aec05BUgRKMacT/arf5jv3","DMD_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("Utils"),d=i("DMD_Configs"),h=cc._decorator,f=h.ccclass,m=(h.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){var e,o;if(!window||!window.location)return null;var i=null===(o=null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.search)||void 0===o?void 0:o.replace("?","");if(!i||""===i)return null;for(var n=i.split("&"),a=0;a<n.length;a++){var r=n[a].split("=");if(decodeURIComponent(r[0])===t)return decodeURIComponent(r[1])}return null},t.prototype.load=function(t){var e=this,o=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var i=this.getUrlParam("isRemote");i&&"1"==i&&(o=!0)}o?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"penglang/BBD_soilder/configs",fileName:"GameJsonCfg.json"},function(o,i){if(o&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(e.data=JSON.parse(n.data),console.log(e.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(d.emDMDBundles.configs,"GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.GearParameterCfg[t]?this.data.GearParameterCfg[t].value:0},t.prototype.extractProp=function(t){var e=this._getSeleteBuff(t);return{id:e.id,Name:e.Name,value:e.value,enumDesc:e.enumDesc,DemonenumDesc:e.DemonenumDesc}},t.prototype.extractProp2=function(t){var e=this.data.ToolCfg.find(function(e){return e.id==t});return{id:e.id,Name:e.Name,value:e.value,enumDesc:e.enumDesc,DemonenumDesc:e.DemonenumDesc}},t.prototype._getSeleteBuff=function(t){for(var e=this.data.ToolCfg,o=[],i=0,n=[],a=t.find(function(t){return 1007==(null==t?void 0:t.id)}),r=t.find(function(t){return 1005==(null==t?void 0:t.id)}),s=0;s<e.length;s++){var c=e[s];1007==c.id&&a||1005==c.id&&r||(o.push(c),i+=c.value,n.push(i))}for(var l=u.Utils.randomRang(0,i),p=0;p<n.length;p++)if(l<n[p])return o[p];return console.log("buff\u968f\u673a\u6709\u95ee\u9898"),o[0]},e=r([f],t)}());a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DMD_GameRoundBase:[function(t,e,o){"use strict";cc._RF.push(e,"6fa81G641pHfY9RFUc5C+7t","DMD_GameRoundBase");var i=t,n=e,a=o;cc._RF.push(n,"6fa81G641pHfY9RFUc5C+7t","DMD_GameRoundBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("Utils"),d=i("DMD_Configs"),h=i("DMD_DataMgr"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpNode=null,e._playerId=0,e._hp=0,e._propHave=[],e._hpMax=0,e._isLock=!1,e.mapCtrl=null,e._propPosArr=null,e._propParent=null,e._actionState=!1,e._useAddHpStr=null,e._isFuturePos=[null,null,null,null,null,null],e}return s(e,t),e.prototype.onLoad=function(){this._propParent=this.node.getChildByName("prop")},e.prototype.onEnable=function(){p.EventMgr.getInstance().on(d.DMDEventName.GameRefreshPropUI,this,this.restPropUI),p.EventMgr.getInstance().on(d.DMDEventName.GameButtleHit,this,this.beingBeaten),p.EventMgr.getInstance().on(d.DMDEventName.GameRestHp,this,this.restHpUI)},e.prototype.onDisable=function(){p.EventMgr.getInstance().off(d.DMDEventName.GameRefreshPropUI,this,this.restPropUI),p.EventMgr.getInstance().off(d.DMDEventName.GameButtleHit,this,this.beingBeaten),p.EventMgr.getInstance().off(d.DMDEventName.GameRestHp,this,this.restHpUI)},e.prototype.init=function(){},e.prototype.initMapCtrl=function(t){this.mapCtrl=t},e.prototype.setActionState=function(t){t&&console.log("\u73b0\u5728\u653b\u51fb\u7684\u4e8b:",this._playerId),this._actionState=t,this._actionState&&console.log("\u73b0\u5728\u653b\u51fb\u7684\u4e8b:")},e.prototype.restHpUI=function(){for(var t=this.hpNode.children[1].children,e=0;e<t.length;e++)t[e].active=e<this._hp;var o=this.hpNode.children[0].children;for(e=0;e<o.length;e++)o[e].active=e<=this._hpMax-1},e.prototype.setLockState=function(t){void 0===t&&(t=!0),this._isLock=t},e.prototype.getLockState=function(){return this._isLock},e.prototype.extractProp=function(t){for(var e=0;e<t;e++)if(this._propHave.length<8){var o=h.default.getInstance().extractProp(this._propHave);this.getProp(o)}this.restPropUI(),p.EventMgr.getInstance().emit(d.DMDEventName.GameFinishExtractProps)},e.prototype.getPropNum=function(){for(var t=0;t<this._propHave.length;t++)this._propHave[t]&&t++;return 0},e.prototype.getProp=function(t){for(var e=0;e<8;e++)if(!this._propHave[e])return void(this._propHave[e]=t)},e.prototype.restPropUI=function(){for(var t=0,e=0;e<8;e++){var o=this._propHave[e];if(o){var i=null;this._propParent.children.length<=t?(i=this.mapCtrl.UIGame.getPoolNode(d.DMDPoolName.PropItem)).parent=this._propParent:i=this._propParent.children[t],i.active=!0,i.setPosition(this._propPosArr[e].pos),i.setScale(this._propPosArr[e].scal),i.getComponent("DMD_PropItem").init(o,!0),t++}}for(var n=t;n<this._propParent.children.length;n++)this._propParent.children[n].active=!1},e.prototype.useProp=function(t){if(!this._actionState)return!1;if(!this.mapCtrl.getIsAttackState(this._playerId))return!1;var e=this._propHave[t],o=e.id,i=this.useProp2(o);return console.log("\u4f7f\u7528\u9053\u5177\uff1a",e.Name),i&&(this._propHave[t]=null),i},e.prototype.useProp2=function(t){if(1001==t)this.useProp1001();else if(1002==t)this.useProp1002();else if(1003==t)this.useProp1003();else if(1004==t)this.useProp1004();else if(1005==t){if(!this.mapCtrl.checkIsSneakProp(this._playerId))return console.log("\u5bf9\u65b9\u6ca1\u6709\u9053\u5177"),!1;this.useProp1005()}else if(1006==t)this.mapCtrl.getOtherStage(this._playerId),this.useProp1006();else if(1007==t){if(!this.checkIsUseProp1007())return console.log("\u6700\u540e\u4e00\u9897\u5b50\u5f39\u4e0d\u80fd\u7528"),!1;this.useProp1007()}else if(1008==t)this.useProp1008();else if(1009==t){if(this.mapCtrl.getNowGunNum()>=5)return!1;this.useProp1009()}else if(1010==t){if(this.mapCtrl.getAddHitState())return console.log("\u5df2\u7ecf\u52a0\u4f24\u5bb3\u4e86"),!1;this.useProp1010()}else if(1011==t){if(this._hp>=this._hpMax)return!1;this.useProp1011()}return!0},e.prototype.checkIsSneakProp=function(){for(var t=!1,e=0;e<this._propHave.length;e++){var o=this._propHave[e];if(o&&1005!=o.id){t=!0;break}}return t},e.prototype.sneakProp=function(){for(var t=u.Utils.randomRang(0,this._propHave.length);!this._propHave[t]||1005==this._propHave[t].id;)t=u.Utils.randomRang(0,this._propHave.length);var e=this._propHave[t];return e.node&&this.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e.node),this._propHave.splice(t,1),e},e.prototype.useProp1001=function(){var t=this.mapCtrl.checkGunButtleIsTrue();console.log("\u67aa\u91cc\u7684\u4e0b\u4e00\u53d1\uff1a",t)},e.prototype.useProp1002=function(){this.mapCtrl.setGunButtleIsTrue()},e.prototype.useProp1003=function(){this.mapCtrl.setGunButtleIsFalse()},e.prototype.useProp1004=function(){var t=u.Utils.randomRang(1,100);this._useAddHpStr="",t<=50?(this.setHp(2,!1),this._useAddHpStr="\u4f7f\u7528\u8fc7\u671f\u836f\u54c1\uff0c\u8840\u91cf+2"):t<=100&&t>50&&(this.setHp(-1,!1),this._useAddHpStr="\u4f7f\u7528\u8fc7\u671f\u836f\u54c1\uff0c\u8840\u91cf-1"),l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.chiyao)},e.prototype.useProp1005=function(){var t=this.mapCtrl.getOtherProp(this._playerId);console.log("\u5077\u5230:",t),this.useProp2(t.id)},e.prototype.useProp1006=function(){this.mapCtrl.lockOtherStage(this._playerId)},e.prototype.checkIsUseProp1007=function(){if(this.mapCtrl.checkIsUseProp1007())return!1;for(var t=this.mapCtrl.getNowGunNum()+1;t<this._isFuturePos.length;t++)if(null==this._isFuturePos[t])return!0;return!1},e.prototype.initFuturePos=function(){this._isFuturePos=[null,null,null,null,null,null]},e.prototype.useProp1007=function(){var t=this.mapCtrl.tipOtherButtle(this._isFuturePos);this._isFuturePos[t[0]]=t[1],console.log("\u67aa\u91cc\u4f4d\u7f6e\u7684\u5b50\u5f39\uff1a",t),l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.zhitiao)},e.prototype.useProp1008=function(){this.mapCtrl.nowButtleChange()},e.prototype.useProp1009=function(){this.mapCtrl.passButtle()},e.prototype.useProp1010=function(){this.mapCtrl.addButtleHit()},e.prototype.useProp1011=function(){this._useAddHpStr="\u4f7f\u7528\u9488\u7b52\uff0c\u8840\u91cf+1",l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.dazhen),this.setHp(1)},e.prototype.startAttack=function(){},e.prototype.setHp=function(t,e){void 0===e&&(e=!0),this._hp+=t,this._hp>this._hpMax&&(this._hp=this._hpMax),this._hp<=0&&(console.log("\u6b7b\u4e86"),this.diy()),e&&this.restHpUI()},e.prototype.diy=function(){},e.prototype.beingBeaten=function(){},c([g({type:cc.Node,tooltip:""})],e.prototype,"hpNode",void 0),c([m],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DMD_MapCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"d8featdr7ZHOKOyZnhozyb+","DMD_MapCtrl");var i=t,n=e,a=o;cc._RF.push(n,"d8featdr7ZHOKOyZnhozyb+","DMD_MapCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("Utils"),d=i("DMD_Configs"),h=i("DMDGameEnumData"),f=i("DMD_DataMgr"),m=i("DMD_UIGame"),g=i("DMD_AnimaItem"),y=i("DMD_BossCtrl"),v=i("DMD_PlayerCtrl"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerNode=null,e.bossNode=null,e.seleteNode=null,e.tipLab=null,e.tipLab2=null,e.buttleAnim=null,e.boxAnim=null,e.boxAnim2=null,e.gunSprArr=[],e.gunSpr=null,e.propDescNode=null,e.propDescNode2=null,e.propBossNode=null,e.propBossNode2=null,e.tip2Node=null,e.tip3Node=null,e.playerCtrl=null,e.bossCtrl=null,e._initState=!1,e._round=0,e._stage=0,e._passNextBoss=!1,e._roundAttack=1,e._gunNum=0,e._bulletArr=[0,0,0,0,0,0],e._trueButtleNum=0,e._tempNum=1,e._addHitState=!1,e._extPropNum=0,e._startAck=!1,e.isCanJoin=!1,e._BossEmptybulletsCall=null,e}return s(e,t),e.prototype.onLoad=function(){this.playerCtrl=this.playerNode.getComponent(v.default),this.bossCtrl=this.bossNode.getComponent(y.default)},e.prototype.onEnable=function(){p.EventMgr.getInstance().on(d.DMDEventName.GameJoinNextStage,this,this.nextStage),p.EventMgr.getInstance().on(d.DMDEventName.GameFinishExtractProps,this,this.finishExtractProps)},e.prototype.onDisable=function(){p.EventMgr.getInstance().off(d.DMDEventName.GameJoinNextStage,this,this.nextStage),p.EventMgr.getInstance().off(d.DMDEventName.GameFinishExtractProps,this,this.finishExtractProps)},e.prototype.start=function(){this.playerCtrl.initMapCtrl(this),this.bossCtrl.initMapCtrl(this)},e.prototype.startInit=function(){this._initState||(this._initState=!0,this.init())},e.prototype.creatAnim=function(t){var e=this.node.getChildByName("anima"),o=m.default.instance.getPoolNode(d.DMDPoolName.AnimItem);o.parent=e,t.pos&&o.setPosition(t.pos),t.parent&&2==t.parent&&(o.parent=this.node.getChildByName("anima2")),o.getComponent(g.default).init(t)},e.prototype.setUIGame=function(t){this.UIGame=t},e.prototype.passRound=function(){this._round++,this._round>=3?this.UIGame.openUI(d.DMD_UIID.UIResult,!0):(l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.huanBoss),this.UIGame.onOpenUINextBoss())},e.prototype.passRound2=function(){this._passNextBoss=!0},e.prototype.getRound=function(){return this._round},e.prototype.init=function(){this.startRound()},e.prototype.startRound=function(){this._roundAttack=1,this._stage=0,this._passNextBoss=!1,this._bulletArr=[0,0,0,0,0,0],this.playerCtrl.init(this._round),this.bossCtrl.init(this._round),this.bossCtrl.loadGunSpine(1),this.playerCtrl.loadGunSpine(1),this.startStage()},e.prototype.getIsAttackState=function(t){return 3==this._stage&&t==this._roundAttack},e.prototype.startStage=function(){var t=this;if(this.gunSpr.spriteFrame=this.gunSprArr[0],0==this._stage)this.setGunSprActive(),this.bossCtrl.playAction({type:0,call:function(){t.UIGame.eventWatchHp2(function(){p.EventMgr.getInstance().emit(d.DMDEventName.GameJoinNextStage)})}});else if(1==this._stage){if(this._bulletArr.indexOf(1)>=0)return void p.EventMgr.getInstance().emit(d.DMDEventName.GameJoinNextStage,2);this.tip3Node.active=!0,cc.Tween.stopAllByTarget(this.tip3Node),cc.tween(this.tip3Node).delay(2).call(function(){t.tip3Node.active=!1,t.restGunBullet()}).start()}else if(2==this._stage)this.setGunSprActive(!0),this.boxAnim.node.active=!0,this.boxAnim.setAnimation(0,"open",!1),this.boxAnim.setCompleteListener(null),this.boxAnim.setCompleteListener(function(){t.boxAnim.setCompleteListener(null),t.extractProps()}),this.boxAnim2.node.active=!0,this.boxAnim2.setAnimation(0,"open",!1);else if(3==this._stage){this.setGunSprActive(),this.UIGame.onOpenTipNode(),this._addHitState=!1;var e=1==this._roundAttack?"\u4f60\u7684\u56de\u5408!":"Boss\u7684\u56de\u5408!";this.tipLab.string=e,this._startAck=!1,this.playerCtrl.setActionState(1==this._roundAttack),this.bossCtrl.setActionState(2==this._roundAttack)}},e.prototype.nextStage=function(t){void 0===t&&(t=1),this._stage+=t,this.startStage()},e.prototype.restGunBullet=function(){var t=this;this._gunNum=0;var e=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.MinAmmoNum),o=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.MaxAmmoNum),i=u.Utils.randomRang(e,o+1);this._trueButtleNum=i;for(var n=0;n<i;n++){for(var a=u.Utils.randomRang(0,this._bulletArr.length);1==this._bulletArr[a];)a=u.Utils.randomRang(0,this._bulletArr.length);this._bulletArr[a]=1}console.log("\u67aa\u91cc\u7684\u5b50\u5f39",this._bulletArr),this.playerCtrl.setLockState(!1),this.bossCtrl.setLockState(!1),this.playerCtrl.initFuturePos(),this.bossCtrl.initFuturePos(),this.buttleAnim.node.active=!0,this.buttleAnim.setAnimation(0,i+"-1",!1),this.buttleAnim.setCompleteListener(null),this.buttleAnim.setCompleteListener(function(){t.buttleAnim.setCompleteListener(null),cc.tween(t.buttleAnim).delay(2).call(function(){t.buttleAnim.setAnimation(0,i+"-2",!1),t.buttleAnim.setCompleteListener(function(){t.buttleAnim.node.active=!1,t.buttleAnim.setCompleteListener(null);var e=t._trueButtleNum+"\u9897\u5b9e\u5f39";t.UIGame.showTips(e),t.showTipLab(),t.bossCtrl.playAction({type:1,call:function(){p.EventMgr.getInstance().emit(d.DMDEventName.GameJoinNextStage)}})})}).start()})},e.prototype.getTrueButtleNum=function(){return this._trueButtleNum},e.prototype.checkGunButtleIsTrue=function(t){return void 0===t&&(t=null),t||(t=this._gunNum),this._bulletArr[t]},e.prototype.setGunButtleIsTrue=function(t){void 0===t&&(t=null),t||(t=this._gunNum),this._bulletArr[t]=1},e.prototype.setGunButtleIsFalse=function(t){void 0===t&&(t=null),t||(t=this._gunNum),this._bulletArr[t]=0},e.prototype.checkIsSneakProp=function(t){var e=1==t?2:1;return this.getPlayerSp(e).checkIsSneakProp()},e.prototype.getOtherProp=function(t){var e=1==t?2:1;return this.getPlayerSp(e).sneakProp()},e.prototype.lockOtherStage=function(t){var e=1==t?2:1;this.getPlayerSp(e).setLockState()},e.prototype.getOtherStage=function(t){var e=1==t?2:1;return this.getPlayerSp(e).getLockState()},e.prototype.getNowGunNum=function(){return this._gunNum},e.prototype.checkIsUseProp1007=function(){return this._gunNum>=5},e.prototype.tipOtherButtle=function(){var t=u.Utils.randomRang(this._gunNum+1,6);return[t,this.checkGunButtleIsTrue(t)]},e.prototype.nowButtleChange=function(){this._bulletArr[this._gunNum]=0==this._bulletArr[this._gunNum]?1:0},e.prototype.passButtle=function(){this._bulletArr[this._gunNum]=0,this._gunNum++},e.prototype.passButtle2=function(){var t=this._bulletArr[this._gunNum];return this._bulletArr[this._gunNum]=0,this._gunNum++,t},e.prototype.getAddHitState=function(){return this._addHitState},e.prototype.addButtleHit=function(){l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.jinsezuolun),this.gunSpr.spriteFrame=this.gunSprArr[1],this._addHitState=!0,this.bossCtrl.loadGunSpine(2),this.playerCtrl.loadGunSpine(2)},e.prototype.setGunSprActive=function(t){void 0===t&&(t=!0),this.gunSpr.node.active=t},e.prototype.getButtleHitNum=function(){var t=1==this._bulletArr[this._gunNum]?1:0;return this._addHitState&&(t*=2),t},e.prototype.getPlayerSp=function(t){return 1==t?this.playerCtrl:this.bossCtrl},e.prototype.extractProps=function(){this._extPropNum=0;var t=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.MinToolNum),e=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.MaxToolNum),o=u.Utils.randomRang(t,e+1);this.playerCtrl.extractProp(o),this.bossCtrl.extractProp(o)},e.prototype.finishExtractProps=function(){var t=this;this._extPropNum++,this._extPropNum>=2&&(this.showPropDesc(),this.boxAnim.setAnimation(0,"close",!1),this.boxAnim.setCompleteListener(null),this.boxAnim.setCompleteListener(function(){t.boxAnim.setCompleteListener(null),t.boxAnim.node.active=!1,t.boxAnim2.node.active=!1,p.EventMgr.getInstance().emit(d.DMDEventName.GameJoinNextStage)}),this.boxAnim2.setAnimation(0,"close",!1))},e.prototype.onClickSeletePlay=function(){var t=this;3==this._stage&&1==this._roundAttack&&(this._startAck=!0,this.playerCtrl.playAction({type:1,call:function(){t.playerCtrl.setTipType(2),t.seleteNode.active=!0}}))},e.prototype.onClickSeletePlay2=function(t,e){var o=this;this.seleteNode.active=!1;var i=parseInt(e);if(3!=i){var n=1==i?3:2;this.playerCtrl.playAction({type:n,call:function(){0==o.getButtleHitNum()&&1==i&&(o.tip2Node.active=!0,cc.Tween.stopAllByTarget(o.tip2Node),cc.tween(o.tip2Node).delay(2).call(function(){o.tip2Node.active=!1}).start()),o.startAttack(i),o.playerCtrl.setTipType()}})}else this.playerCtrl.playAction({type:4,call:function(){o.playerCtrl.setTipType(1),o.setGunSprActive(),o._startAck=!1}})},e.prototype.startAttack=function(t){if(3==this._stage){this.playerCtrl.setTipType();var e=this.getButtleHitNum();p.EventMgr.getInstance().emit(d.DMDEventName.GameButtleHit,t,e),(t!=this._roundAttack||e>0)&&(this._roundAttack=1==this._roundAttack?2:1),this.isCanJoin=!1,e>0?(this._trueButtleNum--,console.log("\u4f24\u5bb3\uff1a",e),1==t?(this.creatAnim({type:1}),l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.fuhuo)):(this.bossCtrl.playHitAnim(),this.creatAnim({type:2,pos:cc.v3(0,216)})),p.EventMgr.getInstance().emit(d.DMDEventName.GameTrueButtle)):this.isCanJoin=!0,this.passButtle(),this.showTipLab()}},e.prototype.showTipLab=function(){for(var t=0,e=0,o=this._gunNum;o<6;o++)1==this._bulletArr[o]?t++:e++;this.tipLab2.string="<b>\u5269\u4f59\u5b50\u5f39 \u5b9e\u5f39: <color=#FF0000>"+t+"</c> \u7a7a\uff1a<color=#00ff00>"+e+"</c></b>"},e.prototype.getEmptyButtle=function(){for(var t=0,e=this._gunNum;e<6;e++)1==this._bulletArr[e]||t++;return t},e.prototype.endRound=function(t){void 0===t&&(t=!1),this._passNextBoss?this.passRound():(t&&(this._roundAttack=1==this._roundAttack?2:1),this._stage=1,this._addHitState=!1,this.bossCtrl.loadGunSpine(1),this.playerCtrl.loadGunSpine(1),this.startStage())},e.prototype.showPropDesc=function(t){void 0===t&&(t=null),null!=t?(this.propDescNode.active=!0,this.propDescNode.getChildByName("labDesc").getComponent(cc.RichText).string=t.enumDesc):this.propDescNode.active=!1},e.prototype.showPropDesc2=function(t){void 0===t&&(t=null);var e=cc.find("icon",this.propDescNode2).getComponent(cc.Sprite);if(null==t)return e.spriteFrame=null,void(this.propDescNode2.active=!1);this.propDescNode2.active=!0;var o=cc.find("title",this.propDescNode2).getComponent(cc.Label),i=cc.find("desc",this.propDescNode2).getComponent(cc.RichText);o.string=t.Name,i.string=u.Utils.StringFormat("<b>{0}</b>",t.enumDesc);var n=t.id;m.default.instance.loadIcon2(e,n)},e.prototype.showBossUsePropData=function(t,e){void 0===e&&(e=null),cc.find("labDesc",this.propBossNode).getComponent(cc.Label).string=e||t.DemonenumDesc,this.propBossNode.active=!0},e.prototype.showBossUsePropData2=function(t){this._BossEmptybulletsCall=t,this.propBossNode2.active=!0},e.prototype.onClickBossNullButtleTip=function(){this._BossEmptybulletsCall&&this._BossEmptybulletsCall(),this.propBossNode2.active=!1},e.prototype.onClickCloseBossUI=function(){this.propBossNode.active=!1,this.bossCtrl.startGame()},c([B({type:cc.Node,tooltip:""})],e.prototype,"playerNode",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"bossNode",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"seleteNode",void 0),c([B({type:cc.Label,tooltip:""})],e.prototype,"tipLab",void 0),c([B({type:cc.RichText,tooltip:""})],e.prototype,"tipLab2",void 0),c([B({type:sp.Skeleton,tooltip:""})],e.prototype,"buttleAnim",void 0),c([B({type:sp.Skeleton,tooltip:""})],e.prototype,"boxAnim",void 0),c([B({type:sp.Skeleton,tooltip:""})],e.prototype,"boxAnim2",void 0),c([B({type:cc.SpriteFrame,tooltip:""})],e.prototype,"gunSprArr",void 0),c([B({type:cc.Sprite,tooltip:""})],e.prototype,"gunSpr",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"propDescNode",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"propDescNode2",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"propBossNode",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"propBossNode2",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"tip2Node",void 0),c([B({type:cc.Node,tooltip:""})],e.prototype,"tip3Node",void 0),c([b],e)}(cc.Component);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],DMD_PlayerCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"2bd6efAvGJE6r3vRwwpAI3n","DMD_PlayerCtrl");var i=t,n=e,a=o;cc._RF.push(n,"2bd6efAvGJE6r3vRwwpAI3n","DMD_PlayerCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("Utils"),d=i("DMD_Configs"),h=i("DMDGameEnumData"),f=i("DMD_DataMgr"),m=i("DMD_GameRoundBase"),g=cc._decorator,y=g.ccclass,v=g.property,_={0:{pos:cc.v3(-260,d.DMData.rowH3),scal:cc.v3(d.DMData.row3,d.DMData.row3)},1:{pos:cc.v3(-173,d.DMData.rowH3),scal:cc.v3(d.DMData.row3,d.DMData.row3)},2:{pos:cc.v3(-330,d.DMData.rowH4),scal:cc.v3(d.DMData.row4,d.DMData.row4)},3:{pos:cc.v3(-230,d.DMData.rowH4),scal:cc.v3(d.DMData.row4,d.DMData.row4)},4:{pos:cc.v3(123,d.DMData.rowH3),scal:cc.v3(-d.DMData.row3,d.DMData.row3)},5:{pos:cc.v3(199,d.DMData.rowH3),scal:cc.v3(-d.DMData.row3,d.DMData.row3)},6:{pos:cc.v3(159,d.DMData.rowH4),scal:cc.v3(-d.DMData.row4,d.DMData.row4)},7:{pos:cc.v3(247,d.DMData.rowH4),scal:cc.v3(-d.DMData.row4,d.DMData.row4)}},b={1:{path:"demon_gun"},2:{path:"demon_goldengun"}},B={1:{action:["gun1","gun2"],camera:0},2:{action:["gun3","gun4","gun5","gun6","gun10"],camera:1},3:{action:["gun7","gun8","gun9","gun10"],camera:2},4:{action:["gun10"],camera:0}},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerAniam=null,e.propParent2=null,e.lockNode=null,e.tipNode=null,e.seleteCall=null,e._playActionData=null,e._nowActionType=null,e._tempProp=[],e._seleteId=-1,e._propCool=!1,e}return s(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.playerAniam.node.active=!1,this.playerAniam.setEventListener(function(t,o){var i;if("atk"==o.data.name){if(e.mapCtrl.UIGame.eventPlayerFire(),e.mapCtrl.getButtleHitNum()<=0)return;var n=t.animation.name,a="gun6"==n?cc.v3(192,92):cc.v3(-116,-432),r="gun6"==n?cc.v3(2,1.5):cc.v3(2.5,2);e.mapCtrl.creatAnim({type:4,pos:a,parent:"gun6"==n?2:1,scal:r}),(null===(i=e._playActionData)||void 0===i?void 0:i.call)&&(e._playActionData.call(),e._playActionData.call=null)}})},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),p.EventMgr.getInstance().on(d.DMDEventName.GamePlayerLock,this,this.setLockStateAnima)},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),p.EventMgr.getInstance().off(d.DMDEventName.GamePlayerLock,this,this.setLockStateAnima)},e.prototype.setTipType=function(t){void 0===t&&(t=0),this.tipNode.children[0].active=1==t,this.tipNode.children[1].active=2==t},e.prototype.setLockStateAnima=function(){this.lockNode.active=!0},e.prototype.init=function(t){this.restProp(),this.lockNode.active=!1,this._hp=f.default.getInstance().getParam(h.enumDMDGearParameterCfg.PlayerHP)[t],this._hpMax=this._hp,this._playerId=1,this._propPosArr=_,this.restHpUI()},e.prototype.loadGunSpine=function(t){var e=this;void 0===t&&(t=1);var o=d.emDMDBundles.GameIcon,i="anim/"+b[t].path+"/"+b[t].path;this.mapCtrl.UIGame.loadResSkeleton(this.node,o,i,function(t){e.playerAniam.skeletonData=t})},e.prototype.initMapCtrl=function(t){this.mapCtrl=t,this.loadGunSpine()},e.prototype.restProp=function(){this._propHave=[];for(var t=this._propParent.children;0<t.length;){var e=t[0];this.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,e)}},e.prototype.setLockState=function(t){void 0===t&&(t=!0),this._isLock=t,t||(this.lockNode.active=!1)},e.prototype.setActionState=function(t){var e=this;t&&console.log("\u73b0\u5728\u653b\u51fb\u7684\u4e8b:",this._playerId),this._actionState=t,this.setSeleteId(),this.setTipType(),this._actionState&&(this._isLock?(this.mapCtrl.UIGame.showTips("\u4e0d\u53ef\u884c\u52a8"),this._isLock=!1,this.lockNode.active=!1,l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.shoukao2),this.scheduleOnce(function(){e.mapCtrl.endRound(!0)},1)):this.setTipType(1))},e.prototype.setSeleteId=function(t){if(void 0===t&&(t=null),null==t)return this.mapCtrl.showPropDesc2(),void(this._seleteId=-1);this._seleteId=t,this.mapCtrl.showPropDesc2(this._propHave[t])},e.prototype.onClickUseProp=function(t,e){"1"==e?(this.seleteCall&&this.seleteCall(),this.seleteCall=null):(this.mapCtrl.showPropDesc2(),this._seleteId=-1)},e.prototype.playAction=function(t){this.setSeleteId(),this.mapCtrl.setGunSprActive(!1),this._playActionData={},this.playerAniam.node.active=!0,this._playActionData.type=t.type;var e=B[t.type].action;this._nowActionType=t.type,B[t.type].camera>0&&this.mapCtrl.UIGame.eventPlayerFire(B[t.type].camera);for(var o=[],i=0;i<e.length;i++){var n=e[i];o[i]=n}this._playActionData.action=o,this._playActionData.call=t.call,this.playAnima()},e.prototype.playAnima=function(){var t=this;this.playerAniam.setCompleteListener(null);var e=this._playActionData.action,o="";if(e.length>0&&(o=e[0],e.splice(0,1)),"gun5"==o||"gun8"==o){var i=this.mapCtrl.getButtleHitNum();this.mapCtrl.UIGame.eventGunFire(i>0)}this.playerAniam.setAnimation(0,o,!1),this.playerAniam.setCompleteListener(function(){var e;if(t.playerAniam.setCompleteListener(null),0==t._playActionData.action.length)return 1!=t._playActionData.type&&(t.playerAniam.node.active=!1,t.mapCtrl.setGunSprActive()),(null===(e=t._playActionData)||void 0===e?void 0:e.call)&&(t._playActionData.call(),t._playActionData.call=null),void(t._nowActionType>=2&&t.mapCtrl.isCanJoin&&t.mapCtrl.endRound());t.playAnima()})},e.prototype.extractProp=function(t){for(var e=this,o=0,i=0;i<8;i++)this._propHave[i]||o++;var n=Math.min(t,o);for(i=0;i<n;i++)cc.tween({}).delay(2*i).call(function(){o++;var t=null;e._tempProp.length>0?(t=f.default.getInstance().extractProp2(e._tempProp[0]),e._tempProp.splice(0,1)):t=f.default.getInstance().extractProp(e._propHave),e.mapCtrl.showPropDesc(t),e.getProp(t)}).start();cc.tween({}).delay(2*n).call(function(){p.EventMgr.getInstance().emit(d.DMDEventName.GameFinishExtractProps)}).start()},e.prototype.getProp=function(t){for(var e=this,o=function(o){if(!i._propHave[o]){i._propHave[o]=t;var n=i.mapCtrl.UIGame.getPoolNode(d.DMDPoolName.PropItem);n.parent=i.propParent2,n.active=!0,n.getComponent("DMD_PropItem").init(t);var a=i._propPosArr[o].pos,r=i._propPosArr[o].scal;return cc.tween(n).to(0,{position:cc.v3(11,-277),opacity:1,scale:.5}).to(.5,{opacity:255,scale:1}).delay(1).to(.5,{position:a,scale:.5}).call(function(){n.setScale(r),n.parent=e._propParent,n.getComponent("DMD_PropItem").loadIcon2(t)}).start(),n.children[0].off(cc.Node.EventType.TOUCH_END),n.children[0].on(cc.Node.EventType.TOUCH_END,function(){!e._actionState||e._propCool||e.mapCtrl._startAck||(e._propHave[o]?e._seleteId!=o&&(e.setSeleteId(o),e.seleteCall=function(){if(e.setSeleteId(),e.useProp(o)){e._propHave[o]=null;var i=cc.v3(-1e3,200);1006==t.id&&(i=cc.v3(0,110)),e._propCool=!0,1010==t.id?cc.tween(n).to(.5,{position:cc.v3(0,-393)}).to(1,{opacity:0}).call(function(){e.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,n),n.opacity=255,e._propCool=!1}).start():cc.tween(n).to(.5,{position:cc.v3(0,-393)}).delay(1).by(.2,{position:i}).call(function(){1006==t.id&&(l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.shoukao1),p.EventMgr.getInstance().emit(d.DMDEventName.GameBossLock)),e.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,n),e.mapCtrl.bossCtrl.setLockStateAnima(),1004==t.id||1011==t.id?e.mapCtrl.UIGame.eventWatchHp(function(){e._propCool=!1}):e._propCool=!1,1004==t.id&&e.mapCtrl.UIGame.showTips(e._useAddHpStr),1011==t.id&&e.mapCtrl.UIGame.showTips(e._useAddHpStr),1005==t.id&&e._hp<=0&&(e.diy(),e.mapCtrl.UIGame.eventWatchHp()),e.restHpUI()}).start()}else e.mapCtrl.UIGame.showTips("\u4e0d\u53ef\u4f7f\u7528")}):e.mapCtrl.UIGame.freePoolNode(d.DMDPoolName.PropItem,n))}),i._propHave[o].node=n,{value:void 0}}},i=this,n=0;n<8;n++){var a=o(n);if("object"==typeof a)return a.value}},e.prototype.sneakProp=function(t){void 0===t&&(t=null);var e=this._propHave.findIndex(function(e){return(null==e?void 0:e.id)==t});if(e>=0);else for(u.Utils.randomRang(0,this._propHave.length);!this._propHave[e]||1005==this._propHave[e].id;)e=u.Utils.randomRang(0,this._propHave.length);var o=this._propHave[e];return this._propHave[e]=null,o},e.prototype.useProp1005=function(){var t=this;this.mapCtrl.bossCtrl.sneakProp(function(e){t.useProp2(e.id)})},e.prototype.useProp1001=function(){var t=this.mapCtrl.checkGunButtleIsTrue(),e="\u67aa\u91cc\u7684\u4e0b\u4e00\u53d1\uff1a"+(t?"\u5b9e\u5f39":"\u7a7a");console.log(e),this.mapCtrl.UIGame.showTips(e),p.EventMgr.getInstance().emit(d.DMDEventName.GameWacthButtle,t)},e.prototype.useProp1009=function(){var t="\u62c6\u51fa\u5b50\u5f39\u4e3a:"+(this.mapCtrl.passButtle2()?"\u5b9e\u5f39":"\u7a7a");console.log(t),this.mapCtrl.showTipLab(),this.mapCtrl.UIGame.showTips(t)},e.prototype.useProp1007=function(){var t=this.mapCtrl.tipOtherButtle(this._isFuturePos);this._isFuturePos[t[0]]=t[1];var e="\u67aa\u91cc\u7684\u7b2c"+(t[0]+1)+"\u53d1\uff1a"+(t[1]?"\u5b9e\u5f39":"\u7a7a");this.mapCtrl.UIGame.showTips(e),l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.zhitiao)},e.prototype.restPropUI=function(){},e.prototype.beingBeaten=function(t,e){this._playerId==t&&this.setHp(-e,!1)},e.prototype.diy=function(){this.mapCtrl.UIGame.onOpenUIResult(!1),l.AudioMgr.getInstance().playEffectFree(d.DMD_AudioId.shibai)},c([v({type:sp.Skeleton,tooltip:""})],e.prototype,"playerAniam",void 0),c([v({type:cc.Node,tooltip:""})],e.prototype,"propParent2",void 0),c([v({type:cc.Node,tooltip:""})],e.prototype,"lockNode",void 0),c([v({type:cc.Node,tooltip:""})],e.prototype,"tipNode",void 0),c([y],e)}(m.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],DMD_PropItem:[function(t,e,o){"use strict";cc._RF.push(e,"6a4a2sQ6vlAHYB1t8/StTCu","DMD_PropItem");var i=t,n=e,a=o;cc._RF.push(n,"6a4a2sQ6vlAHYB1t8/StTCu","DMD_PropItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DMD_UIGame"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.propIcon=null,e._data=null,e}return s(e,t),e.prototype.init=function(t,e){void 0===e&&(e=!1),this._data=t,e?this.loadIcon2():this.loadIcon()},e.prototype.loadIcon=function(){var t="type1_"+this._data.id;l.default.instance.loadIcon(this.propIcon,t)},e.prototype.loadIcon2=function(){var t="type"+this._data.id;l.default.instance.loadIcon(this.propIcon,t)},e.prototype.loadIcon3=function(){l.default.instance.loadIcon(this.propIcon,"type2_1008")},c([d({type:cc.Sprite,tooltip:""})],e.prototype,"propIcon",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DMD_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"b4e4aZXGdBAr4tMw77uduDX","DMD_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"b4e4aZXGdBAr4tMw77uduDX","DMD_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("EventMgr"),d=i("PoolMgr"),h=i("DMD_Configs"),f=i("DMD_APP"),m=i("DMD_MapCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.propItem=null,e.animItem=null,e.stopNode=null,e.mapNode=null,e._gameOver=!1,e._seletState=0,e._seletBuff=[],e._openUIState=!1,e.gameWin=-1,e._tipState=!1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,this.buttleTipUI.active=!1,d.PoolMgr.getInstance().creatrePool(h.DMDPoolName.PropItem,this.propItem,5),d.PoolMgr.getInstance().creatrePool(h.DMDPoolName.AnimItem,this.animItem,2),this.mapCtrl=this.mapNode.getComponent(m.default),this.mapCtrl.setUIGame(this),this.weblinkLabel.active=!0,this.onClickCloseTipNode()},e.prototype.onEnable=function(){u.EventMgr.getInstance().on(h.DMDEventName.GameWatchHp,this,this.eventWatchHp),u.EventMgr.getInstance().on(h.DMDEventName.GameTrueButtle,this,this.eventTrueButtle),u.EventMgr.getInstance().on(h.DMDEventName.GameWacthButtle,this,this.eventGunButtleTip)},e.prototype.onDisable=function(){u.EventMgr.getInstance().off(h.DMDEventName.GameWatchHp,this,this.eventWatchHp),u.EventMgr.getInstance().off(h.DMDEventName.GameTrueButtle,this,this.eventTrueButtle),u.EventMgr.getInstance().off(h.DMDEventName.GameWacthButtle,this,this.eventGunButtleTip)},e.prototype.start=function(){},e.prototype.changeSeletState=function(){this._seletState--,this.OpenBuffSelet(),this._seletState<=0&&(this._seletState=0,this._openUIState=!1)},e.prototype.checkIsMove=function(){return!(this._gameOver||this._seletState>0)},e.prototype.eventOpenBuffSelet=function(){this._seletState++},e.prototype.addUIAlert=function(t,e){void 0===e&&(e=null);var o={UIID:t,data:e};this._seletBuff.push(o),this._openUIState||(this._openUIState=!0,this.OpenBuffSelet())},e.prototype.OpenBuffSelet=function(){this._seletBuff.length>0&&(this.openUI(this._seletBuff[0].UIID,this._seletBuff[0].data),this._seletBuff.splice(0,1))},e.prototype.openGameResultUI=function(t){var e=this;void 0===t&&(t=!0),this._gameOver=!0,this.scheduleOnce(function(){e.openUI(h.DMD_UIID.UIResult,t)},1)},e.prototype.update=function(t){this.checkIsMove()&&u.EventMgr.getInstance().emit(h.DMDEventName.GameUpdata,t)},e.prototype.getPoolNode=function(t){var e=d.PoolMgr.getInstance().getNode(t);return e.active=!0,e},e.prototype.freePoolNode=function(t,e){e.active=!1,d.PoolMgr.getInstance().freeNode(t,e)},e.prototype.loadIcon=function(t,e){var o=h.emDMDBundles.GameIcon,i="icon/"+e;this.loadSpriteFrame(o,i,function(e){cc.isValid(t)&&(t.spriteFrame=e)})},e.prototype.loadIcon2=function(t,e){var o=h.emDMDBundles.GameIcon,i="propB/"+e;this.loadSpriteFrame(o,i,function(e){cc.isValid(t)&&(t.spriteFrame=e)})},e.prototype.loadResSkeleton=function(t,e,o,i){this.loadResFromBundle(e,o,sp.SkeletonData,function(e){cc.isValid(t)&&i(e)})},e.prototype.showTips=function(t){this.openUI(h.DMD_UIID.UITips,t)},e.prototype.showNextBoss=function(){this.openUI(h.DMD_UIID.UINextBoss)},e.prototype.eventWatchHp=function(t){var e=this;void 0===t&&(t=null),cc.Tween.stopAllByTarget(this.cameraNode),cc.Tween.stopAllByTarget(this.cameraNode.node),cc.tween(this.cameraNode).call(function(){p.AudioMgr.getInstance().playEffectFree(h.DMD_AudioId.kouxue),u.EventMgr.getInstance().emit(h.DMDEventName.GameRestHp)}).call(function(){-1==e.gameWin?t?t():e.mapCtrl.endRound():e.openUI(h.DMD_UIID.UIResult,1==e.gameWin)}).start()},e.prototype.eventWatchHp2=function(t){var e=this;cc.Tween.stopAllByTarget(this.cameraNode),cc.Tween.stopAllByTarget(this.cameraNode.node),cc.tween(this.cameraNode).call(function(){var t="\u6076\u9b54"+e.mapCtrl.bossCtrl._hp+"\u6ef4\u8840\uff0c\u4f60"+e.mapCtrl.playerCtrl._hp+"\u6ef4\u8840";e.showTips(t)}).call(function(){t()}).start()},e.prototype.eventPlayerFire=function(t){void 0===t&&(t=null),cc.Tween.stopAllByTarget(this.cameraNode),cc.Tween.stopAllByTarget(this.cameraNode.node);var e=0,o=1;1==t?(e=100,o=1.5):2==t&&(e=-100,o=1.5),cc.tween(this.cameraNode.node).to(.5,{position:cc.v3(0,e,0)}).start(),cc.tween(this.cameraNode).to(.5,{zoomRatio:o}).start()},e.prototype.eventTrueButtle=function(){cc.Tween.stopAllByTarget(this.cameraNode.node),cc.tween(this.cameraNode.node).to(.05,{position:cc.v3(5,5,0)}).to(.1,{position:cc.v3(10,10,0)}).to(.05,{position:cc.v3(0,0,0)}).union().repeat(3).call(function(){u.EventMgr.getInstance().emit(h.DMDEventName.GameWatchHp)}).start()},e.prototype.eventGunFire=function(t){p.AudioMgr.getInstance().playEffectFree(h.DMD_AudioId.jichui),cc.tween(this.node).delay(.2).call(function(){t?p.AudioMgr.getInstance().playEffectFree(h.DMD_AudioId.kaiqiang):p.AudioMgr.getInstance().playEffectFree(h.DMD_AudioId.kongqiang)}).start()},e.prototype.eventGunButtleTip=function(t){var e=this;void 0===t&&(t=!1),this.buttleTipUI.active=!0,this.buttleUI.active=t,cc.Tween.stopAllByTarget(this.buttleTipUI),cc.tween(this.buttleTipUI).delay(1.5).call(function(){e.buttleTipUI.active=!1}).start()},e.prototype.onClickOpenSet=function(){this._gameOver||(this._seletState++,this.stopNode.active=!0)},e.prototype.onClickCloseSet=function(){this._gameOver||(this._seletState--,this.stopNode.active=!1)},e.prototype.onClickExitApp=function(){this._gameOver||(this.closeUI(),f.default.instance.exit_App(0))},e.prototype.onOpenUIResult=function(t){void 0===t&&(t=!0),this.gameWin=t?1:0},e.prototype.onOpenUIGlove=function(t){this.openUI(h.DMD_UIID.UIGlove,t)},e.prototype.onOpenUINextBoss=function(){this.openUI(h.DMD_UIID.UINextBoss)},e.prototype.onOpenTipNode=function(){this._tipState||(this._tipState=!0,this.tipNode.active=!0)},e.prototype.onClickCloseTipNode=function(){this.tipNode.active=!1},c([v({type:cc.Node,tooltip:""})],e.prototype,"propItem",void 0),c([v({type:cc.Node,tooltip:""})],e.prototype,"animItem",void 0),c([v({type:cc.Node,tooltip:""})],e.prototype,"stopNode",void 0),c([v({type:cc.Node,tooltip:""})],e.prototype,"mapNode",void 0),c([v(cc.Node)],e.prototype,"weblinkLabel",void 0),c([v(cc.Node)],e.prototype,"buttleTipUI",void 0),c([v(cc.Node)],e.prototype,"buttleUI",void 0),c([v(cc.Camera)],e.prototype,"cameraNode",void 0),c([v(cc.Node)],e.prototype,"tipNode",void 0),o=c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DMD_UIGlove:[function(t,e,o){"use strict";cc._RF.push(e,"0098dGGb7hK4I6kJMSthrXz","DMD_UIGlove");var i=t,n=e,a=o;cc._RF.push(n,"0098dGGb7hK4I6kJMSthrXz","DMD_UIGlove");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DMD_UIGame"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.init=function(t){for(var e=this,o=t.arr,i=this.layoutNode.children,n=function(n){var r=i[n];if(r.active=o[n],r.active){r.getChildByName("lab").getComponent(cc.Label).string=n+1+":"+o[n].Name;var s=r.getChildByName("icon").getComponent(cc.Sprite);a.loadIcon(s,o[n].id),r.off(cc.Node.EventType.TOUCH_END),r.on(cc.Node.EventType.TOUCH_END,function(){t.call(o[n]),e.closeUI()})}},a=this,r=0;r<i.length;r++)n(r)},e.prototype.loadIcon=function(t,e){var o="type1_"+e;p.default.instance.loadIcon(t,o)},c([h(cc.Node)],e.prototype,"layoutNode",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DMD_UINextBoss:[function(t,e,o){"use strict";cc._RF.push(e,"7f9ebiICVNFnax1MgVEe4to","DMD_UINextBoss");var i=t,n=e,a=o;cc._RF.push(n,"7f9ebiICVNFnax1MgVEe4to","DMD_UINextBoss");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DMD_UIGame"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.onClickNextBoss=function(){this.closeUI(),p.default.instance.mapCtrl.bossCtrl.loadGunSpine2()},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DMD_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"472313kygFAlala7E0Sv4kN","DMD_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"472313kygFAlala7E0Sv4kN","DMD_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("NodeLib"),u=i("DMD_APP"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ndWin=null,e.pro_ndFail=null,e.pro_btn=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.initproperty=function(){this.pro_ndWin=p.default.findChildByName(this.node,"pro_ndWin"),this.pro_ndFail=p.default.findChildByName(this.node,"pro_ndFail"),this.pro_btn=p.default.findChildByName(this.node,"pro_btn")},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initView(),this.pro_btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.pro_ndFail.active=!this.isWin,this.pro_ndWin.active=this.isWin},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DMD_UITips:[function(t,e,o){"use strict";cc._RF.push(e,"68b27Q+RbhHaIbEbqIBJscb","DMD_UITips");var i=t,n=e,a=o;cc._RF.push(n,"68b27Q+RbhHaIbEbqIBJscb","DMD_UITips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDesc=null,e}return s(e,t),e.prototype.init=function(t){var e=this;this.labDesc.string=t,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).delay(2).call(function(){e.closeUI()}).start()},c([d(cc.Label)],e.prototype,"labDesc",void 0),c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DRA_App:[function(t,e,o){"use strict";cc._RF.push(e,"424afAzeRNFQ5oySTLGtmFk","DRA_App");var i=t,n=e,a=o;cc._RF.push(n,"424afAzeRNFQ5oySTLGtmFk","DRA_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("DRA_Configs"),p=i("DRA_DataMgr"),u=i("DRA_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;if(void 0===o&&(o=!1),l.Global.isDirect=o,this.addTouchEvent(),this._exitCall=e,o)s.UIMgr.getInstance().addUICnf(l.DRA_UICF),r.AudioMgr.getInstance().addAdConf(l.DRA_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){s.UIMgr.getInstance().openUIOfCallback(l.DRA_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.DRA_AudioId.bgm,l.DRAConfig.BgMusic)})})},!0);else{var n=function(){i._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.DRA_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.DRA_AudioId.bgm,l.DRAConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.DRA_UICF),r.AudioMgr.getInstance().addAdConf(l.DRA_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){n()})}))}},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.DRA_UIID.UIGame),s.UIMgr.getInstance().closeById(l.DRA_UIID.UIResult),s.UIMgr.getInstance().closeById(l.DRA_UIID.UISetting),l.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],DRA_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"3e1bdPNa6VBcbFeB3Y/PLAL","DRA_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"3e1bdPNa6VBcbFeB3Y/PLAL","DRA_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Utils"),u=i("DRA_Configs"),d=function(t,e){this.flag=t,this.num=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useState=!1,e.bloodArr=[],e.limitTime=3,e.showNum=10,e}return s(e,t),e.prototype.isCirt=function(t,e){t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e+""):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e+""),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=p.Utils.randomRang(-30,30),o=p.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){l.PoolMgr.getInstance().freeNode(u.poolName.blood,t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.x=0,this.node.y=0,this.node.opacity=255},e.prototype.inUse=function(){return this.useState},e.prototype.pushBlood=function(t,e){var o=new d(t,e);this.bloodArr.push(o)},e.prototype.showBlood=function(){for(var t=this.bloodArr.splice(0,this.showNum),e=0;e<t.length;e++){var o=t[e];this.isCirt(o.flag,o.num)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){(this.nowTime<0||!this.nowTime)&&(this.nowTime=this.limitTime,this.showBlood()),this.nowTime--},e.prototype.onDestroy=function(){this.bloodArr=[]},c([m(cc.Node)],e.prototype,"isCritState",void 0),c([m(cc.Label)],e.prototype,"critLabel",void 0),c([m(cc.Label)],e.prototype,"commonLabel",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DRA_Body:[function(t,e,o){"use strict";cc._RF.push(e,"6d29b0n24RK6ItK5hls8PGU","DRA_Body");var i=t,n=e,a=o;cc._RF.push(n,"6d29b0n24RK6ItK5hls8PGU","DRA_Body");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("DRA_Configs"),d=i("DARGameEnumData"),h=i("DRA_DataMgr"),f=i("DRA_UIGame"),m=i("bodyCtrl"),g=i("boxCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.playerParent=null,e.box=null,e.hpParent=null,e.path=new Array,e.gapY=200,e.gapX=200,e.stopState=!1,e.skillState=!1,e.nowIndex=0,e.moveWidth=300,e.colliderArr=[],e.width=35,e.bodyArr=[],e.num=0,e.dtNum=10,e.boxNum=0,e.isFirst=!0,e.isLast=!1,e.boxTemp=null,e.isNext=!1,e.limitDt=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.script=this,this.createPath(),this.lastNode=this.head,this.addEvent(u.emDRAEventName.pause,this.stop),this.addEvent(u.emDRAEventName.skillPause,this.skillPause),this.addEvent(u.emDRAEventName.skillResume,this.skillResume),this.addEvent(u.emDRAEventName.resume,this.resume),this.moveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed)},e.prototype.skillPause=function(){this.skillState=!0},e.prototype.skillResume=function(){this.skillState=!1},e.prototype.stop=function(){for(var t in this.stopState=!0,this.head.getComponent(m.default).stop(),this.bodyArr)this.bodyArr[t].getComponent(m.default)&&this.bodyArr[t].getComponent(m.default).stop()},e.prototype.resume=function(){for(var t in this.stopState=!1,this.head.getComponent(m.default).resume(),this.bodyArr)this.bodyArr[t].getComponent(m.default)&&this.bodyArr[t].getComponent(m.default).resume()},e.prototype.getTurn=function(){return new cc.Vec2(200,this.gapY/2)},e.prototype.createPath=function(){for(var t=-this.bgNode.width/2-30,e=cc.winSize.height/2-100,o=this.bgNode.width,i=f.default.script.getWallPosY(),n=this.bgNode.height/2+i,a=-this.bgNode.height/2+n,r=0;e>a;r++){for(var s=0;s<3;s++){var c=void 0;if(r%2==0){var l=2==s?this.gapX:0,p=2==s?this.gapY/2:0,u=0==s?t+l:t+o+l;c=new cc.Vec2(u,e-p)}else l=2==s?this.gapX:0,p=2==s?this.gapY/2:0,u=0==s?-t+l:-t-o-l,c=new cc.Vec2(u,e-p);if(Math.abs(c.y-i)<=100){for(;this.path.length<3*r+s+1;)this.path.push(new cc.Vec2(0,i));return void(this.path[this.path.length-1]=new cc.Vec2(0,i))}this.path.push(c)}e-=this.gapY}this.path[this.path.length-1]=new cc.Vec2(0,i)},e.prototype.start=function(){this.head.zIndex=1e3,this.head.setPosition(this.path[0].x-200,this.path[0].y),this.head.getComponent(m.default).startRun(this.path,-1,0,0),this.bodyArr.push(this.head)},e.prototype.getHeadY=function(){return this.head.y},e.prototype.createNode=function(t){this.isLast||(u.Global.isDirect?(this.shouldMove||(this.shouldMove=this.width),this.createBody()):(this.shouldMove&&(this.moveWidth-=this.moveSpeed*t),this.shouldMove?this.moveWidth<=0&&(this.moveWidth+=this.shouldMove,this.createBody()):(this.shouldMove=this.width,this.moveWidth=this.shouldMove,this.createBody())))},e.prototype.createBody=function(){this.num>=9&&!u.Global.canAttack&&(u.Global.canAttack=!0),this.num%8==0&&(this.boxTemp&&this.boxTemp.getComponent(g.default).setCanBeAttack(),this.boxTemp=p.PoolMgr.getInstance().getNode(u.poolName.box),this.boxTemp||(this.boxTemp=cc.instantiate(this.boxNode)),this.nowIndex++,this.boxTemp.parent=this.hpParent,this.boxTemp.active=!0);var t=this.nowIndex%4;this.checkLength()&&(t=4,this.isLast=!0);var e=this.boxTemp.getComponent(g.default),o=h.default.getInstance().getLevelCfgByID(this.nowIndex),i=p.PoolMgr.getInstance().getNode(u.poolName.body);i||(i=cc.instantiate(this.player)),i.active=!0,i.parent=this.playerParent,this.bodyArr.push(i);var n=i.getComponent(m.default);n.setPreNode(this.lastNode,this.shouldMove);var a=this.lastNode.getComponent(m.default).getIndex(),r=u.Global.isDirect?.05*this.num:.05*this.num%8;if(u.Global.isDirect&&(r*=25),n.startRun(this.path,t,r,a),this.lastNode=i,e.addOtherNode(i),this.num%4==0&&this.num%8!=0){this.checkLength(1)?e.initNode(i,o.dragonHp,this.nowIndex,!0):e.initNode(i,o.dragonHp,this.nowIndex,!1);var s=new cc.Node;s=this.boxTemp,this.colliderArr.push(s)}i.zIndex=2e3-this.num++,this.isFirst&&(this.isFirst=!1)},e.prototype.checkLength=function(t){return void 0===t&&(t=0),this.nowIndex>=h.default.getInstance().getLevelCfg().length-t},e.prototype.checkCollider=function(t,e,o,i,n,a,r,s){for(var c in this.colliderArr)if(Number(c)!=a&&this.colliderArr[c].getComponent(g.default).checkCollider(t,o,i,n,r,s))return Number(c);return-1},e.prototype.checkSkillCollider=function(t,e){for(var o in this.colliderArr)this.colliderArr[o].getComponent(g.default).checkSkillCollider(t,e)},e.prototype.update=function(t){if(!this.stopState&&!this.skillState)for(var e in this.createNode(t),this.bodyArr)this.bodyArr[e].getComponent(m.default).onUpdate(t)},c([_(cc.Animation)],e.prototype,"animation",void 0),c([_(cc.Node)],e.prototype,"head",void 0),c([_(cc.Node)],e.prototype,"playerParent",void 0),c([_(cc.Node)],e.prototype,"box",void 0),c([_(cc.Node)],e.prototype,"hpParent",void 0),c([_(cc.Node)],e.prototype,"boxNode",void 0),c([_(cc.Node)],e.prototype,"player",void 0),c([_(cc.Node)],e.prototype,"bgNode",void 0),c([_({tooltip:"\u4fe9\u6392\u9f99\u4e4b\u95f4\u7684\u95f4\u9694"})],e.prototype,"gapY",void 0),c([_({tooltip:"\u8f6c\u5f2f\u5904\u79bb\u5c4f\u5e55\u7684\u8ddd\u79bb"})],e.prototype,"gapX",void 0),o=c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],DRA_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1d978naUU1EHqLlAIvnSqhX","DRA_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1d978naUU1EHqLlAIvnSqhX","DRA_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("DRA_Configs"),d=i("DARGameEnumData"),h=i("DRA_DataMgr"),f=i("DRA_UIGame"),m=i("DRA_Hero"),g=i("DRA_HeroCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.nodeObj1=new b,e.nodeObj2=new b,e.lock=!0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(t){this.node.active=!1;var e=h.default.getInstance().getLevelCfgByID(t);if(e){if(e.buffType)if(1==e.buffType){var o=this.getResult(),i=this.getResult(),n=this.getPropertyResultArr(o,i,e);(0==o||1==o||2==o)&&this.initPropertyNode(o,n[0],this.node1,this.nodeObj1),(0==i||1==i||2==i)&&this.initPropertyNode(i,n[1],this.node2,this.nodeObj2)}else if(2==e.buffType){if(0==(o=this.getResult())){var a=this.getPropertyResult(e.buff1,o);this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)}else 1==o?(a=this.getPropertyResult(e.buff2?e.buff2:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)):2==o&&(a=this.getPropertyResult(e.buff3?e.buff3:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1));var r=this.getNewRole();this.initNewNode(r[0],this.node2,this.nodeObj2)}else r=this.getNewRole(2),this.initNewNode(r[0],this.node1,this.nodeObj1),this.initNewNode(r[1],this.node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=u.Global.heroID.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getResult=function(){return Math.floor(Math.random()*u.Global.heroID.length)},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t));if(u.Global.heroID[e].node.getComponent(m.default).getAttackSpeedState())for(var i=0;i<o.length;i++)if(o[i].includes("speed")){o.splice(i,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=h.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);for(var i in u.Global.heroID){var n=o.indexOf(u.Global.heroID[i].id);-1!=n&&o.splice(n,1)}for(var a=Object.keys(o),r=[];t--;)i=Math.floor(Math.random()*a.length),r.push(o[a[i]]),a.splice(i,1);return r},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=u.Global.heroID[t].id;this.loadSpriteFrame(u.emDRABundles.imgs,"js_b/tx_"+a,function(r){n.initPropertyView(o,r,e,a),n.lock=!1,n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=h.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=u.Global.heroID[t].node,c.buffType==u.emDRABuffType.speedPlus?i.type=1:c.buffType==u.emDRABuffType.ATKmul||c.buffType==u.emDRABuffType.ATKplus?i.type=2:c.buffType==u.emDRABuffType.penetratePlus?i.type=3:c.buffType==u.emDRABuffType.bulletPlus?i.type=4:c.buffType==u.emDRABuffType.critPlus?i.type=5:c.buffType==u.emDRABuffType.skillMul&&(i.type=6)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=h.default.getInstance().getCharacterByID(i).characterName,p=h.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon");this.loadSpriteFrame(u.emDRABundles.imgs,"js_b/tx_"+t,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.lock=!1,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=h.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffectFree(u.DRA_AudioId.buff),g.default.script.checkCollider()?this.nodeObj1.isNew?g.default.script.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?g.default.script.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.destroy()},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;1==o?e.getComponent(m.default).addAttackSpeed(t.addType,t.addNum):2==o?e.getComponent(m.default).addAttackPower(t.addType,t.addNum):3==o?e.getComponent(m.default).addAttackPenerate(t.addType,t.addNum):4==o?e.getComponent(m.default).addBulletCount(t.addType,t.addNum):5==o?e.getComponent(m.default).addCritChance(t.addType,t.addNum):6==o&&e.getComponent(m.default).addSkill(t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){o.script=this,this.addEvent(u.emDRAEventName.pause,this.stop),this.addEvent(u.emDRAEventName.resume,this.resume)},e.prototype.stop=function(){this.lock=!0},e.prototype.resume=function(){this.lock=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.lock||(this.node.y-=h.default.getInstance().getParam(d.enumBasicParaCfg.buffMove)*t*100,f.default.script.checkReWardLayer(this.node.y)&&this.doReward())},c([_(cc.Node)],e.prototype,"node1",void 0),c([_(cc.Node)],e.prototype,"node2",void 0),c([_(cc.SpriteFrame)],e.prototype,"sp",void 0),o=c([v],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],DRA_Bullet2:[function(t,e,o){"use strict";cc._RF.push(e,"43931uxx6VHnr074mTMcBhb","DRA_Bullet2");var i=t,n=e,a=o;cc._RF.push(n,"43931uxx6VHnr074mTMcBhb","DRA_Bullet2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("DRA_Configs"),d=i("DRA_Body"),h=function(t,e,o){this.damage=t,this.isCrit=e,this.pos=o};a.damageObj=h;var f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDestory=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e}return s(e,t),e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,h){if(void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===h&&(h=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDestory=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.createNeedCheckY(),this.timer>1)for(var f in h)r=cc.instantiate(r),this.initNodeView(a,r,s,h[f]);else this.initNodeView(a,r,s)},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=d.default.script.getHeadY()-this.node.y},e.prototype.update=function(t){if(this.active&&!this.isDestory){var e=this.flySpeed*t*100;if(this.node.y+=e,this.range-=e,this.needCheckY-=e,this.range<=0&&this.removeNode(),this.needCheckY<=0){var o=this.hit(),i=d.default.script.checkCollider(this.node.getPosition(),this.penetrate,o.damage,this.bulletIndex,o.isCrit,this.lastAttackID,this.timer,1!=this.timer);if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(u.emDRAEventName.GAD_Show_Hit_Effect,n),this.lastAttackID=i,this.onDie()}}}},e.prototype.hit=function(){return this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new h(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition())},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDestory=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)p.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start()},e.prototype.render=function(){},e.prototype.stop=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DRA_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"2d559kWY7VFdZlveUkj4vmn","DRA_BulletEffect");var i=e,n=o;cc._RF.push(i,"2d559kWY7VFdZlveUkj4vmn","DRA_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.show()},e.prototype.hide=function(){this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.node.active=!1,t.resetSystem()})},e.prototype.show=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],DRA_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"73a1bEwbPtLXpI1dlhFbAqm","DRA_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"73a1bEwbPtLXpI1dlhFbAqm","DRA_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.emDRAHitState=l.poolName=l.emDRABuffType=l.emDRAGameState=l.emDRARoleState=l.emDRARoleType=l.emDRAEventName=l.DRA_AudioCF=l.DRA_AudioId=l.DRA_UICF=l.DRAConfig=l.emDRABundles=l.DRA_UIID=void 0,function(t){t.UIGame="DRA_UIGame",t.UIResult="DRA_UIResult",t.UISetting="DRA_UISetting"}(a=l.DRA_UIID||(l.DRA_UIID={})),function(t){t.prefabs="dra_prefabs",t.audios="dra_audios",t.imgs="dra_imgs",t.configs="dra_configs",t.configsB="dra_configsB"}(r=l.emDRABundles||(l.emDRABundles={})),l.DRAConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.DRA_UICF=((i={})[a.UIGame]={prefab:"ui/DRA_UIGame",name:"DRA_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/DRA_UIResult",name:"DRA_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/DRA_UISetting",name:"DRA_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.doubleSword="doubleSword",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.dragonHit="dragonHit",t.rake="rake",t.typhoon="typhoon",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit"}(s=l.DRA_AudioId||(l.DRA_AudioId={})),l.DRA_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.dragonHit]={path:"dragonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n),function(t){t.GAD_Player_Die="dra_gad_player_die",t.GAD_Shoot_Bullet="dra_gad_shoot_bullet",t.GAD_Show_Hit_Text="dra_gad_show_hit_text",t.GAD_Show_Warn="dra_gad_show_warn",t.GAD_Bubble_Buf="dra_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="dra_gad_hit_effect",t.GAD_Show_Buff_Tip="dra_gad_show_buff_tip",t.GAD_Setting_Back="dra_gad_setting_back",t.pause="dra_pause",t.resume="dra_resume",t.skillPause="dra_skillPause",t.skillResume="dra_skillResume",t.buff="dra_buff",t.blood="dra_blood",t.newTarm="dra_newTarm"}(l.emDRAEventName||(l.emDRAEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emDRARoleType||(l.emDRARoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emDRARoleState||(l.emDRARoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emDRAGameState||(l.emDRAGameState={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emDRABuffType||(l.emDRABuffType={})),function(t){t.blood="dra_blood",t.destroy="dra_destroy",t.effect="dra_effect",t.box="dra_box",t.body="dra_body",t.dra_item="dra_item",t.dra_bullet="dra_bullet"}(l.poolName||(l.poolName={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emDRAHitState||(l.emDRAHitState={}));var p=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t}();l.Global=p,cc._RF.pop(),cc._RF.pop()},{}],DRA_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"268f1yUIedFfLa16BGs2/AI","DRA_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"268f1yUIedFfLa16BGs2/AI","DRA_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("DRA_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}e?i?c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"qiujiayu/BraveTower/configsB",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emDRABundles.configsB,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()}):i?c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"qiujiayu/BraveTower/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emDRABundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DRA_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"4157epKCrxOvK+Vfz+riBC/","DRA_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"4157epKCrxOvK+Vfz+riBC/","DRA_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DRA_Configs"),u=i("DRA_Hero"),d=i("DRA_Target"),h=i("DRA_TarmCtrl"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t,e){this.id=t,this.node=e},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;o.script=this,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.heroRoot.x+=o})},e.prototype.heroMove=function(t){this.heroRoot.x+t+this.node.width/2>cc.winSize.width/2||this.heroRoot.x+t-this.node.width/2<-cc.winSize.width/2||(this.heroRoot.x+=t)},e.prototype.test=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPower(2,5);else if("speed"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackSpeed(1,4);else if("penerate"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPenerate(1,1)}else this.addHero(Number(e))},e.prototype.addHero=function(t){var e=this;if(p.Global.heroID.length>=3)console.error("\u4e0d\u5141\u8bb8\u52a0\u5165\u8d85\u8fc7\u4e09\u4e2a\u82f1\u96c4");else{p.Global.heroID||(p.Global.heroID=[]),this.node.getComponent(h.default).pushCard(t);var o=cc.instantiate(this.heorNode);o.active=!0,o.parent=this.node;var i=new y(t,o);p.Global.heroID.push(i),o.getComponent(u.default).initHero(t),this.scheduleOnce(function(){e.checkOverSide()},.01)}},e.prototype.clearHero=function(){p.Global.heroID=[]},e.prototype.getMaxDamage=function(t,e){var o=0;for(var i in p.Global.heroID)p.Global.heroID[i].id!=t&&p.Global.heroID[i].id!=e||(o=Math.max(p.Global.heroID[i].node.getComponent(u.default).getAttackPower(),o));return o},e.prototype.checkOverSide=function(){this.heroRoot.x+this.node.width/2>cc.winSize.width/2?this.heroRoot.x=cc.winSize.width/2-this.node.width/2:this.heroRoot.x-this.node.width/2<-cc.winSize.width/2&&(this.heroRoot.x=-cc.winSize.width/2+this.node.width/2)},e.prototype.checkCollider=function(){return this.node.x<0},e.prototype.start=function(){},e.prototype.createTarget=function(){new d.Target(100)},c([g(cc.Node)],e.prototype,"heroRoot",void 0),c([g(cc.Node)],e.prototype,"heorNode",void 0),o=c([m],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],DRA_Hero:[function(t,e,o){"use strict";cc._RF.push(e,"3bd7e0ilHZGf4L3Hwor93UP","DRA_Hero");var i=t,n=e,a=o;cc._RF.push(n,"3bd7e0ilHZGf4L3Hwor93UP","DRA_Hero");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("DRA_Configs"),h=i("DARGameEnumData"),f=i("DRA_DataMgr"),m=i("DRA_UIGame"),g=i("DRA_Bullet2"),y=i("DRA_BulletEffect"),v=i("DRA_SkillCtrl"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.firing=!1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.bullets=[],e.skillTimer=0,e.skillMultiplier=0,e.attackGap=1,e.maxSpeed=12,e.noInFactSpeed=5,e.lastFireTime=0,e.fireCooldown=.5,e}return s(e,t),e.prototype.initHero=function(t){this.initParm(t),this.initView(t),this.heroIndex=t,this.addEvent(d.emDRAEventName.pause,this.doPause),this.addEvent(d.emDRAEventName.resume,this.doResume)},e.prototype.initParm=function(t){1==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.basicATK):2==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.secondCharATK):3==d.Global.heroID.length&&(this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.thirdCharATK)),this.attackSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.basicASPD),this.bulletCount=f.default.getInstance().getParam(h.enumBasicParaCfg.basicBullet),this.penetrate=f.default.getInstance().getParam(h.enumBasicParaCfg.basicPenetrate),this.flySpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.bulletFlySpeed),this.critChance=f.default.getInstance().getParam(h.enumBasicParaCfg.basicCrit),this.critMultiplier=f.default.getInstance().getParam(h.enumBasicParaCfg.critDamage);var e=f.default.getInstance().getCharacterByID(t);this.skillInterval=e.skillCDtime,this.skillMultiplier=e.skillATK,this.skillEffect=e.skillSound},e.prototype.initView=function(t){var e=this;this.loadPrefab(d.emDRABundles.prefabs,"bullets/DRA_Bullet_"+t,function(o){e.poolName="bullet"+t,u.PoolMgr.getInstance().creatrePool(e.poolName,cc.instantiate(o)),e.bulletPrefab=o,e.startFiring()});var o=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emDRABundles.imgs,"backs/"+o.cardColor,function(t){e.itemBg.spriteFrame=t}),this.loadSpriteFrame(d.emDRABundles.imgs,"js/js_"+t,function(t){e.itemIcon.spriteFrame=t}),this.loadSpriteFrame(d.emDRABundles.imgs,"skill/"+o.skillIcon,function(t){e.itemSkill.spriteFrame=t}),this.loadPrefab(d.emDRABundles.prefabs,"skills/CardSkill"+t,function(o){e.heroSkill=cc.instantiate(o),11==t&&e.loadPrefab(d.emDRABundles.prefabs,"skills/CardSkill"+t,function(){})}),this.itemName.string=o.characterName},e.prototype.startFiring=function(){this.firing=!0},e.prototype.stopFiring=function(){this.firing=!1},e.prototype.useSkill=function(){var t=m.default.script.getSkillLayer(),e=this.bulletPos.getPosition(),o=this.bulletPos.convertToWorldSpaceAR(e);return e=t.convertToNodeSpaceAR(o),v.default.script.useSkill(this.heroIndex,this.attackPower*this.skillMultiplier,this.heroSkill,e)},e.prototype.addAttackPower=function(t,e){this.addBuffTween(),1==t?this.attackPower+=e:this.attackPower*=e},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.addAttackSpeed=function(t,e){this.addBuffTween(),this.attackSpeedMultiplier+=e/f.default.getInstance().getParam(h.enumBasicParaCfg.speedPlusTimes)},e.prototype.getAttackSpeedState=function(){return this.attackSpeedMultiplier>=this.maxSpeed},e.prototype.addAttackPenerate=function(t,e){this.addBuffTween(),1==t?this.penetrate+=e:this.penetrate*=e},e.prototype.addCritChance=function(t,e){this.addBuffTween(),1==t?this.critChance+=e:this.critChance*=e},e.prototype.addSkill=function(t,e){this.addBuffTween(),1==t?this.skillMultiplier+=e:this.skillMultiplier*=e},e.prototype.addBulletCount=function(t,e){this.addBuffTween(),1==t?this.bulletCount+=e:this.bulletCount*=e},e.prototype.addBuffTween=function(){var t=this;this.addBuffSp.opacity=255,this.addBuffSp.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.addBuffSp.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.addBuffSp.opacity=0},.1)})},e.prototype.getAttackSpeed=function(){return this.attackSpeed/this.attackSpeedMultiplier},e.prototype.updateSkillView=function(){this.skillPercent.fillRange=this.skillTimer/this.skillInterval},e.prototype.update=function(t){var e=this;this.firing&&d.Global.canAttack&&(this.nowAttackTime+=t,this.skillTimer+=t,this.updateSkillView(),this.skillTimer>=this.skillInterval&&this.useSkill()&&(this.skillSp.opacity=255,p.AudioMgr.getInstance().playEffect(this.skillEffect,this.skillEffect),this.skillSp.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.skillSp.getComponent(sp.Skeleton).setCompleteListener(function(){e.scheduleOnce(function(){e.skillSp.opacity=0},.1)}),this.skillTimer=0),this.attackGap-=t,this.nowAttackTime-this.lastAttackTime>this.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime,this.attackGap=1))},e.prototype.fireBullets=function(){var t=performance.now()/1e3;t-this.lastFireTime>=this.fireCooldown&&(p.AudioMgr.getInstance().playEffectFree(d.DRA_AudioId.bullet),this.lastFireTime=t);var e=m.default.script.getBulletLayer(this.heroIndex),o=this.bulletPos.getPosition();this.attackSpeedMultiplier<this.noInFactSpeed||1==this.bulletCount?this.creatInfactBullet(e,o):this.creatNoInfactBullet(e,o)},e.prototype.creatInfactBullet=function(t,e){for(var o=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,i=0;i<this.bulletCount;i++){var n=new cc.Vec2(e.x-o,e.y);o+=30;var a=this.bulletPos.convertToWorldSpaceAR(n);n=t.convertToNodeSpaceAR(a);var r=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab);(u.PoolMgr.getInstance().getNode(d.poolName.dra_bullet)||cc.instantiate(this.bullet)).getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,n,r,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier)}},e.prototype.creatNoInfactBullet=function(t,e){for(var o=[],i=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,n=0;n<this.bulletCount;n++){var a=new cc.Vec2(0-i,0);i+=30,o.push(a)}var r=u.PoolMgr.getInstance().getNode(d.poolName.dra_bullet)||cc.instantiate(this.bullet),s=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab),c=this.bulletPos.convertToWorldSpaceAR(e),l=t.convertToNodeSpaceAR(c);r.getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,l,s,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier,this.bulletCount,o)},e.prototype.pushBullet=function(t){t.getComponent(y.default).hide(),this.bullets.push(t)},e.prototype.doPause=function(){this.stopFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).stop()},e.prototype.doResume=function(){this.startFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).resume()},c([B(cc.Prefab)],e.prototype,"bullet",void 0),c([B(cc.Node)],e.prototype,"bulletPos",void 0),c([B(cc.Node)],e.prototype,"skillSp",void 0),c([B(cc.Node)],e.prototype,"addBuffSp",void 0),c([B(cc.Label)],e.prototype,"itemName",void 0),c([B(cc.Sprite)],e.prototype,"itemBg",void 0),c([B(cc.Sprite)],e.prototype,"itemIcon",void 0),c([B(cc.Sprite)],e.prototype,"itemSkill",void 0),c([B(cc.Sprite)],e.prototype,"skillPercent",void 0),c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],DRA_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"bef2e0BTm1K+blVN/T+BTXB","DRA_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"bef2e0BTm1K+blVN/T+BTXB","DRA_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("DRA_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],DRA_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"8863dwLN9lIb5iE5zHX7zKr","DRA_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"8863dwLN9lIb5iE5zHX7zKr","DRA_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DRA_Configs"),u=i("DRA_Skill"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){return!this.isSkill&&(this.isSkill=!0,this.showBanner(t),o.parent=this.node,o.getComponent(u.default).useSkill(i,e,t),!0)},e.prototype.showBanner=function(t){var e=this;this.loadSpriteFrame(p.emDRABundles.imgs,"banner/banner"+t,function(t){e.banner.getComponent(cc.Sprite).spriteFrame=t,e.banner.active=!0}),cc.tween(this.banner).by(.5,{x:this.banner.width}).delay(.5).by(.5,{x:-this.banner.width}).call(function(){e.isSkill=!1,e.banner.active=!1}).start()},e.prototype.onLoad=function(){o.script=this,this.banner.x=-cc.winSize.width/2-this.banner.width/2},e.prototype.start=function(){},e.prototype.update=function(){},c([f(cc.Label)],e.prototype,"label",void 0),c([f(cc.Node)],e.prototype,"banner",void 0),c([f],e.prototype,"text",void 0),o=c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DRA_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"65225BPdmZOSLeJ4uZoTR8Q","DRA_Skill");var i=t,n=e,a=o;cc._RF.push(n,"65225BPdmZOSLeJ4uZoTR8Q","DRA_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DRA_Body"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){"attack"==o.data.name&&(t.animationDuration=e.animation.duration)})},e.prototype.useSkill=function(t,e,o){var i=this;if(this.index=o,this.skillSpeed=this.speed,1==o){this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-300),this.spAni.setAnimation(0,"hit",!1);var n=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){i.doAttack()},n-.65),this.offHeight=300}else 6==o?(this.canMove=!1,this.node.setPosition(t.x,l.default.script.getHeadY()),this.spAni.setAnimation(0,"hit",!1),n=this.spAni.getCurrent(0).animation.duration,this.scheduleOnce(function(){i.doAttack()},n-.6)):8==o?(this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)):11==o?(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!1),this.sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)):(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0));this.damage=e,this.flyDis=l.default.script.getHeadY()-this.node.y},e.prototype.update=function(){var t=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed,this.flyDis-=this.skillSpeed,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){t.sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),t.sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.spAni.setAnimation(0,"hit",!1),this.doAttack()))},e.prototype.doAttack=function(){l.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([d({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([d({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([d({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],DRA_Target:[function(t,e,o){"use strict";cc._RF.push(e,"0e117JkPUhHMbbYxO8gEjlQ","DRA_Target");var i=e,n=o;cc._RF.push(i,"0e117JkPUhHMbbYxO8gEjlQ","DRA_Target"),Object.defineProperty(n,"__esModule",{value:!0}),n.Target=void 0;var a=function(){function t(t){this.health=t}return t.prototype.takeDamage=function(t){this.health-=t,console.log("Target takes "+t+" damage! Remaining health: "+this.health),this.health<=0&&this.destroy()},t.prototype.destroy=function(){console.log("Target destroyed!")},t}();n.Target=a,cc._RF.pop(),cc._RF.pop()},{}],DRA_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e02222wKBZMkKSYYBHO6W44","DRA_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e02222wKBZMkKSYYBHO6W44","DRA_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DRA_Configs"),u=i("DRA_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tarmMap=new Map,e.isTureTarmMap=new Map,e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.sendEvent(p.emDRAEventName.newTarm,e[0],this.delayTime),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DRA_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"7a049GcmH1Oe61hjyMtZh8q","DRA_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"7a049GcmH1Oe61hjyMtZh8q","DRA_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("DRA_Configs"),f=i("DRA_BloodCtrl"),m=i("DRA_BuffCtrl"),g=i("DRA_mateCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.buffLayer=null,e.bloodLayer=null,e.hitLayer=null,e.blood=null,e.pauseLayer=null,e.closeNode=null,e.skillLayer=null,e.banner=null,e.bannerSp=[],e.maxLength=50,e.hpIndex=0,e.hpArr=[],e.tipPools=[],e.maxShowCount=50,e.lastShowTime=0,e.throttleTime=.2,e}return s(e,t),e.prototype.onLoad=function(){p.PoolMgr.getInstance().creatrePool(h.poolName.effect,this.hitEffect,5),p.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2),this.createHpArr(this.maxLength),this.initSystemListen()},e.prototype.createHpArr=function(t){for(;t--;){var e=p.PoolMgr.getInstance().getNode(h.poolName.blood)||cc.instantiate(this.blood);this.hpArr.push(e)}},e.prototype.initSystemListen=function(){var t=this;h.Global.isDirect||cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){t.pauseLayer&&e.keyCode==cc.macro.KEY.space&&(t.pauseLayer.active?(t.pauseLayer.active=!1,t.sendEvent(h.emDRAEventName.resume)):(t.pauseLayer.active=!0,t.sendEvent(h.emDRAEventName.pause)))})},e.prototype.start=function(){var t=this;this.addEvent(h.emDRAEventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(h.emDRAEventName.GAD_Show_Warn,this.playWarn),this.addEvent(h.emDRAEventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(h.emDRAEventName.buff,this.showBuff),this.addEvent(h.emDRAEventName.blood,this.showLoseLabel),this.addEvent(h.emDRAEventName.newTarm,this.showNewTarm),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(h.emDRAEventName.pause),h.Global.isDirect?u.UIMgr.getInstance().openUI(h.DRA_UIID.UISetting,d.UIID.UINONE,function(e){e&&t.sendEvent(h.emDRAEventName.resume)}):t.pauseLayer.active=!0}),this.pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active&&(t.sendEvent(h.emDRAEventName.resume),t.pauseLayer.active=!1)}),this.closeNode.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active=!1,u.UIMgr.getInstance().openUI(h.DRA_UIID.UISetting,d.UIID.UINONE,function(e){e&&t.sendEvent(h.emDRAEventName.resume)})})},e.prototype.onShowHitText=function(t,e){var o,i=this;(o=this.tipPools.length>0?this.tipPools.pop():cc.instantiate(this.ndTipRoot.children[0])).parent=this.ndTipRoot,o.active=!0,o.getComponent(cc.Label).string=(t>0?"+":"")+t,o.color=t>0?cc.color().fromHEX("#0bff16"):cc.color().fromHEX("#ff4e49");var n=this.ndTipRoot.convertToNodeSpaceAR(cc.v2(e.x,e.y));o.setPosition(n.x,n.y),o.opacity=255,cc.tween(o).by(.3,{y:80}).to(.1,{opacity:0}).call(function(){o.removeFromParent(),i.tipPools.push(o)}).start()},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.ndWarn),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.ndWarn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.ndWarn),t.ndWarn.active=!1}).start()},e.prototype.showHitEffect=function(t){var e=this.node.convertToNodeSpaceAR(t),o=p.PoolMgr.getInstance().getNode(h.poolName.effect)||cc.instantiate(this.hitEffect);o.parent=this.hitLayer,o.setPosition(e),o.active=!0,o.opacity=255,o.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.active=!1,p.PoolMgr.getInstance().freeNode("pbt_hit_effect",o)})},e.prototype.showBuff=function(t){var e=this;this.loadPrefab(h.emDRABundles.prefabs,"item/buff",function(o){var i=cc.instantiate(o);i.parent=e.buffLayer,i.getComponent(m.default).initNode(t)})},e.prototype.showLoseLabel=function(t,e,o,i){if(void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),!(this.bloodLayer.children.length>=this.maxShowCount)||i){var n=cc.director.getTotalTime();if(!(n-this.lastShowTime<this.throttleTime)||i){this.lastShowTime=n;var a=p.PoolMgr.getInstance().getNode(h.poolName.blood);a.parent||(a.parent=this.bloodLayer);var r=a.getComponent(f.default);r.resumeNode(),a.setPosition(e.x,e.y+40),r.isCirt(o,t)}}},e.prototype.showNewTarm=function(t,e){var o=this;this.loadPrefab(h.emDRABundles.prefabs,"item/mateIcon",function(e){var i=cc.instantiate(e);i.parent=o.skillLayer,i.getComponent(g.default).initNode(t)}),this.showBanner(t,e)},e.prototype.showBanner=function(t,e){var o=this;this.banner.getComponent(cc.Sprite).spriteFrame=this.bannerSp[t],cc.tween(this.banner).by(e/2,{x:this.banner.width}).delay(e/2).call(function(){o.banner.x=-cc.winSize.width/2-o.banner.width/2}).start()},c([_(cc.Node)],e.prototype,"ndTipRoot",void 0),c([_(cc.Node)],e.prototype,"ndWarn",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"hitEffect",void 0),c([_(cc.Node)],e.prototype,"ndBuffImg",void 0),c([_(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([_(cc.Sprite)],e.prototype,"spBack",void 0),c([_(cc.Node)],e.prototype,"buffLayer",void 0),c([_(cc.Node)],e.prototype,"bloodLayer",void 0),c([_(cc.Node)],e.prototype,"hitLayer",void 0),c([_(cc.Node)],e.prototype,"blood",void 0),c([_(cc.Node)],e.prototype,"pauseLayer",void 0),c([_(cc.Node)],e.prototype,"closeNode",void 0),c([_(cc.Node)],e.prototype,"skillLayer",void 0),c([_(cc.Node)],e.prototype,"banner",void 0),c([_(cc.SpriteFrame)],e.prototype,"bannerSp",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],DRA_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"a5dd1ZY/HtIVrnRlGTpUr0V","DRA_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"a5dd1ZY/HtIVrnRlGTpUr0V","DRA_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DRA_Configs"),u=i("DRA_DataMgr"),d=i("DRA_HeroCtrl"),h=i("PoolMgr"),f=i("AudioMgr"),m=i("DARGameEnumData"),g=i("SdkMgr"),y=i("PlatformSetting"),v=i("BasePlatform"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.sprBgSup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.heroRoot=null,e.ndFence=null,e.content=null,e.item=null,e.bulletLayer=null,e.rewardLayer=null,e.bloodLayer=null,e.destroyLayer=null,e.startNode=null,e.skillLayer=null,e.dieLayer=null,e.gmNode=null,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this.ndCardGroup.getComponent(d.default);t.clearHero(),p.Global.canAttack=!1,p.Global.bulletID=0,t.addHero(this.getNewRole()),o.script=this,this.createNodePool(),this.doStart()},e.prototype.setGmNode=function(){(g.SdkMgr.getInstance().getCheckVersion(y.SwitchID.ShenHe_ABD)||y.PlatformSetting.currentPlatform==v.Platform.EDITOR||y.PlatformSetting.currentPlatform==v.Platform.WEB_LINK)&&(this.gmNode.active=!0)},e.prototype.doStart=function(){var t=this;f.AudioMgr.getInstance().playEffectFree(p.DRA_AudioId.mission),this.startNode.active=!0,this.startNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.startNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.startNode.active=!1},.1)})},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=u.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);return o[Math.floor(Math.random()*o.length)]},e.prototype.getWallPosY=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.y},e.prototype.getWallPos=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.getPosition()},e.prototype.start=function(){this.initEvents()},e.prototype.createNodePool=function(){this.loadPrefab(p.emDRABundles.prefabs,"item/blood",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.blood,e)}),this.loadPrefab(p.emDRABundles.prefabs,"item/destroy",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.destroy,e)}),this.loadPrefab(p.emDRABundles.prefabs,"item/box",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.box,e)}),this.loadPrefab(p.emDRABundles.prefabs,"item/body",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.body,e)}),this.loadPrefab(p.emDRABundles.prefabs,"item/dra_item",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.dra_item,e)}),this.loadPrefab(p.emDRABundles.prefabs,"item/dra_bullet",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.dra_bullet,e)})},e.prototype.initEvents=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.ndCardGroup.getComponent(d.default).heroMove(o)})},e.prototype.getBulletLayer=function(t){var e="layer"+t;return this.bulletLayer.getChildByName(e)},e.prototype.getAllBullet=function(){var t=[];for(var e in this.bulletLayer.children)for(var o in this.bulletLayer.children[e].children)t.push(this.bulletLayer.children[e].children[o])},e.prototype.getDestroyLayer=function(){return this.destroyLayer},e.prototype.getSkillLayer=function(){return this.skillLayer},e.prototype.checkReWardLayer=function(t){return this.rewardLayer.y>t},e.prototype.addHero=function(){},e.prototype.update=function(){},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.sprBgSup);var t=u.default.getInstance().getParam(m.enumBasicParaCfg.quake);cc.tween(this.sprBgSup).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-1*t,-1*t)}).by(.05,{position:cc.v3(2*t,1*t)}).by(.05,{position:cc.v3(-2*t,0*t)}).by(.05,{position:cc.v3(2*t,-1*t)}).by(.05,{position:cc.v3(-1*t,1*t)}).set({position:cc.v3(0,0)}).start()},c([B(cc.Node)],e.prototype,"ndCardGroup",void 0),c([B(cc.Node)],e.prototype,"sprBgSup",void 0),c([B(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([B(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([B(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([B(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([B(cc.Node)],e.prototype,"heroRoot",void 0),c([B(cc.Node)],e.prototype,"ndFence",void 0),c([B(cc.Node)],e.prototype,"content",void 0),c([B(cc.Node)],e.prototype,"item",void 0),c([B(cc.Node)],e.prototype,"bulletLayer",void 0),c([B(cc.Node)],e.prototype,"rewardLayer",void 0),c([B(cc.Node)],e.prototype,"bloodLayer",void 0),c([B(cc.Node)],e.prototype,"destroyLayer",void 0),c([B(cc.Node)],e.prototype,"startNode",void 0),c([B(cc.Node)],e.prototype,"skillLayer",void 0),c([B(cc.Node)],e.prototype,"dieLayer",void 0),c([B(cc.Node)],e.prototype,"gmNode",void 0),o=c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],DRA_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"3e1eengVL5Oz5qW0M5SSRRJ","DRA_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"3e1eengVL5Oz5qW0M5SSRRJ","DRA_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DRA_Configs"),u=i("DRA_App"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e.isDirect=null,e.unDirect=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t,this.isDirect.active=p.Global.isDirect,this.unDirect.active=!p.Global.isDirect},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([f(cc.Label)],e.prototype,"lblBar",void 0),c([f(cc.Sprite)],e.prototype,"spBar",void 0),c([f(cc.Node)],e.prototype,"ndWin",void 0),c([f(cc.Node)],e.prototype,"ndFail",void 0),c([f(cc.Node)],e.prototype,"ndTop",void 0),c([f(cc.Node)],e.prototype,"ndBar",void 0),c([f(cc.Node)],e.prototype,"btn",void 0),c([f(cc.Node)],e.prototype,"btnPlay",void 0),c([f(cc.Label)],e.prototype,"lblRwd",void 0),c([f(cc.Node)],e.prototype,"isDirect",void 0),c([f(cc.Node)],e.prototype,"unDirect",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DRA_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"a88e3XlGQlB26wZD6i/v+aZ","DRA_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"a88e3XlGQlB26wZD6i/v+aZ","DRA_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("DRA_Configs"),m=i("DRA_App"),g=i("DRA_UIGame"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t,this.isDirect.active=f.Global.isDirect,this.unDirect.active=!f.Global.isDirect},e.prototype.onEnable=function(){this.musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&g.default.script.setGmNode()}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){m.default.instance.exit_App(0)}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([_(cc.Slider)],e.prototype,"musicSlider",void 0),c([_(cc.Slider)],e.prototype,"effectSlider",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([_(cc.Node)],e.prototype,"btnBackHome",void 0),c([_(cc.Node)],e.prototype,"isDirect",void 0),c([_(cc.Node)],e.prototype,"unDirect",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Node)],e.prototype,"gmNode",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],DRA_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"82359FY9CRMjasbTrrdyDRs","DRA_UserData");var i=t,n=e,a=o;cc._RF.push(n,"82359FY9CRMjasbTrrdyDRs","DRA_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"gad_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],DRA_mateCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c6eeabZp15Ml6bj807MgSov","DRA_mateCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c6eeabZp15Ml6bj807MgSov","DRA_mateCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Config"),u=i("DRA_Configs"),d=i("DRA_DataMgr"),h=i("DRA_HeroCtrl"),f=i("DRA_mateSkillCtrl"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e.maxCDTime=0,e.cdTime=0,e.mateSkillAttack=1,e.mateID=1,e.isPause=!1,e}return s(e,t),e.prototype.initNode=function(t){this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=this,e=d.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=e.mateCDtime,this.mateSkillAttack=e.mateSkillATK,this.loadPrefab(u.emDRABundles.prefabs,"skills/mateSkill"+this.mateID,function(e){t.skillNode=cc.instantiate(e)})},e.prototype.initView=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID);this.skillLabel.string=t.mateName,this.cdPercent.fillRange=0,this.skillIcon.spriteFrame=this.getSpriteByName(),this.cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){if(this.cdTime<=0){var t=d.default.getInstance().getMateCfgByID(this.mateID),e=Number(t.mateRole.split(",")[0]),o=Number(t.mateRole.split(",")[1]);f.default.script.useSkill(this.mateID,h.default.script.getMaxDamage(e,o)*t.mateSkillATK,this.skillNode,new cc.Vec2(0,0))&&this.initStartUseSkill()}else this.openUI(p.UIID.UITips,"\u6280\u80fd\u6b63\u5728cd")},e.prototype.initStartUseSkill=function(){this.cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.cdLabel.string=this.cdTime+"",this.cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.cdLabel.node.active=!1,this.spNode.node.active=!0,this.spNode.setAnimation(0,"animation",!1),this.spNode.setCompleteListener(function(){e.spNode.node.active=!1})):this.cdLabel.string=this.cdTime.toFixed(0)},e.prototype.getSpriteByName=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID).mateIconRes;for(var e in this.spArr)if(t==this.spArr[e].name)return this.spArr[e]},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.onLoad=function(){this.addEvent(u.emDRAEventName.pause,this.pause),this.addEvent(u.emDRAEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.cdTime>0&&!this.isPause&&this.refreshSkillView(t)},c([y(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([y(cc.Label)],e.prototype,"cdLabel",void 0),c([y(cc.Label)],e.prototype,"skillLabel",void 0),c([y(cc.Sprite)],e.prototype,"cdPercent",void 0),c([y(cc.Sprite)],e.prototype,"skillIcon",void 0),c([y(sp.Skeleton)],e.prototype,"spNode",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],DRA_mateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1ce86OB+QlMZLlPhfRl6uHI","DRA_mateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1ce86OB+QlMZLlPhfRl6uHI","DRA_mateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DRA_mateSkill"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){var n=this;return!this.isSkill&&(this.isSkill=!0,this.scheduleOnce(function(){n.isSkill=!1},.5),o.parent=this.node,o.getComponent(p.default).useSkill(i,e,t),!0)},e.prototype.onLoad=function(){o.script=this},e.prototype.start=function(){},e.prototype.update=function(){},c([h(cc.Label)],e.prototype,"label",void 0),c([h(cc.Node)],e.prototype,"banner",void 0),c([h],e.prototype,"text",void 0),o=c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DRA_mateSkill:[function(t,e,o){"use strict";cc._RF.push(e,"99d88D0ZSJM0ZuxK2j1bM7r","DRA_mateSkill");var i=t,n=e,a=o;cc._RF.push(n,"99d88D0ZSJM0ZuxK2j1bM7r","DRA_mateSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("DRA_Configs"),d=i("DRA_DataMgr"),h=i("DRA_Hero"),f=i("DRA_Body"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){if("attack"==o.data.name){var i=d.default.getInstance().getMateCfgByID(t.index);if(3==t.index)p.EventMgr.getInstance().emit(u.emDRAEventName.skillPause),t.scheduleOnce(function(){p.EventMgr.getInstance().emit(u.emDRAEventName.skillResume)},Number(i.matePara));else if(1==t.index)for(var n in u.Global.heroID)1!=u.Global.heroID[n].id&&7!=u.Global.heroID[n].id||u.Global.heroID[n].node.getComponent(h.default).addAttackSpeed(1,Number(i.matePara));t.doAttack()}})},e.prototype.useSkill=function(t,e,o){var i=d.default.getInstance().getMateCfgByID(o);l.AudioMgr.getInstance().playEffect(i.mateSound),this.index=o,this.spAni.setAnimation(0,"animation",!1),this.node.setPosition(t.x,f.default.script.getHeadY()),this.damage=e},e.prototype.update=function(){},e.prototype.doAttack=function(){f.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([y({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([y({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([y({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([y({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([y({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([g],e)}(cc.Component);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],DW_APP:[function(t,e,o){"use strict";cc._RF.push(e,"799cfdZc+VJo64UaJ0Orc+u","DW_APP");var i=t,n=e,a=o;cc._RF.push(n,"799cfdZc+VJo64UaJ0Orc+u","DW_APP");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("AudioMgr"),c=i("UIMgr"),l=i("Config"),p=i("DW_PoolMgr"),u=i("DW_QuadTreeMgr"),d=i("DW_Simulator"),h=i("DW_Config"),f=i("DW_DataMgr"),m=cc._decorator,g=m.ccclass,y=(m.property,function(){function t(){this._isInited=!1,this._exitCall=null}var e;return e=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e,s.AudioMgr.getInstance().pauseAllMusic();var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(h.DW_UIID.DW_UIGame,h.DW_UIID.DW_UIGame,function(){c.UIMgr.getInstance().closeById(l.UIID.UISubEnter),t&&t()})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(h.DW_UICF),s.AudioMgr.getInstance().addAdConf(h.DW_Audio),f.default.getInstance().loadCfg(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),c.UIMgr.getInstance().closeById(h.DW_UIID.DW_UIGame),c.UIMgr.getInstance().closeById(h.DW_UIID.DW_UIPause),c.UIMgr.getInstance().closeById(h.DW_UIID.DW_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,d.DW_Simulator.instance.clear(),p.default.getInstance().clear(),u.default.Instance.clear(),c.UIMgr.getInstance().openUI(l.UIID.UISubEnter,l.UIID.UINONE)},t._instance=null,e=r([g],t)}());a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DW_AddPropTips:[function(t,e,o){"use strict";cc._RF.push(e,"f8ef0K0p85GOImDiL7ramnQ","DW_AddPropTips");var i=t,n=e,a=o;cc._RF.push(n,"f8ef0K0p85GOImDiL7ramnQ","DW_AddPropTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e.icon=null,e}return s(e,t),e.prototype.init=function(t,e,o){var i=this;this.txt.node.color=o,this.txt.string=e;var n="";switch(t){case 1:n="tou_9002";break;case 2:n="tou_9004";break;case 3:n="buff_11";break;case 4:case 7:n="tou_9008";break;case 5:n="tou_9009"}this.loadSpriteFrame(p.DW_BundleName.Sprite,"buffBoxIcon/"+n,function(t){i.icon.spriteFrame=t}),cc.Tween.stopAllByTarget(this.node),this.node.scale=0;var a=this.node.position.clone();a.y+=100,cc.tween(this.node).to(.2,{scale:1}).to(2,{position:a}).to(.2,{scale:0}).call(function(){i.node.destroy()}).start()},c([h(cc.Label)],e.prototype,"txt",void 0),c([h(cc.Sprite)],e.prototype,"icon",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_Agent:[function(t,e,o){"use strict";cc._RF.push(e,"e64dfdBpORBZ4JZ5q9Y+jNn","DW_Agent");var i=t,n=e,a=o;cc._RF.push(n,"e64dfdBpORBZ4JZ5q9Y+jNn","DW_Agent"),Object.defineProperty(a,"__esModule",{value:!0}),a.DW_Agent=void 0;var r=i("DW_Common"),s=function(){function t(){this.agentNeighbors_=[],this.obstaclNeighbors_=[],this.orcaLines_=[],this.position_=new r.DW_Vector2(0,0),this.prefVelocity_=new r.DW_Vector2(0,0),this.velocity_=new r.DW_Vector2(0,0),this.id=0,this.maxNeighbors_=0,this.maxSpeed_=0,this._neighborDist=0,this.radius_=0,this.timeHorizon=0,this.timeHorizonObst=0,this.newVelocity_=new r.DW_Vector2(0,0),this.mass=1}return Object.defineProperty(t.prototype,"neighborDist",{get:function(){return this._neighborDist},set:function(t){this._neighborDist=t},enumerable:!1,configurable:!0}),t.prototype.computeNeighbors=function(t){this.obstaclNeighbors_.length=0;var e=Math.pow(this.timeHorizonObst*this.maxSpeed_+this.radius_,2);t.kdTree.computeObstacleNeighbors(this,e),this.agentNeighbors_.length=0,this.maxNeighbors_>0&&(e=Math.pow(this.neighborDist,2),e=t.kdTree.computeAgentNeighbors(this,e))},t.prototype.computeNewVelocity=function(t){this.orcaLines_.length=0;for(var e=this.orcaLines_,o=1/this.timeHorizonObst,i=0;i<this.obstaclNeighbors_.length;++i){for(var n=this.obstaclNeighbors_[i].value,a=n.next,s=n.point.minus(this.position_),c=a.point.minus(this.position_),l=!1,p=0;p<e.length;++p)if(r.DW_RVOMath.det(s.scale(o).minus(e[p].point),e[p].direction)-o*this.radius_>=-r.DW_RVOMath.RVO_EPSILON&&r.DW_RVOMath.det(c.scale(o).minus(e[p].point),e[p].direction)-o*this.radius_>=-r.DW_RVOMath.RVO_EPSILON){l=!0;break}if(!l){var u=r.DW_RVOMath.absSq(s),d=r.DW_RVOMath.absSq(c),h=r.DW_RVOMath.sqr(this.radius_),f=a.point.minus(n.point),m=s.scale(-1).multiply(f)/r.DW_RVOMath.absSq(f),g=r.DW_RVOMath.absSq(s.scale(-1).minus(f.scale(m))),y=new r.DW_Line;if(m<0&&u<=h)n.convex&&(y.point=new r.DW_Vector2(0,0),y.direction=r.DW_RVOMath.normalize(new r.DW_Vector2(-s.y,s.x)),e.push(y));else if(m>1&&d<=h)a.convex&&r.DW_RVOMath.det(c,a.direction)>=0&&(y.point=new r.DW_Vector2(0,0),y.direction=r.DW_RVOMath.normalize(new r.DW_Vector2(-c.y,c.x)),e.push(y));else if(m>=0&&m<=1&&g<=h)y.point=new r.DW_Vector2(0,0),y.direction=n.direction.scale(-1),e.push(y);else{var v=void 0,_=void 0;if(m<0&&g<=h){if(!n.convex)continue;a=n;var b=Math.sqrt(u-h);v=new r.DW_Vector2(s.x*b-s.y*this.radius_,s.x*this.radius_+s.y*b).scale(1/u),_=new r.DW_Vector2(s.x*b+s.y*this.radius_,-s.x*this.radius_+s.y*b).scale(1/u)}else if(m>1&&g<=h){if(!a.convex)continue;n=a;var B=Math.sqrt(d-h);v=new r.DW_Vector2(c.x*B-c.y*this.radius_,c.x*this.radius_+c.y*B).scale(1/d),_=new r.DW_Vector2(c.x*B+c.y*this.radius_,-c.x*this.radius_+c.y*B).scale(1/d)}else n.convex?(b=Math.sqrt(u-h),v=new r.DW_Vector2(s.x*b-s.y*this.radius_,s.x*this.radius_+s.y*b).scale(1/u)):v=n.direction.scale(-1),a.convex?(B=Math.sqrt(d-h),_=new r.DW_Vector2(c.x*B+c.y*this.radius_,-c.x*this.radius_+c.y*B).scale(1/d)):_=n.direction;var I=n.previous,P=!1,C=!1;n.convex&&r.DW_RVOMath.det(v,I.direction.scale(-1))>=0&&(v=I.direction.scale(-1),P=!0),a.convex&&r.DW_RVOMath.det(_,a.direction)<=0&&(_=a.direction,C=!0);var D=n.point.minus(this.position_).scale(o),T=a.point.minus(this.position_).scale(o),S=T.minus(D),A=n==a?.5:this.velocity_.minus(D).multiply(S)/r.DW_RVOMath.absSq(S),k=this.velocity_.minus(D).multiply(v),w=this.velocity_.minus(T).multiply(_);if(A<0&&k<0||n==a&&k<0&&w<0){var N=r.DW_RVOMath.normalize(this.velocity_.minus(D));y.direction=new r.DW_Vector2(N.y,-N.x),y.point=D.plus(N.scale(this.radius_*o)),e.push(y)}else if(A>1&&w<0)N=r.DW_RVOMath.normalize(this.velocity_.minus(T)),y.direction=new r.DW_Vector2(N.y,-N.x),y.point=T.plus(N.scale(this.radius_*o)),e.push(y);else{var R=A<0||A>1||n==a?1/0:r.DW_RVOMath.absSq(this.velocity_.minus(S.scale(A).plus(D))),M=k<0?1/0:r.DW_RVOMath.absSq(this.velocity_.minus(v.scale(k).plus(D))),O=w<0?1/0:r.DW_RVOMath.absSq(this.velocity_.minus(_.scale(w).plus(T)));if(R<=M&&R<=O){y.direction=n.direction.scale(-1);var E=new r.DW_Vector2(-y.direction.y,y.direction.x);y.point=E.scale(this.radius_*o).plus(D),e.push(y)}else if(M<=O){if(P)continue;y.direction=v,E=new r.DW_Vector2(-y.direction.y,y.direction.x),y.point=E.scale(this.radius_*o).plus(D),e.push(y)}else C||(y.direction=_.scale(-1),E=new r.DW_Vector2(-y.direction.y,y.direction.x),y.point=E.scale(this.radius_*o).plus(T),e.push(y))}}}}var L=e.length,x=1/this.timeHorizon;for(i=0;i<this.agentNeighbors_.length;++i){var F=this.agentNeighbors_[i].value,G=F.position_.minus(this.position_),U=F.mass/(this.mass+F.mass),j=this.mass/(this.mass+F.mass),H=U>=.5?this.velocity_.minus(this.velocity_.scale(U)).scale(2):this.prefVelocity_.plus(this.velocity_.minus(this.prefVelocity_).scale(2*U)),W=j>=.5?F.velocity_.scale(2).scale(1-j):F.prefVelocity_.plus(F.velocity_.minus(F.prefVelocity_).scale(2*j)),V=H.minus(W),K=r.DW_RVOMath.absSq(G),Y=this.radius_+F.radius_,z=r.DW_RVOMath.sqr(Y),X=void(y=new r.DW_Line);if(K>z){var q=V.minus(G.scale(x)),J=r.DW_RVOMath.absSq(q),Z=q.multiply(G);if(Z<0&&r.DW_RVOMath.sqr(Z)>z*J){var Q=Math.sqrt(J);N=q.scale(1/Q),y.direction=new r.DW_Vector2(N.y,-N.x),X=N.scale(Y*x-Q)}else{var $=Math.sqrt(K-z);r.DW_RVOMath.det(G,q)>0?(E=new r.DW_Vector2(G.x*$-G.y*Y,G.x*Y+G.y*$),y.direction=E.scale(1/K)):(E=new r.DW_Vector2(G.x*$+G.y*Y,-G.x*Y+G.y*$),y.direction=E.scale(-1/K));var tt=V.multiply(y.direction);X=y.direction.scale(tt).minus(V)}}else{var et=1/t;q=V.minus(G.scale(et)),Q=r.DW_RVOMath.abs(q),N=q.scale(1/Q),y.direction=new r.DW_Vector2(N.y,-N.x),X=N.scale(Y*et-Q)}y.point=H.plus(X.scale(U)),e.push(y)}var ot=this.linearProgram2(e,this.maxSpeed_,this.prefVelocity_,!1,this.newVelocity_);ot<e.length&&this.linearProgram3(e,L,ot,this.maxSpeed_,this.newVelocity_)},t.prototype.insertAgentNeighbor=function(t,e){if(this!=t){var o=r.DW_RVOMath.absSq(this.position_.minus(t.position_));if(o<e){this.agentNeighbors_.length<this.maxNeighbors_&&this.agentNeighbors_.push(new r.DW_KeyValuePair(o,t));for(var i=this.agentNeighbors_.length-1;0!=i&&o<this.agentNeighbors_[i-1].key;)this.agentNeighbors_[i]=this.agentNeighbors_[i-1],--i;this.agentNeighbors_[i]=new r.DW_KeyValuePair(o,t),this.agentNeighbors_.length==this.maxNeighbors_&&(e=this.agentNeighbors_[this.agentNeighbors_.length-1].key)}}return e},t.prototype.insertObstacleNeighbor=function(t,e){var o=t.next,i=r.DW_RVOMath.distSqPointLineSegment(t.point,o.point,this.position_);if(i<e){this.obstaclNeighbors_.push(new r.DW_KeyValuePair(i,t));for(var n=this.obstaclNeighbors_.length-1;0!=n&&i<this.obstaclNeighbors_[n-1].key;)this.obstaclNeighbors_[n]=this.obstaclNeighbors_[n-1],--n;this.obstaclNeighbors_[n]=new r.DW_KeyValuePair(i,t)}},t.prototype.update=function(t){this.velocity_.copy(this.newVelocity_),this.position_.copy(this.position_.plus(this.velocity_.scale(t)))},t.prototype.linearProgram1=function(t,e,o,i,n,a){var s=t[e].point.multiply(t[e].direction),c=r.DW_RVOMath.sqr(s)+r.DW_RVOMath.sqr(o)-r.DW_RVOMath.absSq(t[e].point);if(c<0)return!1;for(var l=Math.sqrt(c),p=-s-l,u=-s+l,d=0;d<e;++d){var h=r.DW_RVOMath.det(t[e].direction,t[d].direction),f=r.DW_RVOMath.det(t[d].direction,t[e].point.minus(t[d].point));if(Math.abs(h)<=r.DW_RVOMath.RVO_EPSILON){if(f<0)return!1}else{var m=f/h;if(h>=0?u=Math.min(u,m):p=Math.max(p,m),p>u)return!1}}return n?i.multiply(t[e].direction)>0?a.copy(t[e].point.plus(t[e].direction.scale(u))):a.copy(t[e].point.plus(t[e].direction.scale(p))):(m=t[e].direction.multiply(i.minus(t[e].point)))<p?a.copy(t[e].point.plus(t[e].direction.scale(p))):m>u?a.copy(t[e].point.plus(t[e].direction.scale(u))):a.copy(t[e].point.plus(t[e].direction.scale(m))),!0},t.prototype.linearProgram2=function(t,e,o,i,n){i?n.copy(o.scale(e)):r.DW_RVOMath.absSq(o)>r.DW_RVOMath.sqr(e)?n.copy(r.DW_RVOMath.normalize(o).scale(e)):n.copy(o);for(var a=0;a<t.length;++a)if(r.DW_RVOMath.det(t[a].direction,t[a].point.minus(n))>0){var s=n.clone();if(!this.linearProgram1(t,a,e,o,i,n))return n.copy(s),a}return t.length},t.prototype.linearProgram3=function(t,e,o,i,n){for(var a=0,s=o;s<t.length;++s)if(r.DW_RVOMath.det(t[s].direction,t[s].point.minus(n))>a){for(var c=[],l=0;l<e;++l)c.push(t[l]);for(var p=e;p<s;++p){var u=new r.DW_Line,d=r.DW_RVOMath.det(t[s].direction,t[p].direction);if(Math.abs(d)<=r.DW_RVOMath.RVO_EPSILON){if(t[s].direction.multiply(t[p].direction)>0)continue;u.point=t[s].point.plus(t[p].point).scale(.5)}else u.point=t[s].point.plus(t[s].direction.scale(r.DW_RVOMath.det(t[p].direction,t[s].point.minus(t[p].point))/d));u.direction=r.DW_RVOMath.normalize(t[p].direction.minus(t[s].direction)),c.push(u)}var h=n.clone();this.linearProgram2(c,i,new r.DW_Vector2(-t[s].direction.y,t[s].direction.x),!0,n)<c.length&&n.copy(h),a=r.DW_RVOMath.det(t[s].direction,t[s].point.minus(n))}},t}();a.DW_Agent=s,cc._RF.pop(),cc._RF.pop()},{}],DW_BossEnemy:[function(t,e,o){"use strict";cc._RF.push(e,"f1a1aC0OgtP6ZlVMQEHxnt0","DW_BossEnemy");var i=t,n=e,a=o;cc._RF.push(n,"f1a1aC0OgtP6ZlVMQEHxnt0","DW_BossEnemy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("DW_Config"),u=i("DW_DataMgr"),d=i("DW_GameMgr"),h=i("DW_PoolMgr"),f=i("DW_EnemyRole"),m=i("DW_RoleBullet"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dirArrowsPre=null,e.boxCol2=null,e.planks=null,e.dirArrows=null,e.isColPlayer=!1,e.skillID=0,e.sprintCol=!1,e.sprintColInterval=5,e.sprintColTime=0,e.setout=!1,e.setoutInterval=2.2,e.setoutTime=0,e.setoutAnimTime=0,e.sprintAtk=0,e.atkBulletInterval=5,e.atkBulletTime=0,e.bulletAtk=0,e.isAtkEb=!1,e.atkEbInterval=2,e.atkEbTime=0,e.upMoveSpeed=2.5,e.upMoveSpeedInterval=1,e.upMoveSpeedTime=0,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.spScale=1.6,this.initUpSpeedInterval=u.default.getInstance().getBossInfo().BossSpeedThreshold,this.dirArrows=cc.instantiate(this.dirArrowsPre),this.dirArrows.setParent(d.default.Instance.botBase),this.dirArrows.active=!1},e.prototype.init=function(){this.enemyState=f.DW_EnemyState.move,this.atkTime=0,this.hpBar.node.parent.active=!1,this.frozenPos.active=!1,this.skillFrozen=!1,this.frozenCountTime=0,cc.Tween.stopAllByTarget(this.spAnim.node),cc.Tween.stopAllByTarget(this.hpBar),this.spAnim.node.color=cc.Color.WHITE,this.hpBar.progress=1,this.moveSpeed=this.basicsMoveSpeed,this.isSpeedCut=!1,this.speCutTime=0,this.spAnim.paused=!1,this.node.scale=1,this.initUpSpeedTime=0,this.isDie=!1,this.spAnim.setAnimation(0,p.DW_AnimName.idle,!0),this.basicsMoveSpeed=u.default.getInstance().getBossInfo().Speed,this.moveSpeed=this.basicsMoveSpeed,this.maxHp=u.default.getInstance().getBossInfo().Heathy,this.nowHp=this.maxHp,this.atkForce=u.default.getInstance().getBossInfo().Atk,this.bulletAtk=u.default.getInstance().getBossInfo().Skill1,this.sprintAtk=u.default.getInstance().getBossInfo().Skill2,this.atkBulletInterval=u.default.getInstance().getBossInfo().Skill1CD,this.sprintColInterval=u.default.getInstance().getBossInfo().Skill2CD,this.upMoveSpeed=u.default.getInstance().getBossInfo().BossSpeedUP,l.AudioMgr.getInstance().playEffectFree(p.DW_AudioId.bossjiao)},e.prototype.update=function(t){var e=this;if(!d.default.Instance.isPause&&!this.isDie){if(this.initUpSpeedTime<this.initUpSpeedInterval?this.initUpSpeedTime+=t:this.basicsMoveSpeed<this.maxMoveSpeed&&!this.sprintCol&&(0==this.upSpeedAnim.childrenCount&&this.loadPrefab(p.DW_BundleName.Prefabs,"effAnim/enemyUpSpeedAnim",function(t){var o=cc.instantiate(t);o.setParent(e.upSpeedAnim),o.setPosition(cc.v2())}),(this.upMoveSpeedTime+=t)>this.upMoveSpeedInterval&&(this.upMoveSpeedTime=0,this.basicsMoveSpeed+=this.upMoveSpeed,this.moveSpeed=this.basicsMoveSpeed)),this.isPlayHarm&&(this.isPlayHarm=!1),0==this.skillID)(this.atkBulletTime+=t)>this.atkBulletInterval&&(this.skillID=1,this.atkBulletTime=0,this.shootCircleBullets());else{if(this.sprintCol)this.setout||(this.sprintColTime+=t,this.sprintColTime>.65&&(this.sprintColTime=0,this.sprintCol=!1,this.skillID=0,this.moveSpeed=this.basicsMoveSpeed));else if(this.sprintColTime+=t,this.sprintColTime>this.sprintColInterval){this.sprintColTime=0,this.sprintCol=!0,this.setoutTime=0,this.setout=!0;var o=this.node.getPosition(),i=d.default.Instance.playerCtrl.convertToWorldSpaceAR(cc.Vec2.ZERO),n=this.node.parent.convertToNodeSpaceAR(i).sub(o).normalize();this.nowMovePos=o.add(n.mul(1e3)),this.node.x>this.nowMovePos.x&&this.spAnim.node.scaleX!=-this.spScale?this.spAnim.node.scaleX=-this.spScale:this.node.x<this.nowMovePos.x&&this.spAnim.node.scaleX!=this.spScale&&(this.spAnim.node.scaleX=this.spScale),this.dirArrows.active=!0;var a=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),r=this.dirArrows.parent.convertToNodeSpaceAR(a);this.dirArrows.setPosition(r);var s=180*Math.atan2(n.y,n.x)/Math.PI;this.dirArrows.angle=s,this.setoutAnimTime=0,cc.Tween.stopAllByTarget(this.dirArrows),cc.tween(this.dirArrows).to(.2,{opacity:255}).to(.2,{opacity:150}).start()}if(this.setout)return this.setoutTime+=t,this.setoutTime>this.setoutInterval&&(this.setoutTime=0,this.setout=!1,this.dirArrows.active=!1,this.moveSpeed=1e3,this.spAnim.setAnimation(0,p.DW_AnimName.attack,!0),this.spAnim.timeScale=1.9),void((this.setoutAnimTime+=t)>=.4&&(this.setoutAnimTime=0,cc.Tween.stopAllByTarget(this.dirArrows),cc.tween(this.dirArrows).to(.2,{opacity:255}).to(.2,{opacity:150}).start()))}this.isCol=!1,this.isAtk=!1,this.loongEo=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),this.hitPos=null;for(var c=this.boxCol2.getBoundingBoxToWorld(),l=0,u=d.default.Instance.plankAllList;l<u.length;l++){var h=u[l],m=h.getBoundingBoxToWorld();if(cc.Intersection.rectRect(c,m)){this.isCol=!0;var g=Math.max(c.x,m.x),y=Math.max(c.y,m.y),v=Math.min(c.x+c.width,m.x+m.width),_=Math.min(c.y+c.height,m.y+m.height),b=null;v>g&&_>y&&(b=new cc.Rect(g,y,v-g,_-y)),this.hitPos=b?b.center:c.center}if(6==this.enemyType){var B=h.convertToWorldSpaceAR(cc.Vec3.ZERO);cc.Vec3.distance(B,this.loongEo)<this.atkDis&&(this.isAtk=!0)}}this.isCol?this.isColPlayer||(this.isColPlayer=!0,this.sendEvent(p.DW_EventName.KnockbackPlayer,this.node),d.default.Instance.playEnemyColRole(this.node,this.hitPos),this.isAtkEb||(this.isAtkEb=!0,this.enemyColAtk())):this.isColPlayer=!1,this.isAtkEb&&(this.atkEbTime+=t,this.atkEbTime>this.atkEbInterval&&(this.isAtkEb=!1,this.atkEbTime=0)),this.isAtk?this.enemyState!=f.DW_EnemyState.attack&&(this.enemyState=f.DW_EnemyState.attack):this.enemyState!=f.DW_EnemyState.move&&(this.enemyState=f.DW_EnemyState.move),this.sprintCol?this.moveThis(t):this.enemyState==f.DW_EnemyState.move?(i=d.default.Instance.playerCtrl.convertToWorldSpaceAR(cc.Vec2.ZERO),this.nowMovePos=this.node.parent.convertToNodeSpaceAR(i),this.node.x>this.nowMovePos.x&&this.spAnim.node.scaleX!=-this.spScale?this.spAnim.node.scaleX=-this.spScale:this.node.x<this.nowMovePos.x&&this.spAnim.node.scaleX!=this.spScale&&(this.spAnim.node.scaleX=this.spScale),this.moveThis(t)):this.enemyState==f.DW_EnemyState.attack&&this.atkTime>this.atkInterval&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,p.DW_AnimName.attack,!1)),this.atkTime+=t}},e.prototype.moveThis=function(t){this.loongPos=this.node.getPosition(),this.moveDistance=this.moveSpeed*t,this.direction=this.nowMovePos.sub(this.loongPos).normalize(),this.move=this.direction.mul(this.moveDistance),this.distance=this.nowMovePos.sub(this.loongPos).mag(),(this.sprintCol||this.distance>100)&&this.node.setPosition(this.loongPos.add(this.move))},e.prototype.enemyColAtk=function(){d.default.Instance.isPause||this.isDie||(l.AudioMgr.getInstance().playEffectFree(p.DW_AudioId.mutouzhuangji),this.sprintCol?d.default.Instance.attackEd(this.sprintAtk):d.default.Instance.attackEd(this.atkForce))},e.prototype.shootCircleBullets=function(t){var e=this;void 0===t&&(t=12);for(var o=360/t,i=function(i){var n=360/t*i,a=i*o*Math.PI/180,r=cc.v2(Math.cos(a),Math.sin(a)).normalize();h.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(d.default.Instance.roleBulletBase);var o=e.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i),t.angle=n-90;var a={typeID:e.enemyType,level:1,atkForce:e.bulletAtk,criticalChance:0,criticalForce:1,bulletEffect:e.bulletEffect,bulletPro:e.bulletPro,dir:r,isSplitBullet:!1,atkInterval:e.atkInterval};t.getComponent(m.default).init(a,e.atkPos,!0)})},n=0;n<t;n++)i(n)},e.prototype.knockback=function(){},e.prototype.frozenEd=function(){},e.prototype.speedCut=function(){},e.prototype.setRovMove=function(){},e.prototype.moveByRvo=function(){},e.prototype.attack=function(){},c([v(cc.Prefab)],e.prototype,"dirArrowsPre",void 0),c([v(cc.Node)],e.prototype,"boxCol2",void 0),c([v(cc.Node)],e.prototype,"planks",void 0),c([y],e)}(f.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],DW_BoxInfoTipsBox:[function(t,e,o){"use strict";cc._RF.push(e,"922e0T3uu5IfY9yFgJHN/YK","DW_BoxInfoTipsBox");var i=t,n=e,a=o;cc._RF.push(n,"922e0T3uu5IfY9yFgJHN/YK","DW_BoxInfoTipsBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtTips=null,e.levelBox=null,e.weaponIcon=null,e}return s(e,t),e.prototype.init=function(t,e,o){var i=this;this.txtTips.string=t,this.node.active=!0,cc.Tween.stopAllByTarget(this.node),this.node.opacity=0,cc.tween(this.node).to(.2,{opacity:255}).start();var n="roleBoxIcon/gezi_0"+o;this.loadSpriteFrame(p.DW_BundleName.Sprite,n,function(t){i.levelBox.spriteFrame=t});var a="roleBoxIcon/tou_"+e;this.loadSpriteFrame(p.DW_BundleName.Sprite,a,function(t){i.weaponIcon.spriteFrame=t})},e.prototype.die=function(){var t=this;this.node.active&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.active=!1}).start())},c([h(cc.RichText)],e.prototype,"txtTips",void 0),c([h(cc.Sprite)],e.prototype,"levelBox",void 0),c([h(cc.Sprite)],e.prototype,"weaponIcon",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_Btn_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"5e6518MA7BMNoIhhnPIVB5s","DW_Btn_Skills");var i=t,n=e,a=o;cc._RF.push(n,"5e6518MA7BMNoIhhnPIVB5s","DW_Btn_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("DW_Config"),d=i("DW_DataMgr"),h=i("DW_GameMgr"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelBox=null,e.lockMack=null,e.skillIcon=null,e.isDie=!1,e.skillID=0,e.level=0,e.isSkillLock=!1,e.skillInterval=0,e.skillTime=0,e.orderAct=0,e}return s(e,t),e.prototype.onLoad=function(){this.playBtnAnim()},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.btnAnimId)},e.prototype.init=function(t,e,o){var i=this;this.skillID=t,this.orderAct=o,this.lockMack.node.active=!1,this.skillInterval=d.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime=this.skillInterval,this.updateLevel(e),this.node.on(cc.Node.EventType.TOUCH_END,this.playSkill,this);var n="skillsBtnIcon/"+d.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(u.DW_BundleName.Sprite,n,function(t){i.skillIcon.spriteFrame=t})},e.prototype.update=function(t){h.default.Instance.isPause||h.default.Instance.isPrepare||this.isDie||this.isSkillLock&&(this.skillTime-=t,this.lockMack.progress=this.skillTime/this.skillInterval,this.skillTime<0&&(this.isSkillLock=!1,this.lockMack.node.active=!1,this.playBtnAnim()))},e.prototype.updateLevel=function(t){var e=this;if(this.level!=t){this.level=t;var o="skillsBtnIcon/guang_0"+this.level;this.loadSpriteFrame(u.DW_BundleName.Sprite,o,function(t){e.levelBox.getComponent(cc.Sprite).spriteFrame=t})}},e.prototype.playSkill=function(){h.default.Instance.isPrepare||this.isSkillLock||(clearInterval(this.btnAnimId),this.btnAnimId=null,cc.Tween.stopAllByTarget(this.node),this.lockMack.node.active=!0,this.lockMack.progress=1,this.isSkillLock=!0,this.skillTime=this.skillInterval,h.default.Instance.playSkillsAtk(this.skillID),p.AudioMgr.getInstance().playEffectFree(d.default.getInstance().getSkillsCfg(this.skillID).mateSound))},e.prototype.playBtnAnim=function(){var t=this;clearInterval(this.btnAnimId),this.btnAnimId=null,cc.tween(this.levelBox).to(.65,{scale:1.04}).to(.65,{scale:1}).start(),this.btnAnimId=setInterval(function(){cc.tween(t.levelBox).to(.65,{scale:1.04}).to(.65,{scale:1}).start()},1300)},c([g(cc.Node)],e.prototype,"levelBox",void 0),c([g(cc.ProgressBar)],e.prototype,"lockMack",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],DW_Common:[function(t,e,o){"use strict";cc._RF.push(e,"512c3xFE+1GWal7xfQcOyiS","DW_Common");var i=e,n=o;cc._RF.push(i,"512c3xFE+1GWal7xfQcOyiS","DW_Common"),Object.defineProperty(n,"__esModule",{value:!0}),n.DW_RVOMath=n.DW_KeyValuePair=n.DW_Line=n.DW_Obstacle=n.DW_Vector2=void 0;var a=function(){function t(t,e){this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.plus=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.minus=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.multiply=function(t){return this.x*t.x+this.y*t.y},t.prototype.scale=function(e){return new t(this.x*e,this.y*e)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.substract=function(t,e){return t.x-=e.x,t.y-=e.y,t},t.prototype.lengthSqr=function(){return Math.pow(this.x,2)+Math.pow(this.y,2)},t}();n.DW_Vector2=a,n.DW_Obstacle=function(){},n.DW_Line=function(){},n.DW_KeyValuePair=function(t,e){this.key=t,this.value=e};var r=function(){function t(){}return t.absSq=function(t){return t.multiply(t)},t.normalize=function(e){return e.scale(1/t.abs(e))},t.distSqPointLineSegment=function(e,o,i){var n=i.minus(e),a=o.minus(e),r=n.multiply(a)/t.absSq(a);return r<0?t.absSq(n):r>1?t.absSq(i.minus(o)):t.absSq(i.minus(e.plus(a.scale(r))))},t.sqr=function(t){return t*t},t.det=function(t,e){return t.x*e.y-t.y*e.x},t.abs=function(e){return Math.sqrt(t.absSq(e))},t.leftOf=function(e,o,i){return t.det(e.minus(i),o.minus(e))},t.RVO_EPSILON=1e-5,t}();n.DW_RVOMath=r,cc._RF.pop(),cc._RF.pop()},{}],DW_Config:[function(t,e,o){"use strict";cc._RF.push(e,"54906pCiA5NF5ROV1wrrjqp","DW_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"54906pCiA5NF5ROV1wrrjqp","DW_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.DW_RoleAsePath=l.DW_OnTouchState=l.DW_AnimName=l.DW_EventName=l.DW_Audio=l.DW_AudioId=l.DW_UICF=l.DW_UIID=l.DW_BundleName=void 0,function(t){t.Prefabs="DW_Prefabs",t.Sprite="DW_Sprite",t.Audio="DW_Audio",t.SpAnim="DW_SpAnim"}(a=l.DW_BundleName||(l.DW_BundleName={})),function(t){t.DW_UIGame="DW_UIGame",t.DW_UIGM="DW_UIGM",t.DW_UIPause="DW_UIPause",t.DW_UIGameOver="DW_UIGameOver",t.DW_UISelectBuff="DW_UISelectBuff",t.DW_UIBuffPro="DW_UIBuffPro"}(r=l.DW_UIID||(l.DW_UIID={})),l.DW_UICF=((i={})[r.DW_UIGame]={prefab:"ui/DW_UIGame",name:"DW_UIGame",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.DW_UIGM]={prefab:"ui/DW_UIGM",name:"DW_UIGM",showTop:!0,showMult:!1,zIndex:1002,bundleName:a.Prefabs},i[r.DW_UIPause]={prefab:"ui/DW_UIPause",name:"DW_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.DW_UIGameOver]={prefab:"ui/DW_UIGameOver",name:"DW_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.DW_UISelectBuff]={prefab:"ui/DW_UISelectBuff",name:"DW_UISelectBuff",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.DW_UIBuffPro]={prefab:"ui/DW_UIBuffPro",name:"DW_UIBuffPro",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i),function(t){t.attack2="attack2",t.baozha="baozha",t.bocijieshu="bocijieshu",t.bossjiao="bossjiao",t.fangrugezi="fangrugezi",t.huanditu="huanditu",t.kaishi="kaishi",t.mingzhong="mingzhong",t.mutouzhuangji="mutouzhuangji",t.shengji="shengji",t.shibai="shibai",t.shuaixnshangdian="shuaixnshangdian",t.siwang="siwang",t.summon="summon",t.cwsq="cwsq",t.jdqx="jdqx",t.sgml="sgml",t.zysq="zysq"}(s=l.DW_AudioId||(l.DW_AudioId={})),l.DW_Audio=((n={})[s.attack2]={path:s.attack2,bundle:a.Audio},n[s.baozha]={path:s.baozha,bundle:a.Audio},n[s.bocijieshu]={path:s.bocijieshu,bundle:a.Audio},n[s.bossjiao]={path:s.bossjiao,bundle:a.Audio},n[s.fangrugezi]={path:s.fangrugezi,bundle:a.Audio},n[s.huanditu]={path:s.huanditu,bundle:a.Audio},n[s.kaishi]={path:s.kaishi,bundle:a.Audio},n[s.mingzhong]={path:s.mingzhong,bundle:a.Audio},n[s.mutouzhuangji]={path:s.mutouzhuangji,bundle:a.Audio},n[s.shengji]={path:s.shengji,bundle:a.Audio},n[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.shuaixnshangdian]={path:s.shuaixnshangdian,bundle:a.Audio},n[s.siwang]={path:s.siwang,bundle:a.Audio},n[s.summon]={path:s.summon,bundle:a.Audio},n[s.cwsq]={path:s.cwsq,bundle:a.Audio},n[s.jdqx]={path:s.jdqx,bundle:a.Audio},n[s.sgml]={path:s.sgml,bundle:a.Audio},n[s.zysq]={path:s.zysq,bundle:a.Audio},n),function(t){t.SetPause="DW_SetPause",t.UpdateSceneAllBox="DW_UpdateSceneAllBox",t.PlayGame="DW_PlayGame",t.ActivateSkills="DW_ActivateSkills",t.UpdateRolePro="DW_updateRolePro",t.upTipsBox="DW_upTipsBox",t.rolePlaySkill="DW_rolePlaySkill",t.waveOver="DW_waveOver",t.SetGoldNum="DW_setGoldNum",t.AddPlank="DW_AddPlank",t.BuffAddMoveSpeed="DW_BuffAddMoveSpeed",t.PauseJoystickK="DW_PauseJoystickK",t.PlayerView="DW_playerView",t.DiePlayerViewPro="DW_DiePlayerViewPro",t.KnockbackPlayer="DW_KnockbackPlayer",t.CutMap="DW_CutMap",t.PlayerOnTouchMove="DW_PlayerOnTouchMove"}(l.DW_EventName||(l.DW_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="run",t.animation="animation"}(l.DW_AnimName||(l.DW_AnimName={})),function(t){t[t.Start=0]="Start",t[t.Move=1]="Move",t[t.End=2]="End"}(l.DW_OnTouchState||(l.DW_OnTouchState={})),l.DW_RoleAsePath={1:{path:"soilder_3/soilder_3",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_3"},3:{path:"djdh_3/djdh_3",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_1"},4:{path:"djdh_4/djdh_4",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_1"},5:{path:"djdh_5/djdh_5",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_3"},6:{path:"djdh_6/djdh_6",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_2"},7:{path:"soilder_4/soilder_4",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_3"},8:{path:"djdh_8/djdh_8",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_1"},10:{path:"djdh_10/djdh_10",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_2"},11:{path:"soilder_1/soilder_1",bulletPath:"hdfs_bullte/hdfs_bullte",bulletSkill:"bullte"},17:{path:"djdh_17/djdh_17",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_2"}},cc._RF.pop(),cc._RF.pop()},{}],DW_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"df1efts7ElPDLtLSj6eNX3j","DW_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"df1efts7ElPDLtLSj6eNX3j","DW_DataMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.loadCfg=function(t){var e=this;r.ResourceMgr.getInstance().loadRes("DW_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getCfgByPrimaryKey2=function(t,e,o,i,n){if(t)for(var a=0;a<t.length;a++)if(t[a][i]==e&&t[a][n]==o)return t[a];return null},t.prototype.getBoxProInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.CharacterNum,t,e,"CharacterID","level")},t.prototype.getParameterCfg=function(t){return this.data.GearParameterCfg[t].value},t.prototype.getSkillsCfg=function(t){return this.getCfgByPrimaryKey(this.data.mateCfg,t,"mateID")},t.prototype.getEnemyInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.enemyCfg,t,e,"level","CharacterID")},t.prototype.getEnemyExp=function(t){return this.getCfgByPrimaryKey(this.data.enemyID,t,"ID")},t.prototype.getBuffCfg=function(t,e){return this.getCfgByPrimaryKey2(this.data.buffCfg,t,e,"ID","buffQuality")},t.prototype.getBuffBoxExpCfg=function(t){return this.getCfgByPrimaryKey(this.data.BoxCfg,t,"ID").Reward},t.prototype.getBossInfo=function(){return this.data.BossCfg[0]},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],DW_EffDie:[function(t,e,o){"use strict";cc._RF.push(e,"8a28eWD9vVK/Z0Snr74MgoB","DW_EffDie");var i=t,n=e,a=o;cc._RF.push(n,"8a28eWD9vVK/Z0Snr74MgoB","DW_EffDie");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DW_Config"),p=i("DW_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name!=l.DW_AnimName.animation&&"hit"!=e.animation.name||p.default.getInstance().pushObj(t.node)})},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_EnemyRole:[function(t,e,o){"use strict";cc._RF.push(e,"9fefarvVI5HNoCcaWeof5NF","DW_EnemyRole");var i=t,n=e,a=o;cc._RF.push(n,"9fefarvVI5HNoCcaWeof5NF","DW_EnemyRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.DW_EnemyState=void 0;var l,p=i("BaseCtrl"),u=i("AudioMgr"),d=i("UIMgr"),h=i("DW_Config"),f=i("DW_DataMgr"),m=i("DW_GameEnumData"),g=i("DW_GameMgr"),y=i("DW_PoolMgr"),v=i("DW_QuadTreeMgr"),_=i("DW_Common"),b=i("DW_Simulator"),B=i("DW_RoleBullet"),I=cc._decorator,P=I.ccclass,C=I.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.die=2]="die"}(l=a.DW_EnemyState||(a.DW_EnemyState={}));var D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.boxCol=null,e.hpBar=null,e.frozenPos=null,e.plank=null,e.atkPos=null,e.upSpeedAnim=null,e.enemyType=0,e.isDie=!1,e.enemyState=l.die,e.maxMoveSpeed=320,e.initUpSpeed=40,e.initUpSpeedTime=0,e.initUpSpeedInterval=15,e.basicsMoveSpeed=80,e.moveSpeed=80,e.nowMovePos=cc.v2(),e.spScale=.7,e.skillFrozen=!1,e.frozenCountTime=0,e.isSpeedCut=!1,e.speCutTime=0,e.cutSpeed=1,e.isKnockback=!1,e.knockbackCountTime=.3,e.knockbackTime=0,e._hitPow=100,e.atkForce=1,e.maxHp=10,e.nowHp=0,e.exp=0,e.atkInterval=2.5,e.atkTime=0,e.atkAnimTimeSpeed=1,e.clipDuration=0,e.atkDis=0,e.typeID=0,e.bulletEffect=0,e.bulletPro=1,e.rvoAgentId=-1,e.loongPos=null,e.moveDistance=0,e.direction=null,e.move=null,e._frames=0,e._frames2=0,e.isPlayHarm=!1,e.playHarmInterval=.3,e.playHarmTime=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.addEvent(h.DW_EventName.SetPause,this.setSpAnim),this.addEvent(h.DW_EventName.rolePlaySkill,this.rolePlaySkill),this.spAnim.setCompleteListener(function(e){e.animation.name==h.DW_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.spAnim.setAnimation(0,h.DW_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==h.DW_AnimName.attack&&t.attack()}),this.setSpAnimPlaySpeed(),101!=this.enemyType&&(this.exp=f.default.getInstance().getEnemyExp(this.enemyType).EXP),this.atkDis=f.default.getInstance().getParameterCfg(m.DW_enumGearParameterCfg.EnemyAtkRange),this.atkInterval=f.default.getInstance().getParameterCfg(m.DW_enumGearParameterCfg.EnemyAtkSpeed),this.initUpSpeedInterval=f.default.getInstance().getParameterCfg(m.DW_enumGearParameterCfg.SpeedThreshold),this.initUpSpeed=f.default.getInstance().getParameterCfg(m.DW_enumGearParameterCfg.MonsterSpeedUp),this.maxMoveSpeed=f.default.getInstance().getParameterCfg(m.DW_enumGearParameterCfg.MonsterSpeedUpLimt)},e.prototype.getROVAgent=function(t,e){var o=b.DW_Simulator.instance.addAgent(cc.v2(t.x,t.y),40,e,null,1);return b.DW_Simulator.instance.getAgentByAid(o).neighborDist=135,o},e.prototype.init=function(t){var e=this;this.enemyState=l.move,this.atkTime=0,this.hpBar.node.parent.active=!1,this.frozenPos.active=!1,this.skillFrozen=!1,this.frozenCountTime=0,cc.Tween.stopAllByTarget(this.spAnim.node),cc.Tween.stopAllByTarget(this.hpBar),this.spAnim.node.color=cc.Color.WHITE,this.hpBar.progress=1,this.moveSpeed=this.basicsMoveSpeed,this.isSpeedCut=!1,this.speCutTime=0,this.spAnim.paused=!1,this.node.scale=1,this.initUpSpeedTime=0,this.isDie=!1,5==this.enemyType?(this.spAnim.setAnimation(0,h.DW_AnimName.move,!0),this.spScale=1):this.spAnim.setAnimation(0,h.DW_AnimName.idle,!0);var o=f.default.getInstance().getParameterCfg(m.DW_enumGearParameterCfg.EnemySpeed);this.basicsMoveSpeed=o[this.enemyType-1],this.moveSpeed=this.basicsMoveSpeed,this.rvoAgentId=this.getROVAgent(this.node.position,this.moveSpeed);var i=f.default.getInstance().getEnemyInfo(t,this.enemyType);if(null!=i&&(this.maxHp=g.default.Instance.round(i.HP),this.nowHp=this.maxHp,this.atkForce=g.default.Instance.round(i.Atk)),6==this.enemyType){var n=[1,3,4,5,6,7,8,10,11,17];this.typeID=n[g.default.Instance.random(0,n.length,!0)];var a=""+h.DW_RoleAsePath[this.typeID].path;this.loadResFromBundle(h.DW_BundleName.SpAnim,a,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,h.DW_AnimName.idle,!0),e.setSpAnimPlaySpeed()});var r=f.default.getInstance().getBoxProInfo(this.typeID,1);this.bulletEffect=r.BulletEffect[0],this.bulletPro=g.default.Instance.round_2(r.BulletEffect[1]),8!=this.typeID&&5!=this.typeID||(this.atkForce=Math.round(this.atkForce/this.bulletPro))}},e.prototype.update=function(t){var e=this;if(!g.default.Instance.isPause&&!this.isDie){if(this.initUpSpeedTime<this.initUpSpeedInterval?this.initUpSpeedTime+=t:this.basicsMoveSpeed<this.maxMoveSpeed&&(0==this.upSpeedAnim.childrenCount&&this.loadPrefab(h.DW_BundleName.Prefabs,"effAnim/enemyUpSpeedAnim",function(t){var o=cc.instantiate(t);o.setParent(e.upSpeedAnim),o.setPosition(cc.v2())}),this.basicsMoveSpeed+=t*this.initUpSpeed,this.moveSpeed=this.basicsMoveSpeed*this.cutSpeed,this.skillFrozen||b.DW_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed)),this.isPlayHarm&&(this.playHarmTime+=t)>this.playHarmInterval&&(this.isPlayHarm=!1,this.playHarmTime=0),this.isSpeedCut&&(this.speCutTime-=t,this.speCutTime<0&&(this.isSpeedCut=!1,this.speCutTime=0,this.cutSpeed=1,this.moveSpeed=this.basicsMoveSpeed,this.skillFrozen&&b.DW_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed),this.spAnim.animation!=h.DW_AnimName.attack&&(this.spAnim.timeScale=1))),++this._frames2>7){this._frames2=0;var o=!1,i=!1,n=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),a=this.plank.getBoundingBoxToWorld();if(v.default.Instance.getPlaterTreeColliderList(this.node).length>0)for(var r=0,s=g.default.Instance.plankAllList;r<s.length;r++){var c=(f=s[r]).getBoundingBoxToWorld();if(cc.Intersection.rectRect(a,c)&&(o=!0),6==this.enemyType){var p=f.convertToWorldSpaceAR(cc.Vec3.ZERO);cc.Vec3.distance(p,n)<this.atkDis&&(i=!0)}}else if(6==this.enemyType)for(var u=0,d=g.default.Instance.plankAllList;u<d.length;u++){var f;p=(f=d[u]).convertToWorldSpaceAR(cc.Vec3.ZERO),cc.Vec3.distance(p,n)<this.atkDis&&(i=!0)}if(o)return this.enemyColAtk(),void this.die(!1);6==this.enemyType&&(i?this.enemyState!=l.attack&&(this.enemyState=l.attack,b.DW_Simulator.instance.setMaxSpeed(this.rvoAgentId,0)):this.enemyState!=l.move&&(this.enemyState=l.move,b.DW_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed)))}if(this.skillFrozen)return this.frozenCountTime-=t,void(this.frozenCountTime<0&&(this.frozenCountTime=0,this.skillFrozen=!1,this.setSpAnim(!1),this.frozenPos.active=!1,this.moveSpeed=this.basicsMoveSpeed*this.cutSpeed,b.DW_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed)));if(this.isKnockback)return this.knockbackTime+=t,this.knockbackTime>this.knockbackCountTime&&(this.isKnockback=!1,this.knockbackTime=0),void this.setRovMove();if(this.enemyState==l.move){if(++this._frames>8){this._frames=0;var m=g.default.Instance.playerCtrl.convertToWorldSpaceAR(cc.Vec2.ZERO);this.nowMovePos=this.node.parent.convertToNodeSpaceAR(m),this.node.x>this.nowMovePos.x&&this.spAnim.node.scaleX!=-this.spScale?this.spAnim.node.scaleX=-this.spScale:this.node.x<this.nowMovePos.x&&this.spAnim.node.scaleX!=this.spScale&&(this.spAnim.node.scaleX=this.spScale),this.setRovMove()}}else this.enemyState==l.attack&&this.atkTime>this.atkInterval&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,h.DW_AnimName.attack,!1));this.atkTime+=t}},e.prototype.setRovMove=function(){if(!(this.rvoAgentId<0)){var t=b.DW_Simulator.instance.getAgentByAid(this.rvoAgentId),e=b.DW_Simulator.instance.getAgentPosition(this.rvoAgentId),o=this.nowMovePos;if(this.isKnockback)t&&e&&(i=(i=o.subtract(cc.v2(e.x,e.y))).normalize().multiplyScalar(t.maxSpeed_*-this._hitPow),b.DW_Simulator.instance.setAgentPrefVelocity(this.rvoAgentId,i));else if(t&&e){var i;(i=o.subtract(cc.v2(e.x,e.y))).lengthSqr()>1&&(i=i.normalize().multiplyScalar(t.maxSpeed_));var n=t.velocity_,a=new cc.Vec2(.8*n.x+.2*i.x,.8*n.y+.2*i.y);a.lengthSqr()<_.DW_RVOMath.RVO_EPSILON?b.DW_Simulator.instance.setAgentPrefVelocity(this.rvoAgentId,cc.Vec2.ZERO):b.DW_Simulator.instance.setAgentPrefVelocity(this.rvoAgentId,a)}}},e.prototype.moveByRvo=function(){var t=b.DW_Simulator.instance.getAgentPosition(this.rvoAgentId);this.node.setPosition(t.x,t.y)},e.prototype.attack=function(){if(!g.default.Instance.isPause&&!this.isDie)switch(this.bulletEffect){case 6:this.shootBullets(g.default.Instance.playerCtrl,this.bulletPro);break;case 8:this.sendBullets(this.bulletPro);break;default:this.sendBullets(1)}},e.prototype.enemyColAtk=function(){g.default.Instance.isPause||this.isDie||(u.AudioMgr.getInstance().playEffectFree(h.DW_AudioId.mutouzhuangji),g.default.Instance.attackEd(this.atkForce))},e.prototype.getPlayRoleNear=function(t){for(var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),o=[],i=0,n=g.default.Instance.plankAllList;i<n.length;i++){var a=n[i];if(a.active){var r=a.convertToWorldSpaceAR(cc.v2(0,0)),s=cc.Vec2.distance(e,r);o.push({enemy:a,dist:s})}}return o.sort(function(t,e){return t.dist-e.dist}),o.slice(0,t).map(function(t){return t.enemy})},e.prototype.sendBullets=function(t){var e=this,o=this.getPlayRoleNear(t);if(o.length>0)for(var i=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),a=function(t){var a=t,r=o[a].convertToWorldSpaceAR(cc.v2(0,0)).sub(i).normalize(),s=180*Math.atan2(r.y,r.x)/Math.PI-90;setTimeout(function(){y.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(g.default.Instance.roleBulletBase);var o=t.parent.convertToNodeSpaceAR(n);t.setPosition(o),t.angle=s;var i={typeID:e.typeID,level:1,atkForce:e.atkForce,criticalChance:0,criticalForce:0,bulletEffect:e.bulletEffect,bulletPro:e.bulletPro,dir:r,isSplitBullet:!1,atkInterval:e.atkInterval};t.getComponent(B.default).init(i,e.atkPos,!0)})},70*a)},r=0;r<o.length;r++)a(r)},e.prototype.shootBullets=function(t,e,o){var i=this;void 0===e&&(e=3),void 0===o&&(o=15);for(var n=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),a=t.convertToWorldSpaceAR(cc.v2(0,0)).sub(n).normalize(),r=180*Math.atan2(a.y,a.x)/Math.PI-90,s=Math.floor(e/2),c=function(t){var e=r+(t-s)*o,n=(e+90)*Math.PI/180,a=cc.v2(Math.cos(n),Math.sin(n)).normalize();y.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(g.default.Instance.roleBulletBase);var o=i.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=t.parent.convertToNodeSpaceAR(o);t.setPosition(n),t.angle=e;var r={typeID:i.typeID,level:1,atkForce:i.atkForce,criticalChance:0,criticalForce:0,bulletEffect:i.bulletEffect,bulletPro:i.bulletPro,dir:a,isSplitBullet:!1,atkInterval:i.atkInterval};t.getComponent(B.default).init(r,i.atkPos,!0)})},l=0;l<e;l++)c(l)},e.prototype.rolePlaySkill=function(t,e){if(!this.isDie){switch(t){case 8:this.frozenEd(3)}this.attackEd(e,!1)}},e.prototype.attackEd=function(t,e){this.isDie||(this.nowHp-=t,this.isPlayHarm||(g.default.Instance.playHarmEff(t,e,this.node),this.playHarmTime=0,this.isPlayHarm=!0),this.nowHp<1?(this.isDie=!0,this.die(!0)):(this.hpBar.node.parent.active||(this.hpBar.node.parent.active=!0),this.updeteHpBar(),cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.2,{color:cc.Color.WHITE}).start()))},e.prototype.knockback=function(){this.isDie||(this.isKnockback=!0,this.knockbackTime=0)},e.prototype.frozenEd=function(t){var e=this;this.isDie||(this.setSpAnim(!0),t>this.frozenCountTime&&(this.frozenCountTime=t),b.DW_Simulator.instance.setMaxSpeed(this.rvoAgentId,0),this.skillFrozen=!0,this.frozenPos.active=!0,0==this.frozenPos.childrenCount&&this.loadPrefab(h.DW_BundleName.Prefabs,"effAnim/frozen",function(t){var o=cc.instantiate(t);o.setParent(e.frozenPos),o.setPosition(cc.v2())}))},e.prototype.speedCut=function(t){if(!this.isDie&&this.enemyState!=l.attack){var e=1-t;e<0&&(e=0),e<this.cutSpeed&&(this.cutSpeed=e,this.moveSpeed=this.basicsMoveSpeed*this.cutSpeed,this.spAnim.timeScale=1*e,b.DW_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed)),this.isSpeedCut=!0,this.speCutTime=2}},e.prototype.setSpAnimPlaySpeed=function(){var t=this.spAnim.findAnimation(h.DW_AnimName.attack);this.clipDuration=t.duration,this.atkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.atkInterval*1.05)},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.die=function(t){if(this.isDie=!0,this.enemyState=l.die,101==this.enemyType)return g.default.Instance.setPause(!0),void d.UIMgr.getInstance().openUI(h.DW_UIID.DW_UIGameOver,1,!0);this.frozenPos.removeAllChildren(),this.upSpeedAnim.removeAllChildren(),t?(g.default.Instance.addDropExp(this.exp),g.default.Instance.playEnemyDieEff(this.node)):g.default.Instance.playEnemyColRole(this.node),b.DW_Simulator.instance.removeAgent(this.rvoAgentId),u.AudioMgr.getInstance().playEffectFree(h.DW_AudioId.siwang),g.default.Instance.removeEnemyList(this.node),y.default.getInstance().pushObj(this.node)},e.prototype.setSpAnim=function(t){this.isDie||this.skillFrozen||(this.spAnim.paused=t)},c([C(sp.Skeleton)],e.prototype,"spAnim",void 0),c([C(cc.Node)],e.prototype,"boxCol",void 0),c([C(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([C(cc.Node)],e.prototype,"frozenPos",void 0),c([C(cc.Node)],e.prototype,"plank",void 0),c([C(cc.Node)],e.prototype,"atkPos",void 0),c([C(cc.Node)],e.prototype,"upSpeedAnim",void 0),c([C(cc.Integer)],e.prototype,"enemyType",void 0),c([P],e)}(p.default);a.default=D,cc._RF.pop(),cc._RF.pop()},{}],DW_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"fa312LXHVRGr7AuBkEfd67q","DW_GameData");var i=e,n=o;cc._RF.push(i,"fa312LXHVRGr7AuBkEfd67q","DW_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emDW_GameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.BoxCfg="BoxCfg",t.mateCfg="mateCfg",t.GearParameterCfg="GearParameterCfg",t.BossCfg="BossCfg",t.enemyCfg="enemyCfg",t.enemyID="enemyID",t.wave1Cfg="wave1Cfg",t.CharacterCfg="CharacterCfg",t.CharacterNum="CharacterNum"}(n.emDW_GameDataKeys||(n.emDW_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],DW_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"5bc93QNpn9HM4CoC+g6z5xk","DW_GameEnumData");var i=e,n=o;cc._RF.push(i,"5bc93QNpn9HM4CoC+g6z5xk","DW_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.DW_enumGearParameterCfg=void 0,function(t){t[t.StartWood=1]="StartWood",t[t.StartHealthy=2]="StartHealthy",t[t.StartSpeed=3]="StartSpeed",t[t.WoodCostSpeed=4]="WoodCostSpeed",t[t.EnemySpeed=5]="EnemySpeed",t[t.StoreRefreshCost=6]="StoreRefreshCost",t[t.StartGold=7]="StartGold",t[t.SpeedThreshold=8]="SpeedThreshold",t[t.MonsterSpeedUp=9]="MonsterSpeedUp",t[t.MonsterSpeedUpLimt=10]="MonsterSpeedUpLimt",t[t.EnemyAtkRange=11]="EnemyAtkRange",t[t.EnemyAtkSpeed=12]="EnemyAtkSpeed",t[t.EnemyBulletSpeed=13]="EnemyBulletSpeed",t[t.MaxWoodNum=14]="MaxWoodNum",t[t.PlayerSpeedTop=20]="PlayerSpeedTop"}(n.DW_enumGearParameterCfg||(n.DW_enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],DW_GameMgr:[function(t,e,o){"use strict";cc._RF.push(e,"75263hogdVNeZz5yJXADWyO","DW_GameMgr");var i=t,n=e,a=o;cc._RF.push(n,"75263hogdVNeZz5yJXADWyO","DW_GameMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("DW_Config"),h=i("DW_DataMgr"),f=i("DW_GameEnumData"),m=i("DW_HarmEff"),g=i("DW_SeaWave"),y=i("DW_Skills"),v=i("DW_PoolMgr"),_=i("DW_AddPropTips"),b=i("DW_Prop"),B=i("DW_QuadTreeMgr"),I=i("DW_EnemyRole"),P=i("DW_PlankBox"),C=i("DW_RoleBox"),D=i("DW_RoleField"),T=i("DW_Common"),S=i("DW_Simulator"),A=cc._decorator,k=A.ccclass,w=A.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.joystickCtrl=null,e.gameTopRoot=null,e.boxInfoTips=null,e.shopRoot=null,e.boxSpare=null,e.playerCtrl=null,e.boxDish=null,e.roleFieldBase=null,e.buffBoxIcon=null,e.txtBuffBoxLevel=null,e.buffBoxExpBar=null,e.hpBar=null,e.hpIcon=null,e.txtHp=null,e.atkIcon=null,e.txtAtk=null,e.enemyBaseTop=null,e.enemyBaseMin=null,e.skillsBase=null,e.skillRoleBase=null,e.harmEffBase=null,e.roleBulletBase=null,e.levelBar=null,e.txtLevel=null,e.mapBg=null,e.cutMapMask=null,e.botBase=null,e.atkEdAnim=null,e.propBase=null,e.btn_PlayGo=null,e.goldRoot=null,e.txtGoldNum=null,e.btnUpdateSpare=null,e.txtSpareGold=null,e.txtDownInitWaveTime=null,e.trailingPre=null,e.mapCamera=null,e.uiCamera=null,e.boxDishList=[],e.plankAllList=[],e.maxPlankNum=0,e.propAllList={},e.mapWidth=3750,e.mapHeight=3999,e.roleMapWidth=0,e.roleMapHeight=0,e.isPause=!1,e.isfight=!0,e.isPrepare=!1,e.boxSpareAll=[],e.sceneAllBox=[],e.pitchBox=null,e.roleMateTips=null,e.tipsBoxInfo=null,e.nowMaxWave=0,e.nowminWave=0,e.outWaveTime=0,e.waveInterval=0,e.isCanWave=!1,e.enemyTypeNum={},e.outEnemyInterval=.2,e.outEnemyTime=0,e.isWaveGameOver=!1,e.isWaveOver=!1,e.nowWaveAllNum=0,e.waveEnemySum=0,e.waveGoldNum=0,e.mapID=1,e.mapMaxWave=8,e.mapNowWave=0,e.enemyAllLsit=[],e.dropLevel=0,e.dropUpLevelExp=0,e.dropNowExp=0,e.dropOpenNum=1,e.basicsHp=0,e.maxHp=0,e.nowHp=0,e.returnHp=0,e.returnHpTime=0,e.isShiftAtk=!0,e.shiftAtkTime=0,e.goldNum=0,e.updateSpareGold=5,e.initFirstWave=!0,e.downInitWaveTime=3,e.nowInitWaveTime=0,e.lastInitWaveTime=0,e.playerView=1,e.playerViewNum=0,e.updatePlayerViewNum=0,e.seaWaveInterval=0,e.seaWaveTime=0,e.moveAnimTime=.2,e._StepEnemy=0,e._PropCol=0,e.testNnm=0,e.radius=750,e.showSelectBuffUI=!1,e.color_Green=cc.color().fromHEX("#08f61b"),e.color_Red=cc.color().fromHEX("#ff4a4a"),e.lastGoldNum=0,e.initUpdateSpare=!1,e.dishPosXCfg={1:67,1.5:33.5,2:0,2.5:-33.5,3:-67},e.dishPosYCfg={1.5:-100.5,2:-67,2.5:-33.5,3:0,3.5:33.5,4:67,4.5:100.5},e.lastmMinDisPath=null,e.lastAllAtk=0,e.lastNowHp=100,e.solderGainIDs=[],e.activateSkills=[],e.mateCfgs=[],e.activateSkillAtks=[],e.buffCfg=[],e.buffSelectionCount={},e.buffsPerRefresh=3,e.roleBoxBuffAtk={},e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this)},e.prototype.start=function(){cc.game.setFrameRate(59),this.uiCamera=cc.find("uiRoot/Main Camera").getComponent(cc.Camera),this.btn_PlayGo.on(cc.Node.EventType.TOUCH_END,this.playGame,this),this.btnUpdateSpare.on(cc.Node.EventType.TOUCH_END,this.btnUpdateSpareCall,this),this.initData(),this.initBoxDishList(),this.txtLevel.string="\u7b2c"+(this.mapNowWave+1)+"/"+this.mapMaxWave+"\u6ce2",S.DW_Simulator.instance.setAgentDefaults(60,8,1,.1,20,320,new T.DW_Vector2(0,0)),B.default.Instance.playerQuadTreeAllInfo.push(this.playerCtrl),this.seaWaveInterval=this.random(.4,2);for(var t=0;t<15;t++)this.propAllList[t]=!1},e.prototype.onDestroy=function(){o.Instance=null},e.prototype.initData=function(){this.characterCfg=JSON.parse(JSON.stringify(h.default.getInstance().data.CharacterCfg)),this.mateCfgs=h.default.getInstance().data.mateCfg,this.buffCfg=h.default.getInstance().data.buffCfg,this.dropUpLevelExp=h.default.getInstance().getBuffBoxExpCfg(this.dropOpenNum),this.basicsHp=h.default.getInstance().getParameterCfg(f.DW_enumGearParameterCfg.StartHealthy),this.waveCfg=h.default.getInstance().data.wave1Cfg,this.goldNum=h.default.getInstance().getParameterCfg(f.DW_enumGearParameterCfg.StartGold),this.updateSpareGold=h.default.getInstance().getParameterCfg(f.DW_enumGearParameterCfg.StoreRefreshCost),this.maxPlankNum=h.default.getInstance().getParameterCfg(f.DW_enumGearParameterCfg.MaxWoodNum),this.maxHp=this.basicsHp,this.nowHp=this.maxHp,this.txtAtk.string=""+this.nowHp,this.txtGoldNum.string=""+this.goldNum,this.lastGoldNum=this.goldNum,this.setUpdateSpareGold()},e.prototype.initBoxDishList=function(){for(var t=this,e=0,o=0,i=0,n=this.boxDish.children;i<n.length;i++){var a=n[i];this.boxDishList[e]||(this.boxDishList[e]=[]),this.boxDishList[e][o]={box:a,plank:null,roleSp:null},a.active=!1,5==++e&&(e=0,o++)}var r=[[1,2],[2,2],[3,2],[1,3],[2,3],[3,3]],s=[[2,2],[2,3]],c=this.randomBoxs(s.length,!1);this.loadPrefab(d.DW_BundleName.Prefabs,"roleBox/plankBox",function(e){for(var o=0;o<r.length;o++){var i=r[o][0],n=r[o][1],a=cc.instantiate(e),l=t.boxDishList[i][n].box;l.active=!0,a.setParent(l),a.setPosition(cc.v2());var p=a.getComponent(P.default);p.isUpField=!0,p.unLockRole(),p.initTrailing(),t.boxDishList[i][n].plank=a,t.plankAllList.push(a)}t.loadPrefab(d.DW_BundleName.Prefabs,"roleBox/roleBox",function(e){for(var o=0;o<s.length;o++){var i=s[o][0],n=s[o][1],a=t.boxDishList[i][n].plank,r=c[o],l=cc.instantiate(e);l.setParent(t.roleFieldBase);var p=a.convertToWorldSpaceAR(cc.v3(0,0)),u=t.node.parent.convertToNodeSpaceAR(p);l.setPosition(u);var d=l.getComponent(C.default);d.init(r.CharacterID,r.grade),d.upBoxEnter(cc.v2(i,n),a),d.unLockRole(),d.setCutShowRole(!0),t.boxDishList[i][n].roleSp=d,t.sceneAllBox.push(d),t.updateSumPro(),t.updateSolderID()}}),t.hideDishBox(),t.setRoleMoveMaxPos()})},e.prototype.setPause=function(t){this.isPause=t,this.sendEvent(d.DW_EventName.SetPause,this.isPause),this.sendEvent(d.DW_EventName.PauseJoystickK)},e.prototype.isUpBoxFight=function(){for(var t=0;t<this.boxDishList.length;t++)for(var e=0;e<this.boxDishList[t].length;e++)if(null!=this.boxDishList[t][e].roleSp)return!0;return!1},e.prototype.playGame=function(){null==this.pitchBox?this.isUpBoxFight()?(this.isPrepare=!1,this.playMoveAnim(!0),this.sendEvent(d.DW_EventName.PlayGame),this.updateEnemyMaxWave(),this.isfight=!0,p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.kaishi)):this.upTipsBox("\u8bf7\u5148\u4e0a\u9635\u89d2\u8272"):this.upTipsBox("\u8bf7\u677e\u5f00\u683c\u5b50\u540e\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c")},e.prototype.waveOver=function(){var t=this;this.isfight=!1,this.sendEvent(d.DW_EventName.PauseJoystickK),this.sendEvent(d.DW_EventName.waveOver),v.default.getInstance().clear();var e=function(){if(t.txtLevel.string="\u7b2c"+(t.mapNowWave+1)+"/"+t.mapMaxWave+"\u6ce2",cc.Tween.stopAllByTarget(t.levelBar),t.levelBar.progress=0,t.movePlayerCameraCenter(),t.playMoveAnim(!1),t.setGoldNum(t.waveGoldNum),t.upAddBoxWeight(),t.updateBoxSpare(),p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.bocijieshu),0!=t.returnHp&&t.nowHp!=t.maxHp){var e=t.round(t.maxHp*t.returnHp);t.nowHp+=e,t.nowHp>t.maxHp&&(t.nowHp=t.maxHp),t.updeteHpBar()}};8==this.nowMaxWave||23==this.nowMaxWave?(this.mapID++,this.mapNowWave=0,8==this.nowMaxWave?this.mapMaxWave=15:23==this.nowMaxWave&&(this.mapMaxWave=3),this.cutMap(e)):e()},e.prototype.playMoveAnim=function(t){var e=this;if(!this.isPrepare){var o=cc.v3(),i=0,n=1,a=.2;t?(o=cc.v3(0,this.shopRoot.y-600),i=255,this.joystickCtrl.opacity=0,this.joystickCtrl.active=!0,n=1,a=.5,cc.tween(this.mapCamera).to(.5,{zoomRatio:this.playerView}).start()):(o=cc.v3(0,this.shopRoot.y+600),i=0,n=1.3,a=.2,cc.tween(this.mapCamera).to(.5,{zoomRatio:1}).start()),cc.tween(this.shopRoot).to(this.moveAnimTime,{position:o}).call(function(){t||(e.isPrepare=!0,e.joystickCtrl.active=!1)}).start(),cc.tween(this.joystickCtrl).to(this.moveAnimTime,{opacity:i}).start(),cc.tween(this.playerCtrl).to(a,{scale:n}).start()}},e.prototype.movePlayerCameraCenter=function(){var t=this.mapCamera.node.convertToWorldSpaceAR(cc.Vec3.ZERO),e=this.playerCtrl.parent.convertToNodeSpaceAR(t);cc.Tween.stopAllByTarget(this.playerCtrl),cc.tween(this.playerCtrl).to(this.moveAnimTime,{position:e}).start()},e.prototype.update=function(t){var e=this;if(!this.isPause){if((this.seaWaveTime+=t)>this.seaWaveInterval&&(this.seaWaveTime=0,this.seaWaveInterval=this.random(.5,2.2),v.default.getInstance().getObj("effAnim/seaWave",function(t){t.setParent(e.botBase),t.setPosition(e.randomSeaPos()),t.getComponent(g.default).init(),e.tierBoxList(e.botBase)})),this.initFirstWave)return this.downInitWaveTime-=t,this.nowInitWaveTime=Math.floor(this.downInitWaveTime),this.nowInitWaveTime!=this.lastInitWaveTime&&(this.txtDownInitWaveTime.string=""+this.nowInitWaveTime,cc.tween(this.txtDownInitWaveTime.node).to(.17,{scale:1.4}).to(.17,{scale:1}).start()),this.lastInitWaveTime=this.nowInitWaveTime,void(this.downInitWaveTime<1&&(this.initFirstWave=!1,this.txtDownInitWaveTime.node.active=!1,this.updateEnemyMaxWave(),p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.kaishi)));if(this.isfight){S.DW_Simulator.instance.run(t);for(var o=0,i=this.enemyAllLsit;o<i.length;o++)i[o].getComponent(I.default).moveByRvo();if(this._PropCol++>15){this._PropCol=0;for(var n=!1,a=0,r=this.plankAllList;a<r.length;a++){for(var s=r[a].getBoundingBoxToWorld(),c=0,l=this.propBase.children;c<l.length;c++){var u=l[c],h=u.getBoundingBoxToWorld();if(cc.Intersection.rectRect(s,h)){var f=u.getComponent(b.default);this.addProp(f.typeID,f.node),this.propAllList[f.key]=!1,u.destroy(),n=!0;break}}if(n)break}}if(this._StepEnemy++>30){this._StepEnemy=0;for(var m=0,y=this.enemyAllLsit;m<y.length;m++){var _=y[m];_.y>this.playerCtrl.y?_.setParent(this.enemyBaseTop):_.setParent(this.enemyBaseMin)}this.tierBoxList(this.enemyBaseMin),this.tierBoxList(this.enemyBaseTop)}if(this.enemyAllLsit.length<50)if(!this.isWaveOver&&this.isCanWave)this.outWaveTime+=t,this.outWaveTime>this.waveInterval&&(this.nowminWave++,this.updateEnemyMinWave());else if(this.outEnemyTime+=t,this.outEnemyTime>this.outEnemyInterval){this.outEnemyTime=0;var B=Object.keys(this.enemyTypeNum);if(0===B.length)return void(this.isCanWave=!0);this.isCanWave=!1;var P=Number(B[Math.floor(Math.random()*B.length)]);this.enemyTypeNum[P],this.outEnemy(P),this.enemyTypeNum[P]-=1,0==this.enemyTypeNum[P]&&delete this.enemyTypeNum[P],0===Object.keys(this.enemyTypeNum).length?this.isCanWave=!0:this.isCanWave=!1}}}},e.prototype.updateEnemyMaxWave=function(){this.mapNowWave++,this.nowMaxWave++,this.nowMaxMonsterInfo=[],this.waveEnemySum=0,this.nowWaveAllNum=0,this.waveGoldNum=0;for(var t=0;t<this.waveCfg.length;t++)this.waveCfg[t].id==this.nowMaxWave&&(this.nowMaxMonsterInfo.push(this.waveCfg[t]),this.nowWaveAllNum+=this.waveCfg[t].MonsterSum,this.waveGoldNum+=this.round(this.waveCfg[t].Golden),t==this.waveCfg.length-1&&(this.isWaveGameOver=!0));this.nowminWave=0,this.isWaveOver=!1,this.updateEnemyMinWave(),this.updateProp()},e.prototype.updateEnemyMinWave=function(){if(!(this.nowminWave>this.nowMaxMonsterInfo.length-1)){this.enemyTypeNum=[],this.outWaveTime=0,this.waveInterval=this.nowMaxMonsterInfo[this.nowminWave].FirstInterval;for(var t=this.nowMaxMonsterInfo[this.nowminWave].MonsterSum,e=0;e<this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++){var o=this.nowMaxMonsterInfo[this.nowminWave].Monster[e][0];this.enemyTypeNum[o]=1}for(e=0;e<t-this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++)this.addOutEnemyQueue(this.nowMaxMonsterInfo[this.nowminWave].Monster);this.nowminWave==this.nowMaxMonsterInfo.length-1&&(this.isWaveOver=!0),this.isCanWave=!1}},e.prototype.addOutEnemyQueue=function(t){var e=this.random(0,t.length,!0),o=t[e][0];this.enemyTypeNum[o]==t[e][1]?this.addOutEnemyQueue(t):this.enemyTypeNum[o]+=1},e.prototype.outEnemy=function(t,e){var o=this;void 0===e&&(e=!1);var i="enemy/enemy_"+t;e&&(i="enemy/enemy_Boss"),v.default.getInstance().getObj(i,function(t){t.setParent(o.enemyBaseMin),t.setPosition(o.enemyRandomPosInCircle()),t.y>o.playerCtrl.y&&t.setParent(o.enemyBaseTop),t.getComponent(I.default).init(o.nowMaxWave),B.default.Instance.addInfoQuadTree(t),o.enemyAllLsit.push(t)})},e.prototype.enemyRandomPosInCircle=function(){var t=this.playerCtrl.convertToWorldSpaceAR(cc.Vec2.ZERO),e=360*Math.random()*Math.PI/180,o=t.x+Math.cos(e)*this.radius,i=t.y+Math.sin(e)*this.radius,n=cc.v2(o,i);return this.enemyBaseMin.convertToNodeSpaceAR(n)},e.prototype.removeEnemyList=function(t){B.default.Instance.removeInfoQuadTree(t);var e=this.enemyAllLsit.indexOf(t);this.enemyAllLsit.splice(e,1),this.waveEnemySum++,this.updateLevelBar(),this.waveEnemySum>=this.nowWaveAllNum&&0==this.enemyAllLsit.length&&(this.isWaveGameOver?this.outEnemy(1,!0):(this.isfight=!1,this.waveOver()))},e.prototype.getEnemyNear=function(t,e,o){for(var i=t.convertToWorldSpaceAR(cc.Vec2.ZERO),n=[],a=0,r=this.enemyAllLsit;a<r.length;a++){var s=r[a];if(s.active){var c=s.convertToWorldSpaceAR(cc.Vec2.ZERO),l=cc.Vec2.distance(i,c);l<o&&n.push({enemy:s,dist:l})}}return n.sort(function(t,e){return t.dist-e.dist}),n.slice(0,e).map(function(t){return t.enemy})},e.prototype.getCollisionBullet=function(t){for(var e=B.default.Instance.getTreeColliderList(t),o=t.getBoundingBoxToWorld(),i=0,n=e;i<n.length;i++){var a=n[i],r=a.node.getComponent(I.default).boxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(o,r))return a.node}return null},e.prototype.getBlastCollisionBullet=function(t){for(var e=B.default.Instance.getTreeColliderList(t),o=[],i=t.getBoundingBoxToWorld(),n=0,a=e;n<a.length;n++){var r=a[n],s=r.node.getComponent(I.default).boxCol.getBoundingBoxToWorld();cc.Intersection.rectRect(i,s)&&o.push(r.node)}return o},e.prototype.updateLevelBar=function(){var t=this.waveEnemySum/this.nowWaveAllNum;cc.Tween.stopAllByTarget(this.levelBar),cc.tween(this.levelBar).to(.1,{progress:t}).start()},e.prototype.cutMap=function(t){var e=this;p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.huanditu),this.cutMapMask.active=!0,this.cutMapMask.opacity=0,cc.tween(this.cutMapMask).to(1,{opacity:255}).call(function(){e.updatePlayerViewNum!=e.playerViewNum&&(e.updatePlayerViewNum=e.playerViewNum);for(var o=0,i=e.propBase.children;o<i.length;o++)i[o].destroy();e.propBase.removeAllChildren();for(var n=0;n<15;n++)e.propAllList[n]=!1;e.loadSpriteFrame(d.DW_BundleName.Sprite,"map/bg"+e.mapID,function(o){for(var i=0,n=e.mapBg.children;i<n.length;i++)n[i].getComponent(cc.Sprite).spriteFrame=o;cc.tween(e.cutMapMask).to(1,{opacity:0}).call(function(){t(),e.cutMapMask.active=!1,e.sendEvent(d.DW_EventName.CutMap)}).start()})}).start()},e.prototype.updateProp=function(){for(var t=this,e=[],o=0,i=Object.entries(this.propAllList);o<i.length;o++){var n=i[o],a=n[0],r=n[1],s=Number(a);r||e.push(s)}var c;c=e.length<=2?e.slice():e.sort(function(){return Math.random()-.5}).slice(0,2);for(var l=function(e){var o=p.random(1,8,!0),i=p.roleBoxBuffAtk[9002]||0;if(3==o&&p.updatePlayerViewNum>=3)do{o=p.random(1,8,!0)}while(3==o);if(i>=1&&1==o)do{o=p.random(1,8,!0)}while(1==o);3==o&&p.updatePlayerViewNum++;var n="prop/prop"+o;p.loadPrefab(d.DW_BundleName.Prefabs,n,function(o){var i=cc.instantiate(o);i.setParent(t.propBase);var n=t.mapBg.children[e].convertToWorldSpaceAR(cc.Vec2.ZERO),a=i.parent.convertToNodeSpaceAR(n);i.setPosition(a),i.getComponent(b.default).init(e),t.propAllList[e]=!0})},p=this,u=0,h=c;u<h.length;u++)l(h[u])},e.prototype.randomSeaPos=function(){var t=this.random(200,500),e=this.playerCtrl.convertToWorldSpaceAR(cc.Vec2.ZERO),o=360*Math.random()*Math.PI/180,i=e.x+Math.cos(o)*t,n=e.y+Math.sin(o)*t,a=cc.v2(i,n);return this.botBase.convertToNodeSpaceAR(a)},e.prototype.playSkillsAtk=function(t){for(var e,o,i=this,n=0,a=7,r=0;r<this.boxDishList.length;r++)for(var s=0;s<this.boxDishList[r].length;s++)if(null!=this.boxDishList[r][s].roleSp){var c=this.boxDishList[r][s].roleSp;c.skillID==t&&c.level<a&&(n=c.typeID,a=c.level)}e=h.default.getInstance().getBoxProInfo(n,a).Atk,o=h.default.getInstance().getSkillsCfg(t).mateSkillATK;var l=this.round(o*e);if(7==t)this.loadPrefab(d.DW_BundleName.Prefabs,"roleBox/roleFieldSkill",function(t){var e=cc.instantiate(t);e.setParent(i.skillRoleBase),e.getComponent(D.default).summonSkill(l)});else{var p="skills/skill_"+t;this.loadPrefab(d.DW_BundleName.Prefabs,p,function(e){var o=cc.instantiate(e);o.setParent(i.skillsBase),o.setPosition(cc.v3()),o.getComponent(y.default).init(l,t)})}},e.prototype.addDropExp=function(t,e){var o=this;void 0===e&&(e=!1);var i=this.roleBoxBuffAtk[9005]||0;if(i+=1,this.dropNowExp+=this.round(t*i),e&&(this.dropNowExp=this.dropUpLevelExp),!this.showSelectBuffUI)if(this.dropNowExp>=this.dropUpLevelExp&&this.dropLevel<4){this.dropLevel++,this.dropOpenNum++;var n=this.dropNowExp-this.dropUpLevelExp;this.dropNowExp=n;var a=this.dropNowExp/this.dropUpLevelExp;this.buffBoxExpBar.progress=0,this.txtBuffBoxLevel.string=""+(this.dropLevel+1),this.loadSpriteFrame(d.DW_BundleName.Sprite,"buffBoxIcon/box_0"+(this.dropLevel+1),function(t){o.buffBoxIcon.getComponent(cc.Sprite).spriteFrame=t}),this.dropUpLevelExp=h.default.getInstance().getBuffBoxExpCfg(this.dropOpenNum),cc.Tween.stopAllByTarget(this.buffBoxExpBar),cc.tween(this.buffBoxExpBar).to(.1,{progress:a}).start(),this.showSelectBuffUI=!0;var r=this.showBuffSelection(this.dropLevel);u.UIMgr.getInstance().openUIOfCallback(d.DW_UIID.DW_UISelectBuff,1,function(){o.setPause(!0)},r)}else{if(4==this.dropLevel)return;a=this.dropNowExp/this.dropUpLevelExp,cc.Tween.stopAllByTarget(this.buffBoxExpBar),cc.tween(this.buffBoxExpBar).to(.1,{progress:a}).start()}},e.prototype.openBuffBox=function(){var t=this;this.dropLevel=0,this.dropNowExp=0,this.txtBuffBoxLevel.string=""+(this.dropLevel+1),this.buffBoxExpBar.progress=0,this.dropUpLevelExp=h.default.getInstance().getBuffBoxExpCfg(this.dropOpenNum),this.loadSpriteFrame(d.DW_BundleName.Sprite,"buffBoxIcon/box_0"+(this.dropLevel+1),function(e){t.buffBoxIcon.getComponent(cc.Sprite).spriteFrame=e})},e.prototype.setGoldNum=function(t){var e=this;t=this.round_2(t),this.goldNum+=t,this.txtGoldNum.node.color=this.goldNum>this.lastGoldNum?this.color_Green:this.color_Red,this.txtGoldNum.string=""+this.goldNum,cc.Tween.stopAllByTarget(this.goldRoot),cc.tween(this.goldRoot).to(.1,{scale:1.3}).to(.1,{scale:1}).call(function(){e.txtGoldNum.node.color=cc.Color.WHITE}).start(),this.lastGoldNum=this.goldNum,this.sendEvent(d.DW_EventName.SetGoldNum),this.setUpdateSpareGold()},e.prototype.isGoldEnough=function(t){return t=this.round_2(t),this.goldNum-t>=0},e.prototype.setUpdateSpareGold=function(){var t=this.isGoldEnough(this.updateSpareGold);this.txtSpareGold.string=""+this.updateSpareGold,this.txtSpareGold.node.color=t?cc.Color.WHITE:this.color_Red},e.prototype.btnUpdateSpareCall=function(){null==this.pitchBox?this.isGoldEnough(this.updateSpareGold)?(this.setGoldNum(-this.updateSpareGold),this.updateBoxSpare(),p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.shuaixnshangdian)):this.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"):this.upTipsBox("\u8bf7\u677e\u5f00\u683c\u5b50\u540e\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c")},e.prototype.updateBoxSpare=function(){for(var t=this,e=0,o=this.boxSpareAll;e<o.length;e++){var i=o[e].getComponent(C.default);if(null!=i){var n=this.sceneAllBox.indexOf(i);this.sceneAllBox.splice(n,1)}}this.boxSpare.removeAllChildren(),this.boxSpareAll=[];for(var a=0,r=this.randomBoxs(3),s=function(e){a++,c.initUpdateSpare&&3==a?(c.initUpdateSpare=!1,c.addPlankBox(),3==a&&c.calculateLayout(-1,!0)):1001==e.CharacterID?(c.addPlankBox(),c.characterCfg[10].weight=135,3==a&&c.calculateLayout(-1,!0)):c.loadPrefab(d.DW_BundleName.Prefabs,"roleBox/roleBox",function(o){var i=cc.instantiate(o);i.setParent(t.boxSpare);var n=i.getComponent(C.default);n.init(e.CharacterID,e.grade),t.boxSpareAll.push(i),t.sceneAllBox.push(n),t.sendEvent(d.DW_EventName.UpdateSceneAllBox,t.sceneAllBox),3==a&&t.calculateLayout(-1,!0)})},c=this,l=0,p=r;l<p.length;l++)s(p[l])},e.prototype.randomBoxs=function(t,e){var o=this;void 0===e&&(e=!0);for(var i=this.characterCfg.filter(function(t){return!(t.weight<=0||o.plankAllList.length>=o.maxPlankNum&&1001==t.CharacterID||!e&&1001==t.CharacterID)}),n=[],a=[],r=0,s=0,c=i;s<c.length;s++)r+=c[s].weight,a.push(r);for(var l=r,p=0;p<t;p++)for(var u=Math.random()*l,d=0;d<a.length;d++)if(u<a[d]){n.push(i[d]);break}return this.characterCfg[10].weight+=this.characterCfg[10].weightUp,n},e.prototype.upAddBoxWeight=function(){for(var t=0,e=this.characterCfg;t<e.length;t++){var o=e[t];o.weight+=o.weightUp}},e.prototype.addPlankBox=function(){var t=this;this.loadPrefab(d.DW_BundleName.Prefabs,"roleBox/plankBox",function(e){var o=cc.instantiate(e);o.setParent(t.boxSpare),t.insertRoleBoxSpare(o)})},e.prototype.movePlankBox=function(t,e){if(t==d.DW_OnTouchState.Start){if(this.setParentMap(e.node,this.gameTopRoot),this.boxSpareAll.includes(e.node)){var o=this.boxSpareAll.indexOf(e.node);this.boxSpareAll.splice(o,1),this.calculateLayout()}this.showDishBox()}for(var i=cc.v2(-1,-1),n=null,a=Number.MAX_SAFE_INTEGER,r=0;r<this.boxDishList.length;r++)for(var s=0;s<this.boxDishList[r].length;s++){var c=this.boxDishList[r][s];if(null==c.plank&&c.box.active){var l=this.getScreenDistance(e.node,c.box);l<a&&(a=l,l<65&&(i=cc.v2(r,s),n=c))}}if(null!=this.lastmMinDisPath&&a>=65&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1,!0),this.lastmMinDisPath=null),null!=n&&n!=this.lastmMinDisPath&&(null!=this.lastmMinDisPath&&this.playMoveBoxAnim(this.lastmMinDisPath,!1,!0),this.playMoveBoxAnim(n,!0,!0),this.lastmMinDisPath=n),t==d.DW_OnTouchState.End){if(null!=this.lastmMinDisPath&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1,!0),this.lastmMinDisPath=null),-1!=i.x){if(e.isLock){if(!this.isGoldEnough(e.lockGold))return this.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"),this.insertRoleBoxSpare(e.node),void this.hideDishBox();this.setGoldNum(-e.lockGold),e.unLockRole()}var p=this.boxDishList[i.x][i.y].box;this.setParentCamera(e.node,this.uiCamera,p,this.mapCamera),e.upBoxEnter(p),this.boxDishList[i.x][i.y].plank=e.node,this.plankAllList.push(e.node),this.sendEvent(d.DW_EventName.AddPlank),this.setRoleMoveMaxPos()}else this.insertRoleBoxSpare(e.node);this.hideDishBox()}},e.prototype.showDishBox=function(){for(var t=0;t<this.boxDishList.length;t++)for(var e=0;e<this.boxDishList[t].length;e++){var o=this.boxDishList[t][e];this.findPlank(cc.v2(t,e))?o.box.active||(o.box.active=!0,o.box.opacity=0,cc.tween(o.box).to(.15,{opacity:255}).start()):o.box.active=!1}},e.prototype.findPlank=function(t){if(null!=this.boxDishList[t.x][t.y].plank)return!0;for(var e=0,o=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];e<o.length;e++){var i=o[e],n=i.dx,a=i.dy,r=t.x+n,s=t.y+a;if(r>=0&&r<this.boxDishList.length&&s>=0&&s<this.boxDishList[0].length&&null!=this.boxDishList[r][s].plank)return!0}return!1},e.prototype.hideDishBox=function(){for(var t=[],e=0;e<this.boxDishList.length;e++){for(var o=[],i=function(i){var a=n.boxDishList[e][i];null==a.plank?a.box.active&&cc.tween(a.box).to(.15,{opacity:0}).call(function(){a.box.active=!1}).start():(a.plank.getComponent(P.default).hideRipple(),t.push(cc.v2(e,i)),0==o.length?(o[0]=cc.v2(e,i),o[1]=cc.v2(e,i)):i<o[0].y?o[0]=cc.v2(e,i):i>o[1].y&&(o[1]=cc.v2(e,i)))},n=this,a=0;a<this.boxDishList[e].length;a++)i(a);0!=o.length&&(this.boxDishList[o[0].x][o[0].y].plank.getComponent(P.default).showRipple(0),this.boxDishList[o[1].x][o[1].y].plank.getComponent(P.default).showRipple(2))}var r=this.boxDishList.length,s=this.boxDishList[0].length;for(a=0;a<s;a++){var c=[];for(e=0;e<r;e++)null!=this.boxDishList[e][a].plank&&(0==c.length?(c[0]=cc.v2(e,a),c[1]=cc.v2(e,a)):e<c[0].x?c[0]=cc.v2(e,a):e>c[1].x&&(c[1]=cc.v2(e,a)));0!=c.length&&(this.boxDishList[c[0].x][c[0].y].plank.getComponent(P.default).showRipple(1),this.boxDishList[c[1].x][c[1].y].plank.getComponent(P.default).showRipple(3))}for(var l=[],p=[],u=0,d=t;u<d.length;u++){var h=d[u];0==l.length?(l[0]=h,l[1]=h):h.x<l[0].x?l[0]=h:h.x>l[1].x&&(l[1]=h),0==p.length?(p[0]=h,p[1]=h):h.y<p[0].y?p[0]=h:h.y>p[1].y&&(p[1]=h)}var f=(l[0].x+l[1].x)/2,m=(p[0].y+p[1].y)/2,g=cc.v3(this.dishPosXCfg[f],this.dishPosYCfg[m]);this.boxDish.position.x==g.x&&this.boxDish.position.y==g.y||(cc.Tween.stopAllByTarget(this.boxDish),cc.tween(this.boxDish).to(.15,{position:g}).start(),cc.Tween.stopAllByTarget(this.roleFieldBase),cc.tween(this.roleFieldBase).to(.15,{position:g}).start())},e.prototype.setRoleMoveMaxPos=function(){for(var t=[],e=0;e<this.boxDishList.length;e++)for(var o=0;o<this.boxDishList[e].length;o++)null!=this.boxDishList[e][o].plank&&t.push(cc.v2(e,o));for(var i=[],n=[],a=0,r=t;a<r.length;a++){var s=r[a];0==i.length?(i[0]=s.x,i[1]=s.x):s.x<i[0]?i[0]=s.x:s.x>i[1]&&(i[1]=s.x),0==n.length?(n[0]=s.y,n[1]=s.y):s.y<n[0]?n[0]=s.y:s.y>n[1]&&(n[1]=s.y)}var c=i[1]-i[0]+1,l=n[1]-n[0]+1;this.roleMapWidth=(this.mapWidth-67*c)/2,this.roleMapHeight=(this.mapHeight-67*l)/2},e.prototype.moveRoleBox=function(t,e){if(t==d.DW_OnTouchState.Start){if(this.boxSpareAll.includes(e.node)){var o=this.boxSpareAll.indexOf(e.node);this.boxSpareAll.splice(o,1),this.calculateLayout()}-1!=e.mapKey.x?(this.boxDishList[e.mapKey.x][e.mapKey.y].roleSp=null,this.setParentCamera(e.node,this.mapCamera,this.gameTopRoot,this.uiCamera)):this.setParentMap(e.node,this.gameTopRoot)}for(var i=cc.v2(-1,-1),n=null,a=Number.MAX_SAFE_INTEGER,r=0;r<this.boxDishList.length;r++)for(var s=0;s<this.boxDishList[r].length;s++){var c=this.boxDishList[r][s];if(null!=c.plank){var l=this.getScreenDistance(e.node,c.plank);l<a&&(a=l,l<65&&(i=cc.v2(r,s),n=c))}}null!=this.lastmMinDisPath&&a>=65&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1,!1),this.lastmMinDisPath=null),null!=n&&n!=this.lastmMinDisPath&&(null!=this.lastmMinDisPath&&this.playMoveBoxAnim(this.lastmMinDisPath,!1,!1),this.playMoveBoxAnim(n,!0,!1),this.lastmMinDisPath=n),t==d.DW_OnTouchState.End&&(null!=this.lastmMinDisPath&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1,!1),this.lastmMinDisPath=null),this.endroleBox(e,i))},e.prototype.playMoveBoxAnim=function(t,e,o){var i,n=e?1.18:1,a=e?cc.Color.GREEN:cc.Color.WHITE,r=e?.06:.15;i=o?t.box:t.plank,cc.Tween.stopAllByTarget(i),cc.tween(i).to(r,{scale:n,color:a}).start()},e.prototype.endroleBox=function(t,e){var o=this;if(-1!=e.x){if(t.isLock){if(!this.isGoldEnough(t.lockGold))return this.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"),t.setCutShowRole(!1),t.downBoxEnter(),void this.insertRoleBoxSpare(t.node);this.setGoldNum(-t.lockGold),t.unLockRole()}if(null!=this.boxDishList[e.x][e.y].roleSp){var i=this.boxDishList[e.x][e.y].roleSp;if(i.typeID==t.typeID&&i.level==t.level&&i.level<5){var n=i.node.convertToWorldSpaceAR(cc.Vec3.ZERO),a=cc.v3();this.mapCamera.getWorldToScreenPoint(n,a);var r=cc.v3();this.uiCamera.getScreenToWorldPoint(a,r);var s=t.node.parent.convertToNodeSpaceAR(r);return cc.Tween.stopAllByTarget(t.node),void cc.tween(t.node).to(.1,{position:s}).call(function(){i.upBoxLevel();var e=o.sceneAllBox.indexOf(t);o.sceneAllBox.splice(e,1),o.sendEvent(d.DW_EventName.UpdateSceneAllBox,o.sceneAllBox),t.die(),o.updateSumPro(),o.updateSolderID()}).start()}}if(-1!=t.mapKey.x&&null!=this.boxDishList[e.x][e.y].roleSp){var c=this.boxDishList[t.mapKey.x][t.mapKey.y];this.boxDishList[e.x][e.y].roleSp.upBoxEnter(t.mapKey,c.plank),this.boxDishList[t.mapKey.x][t.mapKey.y].roleSp=this.boxDishList[e.x][e.y].roleSp}else if(null!=this.boxDishList[e.x][e.y].roleSp){var l=this.boxDishList[e.x][e.y].roleSp;l.setCutShowRole(!1),this.insertRoleBoxSpare(l.node),l.downBoxEnter()}this.setParentCamera(t.node,this.uiCamera,this.roleFieldBase,this.mapCamera),t.upBoxEnter(e,this.boxDishList[e.x][e.y].plank),this.boxDishList[e.x][e.y].roleSp=t,p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.fangrugezi)}else{for(var u=this.getWorldPosV2(t.node),h=function(e){var i=f.getWorldPosV2(e);if(cc.Vec2.distance(u,i)<60){var n=e.getComponent(C.default);if(null!=n&&n.typeID==t.typeID&&n.level==t.level&&n.level<5&&!n.isLock){if(t.isLock){if(!f.isGoldEnough(t.lockGold))return f.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"),f.insertRoleBoxSpare(t.node),{value:void 0};f.setGoldNum(-t.lockGold),t.unLockRole()}var a=n.node.convertToWorldSpaceAR(cc.v3(0,0)),r=t.node.parent.convertToNodeSpaceAR(a);return cc.Tween.stopAllByTarget(t.node),cc.tween(t.node).to(.1,{position:r}).call(function(){n.upBoxLevel();var e=o.sceneAllBox.indexOf(t);o.sceneAllBox.splice(e,1),o.sendEvent(d.DW_EventName.UpdateSceneAllBox,o.sceneAllBox),t.die()}).start(),{value:void 0}}}},f=this,m=0,g=this.boxSpareAll;m<g.length;m++){var y=h(g[m]);if("object"==typeof y)return y.value}t.setCutShowRole(!1),t.downBoxEnter(),this.insertRoleBoxSpare(t.node)}this.updateSumPro(),this.updateSolderID()},e.prototype.insertRoleBoxSpare=function(t){var e=t.getComponent(C.default);null!=e&&-1!=e.mapKey.x?this.setParentCamera(t,this.mapCamera,this.boxSpare,this.uiCamera):this.setParentMap(t,this.boxSpare);var o=this.findPosIndex(t);o<this.boxSpare.childrenCount&&this.boxSpare.insertChild(t,o),o>this.boxSpareAll.length?this.boxSpareAll.push(t):this.boxSpareAll.splice(o,0,t),this.calculateLayout(o)},e.prototype.findPosIndex=function(t){if(0==this.boxSpareAll.length)return 0;for(var e=0,o=Number.MAX_SAFE_INTEGER,i=this.getWorldPosV2(t),n=0;n<this.boxSpareAll.length;n++){var a=cc.Vec2.distance(i,this.getWorldPosV2(this.boxSpareAll[n]));a<o&&(o=a,e=n)}return this.getWorldPosV2(this.boxSpareAll[e]).x>i.x?e:e+1},e.prototype.calculateLayout=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=this.boxSpareAll;if(!(o.length<1)){var i=this.boxSpare.width-20,n=o.reduce(function(t,e){return t+e.width},0),a=[];if(n<=i)for(var r=-i/2+(p=(i-n)/(o.length+1)),s=0,c=o;s<c.length;s++){var l=c[s];a.push(cc.v3(r+l.width/2,0)),r+=l.width+p}else for(var p=(i-n)/(o.length-1),u=(r=-i/2,0),d=o;u<d.length;u++)l=d[u],a.push(cc.v3(r+l.width/2,0)),r+=l.width+p;for(var h=0;h<o.length;h++){var f=h,m=o[f];cc.Tween.stopAllByTarget(m),t==f||e?cc.tween(m).to(.2,{position:a[f],angle:this.random(0,1)>.5?7:-7},{easing:"quadOut"}).start():cc.tween(m).to(.2,{position:a[f]},{easing:"quadOut"}).start()}}},e.prototype.updateSumPro=function(){for(var t=this,e=this.nowHp/this.maxHp,o=this.basicsHp,i=0,n=0;n<this.boxDishList.length;n++)for(var a=0;a<this.boxDishList[n].length;a++)if(null!=this.boxDishList[n][a].roleSp){var r=this.boxDishList[n][a].roleSp;o+=r.maxHp,i+=r.atkEffect}this.maxHp=this.round(o),this.nowHp=this.round(this.maxHp*e),this.updeteHpBar(),this.txtAtk.string=""+i,this.lastAllAtk!=i&&(this.txtAtk.node.color=i>this.lastAllAtk?this.color_Green:this.color_Red,cc.Tween.stopAllByTarget(this.atkIcon),cc.tween(this.atkIcon).to(.1,{scale:1.25}).to(.1,{scale:1}).call(function(){t.txtAtk.node.color=cc.Color.WHITE}).start()),this.lastAllAtk=i},e.prototype.attackEd=function(t){this.isPrepare||(this.isShiftAtk=!1,this.shiftAtkTime=3,this.nowHp-=this.round(t),this.updeteHpBar(),this.nowHp<1&&(this.setPause(!0),u.UIMgr.getInstance().openUI(d.DW_UIID.DW_UIGameOver,1,!1),p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.shibai)),this.playAtkEdAnim())},e.prototype.playAtkEdAnim=function(){cc.Tween.stopAllByTarget(this.atkEdAnim),cc.tween(this.atkEdAnim).to(.1,{opacity:255}).to(.15,{opacity:0}).start()},e.prototype.addNowHp=function(t){t<0&&(this.isShiftAtk=!1,this.shiftAtkTime=3);var e=this.round(this.maxHp*t);this.nowHp+=e,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.nowHp<1&&(this.setPause(!0),u.UIMgr.getInstance().openUI(d.DW_UIID.DW_UIGameOver,1,!1),p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.shibai)),this.updeteHpBar()},e.prototype.updeteHpBar=function(){var t=this;this.txtHp.string=""+this.nowHp,this.lastNowHp!=this.nowHp&&(this.txtHp.node.color=this.nowHp>this.lastNowHp?this.color_Green:this.color_Red,cc.Tween.stopAllByTarget(this.hpIcon),cc.tween(this.hpIcon).to(.1,{scale:1.25}).to(.1,{scale:1}).call(function(){t.txtHp.node.color=cc.Color.WHITE}).start()),this.lastNowHp=this.nowHp;var e=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.15,{progress:e}).start()},e.prototype.updateSolderID=function(){this.solderGainIDs=[],this.activateSkillAtks=[];for(var t=0;t<this.boxDishList.length;t++)for(var e=0;e<this.boxDishList[t].length;e++)if(null!=this.boxDishList[t][e].roleSp){var o=this.boxDishList[t][e].roleSp;this.solderGainIDs.includes(o.typeID)||this.solderGainIDs.push(o.typeID),(null==this.activateSkillAtks[o.skillID]||o.level<this.activateSkillAtks[o.skillID])&&(this.activateSkillAtks[o.skillID]=o.level)}this.getActivatedMateIDs()},e.prototype.getActivatedMateIDs=function(){var t=this;this.activateSkills=[];for(var e=function(e){for(var i=0,n=o.mateCfgs;i<n.length;i++){var a=n[i];o.activateSkills.includes(a.mateID)||a.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).includes(e)})&&a.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).every(function(e){return t.solderGainIDs.includes(e)})})&&o.activateSkills.push(a.mateID)}},o=this,i=0,n=this.solderGainIDs;i<n.length;i++)e(n[i]);this.sendEvent(d.DW_EventName.ActivateSkills,this.activateSkills,this.activateSkillAtks)},e.prototype.showBuffSelection=function(t){var e=this.getAvailableBuffs(t);return this.getRandomBuffs(e,this.buffsPerRefresh)},e.prototype.onBuffSelected=function(t){this.buffSelectionCount[t]=(this.buffSelectionCount[t]||0)+1},e.prototype.getAvailableBuffs=function(t){var e=this;return this.buffCfg.filter(function(o){if(o.buffQuality==t)return(e.buffSelectionCount[o.ID]||0)<o.buffNum})},e.prototype.getRandomBuffs=function(t,e){if(t.length<=e)return t;for(var o=[],i=t,n=0;n<e;n++){for(var a=0,r=0,s=i;r<s.length;r++)a+=s[r].buffweight;for(var c=Math.random()*a,l=-1,p=0;p<i.length;p++)if((c-=i[p].buffweight)<0){l=p;break}l>=0&&(o.push(i[l]),i.splice(l,1))}return o},e.prototype.selectBuff=function(t,e){switch(e=this.round_2(e),t){case 9001:case 9002:case 9003:case 9004:case 9005:case 9006:case 9007:null==this.roleBoxBuffAtk[t]?this.roleBoxBuffAtk[t]=e:this.roleBoxBuffAtk[t]+=e,this.sendEvent(d.DW_EventName.UpdateRolePro),this.updateSumPro(),9007==t?this.sendEvent(d.DW_EventName.BuffAddMoveSpeed):9006==t&&(this.returnHp+=e);break;case 9008:this.addNowHp(e);break;case 9009:this.setGoldNum(e)}},e.prototype.addProp=function(t,e){switch(p.AudioMgr.getInstance().playEffectFree(d.DW_AudioId.shengji),t){case 1:null==this.roleBoxBuffAtk[9002]?this.roleBoxBuffAtk[9002]=.05:this.roleBoxBuffAtk[9002]+=.05,this.sendEvent(d.DW_EventName.UpdateRolePro),this.playPropTips(t,"\u66b4\u51fb\u7387+5%",e);break;case 2:null==this.roleBoxBuffAtk[9004]?this.roleBoxBuffAtk[9004]=.05:this.roleBoxBuffAtk[9004]+=.05,this.updateSumPro(),this.sendEvent(d.DW_EventName.UpdateRolePro),this.playPropTips(t,"\u653b\u51fb\u529b+5%",e);break;case 3:this.playerViewNum++,this.playerView-=.05,this.sendEvent(d.DW_EventName.PlayerView),cc.tween(this.mapCamera).to(.5,{zoomRatio:this.playerView}).start(),this.playPropTips(t,"\u89c6\u91ce+10%",e);break;case 4:this.addNowHp(.1),this.playPropTips(t,"\u8840\u91cf+10%",e,this.color_Green);break;case 5:this.setGoldNum(10),this.playPropTips(t,"\u91d1\u5e01+10",e);break;case 6:this.addDropExp(1,!0);break;case 7:this.addNowHp(-.2),this.playPropTips(t,"\u8840\u91cf-20%",e,this.color_Red)}},e.prototype.playPropTips=function(t,e,o,i){var n=this;void 0===i&&(i=cc.Color.WHITE);var a=o.convertToWorldSpaceAR(cc.Vec3.ZERO);this.loadPrefab(d.DW_BundleName.Prefabs,"effAnim/addPropTips",function(o){var r=cc.instantiate(o);r.setParent(n.roleBulletBase);var s=r.parent.convertToNodeSpaceAR(a);r.setPosition(s),r.getComponent(_.default).init(t,e,i)})},e.prototype.playEffAnim=function(t){var e=this,o=t.node.convertToWorldSpaceAR(cc.Vec3.ZERO),i=cc.v3();-1!=t.mapKey.x&&this.mapCamera.getWorldToScreenPoint(o,i),v.default.getInstance().getObj("effAnim/boxUpLevelEff",function(n){n.setParent(e.gameTopRoot);var a=n.parent.convertToNodeSpaceAR(o);if(-1!=t.mapKey.x){var r=cc.v3();e.uiCamera.getScreenToWorldPoint(i,r),a=n.parent.convertToNodeSpaceAR(r)}n.setPosition(a)})},e.prototype.playHarmEff=function(t,e,o){var i=this,n=o.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/harmEff",function(o){o.setParent(i.harmEffBase);var a=o.parent.convertToNodeSpaceAR(n);a.y+=50,o.setPosition(a),o.getComponent(m.default).init(i.round(t),e)})},e.prototype.playEnemyDieEff=function(t){var e=this,o=t.position;v.default.getInstance().getObj("effAnim/enemyDieEff",function(t){t.setParent(e.enemyBaseMin),t.setPosition(o)})},e.prototype.playEnemyColRole=function(t,e){var o=this;void 0===e&&(e=null);var i=t.position;v.default.getInstance().getObj("effAnim/enemyColRole",function(t){if(t.setParent(o.enemyBaseMin),null!=e){var n=t.parent.convertToNodeSpaceAR(e);t.setPosition(n)}else t.setPosition(i)})},e.prototype.tierBoxList=function(t){var e=t.children;e.length<2||(e.sort(function(t,e){return e.y-t.y}),e.forEach(function(t,e){t.setSiblingIndex(e)}))},e.prototype.upTipsBox=function(t){this.sendEvent(d.DW_EventName.upTipsBox,t)},e.prototype.getScreenDistance=function(t,e){var o=this.getRealScreenPos(t,this.uiCamera),i=this.getRealScreenPos(e,this.mapCamera);return cc.Vec2.distance(o,i)},e.prototype.getRealScreenPos=function(t,e){var o=t.convertToWorldSpaceAR(cc.Vec3.ZERO),i=cc.v2();return e.getWorldToScreenPoint(o,i),i},e.prototype.getWorldPosV2=function(t){return t.parent.convertToWorldSpaceAR(t.getPosition())},e.prototype.getWorldPosV3=function(t){return t.parent.convertToWorldSpaceAR(t.position)},e.prototype.setParentMap=function(t,e){var o=this.getWorldPosV3(t);t.setParent(e);var i=e.convertToNodeSpaceAR(o);t.setPosition(i)},e.prototype.setParentCamera=function(t,e,o,i){var n=t.convertToWorldSpaceAR(cc.Vec3.ZERO),a=cc.v3();e.getWorldToScreenPoint(n,a),t.setParent(o);var r=cc.v3();i.getScreenToWorldPoint(a,r);var s=o.convertToNodeSpaceAR(r);t.setPosition(s)},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.prototype.round_2=function(t){return Math.round(100*t)/100},e.Instance=null,c([w(cc.Node)],e.prototype,"joystickCtrl",void 0),c([w(cc.Node)],e.prototype,"gameTopRoot",void 0),c([w(cc.Node)],e.prototype,"boxInfoTips",void 0),c([w(cc.Node)],e.prototype,"shopRoot",void 0),c([w(cc.Node)],e.prototype,"boxSpare",void 0),c([w(cc.Node)],e.prototype,"playerCtrl",void 0),c([w(cc.Node)],e.prototype,"boxDish",void 0),c([w(cc.Node)],e.prototype,"roleFieldBase",void 0),c([w(cc.Node)],e.prototype,"buffBoxIcon",void 0),c([w(cc.Label)],e.prototype,"txtBuffBoxLevel",void 0),c([w(cc.ProgressBar)],e.prototype,"buffBoxExpBar",void 0),c([w(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([w(cc.Node)],e.prototype,"hpIcon",void 0),c([w(cc.Label)],e.prototype,"txtHp",void 0),c([w(cc.Node)],e.prototype,"atkIcon",void 0),c([w(cc.Label)],e.prototype,"txtAtk",void 0),c([w(cc.Node)],e.prototype,"enemyBaseTop",void 0),c([w(cc.Node)],e.prototype,"enemyBaseMin",void 0),c([w(cc.Node)],e.prototype,"skillsBase",void 0),c([w(cc.Node)],e.prototype,"skillRoleBase",void 0),c([w(cc.Node)],e.prototype,"harmEffBase",void 0),c([w(cc.Node)],e.prototype,"roleBulletBase",void 0),c([w(cc.ProgressBar)],e.prototype,"levelBar",void 0),c([w(cc.Label)],e.prototype,"txtLevel",void 0),c([w(cc.Node)],e.prototype,"mapBg",void 0),c([w(cc.Node)],e.prototype,"cutMapMask",void 0),c([w(cc.Node)],e.prototype,"botBase",void 0),c([w(cc.Node)],e.prototype,"atkEdAnim",void 0),c([w(cc.Node)],e.prototype,"propBase",void 0),c([w(cc.Node)],e.prototype,"btn_PlayGo",void 0),c([w(cc.Node)],e.prototype,"goldRoot",void 0),c([w(cc.Label)],e.prototype,"txtGoldNum",void 0),c([w(cc.Node)],e.prototype,"btnUpdateSpare",void 0),c([w(cc.Label)],e.prototype,"txtSpareGold",void 0),c([w(cc.Label)],e.prototype,"txtDownInitWaveTime",void 0),c([w(cc.Prefab)],e.prototype,"trailingPre",void 0),c([w(cc.Camera)],e.prototype,"mapCamera",void 0),o=c([k],e)}(l.default);a.default=N,cc._RF.pop(),cc._RF.pop()},{}],DW_HarmEff:[function(t,e,o){"use strict";cc._RF.push(e,"04349AbfLhBx4N/+P+GgBNg","DW_HarmEff");var i=t,n=e,a=o;cc._RF.push(n,"04349AbfLhBx4N/+P+GgBNg","DW_HarmEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconCritical=null,e.txtHarm=null,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.iconCritical.active=e,this.node.opacity=255,this.txtHarm.string=""+t;var i=this.node.position.clone();i.y+=40,cc.tween(this.node).to(.3,{position:i}).call(function(){i.y+=40}).to(.3,{position:i,opacity:0}).call(function(){o.die()}).start()},e.prototype.die=function(){p.default.getInstance().pushObj(this.node)},c([h(cc.Node)],e.prototype,"iconCritical",void 0),c([h(cc.Label)],e.prototype,"txtHarm",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_JoystickCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"11e69qZpppMzYm5vzb8AmEB","DW_JoystickCtrl");var i=t,n=e,a=o;cc._RF.push(n,"11e69qZpppMzYm5vzb8AmEB","DW_JoystickCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=i("DW_GameMgr"),d=i("DW_PlayerCtrl"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.joystickBg=null,e.joystickKnob=null,e.playerCtrl=null,e.startPositon=null,e.maxDistance=0,e.handleDistance=0,e.joystickInitialPos=null,e.moveX=0,e.moveY=0,e.direction=cc.v3(),e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.addEvent(p.DW_EventName.PauseJoystickK,function(){t.direction=cc.v3(),t.playerCtrl.onTouchMove(p.DW_OnTouchState.End,t.direction),t.joystickBg.setPosition(t.joystickInitialPos),t.joystickKnob.setPosition(0,0,0)}),this.joystickInitialPos=this.joystickBg.position.clone(),this.maxDistance=this.joystickBg.width/2,this.handleDistance=this.joystickKnob.width/2,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onKeyDown=function(t){if(u.default.Instance.isfight){switch(0===this.moveX&&0===this.moveY&&this.playerCtrl.onTouchMove(p.DW_OnTouchState.Start,this.direction),t.keyCode){case cc.macro.KEY.a:this.moveX=-1;break;case cc.macro.KEY.d:this.moveX=1;break;case cc.macro.KEY.w:this.moveY=1;break;case cc.macro.KEY.s:this.moveY=-1}this.direction=cc.v3(this.moveX,this.moveY),this.direction=this.direction.normalizeSelf(),this.playerCtrl.onTouchMove(p.DW_OnTouchState.Move,this.direction)}},e.prototype.onKeyUp=function(t){if(u.default.Instance.isfight){switch(t.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.d:this.moveX=0;break;case cc.macro.KEY.w:case cc.macro.KEY.s:this.moveY=0}this.direction=cc.v3(this.moveX,this.moveY),this.direction=this.direction.normalizeSelf(),this.playerCtrl.onTouchMove(p.DW_OnTouchState.Move,this.direction),0===this.moveX&&0===this.moveY&&this.playerCtrl.onTouchMove(p.DW_OnTouchState.End,this.direction)}},e.prototype.onTouchStart=function(t){u.default.Instance.isfight&&(cc.Tween.stopAllByTarget(this.joystickBg),this.startPositon=t.getLocation().add(this.node.getPosition()),this.joystickBg.setPosition(this.node.convertToNodeSpaceAR(t.getLocation())),this.playerCtrl.onTouchMove(p.DW_OnTouchState.Start,this.direction))},e.prototype.onTouchMove=function(t){if(u.default.Instance.isfight){var e=t.getLocation(),o=180*Math.atan2(e.y-this.startPositon.y,e.x-this.startPositon.x)/Math.PI,i=Math.sqrt(Math.pow(e.y-this.startPositon.y,2)+Math.pow(e.x-this.startPositon.x,2));this.setKnobPos(o,i)}},e.prototype.onTouchEnd=function(){u.default.Instance.isfight&&(this.direction=cc.v3(),this.playerCtrl.onTouchMove(p.DW_OnTouchState.End,this.direction),this.joystickKnob.setPosition(0,0,0),cc.Tween.stopAllByTarget(this.joystickBg),cc.tween(this.joystickBg).to(.03,{position:this.joystickInitialPos}).start())},e.prototype.setKnobPos=function(t,e){void 0===e&&(e=0),e=e<=this.maxDistance-this.handleDistance?e:this.maxDistance-this.handleDistance,this.joystickKnob.x=e*Math.cos(t*Math.PI/180),this.joystickKnob.y=e*Math.sin(t*Math.PI/180),this.direction=cc.v3(Math.cos(t*Math.PI/180),Math.sin(t*Math.PI/180),0),this.direction=this.direction.normalizeSelf(),this.playerCtrl.onTouchMove(p.DW_OnTouchState.Move,this.direction)},c([m(cc.Node)],e.prototype,"joystickBg",void 0),c([m(cc.Node)],e.prototype,"joystickKnob",void 0),c([m(d.default)],e.prototype,"playerCtrl",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DW_PlankBox:[function(t,e,o){"use strict";cc._RF.push(e,"9bda1A9+61I4bOTFxikHgkh","DW_PlankBox");var i=t,n=e,a=o;cc._RF.push(n,"9bda1A9+61I4bOTFxikHgkh","DW_PlankBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=i("DW_GameMgr"),d=i("DW_PlankRipple"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.box=null,e.lockRoot=null,e.txtLockGold=null,e.plankRipple=null,e.isLock=!0,e.lockGold=8,e.isUpField=!1,e.trailing=null,e.isTouchMove=!1,e.moveDir=cc.Vec3.ZERO,e.isTapTouchStart=!1,e.deviationOnStart=null,e.isShowTrailing=!1,e.color_Red=cc.color().fromHEX("#ff4a4a"),e}return s(e,t),e.prototype.start=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this);var e="roleBoxIcon/mufa0"+u.default.Instance.random(1,3,!0);this.loadSpriteFrame(p.DW_BundleName.Sprite,e,function(e){t.box.spriteFrame=e}),this.txtLockGold.string=""+this.lockGold,this.setGoldNum(),this.addEvent(p.DW_EventName.SetGoldNum,this.setGoldNum),this.addEvent(p.DW_EventName.PlayerOnTouchMove,this.onTouch)},e.prototype.onTouchStart=function(t){if(!this.isUpField&&u.default.Instance.isPrepare&&null==u.default.Instance.pitchBox){u.default.Instance.pitchBox=this.node,this.isTapTouchStart=!0,cc.Tween.stopAllByTarget(this.node),this.node.angle=0;var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.deviationOnStart=this.node.getPosition().subtract(e),this.updateTouchPos(t.getLocation()),u.default.Instance.movePlankBox(p.DW_OnTouchState.Start,this)}},e.prototype.onTouchMove=function(t){this.isTapTouchStart&&(this.updateTouchPos(t.getLocation()),u.default.Instance.movePlankBox(p.DW_OnTouchState.Move,this))},e.prototype.onTouchEnd=function(t){this.isTapTouchStart&&(this.isTapTouchStart=!1,u.default.Instance.pitchBox=null,this.updateTouchPos(t.getLocation()),u.default.Instance.movePlankBox(p.DW_OnTouchState.End,this))},e.prototype.updateTouchPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t).add(this.deviationOnStart);this.node.setPosition(e)},e.prototype.hideRipple=function(){this.plankRipple.hide(),this.isShowTrailing=!1,this.plankRipple.node.active=!1},e.prototype.showRipple=function(t){this.plankRipple.show(t),this.isShowTrailing=!0,this.plankRipple.node.active=!0},e.prototype.update=function(){this.isShowTrailing&&this.isTouchMove&&null!=this.trailing&&(this.worldPos=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),this.localPos=this.trailing.parent.convertToNodeSpaceAR(this.worldPos),this.trailing.setPosition(this.localPos),this.angle=180*Math.atan2(this.moveDir.y,this.moveDir.x)/Math.PI-90,this.trailing.angle=this.angle)},e.prototype.upBoxEnter=function(){var t=this;this.isUpField=!0,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.1,{position:cc.v3()}).call(function(){t.initTrailing()}).start()},e.prototype.initTrailing=function(){this.trailing=cc.instantiate(u.default.Instance.trailingPre),this.trailing.setParent(u.default.Instance.botBase),this.trailing.active=!1,this.plankRipple.setSkin()},e.prototype.setGoldNum=function(){if(this.isLock){var t=u.default.Instance.goldNum>=this.lockGold;this.txtLockGold.node.color=t?cc.Color.WHITE:this.color_Red}},e.prototype.unLockRole=function(){this.isLock=!1,this.lockRoot.active=!1},e.prototype.onTouch=function(t,e){switch(t){case p.DW_OnTouchState.Start:this.isTouchMove=!0,null!=this.trailing&&this.isShowTrailing&&(this.trailing.active=!0);break;case p.DW_OnTouchState.End:this.isTouchMove=!1,null!=this.trailing&&(this.trailing.active=!1)}this.moveDir=e},c([m(cc.Sprite)],e.prototype,"box",void 0),c([m(cc.Node)],e.prototype,"lockRoot",void 0),c([m(cc.Label)],e.prototype,"txtLockGold",void 0),c([m(d.default)],e.prototype,"plankRipple",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DW_PlankRipple:[function(t,e,o){"use strict";cc._RF.push(e,"3f862si8mBGgJTeNTXyabrj","DW_PlankRipple");var i=t,n=e,a=o;cc._RF.push(n,"3f862si8mBGgJTeNTXyabrj","DW_PlankRipple");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=i("DW_GameMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnims=[],e}return s(e,t),e.prototype.onLoad=function(){for(var t="skill_"+u.default.Instance.mapID,e=0;e<this.node.childrenCount;e++)this.spAnims[e]=this.node.children[e].getComponent(sp.Skeleton),this.spAnims[e].setSkin(t);this.addEvent(p.DW_EventName.CutMap,this.setSkin)},e.prototype.hide=function(){for(var t=0,e=this.spAnims;t<e.length;t++)e[t].node.active=!1},e.prototype.show=function(t){this.spAnims[t].node.active=!0},e.prototype.setSkin=function(){for(var t="skill_"+u.default.Instance.mapID,e=0,o=this.spAnims;e<o.length;e++)o[e].setSkin(t)},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_PlayerCamera:[function(t,e,o){"use strict";cc._RF.push(e,"2bae45Y77NPSrBoZqNl8AQ2","DW_PlayerCamera");var i=t,n=e,a=o;cc._RF.push(n,"2bae45Y77NPSrBoZqNl8AQ2","DW_PlayerCamera");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=i("DW_GameMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameMapCamera=null,e.cameraHalfWidth=0,e.cameraHalfHeight=0,e.isTouchMove=!1,e.moveDir=cc.v3(),e.isUpCameraView=!1,e.upCameraViewTime=0,e}return s(e,t),e.prototype.onLoad=function(){this.gameMapCamera=this.node.getComponent(cc.Camera),this.addEvent(p.DW_EventName.PlayerView,this.playerView)},e.prototype.start=function(){this.updateCameraHalfSize()},e.prototype.update=function(t){if(this.isUpCameraView){this.upCameraViewTime-=t,this.upCameraViewTime<0&&(this.isUpCameraView=!1),this.updateCameraHalfSize();var e=-u.default.Instance.mapWidth/2+this.cameraHalfWidth,o=u.default.Instance.mapWidth/2-this.cameraHalfWidth,i=-u.default.Instance.mapHeight/2+this.cameraHalfHeight,n=u.default.Instance.mapHeight/2-this.cameraHalfHeight,a=this.moveDir.clone();a.x=cc.misc.clampf(a.x,e,o),a.y=cc.misc.clampf(a.y,i,n),this.node.setPosition(a)}var r=-u.default.Instance.mapWidth/2+this.cameraHalfWidth,s=u.default.Instance.mapWidth/2-this.cameraHalfWidth,c=-u.default.Instance.mapHeight/2+this.cameraHalfHeight,l=u.default.Instance.mapHeight/2-this.cameraHalfHeight,p=this.moveDir.clone();p.x=cc.misc.clampf(p.x,r,s),p.y=cc.misc.clampf(p.y,c,l),this.node.setPosition(p)},e.prototype.onTouchMove=function(t,e){switch(t){case p.DW_OnTouchState.Start:this.isTouchMove=!0;break;case p.DW_OnTouchState.Move:break;case p.DW_OnTouchState.End:this.isTouchMove=!1}this.moveDir=e},e.prototype.playerView=function(){this.isUpCameraView=!0,this.upCameraViewTime=.6,this.updateCameraHalfSize()},e.prototype.updateCameraHalfSize=function(){var t=cc.view.getVisibleSize();this.cameraHalfWidth=t.width/2/this.gameMapCamera.zoomRatio,this.cameraHalfHeight=t.height/2/this.gameMapCamera.zoomRatio},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_PlayerCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f1064TWpYdAGYVXEF3dh9Su","DW_PlayerCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f1064TWpYdAGYVXEF3dh9Su","DW_PlayerCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=i("DW_DataMgr"),d=i("DW_GameEnumData"),h=i("DW_GameMgr"),f=i("DW_PlayerCamera"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerCamera=null,e.test=null,e.isTouchMove=!1,e.moveDir=cc.Vec3.ZERO,e.isKnockback=!1,e.knockbackOffset=cc.Vec3.ZERO,e.basicMoveSpeed=180,e.moveSpeed=0,e.maxMoveSpeed=0,e.subtractSpeed=0,e.plankNum=2,e.maxSubNum=6,e}return s(e,t),e.prototype.start=function(){this.basicMoveSpeed=u.default.getInstance().getParameterCfg(d.DW_enumGearParameterCfg.StartSpeed),this.subtractSpeed=u.default.getInstance().getParameterCfg(d.DW_enumGearParameterCfg.WoodCostSpeed),this.maxMoveSpeed=u.default.getInstance().getParameterCfg(d.DW_enumGearParameterCfg.PlayerSpeedTop),this.moveSpeed=this.basicMoveSpeed,this.addEvent(p.DW_EventName.AddPlank,this.upPlankNum),this.addEvent(p.DW_EventName.BuffAddMoveSpeed,this.setMoveSpeed),this.addEvent(p.DW_EventName.KnockbackPlayer,this.knockback)},e.prototype.upPlankNum=function(){this.plankNum=h.default.Instance.plankAllList.length;var t=0;this.plankNum>this.maxSubNum&&(t=(this.plankNum-this.maxSubNum)*this.subtractSpeed),this.moveSpeed=this.basicMoveSpeed-t;var e=h.default.Instance.roleBoxBuffAtk[9007]||0;e+=1,this.moveSpeed=Math.round(this.moveSpeed*e),this.moveSpeed,this.maxMoveSpeed},e.prototype.setMoveSpeed=function(){this.upPlankNum()},e.prototype.update=function(){if(!h.default.Instance.isPause&&(this.isKnockback&&((t=this.node.position.clone().add(this.knockbackOffset)).x>h.default.Instance.roleMapWidth?t.x=h.default.Instance.roleMapWidth:t.x<-h.default.Instance.roleMapWidth&&(t.x=-h.default.Instance.roleMapWidth),t.y>h.default.Instance.roleMapHeight?t.y=h.default.Instance.roleMapHeight:t.y<-h.default.Instance.roleMapHeight&&(t.y=-h.default.Instance.roleMapHeight),this.node.setPosition(t),this.playerCamera.onTouchMove(p.DW_OnTouchState.Move,t)),this.isTouchMove&&h.default.Instance.isfight)){var t,e=this.moveDir.mul(.016*this.moveSpeed);(t=this.node.position.add(e)).x>h.default.Instance.roleMapWidth?t.x=h.default.Instance.roleMapWidth:t.x<-h.default.Instance.roleMapWidth&&(t.x=-h.default.Instance.roleMapWidth),t.y>h.default.Instance.roleMapHeight?t.y=h.default.Instance.roleMapHeight:t.y<-h.default.Instance.roleMapHeight&&(t.y=-h.default.Instance.roleMapHeight),this.node.setPosition(t),this.playerCamera.onTouchMove(p.DW_OnTouchState.Move,t)}},e.prototype.knockback=function(t){var e=this;this.isKnockback=!0;var o=this.node.getPosition().sub(t.getPosition()).normalize().mul(25);this.knockbackOffset=cc.v3(o.x,o.y,0),cc.Tween.stopAllByTarget(this.knockbackOffset),cc.tween(this.knockbackOffset).to(.1,{x:0,y:0,z:0}).call(function(){e.knockbackOffset=cc.Vec3.ZERO,e.isKnockback=!1}).start()},e.prototype.onTouchMove=function(t,e){switch(t){case p.DW_OnTouchState.Start:this.isTouchMove=!0;break;case p.DW_OnTouchState.Move:break;case p.DW_OnTouchState.End:this.isTouchMove=!1}this.moveDir=e,this.playerCamera.onTouchMove(t,this.node.position.clone()),this.sendEvent(p.DW_EventName.PlayerOnTouchMove,t,e)},c([y(f.default)],e.prototype,"playerCamera",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],DW_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"4b0f1a/qsFAnYdDmwD8eqzF","DW_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"4b0f1a/qsFAnYdDmwD8eqzF","DW_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=i("DW_Config"),l=cc._decorator.ccclass,p=function(){function t(){this.poolMap={},this.poolRoot=null;var t=new cc.Node("DW_PoolRoot"),e=cc.find("uiRoot");t.setParent(e),e.insertChild(t,0),this.poolRoot=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e){var o=t.replace(/\//g,"_");this.poolMap[o]&&this.poolMap[o].poolList.length>0?e(this.poolMap[o].getObj()):s.ResourceMgr.getInstance().loadRes(c.DW_BundleName.Prefabs,t,cc.Prefab,function(t){var i=cc.instantiate(t);i.name=o,e(i)})},t.prototype.pushObj=function(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new u(t,this.poolRoot);this.poolMap[e]=o}},t.prototype.clear=function(){this.poolMap={},this.poolRoot.removeAllChildren()},e=r([l],t)}();a.default=p;var u=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],DW_Prop:[function(t,e,o){"use strict";cc._RF.push(e,"3b5d6kYkZ1NgpjUapgFqWXG","DW_Prop");var i=t,n=e,a=o;cc._RF.push(n,"3b5d6kYkZ1NgpjUapgFqWXG","DW_Prop");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=i("DW_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.typeID=0,e.spAnim=null,e.key=-1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(t){var e=this;if(this.key=t,1!=u.default.Instance.mapID&&7!=this.typeID){var o="propIcon/dao_0"+this.typeID+"_"+u.default.Instance.mapID;this.loadSpriteFrame(p.DW_BundleName.Sprite,o,function(t){e.node.getComponent(cc.Sprite).spriteFrame=t})}if(7==this.typeID){var i="skill_"+u.default.Instance.mapID;this.spAnim.setSkin(i)}},c([f(cc.Integer)],e.prototype,"typeID",void 0),c([f(sp.Skeleton)],e.prototype,"spAnim",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DW_QuadTreeMgr:[function(t,e,o){"use strict";cc._RF.push(e,"e8bf6mboOJMuqFL7PgaCMrB","DW_QuadTreeMgr");var i=t,n=e,a=o;cc._RF.push(n,"e8bf6mboOJMuqFL7PgaCMrB","DW_QuadTreeMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("DW_GameMgr"),u=i("DW_QuadTree"),d=cc._decorator,h=d.ccclass;d.property,function(t){t[t.enemy=0]="enemy",t[t.player=1]="player"}(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.quadTree=null,e.quadTreeAllInfo=[],e.playerQuadTree=null,e.playerQuadTreeAllInfo=[],e}var o;return s(e,t),o=e,Object.defineProperty(e,"Instance",{get:function(){if(!this.instance){var t=new cc.Node("DW_QuadTreeMgr"),e=cc.find("uiRoot");t.setParent(e),e.insertChild(t,0),this.instance=t.addComponent(o)}return this.instance},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.rebuildTree(),this.rebuildPlayerTree()},e.prototype.rebuildTree=function(){this.mapRect=cc.view.getViewportRect(),this.quadTree=new u.default(this.mapRect,0);for(var t=0,e=this.quadTreeAllInfo;t<e.length;t++){var o=e[t];if(this.isNodeVisibleByCamera(o)){var i=o.getBoundingBoxToWorld(),n={x:i.x,y:i.y,height:i.height,width:i.width,node:o};this.quadTree.insert(n)}}},e.prototype.isNodeVisibleByCamera=function(t){var e=t.convertToWorldSpaceAR(cc.v2(0,0)),o=p.default.Instance.mapCamera.getWorldToScreenPoint(e);return cc.view.getViewportRect().contains(cc.v2(o.x,o.y))},e.prototype.rebuildPlayerTree=function(){this.mapRect=cc.view.getViewportRect(),this.playerQuadTree=new u.default(this.mapRect,0);for(var t=0,e=this.playerQuadTreeAllInfo;t<e.length;t++){var o=e[t];if(this.isNodeVisibleByCamera(o)){var i=o.getBoundingBoxToWorld(),n={x:i.x,y:i.y,height:i.height,width:i.width,node:o};this.playerQuadTree.insert(n)}}},e.prototype.getPlaterTreeColliderList=function(t){var e=t.getBoundingBoxToWorld();return this.playerQuadTree?this.playerQuadTree.retrieve(e):[]},e.prototype.getTreeColliderList=function(t){var e=t.getBoundingBoxToWorld();return this.quadTree?this.quadTree.retrieve(e):[]},e.prototype.addInfoQuadTree=function(t){this.quadTreeAllInfo.push(t)},e.prototype.removeInfoQuadTree=function(t){var e=this.quadTreeAllInfo.indexOf(t);this.quadTreeAllInfo.splice(e,1)},e.prototype.clear=function(){this.quadTreeAllInfo=[],this.playerQuadTreeAllInfo=[]},o=c([h],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_QuadTree:[function(t,e,o){"use strict";cc._RF.push(e,"3926ew/0CVDRIqrZfU1dmVg","DW_QuadTree");var i=e,n=o;cc._RF.push(i,"3926ew/0CVDRIqrZfU1dmVg","DW_QuadTree");var a=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator.ccclass,s=function(){function t(t,e){this.nodes=[],this.objects=[],this.bounds=null,this.bounds=t,this.level=e,this.max_levels=4,this.max_objects=4,this.nodes=[],this.objects=[]}var e;return e=t,t.prototype.insert=function(t){if(this.nodes.length>0)for(var e=this.getIndex(t),o=0;o<e.length;o++)this.nodes[e[o]].insert(t);else if(this.objects.push(t),this.objects.length>this.max_objects&&this.level<this.max_levels){for(this.split(),o=0;o<this.objects.length;o++){e=this.getIndex(this.objects[o]);for(var i=0;i<e.length;i++)this.nodes[e[i]].insert(this.objects[o])}this.objects=[]}},t.prototype.split=function(){var t=this.level+1,o=this.bounds.x,i=this.bounds.y,n=this.bounds.width/2,a=this.bounds.height/2;this.nodes[0]=new e(new cc.Rect(o+n,i,n,a),t),this.nodes[1]=new e(new cc.Rect(o,i,n,a),t),this.nodes[2]=new e(new cc.Rect(o,i+a,n,a),t),this.nodes[3]=new e(new cc.Rect(o+n,i+a,n,a),t)},t.prototype.getIndex=function(t){var e=[],o=this.bounds.x+this.bounds.width/2,i=this.bounds.y+this.bounds.height/2,n=t.y<i,a=t.x<o,r=t.x+t.width>o,s=t.y+t.height>i;return n&&r&&e.push(0),a&&n&&e.push(1),a&&s&&e.push(2),r&&s&&e.push(3),e},t.prototype.retrieve=function(t){var e=this.objects;if(this.nodes.length>0)for(var o=this.getIndex(t),i=0;i<o.length;i++)e=e.concat(this.nodes[o[i]].retrieve(t));return e=e.filter(function(t,o){return e.indexOf(t)>=o})},e=a([r],t)}();n.default=s,cc._RF.pop(),cc._RF.pop()},{}],DW_RoleBox:[function(t,e,o){"use strict";cc._RF.push(e,"47c06JULMhFQo+gJeWU/rXs","DW_RoleBox");var i=t,n=e,a=o;cc._RF.push(n,"47c06JULMhFQo+gJeWU/rXs","DW_RoleBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("DW_Config"),d=i("DW_DataMgr"),h=i("DW_GameMgr"),f=i("DW_BoxInfoTipsBox"),m=i("DW_RoleMateTips"),g=i("DW_PoolMgr"),y=i("DW_RoleField"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelBox=null,e.levelIcon=null,e.roleIcon=null,e.tipsUpLevel=null,e.tipsLevelRoot=null,e.box=null,e.role=null,e.roleField=null,e.lockRoot=null,e.txtLockGold=null,e.tipsUpLevelInitPos=null,e.skillID=0,e.typeID=0,e.level=0,e.mapKey=cc.v2(-1,-1),e.boxCfg=null,e.atkForce=1,e.criticalChance=0,e.criticalForce=0,e.bulletEffect=0,e.bulletPro=1,e.atkInterval=1,e.atkEffect=0,e.maxHp=0,e.isLock=!0,e.lockGold=0,e.isTapTouchStart=!1,e.deviationOnStart=null,e.color_Red=cc.color().fromHEX("#ff4a4a"),e.upEnterCourse=!1,e.animIndexID=null,e}return s(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.tipsUpLevelInitPos=this.tipsUpLevel.position.clone(),this.addEvent(u.DW_EventName.UpdateSceneAllBox,this.updateAllBoxAccord),this.addEvent(u.DW_EventName.PlayGame,this.closeBoxUpTips),this.addEvent(u.DW_EventName.UpdateRolePro,this.updateRolePro),this.addEvent(u.DW_EventName.SetGoldNum,this.setGoldNum)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.animIndexID)},e.prototype.init=function(t,e){this.typeID=t,this.level=e,this.updateBoxPro(!0),this.roleField.setLevelIcon(),this.setCutShowRole(!1)},e.prototype.onTouchStart=function(t){if(!this.upEnterCourse&&h.default.Instance.isPrepare&&null==h.default.Instance.pitchBox){h.default.Instance.pitchBox=this.node,h.default.Instance.moveRoleBox(u.DW_OnTouchState.Start,this),this.isTapTouchStart=!0,this.playTipsInfo(!0),this.setCutShowRole(!0),cc.Tween.stopAllByTarget(this.node),this.node.angle=0,this.node.setScale(1),this.role.setScale(1.3);var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.deviationOnStart=this.node.getPosition().subtract(e),this.updateTouchPos(t.getLocation()),this.roleField.setSurrBulletActive(!1)}},e.prototype.onTouchMove=function(t){this.isTapTouchStart&&(this.updateTouchPos(t.getLocation()),h.default.Instance.moveRoleBox(u.DW_OnTouchState.Move,this))},e.prototype.onTouchEnd=function(t){this.isTapTouchStart&&(this.isTapTouchStart=!1,h.default.Instance.pitchBox=null,this.role.setScale(1),this.playTipsInfo(!1),this.updateTouchPos(t.getLocation()),h.default.Instance.moveRoleBox(u.DW_OnTouchState.End,this))},e.prototype.updateTouchPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t).add(this.deviationOnStart);this.node.setPosition(e)},e.prototype.playTipsInfo=function(t){var e=this;if(t){var o="",i="#5bfe1b";switch(this.level){case 1:i="#5bfe1b";break;case 2:i="#1bc1fe";break;case 3:i="#e11bfe";break;case 4:i="#ffdb14";break;case 5:i="#ff2371"}switch(this.typeID){case 1:o="<b><outline color=black width=4>\u609f\u7a7a\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u51fb\u9000</color>\u654c\u4eba\uff0c</outline></b>";break;case 3:o="<b><outline color=black width=4>\u5ae6\u5a25\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u51bb\u7ed3</color>\u654c\u4eba<color="+i+">"+this.bulletPro+"\u79d2</color></outline></b>";break;case 4:o="<b><outline color=black width=4>\u5218\u5907\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u7a7f\u900f"+(this.bulletPro-1)+"\u540d</color>\u654c\u4eba</outline></b>";break;case 5:o="<b><outline color=black width=4>\u8bf8\u845b\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u53d1\u5c04<color="+i+">"+this.bulletPro+"\u9897</color>\u5b50\u5f39</outline></b>";break;case 6:o="<b><outline color=black width=4>\u4e54\u5e2e\u4e3b\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u7206\u70b8</color>\u5c0f\u8303\u56f4\u4f24\u5bb3</outline></b>";break;case 7:o="<b><outline color=black width=4>\u7d2b\u971e\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u5b50\u5f39<color="+i+">\u5206\u88c2"+this.bulletPro+"\u6b21</color></outline></b>";break;case 8:o="<b><outline color=black width=4>\u5173\u7fbd\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u53d1\u5c04<color="+i+">"+this.bulletPro+"\u9897\u6247\u5f62</color>\u5b50\u5f39</outline></b>";break;case 10:o="<b><outline color=black width=4>\u900d\u9065\u50e7\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u56de\u65cb</color>\u5b50\u5f39</outline></b>";break;case 11:o="<b><outline color=black width=4>\u516b\u6212\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u73af\u7ed5<color="+i+">"+this.bulletPro+"\u9897</color>\u5b50\u5f39</outline></b>";break;case 17:o="<b><outline color=black width=4>\u5b59\u5c1a\u9999\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u5b50\u5f39<color="+i+">\u5f39\u5c04"+(this.bulletPro-1)+"\u6b21</color></outline></b>"}null==h.default.Instance.tipsBoxInfo?g.default.getInstance().getObj("tipsBox/boxInfoTipsBox",function(t){t.setParent(h.default.Instance.boxInfoTips),h.default.Instance.tipsBoxInfo=t.getComponent(f.default),h.default.Instance.tipsBoxInfo.init(o,e.typeID,e.level)}):h.default.Instance.tipsBoxInfo.init(o,this.typeID,this.level),null==h.default.Instance.roleMateTips?g.default.getInstance().getObj("tipsBox/roleMateTips",function(t){t.setParent(h.default.Instance.boxInfoTips),h.default.Instance.roleMateTips=t.getComponent(m.default),h.default.Instance.roleMateTips.init(e.skillID)}):h.default.Instance.roleMateTips.init(this.skillID)}else null!=h.default.Instance.tipsBoxInfo&&h.default.Instance.tipsBoxInfo.die(),null!=h.default.Instance.roleMateTips&&h.default.Instance.roleMateTips.die()},e.prototype.setCutShowRole=function(t){this.role.active=t,this.box.active=!t;var e=cc.v3();t&&(e=cc.v3(-5,0)),cc.Tween.stopAllByTarget(this.tipsLevelRoot),cc.tween(this.tipsLevelRoot).to(.1,{position:e}).start()},e.prototype.setGoldNum=function(){if(this.isLock){var t=h.default.Instance.goldNum>=this.lockGold;this.txtLockGold.node.color=t?cc.Color.WHITE:this.color_Red}},e.prototype.unLockRole=function(){this.isLock=!1,this.lockRoot.active=!1},e.prototype.upBoxEnter=function(t,e){var o=this;this.upEnterCourse=!0,this.mapKey=t,cc.Tween.stopAllByTarget(this.node);var i=e.convertToWorldSpaceAR(cc.v3(0,0)),n=this.node.parent.convertToNodeSpaceAR(i);cc.tween(this.node).to(.1,{position:n}).call(function(){o.upEnterCourse=!1,h.default.Instance.tierBoxList(h.default.Instance.roleFieldBase),10==o.bulletEffect&&o.roleField.upBoxEnter()}).start()},e.prototype.downBoxEnter=function(){this.mapKey=cc.v2(-1,-1),this.roleField.setSurrBulletActive(!1)},e.prototype.updateAllBoxAccord=function(t){for(var e=!1,o=0;o<t.length;o++)if(t[o]!=this){var i=t[o];if(i.typeID==this.typeID&&i.level==this.level&&this.level<5){e=!0;break}}e?this.openBoxUpTips():this.closeBoxUpTips()},e.prototype.openBoxUpTips=function(){var t=this;this.tipsUpLevel.active=!0,this.tipsUpLevel.setPosition(this.tipsUpLevelInitPos),clearInterval(this.animIndexID),this.animIndexID=null;var e=this.tipsUpLevelInitPos.clone();e.y+=7,cc.Tween.stopAllByTarget(this.tipsUpLevel),cc.tween(this.tipsUpLevel).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).start(),this.animIndexID=setInterval(function(){cc.tween(t.tipsUpLevel).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).start()},1200)},e.prototype.closeBoxUpTips=function(){this.tipsUpLevel.active&&(this.tipsUpLevel.active=!1,clearInterval(this.animIndexID),this.animIndexID=null)},e.prototype.upBoxLevel=function(){this.level>=5||(this.level++,this.updateBoxPro(),this.roleField.setLevelIcon(),h.default.Instance.playEffAnim(this),p.AudioMgr.getInstance().playEffectFree(u.DW_AudioId.shengji),this.roleField.addSurrBullet())},e.prototype.updateBoxPro=function(t){var e=this;void 0===t&&(t=!1);var o="roleBoxIcon/gezi_0"+this.level;this.loadSpriteFrame(u.DW_BundleName.Sprite,o,function(t){e.levelBox.spriteFrame=t});var i="roleBoxIcon/tb_0"+this.level;if(this.loadSpriteFrame(u.DW_BundleName.Sprite,i,function(t){e.levelIcon.spriteFrame=t}),t){var n="roleBoxIcon/tou_"+this.typeID;this.loadSpriteFrame(u.DW_BundleName.Sprite,n,function(t){e.roleIcon.spriteFrame=t})}this.boxCfg=d.default.getInstance().getBoxProInfo(this.typeID,this.level),this.skillID=this.boxCfg.mate,this.updateRolePro(),this.isLock&&(this.lockGold=this.round(this.boxCfg.StoreCost),this.txtLockGold.string=""+this.lockGold,this.setGoldNum())},e.prototype.updateRolePro=function(){var t=h.default.Instance.roleBoxBuffAtk[9001]||0,e=h.default.Instance.roleBoxBuffAtk[9002]||0,o=h.default.Instance.roleBoxBuffAtk[9003]||0,i=h.default.Instance.roleBoxBuffAtk[9004]||0;i+=1,this.atkForce=this.round(this.boxCfg.Atk*i),this.criticalChance=this.round_2(this.boxCfg.CriticPro+e),this.criticalForce=this.round_2(this.boxCfg.CriticProDamage+o),this.atkInterval=this.round_2(this.boxCfg.AtkSpeed),this.atkEffect=this.round(this.boxCfg.AtkEffect*i),this.maxHp=this.round(this.boxCfg.Healthy),this.bulletEffect=this.boxCfg.BulletEffect[0],this.bulletPro=this.round_2(this.boxCfg.BulletEffect[1]),t>0&&(this.atkInterval=this.round_2(this.atkInterval/(1+t)));var n={typeID:this.typeID,level:this.level,atkForce:this.atkForce,criticalChance:this.criticalChance,criticalForce:this.criticalForce,bulletEffect:this.bulletEffect,bulletPro:this.bulletPro,dir:null,isSplitBullet:!1,atkInterval:this.atkInterval};this.roleField.updateRolePro(n)},e.prototype.die=function(){this.node.destroy()},e.prototype.round_2=function(t){return Math.round(100*t)/100},e.prototype.round=function(t){return Math.round(t)},c([b(cc.Sprite)],e.prototype,"levelBox",void 0),c([b(cc.Sprite)],e.prototype,"levelIcon",void 0),c([b(cc.Sprite)],e.prototype,"roleIcon",void 0),c([b(cc.Node)],e.prototype,"tipsUpLevel",void 0),c([b(cc.Node)],e.prototype,"tipsLevelRoot",void 0),c([b(cc.Node)],e.prototype,"box",void 0),c([b(cc.Node)],e.prototype,"role",void 0),c([b(y.default)],e.prototype,"roleField",void 0),c([b(cc.Node)],e.prototype,"lockRoot",void 0),c([b(cc.Label)],e.prototype,"txtLockGold",void 0),c([_],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],DW_RoleBullet:[function(t,e,o){"use strict";cc._RF.push(e,"73911ewZw9MUL9xFPw3Ekgt","DW_RoleBullet");var i=t,n=e,a=o;cc._RF.push(n,"73911ewZw9MUL9xFPw3Ekgt","DW_RoleBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("DW_Config"),d=i("DW_DataMgr"),h=i("DW_GameEnumData"),f=i("DW_GameMgr"),m=i("DW_PoolMgr"),g=i("DW_QuadTreeMgr"),y=i("DW_EnemyRole"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.boxCol=null,e.blastCol=null,e.fieldBullet=null,e.roleAtk=null,e.isEnemyType=!1,e.typeID=0,e.isDie=!1,e.moveDir=cc.v2(),e.moveSpeed=750,e.dieTime=0,e.atkForce=0,e.criticalForce=0,e.criticalChance=0,e.bulletEffect=0,e.bulletPro=1,e.atkList=[],e.lastEnemy=null,e.isSplitBullet=!1,e.isSpinBullet=!1,e.spinBulletTime=0,e.spinMaxTime=.6,e.isSpinTurnto=!1,e.surrCountTimeClear=1.8,e.surrCountTime=0,e.refreshCount=0,e}var o;return s(e,t),o=e,e.prototype.init=function(t,e,o){var i=this;if(void 0===e&&(e=null),void 0===o&&(o=!1),this.isDie=!1,this.typeID=t.typeID,this.atkForce=t.atkForce,this.criticalChance=t.criticalChance,this.criticalForce=t.criticalForce,this.bulletEffect=t.bulletEffect,this.bulletPro=t.bulletPro,this.moveDir=t.dir,this.isSplitBullet=t.isSplitBullet,this.roleAtk=e,this.isEnemyType=o,this.isSpinBullet=7==this.bulletEffect,this.isSpinTurnto=!1,this.spinBulletTime=0,this.isEnemyType?(this.spinMaxTime=1.2,this.moveSpeed=d.default.getInstance().getParameterCfg(h.DW_enumGearParameterCfg.EnemyBulletSpeed)):(10==this.typeID?this.moveSpeed=600:this.moveSpeed=750,this.spinMaxTime=.6),this.atkList=[],this.lastEnemy=null,-1==this.typeID||101==this.typeID)this.fieldBullet.active=!0,this.spAnim.node.active=!1;else{this.fieldBullet.active=!1,this.spAnim.node.active=!0;var n=""+u.DW_RoleAsePath[this.typeID].bulletPath;this.loadResFromBundle(u.DW_BundleName.SpAnim,n,sp.SkeletonData,function(t){i.spAnim.skeletonData=t,i.spAnim.setAnimation(0,u.DW_RoleAsePath[i.typeID].bulletSkill,!0)})}},e.prototype.update=function(t){if(!f.default.Instance.isPause&&!this.isDie){if(10==this.bulletEffect&&!this.isEnemyType)return this.surrCountTime+=t,this.surrCountTime>this.surrCountTimeClear&&(this.surrCountTime=0,this.atkList=[]),void(++this.refreshCount>2&&(this.refreshCount=0,this.checkCollisionEnemy()));if(this.isSpinTurnto){if(this.isSpinBullet)if(this.roleAtk&&this.roleAtk.activeInHierarchy){var e=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),o=this.roleAtk.convertToWorldSpaceAR(cc.Vec3.ZERO),i=o.sub(e).normalize(),n=180*Math.atan2(i.y,i.x)/Math.PI-90;this.node.angle=n,this.node.x+=i.x*this.moveSpeed*t,this.node.y+=i.y*this.moveSpeed*t,cc.Vec3.distance(e,o)<30&&this.die()}else this.die()}else this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t;++this.refreshCount>2&&(this.refreshCount=0,this.isEnemyType?this.checkCollisionRolePlank():this.checkCollisionEnemy()),!this.isSpinBullet||this.isSpinTurnto||this.isEnemyType||(this.spinBulletTime+=t,this.spinBulletTime>this.spinMaxTime&&(this.spinBulletTime=0,this.isSpinTurnto=!0,this.atkList=[])),this.dieTime+=t,this.isEnemyType?this.dieTime>3&&this.die():5!=this.bulletEffect&&7!=this.bulletEffect?this.dieTime>1.5&&this.die():this.dieTime>3&&this.die()}},e.prototype.checkCollisionRolePlank=function(){var t=this.getCollisionPlank();if(t)if(3==this.bulletEffect){p.AudioMgr.getInstance().playEffectFree(u.DW_AudioId.baozha);var e=this.blastCol.convertToWorldSpaceAR(cc.v2(0,0));m.default.getInstance().getObj("effAnim/bulletBlast",function(t){t.setParent(f.default.Instance.roleBulletBase);var o=t.parent.convertToNodeSpaceAR(e);t.setPosition(o)}),f.default.Instance.attackEd(this.atkForce),this.die()}else{if(this.atkList.includes(t))return;this.atkList.push(t),p.AudioMgr.getInstance().playEffectFree(u.DW_AudioId.mingzhong),f.default.Instance.attackEd(this.atkForce),this.die()}},e.prototype.getCollisionPlank=function(){if(g.default.Instance.getPlaterTreeColliderList(this.node).length>0)for(var t=this.boxCol.getBoundingBoxToWorld(),e=0,o=f.default.Instance.plankAllList;e<o.length;e++){var i=o[e],n=i.getBoundingBoxToWorld();if(cc.Intersection.rectRect(t,n))return i}return null},e.prototype.checkCollisionEnemy=function(){var t=this,e=f.default.Instance.getCollisionBullet(this.boxCol);if(e){var i=e.getComponent(y.default);if(i.isDie)return;if(3==this.bulletEffect){p.AudioMgr.getInstance().playEffectFree(u.DW_AudioId.baozha);var n=this.blastCol.convertToWorldSpaceAR(cc.v2(0,0));m.default.getInstance().getObj("effAnim/bulletBlast",function(t){t.setParent(f.default.Instance.roleBulletBase);var e=t.parent.convertToNodeSpaceAR(n);t.setPosition(e)});for(var a=0,r=f.default.Instance.getBlastCollisionBullet(this.blastCol);a<r.length;a++){var s=(v=r[a]).getComponent(y.default);s.isDie||s.attackEd(f.default.Instance.round(this.atkForce),!1)}this.die()}else{if(5!=this.bulletEffect){if(this.atkList.includes(e))return}else if(null!=this.lastEnemy&&this.lastEnemy==e)return;this.atkList.push(e);var c=this.atkForce,l=Math.random()<this.criticalChance;switch(l&&(c=this.atkForce*this.criticalForce),c=f.default.Instance.round(c),i.attackEd(c,l),this.bulletEffect){case 1:this.atkList.length>=this.bulletPro&&this.die();break;case 2:i.knockback(this.node,5),this.die();break;case 4:i.frozenEd(this.bulletPro),this.die();break;case 5:if(this.lastEnemy=e,this.atkList.length>=this.bulletPro)this.die();else{for(var d=null,h=0,g=I=f.default.Instance.getEnemyNear(this.node,2,2e6);h<g.length;h++){var v=g[h];if(this.lastEnemy!=v){d=v;break}}if(null!=d){var _=this.node.convertToWorldSpaceAR(cc.v2(0,0)),b=d.convertToWorldSpaceAR(cc.v2(0,0)).sub(_).normalize(),B=180*Math.atan2(b.y,b.x)/Math.PI-90;this.node.angle=B,this.moveDir=b}}break;case 9:var I;if(!this.isSplitBullet&&(this.lastEnemy=e,(I=f.default.Instance.getEnemyNear(this.node,this.bulletPro+1,2e6)).length>0)){_=this.node.convertToWorldSpaceAR(cc.v2(0,0));for(var P=this.node.convertToWorldSpaceAR(cc.v2(0,0)),C=function(e){if(I[e]==D.lastEnemy)return"continue";var i=I[e].convertToWorldSpaceAR(cc.v2(0,0)).sub(_).normalize(),n=180*Math.atan2(i.y,i.x)/Math.PI-90;m.default.getInstance().getObj("bullet/roleBullet",function(e){e.setParent(f.default.Instance.roleBulletBase);var a=e.parent.convertToNodeSpaceAR(P);e.setPosition(a),e.angle=n;var r=e.getComponent(o),s={typeID:t.typeID,level:1,atkForce:t.atkForce,criticalChance:t.criticalChance,criticalForce:t.criticalForce,bulletEffect:t.bulletEffect,bulletPro:t.bulletPro,dir:i,isSplitBullet:!0,atkInterval:0};r.init(s),r.atkList=t.atkList})},D=this,T=0;T<I.length;T++)C(T)}this.die();break;case 10:case 7:break;default:this.die()}}}},e.prototype.die=function(){this.isDie=!0,this.moveDir=cc.v2(),this.dieTime=0,m.default.getInstance().pushObj(this.node)},c([b(sp.Skeleton)],e.prototype,"spAnim",void 0),c([b(cc.Node)],e.prototype,"boxCol",void 0),c([b(cc.Node)],e.prototype,"blastCol",void 0),c([b(cc.Node)],e.prototype,"fieldBullet",void 0),o=c([_],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],DW_RoleField:[function(t,e,o){"use strict";cc._RF.push(e,"7838596EVRCh6bJJWfzw2dS","DW_RoleField");var i=t,n=e,a=o;cc._RF.push(n,"7838596EVRCh6bJJWfzw2dS","DW_RoleField");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("DW_Config"),d=i("DW_GameMgr"),h=i("DW_PoolMgr"),f=i("DW_RoleBullet"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkPos=null,e.levelIcon=null,e.surrBullet=null,e.isDie=!1,e.skillRole=!1,e.skillContTime=30,e.skillRoleTime=0,e.typeID=0,e.level=0,e.atkType=0,e.bulletEffect=0,e.bulletPro=1,e.atkDis=350,e.surrBulletSpeed=120,e.atkForce=1,e.criticalChance=0,e.criticalForce=0,e.isAtkCooling=!0,e.atkInterval=1,e.atkTime=0,e.atkAnimTimeSpeed=1,e.isInit=!1,e.radius=240,e}return s(e,t),e.prototype.onLoad=function(){this.addEvent(u.DW_EventName.SetPause,this.setPause)},e.prototype.start=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==u.DW_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.spAnim.setAnimation(0,u.DW_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==u.DW_AnimName.attack&&t.attack()})},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),null!=this.surrBullet&&this.surrBullet.destroy()},e.prototype.updateRolePro=function(t){var e=this;if(this.typeID=t.typeID,this.level=t.level,this.atkForce=t.atkForce,this.criticalChance=t.criticalChance,this.criticalForce=t.criticalForce,this.bulletEffect=t.bulletEffect,this.bulletPro=t.bulletPro,this.atkInterval=t.atkInterval,!this.isInit){var o=""+u.DW_RoleAsePath[this.typeID].path;this.loadResFromBundle(u.DW_BundleName.SpAnim,o,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,u.DW_AnimName.idle,!0),e.setSpAnimPlaySpeed()}),this.isInit=!0}this.updateSurrBulletRolePro()},e.prototype.setLevelIcon=function(){var t=this,e="roleBoxIcon/tb_0"+this.level;this.loadSpriteFrame(u.DW_BundleName.Sprite,e,function(e){t.levelIcon.spriteFrame=e})},e.prototype.summonSkill=function(t){var e=this;this.atkForce=t,this.isDie=!0,this.skillRole=!0,this.atkInterval=.22,this.typeID=-1,this.level=1,this.criticalChance=0,this.criticalForce=1,this.bulletPro=0,this.skillRoleTime=0,this.atkDis=1e4,this.addEvent(u.DW_EventName.waveOver,this.dieSkillRole),this.node.scaleX=-.7,cc.tween(this.node).to(.7,{position:cc.v3(0,290)}).call(function(){e.isDie=!1}).start()},e.prototype.dieSkillRole=function(){var t=this;this.node.scaleX=.7,cc.tween(this.node).to(.7,{position:cc.v3(500,290)}).call(function(){t.die()}).start()},e.prototype.update=function(t){if(!d.default.Instance.isPause&&!this.isDie)if(10!=this.bulletEffect)d.default.Instance.isPrepare||(this.isAtkCooling?(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.isAtkCooling=!1)):this.skillRole?(this.attack(),this.isAtkCooling=!0):this.isPlayAtkAnim(),this.skillRole&&(this.skillRoleTime+=t)>this.skillContTime&&(this.skillRoleTime=0,this.dieSkillRole()));else if(null!=this.surrBullet){var e=this.node.parent.convertToWorldSpaceAR(cc.Vec3.ZERO),o=this.surrBullet.parent.convertToNodeSpaceAR(e);this.surrBullet.setPosition(o),this.surrBullet.angle-=t*this.surrBulletSpeed}},e.prototype.isPlayAtkAnim=function(){d.default.Instance.getEnemyNear(this.node,1,this.atkDis).length>0&&(this.setDir(),p.AudioMgr.getInstance().playEffectFree(u.DW_AudioId.attack2),this.isAtkCooling=!0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,u.DW_AnimName.attack,!1))},e.prototype.attack=function(){if(10!=this.bulletEffect)switch(this.setDir(),this.bulletEffect){case 6:var t=d.default.Instance.getEnemyNear(this.node,1,this.atkDis);t.length>0&&this.shootBullets(t[0],this.bulletPro);break;case 8:this.sendBullets(this.bulletPro);break;default:this.sendBullets(1)}},e.prototype.sendBullets=function(t){var e=this,o=d.default.Instance.getEnemyNear(this.node,t,this.atkDis);if(o.length>0)for(var i=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),a=function(t){var a=t,r=o[a].convertToWorldSpaceAR(cc.v2(0,0)).sub(i).normalize(),s=180*Math.atan2(r.y,r.x)/Math.PI-90;setTimeout(function(){h.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(d.default.Instance.roleBulletBase);var o=t.parent.convertToNodeSpaceAR(n);t.setPosition(o),t.angle=s;var i={typeID:e.typeID,level:e.level,atkForce:e.atkForce,criticalChance:e.criticalChance,criticalForce:e.criticalForce,bulletEffect:e.bulletEffect,bulletPro:e.bulletPro,dir:r,isSplitBullet:!1,atkInterval:e.atkInterval};t.getComponent(f.default).init(i,e.atkPos)})},70*a)},r=0;r<o.length;r++)a(r)},e.prototype.shootBullets=function(t,e,o){var i=this;void 0===e&&(e=3),void 0===o&&(o=15);for(var n=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),a=t.convertToWorldSpaceAR(cc.v2(0,0)).sub(n).normalize(),r=180*Math.atan2(a.y,a.x)/Math.PI-90,s=Math.floor(e/2),c=function(t){var e=r+(t-s)*o,n=(e+90)*Math.PI/180,a=cc.v2(Math.cos(n),Math.sin(n)).normalize();h.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(d.default.Instance.roleBulletBase);var o=i.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=t.parent.convertToNodeSpaceAR(o);t.setPosition(n),t.angle=e;var r={typeID:i.typeID,level:i.level,atkForce:i.atkForce,criticalChance:i.criticalChance,criticalForce:i.criticalForce,bulletEffect:i.bulletEffect,bulletPro:i.bulletPro,dir:a,isSplitBullet:!1,atkInterval:i.atkInterval};t.getComponent(f.default).init(r)})},l=0;l<e;l++)c(l)},e.prototype.setDir=function(){if(!this.skillRole){var t=d.default.Instance.getEnemyNear(this.node,1,this.atkDis);if(t.length>0){var e=t[0].convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.parent.convertToNodeSpaceAR(e);this.node.x>o.x?this.spAnim.node.scaleX=-.7:this.node.x<o.x&&(this.spAnim.node.scaleX=.7)}}},e.prototype.upBoxEnter=function(){if(10==this.bulletEffect&&null==this.surrBullet){this.surrBullet=new cc.Node("surrBullet"),this.surrBullet.setParent(this.node.parent.parent.parent);var t=this.node.parent.convertToWorldSpaceAR(cc.Vec3.ZERO),e=this.surrBullet.parent.convertToNodeSpaceAR(t);this.surrBullet.setPosition(e)}this.addSurrBullet(),this.setSurrBulletActive(!0),this.updateSurrBulletRolePro()},e.prototype.updateSurrBulletRolePro=function(){if(10==this.bulletEffect&&null!=this.surrBullet)for(var t=0,e=this.surrBullet.children;t<e.length;t++){var o=e[t],i={typeID:this.typeID,level:this.level,atkForce:this.atkForce,criticalChance:this.criticalChance,criticalForce:this.criticalForce,bulletEffect:this.bulletEffect,bulletPro:this.bulletPro,dir:cc.Vec2.ZERO,isSplitBullet:!1,atkInterval:this.atkInterval};o.getComponent(f.default).init(i)}},e.prototype.setSurrBulletActive=function(t){if(null!=this.surrBullet&&(this.surrBullet.active=t,t)){this.refreshSurrBullet();var e=this.node.parent.convertToWorldSpaceAR(cc.Vec3.ZERO),o=this.surrBullet.parent.convertToNodeSpaceAR(e);this.surrBullet.setPosition(o)}},e.prototype.addSurrBullet=function(){var t=this;if(10==this.bulletEffect&&null!=this.surrBullet){var e=this.bulletPro-this.surrBullet.childrenCount;if(e>0)for(var o=0;o<e;o++)h.default.getInstance().getObj("bullet/roleBullet",function(e){e.setParent(t.surrBullet);var o={typeID:t.typeID,level:t.level,atkForce:t.atkForce,criticalChance:t.criticalChance,criticalForce:t.criticalForce,bulletEffect:t.bulletEffect,bulletPro:t.bulletPro,dir:cc.Vec2.ZERO,isSplitBullet:!1,atkInterval:t.atkInterval};e.getComponent(f.default).init(o),t.refreshSurrBullet()})}},e.prototype.refreshSurrBullet=function(){if(null!=this.surrBullet)for(var t=this.surrBullet.children,e=t.length,o=0;o<e;o++){var i=t[o],n=360/e*o,a=cc.misc.degreesToRadians(n),r=this.radius*Math.cos(a),s=this.radius*Math.sin(a),c=cc.v3(r,s,0);cc.Tween.stopAllByTarget(i),cc.tween(i).to(.15,{position:c,angle:n-180}).start()}},e.prototype.die=function(){this.isDie||(this.isDie=!0,this.node.setParent(null),this.node.destroy())},e.prototype.setPause=function(t){this.isDie||(this.spAnim.paused=t)},e.prototype.setSpAnimPlaySpeed=function(){var t=this.spAnim.findAnimation(u.DW_AnimName.attack).duration;this.atkInterval<t&&(this.atkAnimTimeSpeed=t/this.atkInterval*1.05)},c([y(sp.Skeleton)],e.prototype,"spAnim",void 0),c([y(cc.Node)],e.prototype,"atkPos",void 0),c([y(cc.Sprite)],e.prototype,"levelIcon",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],DW_RoleMateTips:[function(t,e,o){"use strict";cc._RF.push(e,"09a7cNPm5VGt4Of5+T6yld7","DW_RoleMateTips");var i=t,n=e,a=o;cc._RF.push(n,"09a7cNPm5VGt4Of5+T6yld7","DW_RoleMateTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=i("DW_PoolMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtTips=null,e.weaponIcon1=null,e.weaponIcon2=null,e.mateCfg={7:{role:[6,10],name:"\u5929\u9f99\u516b\u90e8"},8:{role:[3,11],name:"\u5c18\u5916\u53cc\u6e05"},9:{role:[1,7],name:"\u5251\u80c6\u7434\u5fc3"},10:{role:[4,5],name:"\u4e09\u987e\u8305\u5e90"},11:{role:[8,17],name:"\u667a\u52c7\u53cc\u5168"}},e}return s(e,t),e.prototype.init=function(t){var e=this,o=this.mateCfg[t];if(null!=o){this.node.active=!0,cc.Tween.stopAllByTarget(this.node),this.node.opacity=0,cc.tween(this.node).to(.2,{opacity:255}).start();var i="roleBoxIcon/tou_"+o.role[0];this.loadSpriteFrame(p.DW_BundleName.Sprite,i,function(t){e.weaponIcon1.spriteFrame=t}),this.weaponIcon2.node.parent.active=!0;var n="roleBoxIcon/tou_"+o.role[1];this.loadSpriteFrame(p.DW_BundleName.Sprite,n,function(t){e.weaponIcon2.spriteFrame=t});var a="";switch(t){case 7:a="<b><outline color=black width=4>\u4e54\u5e2e\u4e3b&\u900d\u9065\u50e7\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 8:a="<b><outline color=black width=4>\u5ae6\u5a25&\u516b\u6212\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 9:a="<b><outline color=black width=4>\u609f\u7a7a&\u7d2b\u971e\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 10:a="<b><outline color=black width=4>\u5218\u5907&\u8bf8\u845b\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 11:a="<b><outline color=black width=4>\u5173\u7fbd&\u5b59\u5c1a\u9999\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>"}this.txtTips.string=a}else this.node.active=!1,console.error(t+" ID\uff0c\u914d\u7f6e\u4e3a\u7a7a\uff0c\u5173\u95ed\u7f81\u7eca\u63d0\u793a"),cc.Tween.stopAllByTarget(this.node),u.default.getInstance().pushObj(this.node)},e.prototype.die=function(){var t=this;this.node.active&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.active=!1}).start())},c([f(cc.RichText)],e.prototype,"txtTips",void 0),c([f(cc.Sprite)],e.prototype,"weaponIcon1",void 0),c([f(cc.Sprite)],e.prototype,"weaponIcon2",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DW_SeaWave:[function(t,e,o){"use strict";cc._RF.push(e,"f0f4a5DGFZCsIWqxooPZfEt","DW_SeaWave");var i=t,n=e,a=o;cc._RF.push(n,"f0f4a5DGFZCsIWqxooPZfEt","DW_SeaWave");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("DW_GameMgr"),u=i("DW_PoolMgr"),d=cc._decorator,h=d.ccclass,f=d.property;!function(t){t.start="idle2",t.idle="idle",t.die="die"}(l||(l={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.idleTime=0,e.speed=80,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==l.die?t.die():e.animation.name==l.start&&t.spAnim.setAnimation(0,l.idle,!0)})},e.prototype.init=function(){this.spAnim.setAnimation(0,l.start,!1),this.idleTime=p.default.Instance.random(2,5),this.speed=p.default.Instance.random(30,80),this.spAnim.node.scaleX=Math.random()>.5?1:-1;var t="skill_"+p.default.Instance.mapID;this.spAnim.setSkin(t),this.node.scale=p.default.Instance.random(.5,1.1)},e.prototype.update=function(t){this.idleTime>0&&(this.idleTime-=t)<0&&this.spAnim.setAnimation(0,l.die,!1),this.pos=this.node.getPosition(),this.spAnim.node.scaleX>0?this.pos.x-=t*this.speed:this.pos.x+=t*this.speed,this.node.setPosition(this.pos)},e.prototype.die=function(){u.default.getInstance().pushObj(this.node)},c([f(sp.Skeleton)],e.prototype,"spAnim",void 0),c([h],e)}(cc.Component);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DW_Simulator:[function(t,e,o){"use strict";cc._RF.push(e,"3b6deKQ/W9NoqPf8jGFuurI","DW_Simulator");var i=t,n=e,a=o;cc._RF.push(n,"3b6deKQ/W9NoqPf8jGFuurI","DW_Simulator"),Object.defineProperty(a,"__esModule",{value:!0}),a.DW_Simulator=void 0;var r=i("DW_Agent"),s=i("DW_Common"),c=i("DW_kdtree"),l=function(){function t(){this.agentId=0,this.agentIdLst=[],this.aid2agent=Object.create(null),this.obstacles=[],this.kdTree=new c.DW_KdTree,this.time=0}return Object.defineProperty(t,"instance",{get:function(){return t._inst||(t._inst=new t),t._inst},enumerable:!1,configurable:!0}),t.prototype.getAgent=function(t){return this.aid2agent[this.agentIdLst[t]]},t.prototype.getAgentByAid=function(t){return this.aid2agent[t]},t.prototype.getGlobalTime=function(){return this.time},t.prototype.getNumAgents=function(){return this.agentIdLst.length},t.prototype.getAgentAidByIdx=function(t){return this.agentIdLst[t]},t.prototype.setAgentPrefVelocity=function(t,e){this.aid2agent[t].prefVelocity_.copy(e)},t.prototype.getAgentPosition=function(t){return this.aid2agent[t]?this.aid2agent[t].position_:null},t.prototype.setAgentPosition=function(t,e){this.aid2agent[t]&&this.aid2agent[t].position_.copy(e)},t.prototype.getAgentPrefVelocity=function(t){return this.aid2agent[t].prefVelocity_},t.prototype.getAgentVelocity=function(t){return this.aid2agent[t].velocity_},t.prototype.getAgentRadius=function(t){return this.aid2agent[t].radius_},t.prototype.getAgentOrcaLines=function(t){return this.aid2agent[t].orcaLines_},t.prototype.addAgent=function(t,e,o,i,n){if(void 0===e&&(e=null),void 0===o&&(o=null),void 0===i&&(i=null),void 0===n&&(n=null),!this.defaultAgent)throw new Error("no default agent");var a=new r.DW_Agent;return a.position_.copy(t),a.maxNeighbors_=this.defaultAgent.maxNeighbors_,a.maxSpeed_=o||this.defaultAgent.maxSpeed_,a.neighborDist=this.defaultAgent.neighborDist,a.radius_=e||this.defaultAgent.radius_,a.timeHorizon=this.defaultAgent.timeHorizon,a.timeHorizonObst=this.defaultAgent.timeHorizonObst,a.velocity_.copy(i||this.defaultAgent.velocity_),a.id=this.agentId++,n&&n>=0&&(a.mass=n),this.aid2agent[a.id]=a,this.agentIdLst.push(a.id),a.id},t.prototype.removeAgent=function(t){if(this.hasAgent(t)){var e=this.agentIdLst.indexOf(t);e>=0&&(this.agentIdLst[e]=this.agentIdLst[this.agentIdLst.length-1],this.agentIdLst.length--),delete this.aid2agent[t]}},t.prototype.hasAgent=function(t){return!!this.aid2agent[t]},t.prototype.setAgentMass=function(t,e){this.aid2agent[t].mass=e},t.prototype.getAgentMass=function(t){return this.aid2agent[t].mass},t.prototype.setAgentRadius=function(t,e){this.aid2agent[t].radius_=e},t.prototype.setMaxSpeed=function(t,e){this.aid2agent[t]&&(this.aid2agent[t].maxSpeed_=e)},t.prototype.setAgentDefaults=function(t,e,o,i,n,a,s){this.defaultAgent||(this.defaultAgent=new r.DW_Agent),this.defaultAgent.maxNeighbors_=e,this.defaultAgent.maxSpeed_=a,this.defaultAgent.neighborDist=t,this.defaultAgent.radius_=n,this.defaultAgent.timeHorizon=o,this.defaultAgent.timeHorizonObst=i,this.defaultAgent.velocity_=s},t.prototype.run=function(t){this.kdTree.buildAgentTree(this.getNumAgents());for(var e=this.agentIdLst.length,o=0;o<e;o++)this.aid2agent[this.agentIdLst[o]].computeNeighbors(this),this.aid2agent[this.agentIdLst[o]].computeNewVelocity(t);for(o=0;o<e;o++)this.aid2agent[this.agentIdLst[o]].update(t);this.time+=t},t.prototype.addObstacle=function(t){if(t.length<2)return-1;for(var e=this.obstacles.length,o=0;o<t.length;++o){var i=new s.DW_Obstacle;i.point=t[o],0!=o&&(i.previous=this.obstacles[this.obstacles.length-1],i.previous.next=i),o==t.length-1&&(i.next=this.obstacles[e],i.next.previous=i),i.direction=s.DW_RVOMath.normalize(t[o==t.length-1?0:o+1].minus(t[o])),2==t.length?i.convex=!0:i.convex=s.DW_RVOMath.leftOf(t[0==o?t.length-1:o-1],t[o],t[o==t.length-1?0:o+1])>=0,i.id=this.obstacles.length,this.obstacles.push(i)}return e},t.prototype.processObstacles=function(){this.kdTree.buildObstacleTree()},t.prototype.queryVisibility=function(t,e,o){return this.kdTree.queryVisibility(t,e,o)},t.prototype.getObstacles=function(){return this.obstacles},t.prototype.clear=function(){this.agentIdLst.length=0,this.agentId=0,this.aid2agent=Object.create(null),this.defaultAgent=null,this.kdTree=new c.DW_KdTree,this.obstacles.length=0},t}();a.DW_Simulator=l,cc._RF.pop(),cc._RF.pop()},{}],DW_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"b47e4uTZe9EyJNzjUFMLgWA","DW_Skills");var i=t,n=e,a=o;cc._RF.push(n,"b47e4uTZe9EyJNzjUFMLgWA","DW_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkForce=0,e.skillID=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==p.DW_AnimName.animation&&t.die()}),this.spAnim.setEventListener(function(e,o){switch(o.data.name){case p.DW_AnimName.attack:case"hit":t.sendEvent(p.DW_EventName.rolePlaySkill,t.skillID,t.atkForce)}}),this.addEvent(p.DW_EventName.SetPause,this.setGameState)},e.prototype.init=function(t,e){this.atkForce=t,this.skillID=e,this.spAnim.setAnimation(0,p.DW_AnimName.animation,!1)},e.prototype.setGameState=function(t){this.spAnim.paused=t},e.prototype.die=function(){this.node.destroy()},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_Trailing:[function(t,e,o){"use strict";cc._RF.push(e,"201e3tIM3xKIpfQjSJNuBBp","DW_Trailing");var i=t,n=e,a=o;cc._RF.push(n,"201e3tIM3xKIpfQjSJNuBBp","DW_Trailing");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DW_GameMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onEnable=function(){var t="skill_"+p.default.Instance.mapID;this.spAnim.setSkin(t)},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_UIBuffPro:[function(t,e,o){"use strict";cc._RF.push(e,"93fe6nDdcFI1KcwvidWYICD","DW_UIBuffPro");var i=t,n=e,a=o;cc._RF.push(n,"93fe6nDdcFI1KcwvidWYICD","DW_UIBuffPro");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DW_Config"),u=i("DW_DataMgr"),d=i("DW_GameMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.itemBuffInfo=null,e.itemBase=null,e.noTips=null,e.roleBuff={},e}return s(e,t),e.prototype.start=function(){for(var t=this,e=!0,o=0,i=Object.entries(JSON.parse(JSON.stringify(d.default.Instance.roleBoxBuffAtk)));o<i.length;o++){var n=i[o],a=n[0],r=n[1],s=Number(a);e=!1;var c=void 0,l=void 0,h=void 0;switch(s){case 9001:c=90011,l=900111,h=9001111;break;case 9002:c=90022,l=900222,h=9002222;break;case 9003:c=90033,l=900333,h=9003333;break;case 9004:c=90044,l=900444,h=9004444;break;case 9005:c=90055,l=900555,h=9005555;break;case 9006:c=90066,l=900666,h=9006666;break;case 9007:c=90077,l=900777,h=9007777}var f,m,g,y,v=Math.floor(100*r);f=Math.floor(100*u.default.getInstance().getBuffCfg(s,1).buffParametric),m=Math.floor(100*u.default.getInstance().getBuffCfg(c,2).buffParametric),g=Math.floor(100*u.default.getInstance().getBuffCfg(l,3).buffParametric),y=Math.floor(100*u.default.getInstance().getBuffCfg(h,4).buffParametric);var _=1;v<=f?_=1:v>f&&v<=m?_=2:v>m&&v<=g?_=3:v>g&&v<=y?_=4:v>y&&(_=5),this.roleBuff[s]={value:v,level:_}}if(!e){(_=Object.entries(this.roleBuff)).sort(function(t,e){return e[1].level-t[1].level});for(var b=function(t,e){var o=Number(t),i=B.round2(e.value),n="#5bfe1b";switch(e.level){case 1:n="#5bfe1b";break;case 2:n="#1bc1fe";break;case 3:n="#e11bfe";break;case 4:n="#ffdb14";break;case 5:n="#ff2371"}var a="";switch(o){case 9001:a="<b><outline color=black width=4>\u5168\u4f53\u653b\u901f\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9002:a="<b><outline color=black width=4>\u5168\u4f53\u66b4\u51fb\u7387\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9003:a="<b><outline color=black width=4>\u5168\u4f53\u66b4\u51fb\u4f24\u5bb3\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9004:a="<b><outline color=black width=4>\u5168\u4f53\u653b\u51fb\u529b\u63d0\u5347<color="+n+">"+i+"%</color></outline></b>";break;case 9005:a="<b><outline color=black width=4>\u83b7\u5f97\u7ecf\u9a8c\u589e\u52a0<color="+n+">"+i+"%</color></outline></b>";break;case 9006:a="<b><outline color=black width=4>\u6bcf\u56de\u5408\u7ed3\u675f\u56de\u590d<color="+n+">"+i+"%</color>\u751f\u547d\u503c</outline></b>";break;case 9007:a="<b><outline color=black width=4>\u79fb\u52a8\u901f\u5ea6\u589e\u52a0<color="+n+">"+i+"%</color></outline></b>"}var r=cc.instantiate(B.itemBuffInfo);r.active=!0,r.setParent(B.itemBase),r.getChildByName("proInfo").getComponent(cc.RichText).string=a;var s="buffBoxIcon/tou_"+o;B.loadSpriteFrame(p.DW_BundleName.Sprite,s,function(t){r.getChildByName("buffIcon").getComponent(cc.Sprite).spriteFrame=t})},B=this,I=0,P=_;I<P.length;I++){var C=P[I];b(a=C[0],C[1])}}this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.noTips.active=e},e.prototype.round2=function(t){return Math.round(100*t)/100},c([m(cc.Node)],e.prototype,"btnClose",void 0),c([m(cc.Node)],e.prototype,"itemBuffInfo",void 0),c([m(cc.Node)],e.prototype,"itemBase",void 0),c([m(cc.Node)],e.prototype,"noTips",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],DW_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"b98d1h2k25BRJDDuXiN5H63","DW_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"b98d1h2k25BRJDDuXiN5H63","DW_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DW_Config"),u=i("DW_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.timeSpeed=null,e.txtTimeSpeed=null,e.isTimeSpeed=!0,e.upRoleBox=null,e.addPlankBox=null,e.showBuff=null,e.addGold=null,e.dropLevel=0,e}return s(e,t),e.prototype.start=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.timeSpeed.on(cc.Node.EventType.TOUCH_END,function(){t.isTimeSpeed=!t.isTimeSpeed;var e=t.isTimeSpeed?1:2.5;t.txtTimeSpeed.string="\u500d\u901f\uff1a"+e},this),this.upRoleBox.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.updateBoxSpare()},this),this.addPlankBox.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.addPlankBox()},this),this.showBuff.on(cc.Node.EventType.TOUCH_END,function(){t.dropLevel=1;var e=u.default.Instance.showBuffSelection(t.dropLevel);t.openUI(p.DW_UIID.DW_UISelectBuff,e),u.default.Instance.setPause(!0)},this),this.addGold.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.setGoldNum(100)},this)},c([f(cc.Node)],e.prototype,"btnClose",void 0),c([f(cc.Node)],e.prototype,"timeSpeed",void 0),c([f(cc.Label)],e.prototype,"txtTimeSpeed",void 0),c([f(cc.Node)],e.prototype,"upRoleBox",void 0),c([f(cc.Node)],e.prototype,"addPlankBox",void 0),c([f(cc.Node)],e.prototype,"showBuff",void 0),c([f(cc.Node)],e.prototype,"addGold",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DW_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"d1a65/B0d1IdpoLwz3seWXP","DW_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"d1a65/B0d1IdpoLwz3seWXP","DW_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DW_APP"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.win=null,e.fail=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this),this.win.active=this.isWin,this.fail.active=!this.isWin},c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"win",void 0),c([h(cc.Node)],e.prototype,"fail",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],DW_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"c91ddvbiT1G/7fd0z3L3YD2","DW_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"c91ddvbiT1G/7fd0z3L3YD2","DW_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("SdkMgr"),h=i("DW_Config"),f=i("DW_DataMgr"),m=i("DW_GameMgr"),g=i("DW_Btn_Skills"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lockTips=null,e.btnPause=null,e.btnShowBuffPro=null,e.levelBg=null,e.skillBtnsBase=null,e.btn_Skills=null,e.skillTips=null,e.upTips=null,e.orderAct=0,e.activateSkills=[],e}return s(e,t),e.prototype.start=function(){var t=this;(d.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR)&&(this.lockTips.on(cc.Node.EventType.TOUCH_END,function(){m.default.Instance.setGoldNum(200)},this),this.levelBg.on(cc.Node.EventType.TOUCH_END,function(){m.default.Instance.addPlankBox()},this)),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){m.default.Instance.setPause(!0),t.openUI(h.DW_UIID.DW_UIPause)},this),this.btnShowBuffPro.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.DW_UIID.DW_UIBuffPro)},this),this.addEvent(h.DW_EventName.upTipsBox,this.upTipsBox),this.addEvent(h.DW_EventName.ActivateSkills,this.onRoleSkillAdded),this.addEvent(h.DW_EventName.PlayGame,this.showSkillBtns),this.addEvent(h.DW_EventName.waveOver,this.hideSkillBtns),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.space:m.default.Instance.setPause(!0),this.openUI(h.DW_UIID.DW_UIPause)}},e.prototype.showSkillBtns=function(){this.skillBtnsBase.active=!0},e.prototype.hideSkillBtns=function(){this.skillBtnsBase.active=!1},e.prototype.onRoleSkillAdded=function(t,e){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(null==this.activateSkills[n]){this.orderAct++;var a=cc.instantiate(this.btn_Skills);a.setParent(this.skillBtnsBase),a.active=!0,this.activateSkills[n]=a.getComponent(g.default),this.activateSkills[n].init(n,e[n],this.orderAct),this.playAddSkillTips(n)}else this.activateSkills[n].isDie=!1,this.activateSkills[n].node.active=!0,this.activateSkills[n].updateLevel(e[n])}for(var r=[],s=[],c=0,l=Object.entries(this.activateSkills);c<l.length;c++){var p=l[c],u=p[0],d=p[1],h=Number(u);t.includes(h)?r.push(d):s.push(h)}for(var f=0,m=s;f<m.length;f++)n=m[f],this.activateSkills[n].isDie=!0,this.activateSkills[n].node.active=!1},e.prototype.playAddSkillTips=function(t){var e=cc.instantiate(this.skillTips);e.setParent(this.skillTips.parent),e.active=!0,e.getChildByName("tipsName").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).mateName,e.getChildByName("info").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).introduce;var o="skillsBtnIcon/"+f.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(h.DW_BundleName.Sprite,o,function(t){e.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),e.setPosition(0,400),e.setScale(0);var i=e.position.clone();i.y+=300,cc.tween(e).to(.2,{scale:1}).to(2,{}).to(.4,{position:i}).call(function(){e.destroy()}).start()},e.prototype.upTipsBox=function(t){var e=32*t.length+30,o=cc.instantiate(this.upTips);o.setParent(this.upTips.parent),o.active=!0,o.width=e,o.getChildByName("txtTips").getComponent(cc.Label).string=t,o.scale=0;var i=o.position.clone();i.y+=300,cc.tween(o).to(.2,{scale:1}).to(1.2,{scale:1}).to(.5,{position:i,opacity:.3}).call(function(){o.destroy()}).start()},c([_(cc.Node)],e.prototype,"lockTips",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"btnShowBuffPro",void 0),c([_(cc.Node)],e.prototype,"levelBg",void 0),c([_(cc.Node)],e.prototype,"skillBtnsBase",void 0),c([_(cc.Node)],e.prototype,"btn_Skills",void 0),c([_(cc.Node)],e.prototype,"skillTips",void 0),c([_(cc.Node)],e.prototype,"upTips",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],DW_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"f843akOSs9GqpAx8kg2fN4Y","DW_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"f843akOSs9GqpAx8kg2fN4Y","DW_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DW_APP"),u=i("DW_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.setPause(!1),t.closeUI()},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0),t.closeUI()},this)},c([f(cc.Node)],e.prototype,"btnResume",void 0),c([f(cc.Node)],e.prototype,"btnClose",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DW_UISelectBuff:[function(t,e,o){"use strict";cc._RF.push(e,"bb06euxzrFA6aNN7eE1t21m","DW_UISelectBuff");var i=t,n=e,a=o;cc._RF.push(n,"bb06euxzrFA6aNN7eE1t21m","DW_UISelectBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("DW_Config"),u=i("DW_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.itemBuff=null,e.btnClose=null,e.randomBuffs=[],e.isSelected=!1,e}return s(e,t),e.prototype.init=function(t){this.randomBuffs=t},e.prototype.start=function(){this.isSelected=!1,this.showBuffSelection()},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),u.default.Instance.showSelectBuffUI=!1},e.prototype.showBuffSelection=function(){for(var t=this,e=!0,o=function(o){4==o.buffQuality&&(e=!1);var n=o.ID;switch(n){case 9001:case 90011:case 900111:case 9001111:n=9001;break;case 9002:case 90022:case 900222:case 9002222:n=9002;break;case 9003:case 90033:case 900333:case 9003333:n=9003;break;case 9004:case 90044:case 900444:case 9004444:n=9004;break;case 9005:case 90055:case 900555:case 9005555:n=9005;break;case 9006:case 90066:case 900666:case 9006666:n=9006;break;case 9007:case 90077:case 900777:case 9007777:n=9007}var a=cc.instantiate(i.itemBuff);a.setParent(i.itemBase),a.active=!0,a.on(cc.Node.EventType.TOUCH_END,function(){t.onBuffSelected(n,o.ID,o.buffParametric)},i),a.getChildByName("buffName").getComponent(cc.Label).string=o.buffName,a.getChildByName("buffInfo").getComponent(cc.RichText).string=o.buffCopy1;var r,s=a.getChildByName("buffIcon");r="buffBoxIcon/tou_"+n,s.setScale(.87),i.loadSpriteFrame(p.DW_BundleName.Sprite,r,function(t){s.getComponent(cc.Sprite).spriteFrame=t});var c="buffBG/buffLevel"+o.buffQuality;i.loadSpriteFrame(p.DW_BundleName.Sprite,c,function(t){a.getComponent(cc.Sprite).spriteFrame=t})},i=this,n=0,a=this.randomBuffs;n<a.length;n++)o(a[n]);this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.isSelected||(t.isSelected=!0,u.default.Instance.setPause(!1),t.closeUI())},this),this.btnClose.active=e},e.prototype.onBuffSelected=function(t,e,o){this.isSelected||(this.isSelected=!0,u.default.Instance.setPause(!1),this.closeUI(),u.default.Instance.selectBuff(t,o),u.default.Instance.onBuffSelected(e),u.default.Instance.openBuffBox())},c([f(cc.Node)],e.prototype,"itemBase",void 0),c([f(cc.Node)],e.prototype,"itemBuff",void 0),c([f(cc.Node)],e.prototype,"btnClose",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],DW_kdtree:[function(t,e,o){"use strict";cc._RF.push(e,"54722/QYLtJa7Py2xGsi6Ef","DW_kdtree");var i=t,n=e,a=o;cc._RF.push(n,"54722/QYLtJa7Py2xGsi6Ef","DW_kdtree"),Object.defineProperty(a,"__esModule",{value:!0}),a.DW_KdTree=void 0;var r=i("DW_Common"),s=i("DW_Simulator"),c=function(){function t(t,e){this.a=t,this.b=e}return t.prototype.lessThan=function(t){return this.a<t.a||!(t.a<this.a)&&this.b<t.b},t.prototype.lessEqualThan=function(t){return this.a==t.a&&this.b==t.b||this.lessThan(t)},t.prototype.bigThan=function(t){return!this.lessEqualThan(t)},t.prototype.bigEqualThan=function(t){return!this.lessThan(t)},t}(),l=function(){},p=function(){},u=function(){function t(){this.MAX_LEAF_SIZE=10,this.agents=null,this.agentTree=[],this.obstacleTree=null}return t.prototype.buildAgentTree=function(t){if(!this.agents||this.agents.length!=t){this.agents=new Array(t);for(var e=0;e<this.agents.length;e++)this.agents[e]=s.DW_Simulator.instance.getAgent(e);for(this.agentTree=new Array(2*this.agents.length),e=0;e<this.agentTree.length;e++)this.agentTree[e]=new l}0!=this.agents.length&&this.buildAgentTreeRecursive(0,this.agents.length,0)},t.prototype.buildObstacleTree=function(){this.obstacleTree=new p;for(var t=new Array(s.DW_Simulator.instance.obstacles.length),e=0;e<t.length;e++)t[e]=s.DW_Simulator.instance.obstacles[e];this.obstacleTree=this.buildObstacleTreeRecursive(t)},t.prototype.computeAgentNeighbors=function(t,e){return this.queryAgentTreeRecursive(t,e,0)},t.prototype.computeObstacleNeighbors=function(t,e){this.queryObstacleTreeRecursive(t,e,this.obstacleTree)},t.prototype.queryVisibility=function(t,e,o){return this.queryVisibilityRecursive(t,e,o,this.obstacleTree)},t.prototype.buildAgentTreeRecursive=function(t,e,o){this.agentTree[o].begin=t,this.agentTree[o].end=e,this.agentTree[o].minX=this.agentTree[o].maxX=this.agents[t].position_.x,this.agentTree[o].minY=this.agentTree[o].maxY=this.agents[t].position_.y;for(var i=t+1;i<e;++i)this.agentTree[o].maxX=Math.max(this.agentTree[o].maxX,this.agents[i].position_.x),this.agentTree[o].minX=Math.min(this.agentTree[o].minX,this.agents[i].position_.x),this.agentTree[o].maxY=Math.max(this.agentTree[o].maxY,this.agents[i].position_.y),this.agentTree[o].minY=Math.min(this.agentTree[o].minY,this.agents[i].position_.y);if(e-t>this.MAX_LEAF_SIZE){for(var n=this.agentTree[o].maxX-this.agentTree[o].minX>this.agentTree[o].maxY-this.agentTree[o].minY,a=.5*(n?this.agentTree[o].maxX+this.agentTree[o].minX:this.agentTree[o].maxY+this.agentTree[o].minY),r=t,s=e;r<s;){for(;r<s&&(n?this.agents[r].position_.x:this.agents[r].position_.y)<a;)++r;for(;s>r&&(n?this.agents[s-1].position_.x:this.agents[s-1].position_.y)>=a;)--s;if(r<s){var c=this.agents[r];this.agents[r]=this.agents[s-1],this.agents[s-1]=c,++r,--s}}var l=r-t;0==l&&(++l,++r,++s),this.agentTree[o].left=o+1,this.agentTree[o].right=o+2*l,this.buildAgentTreeRecursive(t,r,this.agentTree[o].left),this.buildAgentTreeRecursive(r,e,this.agentTree[o].right)}},t.prototype.buildObstacleTreeRecursive=function(t){if(0==t.length)return null;for(var e=new p,o=0,i=t.length,n=i,a=0;a<t.length;++a){for(var l=0,u=0,d=(C=t[a]).next,h=0;h<t.length;h++)if(a!=h){var f=(S=t[h]).next,m=r.DW_RVOMath.leftOf(C.point,d.point,S.point),g=r.DW_RVOMath.leftOf(C.point,d.point,f.point);m>=-r.DW_RVOMath.RVO_EPSILON&&g>=-r.DW_RVOMath.RVO_EPSILON?++l:(m<=r.DW_RVOMath.RVO_EPSILON&&g<=r.DW_RVOMath.RVO_EPSILON||++l,++u);var y=new c(Math.max(l,u),Math.min(l,u)),v=new c(Math.max(i,n),Math.min(i,n));if(y.bigEqualThan(v))break}var _=new c(Math.max(l,u),Math.min(l,u)),b=new c(Math.max(i,n),Math.min(i,n));_.lessThan(b)&&(i=l,n=u,o=a)}for(var B=[],I=0;I<i;++I)B.push(null);var P=[];for(I=0;I<n;++I)P.push(null);var C,D=0,T=0;for(d=(C=t[a=o]).next,h=0;h<t.length;++h){var S;if(a!=h)if(f=(S=t[h]).next,m=r.DW_RVOMath.leftOf(C.point,d.point,S.point),g=r.DW_RVOMath.leftOf(C.point,d.point,f.point),m>=-r.DW_RVOMath.RVO_EPSILON&&g>=-r.DW_RVOMath.RVO_EPSILON)B[D++]=t[h];else if(m<=r.DW_RVOMath.RVO_EPSILON&&g<=r.DW_RVOMath.RVO_EPSILON)P[T++]=t[h];else{var A=r.DW_RVOMath.det(d.point.minus(C.point),S.point.minus(C.point))/r.DW_RVOMath.det(d.point.minus(C.point),S.point.minus(f.point)),k=S.point.plus(f.point.minus(S.point).scale(A)),w=new r.DW_Obstacle;w.point=k,w.previous=S,w.next=f,w.convex=!0,w.direction=S.direction,w.id=s.DW_Simulator.instance.obstacles.length,s.DW_Simulator.instance.obstacles.push(w),S.next=w,f.previous=w,m>0?(B[D++]=S,P[T++]=w):(P[T++]=S,B[D++]=w)}}return e.obstacle=C,e.left=this.buildObstacleTreeRecursive(B),e.right=this.buildObstacleTreeRecursive(P),e},t.prototype.queryAgentTreeRecursive=function(t,e,o){if(this.agentTree[o].end-this.agentTree[o].begin<=this.MAX_LEAF_SIZE)for(var i=this.agentTree[o].begin;i<this.agentTree[o].end;++i)e=t.insertAgentNeighbor(this.agents[i],e);else{var n=r.DW_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].left].minX-t.position_.x))+r.DW_RVOMath.sqr(Math.max(0,t.position_.x-this.agentTree[this.agentTree[o].left].maxX))+r.DW_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].left].minY-t.position_.y))+r.DW_RVOMath.sqr(Math.max(0,t.position_.y-this.agentTree[this.agentTree[o].left].maxY)),a=r.DW_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].right].minX-t.position_.x))+r.DW_RVOMath.sqr(Math.max(0,t.position_.x-this.agentTree[this.agentTree[o].right].maxX))+r.DW_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].right].minY-t.position_.y))+r.DW_RVOMath.sqr(Math.max(0,t.position_.y-this.agentTree[this.agentTree[o].right].maxY));n<a?n<e&&a<(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].left))&&(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].right)):a<e&&n<(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].right))&&(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].left))}return e},t.prototype.queryObstacleTreeRecursive=function(t,e,o){if(null==o)return e;var i=o.obstacle,n=i.next,a=r.DW_RVOMath.leftOf(i.point,n.point,t.position_);return e=this.queryObstacleTreeRecursive(t,e,a>=0?o.left:o.right),r.DW_RVOMath.sqr(a)/r.DW_RVOMath.absSq(n.point.minus(i.point))<e&&(a<0&&t.insertObstacleNeighbor(o.obstacle,e),this.queryObstacleTreeRecursive(t,e,a>=0?o.right:o.left)),e},t.prototype.queryVisibilityRecursive=function(t,e,o,i){if(null==i)return!0;var n=i.obstacle,a=n.next,s=r.DW_RVOMath.leftOf(n.point,a.point,t),c=r.DW_RVOMath.leftOf(n.point,a.point,e),l=1/r.DW_RVOMath.absSq(a.point.minus(n.point));if(s>=0&&c>=0)return this.queryVisibilityRecursive(t,e,o,i.left)&&(r.DW_RVOMath.sqr(s)*l>=r.DW_RVOMath.sqr(o)&&r.DW_RVOMath.sqr(c)*l>=r.DW_RVOMath.sqr(o)||this.queryVisibilityRecursive(t,e,o,i.right));if(s<=0&&c<=0)return this.queryVisibilityRecursive(t,e,o,i.right)&&(r.DW_RVOMath.sqr(s)*l>=r.DW_RVOMath.sqr(o)&&r.DW_RVOMath.sqr(c)*l>=r.DW_RVOMath.sqr(o)||this.queryVisibilityRecursive(t,e,o,i.left));if(s>=0&&c<=0)return this.queryVisibilityRecursive(t,e,o,i.left)&&this.queryVisibilityRecursive(t,e,o,i.right);var p=r.DW_RVOMath.leftOf(t,e,n.point),u=r.DW_RVOMath.leftOf(t,e,a.point),d=1/r.DW_RVOMath.absSq(e.minus(t));return p*u>=0&&r.DW_RVOMath.sqr(p)*d>r.DW_RVOMath.sqr(o)&&r.DW_RVOMath.sqr(u)*d>r.DW_RVOMath.sqr(o)&&this.queryVisibilityRecursive(t,e,o,i.left)&&this.queryVisibilityRecursive(t,e,o,i.right)},t}();a.DW_KdTree=u,cc._RF.pop(),cc._RF.pop()},{}],DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a3d71eFHL9IW7ks0mgrQcIp","DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"a3d71eFHL9IW7ks0mgrQcIp","DataMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.DataMgr=void 0;var r=i("Appcfg"),s=i("EventMgr"),c=i("HttpMgr"),l=i("ResourceMgr"),p=function(){function t(){this.web=!1}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.preload=function(){var t=this;this.web?(alert("\u6ce8\u610f\uff1a\u5f53\u524d\u4f7f\u7528\u7684\u662f\u672c\u5730\u8fdc\u7a0b\u914d\u7f6e\u6587\u4ef6"),console.error("\u6ce8\u610f\uff1a\u5f53\u524d\u4f7f\u7528\u7684\u662f\u672c\u5730\u8fdc\u7a0b\u914d\u7f6e\u6587\u4ef6\uff01\uff01\uff01"),this.loadRemoteTestCfg({dir:"zhongwei/BraveTower/configs",fileName:"GameJsonCfg.json"},function(e){t.data=e,s.EventMgr.getInstance().emit(r.BaseEventName.Loading,r.LoadingProcess.ExcelCfg)})):l.ResourceMgr.getInstance().loadRes("BraveTowerConfig","GameJsonCfg",cc.JsonAsset,function(e){t.data=e.json,e.decRef(),s.EventMgr.getInstance().emit(r.BaseEventName.Loading,r.LoadingProcess.ExcelCfg)})},t.prototype.reloadConfig=function(t,e){var o=this;if("A"!=t&&"C"!=t)if(this.web){var i="zhongwei/BraveTower/configsB",n=!0;if("D"==t&&(i="zhongwei/BraveTower/configsD",n=!0),n){var a={dir:i,fileName:"GameJsonCfg.json"};this.loadRemoteTestCfg(a,function(t){if(t)for(var i in t)o.data[i]=t[i];e&&e()})}else e&&e()}else i="BraveTowerConfigB",n=!0,"D"==t&&(i="BraveTowerConfigD",n=!0),n?l.ResourceMgr.getInstance().loadRes(i,"GameJsonCfg",cc.JsonAsset,function(t){var i=t.json;if(i)for(var n in i)o.data[n]=i[n];t.decRef(),e&&e()}):e&&e();else e&&e()},t.prototype.loadRemoteTestCfg=function(t,e){c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",t,function(t,o){if(t&&o&&(o.startsWith("{")||o.startsWith("["))){var i=JSON.parse(o);0==i.code?e&&e(JSON.parse(i.data)):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",o)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")})},t.prototype.orderCfgs=function(){for(var t in this.data)"language"!=t&&this.data[t][0].id&&this.data[t].sort(function(t,e){return t.id-e.id})},t.prototype.T=function(t){return t},t.prototype.getParamCfg=function(t){return this.data.paramsCfg[t].value},t.prototype.getGoodsCfgById=function(t){return this.data.GoodsCfg[t]},t.prototype.getRewardList=function(){return this.data.rewardCfg},t.prototype.getLevelCfgList=function(){return this.data.LevelCfg},t.prototype.getLevelCfgById=function(t){return this.data.LevelCfg[t-1]},t.prototype.getSigninCfg=function(){return this.data.SigninCfg},t.prototype.getCardCfgList=function(){return this.data.CardCfg},t.prototype.getCardCfg=function(t){for(var e=0;e<this.data.CardCfg.length;e++){var o=this.data.CardCfg[e];if(o.id==t)return o}return null},t.prototype.getTiesCfgList=function(){return this.data.TiesCfg},t.prototype.getTiesCfg=function(t){return this.data.TiesCfg[t-1]},t.prototype.getEnemyCfg=function(t){return this.data.EnemyCfg[t-1]},t.prototype.getShopBoxCfgList=function(){return this.data.ShopBoxCfg},t.prototype.getDrawCardsRewardList=function(){return this.data.DrawCardsReward},t.prototype.getCardQualityCfgList=function(){return this.data.CardQualityCfg},t.prototype.getCardQualityCfg=function(t){return this.data.CardQualityCfg[t-1]},t.prototype.getTaskCfgList=function(){return this.data.DailyTasksCfg},t.prototype.getTaskCfg=function(t){for(var e=0;e<this.data.DailyTasksCfg.length;e++){var o=this.data.DailyTasksCfg[e];if(o.ID==t)return o}return null},t.prototype.getAchieveCfgList=function(){return this.data.AchieveCfg},t.prototype.getAchieveCfg=function(t){for(var e=0;e<this.data.AchieveCfg.length;e++){var o=this.data.AchieveCfg[e];if(o.ID==t)return o}return null},t.prototype.getAchieveCfgByLevel=function(t,e){for(var o=0;o<this.data.AchieveCfg.length;o++){var i=this.data.AchieveCfg[o];if(i.type==t&&i.Linear==e)return i}return null},t.prototype.getAchieveTreasureChestList=function(){return this.data.AchieveTreasureChest},t.prototype.getBuffCfgList=function(){return this.data.BuffCfg},t.prototype.getBuffFarray=function(){return this.data.BUFFarray},t.prototype.getBuffCfg=function(t){for(var e=0;e<this.data.BuffCfg.length;e++){var o=this.data.BuffCfg[e];if(o.id==t)return o}return null},t.prototype.getChallengeCfgList=function(){return this.data.ChallengeCfg},t.prototype.getChallengeCfg=function(t){return this.data.ChallengeCfg[t-1]},t.prototype.getCode=function(t){for(var e=t.toLocaleLowerCase(),o=0;o<this.data.giftCfg.length;o++){var i=this.data.giftCfg[o];if(i.gift_num.toLocaleLowerCase()==e)return i}return null},t.prototype.getCodeJoin=function(t){for(var e=0;e<this.data.giftCfg.length;e++){var o=this.data.giftCfg[e];if(o.join==t)return o}return null},t}();a.DataMgr=p,cc._RF.pop(),cc._RF.pop()},{}],DragonBody:[function(t,e,o){"use strict";cc._RF.push(e,"93c78W8R39IRLiSAnlcUIiZ","DragonBody");var i=e,n=o;cc._RF.push(i,"93c78W8R39IRLiSAnlcUIiZ","DragonBody");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bodyArr=[],e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){o.instance=this},e.prototype.start=function(){},e.prototype.init=function(t){this.initView(t)},e.prototype.initView=function(t){this.node.getComponent(cc.Sprite).spriteFrame=this.bodyArr[t%this.bodyArr.length]},e.prototype.die=function(){this.node.removeFromParent()},s([p(cc.SpriteFrame)],e.prototype,"bodyArr",void 0),o=s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],DragonCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f0e81maGGxIHYcGU4X1K7gv","DragonCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f0e81maGGxIHYcGU4X1K7gv","DragonCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RSD_DataMgr"),p=i("DragonBody"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragonHeadPrefab=null,e.dragonBodyPrefab=null,e.bodySpacing=15,e.speed=105,e.initialOffsetX=350,e.initialOffsetY=300,e.offsetStepX=50,e.offsetStepY=50,e.minOffsetX=50,e.minOffsetY=50,e.dragonParts=[],e.trailPoints=[],e.pathProgress=0,e.offsetX=0,e.offsetY=0,e.center=cc.v2(0,0),e.dragonLength=0,e.dragonAction=!1,e.currentIndex=1,e.maxIndex=6,e.colorIndex=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,this.center=cc.v2(this.node.parent.convertToWorldSpaceAR(cc.Vec2.ZERO).x+100,this.node.parent.convertToWorldSpaceAR(cc.Vec2.ZERO).y),this.offsetX=this.initialOffsetX,this.offsetY=this.initialOffsetY,this.initParam(),this.pathProgress=0},e.prototype.start=function(){this.spawnDragon()},e.prototype.initParam=function(){this.dragonLength=l.default.getInstance().getDragonLenghtByLevel(1)*this.maxIndex},e.prototype.spawnDragon=function(){var t=cc.instantiate(this.dragonHeadPrefab);t.setPosition(this.center.add(cc.v2(-this.offsetX,this.offsetY))),this.node.addChild(t),this.dragonParts.push(t);for(var e=1;e<this.dragonLength;e++){var o=cc.instantiate(this.dragonBodyPrefab);o.getComponent(p.default).init(this.colorIndex),this.currentIndex==this.maxIndex&&(this.currentIndex=1,this.colorIndex++),this.currentIndex++,o.setPosition(t.position),this.node.addChild(o),this.dragonParts.push(o)}},e.prototype.update=function(t){this.moveHead(t),this.followTrail(),this.updateZOrder()},e.prototype.moveHead=function(t){if(0!==this.dragonParts.length){var e,o=this.dragonParts[0],i=o.getPosition(),n=this.getRectanglePoints(),a=this.vec2ToVec3(n[0]),r=this.vec2ToVec3(n[1]),s=this.vec2ToVec3(n[2]),c=this.vec2ToVec3(n[3]);switch(this.pathProgress){case 0:e=r;break;case 1:e=s;break;case 2:e=c;break;case 3:e=a}var l=e.sub(this.vec2ToVec3(i));l.mag()<this.speed*t?(o.setPosition(e),this.turnToNextCorner()):o.setPosition(cc.v2(i.x,i.y).add(cc.v2(l.x,l.y).normalize().mul(this.speed*t))),this.trailPoints.unshift(this.vec2ToVec3(o.getPosition()).clone());for(var p=this.dragonLength*this.bodySpacing;this.trailPoints.length>p;)this.trailPoints.pop()}},e.prototype.turnToNextCorner=function(){this.pathProgress++,this.pathProgress>3&&(this.pathProgress=0,this.offsetX-=this.offsetStepX,this.offsetY-=this.offsetStepY,this.offsetX<this.minOffsetX&&(this.offsetX=this.minOffsetX),this.offsetY<this.minOffsetY&&(this.offsetY=this.minOffsetY))},e.prototype.followTrail=function(){for(var t=1;t<this.dragonParts.length;t++){var e=t*this.bodySpacing;if(e<this.trailPoints.length){var o=this.trailPoints[e];this.dragonParts[t].setPosition(o)}}},e.prototype.getRectanglePoints=function(){var t=this.center.x,e=this.center.y,o=this.offsetX,i=this.offsetY;return[cc.v2(t-o,e-i),cc.v2(t-o,e+i),cc.v2(t+o,e+i),cc.v2(t+o,e-i)]},e.prototype.updateZOrder=function(){for(var t=this.dragonParts.length,e=1;e<t;e++)this.dragonParts[e].zIndex=t-e;this.dragonParts[0].zIndex=9999},e.prototype.vec2ToVec3=function(t){return new cc.Vec3(t.x,t.y,0)},e.prototype.getColliderItemArr=function(t,e){for(var o=[],i=0,n=this.dragonParts;i<n.length;i++){var a=n[i],r=a.convertToWorldSpaceAR(cc.Vec3.ZERO),s=t.x-r.x,c=t.y-r.y;s*s+c*c<=e*e&&o.push(a)}return o},c([h(cc.Prefab)],e.prototype,"dragonHeadPrefab",void 0),c([h(cc.Prefab)],e.prototype,"dragonBodyPrefab",void 0),o=c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],EditorManager:[function(t,e,o){"use strict";cc._RF.push(e,"e84c9h26/pDL5ehMU5LlXD7","EditorManager");var i=t,n=e,a=o;cc._RF.push(n,"e84c9h26/pDL5ehMU5LlXD7","EditorManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.EditorManager=void 0;var r=i("Utils"),s=function(){function t(){this.enableUMAlret=!1,this.enableRemoteCfg=!1,this.infostr=[]}return t.prototype.initSdk=function(t,e){var o=r.Utils.getWebUrlParams(window.location.href),i=o.enableUM,n=o.cfg;i&&"1"==i&&(this.enableUMAlret=!0),n&&"1"==n&&(this.enableRemoteCfg=!0),e&&e()},t.prototype.getEnableRemoteCfg=function(){return this.enableRemoteCfg},t.prototype.getLaunchOptionsSync=function(){},t.prototype.getCode=function(){return""},t.prototype.pauseRecord=function(){},t.prototype.resumeRecord=function(){},t.prototype.verifyKey=function(){},t.prototype.toAppStore=function(){},t.prototype.openNotify=function(){},t.prototype.shareImg=function(){},t.prototype.getUserInfo=function(){},t.prototype.getIsZhiTouUser=function(){return!1},t.prototype.checkCanOpenSideBar=function(){},t.prototype.openSideBar=function(){},t.prototype.isFromBroadside=function(){},t.prototype.playMultitonVideo=function(){},t.prototype.checkShortcut=function(t,e){e&&e(!1)},t.prototype.addShortcut=function(t,e){e&&e("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u6210\u529f")},t.prototype.hasVerify=function(){return!0},t.prototype.canShare=function(){return!0},t.prototype.youmengTrack=function(t,e,o,i){var n="\u4e8b\u4ef6id\uff1a"+t+"\n";n+="\u4e8b\u4ef6\u503c\uff1a"+o+"\n",n+="AB\u7528\u6237\uff1a"+e+"\n",n+="\u8bf4\u660e\uff1a"+i+"\n",setTimeout(function(){console.log(n)},250)},t.prototype.login=function(t,e){e&&e()},t.prototype.pay=function(t,e){e&&e()},t.prototype.share=function(t,e){e&&e()},t.prototype.showBanner=function(t,e){e&&e()},t.prototype.hideBanner=function(t,e){e&&e()},t.prototype.showInsertAd=function(t,e){e&&e()},t.prototype.showVideoAd=function(t,e){e&&e()},t.prototype.otherFun=function(t,e){e&&e()},t.prototype.shark=function(t,e){e&&e()},t.prototype.recordVideo=function(t,e){e&&e()},t.prototype.shareVideo=function(t,e){e&&e()},t.prototype.stopRecorderManager=function(t,e){e&&e()},t.prototype.setLanguage=function(t,e){return e&&e(),"zh"},t}();a.EditorManager=s,cc._RF.pop(),cc._RF.pop()},{}],EnemyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"bf421TQMihBKZTIlv+Hew6l","EnemyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"bf421TQMihBKZTIlv+Hew6l","EnemyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RoleCtrl"),p=i("CameraCtrl"),u=i("QuadTree"),d=i("Enemy"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monsterPrefab=null,e.spawnDistance=300,e.monsters=[],e}var o;return s(e,t),o=e,e.prototype.start=function(){o.instance=this;var t=new cc.Rect(-1e3,-1e3,2e3,2e3);this.quadTree=new u.Quadtree(t),this.player=l.default.instance.body,this.schedule(this.spawnMonsterInCameraView,1)},e.prototype.getMonsterLayer=function(){return this.monsters},e.prototype.spawnMonsterInCameraView=function(){var t,e=p.default.instance.getCameraBounds();do{var o=cc.misc.lerp(e.min.x-this.spawnDistance,e.max.x+this.spawnDistance,Math.random()),i=cc.misc.lerp(e.min.y-this.spawnDistance,e.max.y+this.spawnDistance,Math.random());t=cc.v2(o,i)}while(t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y);var n=cc.instantiate(this.monsterPrefab);n.setPosition(t),n.parent=this.node,n.getComponent(d.default).setTarget(this.player),this.monsters.push(n),this.quadTree.insert(n)},e.prototype.update=function(){},c([m(cc.Prefab)],e.prototype,"monsterPrefab",void 0),c([m({tooltip:"\u602a\u7269\u751f\u6210\u8ddd\u79bb\uff08\u8d85\u51fa\u6444\u50cf\u673a\u8303\u56f4\uff09"})],e.prototype,"spawnDistance",void 0),o=c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],Enemy:[function(t,e,o){"use strict";cc._RF.push(e,"14e0bN5MQFF9bQyOAna7UDi","Enemy");var i=e,n=o;cc._RF.push(i,"14e0bN5MQFF9bQyOAna7UDi","Enemy");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e.speed=100,e.target=null,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){o.instance=this},e.prototype.bodyBoxCollider=function(){return this.node},e.prototype.setTarget=function(t){this.target=t},e.prototype.getCameraBounds=function(t){var e=cc.view.getVisibleSize(),o=t.node.convertToWorldSpaceAR(cc.Vec2.ZERO),i=e.width/2,n=e.height/2;return cc.rect(o.x-i,o.y-n,e.width,e.height)},e.prototype.computeAABB=function(t){for(var e=t[0].x,o=t[0].x,i=t[0].y,n=t[0].y,a=1;a<t.length;a++){var r=t[a];r.x<e&&(e=r.x),r.x>o&&(o=r.x),r.y<i&&(i=r.y),r.y>n&&(n=r.y)}return cc.rect(e,i,o-e,n-i)},e.prototype.rectIntersects=function(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},e.prototype.getMonstersInCameraView=function(t,e){for(var o=[],i=this.getCameraBounds(e),n=0,a=t;n<a.length;n++){var r=a[n],s=r.getComponent(cc.BoxCollider);if(s&&s.world&&s.world.points&&s.world.points.length>0){var c=s.world.points.map(function(t){return cc.v2(t.x,t.y)}),l=this.computeAABB(c);this.rectIntersects(i,l)&&o.push(r)}}return o},e.prototype.die=function(){this.node.removeFromParent()},e.prototype.update=function(t){if(this.target){var e=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),o=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),i=e.sub(o).normalize().mul(this.speed*t),n=new cc.Vec3(i.x,i.y,0);this.node.position=this.node.position.add(n),e.x<o.x?this.node.scaleX=-Math.abs(this.node.scaleX):this.node.scaleX=Math.abs(this.node.scaleX)}},s([p(cc.Node)],e.prototype,"player",void 0),o=s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],EventMgr:[function(t,e,o){"use strict";cc._RF.push(e,"1679c2ub2tJ4L/kArQZViBz","EventMgr");var i=e,n=o;cc._RF.push(i,"1679c2ub2tJ4L/kArQZViBz","EventMgr"),Object.defineProperty(n,"__esModule",{value:!0}),n.EventMgr=n.Listener=void 0;var a=function(){function t(t,e){this.mListener=e,this.mtarget=t}return Object.defineProperty(t.prototype,"listener",{get:function(){return this.mListener},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.mtarget},enumerable:!1,configurable:!0}),t}();n.Listener=a;var r=function(){function t(){this.global_event_list=new Array}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.getEventNum=function(t){return this.global_event_list[t]?this.global_event_list[t].length:0},t.prototype.on=function(t,e,o,i){if(void 0===i&&(i=!1),null!=t&&null!=o){if(null==this.global_event_list[t]&&(this.global_event_list[t]=new Array),!i&&this.global_event_list[t])for(var n=0;n<this.global_event_list[t].length;n++)if(this.global_event_list[t][n].listener==o&&this.global_event_list[t][n].target==e)return;var r=new a(e,o);this.global_event_list[t].push(r)}else console.error("RegistEvent Error")},t.prototype.off=function(t,e,o){if(null!=t&&null!=o&&null!=this.global_event_list[t])for(var i=0;i<this.global_event_list[t].length;i++)this.global_event_list[t][i].listener==o&&this.global_event_list[t][i].target==e&&this.global_event_list[t].splice(i,1)},t.prototype.removeAll=function(){this.global_event_list=new Array},t.prototype.emit=function(t,e,o,i,n,a,r){if(null!=t){if(null!=this.global_event_list[t])for(var s=0;s<this.global_event_list[t].length;s++){var c=this.global_event_list[t][s];c&&c.listener.call(c.target,e,o,i,n,a,r)}}else console.error("FireEvent Error")},t.instance=null,t}();n.EventMgr=r,cc._RF.pop(),cc._RF.pop()},{}],FLY_App:[function(t,e,o){"use strict";cc._RF.push(e,"d603eyReoNFvoKVQ1GXbAIj","FLY_App");var i=t,n=e,a=o;cc._RF.push(n,"d603eyReoNFvoKVQ1GXbAIj","FLY_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("EventMgr"),c=i("UIMgr"),l=i("Config"),p=i("FLY_Configs"),u=i("FLY_DataMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(t){t.keyCode==cc.macro.KEY.space&&s.EventMgr.getInstance().emit(p.emFLYEventName.spacePause)}),this.addTouchEvent(),this._exitCall=e;var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(p.FLY_UIID.UIGame,l.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(p.FLY_AudioId.bgm,p.FLYConfig.BgMusic)})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(p.FLY_UICF),r.AudioMgr.getInstance().addAdConf(p.FLY_AudioCF),u.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){c.UIMgr.getInstance().closeById(p.FLY_UIID.UIGame),c.UIMgr.getInstance().closeById(p.FLY_UIID.UIResult),c.UIMgr.getInstance().closeById(p.FLY_UIID.UISetting),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],FLY_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"92a30bXuqlPCbc6XTFJ8Rug","FLY_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"92a30bXuqlPCbc6XTFJ8Rug","FLY_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("NodeLib"),d=i("FLY_Configs"),h=i("FLY_BloodItem"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_blood=null,e.bloodArr=[],e.maxItemNum=30,e.nowItemNum=0,e}return s(e,t),e.prototype.initProperty=function(){this.pro_blood=u.default.findChildByName(this.node,"blood")},e.prototype.initPool=function(){p.PoolMgr.getInstance().creatrePool(d.poolName.bloodText,this.pro_blood)},e.prototype.createBlood=function(t,e,o){if(!(this.nowItemNum>=this.maxItemNum)){this.nowItemNum++;var i=this.bloodArr.pop();i||((i=p.PoolMgr.getInstance().getNode(d.poolName.bloodText)).parent=this.node);var n=i.getComponent(h.default);i.setPosition(o),n.resumeNode(),n.isCirt(e,t,this)}},e.prototype.recycleBlood=function(t){this.nowItemNum--,this.bloodArr.push(t)},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.initPool()},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FLY_BloodItem:[function(t,e,o){"use strict";cc._RF.push(e,"1e4bexoO09FAaGAu2yi78Hf","FLY_BloodItem");var i=t,n=e,a=o;cc._RF.push(n,"1e4bexoO09FAaGAu2yi78Hf","FLY_BloodItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Utils"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentCtrl=null,e}return s(e,t),e.prototype.isCirt=function(t,e,o){this.parentCtrl||(this.parentCtrl=o),t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e.toString()):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e.toString()),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255,this.node.active=!0;var e=l.Utils.randomRang(-30,30),o=l.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){t.node.active=!1,t.parentCtrl.recycleBlood(t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.opacity=255},e.prototype.onLoad=function(){},e.prototype.start=function(){},c([d(cc.Node)],e.prototype,"isCritState",void 0),c([d(cc.Label)],e.prototype,"critLabel",void 0),c([d(cc.Label)],e.prototype,"commonLabel",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],FLY_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"9e6fc7aTBpHz7wEpLc34nxA","FLY_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"9e6fc7aTBpHz7wEpLc34nxA","FLY_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FLY_Configs"),u=i("fly_GameEnumData"),d=i("FLY_DataMgr"),h=i("fly_gameCtrl"),f=i("FLY_BuffItem"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t,e){this.nowCfg=null,this.item=null,this.nowCfg=t,this.item=e}),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffList=[],e.enemyBuffList=[],e.contrlBuffList=[],e.pro_buff=null,e.buffMoveSpeed=100,e.aimDistaceY=0,e.haveBuff=!1,e.buffGapTime=0,e.buffTime=.5,e}return s(e,t),e.prototype.initProperty=function(){this.pro_buff=this.node.getChildByName("pro_buff")},e.prototype.initParam=function(){this.buffMoveSpeed=100*d.default.getInstance().getParam(u.enumBasicParaCfg.buffMove),this.pro_buff.y=cc.winSize.height/2+150;var t=h.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroLayer().y;this.aimDistaceY=Math.abs(t-this.pro_buff.y)-150},e.prototype.addBuff=function(t,e){if(t){if(t.buffType)if(e==p.belongCamp.enemy){(n=cc.instantiate(this.pro_buff)).active=!0;var o=n.getComponent(f.default),i=new y(t,o);n.parent=this.node,this.buffList.push(i)}else{var n;o=(n=cc.instantiate(this.pro_buff)).getComponent(f.default),n.parent=this.node,n.active=!0;var a=h.default.instance.getPro_buttomCtrl().getEnemyCtrl().getHeroList();o.initNode(t,a,this.buffMoveSpeed,this,this.aimDistaceY,p.belongCamp.hero)}}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.removeBuff=function(t){for(var e=0;e<this.contrlBuffList.length;e++)if(this.contrlBuffList[e].uuid==t.uuid){this.contrlBuffList[e].node.removeFromParent(),this.contrlBuffList.splice(e,1);break}},e.prototype.doInitBuffDown=function(){if(0!=this.buffList.length){var t=this.buffList.shift(),e=t.item,o=h.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList();this.contrlBuffList.push(e),e.initNode(t.nowCfg,o,this.buffMoveSpeed,this,this.aimDistaceY,p.belongCamp.enemy),this.haveBuff=!0}},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.initParam()},e.prototype.onUpdate=function(t){this.haveBuff?(this.buffGapTime+=t,this.buffGapTime>=this.buffTime&&(this.buffGapTime=0,this.haveBuff=!1)):this.doInitBuffDown();for(var e=0;e<this.contrlBuffList.length;e++)this.contrlBuffList[e].onUpdate(t)},c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],FLY_BuffItem:[function(t,e,o){"use strict";cc._RF.push(e,"7035ctcFepOe437cQ8p1XlD","FLY_BuffItem");var i=t,n=e,a=o;cc._RF.push(n,"7035ctcFepOe437cQ8p1XlD","FLY_BuffItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("Utils"),d=i("NodeLib"),h=i("FLY_Configs"),f=i("FLY_DataMgr"),m=i("fly_gameCtrl"),g=i("FLY_HeroItem"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e){this.name=t,this.weight=e},B=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=null),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.pro_node1=null,e.pro_node2=null,e.nodeObj1=new B,e.nodeObj2=new B,e.heroList=[],e.buffMoveSpeed=0,e.parentCtrl=null,e.moveDistance=0,e.buffCamp=null,e}return s(e,t),e.prototype.initProperty=function(){this.pro_node1=d.default.findChildByName(this.node,"node1"),this.pro_node2=d.default.findChildByName(this.node,"node2")},e.prototype.initNode=function(t,e,o,i,n,a){var r,s=this;if(a==h.belongCamp.hero&&this.scheduleOnce(function(){s.doReward()},.5),this.buffMoveSpeed=o,this.moveDistance=n,this.parentCtrl=i,this.buffCamp=a,r=t){if(r.buffType)if(this.heroList=e,1==r.buffType){var c=this.getResult(),l=this.getResult(),p=this.getPropertyResultArr(c,l,r);(0==c||1==c||2==c)&&this.initPropertyNode(c,p[0],this.pro_node1,this.nodeObj1),(0==l||1==l||2==l)&&this.initPropertyNode(l,p[1],this.pro_node2,this.nodeObj2)}else if(2==r.buffType){if(0==(c=this.getResult())){var u=this.getPropertyResult(r.buff1,c);this.initPropertyNode(c,u[0],this.pro_node1,this.nodeObj1)}else 1==c?(u=this.getPropertyResult(r.buff2?r.buff2:r.buff1,c),this.initPropertyNode(c,u[0],this.pro_node1,this.nodeObj1)):2==c&&(u=this.getPropertyResult(r.buff3?r.buff3:r.buff1,c),this.initPropertyNode(c,u[0],this.pro_node1,this.nodeObj1));var d=this.getNewRole();this.initNewNode(d[0],this.pro_node2,this.nodeObj2)}else d=this.getNewRole(2),this.initNewNode(d[0],this.pro_node1,this.nodeObj1),this.initNewNode(d[1],this.pro_node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getResult=function(){var t;this.buffCamp==h.belongCamp.enemy?t=f.default.getInstance().getBuffOddsCfgByAmount(this.heroList.length):this.buffCamp==h.belongCamp.hero&&(t=f.default.getInstance().getEnemyBuffOddsCfgByAmount(this.heroList.length));var e=[],o=t.buff1Odds+t.buff2Odds+t.buff3Odds;e.push(t.buff1Odds),e.push(t.buff2Odds),e.push(t.buff3Odds);for(var i=Math.random()*o,n=0;n<e.length;n++)if((i-=e[n])<=0)return n},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=this.heroList.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t));if(3==this.heroList[e].getIndex()){for(var i=0;i<o.length;i++)if(o[i].includes("penetrate")){o.splice(i,1);break}}else if(this.heroList[e].isMaxAttackSpeed())for(i=0;i<o.length;i++)if(o[i].includes("speed")){o.splice(i,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=[],o=this.heroList[0].getIndex(),i=this.heroList[1]?this.heroList[1].getIndex():-1;for(var n in this.heroList){var a=this.heroList[n].getIndex(),r=void 0;this.buffCamp==h.belongCamp.hero?r=f.default.getInstance().getEnemeyMateOddsCfgByID(a):this.buffCamp==h.belongCamp.enemy&&(r=f.default.getInstance().getMateOddsCfgByID(a)),e=e.concat(this.createRoleLottery(r.mateOdds.split("|"),o,i))}for(var s=[];t--;){var c;for(c=u.Utils.weight_rand(e)?Number(u.Utils.weight_rand(e).name):s[0],n=0;n<e.length;n++)if(c==Number(e[n].name)){e.splice(n,1);break}s.push(c)}return s},e.prototype.createRoleLottery=function(t,e,o){var i=[];for(var n in t){var a=t[n].split(","),r=Number(a[0]),s=Number(a[1]);if(e!=r&&r!=o){var c=new b(r.toString(),s);i.push(c)}}return i},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=this.heroList[t].getIndex(),r=f.default.getInstance().getCharacterByID(a);this.loadSpriteFrame(h.emFLYBundles.imgs,"js_b/"+r.image,function(r){n.initPropertyView(o,r,e,a),n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=f.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=n.heroList[t].node,i.type=c.buffType})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=f.default.getInstance().getCharacterByID(i).characterName,p=f.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon"),s=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(h.emFLYBundles.imgs,"js_b/"+s.image,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=f.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){if(p.AudioMgr.getInstance().playEffect(h.FLY_AudioId.buff,h.FLY_AudioId.buff),this.buffCamp==h.belongCamp.hero){var t=m.default.instance.getPro_buttomCtrl().getEnemyCtrl();0==Math.floor(2*Math.random())?this.nodeObj1.isNew?t.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?t.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.removeFromParent()}else(t=m.default.instance.getPro_buttomCtrl().getHeroCtrl()).checkHeroPosX()?this.nodeObj1.isNew?t.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?t.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.active=!1,this.buffMoveSpeed=0,this.parentCtrl.removeBuff(this)},e.prototype.doPeopertyReward=function(t){var e,o=t.heroNode,i=t.type;this.buffCamp==h.belongCamp.hero?null!=(e=o.getComponent(g.default))&&e.enemyShowBuffImage(i,t.addType,t.addNum):null!=(e=o.getComponent(g.default))&&e.modifyAttribute(i,t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.node.y-=this.buffMoveSpeed*t,this.moveDistance-=this.buffMoveSpeed*t,this.moveDistance<=0&&this.doReward()},c([_(cc.SpriteFrame)],e.prototype,"sp",void 0),c([v],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],FLY_BulletBaseItem:[function(t,e,o){"use strict";cc._RF.push(e,"ee7866N1aZLkI9tEnfz0kUW","FLY_BulletBaseItem");var i=t,n=e,a=o;cc._RF.push(n,"ee7866N1aZLkI9tEnfz0kUW","FLY_BulletBaseItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("Utils"),u=i("FLY_Configs"),d=i("FLY_DataMgr"),h=i("fly_gameCtrl"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.penetrate=0,e.lastAttackID=-1,e.lastDir=u.bulletDir.None,e.velocity=cc.Vec3.ZERO,e.angle=0,e.isDestroy=!1,e.isBounceBullet=!1,e.canBounce=!1,e.screnSize=null,e.hitTimes=0,e.isBounceWithDragon=!1,e.basePenetrate=0,e.appearTime=0,e.bulletCamp=null,e.doCheckDistance=0,e.bulletDir=0,e}return s(e,t),e.prototype.initParam=function(t,e,o,i,n,a,r){this.range=t,this.penetrate=e,this.flySpeed=o,a==u.belongCamp.enemy?(this.bulletDir=-1,this.node.scaleY=-1):(this.bulletDir=1,this.node.scaleY=1),this.hero=i,this.appearTime=n,this.isDestroy=!1,this.isBounceBullet=!1,this.canBounce=!1;var s=i.getIndex();this.bulletCamp=a,this.doCheckDistance=r,3!=s&&17!=s||this.initBounceBullet(s)},e.prototype.doResycleNoBounceBulletDown=function(){var t=this;this.isDestroy=!0,this.lastAttackID=-1,this.node.y=-1e4,this.scheduleOnce(function(){t.hero.recycleBullet(t)})},e.prototype.initBounceBullet=function(t){this.initAngle(),this.lastDir=u.bulletDir.None,this.isBounceBullet=!0,this.screnSize=h.default.instance.getBulletBoundary(),this.hitTimes=d.default.getInstance().getCharacterByID(t).hitTimes,3==t?(this.penetrate=100,this.isBounceWithDragon=!1):this.isBounceWithDragon=!0},e.prototype.resycleBullet=function(){this.isDestroy||(this.isBounceBullet?this.doResycleBounceBulletDown():(this.penetrate--,this.penetrate<0&&this.doResycleNoBounceBulletDown()))},e.prototype.doResycleBounceBulletDown=function(){this.hitTimes--,this.hitTimes<=0&&this.doResycleNoBounceBulletDown(),this.isBounceWithDragon&&(this.penetrate--,this.penetrate<0&&this.bounceWithDragon())},e.prototype.checkCollision=function(){if(!(this.doCheckDistance>0)){var t=this.node.getPosition(),e=this.lastAttackID,o=this.hero.getIsCirt(),i=this.hero.getCirtDamage(o),n=h.default.instance.getPro_topCtrl().getDragonCtrlByCamp(this.bulletCamp).checkCollision(t,e,i,o);-1!=n&&(this.lastAttackID=n,this.resycleBullet())}},e.prototype.bounceWithDragon=function(){this.penetrate=this.hero.getPenetrate(),this.lastDir=u.bulletDir.None,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()},e.prototype.overSide=function(t,e){t.x,e.leftBoundary,t.x,e.rightBoundary,t.y,e.downBoundary,t.y,e.upBoundary},e.prototype.initAngle=function(){var t=p.Utils.randomRang(-45,45);this.angle=t;var e=(t+90)*(Math.PI/180),o=new cc.Vec3(Math.cos(e),Math.sin(e),0);this.velocity=o.multiplyScalar(100*this.flySpeed),this.changeAngle()},e.prototype.changeAngle=function(){this.lastAttackID=-1,this.node.angle=this.angle},e.prototype.onUpdateBullet1=function(t){var e=this.flySpeed*t*100;this.node.y+=e*this.bulletDir,this.doCheckDistance-=e,this.range-=e,this.range<=0&&this.resycleBullet()},e.prototype.onUpdateBullet2=function(t){this.node.y>this.screnSize.downBoundary&&(this.canBounce=!0),this.node.x+=this.velocity.x*t,this.node.y+=this.velocity.y*t;var e=this.screnSize;this.overSide(this.node.position,e);var o=this.node.position;this.canBounce&&(o.x<e.leftBoundary&&this.lastDir!=u.bulletDir.left&&(this.lastDir=u.bulletDir.left,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),o.x>e.rightBoundary&&this.lastDir!=u.bulletDir.right&&(this.lastDir=u.bulletDir.right,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),o.y<e.downBoundary&&this.lastDir!=u.bulletDir.down&&(this.lastDir=u.bulletDir.down,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()),o.y>e.upBoundary&&this.lastDir!=u.bulletDir.up&&(this.lastDir=u.bulletDir.up,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()))},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.isDestroy||(this.appearTime-=t,this.appearTime<=0?this.doResycleNoBounceBulletDown():(this.isBounceBullet?this.onUpdateBullet2(t):this.onUpdateBullet1(t),this.checkCollision()))},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FLY_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"962f74eZlVKkqEdd/w4A+xO","FLY_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"962f74eZlVKkqEdd/w4A+xO","FLY_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.emFLYBuffType=l.belongCamp=l.heroPropertyType=l.AIState=l.bulletDir=l.poolName=l.emFLYGameState=l.emFLYEventName=l.FLY_AudioCF=l.FLY_AudioId=l.FLY_UICF=l.FLYConfig=l.emFLYBundles=l.FLY_UIID=void 0,function(t){t.UIGame="FLY_UIGame",t.UIResult="FLY_UIResult",t.UISetting="FLY_UISetting"}(a=l.FLY_UIID||(l.FLY_UIID={})),function(t){t.prefabs="fly_prefabs",t.audios="fly_audios",t.imgs="fly_imgs",t.configs="fly_configs"}(r=l.emFLYBundles||(l.emFLYBundles={})),l.FLYConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.FLY_UICF=((i={})[a.UIGame]={prefab:"ui/FLY_UIGame",name:"FLY_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/FLY_UIResult",name:"FLY_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/FLY_UISetting",name:"FLY_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.doubleSword="doubleSword",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.dragonHit="dragonHit",t.rake="rake",t.typhoon="typhoon",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.barrier="barrier",t.dragonBallGet="dragonBallGet",t.dragonBallShow="dragonBallShow",t.electric="electric",t.fireball="fireball",t.ice="ice",t.icebreak="icebreak",t.lightningBullet="lightningBullet",t.magic="magic",t.wind="wind",t.moon="moon",t.boomerang="boomerang",t.boom="boom",t.moonGod="moonGod",t.lightDragonBall="lightDragonBall",t.over="over",t.bluePalm="bluePalm",t.summon="summon",t.levelup="levelup",t.chi="chi",t.congrat="congrat",t.gang="gang",t.peng="peng"}(s=l.FLY_AudioId||(l.FLY_AudioId={})),l.FLY_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.dragonHit]={path:"dragonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.dragonBallGet]={path:"dragonBallGet",bundle:r.audios},n[s.barrier]={path:"barrier",bundle:r.audios},n[s.dragonBallShow]={path:"dragonBallShow",bundle:r.audios},n[s.electric]={path:"electric",bundle:r.audios},n[s.fireball]={path:"fireball",bundle:r.audios},n[s.ice]={path:"ice",bundle:r.audios},n[s.icebreak]={path:"icebreak",bundle:r.audios},n[s.lightningBullet]={path:"lightningBullet",bundle:r.audios},n[s.magic]={path:"magic",bundle:r.audios},n[s.wind]={path:"wind",bundle:r.audios},n[s.moon]={path:"moon",bundle:r.audios},n[s.boomerang]={path:"boomerang",bundle:r.audios},n[s.boom]={path:"boom",bundle:r.audios},n[s.moonGod]={path:"moonGod",bundle:r.audios},n[s.lightDragonBall]={path:"lightDragonBall",bundle:r.audios},n[s.over]={path:"over",bundle:r.audios},n[s.bluePalm]={path:"bluePalm",bundle:r.audios},n[s.summon]={path:"bluePalm",bundle:r.audios},n[s.levelup]={path:"levelup",bundle:r.audios},n[s.chi]={path:"chi",bundle:r.audios},n[s.congrat]={path:"congrat",bundle:r.audios},n[s.gang]={path:"gang",bundle:r.audios},n[s.peng]={path:"peng",bundle:r.audios},n),function(t){t.GAD_Player_Die="fly_gad_player_die",t.GAD_Shoot_Bullet="fly_gad_shoot_bullet",t.GAD_Show_Hit_Text="fly_gad_show_hit_text",t.GAD_Show_Warn="fly_gad_show_warn",t.GAD_Bubble_Buf="fly_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="fly_gad_hit_effect",t.GAD_Show_Buff_Tip="fly_gad_show_buff_tip",t.GAD_Setting_Back="fly_gad_setting_back",t.pause="fly_pause",t.resume="fly_resume",t.skillPause="fly_skillPause",t.skillResume="fly_skillResume",t.buff="fly_buff",t.blood="fly_blood",t.newTarm="fly_newTarm",t.fly_loot="fly_loot",t.fly_ball_tips=" fly_ball_tips",t.loseBlood="fly_loseBlood",t.screenShake="fly_screenShake",t.warn="fly_warn",t.hitEffect="fly_hitEffect",t.destroy="fly_destroy",t.spacePause="fly_spacePause",t.fail="fly_fail"}(l.emFLYEventName||(l.emFLYEventName={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emFLYGameState||(l.emFLYGameState={})),function(t){t.blood="fly_blood",t.destroy="fly_destroy",t.effect="fly_effect",t.box="fly_box",t.body="fly_body",t.fly_item="fly_item",t.bulletName="FLY_Bullet_",t.CardSkill="CardSkill",t.MateSkill="mateSkill",t.bloodText="fly_bloodText",t.body_num="body_num",t.body_box="body_box",t.body_link="body_link",t.body_blood="body_blood",t.body_destroy="body_destroy",t.Bullet_skill="Bullet_skill"}(l.poolName||(l.poolName={})),function(t){t.None="None",t.up="up",t.down="down",t.left="left",t.right="right"}(l.bulletDir||(l.bulletDir={}));var p=function(){function t(){}return t.None="None",t.static="static",t.Move="move",t}();l.AIState=p,function(t){t[t.attackPower=1]="attackPower",t[t.attackSpeed=2]="attackSpeed",t[t.penetrate=3]="penetrate",t[t.critChance=4]="critChance",t[t.bulletCount=5]="bulletCount",t[t.skillInterval=6]="skillInterval",t[t.skillTimer=7]="skillTimer"}(l.heroPropertyType||(l.heroPropertyType={})),function(t){t[t.hero=1]="hero",t[t.enemy=2]="enemy"}(l.belongCamp||(l.belongCamp={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul",t.skillInterval="skillInterval"}(l.emFLYBuffType||(l.emFLYBuffType={}));var u=function(){function t(){}return t.testID=0,t}();l.Global=u,cc._RF.pop(),cc._RF.pop()},{}],FLY_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"62f6fhVJ6RGOIsA/8mUlt0a","FLY_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"62f6fhVJ6RGOIsA/8mUlt0a","FLY_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("FLY_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_fly/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emFLYBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getOurLevelCfg=function(){return this.data.levelRedCfg},t.prototype.getEnemyLevelCfg=function(){return this.data.levelCfg},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getMateOddsCfgByID=function(t){var e=this.data.mateOddsCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getEnemeyMateOddsCfgByID=function(t){var e=this.data.mateOddsEnCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getBuffOddsCfgByAmount=function(t){var e=this.data.buffOddsCfg;for(var o in e)if(e[o].charAmount==t)return e[o]},t.prototype.getEnemyBuffOddsCfgByAmount=function(t){var e=this.data.buffOddsEnCfg;for(var o in e)if(e[o].charAmount==t)return e[o]},t.prototype.getBuffImageByString=function(t){var e=this.data.buffMapCfg;for(var o in e)if(e[o].mahID==t)return e[o].image},t.prototype.getAIMotionCfg=function(){return this.data.motionCfg},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FLY_DragonBaseItem:[function(t,e,o){"use strict";cc._RF.push(e,"7844anDAuBHarSxi+MJuf7j","FLY_DragonBaseItem");var i=t,n=e,a=o;cc._RF.push(n,"7844anDAuBHarSxi+MJuf7j","FLY_DragonBaseItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("FLY_Configs"),f=i("fly_GameEnumData"),m=i("FLY_DataMgr"),g=i("fly_gameCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteFrameArr=[],e.nowIndex=0,e.dragonPath=[],e._isDestroy=!1,e.preNode=null,e.parent_Ctrl=null,e.gapNum=0,e.isLast=!1,e.testID=0,e.dragonCamp=null,e}var o;return s(e,t),o=e,e.prototype.initParam=function(t,e,o,i,n,a,r){void 0===n&&(n=0),void 0===a&&(a=null),void 0===r&&(r=0),this.setPreNode(a),this.resetNode(),this.parent_Ctrl=o,this.nowIndex=Math.max(t,0),this.dragonPath=e,this.gapNum=n,this.dragonCamp=i,a&&(this.setColor(r),this.setAnimation())},e.prototype.doDestroy=function(){this._isDestroy||(this._isDestroy=!0,this.node.active=!1)},e.prototype.setPreNode=function(t){this.preNode=t},e.prototype.setIsLast=function(){this.isLast=!0},e.prototype.consoleNowIndex=function(){console.log("\u5f53\u524d\u8282\u70b9\u662f\u7b2c",this.testID,"\u4e2a\u8282\u70b9  ","\u6240\u5728\u70b9\u4f4d\u662f",this.nowIndex)},e.prototype.getNowIndex=function(){return this.nowIndex},e.prototype.getGapNum=function(){return this.gapNum},e.prototype.getIsDestroy=function(){return this._isDestroy},e.prototype.informPre=function(t){void 0===t&&(t=!1),this.preNode&&(t&&this.doDestroy(),this.preNode=this.getInfactPre(),this.preNode.getComponent(o).setNodePosition())},e.prototype.setAnimation=function(){if(this.preNode){var t=this.pro_spNode.getComponent(cc.Animation);t.play(),this.dragonCamp==h.belongCamp.enemy?t.getAnimationState("body").clip.speed=m.default.getInstance().getParam(f.enumBasicParaCfg.dragonMoveAmni):t.getAnimationState("body").clip.speed=m.default.getInstance().getParam(f.enumBasicParaCfg.dragonMoveAmniRed)}},e.prototype.resetNode=function(){this.node.active=!0,this.pro_fire&&(this.pro_fire.active=!1),this._isDestroy=!1},e.prototype.setColor=function(t){this.preNode&&(this.dragonCamp==h.belongCamp.enemy&&(t+=5),4!=t&&9!=t||(this.isLast=!0,this.pro_spNode.anchorX=.7,this.pro_spNode.anchorY=.3,console.log("\u662f\u9f99\u5c3e")),this.pro_spNode.getComponent(cc.Sprite).spriteFrame=this.spriteFrameArr[t])},e.prototype.getNodeScaleX=function(){var t=this.dragonPath[this.nowIndex],e=this.dragonPath[this.nowIndex+1].sub(t);return e.x<0?-1:e.x>0?1:void 0},e.prototype.getInfactPre=function(){for(var t=this.preNode;t&&!t.active;)t.getComponent(o).removeInParent(),t=t.getComponent(o).preNode;return t},e.prototype.setNodePosition=function(){var t=this;this.informPre(),this.nowIndex-=this.gapNum;var e=this.dragonPath[this.nowIndex];this.node.setPosition(e),this.preNode||(this.node.scaleX=this.getNodeScaleX()),this.preNode||"die"!=this.node.getComponent(sp.Skeleton).animation&&(this.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1),this.node.getComponent(sp.Skeleton).setCompleteListener(function(){t.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}))},e.prototype.removeInParent=function(){p.PoolMgr.getInstance().freeNode(h.poolName.body,this.node),this.parent_Ctrl.removeBodyItem(this)},e.prototype.onLoad=function(){this.pro_spNode=this.node.getChildByName("pro_spNode"),this.pro_fire=this.node.getChildByName("pro_fire")},e.prototype.start=function(){},e.prototype.onUpdate=function(t,e){if(!this._isDestroy){if(this.nowIndex+=e,this.nowIndex>=this.dragonPath.length-1)return this.dragonCamp==h.belongCamp.enemy?this.sendEvent(h.emFLYEventName.fail):this.dragonCamp==h.belongCamp.hero&&u.UIMgr.getInstance().openUI(h.FLY_UIID.UIResult,d.UIID.UINONE,!0),void g.default.instance.onGameOver();var o=this.dragonPath[this.nowIndex];this.node.setPosition(o),this.preNode&&!this.isLast||(this.node.scaleX=this.getNodeScaleX())}},c([_(cc.SpriteFrame)],e.prototype,"spriteFrameArr",void 0),o=c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],FLY_DragonBloodItem:[function(t,e,o){"use strict";cc._RF.push(e,"ff15eT2ewNCWYomTkW+ohLR","FLY_DragonBloodItem");var i=t,n=e,a=o;cc._RF.push(n,"ff15eT2ewNCWYomTkW+ohLR","FLY_DragonBloodItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("FLY_Configs"),d=i("fly_gameCtrl"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteFrameArr=[],e.pro_collider=null,e.pro_hpLabel=null,e.targetNode=null,e.childCtrlArr=[],e._isDestroy=!1,e.parent_Ctrl=null,e.canBeHit=!1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_collider=this.node.getChildByName("pro_collider"),this.pro_hpLabel=this.node.getChildByName("pro_hpLabel").getComponent(cc.Label),this.canBeHit=!1},e.prototype.initParam=function(t,e,o,i,n){this.bloodCamp=n,this.pro_hpLabel.string=t+"",this.pro_collider.setContentSize(cc.size(290,100)),this.node.active=!0,this.targetNode=e,this.parent_Ctrl=o,this._isDestroy=!1,this.nowCfg=i,i.treasureType&&this.initTreasure(i.treasureType)},e.prototype.doCanbeHitDown=function(){this.canBeHit=!0},e.prototype.addChildNode=function(t){this.childCtrlArr.push(t)},e.prototype.getIsReward=function(){return this.nowCfg.treasureType},e.prototype.checkCollision=function(t,e,o){return!(this._isDestroy||!this.canBeHit||!this.inRange(t)||(t=this.node.parent.convertToWorldSpaceAR(t),this.sendEvent(u.emFLYEventName.hitEffect,t),this.loseHP(e,t,o),0))},e.prototype.checkRangeCollision=function(t,e){if(this._isDestroy||!this.canBeHit)return!1;if(this.getWorldColldierRect(this.pro_collider).intersects(t)){var o=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.loseHP(e,o,!1)}},e.prototype.checkInSkillRange=function(t){if(this._isDestroy)return null;var e=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);return Math.abs(e.x-t.x)<100?this.node:null},e.prototype.initTreasure=function(t){var e=this.node.getChildByName("pro_box");e.active=!0;for(var o=0;o<this.spriteFrameArr.length;o++)if(this.spriteFrameArr[o].name==t){e.getComponent(cc.Sprite).spriteFrame=this.spriteFrameArr[o];break}},e.prototype.loseHP=function(t,e,o){p.AudioMgr.getInstance().playEffect(u.FLY_AudioId.dragonHit,u.FLY_AudioId.dragonHit);var i=parseInt(this.pro_hpLabel.string)-t;this.pro_hpLabel.string=i+"",this.sendEvent(u.emFLYEventName.loseBlood,t,e,o),i<=0&&this.doDie()},e.prototype.doDie=function(){var t=this;p.AudioMgr.getInstance().playEffect(u.FLY_AudioId.burn,u.FLY_AudioId.burn),this._isDestroy=!0,this.node.active=!1,this.parent_Ctrl.removeBloodItem(this),this.targetNode=null,d.default.instance.getPro_buttomCtrl().getBuffCtrl().addBuff(this.nowCfg,this.bloodCamp),this.sendEvent(u.emFLYEventName.screenShake);for(var e=this.childCtrlArr.length,o=function(o){if(i.scheduleOnce(function(){t.childCtrlArr[o].informPre(!0),0==o&&t.node.removeFromParent()},.05*(e-o)),o%2){var n=i.childCtrlArr[o].node.convertToWorldSpaceAR(cc.v3(0,0,0));i.scheduleOnce(function(){t.sendEvent(u.emFLYEventName.destroy,n)},.05*o)}},i=this,n=0;n<this.childCtrlArr.length;n++)o(n)},e.prototype.inRange=function(t){var e=this.node.getPosition();return cc.rect(e.x-this.pro_collider.width/2,e.y-this.pro_collider.height/2,this.pro_collider.width,this.pro_collider.height).contains(t)},e.prototype.getWorldColldierRect=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var i=t.getAnchorPoint(),n=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),a=(t.width+e)*t.scaleX,r=(t.height+o)*t.scaleY;return cc.rect(n.x-i.x*a,n.y-i.y*r,a,r)},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(){if(!this._isDestroy&&this.targetNode){var t=this.targetNode.getPosition(),e=this.targetNode.parent.convertToWorldSpaceAR(t),o=this.node.parent.convertToNodeSpaceAR(e);this.node.setPosition(o),this.node.angle=this.targetNode.angle}},c([m(cc.SpriteFrame)],e.prototype,"spriteFrameArr",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FLY_DragonCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"5307epX1FZDxoy8JM8qhLH1","FLY_DragonCtrl");var i=t,n=e,a=o;cc._RF.push(n,"5307epX1FZDxoy8JM8qhLH1","FLY_DragonCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("NodeLib"),d=i("FLY_Configs"),h=i("fly_GameEnumData"),f=i("FLY_DataMgr"),m=i("fly_gameCtrl"),g=i("FLY_DragonBaseItem"),y=i("FLY_DragonBloodItem"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_bodyLayer=null,e.pro_bloodLayer=null,e.pro_head=null,e.pro_pathAnimation=null,e.dragonPath=[],e.dragonSpeed=200,e.dragonBodyArr=[],e.dragonBloodArr=[],e.bodyNowIndex=1,e.nowLevel=1,e.lastNode=null,e.nowLevelCfg=null,e.bloodNode=null,e.skillPause=!1,e.skillPauseTime=0,e.constDistance=.5,e.isEnd=!1,e.iceState=!1,e.isDie=!1,e.distance=70,e.nowZindex=1e4,e.dragonLastNode=null,e.dragonCamp=null,e.levelCfgArr=[],e.dragonColor=0,e.nowItemNum=0,e.maxItemNum=8,e.lockCreate=!1,e.createGapNum=0,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_bloodLayer=u.default.findChildByName(this.node,"pro_bloodLayer"),this.pro_bodyLayer=u.default.findChildByName(this.node,"pro_bodyLayer"),this.pro_head=u.default.findChildByName(this.node,"pro_head"),this.pro_pathAnimation=u.default.findChildByName(this.node,"pro_path").getComponent(cc.Animation)},e.prototype.initParam=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=[]),this.isEnd=!1,this.bodyNowIndex=1,this.nowLevel=1,this.lastNode=null,this.nowZindex=1e4,t?(this.dragonCamp=d.belongCamp.enemy,this.initEnemyParam()):(this.dragonCamp=d.belongCamp.hero,this.initOurParam()),this.dragonPath=e,this.dragonBodyArr=[],this.dragonBloodArr=[]},e.prototype.setIceState=function(t){this.iceState=t},e.prototype.doSkillPause=function(t){this.skillPause=!0,this.skillPauseTime=t},e.prototype.checkCollision=function(t,e,o,i){for(var n=0;n<this.dragonBloodArr.length;n++)if(e!=n&&this.dragonBloodArr[n].checkCollision(t,o,i))return n;return-1},e.prototype.checkRangeSkill=function(t,e){for(var o=0;o<this.dragonBloodArr.length;o++)this.dragonBloodArr[o].checkRangeCollision(t,e)},e.prototype.removeBloodItem=function(t){for(var e in this.dragonBloodArr)if(this.dragonBloodArr[e].uuid==t.uuid){this.dragonBloodArr.splice(parseInt(e),1);break}0==this.dragonBloodArr.length&&this.isEnd&&this.setDie()},e.prototype.removeBodyItem=function(t){for(var e in this.dragonBodyArr)if(this.dragonBodyArr[e].uuid==t.uuid){this.dragonBodyArr.splice(parseInt(e),1);break}},e.prototype.getCloserChildNode=function(){return this.pro_head},e.prototype.getHeadY=function(){return this.pro_head.y},e.prototype.getDragonPercent=function(){var t=this.dragonPath.length-1;return this.pro_head.getComponent(g.default).getNowIndex()/t},e.prototype.testChangeSpeed=function(t){"up"==t?this.dragonSpeed*=2:"down"==t&&(this.dragonSpeed/=2)},e.prototype.getFirstRewardBlood=function(){for(var t=0;t<this.dragonBloodArr.length;t++)if(!this.dragonBloodArr[t].getIsReward())return this.dragonBloodArr[t].node;return this.pro_head},e.prototype.setDie=function(){var t;this.isDie||(this.dragonCamp==d.belongCamp.hero?t=m.default.instance.getPro_buttomCtrl().getHeroCtrl():this.dragonCamp==d.belongCamp.enemy&&(t=m.default.instance.getPro_buttomCtrl().getEnemyCtrl()),t.setBodyDie(),this.dragonLastNode.active=!1,this.isDie=!0)},e.prototype.initOurParam=function(){this.dragonSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.moveSpeedRed),this.levelCfgArr=f.default.getInstance().getOurLevelCfg()},e.prototype.initEnemyParam=function(){this.dragonSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.moveSpeed),this.levelCfgArr=f.default.getInstance().getEnemyLevelCfg()},e.prototype.createPath=function(){for(var t=this.constDistance,e=[],o=0,i=1;i<this.dragonPath.length;i++){for(var n=this.dragonPath[i-1],a=this.dragonPath[i],r=n.sub(a).mag();o+r>=t;){var s=t-o,c=a.sub(n).normalize(),l=n.add(c.mul(s));e.push(l),o=0,n=l,r=a.sub(n).mag()}o+=r}this.dragonPath=e},e.prototype.createBody=function(){if(!this.lockCreate&&this.checkCanCreate()){0==(this.nowItemNum%=this.maxItemNum)&&(this.nowItemNum=0,this.setNextLevel(),this.createBodyBlood(),this.refreshItemColor());var t=this.getInfactPre(),e=p.PoolMgr.getInstance().getNode(d.poolName.body);this.pro_bodyLayer.addChild(e),e.zIndex=this.nowZindex--,this.dragonBodyArr.push(e.getComponent(g.default));var o=this.dragonColor;this.isEnd&&(o=4,this.lockCreate=!0);var i=t.getComponent(g.default).getNowIndex()-this.distance;e.getComponent(g.default).initParam(i,this.dragonPath,this,this.dragonCamp,this.distance,this.lastNode,o),this.isEnd?this.dragonLastNode=e:(this.bloodNode.getComponent(y.default).addChildNode(e.getComponent(g.default)),4==this.nowItemNum&&this.setBodyBloodTagetNode(e),this.nowItemNum++,this.lastNode=e,this.createGapNum+=this.distance)}},e.prototype.refreshItemColor=function(){this.dragonColor+=1,this.dragonColor>3&&(this.dragonColor=0)},e.prototype.setNextLevel=function(){this.nowLevelCfg=this.levelCfgArr[this.nowLevel-1],this.nowLevelCfg?this.nowLevel++:this.isEnd=!0},e.prototype.getGapNum=function(t){return this.getInfactPre().getComponent(g.default).getGapNum()/2+t/2},e.prototype.checkCanCreate=function(){return this.distance,this.getInfactPre().getComponent(g.default).getNowIndex()-this.distance>=0},e.prototype.createBodyHead=function(){var t=this.pro_head,e=t.getComponent(g.default),o=this.dragonPath[0];t.setPosition(o),this.lastNode=t,this.dragonBodyArr.push(e),e.initParam(0,this.dragonPath,this,this.dragonCamp,this.distance)},e.prototype.createBodyBlood=function(){this.bloodNode&&this.bloodNode.getComponent(y.default).doCanbeHitDown(),this.bloodNode=p.PoolMgr.getInstance().getNode(d.poolName.body_blood),this.pro_bloodLayer.addChild(this.bloodNode),this.bloodNode.active=!1},e.prototype.setBodyBloodTagetNode=function(t){this.bloodNode.active=!0;var e=this.bloodNode.getComponent(y.default),o=this.nowLevelCfg.dragonHp;t.height,e.initParam(o,t,this,this.nowLevelCfg,this.dragonCamp),this.dragonBloodArr.push(e)},e.prototype.getInfactPre=function(){for(var t=null,e=0;e<this.dragonBodyArr.length;e++)this.dragonBodyArr[e].getIsDestroy()||(t=this.dragonBodyArr[e].node);return t},e.prototype.onLoad=function(){this.initPorperty()},e.prototype.start=function(){this.createPath(),this.createBodyHead()},e.prototype.onUpdate=function(t){if(!this.isDie){if(this.skillPause&&(this.skillPauseTime-=t,this.skillPauseTime<=0&&(this.skillPause=!1)),!this.skillPause&&!this.iceState){this.createGapNum-=this.dragonSpeed,this.createGapNum<=0&&this.createBody();for(var e=0;e<this.dragonBodyArr.length;e++)this.dragonBodyArr[e].onUpdate(t,this.dragonSpeed)}for(e=0;e<this.dragonBloodArr.length;e++)this.dragonBloodArr[e].onUpdate(t)}},c([_],e)}(l.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],FLY_ExtraBuffCtrl:[function(t,e){"use strict";cc._RF.push(e,"617e1d4cPBLaqmVHwSbFzA0","FLY_ExtraBuffCtrl");var o=e;cc._RF.push(o,"617e1d4cPBLaqmVHwSbFzA0","FLY_ExtraBuffCtrl"),cc._RF.pop(),cc._RF.pop()},{}],FLY_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f98ee5BiPdFbI0ZANfn0RLq","FLY_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f98ee5BiPdFbI0ZANfn0RLq","FLY_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NodeLib"),u=i("FLY_Configs"),d=i("fly_GameEnumData"),h=i("FLY_DataMgr"),f=i("fly_gameCtrl"),m=i("FLY_HeroItem"),g=i("FLY_SkillCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_heroLayer=null,e.pro_skillCtrl=null,e.pro_Item=null,e.heroList=[],e.AIMotionCfg=null,e.tempTime=0,e.haveTempHero=!1,e.heroCtrlCamp=null,e.isDie=!1,e.boundaryLeft=0,e.boundaryRight=0,e.skillPause=!1,e.skillPauseTime=0,e.aiTarmSkillState=!1,e.aiTarmSkillTime=0,e.aiTarmSkillMaxTime=0,e.aiTarmSkillID=0,e.AIHeroState=u.AIState.None,e.AIStaticTime=0,e.AIMoveSpeed=10,e.AIMoveDistance=10,e.boundrayWidth=60,e.AIMoveDir=1,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_heroLayer=this.node.getChildByName("pro_heroLayer"),this.pro_Item=this.node.getChildByName("pro_Item"),this.pro_skillCtrl=p.default.findChildByName(this.node,"pro_skillCtrl").getComponent(g.default)},e.prototype.testAddHero=function(){},e.prototype.initCamp=function(t){this.heroCtrlCamp=t,t==u.belongCamp.enemy&&(this.AIMotionCfg=h.default.getInstance().getAIMotionCfg())},e.prototype.addFirstHero=function(){for(var t=h.default.getInstance().getCharacter(),e=[],o=0;o<t.length;o++)14!=t[o].characterID&&e.push(t[o].characterID);var i=Math.floor(Math.random()*e.length);this.addHero(e[i])},e.prototype.moveHero=function(t){if(0!=t){for(var e=0;e<this.heroList.length;e++){var o=t>0?1:-1;this.heroList[e].changeScaleX(o)}this.pro_heroLayer.x+=t}},e.prototype.addHero=function(t){if(this.getHeroList().length>=3)console.error("\u82f1\u96c4\u6570\u91cf\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650");else{this.heroCtrlCamp==u.belongCamp.hero?f.default.instance.getPro_buttomCtrl().getTarmCtrl().pushCard(t):this.heroCtrlCamp==u.belongCamp.enemy&&0!=this.heroList.length&&this.heroList[0].showBuffImage(u.emFLYBuffType.skillInterval);var e=cc.instantiate(this.pro_Item);e.active=!0;var o=e.getComponent(m.default);e.parent=this.pro_heroLayer,this.heroList.push(o);var i=0;1==this.heroList.length?i=h.default.getInstance().getParam(d.enumBasicParaCfg.basicATK):2==this.heroList.length?i=h.default.getInstance().getParam(d.enumBasicParaCfg.secondCharATK):3==this.heroList.length&&(i=h.default.getInstance().getParam(d.enumBasicParaCfg.thirdCharATK)),o.initParam(t,i,this.pro_skillCtrl,this.heroCtrlCamp),this.heroCtrlCamp==u.belongCamp.enemy&&this.AIddTarmSkill()}},e.prototype.removeHero=function(t){f.default.instance.getBullletLayerByHeroIndex(t).removeAllChildren();for(var e=0;e<this.heroList.length;e++)if(this.heroList[e].getIndex()==t){this.heroList[e].node.removeFromParent(),this.heroList.splice(e,1);break}},e.prototype.getHeroWorldPos=function(){var t=this.pro_heroLayer.x+this.pro_heroLayer.width/2,e=this.pro_heroLayer.y;return this.pro_heroLayer.parent.convertToWorldSpaceAR(cc.v2(t,e))},e.prototype.addTempHero=function(t,e,o,i,n){var a=cc.instantiate(this.pro_Item);this.haveTempHero=!0,a.active=!0;var r=a.getComponent(m.default);a.parent=this.pro_heroLayer,this.heroList.push(r),r.initTempHero(t,e,o,n,this.heroCtrlCamp),this.tempTime=i},e.prototype.getHeroItemCtrlByIndex=function(t){for(var e=0;e<this.heroList.length;e++)if(this.heroList[e].getIndex()==t)return this.heroList[e]},e.prototype.getHeroList=function(){var t=[];for(var e in this.heroList)14!=this.heroList[e].getIndex()&&t.push(this.heroList[e]);return t},e.prototype.checkHeroPosX=function(){return this.pro_heroLayer.x<=0},e.prototype.getHeroLayer=function(){return this.pro_heroLayer.getComponent(cc.Widget).updateAlignment(),this.pro_heroLayer},e.prototype.doSkillPause=function(t){this.skillPause=!0,this.skillPauseTime=t},e.prototype.setBodyDie=function(){this.isDie=!0;for(var t=0;t<this.heroList.length;t++)this.heroList[t].removeAllBullet()},e.prototype.refreshBoundary=function(){var t=cc.winSize.width>750?750:cc.winSize.width;this.boundaryLeft=-t/2+this.boundrayWidth*this.heroList.length,this.boundaryRight=t/2-this.boundrayWidth*this.heroList.length},e.prototype.moveAIHero=function(t){if(0!=t)for(var e=0;e<this.heroList.length;e++)this.heroList[e].node.scaleX=t>0?1:-1},e.prototype.getAIMotionCfg=function(){var t=Math.floor(Math.random()*this.AIMotionCfg.length);return this.AIMotionCfg[t]},e.prototype.AIMoveHero=function(){if(this.AIMoveDistance<=0)this.AIHeroState=u.AIState.None;else if(this.pro_heroLayer.x<=this.boundaryLeft&&-1==this.AIMoveDir)this.AIHeroState=u.AIState.None;else if(this.pro_heroLayer.x>=this.boundaryRight&&1==this.AIMoveDir)this.AIHeroState=u.AIState.None;else{var t=this.AIMoveSpeed/100*this.AIMoveDir;this.AIMoveDistance-=Math.abs(t),this.moveHero(t)}},e.prototype.AIStaticUpdate=function(t){this.AIStaticTime-=t,this.AIStaticTime<=0&&(this.AIHeroState=u.AIState.None)},e.prototype.AIddTarmSkill=function(){var t=h.default.getInstance().getMateCfg();for(var e in t){for(var o=0,i=t[e].mateRole.split(","),n=0;n<i.length;n++)for(var a=0;a<this.heroList.length;a++)if(this.heroList[a].getIndex()==Number(i[n])){o++;break}2==o&&(this.aiTarmSkillState=!0,this.aiTarmSkillMaxTime=t[e].mateCDtime,this.aiTarmSkillTime=this.aiTarmSkillMaxTime,this.aiTarmSkillID=t[e].mateID,this.doAITarmSkillDown())}},e.prototype.AITarmSkillUpdate=function(t){this.aiTarmSkillState&&(this.aiTarmSkillTime-=t,this.aiTarmSkillTime<=0&&this.doAITarmSkillDown())},e.prototype.doAITarmSkillDown=function(){f.default.instance.getPro_buttomCtrl().getMateSkillCtrl().useSkill(this.aiTarmSkillID,u.belongCamp.enemy),this.aiTarmSkillTime=this.aiTarmSkillMaxTime},e.prototype.getAIheroDir=function(){this.refreshBoundary();var t=this.pro_heroLayer.x,e=Math.abs(t-this.boundaryLeft),o=Math.abs(t-this.boundaryRight);this.AIMoveDir=e>o?-1:1},e.prototype.selectAIBehavior=function(t){if(this.AIHeroState==u.AIState.None){var e=this.getAIMotionCfg();this.AIHeroState=e.motionType,this.AIHeroState==u.AIState.Move?(this.AIMoveSpeed=e.moveSpeed,this.AIMoveDistance=e.moveDistance,this.getAIheroDir()):this.AIHeroState==u.AIState.static&&(this.AIStaticTime=e.staticTime)}else this.AIHeroState==u.AIState.Move?this.AIMoveHero():this.AIHeroState==u.AIState.static&&this.AIStaticUpdate(t)},e.prototype.onLoad=function(){this.initPorperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){if(!this.isDie){if(this.haveTempHero&&(this.tempTime-=t,this.tempTime<=0&&(this.haveTempHero=!1,this.removeHero(14))),this.skillPause)return this.skillPauseTime-=t,void(this.skillPauseTime<=0&&(this.skillPause=!1));this.heroCtrlCamp==u.belongCamp.enemy&&(this.selectAIBehavior(t),this.AITarmSkillUpdate(t));for(var e=0;e<this.heroList.length;e++)this.heroList[e].onUpdate(t);this.pro_skillCtrl.onUpdate(t)}},c([v],e)}(l.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],FLY_HeroItem:[function(t,e,o){"use strict";cc._RF.push(e,"fd874iPZkVNfITjCUibgtAA","FLY_HeroItem");var i=t,n=e,a=o;cc._RF.push(n,"fd874iPZkVNfITjCUibgtAA","FLY_HeroItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("NodeLib"),h=i("FLY_Configs"),f=i("fly_GameEnumData"),m=i("FLY_DataMgr"),g=i("fly_gameCtrl"),y=i("FLY_BulletBaseItem"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroAniArr=[],e.pro_heroBgIcon=null,e.pro_icon=null,e.pro_itemName=null,e.pro_percentIcon=null,e.pro_skillIcon=null,e.pro_bulletPos=null,e.pro_skillAni=null,e.pro_buffAni=null,e.pro_heroAni=null,e.pro_addBuffImage=null,e.pro_floorAni=null,e.bulletArr=[],e.flyingBullet=[],e.bulletRange=1500,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.maxAttackSpeed=12,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.skillTimer=0,e.skillMultiplier=0,e.speedInfactTimer=1,e.maxBulletNum=1e4,e.bulletTime=0,e.skillCtrl=null,e.isTemp=!1,e.windState=!1,e.windChangeSpeed=0,e.reduceCdState=!1,e.reduceCdSkillChange=0,e.lightState=!1,e.heroCamp=null,e.maxBulletLenth=20,e.bullteAudioID=0,e.maxBulletAudioID=3,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_heroBgIcon=this.node.getComponent(cc.Sprite),this.pro_icon=d.default.findChildByName(this.node,"pro_icon").getComponent(cc.Sprite),this.pro_itemName=d.default.findChildByName(this.node,"pro_itemName").getComponent(cc.Label),this.pro_percentIcon=d.default.findChildByName(this.node,"pro_percentIcon").getComponent(cc.Sprite),this.pro_skillIcon=d.default.findChildByName(this.node,"pro_skillIcon").getComponent(cc.Sprite),this.pro_bulletPos=d.default.findChildByName(this.node,"pro_bulletPos"),this.pro_skillAni=d.default.findChildByName(this.node,"pro_skillAni").getComponent(sp.Skeleton),this.pro_buffAni=d.default.findChildByName(this.node,"pro_buffAni").getComponent(sp.Skeleton),this.pro_heroAni=d.default.findChildByName(this.node,"pro_heroAni").getComponent(sp.Skeleton),this.pro_addBuffImage=d.default.findChildByName(this.node,"pro_addBuffImage").getComponent(cc.Sprite),this.pro_floorAni=d.default.findChildByName(this.node,"pro_floorAni").getComponent(sp.Skeleton)},e.prototype.enemyShowBuffImage=function(t,e,o,i,n){this.modifyAttribute(t,e,o,i,n),this.showBuffImage(t)},e.prototype.showBuffImage=function(t){var e=m.default.getInstance().getBuffImageByString(t),o=cc.instantiate(this.pro_addBuffImage.node);o.parent=this.node;var i="buffLabel/"+e;this.loadSpriteFrame(h.emFLYBundles.imgs,i,function(t){null!=t&&(o.active=!0,null!=o.getComponent(cc.Sprite)&&(o.getComponent(cc.Sprite).spriteFrame=t,cc.tween(o).by(1,{y:100}).call(function(){o.destroy()}).start()))})},e.prototype.changeScaleX=function(t){this.pro_floorAni.node.scaleX=t*Math.abs(this.pro_floorAni.node.scaleX)},e.prototype.modifyAttribute=function(t,e,o,i,n){switch(this.doAddBuffTween(),t){case h.emFLYBuffType.ATKmul:case h.emFLYBuffType.ATKplus:this.modifyAttackPower(e,o);break;case h.emFLYBuffType.speedPlus:this.modifyAttackSpeed(e,o);break;case h.emFLYBuffType.penetratePlus:this.modifyPenetrate(e,o,i,n);break;case h.emFLYBuffType.critPlus:this.modifyCritChance(e,o);break;case h.emFLYBuffType.bulletPlus:this.modifyBulletCount(e,o);break;case h.emFLYBuffType.skillInterval:this.modifySkillInterval(o,.5);break;case h.emFLYBuffType.skillMul:this.modifySkillMultiplier(o);break;default:console.warn("Unknown attribute: "+t)}},e.prototype.initParam=function(t,e,o,i){this.attackPower=e,this.heroIndex=t,this.skillCtrl=o,this.bulletCount=m.default.getInstance().getParam(f.enumBasicParaCfg.basicBullet),this.heroCamp=i,this.initHeroData()},e.prototype.initTempHero=function(t,e,o,i,n){this.attackPower=e,this.heroIndex=t,this.attackSpeedMultiplier=o,this.bulletCount=i,this.heroCamp=n,this.initHeroData(),this.isTemp=!0},e.prototype.recycleBullet=function(t){for(var e=0;e<this.flyingBullet.length;e++)if(this.flyingBullet[e].uuid==t.uuid){this.flyingBullet.splice(e,1),this.bulletArr.length<this.maxBulletLenth?this.bulletArr.push(t):u.PoolMgr.getInstance().freeNode(this.bulletPoolName,t.node);break}},e.prototype.removeAllBullet=function(){for(var t=0;t<this.flyingBullet.length;t++)this.flyingBullet[t].doResycleNoBounceBulletDown()},e.prototype.getIndex=function(){return this.heroIndex},e.prototype.setWindState=function(t,e){void 0===e&&(e=0),this.windState=t,this.windChangeSpeed=e},e.prototype.setReduceCdState=function(t,e){void 0===e&&(e=0),this.reduceCdState=t,this.reduceCdSkillChange=e},e.prototype.setLightState=function(t){this.lightState=t},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.getPenetrate=function(){return this.penetrate},e.prototype.getAttackSpeed=function(){return this.attackSpeedMultiplier},e.prototype.isMaxAttackSpeed=function(){return this.attackSpeedMultiplier>=this.maxAttackSpeed},e.prototype.getBulletCount=function(){return this.bulletCount},e.prototype.getIsCirt=function(){return Math.random()<this.critChance},e.prototype.getCirtDamage=function(t){return t?this.critMultiplier*this.attackPower:this.attackPower},e.prototype.initHeroData=function(){this.attackSpeed=m.default.getInstance().getParam(f.enumBasicParaCfg.basicASPD),this.penetrate=m.default.getInstance().getParam(f.enumBasicParaCfg.basicPenetrate),this.flySpeed=m.default.getInstance().getParam(f.enumBasicParaCfg.bulletFlySpeed),this.critChance=m.default.getInstance().getParam(f.enumBasicParaCfg.basicCrit),this.critMultiplier=m.default.getInstance().getParam(f.enumBasicParaCfg.critDamage),this.maxBulletNum=1e4;var t=m.default.getInstance().getCharacterByID(this.heroIndex);this.skillInterval=t.skillCDtime,this.skillMultiplier=t.skillATK,this.skillAudioName=t.skillSound,this.bulletArr=[],this.speedInfactTimer=t.characterASPD,t.disappearTime?this.bulletTime=t.disappearTime:this.bulletTime=999999,this.bulletPoolName=h.poolName.bulletName+this.heroIndex,this.lastAttackTime=0,this.initView()},e.prototype.initView=function(){var t=this.heroIndex;11==t&&(this.pro_heroAni.node.scale=.85);var e="djdh_"+t;this.pro_heroAni.skeletonData=this.getHeroSkeletonByName(e),this.pro_heroAni.setAnimation(0,e,!0),this.pro_floorAni.setAnimation(0,"animation",!0)},e.prototype.getHeroSkeletonByName=function(t){for(var e=0;e<this.heroAniArr.length;e++)if(this.heroAniArr[e].name==t)return this.heroAniArr[e];return null},e.prototype.doAddBuffTween=function(){var t=this;this.pro_buffAni.node.active=!0,this.pro_buffAni.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.pro_buffAni.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.pro_buffAni.node.active=!1},.1)})},e.prototype.modifyAttackPower=function(t,e){1==t?this.attackPower+=e:this.attackPower*=e,this.attackPower=Math.floor(this.attackPower)},e.prototype.modifyAttackSpeed=function(t,e){this.attackSpeedMultiplier+=e/m.default.getInstance().getParam(f.enumBasicParaCfg.speedPlusTimes)},e.prototype.modifyPenetrate=function(t,e,o,i){1==t?this.penetrate+=e:2==t?this.penetrate*=e:3==t&&(this.penetrate+e>o?this.modifyAttackSpeed(1,i):this.penetrate+=e)},e.prototype.modifyCritChance=function(t,e){1==t?this.critChance+=e:2==t?this.critChance*=e:3==t&&(this.critChance>=1?this.modifyBulletCount(1,1):this.critChance+=e)},e.prototype.modifyBulletCount=function(t,e){1==t?this.bulletCount+=e:this.bulletCount*=e},e.prototype.modifySkillInterval=function(t,e){var o=this.skillInterval*(1-t);(o=Number(o.toFixed(2)))<e&&(o=e),this.skillInterval=o},e.prototype.modifySkillMultiplier=function(t){this.skillMultiplier*=t},e.prototype.updateFire=function(t){this.nowAttackTime+=t,this.nowAttackTime-this.lastAttackTime>this._AttackSpeed&&(this.lightState?this.fireLightBullets():this.fireBullets(),this.lastAttackTime=this.nowAttackTime)},e.prototype.fireBullets=function(){this.bullteAudioID++,this.bullteAudioID%=this.maxBulletAudioID,p.AudioMgr.getInstance().playEffect(h.FLY_AudioId.bullet,this.bulletPoolName+this.bullteAudioID);for(var t=this.getColliderDisY(),e=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,o=0;o<this.bulletCount;o++){var i=this.getBullet(),n=cc.v2(e+30*o,this.pro_bulletPos.y),a=this.pro_bulletPos.convertToWorldSpaceAR(n);n=i.node.parent.convertToNodeSpaceAR(a),i.node.setPosition(n),i.initParam(this.bulletRange,this.penetrate,this.flySpeed,this,this.bulletTime,this.heroCamp,t),this.flyingBullet.push(i)}},e.prototype.fireLightBullets=function(){p.AudioMgr.getInstance().playEffect(h.FLY_AudioId.lightningBullet,this.bulletPoolName+this.bullteAudioID);var t=u.PoolMgr.getInstance().getNode(h.poolName.Bullet_skill);t.parent=g.default.instance.getBullletLayerByHeroIndex("Skill");var e=cc.v2(0,this.pro_bulletPos.y),o=this.pro_bulletPos.convertToWorldSpaceAR(e);e=t.parent.convertToNodeSpaceAR(o),t.setPosition(e),t.getComponentInChildren(cc.Animation).play(),this.lightDamage(t,Math.floor(this.attackPower*this.bulletCount*1.5)),this.scheduleOnce(function(){u.PoolMgr.getInstance().freeNode(h.poolName.Bullet_skill,t)},.1)},e.prototype.lightDamage=function(t,e){g.default.instance.getPro_topCtrl().getDragonCtrlByCamp(this.heroCamp).checkRangeSkill(this.getWorldColldierRect(t),e)},e.prototype.getWorldColldierRect=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var i=t.getAnchorPoint(),n=t.convertToWorldSpaceAR(cc.Vec2.ZERO),a=(t.width+e)*t.scaleX,r=(t.height+o)*t.scaleY;return cc.rect(n.x-i.x*a,n.y-i.y*r,a,r)},e.prototype.getBullet=function(){if(this.flyingBullet.length>=this.maxBulletNum)for(var t in this.flyingBullet)if(this.flyingBullet[t]){this.flyingBullet[t].doResycleNoBounceBulletDown();break}var e=this.bulletArr.pop();if(!e){var o=u.PoolMgr.getInstance().getNode(this.bulletPoolName);o.parent=g.default.instance.getBullletLayerByHeroIndex(this.heroIndex),e=o.getComponent(y.default)}return e},e.prototype.getColliderDisY=function(){var t=g.default.instance.getPro_topCtrl().getDragonCtrlByCamp(this.heroCamp).getHeadY(),e=this.pro_bulletPos.y;return(this.heroCamp==h.belongCamp.hero?t-e:e-t)-100},e.prototype.contrlBullet=function(t){for(var e=0;e<this.flyingBullet.length;e++){var o=this.flyingBullet[e];o&&o.onUpdate(t)}},Object.defineProperty(e.prototype,"_AttackSpeed",{get:function(){var t=this.speedInfactTimer*this.attackSpeedMultiplier;return this.windChangeSpeed&&(t+=this.windChangeSpeed),t<this.speedInfactTimer&&(t=this.speedInfactTimer),this.attackSpeed/t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_skillInterval",{get:function(){var t=this.skillInterval;return this.reduceCdState&&(t=this.reduceCdSkillChange),t},enumerable:!1,configurable:!0}),e.prototype.contrlSkill=function(t){this.isTemp||(this.skillTimer+=t,this.updateSkillBar(),this.skillTimer>=this._skillInterval&&this.useSkill())},e.prototype.updateSkillBar=function(){var t=this.skillTimer/this._skillInterval;this.pro_percentIcon.fillRange=t},e.prototype.useSkill=function(){var t=this,e=this.attackPower*this.skillMultiplier,o=this.node.convertToWorldSpaceAR(this.pro_bulletPos.getPosition());this.pro_skillAni.setCompleteListener(function(){t.pro_skillAni.node.active=!1}),this.skillCtrl.useSkill(this.heroIndex,e,o,this.heroCamp)&&(this.skillTimer=0)},e.prototype.onLoad=function(){this.initPorperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.updateFire(t),this.contrlBullet(t),this.contrlSkill(t)},c([b(sp.SkeletonData)],e.prototype,"heroAniArr",void 0),c([_],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],FLY_MateIconItem:[function(t,e,o){"use strict";cc._RF.push(e,"e73e0mNcKdIlIS3rUpaOrUA","FLY_MateIconItem");var i=t,n=e,a=o;cc._RF.push(n,"e73e0mNcKdIlIS3rUpaOrUA","FLY_MateIconItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FLY_Configs"),u=i("FLY_DataMgr"),d=i("fly_gameCtrl"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_cdLabel=null,e.pro_skillLabel=null,e.pro_cdPercent=null,e.pro_skillIcon=null,e.pro_spNode=null,e.maxCDTime=0,e.cdTime=0,e.mateID=1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_cdLabel=this.node.getChildByName("pro_cdLabel").getComponent(cc.Label),this.pro_skillLabel=this.node.getChildByName("pro_skillLabel").getComponent(cc.Label),this.pro_cdPercent=this.node.getChildByName("pro_cdPercent").getComponent(cc.Sprite),this.pro_skillIcon=this.node.getComponent(cc.Sprite),this.pro_spNode=this.node.getChildByName("pro_spNode").getComponent(sp.Skeleton)},e.prototype.initNode=function(t,e){this.pro_skillIcon.spriteFrame=e,this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=t.mateCDtime},e.prototype.initView=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID);this.pro_skillLabel.string=t.mateName,this.pro_cdPercent.fillRange=0,this.pro_cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){var t=this;this.cdTime<=0&&(d.default.instance.getPro_buttomCtrl().getMateSkillCtrl().useSkill(this.mateID,p.belongCamp.hero),this.scheduleOnce(function(){t.initStartUseSkill()},.1))},e.prototype.initStartUseSkill=function(){this.pro_cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.pro_cdLabel.string=this.cdTime+"",this.pro_cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.pro_cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.pro_cdLabel.node.active=!1,this.pro_spNode.node.active=!0,this.pro_spNode.setAnimation(0,"animation",!1),this.pro_spNode.setCompleteListener(function(){e.pro_spNode.node.active=!1})):this.pro_cdLabel.string=this.cdTime.toFixed(0)},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],FLY_MateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"9ef8a9CD4dDm7KRNkxHhJSE","FLY_MateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"9ef8a9CD4dDm7KRNkxHhJSE","FLY_MateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("FLY_Configs"),h=i("FLY_DataMgr"),f=i("fly_gameCtrl"),m=i("FLY_MateSkillItem"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.useSkill=function(t,e){var o=u.PoolMgr.getInstance().getNode(d.poolName.MateSkill+t);this.node.addChild(o),o.setPosition(0,0),this.doUseSkillDown(o,t,e)},e.prototype.doUseSkillDown=function(t,e,o){var i=t.getComponent(m.default),n=h.default.getInstance().getMateCfgByID(e);p.AudioMgr.getInstance().playEffect(n.mateSound,"mateSkill");var a,r=n.mateRole.split(","),s=parseInt(r[0]),c=parseInt(r[1]),l=[];a=o==d.belongCamp.hero?f.default.instance.getPro_buttomCtrl().getHeroCtrl():f.default.instance.getPro_buttomCtrl().getEnemyCtrl(),l.push(a.getHeroItemCtrlByIndex(s)),l.push(a.getHeroItemCtrlByIndex(c));var u=Math.max(l[0].getAttackPower(),l[1].getAttackPower()),g=n.mateSkillATK*u;i.useSkill(g,e,l,o)},e.prototype.start=function(){},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],FLY_MateSkillItem:[function(t,e,o){"use strict";cc._RF.push(e,"6932ebwZtpO477O7iOqbxLg","FLY_MateSkillItem");var i=t,n=e,a=o;cc._RF.push(n,"6932ebwZtpO477O7iOqbxLg","FLY_MateSkillItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("NodeLib"),u=i("FLY_Configs"),d=i("FLY_DataMgr"),h=i("fly_gameCtrl"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_spAni=null,e.index=0,e.damage=0,e.skillCamp=null,e.heroItemArr=[],e}return s(e,t),e.prototype.initProperty=function(){this.pro_spAni=p.default.findChildByName(this.node,"spAni").getComponent(sp.Skeleton)},e.prototype.useSkill=function(t,e,o,i){if(this.heroItemArr=l(o),d.default.getInstance().getMateCfgByID(e),this.skillCamp=i,this.index=e,this.pro_spAni.setAnimation(0,"animation",!1),7!=e){var n=h.default.instance.getPro_topCtrl().getDragonCtrlByCamp(i);this.node.setPosition(0,n.getHeadY())}else{var a=h.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroWorldPos(),r=this.node.parent.convertToNodeSpaceAR(a);this.node.setPosition(r)}this.damage=t},e.prototype.doMateSkillCtrl=function(t,e){1==t?this.doMateSkill1(e):2==t?this.doMateSkill2(e):3==t?this.doMateSkill3(e):4==t?this.doMateSkill4(e):5==t?this.doMateSkill5(e):6==t?this.doMateSkill6(e):7==t&&this.doMateSkill7(e)},e.prototype.doMateSkill1=function(t){for(var e in this.heroItemArr)this.heroItemArr[e].modifyAttribute(u.emFLYBuffType.speedPlus,1,Number(t.matePara))},e.prototype.doMateSkill2=function(t){var e=Math.max(this.heroItemArr[0].getAttackPower(),this.heroItemArr[1].getAttackPower()),o=Math.floor(e*Number(t.matePara));for(var i in this.heroItemArr)this.heroItemArr[i].modifyAttribute(u.emFLYBuffType.ATKplus,1,o)},e.prototype.doMateSkill3=function(t){var e=Number(t.matePara);h.default.instance.getPro_topCtrl().getDragonCtrlByCamp(this.skillCamp).doSkillPause(e),(this.skillCamp==u.belongCamp.hero?h.default.instance.getPro_buttomCtrl().getEnemyCtrl():h.default.instance.getPro_buttomCtrl().getHeroCtrl()).doSkillPause(e)},e.prototype.doMateSkill4=function(t){for(var e in this.heroItemArr){var o=Math.floor(2*Math.random()),i=Number(t.matePara.split(",")[o]),n=this.heroItemArr[e];i<1?n.modifyAttribute(u.emFLYBuffType.critPlus,3,i):n.modifyAttribute(u.emFLYBuffType.bulletPlus,1,i)}},e.prototype.doMateSkill5=function(t){var e=Number(t.matePara.split(",")[0]),o=Number(t.matePara.split(",")[1]);for(var i in this.heroItemArr)this.heroItemArr[i].modifyAttribute(u.emFLYBuffType.skillInterval,1,e,o)},e.prototype.doMateSkill6=function(t){var e=Number(t.matePara.split(",")[0]),o=Number(t.matePara.split(",")[1]);for(var i in this.heroItemArr)this.heroItemArr[i].modifyAttribute(u.emFLYBuffType.penetratePlus,3,e,5,o)},e.prototype.doMateSkill7=function(t){var e=Math.max(this.heroItemArr[0].getAttackPower(),this.heroItemArr[1].getAttackPower()),o=Math.max(this.heroItemArr[0].getAttackSpeed(),this.heroItemArr[1].getAttackSpeed()),i=t.matePara.split(","),n=Math.floor(e*Number(i[0])),a=Math.floor(o*Number(i[1])),r=Number(i[2]),s=Math.min(this.heroItemArr[0].getBulletCount(),this.heroItemArr[1].getBulletCount());(this.skillCamp==u.belongCamp.hero?h.default.instance.getPro_buttomCtrl().getHeroCtrl():h.default.instance.getPro_buttomCtrl().getEnemyCtrl()).addTempHero(14,n,a,r,s)},e.prototype.doAttack=function(){h.default.instance.getPro_topCtrl().getDragonCtrlByCamp(this.skillCamp).checkRangeSkill(this.getWorldColldierRect(0,0),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onLoad=function(){var t=this;this.initProperty(),this.pro_spAni.setEventListener(function(e,o){var i=d.default.getInstance().getMateCfgByID(t.index);"attack"==o.data.name&&(t.doMateSkillCtrl(t.index,i),t.doAttack())}),this.pro_spAni.setCompleteListener(function(){t.node.removeFromParent()})},e.prototype.start=function(){},e.prototype.onUpdate=function(){},c([m],e)}(cc.Component));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FLY_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"6c0c2jDKghOlYX8islyH5fa","FLY_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"6c0c2jDKghOlYX8islyH5fa","FLY_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("FLY_Configs"),h=i("FLY_DataMgr"),f=i("FLY_SkillItem"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_banner=null,e.isSkill=!1,e.rawDelayTime=1.5,e.delayTime=1.5,e.nowSkillCtrlArr=[],e.skillNodeMap=new Map,e}return s(e,t),e.prototype.initProperty=function(){this.pro_banner=this.node.getChildByName("pro_banner")},e.prototype.useSkill=function(t,e,o,i){return i==d.belongCamp.hero&&this.showBanner(t),this.doUseSkillDown(t,e,o,i),!0},e.prototype.doUseSkillDown=function(t,e,o,i){var n,a=h.default.getInstance().getCharacterByID(t);p.AudioMgr.getInstance().playEffect(a.skillSound,"skill"),(n=u.PoolMgr.getInstance().getNode(d.poolName.CardSkill+t)).parent=this.node;var r=this.node.convertToNodeSpaceAR(o);n.setPosition(r);var s=n.getComponent(f.default);this.nowSkillCtrlArr.push(s),s.useSkill(r,e,t,this,i)},e.prototype.removeSkillCtrl=function(t){for(var e in this.nowSkillCtrlArr)if(this.nowSkillCtrlArr[e].uuid==t.uuid){var o=parseInt(e);this.nowSkillCtrlArr[e].node.removeFromParent(),this.nowSkillCtrlArr.splice(o,1);break}},e.prototype.changeDelayTime=function(t){t/2<this.delayTime&&(this.delayTime=t/2-.15)},e.prototype.resumeDelayTime=function(){this.delayTime=this.rawDelayTime},e.prototype.showBanner=function(t){var e=cc.instantiate(this.pro_banner);e.parent=this.pro_banner.parent,this.loadSpriteFrame(d.emFLYBundles.imgs,"banner/banner"+t,function(t){e.getComponent(cc.Sprite).spriteFrame=t,e.active=!0});var o=Number((this.delayTime/3).toFixed(1));cc.tween(e).by(o,{x:e.width}).delay(o).by(o,{x:-e.width}).call(function(){e.removeFromParent()}).start()},e.prototype.onLoad=function(){this.initProperty()},e.prototype.onUpdate=function(t){for(var e=0;e<this.nowSkillCtrlArr.length;e++)this.nowSkillCtrlArr[e].onUpdate(t)},c([g],e)}(l.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],FLY_SkillItem:[function(t,e,o){"use strict";cc._RF.push(e,"48d0fLsgvZOk5MUW8EnjTw7","FLY_SkillItem");var i=t,n=e,a=o;cc._RF.push(n,"48d0fLsgvZOk5MUW8EnjTw7","FLY_SkillItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FLY_Configs"),u=i("fly_gameCtrl"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canMove=!1,e.offWidth=0,e.offHeight=0,e.aimNode=null,e.pro_RangeNode=null,e.pro_spAni=null,e.pro_sub1=null,e.pro_sub2=null,e.parent_Ctrl=null,e.skillDir=1,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_spAni=this.node.getChildByName("spAni").getComponent(sp.Skeleton),this.pro_RangeNode=this.node.getChildByName("pro_RangeNode"),this.pro_sub1=this.node.getChildByName("pro_sub1"),this.pro_sub2=this.node.getChildByName("pro_sub2")},e.prototype.useSkill=function(t,e,o,i,n){this.parent_Ctrl=i,this.index=o,this.skillSpeed=this.speed,n==p.belongCamp.hero?(this.skillDir=1,this.node.scale=1):n==p.belongCamp.enemy&&(this.skillDir=-1,this.node.scale=-1),this.damage=e;var a=this.node.parent.convertToWorldSpaceAR(t);this.skillCamp=n;var r=u.default.instance.getPro_topCtrl().getDragonCtrlByCamp(n);this.aimNode=r.getCloserChildNode(a),this.flyDis=Math.abs(this.aimNode.y-this.node.y),this["useSkill"+o](t)},e.prototype.getDragonCtrl=function(){return u.default.instance.getPro_topCtrl().getDragonCtrlByCamp(this.skillCamp)},e.prototype.useSkill1=function(){var t=this;this.node.scale=1,this.canMove=!1,this.node.setPosition(0,this.aimNode.y-300),this.pro_spAni.setAnimation(0,"hit",!1);var e=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65),this.offHeight=300},e.prototype.useSkill3=function(){var t=this;this.canMove=!1,this.node.setPosition(0,this.aimNode.y-100),this.pro_spAni.setAnimation(0,"cedz",!1);var e=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65)},e.prototype.useSkill4=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill6=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,this.aimNode.y),this.pro_spAni.setAnimation(0,"hit",!1);var o=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill7=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill8=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill10=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,this.aimNode.y),this.pro_spAni.setAnimation(0,"animation",!1);var o=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill11=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!1),this.pro_sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.pro_sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)},e.prototype.useSkill17=function(){var t=this;this.canMove=!1,this.node.setPosition(0,this.aimNode.y-100),this.pro_spAni.setAnimation(0,"ssxdz",!1);var e=this.pro_spAni.getCurrent(0).animation.duration;this.offHeight=100,this.scheduleOnce(function(){t.doAttack()},e-2)},e.prototype.doAttack=function(){this.getDragonCtrl().checkRangeSkill(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),n=this.node.width+t,a=this.node.height+e;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onLoad=function(){var t=this;this.initProperty(),this.pro_spAni.setCompleteListener(function(e){"bullet"!=(e.animation?e.animation.name:"unknown")&&t.parent_Ctrl.removeSkillCtrl(t)}),this.pro_spAni.setEventListener(function(t,e){e.data.name})},e.prototype.start=function(){this.pro_RangeNode.active=!1},e.prototype.onUpdate=function(){var t=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed*this.skillDir,this.flyDis-=this.skillSpeed,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){t.pro_sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),t.pro_sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.pro_spAni.setAnimation(0,"hit",!1),this.doAttack()))},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FLY_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"9f252/XsAxLcq0I1FQ1fXyQ","FLY_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"9f252/XsAxLcq0I1FQ1fXyQ","FLY_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FLY_Configs"),u=i("FLY_DataMgr"),d=i("FLY_MateIconItem"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_mateBanner=null,e.pro_mateIconLayer=null,e.tarmMap=new Map,e.isTureTarmMap=new Map,e.pro_mateItemArr=[],e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_mateBanner=this.node.getChildByName("pro_mateBanner"),this.pro_mateIconLayer=this.node.getChildByName("pro_mateIconLayer")},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.doTarmDown(e[0]),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},e.prototype.doTarmDown=function(t){var e=this;this.loadSpriteFrame(p.emFLYBundles.imgs,"mateIcon/mateIcon_"+t,function(o){e.loadPrefab(p.emFLYBundles.prefabs,"item/mateIcon",function(i){var n=cc.instantiate(i);e.pro_mateIconLayer.addChild(n),n.getComponent(d.default).initNode(t,o),e.pro_mateItemArr.push(n.getComponent(d.default))})}),this.showBanner(t)},e.prototype.showBanner=function(t){var e=this,o=this.delayTime;this.loadSpriteFrame(p.emFLYBundles.imgs,"mateBanner/mateBanner_"+t,function(t){e.pro_mateBanner.getComponent(cc.Sprite).spriteFrame=t,e.pro_mateBanner.active=!0,cc.tween(e.pro_mateBanner).by(o/2,{x:e.pro_mateBanner.width}).delay(o/2).call(function(){e.pro_mateBanner.x=-cc.winSize.width/2-e.pro_mateBanner.width/2}).start()})},e.prototype.onLoad=function(){this.initProperty(),this.pro_mateBanner.x=-cc.winSize.width/2-this.pro_mateBanner.width/2},e.prototype.start=function(){},e.prototype.onUpdate=function(t){for(var e=0;e<this.pro_mateItemArr.length;e++)this.pro_mateItemArr[e].refreshSkillView(t)},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],FLY_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"ba17bIw7uVJgYeQlRdt5LJJ","FLY_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"ba17bIw7uVJgYeQlRdt5LJJ","FLY_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("PoolMgr"),h=i("NodeLib"),f=i("FLY_Configs"),m=i("fly_gameCtrl"),g=i("FLY_BloodCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgTexture=null,e.pro_bg=null,e.pro_layer=null,e.pro_hitLayer=null,e.pro_bloodLayerCtrl=null,e.pro_destroyLayer=null,e.pro_beginNode=null,e.pro_weblinkLabel=null,e.pro_btn_pause=null,e.pro_pauseLayer=null,e.pro_loseAni=null,e.pro_heroBaneer=null,e.pro_mateBanner=null,e.pro_fence=null,e.pro_hit=null,e.pro_warn=null,e.effectArrMaxNum=20,e.effectArr=[],e.lockSpacePause=!1,e}var o;return s(e,t),o=e,e.prototype.init=function(t){this.bgTexture=t},e.prototype.initListenEvent=function(){this.addEvent(f.emFLYEventName.loseBlood,this.showLoseLabel),this.addEvent(f.emFLYEventName.hitEffect,this.showHitEffect),this.addEvent(f.emFLYEventName.screenShake,this.onScreenShake),this.addEvent(f.emFLYEventName.warn,this.playWarn),this.addEvent(f.emFLYEventName.destroy,this.doBodyDestroy),this.addEvent(f.emFLYEventName.spacePause,this.doSpacePause),this.addEvent(f.emFLYEventName.fail,this.doFailDown)},e.prototype.initBtnListener=function(){var t=this;this.pro_btn_pause.on(cc.Node.EventType.TOUCH_END,function(){t.doPauseDown()}),this.pro_pauseLayer.children[1].on(cc.Node.EventType.TOUCH_END,function(){t.lockSpacePause=!0,t.openUI(f.FLY_UIID.UISetting,function(){t.pro_btn_pause.active=!0,t.pro_pauseLayer.active=!1,t.sendEvent(f.emFLYEventName.resume),t.lockSpacePause=!1})}),this.pro_pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pro_btn_pause.active=!0,t.pro_pauseLayer.active=!1,t.sendEvent(f.emFLYEventName.resume)})},e.prototype.doSpacePause=function(){m.default.instance.getGameState()==f.emFLYGameState.None||this.lockSpacePause||(this.pro_btn_pause.active?(this.doPauseDown(),this.lockSpacePause=!0):(this.pro_btn_pause.active=!0,this.pro_pauseLayer.active=!1,this.sendEvent(f.emFLYEventName.resume)))},e.prototype.doPauseDown=function(){m.default.instance.getGameState()!=f.emFLYGameState.None&&(this.sendEvent(f.emFLYEventName.pause),this.pro_btn_pause.active=!1,this.pro_pauseLayer.active=!0)},e.prototype.doFailDown=function(){var t=this;if(this.pro_loseAni.active=!0,cc.winSize.height>1334){var e=cc.winSize.height/1334;this.pro_loseAni.scale=e+.1}this.pro_loseAni.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.pro_loseAni.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.openUI(f.FLY_UIID.UIResult)},.5)})},e.prototype.initProperty=function(){this.pro_bg=h.default.findChildByName(this.node.parent,"pro_bg"),this.pro_layer=h.default.findChildByName(this.node,"layer"),this.pro_bloodLayerCtrl=h.default.findChildByName(this.pro_layer,"bloodLayer").getComponent(g.default),this.pro_hitLayer=h.default.findChildByName(this.pro_layer,"hitLayer"),this.pro_destroyLayer=h.default.findChildByName(this.pro_layer,"destroyLayer"),this.pro_beginNode=h.default.findChildByName(this.node,"beginNode"),this.pro_weblinkLabel=h.default.findChildByName(this.node,"weblinkLabel"),this.pro_btn_pause=h.default.findChildByName(this.node,"btn_pause"),this.pro_pauseLayer=h.default.findChildByName(this.node,"pauseLayer"),this.pro_heroBaneer=h.default.findChildByName(this.node,"heroBaneer"),this.pro_mateBanner=h.default.findChildByName(this.node,"mateBanner"),this.pro_loseAni=h.default.findChildByName(this.node,"loseAni"),this.pro_fence=h.default.findChildByName(this.node,"fence");var t=h.default.findChildByName(this.node,"item");this.pro_hit=h.default.findChildByName(t,"hit"),this.pro_warn=h.default.findChildByName(t,"warn")},e.prototype.initview=function(){this.pro_weblinkLabel.active=l.Platform.WEB_LINK==u.PlatformSetting.currentPlatform},e.prototype.showLoseLabel=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=!1);var i=this.pro_bloodLayerCtrl.node.convertToNodeSpaceAR(e);this.pro_bloodLayerCtrl.createBlood(t,o,i)},e.prototype.showHitEffect=function(t){var e=this,o=this.getEffectNode(),i=this.pro_hitLayer.convertToNodeSpaceAR(t);o.setPosition(i),o.active=!0,o.getComponent(cc.Animation).play(),this.scheduleOnce(function(){e.effectArr.length>e.effectArrMaxNum?e.effectArr.push(o):d.PoolMgr.getInstance().freeNode(f.poolName.effect,o),o.active=!1},.1)},e.prototype.getEffectNode=function(){var t=this.effectArr.pop();return t||((t=d.PoolMgr.getInstance().getNode(f.poolName.effect)).parent=this.pro_hitLayer),t},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.pro_warn),this.pro_warn.active=!0,cc.tween(this.pro_warn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.pro_warn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.pro_warn),t.pro_warn.active=!1}).start()},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.pro_bg),cc.tween(this.pro_bg).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-5,-5)}).by(.05,{position:cc.v3(10,5)}).by(.05,{position:cc.v3(-10,0)}).by(.05,{position:cc.v3(10,-5)}).by(.05,{position:cc.v3(-5,5)}).set({position:cc.v3(0,0)}).start()},e.prototype.doBodyDestroy=function(t){var e=this.pro_destroyLayer.convertToNodeSpaceAR(t),o=d.PoolMgr.getInstance().getNode(f.poolName.body_destroy);o.parent=this.pro_destroyLayer,o.setPosition(e),o.active=!0,o.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){d.PoolMgr.getInstance().freeNode(f.poolName.body_destroy,o)})},e.prototype.onLoad=function(){o.instance=this,this.initProperty()},e.prototype.start=function(){this.initview(),this.initListenEvent(),this.initBtnListener()},o=c([v],e)}(p.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],FLY_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"535daGsXs9IDZ98osNMJ8ed","FLY_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"535daGsXs9IDZ98osNMJ8ed","FLY_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("NodeLib"),u=i("FLY_App"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ndWin=null,e.pro_ndFail=null,e.pro_btn=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.initproperty=function(){this.pro_ndWin=p.default.findChildByName(this.node,"pro_ndWin"),this.pro_ndFail=p.default.findChildByName(this.node,"pro_ndFail"),this.pro_btn=p.default.findChildByName(this.node,"pro_btn")},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initView(),this.pro_btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.pro_ndFail.active=!this.isWin,this.pro_ndWin.active=this.isWin},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FLY_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"5dda1rf8nhFOb7D61owNjvn","FLY_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"5dda1rf8nhFOb7D61owNjvn","FLY_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("NodeLib"),m=i("fly_gameCtrl"),g=i("FLY_App"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_musicSlider=null,e.pro_effectSlider=null,e.pro_btnClose=null,e.pro_btnBackHome=null,e.pro_btnPlay=null,e.pro_gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.initproperty=function(){this.pro_musicSlider=f.default.findChildByName(this.node,"pro_musicSlider").getComponent(cc.Slider),this.pro_effectSlider=f.default.findChildByName(this.node,"pro_effectSlider").getComponent(cc.Slider),this.pro_btnClose=f.default.findChildByName(this.node,"pro_btnClose"),this.pro_btnBackHome=f.default.findChildByName(this.node,"pro_btnBackHome"),this.pro_btnPlay=f.default.findChildByName(this.node,"pro_btnPlay"),this.pro_gmNode=f.default.findChildByName(this.node,"pro_gmNode"),this.pro_musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.pro_effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.pro_musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.pro_effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.pro_musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.pro_effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.pro_musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.pro_gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&m.default.instance.openGmButtom()}),this.pro_effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.pro_btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.pro_btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){g.default.instance.exit_App(0)}),this.pro_btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([v],e)}(p.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],FSL_APP:[function(t,e,o){"use strict";cc._RF.push(e,"5ffd85Azf1Kya4FT+/eLNvv","FSL_APP");var i=t,n=e,a=o;cc._RF.push(n,"5ffd85Azf1Kya4FT+/eLNvv","FSL_APP"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("FSL_PoolMgr"),l=i("FSL_Config"),p=i("FSL_DataMgr"),u=function(){function t(){this._isInited=!1,this._exitCall=null,this.preloadComponent=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e,r.AudioMgr.getInstance().pauseAllMusic(),this.preloadComponent=function(){i._isInited=!0,s.UIMgr.getInstance().openUIOfCallback(l.FSL_UIID.FSL_UIGame,l.FSL_UIID.FSL_UIGame,function(){t&&t(),i.removeTouchEvent()})},this._isInited?this.loading():(s.UIMgr.getInstance().addUICnf(l.FSL_UICF),r.AudioMgr.getInstance().addAdConf(l.FSL_Audio),p.default.getInstance().loadCfg(function(){i.loading()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),s.UIMgr.getInstance().closeById(l.FSL_UIID.FSL_UIGame),s.UIMgr.getInstance().closeById(l.FSL_UIID.FSL_UIPause),s.UIMgr.getInstance().closeById(l.FSL_UIID.FSL_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,c.default.getInstance().clear()},t.prototype.removeTouchEvent=function(){},t.prototype.loading=function(){this.preloadComponent()},t._instance=null,t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],FSL_AtkHitEff:[function(t,e,o){"use strict";cc._RF.push(e,"06e451X28ZKw7kX/0eVRTE0","FSL_AtkHitEff");var i=t,n=e,a=o;cc._RF.push(n,"06e451X28ZKw7kX/0eVRTE0","FSL_AtkHitEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("FSL_Config"),p=i("FSL_PoolMgr"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim=this.node.getComponent(sp.Skeleton),this.spAnim.findAnimation(l.FSL_AnimName.animation),this.spAnim.setCompleteListener(function(e){e.animation.name==l.FSL_AnimName.animation&&p.default.getInstance().PushObj(t.node)})},c([d],e)}(cc.Component));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],FSL_BuffBox:[function(t,e,o){"use strict";cc._RF.push(e,"d2d576QvMNE77a1EYNizwkr","FSL_BuffBox");var i=t,n=e,a=o;cc._RF.push(n,"d2d576QvMNE77a1EYNizwkr","FSL_BuffBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("FSL_Config"),p=i("FSL_DataMgr"),u=i("FSL_GameManager"),d=i("FSL_PropBoxBase"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffIcon=null,e.txtBuffName=null,e.txtOpenFew=null,e.buffDatas=[],e.openFew=0,e.lockHp=0,e.isMAX=!1,e}return s(e,t),e.prototype.onLoad=function(){this.propType=l.FSL_ColliderName.buffBox,u.default.Instance.addPropBuffItem(this)},e.prototype.start=function(){this.buffDatas=p.default.getInstance().getTreasure(),this.updateBuffData()},e.prototype.onCollision=function(){if(!this.isMAX){if(this.lockHp--,this.txtOpenFew.string=""+this.lockHp,this.lockHp<=0){var t=this.node.position;u.default.Instance.dropBuff(t,this.buffDatas[this.openFew].buffTypeID),this.openFew++,this.updateBuffData()}cc.Tween.stopAllByTarget(this.txtOpenFew.node),cc.tween(this.txtOpenFew.node).to(.1,{scale:.7}).to(.1,{scale:.5}).start()}},e.prototype.updateBuffData=function(){var t=this;if(this.openFew>=this.buffDatas.length)return this.txtOpenFew.string="MAX",void(this.isMAX=!0);this.lockHp=this.buffDatas[this.openFew].rightHp,this.txtOpenFew.string=""+this.lockHp;var e=this.buffDatas[this.openFew].buffTypeID;this.txtBuffName.string=p.default.getInstance().getBuffData(e).buffName;var o="buffIcon/"+p.default.getInstance().getBuffData(e).icon1;this.loadSpriteFrame(l.FSL_BundleName.Sprite,o,function(e){t.buffIcon.spriteFrame=e})},c([m(cc.Sprite)],e.prototype,"buffIcon",void 0),c([m(cc.Label)],e.prototype,"txtBuffName",void 0),c([m(cc.Label)],e.prototype,"txtOpenFew",void 0),c([f],e)}(d.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FSL_Config:[function(t,e,o){"use strict";cc._RF.push(e,"7f9c9qMqpdOMJvlXx94njXI","FSL_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"7f9c9qMqpdOMJvlXx94njXI","FSL_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.FSL_RoleAsePath=l.FSL_PoolKeyName=l.FSL_QuadtreeType=l.FSL_ColliderName=l.FSL_GameState=l.FSL_AnimName=l.FSL_EventName=l.FSL_Audio=l.FSL_AudioId=l.FSL_UICF=l.FSL_UIID=l.FSL_BundleName=void 0,function(t){t.Prefabs="FSL_Prefabs",t.Sprite="FSL_Sprite",t.Audio="FSL_Audio",t.SpAnim="FSL_SpAnim"}(a=l.FSL_BundleName||(l.FSL_BundleName={})),function(t){t.FSL_UIGame="FSL_UIGame",t.FSL_UIGM="FSL_UIGM",t.FSL_UIPause="FSL_UIPause",t.FSL_UIGameOver="FSL_UIGameOver",t.FSL_UISelectBuff="FSL_UISelectBuff",t.FSL_UISelectSolderRole="FSL_UISelectSolderRole",t.FSL_UIToolTips="FSL_UIToolTips"}(r=l.FSL_UIID||(l.FSL_UIID={})),l.FSL_UICF=((i={})[r.FSL_UIGame]={prefab:"ui/FSL_UIGame",name:"FSL_UIGame",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.FSL_UIGM]={prefab:"ui/FSL_UIGM",name:"FSL_UIGM",showTop:!0,showMult:!1,zIndex:1002,bundleName:a.Prefabs},i[r.FSL_UIPause]={prefab:"ui/FSL_UIPause",name:"FSL_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.FSL_UIGameOver]={prefab:"ui/FSL_UIGameOver",name:"FSL_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.FSL_UISelectBuff]={prefab:"ui/FSL_UISelectBuff",name:"FSL_UISelectBuff",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.FSL_UISelectSolderRole]={prefab:"ui/FSL_UISelectSolderRole",name:"FSL_UISelectSolderRole",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.FSL_UIToolTips]={prefab:"ui/FSL_UIToolTips",name:"FSL_UIToolTips",showTop:!0,showMult:!1,zIndex:1010,bundleName:a.Prefabs},i),function(t){t.dragonHit="dragonHit",t.gongji="gongji",t.huode="huode",t.shibai="shibai",t.flash="flash",t.flashatk="flashatk",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.moonGod="moonGod",t.boom="boom",t.summon="summon",t.cwsq="cwsq",t.jdqx="jdqx",t.sgml="sgml",t.zysq="zysq"}(s=l.FSL_AudioId||(l.FSL_AudioId={})),l.FSL_Audio=((n={})[s.dragonHit]={path:s.dragonHit,bundle:a.Audio},n[s.gongji]={path:s.gongji,bundle:a.Audio},n[s.huode]={path:s.huode,bundle:a.Audio},n[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.flash]={path:s.flash,bundle:a.Audio},n[s.flashatk]={path:s.flashatk,bundle:a.Audio},n[s.lotus]={path:s.lotus,bundle:a.Audio},n[s.goldGod]={path:s.goldGod,bundle:a.Audio},n[s.classic]={path:s.classic,bundle:a.Audio},n[s.swordHit]={path:s.swordHit,bundle:a.Audio},n[s.moonGod]={path:s.moonGod,bundle:a.Audio},n[s.boom]={path:s.boom,bundle:a.Audio},n[s.summon]={path:s.summon,bundle:a.Audio},n[s.cwsq]={path:s.cwsq,bundle:a.Audio},n[s.jdqx]={path:s.jdqx,bundle:a.Audio},n[s.sgml]={path:s.sgml,bundle:a.Audio},n[s.zysq]={path:s.zysq,bundle:a.Audio},n),function(t){t.TouchMove="FSL_TouchMove",t.SetGameState="FSL_SetGameState",t.LoongRetreatFinish="FSL_frontMove",t.ObtainBuff="FSL_ObtainBuff",t.ActivateSkills="FSL_ActivateSkills",t.SkillsAtkDouble="FSL_SkillsAtkDouble",t.PlaySkillsAtk="FSL_PlaySkillsAtk",t.GMPlaySkill="FSL_GMPlaySkill"}(l.FSL_EventName||(l.FSL_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="move",t.animation="animation"}(l.FSL_AnimName||(l.FSL_AnimName={})),function(t){t[t.playing=0]="playing",t[t.pause=1]="pause"}(l.FSL_GameState||(l.FSL_GameState={})),function(t){t[t.loong=1]="loong",t[t.buffBox=2]="buffBox",t[t.skillBox=3]="skillBox",t[t.playerAddBuffArea=4]="playerAddBuffArea",t[t.playerRole=5]="playerRole",t[t.loongInitCourse=6]="loongInitCourse"}(l.FSL_ColliderName||(l.FSL_ColliderName={})),function(t){t[t.None=0]="None",t[t.RoleBullet=1]="RoleBullet",t[t.LoongBody=2]="LoongBody",t[t.LoongInitCourse=4]="LoongInitCourse",t[t.PropBuff=8]="PropBuff"}(l.FSL_QuadtreeType||(l.FSL_QuadtreeType={})),function(t){t.roleBullet="roleBullet",t.roleBulletPro="roleBulletPro",t.loong="loong",t.loongLinkTrack="loongLinkTrack",t.dieEff="dieEff",t.harmEff="harmEff",t.atkHitEff="atkHitEff"}(l.FSL_PoolKeyName||(l.FSL_PoolKeyName={})),l.FSL_RoleAsePath={1:{path:"soilder_3/soilder_3",ID:1},3:{path:"djdh_3/djdh_3",ID:3},4:{path:"djdh_4/djdh_4",ID:4},5:{path:"djdh_5/djdh_5",ID:5},6:{path:"djdh_6/djdh_6",ID:6},7:{path:"soilder_4/soilder_4",ID:7},8:{path:"djdh_8/djdh_8",ID:8},10:{path:"djdh_10/djdh_10",ID:10},11:{path:"soilder_1/soilder_1",ID:11},17:{path:"djdh_17/djdh_17",ID:17}},cc._RF.pop(),cc._RF.pop()},{}],FSL_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"9ad5bnv/zpP8pozrnU+6gGa","FSL_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"9ad5bnv/zpP8pozrnU+6gGa","FSL_DataMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.getData=function(){return this.data},t.prototype.loadCfg=function(t){var e=this;r.ResourceMgr.getInstance().loadRes("FSL_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getLoongLevelInfoCfg=function(t){return this.getCfgByPrimaryKey(this.data.levelCfg1,t,"round")},t.prototype.getLoongList=function(){return this.data.levelCfg1},t.prototype.getTreasure=function(){return this.data.rightTreasureCfg},t.prototype.getBuffCfg=function(){return this.data.buffCfg||null},t.prototype.getBuffData=function(t){return this.getCfgByPrimaryKey(this.data.buffCfg,t,"ID")},t.prototype.getParameterCfg=function(t){return this.data.GearParameterCfg[t].value},t.prototype.getRoleInfo=function(t){return this.getCfgByPrimaryKey(this.data.characterCfg,t,"characterID")},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getSkillsCfg=function(t){return this.getCfgByPrimaryKey(this.data.mateCfg,t,"mateID")},t.prototype.getMateOddsCfg=function(){return this.data.mateOddsCfg},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],FSL_DropBuff:[function(t,e,o){"use strict";cc._RF.push(e,"9a0d5dtDDlNQ6zh1ExPcSGg","FSL_DropBuff");var i=t,n=e,a=o;cc._RF.push(n,"9a0d5dtDDlNQ6zh1ExPcSGg","FSL_DropBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("FSL_Config"),h=i("FSL_DataMgr"),f=i("FSL_GameManager"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffIcon=null,e.moveSpeed=250,e.buffID=0,e.isPause=!1,e}return s(e,t),e.prototype.init=function(t){var e,o=this;e=999==t?"buffIcon/buff_06":"buffIcon/"+h.default.getInstance().getBuffData(t).icon1,this.loadSpriteFrame(d.FSL_BundleName.Sprite,e,function(t){o.buffIcon.spriteFrame=t}),this.buffID=t,this.isPause=!1,this.moveSpeed=250},e.prototype.update=function(t){if(f.default.Instance.gameState!=d.FSL_GameState.pause&&!this.isPause){this.moveSpeed+=15;var e=this.moveSpeed*t;this.node.y-=e}},e.prototype.onCollisionEnter=function(t){if(f.default.Instance.gameState!=d.FSL_GameState.pause)switch(t.tag){case d.FSL_ColliderName.playerAddBuffArea:this.isPause=!0;break;case d.FSL_ColliderName.playerRole:switch(this.buffID){case 9011:f.default.Instance.setGameState(d.FSL_GameState.pause);var e=f.default.Instance.getSolderRoleIds();u.UIMgr.getInstance().openUI(d.FSL_UIID.FSL_UISelectSolderRole,1,e),p.AudioMgr.getInstance().playEffectFree(d.FSL_AudioId.huode);break;case 666:f.default.Instance.setGameState(d.FSL_GameState.pause),u.UIMgr.getInstance().openUI(d.FSL_UIID.FSL_UISelectBuff,1),p.AudioMgr.getInstance().playEffectFree(d.FSL_AudioId.huode);break;case 999:f.default.Instance.isBullerPro=!0,p.AudioMgr.getInstance().playEffectFree(d.FSL_AudioId.flash),u.UIMgr.getInstance().openUI(d.FSL_UIID.FSL_UIToolTips,1,1,this.buffID);break;default:var o=h.default.getInstance().getBuffData(this.buffID).buffParametric;this.sendEvent(d.FSL_EventName.ObtainBuff,this.buffID,o),u.UIMgr.getInstance().openUI(d.FSL_UIID.FSL_UIToolTips,1,1,this.buffID),p.AudioMgr.getInstance().playEffectFree(d.FSL_AudioId.huode)}this.isPause=!0,this.node.destroy()}},c([y(cc.Sprite)],e.prototype,"buffIcon",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],FSL_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"bd877gbBpNGiIRdoTEiQMS2","FSL_GameData");var i=e,n=o;cc._RF.push(i,"bd877gbBpNGiIRdoTEiQMS2","FSL_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emFSL_GameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.levelCfg1="levelCfg1",t.levelCfg3="levelCfg3",t.levelCfg2="levelCfg2",t.mateOddsCfg="mateOddsCfg",t.mateCfg="mateCfg",t.GearParameterCfg="GearParameterCfg",t.rightTreasureCfg="rightTreasureCfg",t.characterCfg="characterCfg"}(n.emFSL_GameDataKeys||(n.emFSL_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],FSL_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"af72eWPAJVBTZPoWzLMFflZ","FSL_GameEnumData");var i=e,n=o;cc._RF.push(i,"af72eWPAJVBTZPoWzLMFflZ","FSL_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.FSL_enumGearParameterCfg=void 0,function(t){t[t.BasicAtk=1]="BasicAtk",t[t.BasicAtkSpeed=2]="BasicAtkSpeed",t[t.BasicSpeed=3]="BasicSpeed",t[t.BasicFireSpeed=4]="BasicFireSpeed",t[t.BulletSpeed=5]="BulletSpeed",t[t.SecondCharATK=6]="SecondCharATK",t[t.ThirdCharATK=7]="ThirdCharATK",t[t.BasicCrit=8]="BasicCrit",t[t.CritDamage=9]="CritDamage",t[t.LeftBoxHp=10]="LeftBoxHp",t[t.ChoseID=11]="ChoseID",t[t.FireDragonNum=12]="FireDragonNum",t[t.FireDragonTime=13]="FireDragonTime",t[t.duanyuAtkSpeed=14]="duanyuAtkSpeed",t[t.TopAtkSpeed=15]="TopAtkSpeed",t[t.DragonHp1=16]="DragonHp1",t[t.DragonHp2=17]="DragonHp2",t[t.DragonHp3=18]="DragonHp3"}(n.FSL_enumGearParameterCfg||(n.FSL_enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],FSL_GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"2f34es5BiJIWKFHiIEXW/As","FSL_GameManager");var i=t,n=e,a=o;cc._RF.push(n,"2f34es5BiJIWKFHiIEXW/As","FSL_GameManager");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("FSL_Config"),h=i("FSL_DataMgr"),f=i("FSL_GameEnumData"),m=i("FSL_Loong"),g=i("FSL_LoongLinkTrack"),y=i("FSL_DropBuff"),v=i("FSL_HarmEff"),_=i("FSL_LoongMovePathInfo"),b=i("FSL_Skills"),B=i("FSL_PlayerRole"),I=i("FSL_PoolMgr"),P=cc._decorator,C=P.ccclass,D=P.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loongInitCourse=null,e.roleBulletBase=null,e.loongBase=null,e.rolePos=[],e.skillPos=null,e.skillsBase=null,e.harmEffBase=null,e.loongBodyIcon=[],e.loongBodyIconRotate=[],e.gameState=null,e.sendLoongInterval=1.1,e.sendLoongTime=0,e.sendLoongOrder=0,e.loongBodyAll=[],e.loongMovePath=[],e.behindLoong=null,e.bodyIconIndex=0,e.bodyIconLog=0,e.maxLoongLevelLength=0,e.bodyRotateSpeed=50,e.bodyRotateTime=0,e.bodyRotateToggle=!1,e.loongMoveSpeed=80,e.killedLoongBody=0,e.loongFireNeedFew=20,e.isLoongFier=!1,e.loongFireContinue=2,e.loongFireTime=0,e.loongHeadScript=null,e.lordRoleScript=null,e.lordRoleGainID=0,e.solderGainIDs=[],e.activateSkills=[],e.mateCfgs=[],e.mateOddsCfg=[],e.isImmobilize=!1,e.immobilizeTime=0,e.isBullerPro=!1,e.roleBulletSpriteFrame=[],e.roleBulletCfg={},e.harmCritical=[],e.harmOrdinary=[],e.propBuff=[],e.isPlayAtkHitAudio=!1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this)},e.prototype.start=function(){for(var t=this,e=0,o=this.roleBulletSpriteFrame;e<o.length;e++){var i=o[e];this.roleBulletCfg[i.name]=i}for(var n=cc.find("loongMovePath copy",this.node).children,a=0;a<n.length;a++)this.loongMovePath[a]=n[a].getComponent(_.default);this.initData(),this.loadPrefab(d.FSL_BundleName.Prefabs,"role/playerRole",function(e){var o=t.solderGainIDs.length,i=cc.instantiate(e);t.rolePos[o].active=!0,i.setParent(t.rolePos[o]),i.setPosition(cc.v3());var n=[1,3,4,5,6,7,8,10,11,17],a=n[t.random(0,n.length,!0)];t.lordRoleScript=i.getComponent(B.default),t.lordRoleScript.init(o,a),t.lordRoleGainID=a,t.solderGainIDs.push(a)}),this.sendLoong(!0),this.setGameState(d.FSL_GameState.playing)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),o.Instance=null},e.prototype.initData=function(){this.maxLoongLevelLength=h.default.getInstance().getLoongList().length,this.mateCfgs=h.default.getInstance().getMateCfg(),this.mateOddsCfg=h.default.getInstance().getMateOddsCfg(),this.loongFireNeedFew=h.default.getInstance().getParameterCfg(f.FSL_enumGearParameterCfg.FireDragonNum),this.loongFireContinue=h.default.getInstance().getParameterCfg(f.FSL_enumGearParameterCfg.FireDragonTime),this.loongMoveSpeed=h.default.getInstance().getParameterCfg(f.FSL_enumGearParameterCfg.BasicSpeed)},e.prototype.getLoongRectRect=function(t){for(var e=[],o=t.colBox.getBoundingBoxToWorld(),i=0,n=this.loongBodyAll;i<n.length;i++){var a=n[i],r=a.colBox.getBoundingBoxToWorld();cc.Intersection.rectRect(o,r)&&(a.isHead||e.push(a))}return e},e.prototype.addPropBuffItem=function(t){this.propBuff.includes(t)||this.propBuff.push(t)},e.prototype.removePropBuffItem=function(t){var e=this.propBuff.indexOf(t);-1!==e&&this.propBuff.splice(e,1)},e.prototype.getPropRectRect=function(t){for(var e=t.colBox.getBoundingBoxToWorld(),o=0,i=this.propBuff;o<i.length;o++){var n=i[o],a=n.colBox.getBoundingBoxToWorld();if(cc.Intersection.rectRect(e,a))return n}return null},e.prototype.update=function(t){if(this.gameState!=d.FSL_GameState.pause){if(this.bodyRotateTime+=t,this.bodyRotateToggle?this.bodyRotateTime>2&&(this.bodyRotateTime=0,this.bodyRotateToggle=!this.bodyRotateToggle,this.bodyRotateSpeed=50):this.bodyRotateTime>6&&(this.bodyRotateTime=0,this.bodyRotateToggle=!this.bodyRotateToggle,this.bodyRotateSpeed=90),this.isImmobilize)return this.immobilizeTime+=t,void(this.immobilizeTime>3&&this.setImmobilize(!1));if(this.isLoongFier&&(this.loongFireTime+=t,this.loongFireTime>this.loongFireContinue&&(this.loongFireTime=0,this.isLoongFier=!1,this.loongFireState(!1))),null!=this.behindLoong&&this.behindLoong.active&&this.sendLoongOrder<this.maxLoongLevelLength){var e=this.loongMovePath[0].pos.position,o=this.behindLoong.position;e.sub(o).mag()>=95&&this.sendLoong()}}},e.prototype.setGameState=function(t){switch(this.gameState=t,this.sendEvent(d.FSL_EventName.SetGameState,this.gameState),this.gameState){case d.FSL_GameState.pause:cc.director.getCollisionManager().enabled=!1;break;case d.FSL_GameState.playing:cc.director.getCollisionManager().enabled=!0}},e.prototype.setImmobilize=function(t){t?this.loongHeadScript.setLoongHeadAnim(2):this.loongHeadScript.setLoongHeadAnim(0),this.isImmobilize=t,this.immobilizeTime=0},e.prototype.loongFireState=function(t){t?(this.loongMoveSpeed=h.default.getInstance().getParameterCfg(f.FSL_enumGearParameterCfg.BasicFireSpeed),this.loongHeadScript.setLoongHeadAnim(1)):(this.loongMoveSpeed=h.default.getInstance().getParameterCfg(f.FSL_enumGearParameterCfg.BasicSpeed),this.loongHeadScript.setLoongHeadAnim(0))},e.prototype.setLoongFire=function(){this.killedLoongBody=0,this.isLoongFier=!0,this.loongFireTime=0,this.loongFireState(!0)},e.prototype.sendLoong=function(t){var e=this;void 0===t&&(t=!1),this.sendLoongOrder++;var o=h.default.getInstance().getLoongLevelInfoCfg(this.sendLoongOrder);I.default.getInstance().getObj(d.FSL_BundleName.Prefabs,"loong/loongLinkTrack",function(i){i.setParent(e.loongBase),i.setPosition(e.loongMovePath[0].pos.position);var n=i.getComponent(g.default);n.init(e.loongMovePath),e.behindLoong=i,I.default.getInstance().getObj(d.FSL_BundleName.Prefabs,"loong/loongBody",function(i){i.setParent(e.loongBase),i.setPosition(e.loongMovePath[0].pos.position),e.loongBase.insertChild(i,0);var a=i.getComponent(m.default);a.init(e.loongMovePath,o,e.sendLoongOrder,n,t),e.loongBodyAll.push(a),t&&(e.loongHeadScript=a,e.setLoongFire())})})},e.prototype.removeloong=function(t){this.killedLoongBody++,this.killedLoongBody>=this.loongFireNeedFew&&this.setLoongFire();for(var e=this.loongBodyAll.indexOf(t),o=this.loongBodyAll[e],i=0;i<this.loongBodyAll.length;i++)if(i<e){var n=i==e-1;this.loongBodyAll[i].retreatMove(o.loongIndex,o,this.loongBodyAll[i+1].loongLinkTrack,n)}if(this.loongBodyAll.splice(e,1),this.sendLoongOrder==this.maxLoongLevelLength&&1==this.loongBodyAll.length)return this.setGameState(d.FSL_GameState.pause),void u.UIMgr.getInstance().openUI(d.FSL_UIID.FSL_UIGameOver,1,!0)},e.prototype.getLoongBodyIcon=function(t){var e=[];return t?(e[0]=this.loongBodyIcon[5],e[1]=this.loongBodyIconRotate[5],this.bodyIconLog=0,this.bodyIconIndex++,this.bodyIconIndex>4&&(this.bodyIconIndex=0)):(this.bodyIconLog++,this.bodyIconLog>3&&(this.bodyIconLog=1,this.bodyIconIndex++,this.bodyIconIndex>4&&(this.bodyIconIndex=0)),e[0]=this.loongBodyIcon[this.bodyIconIndex],e[1]=this.loongBodyIconRotate[this.bodyIconIndex]),e},e.prototype.playDieEff=function(t){var e=this;I.default.getInstance().getObj(d.FSL_BundleName.Prefabs,"eff/loongDieEff",function(o){o.setParent(e.roleBulletBase),o.setPosition(t)})},e.prototype.playAtkHitEff=function(t){var e=this;I.default.getInstance().getObj(d.FSL_BundleName.Prefabs,"eff/atkHitEff",function(o){o.setParent(e.roleBulletBase),t.y-=40,o.setPosition(t)})},e.prototype.playAtkHitAudio=function(){var t=this;this.isPlayAtkHitAudio||(this.isPlayAtkHitAudio=!0,setTimeout(function(){t.isPlayAtkHitAudio=!1},110),p.AudioMgr.getInstance().playEffectFree(d.FSL_AudioId.dragonHit))},e.prototype.playHarmEff=function(t,e,o,i){var n=this;I.default.getInstance().getObj(d.FSL_BundleName.Prefabs,"eff/harmEff",function(a){a.setParent(n.harmEffBase),t.x+=30*e,t.y+=30*e,n.harmEffBase.insertChild(a,0),a.setPosition(t),a.getComponent(v.default).init(o,i)})},e.prototype.getHarmIcon=function(t,e){return e?this.harmCritical[t]:this.harmOrdinary[t]},e.prototype.dropBuff=function(t,e){var o=this;this.loadPrefab(d.FSL_BundleName.Prefabs,"buff/dropBuff",function(i){var n=cc.instantiate(i);n.setParent(o.roleBulletBase),n.setPosition(t),n.getComponent(y.default).init(e)})},e.prototype.getRoleBullet=function(t){return this.roleBulletCfg[t]},e.prototype.getSolderRoleIds=function(){var t=new Set(this.solderGainIDs),e=this.lordRoleGainID,o=this.mateOddsCfg.find(function(t){return t.characterID===e});if(!o)return cc.error("\u627e\u4e0d\u5230\u4e3b\u89d2ID "+e+" \u7684 mateOdds \u914d\u7f6e"),[];var i=o.mateOdds.split("|").map(function(t){var e=t.split(","),o=e[0],i=e[1];return[parseInt(o,10),parseFloat(i)]}).filter(function(o){var i=o[0],n=o[1];return i!==e&&n>0&&!t.has(i)});if(0===i.length)return[];for(var n=[],a=0,r=0,s=i;r<s.length;r++){var c=s[r],l=c[0],p=c[1];a+=p,n.push([l,a])}for(var u=[],d=function(){var t=Math.random()*a,e=n.findIndex(function(e){var o=e[1];return t<=o});if(-1===e)return"break";var o=n[e],i=o[0];o[1],u.push(i);var r=0===e?n[0][1]:n[e][1]-n[e-1][1];a-=r,n.splice(e,1);for(var s=e;s<n.length;s++)n[s][1]-=r},h=0;h<2&&n.length>0&&"break"!==d();h++);return u},e.prototype.pickupSolderRole=function(t){var e=this;if(!(this.solderGainIDs.length>=3)){var o=this.solderGainIDs.length;this.loadPrefab(d.FSL_BundleName.Prefabs,"role/playerRole",function(i){var n=cc.instantiate(i);e.rolePos[o].active=!0,n.setParent(e.rolePos[o]),n.setPosition(cc.v3()),n.getComponent(B.default).init(o,t)}),this.getActivatedMateIDs(t)}},e.prototype.getActivatedMateIDs=function(t){var e=this;this.solderGainIDs.push(t);for(var o=0,i=this.mateCfgs;o<i.length;o++){var n=i[o];this.activateSkills.includes(n.mateID)||n.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).includes(t)})&&n.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).every(function(t){return e.solderGainIDs.includes(t)})})&&(this.activateSkills.push(n.mateID),this.sendEvent(d.FSL_EventName.ActivateSkills,n.mateID))}},e.prototype.playSkillsAtk=function(t){var e=this,o="skills/skill_"+t;this.loadPrefab(d.FSL_BundleName.Prefabs,o,function(o){var i=cc.instantiate(o);i.setParent(e.skillsBase),i.setPosition(cc.v3());var n=e.round(e.lordRoleScript.atkForce*h.default.getInstance().getSkillsCfg(t).mateSkillATK);i.getComponent(b.default).init(n,t)})},e.prototype.playSkillsOuside=function(){var t=this;this.skillPos.active||this.loadPrefab(d.FSL_BundleName.Prefabs,"role/playerRole",function(e){var o=cc.instantiate(e);t.skillPos.active=!0,o.setParent(t.skillPos),o.setPosition(cc.v3()),o.getComponent(B.default).summonSkill(t.lordRoleScript.atkForce,t.lordRoleScript.nowAtkInterval)})},e.prototype.removeSkillsOuside=function(){this.skillPos.active=!1},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.Instance=null,c([D(cc.Node)],e.prototype,"loongInitCourse",void 0),c([D(cc.Node)],e.prototype,"roleBulletBase",void 0),c([D(cc.Node)],e.prototype,"loongBase",void 0),c([D(cc.Node)],e.prototype,"rolePos",void 0),c([D(cc.Node)],e.prototype,"skillPos",void 0),c([D(cc.Node)],e.prototype,"skillsBase",void 0),c([D(cc.Node)],e.prototype,"harmEffBase",void 0),c([D(cc.SpriteFrame)],e.prototype,"loongBodyIcon",void 0),c([D(cc.SpriteFrame)],e.prototype,"loongBodyIconRotate",void 0),c([D(cc.SpriteFrame)],e.prototype,"roleBulletSpriteFrame",void 0),c([D(cc.SpriteFrame)],e.prototype,"harmCritical",void 0),c([D(cc.SpriteFrame)],e.prototype,"harmOrdinary",void 0),o=c([C],e)}(l.default);a.default=T,cc._RF.pop(),cc._RF.pop()},{}],FSL_HarmEff:[function(t,e,o){"use strict";cc._RF.push(e,"f8e5bZIaD1JF4ledlfFgrTX","FSL_HarmEff");var i=t,n=e,a=o;cc._RF.push(n,"f8e5bZIaD1JF4ledlfFgrTX","FSL_HarmEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("FSL_GameManager"),p=i("FSL_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ordinaryRoot=null,e.criticalRoot=null,e.critical=null,e.criticalIcon=null,e.ordinary=null,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.node.opacity=255;var i=t.toString().split("").map(Number);this.ordinaryRoot.removeAllChildren(),this.criticalRoot.removeAllChildren(),this.ordinaryRoot.active=!e,this.criticalRoot.active=e,e?(this.criticalIcon.setParent(this.criticalRoot),this.criticalIcon.active=!0):this.criticalIcon.active=!1;for(var n=0;n<i.length;n++){var a=e?cc.instantiate(this.critical):cc.instantiate(this.ordinary),r=e?this.criticalRoot:this.ordinaryRoot;a.setParent(r),a.active=!0,a.getComponent(cc.Sprite).spriteFrame=l.default.Instance.getHarmIcon(i[n],e)}var s=this.node.position.clone();s.y+=40,cc.tween(this.node).to(.25,{position:s}).call(function(){s.y+=40}).to(.25,{position:s,opacity:0}).call(function(){o.die()}).start()},e.prototype.die=function(){this.criticalIcon.setParent(this.node),p.default.getInstance().PushObj(this.node)},c([h(cc.Node)],e.prototype,"ordinaryRoot",void 0),c([h(cc.Node)],e.prototype,"criticalRoot",void 0),c([h(cc.Node)],e.prototype,"critical",void 0),c([h(cc.Node)],e.prototype,"criticalIcon",void 0),c([h(cc.Node)],e.prototype,"ordinary",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FSL_JoystickCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"846adF5Qa1Gk5FZkJSl0AMW","FSL_JoystickCtrl");var i=t,n=e,a=o;cc._RF.push(n,"846adF5Qa1Gk5FZkJSl0AMW","FSL_JoystickCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FSL_Config"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDownA=!1,e.isDownD=!1,e}return s(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onTouchMove=function(t){var e=t.getDeltaX();this.sendEvent(p.FSL_EventName.TouchMove,e)},e.prototype.update=function(){this.isDownA?this.sendEvent(p.FSL_EventName.TouchMove,-6):this.isDownD&&this.sendEvent(p.FSL_EventName.TouchMove,6)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.a:this.isDownA=!0;break;case cc.macro.KEY.d:this.isDownD=!0}},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.a:this.isDownA=!1;break;case cc.macro.KEY.d:this.isDownD=!1}},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],FSL_LoongDieEff:[function(t,e,o){"use strict";cc._RF.push(e,"1454ewBseNOeqVNfbww2wye","FSL_LoongDieEff");var i=t,n=e,a=o;cc._RF.push(n,"1454ewBseNOeqVNfbww2wye","FSL_LoongDieEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FSL_Config"),u=i("FSL_PoolMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim=this.node.getComponent(sp.Skeleton),this.spAnim.setCompleteListener(function(e){e.animation.name==p.FSL_AnimName.animation&&u.default.getInstance().PushObj(t.node)})},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FSL_LoongInitCourse:[function(t,e,o){"use strict";cc._RF.push(e,"609d2w5nOJJFp1QsEUd4/ao","FSL_LoongInitCourse");var i=t,n=e,a=o;cc._RF.push(n,"609d2w5nOJJFp1QsEUd4/ao","FSL_LoongInitCourse");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.onLoad=function(){},c([u],e)}(l.default));a.default=d,cc._RF.pop(),cc._RF.pop()},{}],FSL_LoongLinkTrack:[function(t,e,o){"use strict";cc._RF.push(e,"09783X17g9B1Iepr0ZtmWQL","FSL_LoongLinkTrack");var i=t,n=e,a=o;cc._RF.push(n,"09783X17g9B1Iepr0ZtmWQL","FSL_LoongLinkTrack");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("FSL_Config"),p=i("FSL_GameManager"),u=i("FSL_PoolMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.movePath=[],e.nowMovePos=cc.v2(),e.moveIndex=1,e.maxMoveIndex=0,e.isDie=!1,e}return s(e,t),e.prototype.init=function(t){this.moveIndex=1,this.movePath=t,this.nowMovePos=this.movePath[this.moveIndex].pos.getPosition(),this.maxMoveIndex=this.movePath.length-1,this.isDie=!1},e.prototype.update=function(t){var e=this;if(p.default.Instance.gameState!=l.FSL_GameState.pause&&!p.default.Instance.isImmobilize&&!this.isDie){var o=this.node.getPosition(),i=p.default.Instance.loongMoveSpeed*t,n=this.nowMovePos.sub(o).normalize().mul(i);this.node.setPosition(o.add(n)),this.nowMovePos.sub(o).mag()<=i&&(this.node.setPosition(this.nowMovePos),this.moveIndex<this.maxMoveIndex?(this.moveIndex++,this.nowMovePos=this.movePath[this.moveIndex].pos.getPosition()):(this.isDie=!0,setTimeout(function(){u.default.getInstance().PushObj(e.node)},1e3)))}},c([h],e)}(cc.Component));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FSL_LoongMovePathInfo:[function(t,e,o){"use strict";cc._RF.push(e,"da2abDjNLdMdKKYAJbUQnvq","FSL_LoongMovePathInfo");var i=e,n=o;cc._RF.push(i,"da2abDjNLdMdKKYAJbUQnvq","FSL_LoongMovePathInfo");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=null,e.isForward=!1,e.isReverse=!1,e.centerOnRight=!0,e.direction=1,e.targetAngleDeg=0,e.radius=0,e}return r(e,t),s([p(cc.Node)],e.prototype,"pos",void 0),s([p(cc.Boolean)],e.prototype,"isForward",void 0),s([p(cc.Boolean)],e.prototype,"isReverse",void 0),s([p(cc.Boolean)],e.prototype,"centerOnRight",void 0),s([p(cc.Integer)],e.prototype,"direction",void 0),s([p(cc.Integer)],e.prototype,"targetAngleDeg",void 0),s([p(cc.Integer)],e.prototype,"radius",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],FSL_Loong:[function(t,e,o){"use strict";cc._RF.push(e,"e5a80lBBwFC9IH9TaAaTo2b","FSL_Loong");var i=t,n=e,a=o;cc._RF.push(n,"e5a80lBBwFC9IH9TaAaTo2b","FSL_Loong");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("AudioMgr"),d=i("UIMgr"),h=i("FSL_Config"),f=i("FSL_DataMgr"),m=i("FSL_GameEnumData"),g=i("FSL_GameManager"),y=i("FSL_PoolMgr");!function(t){t.idle="idle",t.anger="anger",t.xuanyun="xuanyun"}(l||(l={}));var v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.root=null,e.Body=null,e.bodyRotate=null,e.bodyAnim=null,e.Head=null,e.txtLoongHp=null,e.iconBuff=null,e.colBox=null,e.isPoolDie=!1,e.isHead=!1,e.isDie=!1,e.loongIndex=0,e.isInitCourse=!0,e.movePath=[],e.nowMovePos=cc.v2(),e.moveIndex=1,e.maxMoveIndex=0,e.isRetreatMove=!1,e.isRetreatIndex=!1,e.retreatMoveIndex=Number.MAX_SAFE_INTEGER,e.loongLinkTrack=null,e.lastDistance=Number.MAX_SAFE_INTEGER,e.loongLevelInfo=null,e.loongHP=0,e.isBuff=!1,e.isBodyAnim=!1,e.isAtkHitEff=!1,e.atkHitEffIndex=null,e.harmEffFew=0,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.addEvent(h.FSL_EventName.PlaySkillsAtk,this.playSkillsAtk),this.addEvent(h.FSL_EventName.LoongRetreatFinish,this.loongRetreatFinish)},e.prototype.init=function(t,e,o,i,n){var a=this;if(this.isDie=!1,this.isRetreatMove=!1,this.isRetreatIndex=!1,this.moveIndex=1,this.retreatMoveIndex=Number.MAX_SAFE_INTEGER,this.root.active=!0,this.Body.color=cc.Color.WHITE,this.loongLevelInfo=null,this.isAtkHitEff=!1,this.isInitCourse=!0,this.harmEffFew=0,this.isPoolDie=!1,this.movePath=t,this.nowMovePos=this.movePath[this.moveIndex].pos.getPosition(),this.maxMoveIndex=this.movePath.length-1,this.loongIndex=o,this.isHead=n,this.loongLinkTrack=i,this.Body.active=!this.isHead,this.Head.node.active=this.isHead,this.bodyAnim.active=!1,this.txtLoongHp.node.active=!this.isHead,this.isHead)this.iconBuff.active=!1,this.setLoongHeadAnim(0);else{this.loongLevelInfo=e;var r=this.loongLevelInfo.dragonHp*f.default.getInstance().getParameterCfg(m.FSL_enumGearParameterCfg.DragonHp1);this.loongHP=g.default.Instance.round(r),this.txtLoongHp.string=this.loongHP.toString(),this.isBuff=!!this.loongLevelInfo.buffType;var s=g.default.Instance.getLoongBodyIcon(this.isBuff);if(s[0]?(this.Body.getComponent(cc.Sprite).spriteFrame=s[0],this.bodyRotate.getComponent(cc.Sprite).spriteFrame=s[1],this.isBodyAnim=!1):(this.bodyAnim.active=!0,this.Body.active=!1,this.isBodyAnim=!0),this.iconBuff.active=this.isBuff,this.txtLoongHp.node.active=!this.isBuff,this.isBuff){var c="buffIcon/"+f.default.getInstance().getBuffData(this.loongLevelInfo.buffType).icon1;this.loadSpriteFrame(h.FSL_BundleName.Sprite,c,function(t){a.iconBuff.getComponent(cc.Sprite).spriteFrame=t})}}},e.prototype.setLoongHeadAnim=function(t){switch(t){case 0:this.Head.setAnimation(0,l.idle,!0);break;case 1:this.Head.setAnimation(0,l.anger,!0);break;case 2:this.Head.setAnimation(0,l.xuanyun,!0)}},e.prototype.update=function(t){if(this.isHead||(this.bodyRotate.angle+=g.default.Instance.bodyRotateSpeed*t),g.default.Instance.gameState!=h.FSL_GameState.pause&&(!g.default.Instance.isImmobilize||this.isRetreatMove)&&!this.isDie){if(this.isInitCourse){var e=g.default.Instance.loongInitCourse.getBoundingBoxToWorld();cc.Intersection.rectRect(e,this.colBox.getBoundingBoxToWorld())&&(this.isInitCourse=!1)}if(this.isRetreatMove){var o=this.node.getPosition(),i=6*g.default.Instance.loongMoveSpeed*t,n=this.nowMovePos.sub(o).normalize().mul(i);this.node.setPosition(o.add(n));var a=this.nowMovePos.sub(o).mag();if(this.isRetreatIndex){var r=this.loongLinkTrack.node.position,s=this.node.position,c=r.sub(s).mag();if(c>this.lastDistance)return this.isRetreatIndex=!1,void this.sendEvent(h.FSL_EventName.LoongRetreatFinish,this.retreatMoveIndex);if(this.lastDistance=c,c<=i)return this.isRetreatIndex=!1,void this.sendEvent(h.FSL_EventName.LoongRetreatFinish,this.retreatMoveIndex)}a<=i&&(this.node.setPosition(this.nowMovePos),this.moveIndex--,this.moveIndex<0&&(this.moveIndex=0),this.nowMovePos=this.movePath[this.moveIndex].pos.getPosition(),this.isHead&&(this.node.x<this.nowMovePos.x?this.Head.node.setScale(-1.5,1.5):this.node.x>this.nowMovePos.x&&this.Head.node.setScale(1.5,1.5)))}else this.isHead&&(this.node.x<this.loongLinkTrack.node.x&&1.5!=this.Head.node.x?this.Head.node.setScale(1.5,1.5):this.node.x>this.loongLinkTrack.node.x&&1.5!=this.Head.node.x&&this.Head.node.setScale(-1.5,1.5),this.moveIndex==this.maxMoveIndex)&&(r=this.movePath[this.moveIndex].pos.position,s=this.node.position,r.sub(s).mag()<=4&&(g.default.Instance.setGameState(h.FSL_GameState.pause),u.AudioMgr.getInstance().playEffectFree(h.FSL_AudioId.shibai),d.UIMgr.getInstance().openUI(h.FSL_UIID.FSL_UIGameOver,1,!1))),this.moveIndex=this.loongLinkTrack.moveIndex,this.node.setPosition(this.loongLinkTrack.node.position)}},e.prototype.loongRetreatFinish=function(t){this.isPoolDie||this.isRetreatMove&&this.retreatMoveIndex==t&&(this.node.setPosition(this.loongLinkTrack.node.position),this.retreatMoveIndex=Number.MAX_SAFE_INTEGER,this.lastDistance=Number.MAX_SAFE_INTEGER,this.isRetreatMove=!1,this.isRetreatIndex=!1)},e.prototype.retreatMove=function(t,e,o,i){void 0===i&&(i=!1),this.loongIndex>=t||(this.loongLinkTrack=o,i&&(this.isRetreatIndex=!0),t<this.retreatMoveIndex&&(this.retreatMoveIndex=t),this.isRetreatMove||(this.isRetreatMove=!0,this.moveIndex--,this.moveIndex<0&&(this.moveIndex=0),this.nowMovePos=this.movePath[this.moveIndex].pos.getPosition()))},e.prototype.playSkillsAtk=function(t){this.isPoolDie||this.attackEd(t,!1)},e.prototype.attackEd=function(t,e){var o=this;if(g.default.Instance.gameState!=h.FSL_GameState.pause&&!(this.isHead||this.isInitCourse||this.isDie))if(this.loongHP-=t,this.harmEffFew<5&&(this.harmEffFew++,setTimeout(function(){o.harmEffFew--},150),g.default.Instance.playHarmEff(this.node.position,this.harmEffFew,t,e)),this.isAtkHitEff||(this.isAtkHitEff=!0,this.atkHitEffIndex=setTimeout(function(){o.isAtkHitEff=!1,o.atkHitEffIndex=null},350),g.default.Instance.playAtkHitEff(this.node.position)),this.txtLoongHp.string=this.loongHP.toString(),this.loongHP<=0)this.beKilled();else{var i=this.isBodyAnim?this.bodyAnim:this.Body;cc.Tween.stopAllByTarget(i),cc.tween(i).to(.05,{color:cc.Color.RED}).to(.05,{color:cc.Color.WHITE}).start()}},e.prototype.beKilled=function(){if(this.isPoolDie=!0,this.root.active=!1,clearTimeout(this.atkHitEffIndex),this.isBuff){var t=this.node.position;g.default.Instance.dropBuff(t,this.loongLevelInfo.buffType)}g.default.Instance.playDieEff(this.node.position),g.default.Instance.removeloong(this),this.isDie=!0,y.default.getInstance().PushObj(this.node)},c([b(cc.Node)],e.prototype,"root",void 0),c([b(cc.Node)],e.prototype,"Body",void 0),c([b(cc.Node)],e.prototype,"bodyRotate",void 0),c([b(cc.Node)],e.prototype,"bodyAnim",void 0),c([b(sp.Skeleton)],e.prototype,"Head",void 0),c([b(cc.Label)],e.prototype,"txtLoongHp",void 0),c([b(cc.Node)],e.prototype,"iconBuff",void 0),c([b(cc.Node)],e.prototype,"colBox",void 0),c([_],e)}(p.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],FSL_PlayerRole:[function(t,e,o){"use strict";cc._RF.push(e,"1edd0YNsqRFkJpLoqY4jWvF","FSL_PlayerRole");var i=t,n=e,a=o;cc._RF.push(n,"1edd0YNsqRFkJpLoqY4jWvF","FSL_PlayerRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("FSL_Config"),d=i("FSL_DataMgr"),h=i("FSL_GameEnumData"),f=i("FSL_GameManager"),m=i("FSL_PoolMgr"),g=i("FSL_RoleBullet"),y=i("FSL_RoleBulletPro"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.aktPos=null,e.skillEff=null,e.isLordRole=!1,e.clipDuration=1,e.atkAnimTimeSpeed=1,e.atkForce=0,e.criticalChance=0,e.criticalForce=1,e.basicAtkInterval=1,e.nowAtkInterval=.7,e.addAtkInterval=0,e.atkTime=0,e.bulletStepX=23,e.bulletTrajectory=1,e.bulletPenetrateFew=1,e.bulletName="",e.isSkillDouble=!1,e.skillDoubleTime=0,e.isSkillRole=!1,e.skillRoleTime=0,e}return s(e,t),e.prototype.start=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==u.FSL_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.spAnim.setAnimation(0,u.FSL_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==u.FSL_AnimName.attack&&t.attack()}),this.addEvent(u.FSL_EventName.TouchMove,this.playerMove),this.addEvent(u.FSL_EventName.SetGameState,this.setGameState),this.addEvent(u.FSL_EventName.SkillsAtkDouble,this.skillsAtkDouble)},e.prototype.init=function(t,e){var o=this;switch(t){case 0:this.isLordRole=!0,this.atkForce=d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.BasicAtk);break;case 1:this.atkForce=d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.SecondCharATK);break;case 2:this.atkForce=d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.ThirdCharATK)}this.basicAtkInterval=d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.BasicAtkSpeed),this.nowAtkInterval=d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.BasicAtkSpeed),this.criticalChance=d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.BasicCrit),this.criticalForce=d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.CritDamage),this.nowAtkInterval=this.basicAtkInterval,this.bulletName=d.default.getInstance().getRoleInfo(e).bullet,this.loadResFromBundle(u.FSL_BundleName.SpAnim,u.FSL_RoleAsePath[e].path,sp.SkeletonData,function(t){o.spAnim.skeletonData=t;var e=o.spAnim.findAnimation(u.FSL_AnimName.attack);o.clipDuration=e.duration,o.setSpAnimPlaySpeed(),o.playAtkAnim()}),this.addEvent(u.FSL_EventName.ObtainBuff,this.obtainBuff)},e.prototype.summonSkill=function(t,e){var o=this;this.isSkillRole=!0,this.skillRoleTime=0,this.skillEff.active=!0,this.nowAtkInterval=e*d.default.getInstance().getParameterCfg(h.FSL_enumGearParameterCfg.duanyuAtkSpeed),this.atkForce=t*d.default.getInstance().getSkillsCfg(7).mateSkillATK,this.bulletName="hero8_bullet1",this.loadResFromBundle(u.FSL_BundleName.SpAnim,"djdh_14/djdh_14",sp.SkeletonData,function(t){o.spAnim.skeletonData=t,o.spAnim.setAnimation(0,u.FSL_AnimName.idle,!0)})},e.prototype.update=function(t){f.default.Instance.gameState!=u.FSL_GameState.pause&&(this.atkTime+=t,this.atkTime>this.nowAtkInterval&&(this.atkTime=0,this.isSkillRole?this.attack():this.playAtkAnim()),this.isSkillDouble&&(this.skillDoubleTime+=t,this.skillDoubleTime>15&&(this.skillDoubleTime=0,this.isSkillDouble=!1,this.skillEff.active=!1)),this.isSkillRole&&(this.skillRoleTime+=t,this.skillRoleTime>30&&(this.skillRoleTime=0,this.isSkillRole=!1,f.default.Instance.removeSkillsOuside(),this.node.destroy())))},e.prototype.setSpAnimPlaySpeed=function(){this.nowAtkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.nowAtkInterval*1.1)},e.prototype.playAtkAnim=function(){this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,u.FSL_AnimName.attack,!1)},e.prototype.attack=function(){var t=this;if(this.isLordRole&&(f.default.Instance.isBullerPro?p.AudioMgr.getInstance().playEffectFree(u.FSL_AudioId.flashatk):p.AudioMgr.getInstance().playEffectFree(u.FSL_AudioId.gongji)),f.default.Instance.isBullerPro)m.default.getInstance().getObj(u.FSL_BundleName.Prefabs,"bullet/roleBulletPro",function(e){e.setParent(f.default.Instance.roleBulletBase);var o=t.aktPos.convertToWorldSpaceAR(cc.v2(0,0)),i=e.parent.convertToNodeSpaceAR(o),n=t.atkForce*t.bulletTrajectory;t.isSkillDouble&&(n=2*t.atkForce),e.setPosition(i),e.getComponent(y.default).init(n,t.criticalChance,t.criticalForce)});else for(var e=function(e){m.default.getInstance().getObj(u.FSL_BundleName.Prefabs,"bullet/roleBullet",function(o){o.setParent(f.default.Instance.roleBulletBase);var i=t.aktPos.convertToWorldSpaceAR(cc.v2(0,0)),n=o.parent.convertToNodeSpaceAR(i),a=-t.bulletStepX*(t.bulletTrajectory-1)/2+e*t.bulletStepX;n.x+=a;var r=t.atkForce;t.isSkillDouble&&(r=2*t.atkForce),o.setPosition(n),o.getComponent(g.default).init(t.bulletName,r,t.bulletPenetrateFew,t.criticalChance,t.criticalForce)})},o=0;o<this.bulletTrajectory;o++)e(o)},e.prototype.skillsAtkDouble=function(){this.skillEff.active=!0,this.isSkillDouble=!0,this.skillDoubleTime=0},e.prototype.obtainBuff=function(t,e){switch(t){case 9001:case 9012:this.atkForce+=e;break;case 9002:case 9003:case 9004:var o=f.default.Instance.round(this.atkForce*e);this.atkForce=o;break;case 9005:this.bulletTrajectory+=e;break;case 9006:case 9007:case 9008:this.addAtkInterval+=e,this.nowAtkInterval=this.basicAtkInterval/(1+this.addAtkInterval),this.nowAtkInterval<.15&&(this.nowAtkInterval=.15),this.setSpAnimPlaySpeed();break;case 9009:this.criticalChance+=e;break;case 9010:this.criticalForce+=e}},e.prototype.setGameState=function(t){switch(t){case u.FSL_GameState.pause:this.spAnim.paused=!0;break;case u.FSL_GameState.playing:this.spAnim.paused=!1}},e.prototype.playerMove=function(t){f.default.Instance.gameState!=u.FSL_GameState.pause&&(t>.01&&1!=this.spAnim.node.x?this.spAnim.node.setScale(1,1):-1!=this.spAnim.node.x&&this.spAnim.node.setScale(-1,1))},c([b(sp.Skeleton)],e.prototype,"spAnim",void 0),c([b(cc.Node)],e.prototype,"aktPos",void 0),c([b(cc.Node)],e.prototype,"skillEff",void 0),c([_],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],FSL_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"e51983pXAhFd60y09VRh5MG","FSL_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"e51983pXAhFd60y09VRh5MG","FSL_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=cc._decorator.ccclass,l=function(){function t(){this.poolMap={},this.poolObjBase=null;var t=new cc.Node("poolObjBase"),e=cc.find("uiRoot");t.setParent(e),this.poolObjBase=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e,o){var i=e.replace(/\//g,"_");this.poolMap[i]&&this.poolMap[i].poolList.length>0?o(this.poolMap[i].getObj()):s.ResourceMgr.getInstance().loadRes(t,e,cc.Prefab,function(t){var e=cc.instantiate(t);e.name=i,o(e)})},t.prototype.PushObj=function(t){if(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new p(t,this.poolObjBase);this.poolMap[e]=o}}},t.prototype.clear=function(){this.poolMap={},this.poolObjBase.removeAllChildren()},e=r([c],t)}();a.default=l;var p=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],FSL_PropBoxBase:[function(t,e,o){"use strict";cc._RF.push(e,"70435CSGp5C/IRlquTDON/L","FSL_PropBoxBase");var i=t,n=e,a=o;cc._RF.push(n,"70435CSGp5C/IRlquTDON/L","FSL_PropBoxBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colBox=null,e.propType=null,e}return s(e,t),e.prototype.onCollision=function(){},c([d(cc.Node)],e.prototype,"colBox",void 0),c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],FSL_PropBoxMove:[function(t,e,o){"use strict";cc._RF.push(e,"18badTB4WJPMZrrlXEWD6EV","FSL_PropBoxMove");var i=t,n=e,a=o;cc._RF.push(n,"18badTB4WJPMZrrlXEWD6EV","FSL_PropBoxMove");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FSL_PropBoxBase"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLeft=!1,e.prop=null,e}return s(e,t),e.prototype.onLoad=function(){},c([h(Boolean)],e.prototype,"isLeft",void 0),c([h(p.default)],e.prototype,"prop",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FSL_RoleBaseCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1d02dJyMzBLlIzh/GDNj/z3","FSL_RoleBaseCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1d02dJyMzBLlIzh/GDNj/z3","FSL_RoleBaseCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FSL_Config"),u=i("FSL_GameManager"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.start=function(){this.addEvent(p.FSL_EventName.TouchMove,this.playerMove)},e.prototype.playerMove=function(t){if(u.default.Instance.gameState!=p.FSL_GameState.pause){var e=this.node.x+t;this.node.x=e}},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FSL_RoleBulletBase:[function(t,e,o){"use strict";cc._RF.push(e,"379ddu2t9ZPUrKDInCbiIMc","FSL_RoleBulletBase");var i=t,n=e,a=o;cc._RF.push(n,"379ddu2t9ZPUrKDInCbiIMc","FSL_RoleBulletBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colBox=null,e}return s(e,t),e.prototype.quadtreeCollisionEnter=function(){},c([d(cc.Node)],e.prototype,"colBox",void 0),c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],FSL_RoleBulletPro:[function(t,e,o){"use strict";cc._RF.push(e,"43a4dlql5REALbVslkBX8NK","FSL_RoleBulletPro");var i=t,n=e,a=o;cc._RF.push(n,"43a4dlql5REALbVslkBX8NK","FSL_RoleBulletPro");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("FSL_Config"),p=i("FSL_GameManager"),u=i("FSL_PoolMgr"),d=i("FSL_RoleBulletBase"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.isDie=!1,e.atkForce=0,e.criticalChance=0,e.criticalForce=0,e.atkNodeFew=[],e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==l.FSL_AnimName.animation&&t.die()})},e.prototype.init=function(t,e,o){this.atkForce=t,this.criticalChance=e,this.criticalForce=o,this.isDie=!1,this.atkNodeFew=[],this.spAnim.setAnimation(0,l.FSL_AnimName.animation,!1)},e.prototype.update=function(){p.default.Instance.gameState!=l.FSL_GameState.pause&&(this.isDie||(this.checkCollisionProp(),this.checkCollisionLoong()))},e.prototype.checkCollisionProp=function(){var t=p.default.Instance.getPropRectRect(this);if(null!=t){if(this.atkNodeFew.includes(t.node))return;this.atkNodeFew.push(t.node),t.onCollision()}},e.prototype.checkCollisionLoong=function(){for(var t=0,e=p.default.Instance.getLoongRectRect(this);t<e.length;t++){var o=e[t];if(o.isDie)return;if(this.atkNodeFew.includes(o.node))return;this.atkNodeFew.push(o.node);var i=this.atkForce,n=Math.random()<this.criticalChance;n&&(i=p.default.Instance.round(this.atkForce*this.criticalForce)),o.attackEd(i,n)}},e.prototype.die=function(){this.isDie=!0,u.default.getInstance().PushObj(this.node)},c([m(sp.Skeleton)],e.prototype,"spAnim",void 0),c([f],e)}(d.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FSL_RoleBullet:[function(t,e,o){"use strict";cc._RF.push(e,"317e5elfWlKrIgS7zTl87eV","FSL_RoleBullet");var i=t,n=e,a=o;cc._RF.push(n,"317e5elfWlKrIgS7zTl87eV","FSL_RoleBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("FSL_Config"),p=i("FSL_GameManager"),u=i("FSL_PoolMgr"),d=i("FSL_RoleBulletBase"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletSprite=null,e.isDie=!1,e.dieTime=0,e.moveSpeed=1300,e.atkForce=0,e.atkFew=0,e.bulletPenetrateFew=1,e.criticalChance=0,e.criticalForce=0,e}return s(e,t),e.prototype.init=function(t,e,o,i,n){this.bulletSprite.spriteFrame=p.default.Instance.getRoleBullet(t),this.atkForce=e,this.bulletPenetrateFew=o,this.criticalChance=i,this.criticalForce=n,this.isDie=!1,this.dieTime=0,this.atkFew=0},e.prototype.update=function(t){if(p.default.Instance.gameState!=l.FSL_GameState.pause&&!this.isDie){var e=this.moveSpeed*t;this.node.y+=e,this.dieTime+=t,this.dieTime>1.5&&this.die(),this.checkCollisionProp()}},e.prototype.checkCollisionProp=function(){var t=p.default.Instance.getPropRectRect(this);null!=t?(t.onCollision(),this.atkFew++,this.atkFew==this.bulletPenetrateFew&&this.die()):this.checkCollisionLoong()},e.prototype.checkCollisionLoong=function(){var t=p.default.Instance.getLoongRectRect(this);if(t.length>0){var e=t[0];if(e.isDie)return;p.default.Instance.playAtkHitAudio();var o=this.atkForce,i=Math.random()<this.criticalChance;i&&(o=p.default.Instance.round(this.atkForce*this.criticalForce)),e.attackEd(o,i),this.atkFew++,this.atkFew==this.bulletPenetrateFew&&this.die()}},e.prototype.die=function(){this.isDie=!0,u.default.getInstance().PushObj(this.node)},c([m(cc.Sprite)],e.prototype,"bulletSprite",void 0),c([f],e)}(d.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FSL_SkillBox:[function(t,e,o){"use strict";cc._RF.push(e,"2141eufMVFG1pybnZbAvFSh","FSL_SkillBox");var i=t,n=e,a=o;cc._RF.push(n,"2141eufMVFG1pybnZbAvFSh","FSL_SkillBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("FSL_Config"),p=i("FSL_DataMgr"),u=i("FSL_GameEnumData"),d=i("FSL_GameManager"),h=i("FSL_PropBoxBase"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtOpenFew=null,e.lockHp=999,e}return s(e,t),e.prototype.onLoad=function(){this.lockHp=p.default.getInstance().getParameterCfg(u.FSL_enumGearParameterCfg.LeftBoxHp),this.txtOpenFew.string=""+this.lockHp,this.propType=l.FSL_ColliderName.skillBox,d.default.Instance.addPropBuffItem(this)},e.prototype.onCollision=function(){if(this.lockHp--,this.txtOpenFew.string=""+this.lockHp,this.lockHp<=0){var t=this.node.position;return d.default.Instance.dropBuff(t,999),d.default.Instance.removePropBuffItem(this),void this.node.destroy()}cc.Tween.stopAllByTarget(this.txtOpenFew.node),cc.tween(this.txtOpenFew.node).to(.1,{scale:.7}).to(.1,{scale:.5}).start()},c([g(cc.Label)],e.prototype,"txtOpenFew",void 0),c([m],e)}(h.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],FSL_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"1b94exJ8adNfZiIx1/jsB8+","FSL_Skills");var i=t,n=e,a=o;cc._RF.push(n,"1b94exJ8adNfZiIx1/jsB8+","FSL_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("FSL_Config"),u=i("FSL_GameManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkForce=0,e.skillID=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==p.FSL_AnimName.animation&&t.node.destroy()}),this.spAnim.setEventListener(function(e,o){switch(o.data.name){case p.FSL_AnimName.attack:case"hit":t.sendEvent(p.FSL_EventName.PlaySkillsAtk,t.atkForce),3==t.skillID&&u.default.Instance.setImmobilize(!0)}})},e.prototype.init=function(t,e){this.atkForce=t,this.skillID=e,this.spAnim.setAnimation(0,p.FSL_AnimName.animation,!1)},c([f(sp.Skeleton)],e.prototype,"spAnim",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],FSL_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"db7f001XKNG0764yPLu37tm","FSL_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"db7f001XKNG0764yPLu37tm","FSL_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("UIMgr"),u=i("FSL_Config"),d=i("FSL_DataMgr"),h=i("FSL_GameManager"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.addRole=null,e.playSkill=null,e.addBuiiet=null,e.addAtkSpeed=null,e.BullerPro=null,e.addAtk=null,e}return s(e,t),e.prototype.start=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.addRole.on(cc.Node.EventType.TOUCH_END,function(){h.default.Instance.setGameState(u.FSL_GameState.pause);var t=h.default.Instance.getSolderRoleIds();p.UIMgr.getInstance().openUI(u.FSL_UIID.FSL_UISelectSolderRole,1,t)},this),this.playSkill.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(u.FSL_EventName.GMPlaySkill,1)},this),this.addBuiiet.on(cc.Node.EventType.TOUCH_END,function(){var e=d.default.getInstance().getBuffData(9005).buffParametric;t.sendEvent(u.FSL_EventName.ObtainBuff,9005,e),p.UIMgr.getInstance().openUI(u.FSL_UIID.FSL_UIToolTips,1,1,9005)},this),this.addAtkSpeed.on(cc.Node.EventType.TOUCH_END,function(){var e=d.default.getInstance().getBuffData(9006).buffParametric;t.sendEvent(u.FSL_EventName.ObtainBuff,9006,e),p.UIMgr.getInstance().openUI(u.FSL_UIID.FSL_UIToolTips,1,1,9006)},this),this.BullerPro.on(cc.Node.EventType.TOUCH_END,function(){h.default.Instance.isBullerPro=!h.default.Instance.isBullerPro},this),this.addAtk.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(u.FSL_EventName.ObtainBuff,9001,100),p.UIMgr.getInstance().openUI(u.FSL_UIID.FSL_UIToolTips,1,1,9001)},this)},c([g(cc.Node)],e.prototype,"btnClose",void 0),c([g(cc.Node)],e.prototype,"addRole",void 0),c([g(cc.Node)],e.prototype,"playSkill",void 0),c([g(cc.Node)],e.prototype,"addBuiiet",void 0),c([g(cc.Node)],e.prototype,"addAtkSpeed",void 0),c([g(cc.Node)],e.prototype,"BullerPro",void 0),c([g(cc.Node)],e.prototype,"addAtk",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],FSL_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"5a80bwFfKpN+5mU+CfWFPjw","FSL_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"5a80bwFfKpN+5mU+CfWFPjw","FSL_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("FSL_APP"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.win=null,e.fail=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this),this.win.active=this.isWin,this.fail.active=!this.isWin},c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"win",void 0),c([h(cc.Node)],e.prototype,"fail",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],FSL_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"3c354g/va1JwITFlpLDl5P7","FSL_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"3c354g/va1JwITFlpLDl5P7","FSL_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("FSL_Config"),m=i("FSL_DataMgr"),g=i("FSL_GameManager"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnPause=null,e.lockTips=null,e.btn_Skills1=null,e.btn_Skills2=null,e.lockMack_1=null,e.lockMack_2=null,e.playSkillTips=null,e.isSkillLock1=!1,e.isSkillLock2=!1,e.skillInterval1=0,e.skillInterval2=0,e.skillTime1=0,e.skillTime2=0,e.activateSkills=[],e}return s(e,t),e.prototype.start=function(){var t=this;this.playSkillTips.active=!1,this.btn_Skills1.active=!1,this.btn_Skills2.active=!1,this.lockMack_1.node.active=!1,this.lockMack_2.node.active=!1,(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&this.lockTips.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(f.FSL_UIID.FSL_UIGM)},this),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.setGameState(f.FSL_GameState.pause),t.openUI(f.FSL_UIID.FSL_UIPause)},this),this.btn_Skills1.on(cc.Node.EventType.TOUCH_END,function(){t.isSkillLock1||(t.lockMack_1.node.active=!0,t.lockMack_1.progress=1,t.isSkillLock1=!0,t.skillTime1=t.skillInterval1,t.playSkills(t.activateSkills[0]))},this),this.btn_Skills2.on(cc.Node.EventType.TOUCH_END,function(){t.isSkillLock2||(t.lockMack_2.node.active=!0,t.lockMack_2.progress=1,t.isSkillLock2=!0,t.skillTime2=t.skillInterval2,t.playSkills(t.activateSkills[1]))},this),this.addEvent(f.FSL_EventName.ActivateSkills,this.onSkillAdded),this.addEvent(f.FSL_EventName.GMPlaySkill,this.playSkills),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.space:g.default.Instance.setGameState(f.FSL_GameState.pause),this.openUI(f.FSL_UIID.FSL_UIPause)}},e.prototype.update=function(t){g.default.Instance.gameState!=f.FSL_GameState.pause&&(this.isSkillLock1&&(this.skillTime1-=t,this.lockMack_1.progress=this.skillTime1/this.skillInterval1,this.skillTime1<0&&(this.isSkillLock1=!1,this.lockMack_1.node.active=!1)),this.isSkillLock2&&(this.skillTime2-=t,this.lockMack_2.progress=this.skillTime2/this.skillInterval2,this.skillTime2<0&&(this.isSkillLock2=!1,this.lockMack_2.node.active=!1)))},e.prototype.playSkills=function(t){switch(t){case 1:case 2:case 3:case 4:case 6:case 8:case 9:case 10:case 11:g.default.Instance.playSkillsAtk(t);break;case 5:this.sendEvent(f.FSL_EventName.SkillsAtkDouble);break;case 7:g.default.Instance.playSkillsOuside()}d.AudioMgr.getInstance().playEffectFree(m.default.getInstance().getSkillsCfg(t).mateSound);var e=this.playSkillTips.position.clone(),o=cc.instantiate(this.playSkillTips);o.active=!0,o.setParent(this.playSkillTips.parent),o.setPosition(e);var i="skillsBanner/"+m.default.getInstance().getSkillsCfg(t).mateBannerRes;this.loadSpriteFrame(f.FSL_BundleName.Sprite,i,function(t){o.getComponent(cc.Sprite).spriteFrame=t}),e.x+=400,cc.tween(o).to(.4,{position:e}).start(),setTimeout(function(){e.x-=400,cc.tween(o).to(.4,{position:e}).call(function(){o.destroy()}).start()},2400)},e.prototype.onSkillAdded=function(t){var e=this;if(!(this.activateSkills.length>=2)){if(this.activateSkills.push(t),1==this.activateSkills.length){this.btn_Skills1.active=!0,this.skillInterval1=m.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime1=this.skillInterval1;var o="skillsBtnIcon/"+m.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(f.FSL_BundleName.Sprite,o,function(o){e.btn_Skills1.getComponent(cc.Sprite).spriteFrame=o,e.btn_Skills1.setScale(0),cc.tween(e.btn_Skills1).to(.2,{scale:1}).start(),e.btn_Skills1.getChildByName("skillName").getComponent(cc.Label).string=m.default.getInstance().getSkillsCfg(t).mateName})}else 2==this.activateSkills.length&&(this.btn_Skills2.active=!0,this.skillInterval2=m.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime2=this.skillInterval2,o="skillsBtnIcon/"+m.default.getInstance().getSkillsCfg(t).mateIconRes,this.loadSpriteFrame(f.FSL_BundleName.Sprite,o,function(o){e.btn_Skills2.getComponent(cc.Sprite).spriteFrame=o,e.btn_Skills2.setScale(0),cc.tween(e.btn_Skills2).to(.2,{scale:1}).start(),e.btn_Skills2.getChildByName("skillName").getComponent(cc.Label).string=m.default.getInstance().getSkillsCfg(t).mateName}));this.openUI(f.FSL_UIID.FSL_UIToolTips,0,t)}},c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"lockTips",void 0),c([_(cc.Node)],e.prototype,"btn_Skills1",void 0),c([_(cc.Node)],e.prototype,"btn_Skills2",void 0),c([_(cc.ProgressBar)],e.prototype,"lockMack_1",void 0),c([_(cc.ProgressBar)],e.prototype,"lockMack_2",void 0),c([_(cc.Node)],e.prototype,"playSkillTips",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],FSL_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"c8834LllsNOsJQmCYw6xND0","FSL_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"c8834LllsNOsJQmCYw6xND0","FSL_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("FSL_APP"),u=i("FSL_Config"),d=i("FSL_GameManager"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){d.default.Instance.setGameState(u.FSL_GameState.playing),t.closeUI()},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0),t.closeUI()},this)},c([m(cc.Node)],e.prototype,"btnResume",void 0),c([m(cc.Node)],e.prototype,"btnClose",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FSL_UISelectBuff:[function(t,e,o){"use strict";cc._RF.push(e,"9dc74PIt1NAtpFN/PnHB5EV","FSL_UISelectBuff");var i=t,n=e,a=o;cc._RF.push(n,"9dc74PIt1NAtpFN/PnHB5EV","FSL_UISelectBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("FSL_Config"),u=i("FSL_DataMgr"),d=i("FSL_GameManager"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.itemBuff=null,e.randomBuffs=[],e.isSelected=!1,e}return s(e,t),e.prototype.onLoad=function(){this.itemBuff.active=!1,this.randomBuffs=u.default.getInstance().getBuffCfg()},e.prototype.start=function(){this.isSelected=!1,this.showBuffSelection()},e.prototype.showBuffSelection=function(){for(var t=this,e=this.getRandomBuffs(),o=function(e){var o=cc.instantiate(i.itemBuff);o.setParent(i.itemBase),o.active=!0,o.on(cc.Node.EventType.TOUCH_END,function(){t.onBuffSelected(e.ID,e.buffParametric)},i);var n=e.buffCopy1;if(9001==e.ID){var a=d.default.Instance.lordRoleScript.atkForce;a=d.default.Instance.round(a*e.buffParametric),n=e.buffCopy1.replace("{0}",a.toString())}o.getChildByName("buffName").getComponent(cc.Label).string=e.buffName,o.getChildByName("buffInfo").getComponent(cc.RichText).string=n;var r="buffIcon/"+e.icon1;i.loadSpriteFrame(p.FSL_BundleName.Sprite,r,function(t){o.getChildByName("buffIcon").getComponent(cc.Sprite).spriteFrame=t})},i=this,n=0,a=e;n<a.length;n++)o(a[n])},e.prototype.onBuffSelected=function(t,e){this.isSelected||(this.isSelected=!0,d.default.Instance.setGameState(p.FSL_GameState.playing),this.sendEvent(p.FSL_EventName.ObtainBuff,t,e),this.closeUI())},e.prototype.getRandomBuffs=function(t){void 0===t&&(t=3);for(var e=this.randomBuffs.filter(function(t){return t.buffPro>0}),o=[],i=0;i<t&&0!==e.length;i++)for(var n=e.reduce(function(t,e){return t+e.buffPro},0),a=Math.random()*n,r=0;r<e.length;r++)if((a-=e[r].buffPro)<=0){var s=e[r];o.push(s),e.splice(r,1);break}return o},c([m(cc.Node)],e.prototype,"itemBase",void 0),c([m(cc.Node)],e.prototype,"itemBuff",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FSL_UISelectSolderRole:[function(t,e,o){"use strict";cc._RF.push(e,"56b1fNShgZJWIZRNKY9unul","FSL_UISelectSolderRole");var i=t,n=e,a=o;cc._RF.push(n,"56b1fNShgZJWIZRNKY9unul","FSL_UISelectSolderRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("FSL_Config"),u=i("FSL_DataMgr"),d=i("FSL_GameManager"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.ltemRole=null,e.roleSolderInfo=null,e.headBase=null,e.headinfo=null,e.headIcon=null,e.solderID=[],e.isSelected=!1,e}return s(e,t),e.prototype.onLoad=function(){this.ltemRole.active=!1,this.roleSolderInfo.active=!1,this.headinfo.active=!1,this.headIcon.active=!1},e.prototype.init=function(t){this.solderID=t},e.prototype.start=function(){var t=this;this.isSelected=!1;for(var e=function(e){var i=e,n=cc.instantiate(o.ltemRole);n.setParent(o.itemBase),n.active=!0,n.on(cc.Node.EventType.TOUCH_END,function(){t.selected(i)},o),n.getChildByName("roleName").getComponent(cc.Label).string=u.default.getInstance().getRoleInfo(o.solderID[i]).characterName;var a=n.getChildByName("infoBase");if(u.default.getInstance().getRoleInfo(o.solderID[i]).characterintr1){var r=cc.instantiate(o.roleSolderInfo);r.setParent(a),r.active=!0,r.getChildByName("txt").getComponent(cc.RichText).string=u.default.getInstance().getRoleInfo(o.solderID[i]).characterintr1;var s="solderIcon/"+u.default.getInstance().getRoleInfo(o.solderID[i]).icon1;o.loadSpriteFrame(p.FSL_BundleName.Sprite,s,function(t){r.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}if(u.default.getInstance().getRoleInfo(o.solderID[i]).characterintr2){var c=cc.instantiate(o.roleSolderInfo);c.setParent(a),c.active=!0,c.getChildByName("txt").getComponent(cc.RichText).string=u.default.getInstance().getRoleInfo(o.solderID[i]).characterintr2,s="solderIcon/"+u.default.getInstance().getRoleInfo(o.solderID[i]).icon2,o.loadSpriteFrame(p.FSL_BundleName.Sprite,s,function(t){c.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}if(u.default.getInstance().getRoleInfo(o.solderID[i]).characterintr3){var l=cc.instantiate(o.roleSolderInfo);l.setParent(a),l.active=!0,l.getChildByName("txt").getComponent(cc.RichText).string=u.default.getInstance().getRoleInfo(o.solderID[i]).characterintr3,s="solderIcon/"+u.default.getInstance().getRoleInfo(o.solderID[i]).icon3,o.loadSpriteFrame(p.FSL_BundleName.Sprite,s,function(t){l.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}o.loadResFromBundle(p.FSL_BundleName.SpAnim,p.FSL_RoleAsePath[o.solderID[i]].path,sp.SkeletonData,function(t){n.getChildByName("roleSpIcon").getComponent(sp.Skeleton).skeletonData=t,n.getChildByName("roleSpIcon").getComponent(sp.Skeleton).setAnimation(0,p.FSL_AnimName.idle,!0)})},o=this,i=0;i<2;i++)e(i);var n=d.default.Instance.solderGainIDs,a=function(t){var e=t,o=cc.instantiate(r.headinfo);o.setParent(r.headBase),o.setPosition(cc.v3()),o.active=!0;var i="head/"+u.default.getInstance().getRoleInfo(n[e]).image;r.loadSpriteFrame(p.FSL_BundleName.Sprite,i,function(t){o.getComponent(cc.Sprite).spriteFrame=t});var a=o.getChildByName("headSolderBase");if(u.default.getInstance().getRoleInfo(n[e]).icon1){var s=cc.instantiate(r.headIcon);s.setParent(a),s.setPosition(cc.v3()),s.active=!0;var c="solderIcon/"+u.default.getInstance().getRoleInfo(n[e]).icon1;r.loadSpriteFrame(p.FSL_BundleName.Sprite,c,function(t){s.getComponent(cc.Sprite).spriteFrame=t})}if(u.default.getInstance().getRoleInfo(n[e]).icon2){var l=cc.instantiate(r.headIcon);l.setParent(a),l.setPosition(cc.v3()),l.active=!0,c="solderIcon/"+u.default.getInstance().getRoleInfo(n[e]).icon2,r.loadSpriteFrame(p.FSL_BundleName.Sprite,c,function(t){l.getComponent(cc.Sprite).spriteFrame=t})}if(u.default.getInstance().getRoleInfo(n[e]).icon3){var d=cc.instantiate(r.headIcon);d.setParent(a),d.setPosition(cc.v3()),d.active=!0,c="solderIcon/"+u.default.getInstance().getRoleInfo(n[e]).icon3,r.loadSpriteFrame(p.FSL_BundleName.Sprite,c,function(t){d.getComponent(cc.Sprite).spriteFrame=t})}},r=this;for(i=0;i<n.length;i++)a(i)},e.prototype.selected=function(t){this.isSelected||(this.isSelected=!0,d.default.Instance.pickupSolderRole(this.solderID[t]),d.default.Instance.setGameState(p.FSL_GameState.playing),this.closeUI())},c([m(cc.Node)],e.prototype,"itemBase",void 0),c([m(cc.Node)],e.prototype,"ltemRole",void 0),c([m(cc.Node)],e.prototype,"roleSolderInfo",void 0),c([m(cc.Node)],e.prototype,"headBase",void 0),c([m(cc.Node)],e.prototype,"headinfo",void 0),c([m(cc.Node)],e.prototype,"headIcon",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],FSL_UIToolTips:[function(t,e,o){"use strict";cc._RF.push(e,"2df0a0JH95McKhUwB9jjJWd","FSL_UIToolTips");var i=t,n=e,a=o;cc._RF.push(n,"2df0a0JH95McKhUwB9jjJWd","FSL_UIToolTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("FSL_Config"),u=i("FSL_DataMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.tipsName=null,e.info=null,e.isSkill=0,e.tipsID=0,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(t,e){this.isSkill=t,this.tipsID=e},e.prototype.start=function(){var t=this;switch(this.isSkill){case 0:this.tipsName.string=u.default.getInstance().getSkillsCfg(this.tipsID).mateName,this.info.string=u.default.getInstance().getSkillsCfg(this.tipsID).introduce;var e="skillsBtnIcon/"+u.default.getInstance().getSkillsCfg(this.tipsID).mateIconRes;this.loadSpriteFrame(p.FSL_BundleName.Sprite,e,function(e){t.icon.spriteFrame=e});break;case 1:this.tipsName.node.active=!1;var o="";999==this.tipsID?(o="buffIcon/buff_06",this.info.string="\u96f7\u7535"):(o="buffIcon/"+u.default.getInstance().getBuffData(this.tipsID).icon1,this.info.string=u.default.getInstance().getBuffData(this.tipsID).buffName),this.loadSpriteFrame(p.FSL_BundleName.Sprite,o,function(e){t.icon.spriteFrame=e})}this.isSkill,this.node.setPosition(0,400),setTimeout(function(){var e=t.node.position.clone();e.y+=300,cc.tween(t.node).to(.4,{position:e}).call(function(){t.closeUI()}).start()},2400)},c([f(cc.Sprite)],e.prototype,"icon",void 0),c([f(cc.Label)],e.prototype,"tipsName",void 0),c([f(cc.Label)],e.prototype,"info",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],FeedCardMgr:[function(t,e,o){"use strict";cc._RF.push(e,"55c7eYIepRArqLjTPsgPzKy","FeedCardMgr");var i=t,n=e,a=o;cc._RF.push(n,"55c7eYIepRArqLjTPsgPzKy","FeedCardMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.TaskData=a.FeedCardMgr=void 0;var r=i("BasePlatform"),s=i("PlatformManager"),c=function(){function t(){this.url="https://app.sfplay.net:5555",this.isInit=!1,this.platformId=-1,this.type=-1,this.bytebroadside=["021036","021001","011004","101001","021003","061001","061004"],this.datas=[]}return t.prototype.init=function(){s.PlatformManager.currentPlatform==r.Platform.BYTEDANCE&&(this.initDy(),this.type=1)},t.prototype.initDy=function(){if(this.isInit=!0,this.systemInfo=tt.getSystemInfoSync(),this.launchOptions=tt.getLaunchOptionsSync(),window.openId)this.uid=window.openId;else{var t=localStorage.getItem(l.openId);t&&(this.uid=t)}if(this.launchOptions){var e=this.launchOptions.extra;e&&(this.appId=e.appId)}null!=this.systemInfo&&("Douyin"!=this.systemInfo.appName&&"douyin_lite"!=this.systemInfo.appName||("douyin_lite"==this.systemInfo.appName?this.platformId=2:this.platformId=1))},t.prototype.login=function(t){this.uid=localStorage.getItem(l.openId),""!=this.uid&&this.uid?t&&t():this.getOpenId(function(){t&&t()})},t.prototype.getIsBytebroadside=function(){if(1!=this.type)return!1;this.isInit||this.init();for(var t=0;t<this.bytebroadside.length;t++)if(this.launchOptions.scene==this.bytebroadside[t])return!0;return!1},t.prototype.checkCanSend=function(){return 1==this.type&&(this.isInit||this.init(),-1!=this.platformId)},t.prototype.getLaunchCardId=function(){if(1!=this.type)return-1;if(this.isInit||this.init(),this.launchOptions){if(1==this.platformId){if(this.launchOptions.scene+""!="023040")return-1}else if(2==this.platformId&&this.launchOptions.scene+""!="103040")return-1;return this.launchOptions.query.card_id?this.launchOptions.query.card_id:-1}return-1},t.prototype.getLaunchFromFeedcard=function(){if(this.isInit||this.init(),this.launchOptions)if(1==this.platformId){if(this.launchOptions.scene+""=="023040")return!0}else if(2==this.platformId&&this.launchOptions.scene+""=="103040")return!0;return!1},t.prototype.getTaskTarget=function(t){var e=this;if(this.iLog("\u83b7\u53d6\u9700\u8981\u5b8c\u6210\u7684\u4efb\u52a1\u76ee\u6807"),1==this.type){if(this.isInit||this.init(),!this.checkCanSend())return console.error("\u4e0d\u662f\u5bf9\u5e94\u7684\u5e73\u53f0"),void(t&&t(null));var o={appId:this.appId};this.ttRequest(this.url+"/appCfg",o,function(o){if(!o.data)return console.error(o.errMsg),void(t&&t(null));var i=JSON.parse(o.data);if(0==i.code){e.taskdatas=i.data;var n=e.getTaskData();t&&t(n)}else console.error(o.data),t&&t(null)})}else t&&t(null)},t.prototype.sendTask=function(t,e){var o=this;if(this.iLog("\u5f00\u59cb\u53d1\u9001\u4efb\u52a1"),1==this.type)return this.isInit||this.init(),this.getIsSend(t)?(console.error("\u5df2\u7ecf\u53d1\u9001\u8fc7\u4e86"),void(e&&e(!0))):this.checkCanSend()?void this.getOpenId(function(){var i={appId:o.appId,openId:o.openId,cardId:t,platformId:o.platformId};o.ttRequest(o.url+"/addUser",i,function(i){if(!i.data)return console.error(i.errMsg),void(e&&e(!1));var n=JSON.parse(i.data);0==n.code?(o.iLog("\u53d1\u9001\u4efb\u52a1\u6210\u529f\uff1a",t),localStorage.setItem(l.uid_key,n.data),o.uid=n.data,o.addTaskCardId(t),e&&e(!0)):(console.error(i.data),e&&e(!1))})}):(console.error("\u4e0d\u662f\u5bf9\u5e94\u7684\u5e73\u53f0"),void(e&&e(!1)));e&&e(null)},t.prototype.getTaskData=function(){if(this.datas.length>0)return this.datas;for(var t=0;t<this.taskdatas.length;t++){var e=this.taskdatas[t];-1!=e.platform.indexOf(this.platformId+"")&&this.datas.push(e)}return this.datas},t.prototype.getTaskDataById=function(t){for(var e=0;e<this.taskdatas.length;e++){var o=this.taskdatas[e];if(o.id==t)return o}return null},t.prototype.getTaskDataConditions=function(t){for(var e=0;e<this.taskdatas.length;e++){var o=this.taskdatas[e];if(o.conditions==t)return o}return null},t.prototype.getOpenId=function(t){var e=this,o=this,i=localStorage.getItem(l.openId);return i?(this.openId=i,void(t&&t(this.openId))):this.uid?(this.openId=this.uid,void(t&&t(this.openId))):void tt.login({force:!1,success:function(i){if(i.code){var n=localStorage.getItem(l.openId);if(o.openId=n,n&&""!=n)t&&t(o.openId);else{var a={code:i.code,appId:e.appId};o.ttRequest(o.url+"/getOpenId",a,function(e){if(!e.data)return console.error(e.errMsg),void(t&&t(null));var i=JSON.parse(e.data);0==i.code?(o.openId=i.data.openid,localStorage.setItem(l.openId,o.openId),t&&t(o.openId)):(console.error(e.data),t&&t(null))})}}else t&&t(null)},fail:function(e){console.error(e.errMsg),t&&t(!1)}})},t.prototype.ttRequest=function(t,e,o){tt.request({url:t,data:e,header:{"content-type":"application/json"},dataType:"JSON",responseType:"text",success:function(t){o(t)},fail:function(t){o(t)}})},t.prototype.wxRequest=function(t,e,o){wx.request({url:t,data:e,header:{"content-type":"application/json"},dataType:"JSON",responseType:"text",success:function(t){o(t)},fail:function(t){o(t)}})},t.prototype.getIsSend=function(t){var e=localStorage.getItem(l.taskSend);if(e){var o=e.split("_");if(o[0]==this.getTimeDay()&&o[1]&&-1!=o[1].indexOf(t+""))return!0}return!1},t.prototype.addTaskCardId=function(t){var e=localStorage.getItem(l.taskSend);if(null==e)localStorage.setItem(l.taskSend,this.getTimeDay()+"_"+t);else{var o=e.split("_");localStorage.setItem(l.taskSend,this.getTimeDay()+"_"+o[1]+","+t)}},t.prototype.iLog=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log("SF_FeedCard_subject:",t)},t.prototype.getTimeDay=function(){var t=new Date,e=t.getFullYear(),o=t.getMonth()+1,i=t.getDate(),n=o+"",a=i+"";return o>=1&&o<=9&&(n="0"+o),i>=0&&i<=9&&(a="0"+i),e+"-"+n+"-"+a},Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t}();a.FeedCardMgr=c,a.TaskData=function(){};var l=function(){function t(){}return t.openId="igame_openId",t.uid_key="igame_server_uid",t.taskSend="igame_task",t}();cc._RF.pop(),cc._RF.pop()},{}],GADGameData:[function(t,e,o){"use strict";cc._RF.push(e,"8abecKO4oJCxomho6JgkI/p","GADGameData");var i=e,n=o;cc._RF.push(i,"8abecKO4oJCxomho6JgkI/p","GADGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emGADGameDataKeys=void 0,function(t){t.basicCfg="basicCfg",t.enemyCfg="enemyCfg",t.levelCfg="levelCfg",t.buffTypeCfg="buffTypeCfg",t.bubbleCfg="bubbleCfg",t.memberCfg="memberCfg"}(n.emGADGameDataKeys||(n.emGADGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],GADGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"da7e4qq4vVJb4OKtNTji5/V","GADGameEnumData");var i=e,n=o;cc._RF.push(i,"da7e4qq4vVJb4OKtNTji5/V","GADGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumGADBuffTypeCfg=n.enumGADBasicCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicbullet=2]="basicbullet",t[t.basicHP=3]="basicHP",t[t.moveSpeed=4]="moveSpeed",t[t.roundDistance=5]="roundDistance",t[t.swordFlySpeed=6]="swordFlySpeed",t[t.sideRoadSpeed=7]="sideRoadSpeed",t[t.swordFLlyDistance=8]="swordFLlyDistance",t[t.memberLimit=9]="memberLimit",t[t.WallWidth=10]="WallWidth",t[t.EnemyFixedWidth=11]="EnemyFixedWidth",t[t.SpeedAdditionSegs=12]="SpeedAdditionSegs",t[t.BulletSpace=13]="BulletSpace",t[t.width=14]="width",t[t.maxWidth=15]="maxWidth",t[t.minimumWidth=16]="minimumWidth",t[t.IntervalTime=17]="IntervalTime",t[t.bulletLimit=18]="bulletLimit",t[t.bulletChange=19]="bulletChange",t[t.speedLimit=20]="speedLimit",t[t.MaxLevel=21]="MaxLevel"}(n.enumGADBasicCfg||(n.enumGADBasicCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.memberPlus="memberPlus",t.memberSub="memberSub",t.HPplus="HPplus",t.HPsub="HPsub",t.levelPlus="levelPlus",t.levelSub="levelSub",t.speedMultiply="speedMultiply",t.speedDivision="speedDivision",t.ATKMultiply="ATKMultiply",t.ATKDivision="ATKDivision"}(n.enumGADBuffTypeCfg||(n.enumGADBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],GAD_App:[function(t,e,o){"use strict";cc._RF.push(e,"fb85dLmj/NLx5yLz92Kvds3","GAD_App");var i=t,n=e,a=o;cc._RF.push(n,"fb85dLmj/NLx5yLz92Kvds3","GAD_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("GAD_Configs"),p=i("GAD_DataMgr"),u=i("GAD_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e){var o=this;this.addTouchEvent(),this._exitCall=e;var i=function(){o._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.GAD_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),o.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.GAD_AudioId.Levels,l.GADConfig.BgMusic)})};this._isInited?i():(s.UIMgr.getInstance().addUICnf(l.GAD_UICF),r.AudioMgr.getInstance().addAdConf(l.GAD_AudioCF),p.default.getInstance().load(function(){p.default.getInstance().initCfgData(),u.default.getInstance().preload(function(){i()})}))},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.GAD_UIID.UIGame),s.UIMgr.getInstance().closeById(l.GAD_UIID.UIResult),s.UIMgr.getInstance().closeById(l.GAD_UIID.UISetting),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=999999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],GAD_Base:[function(t,e,o){"use strict";cc._RF.push(e,"b4cd7q+iUtPfbQrPF8kuXLN","GAD_Base");var i=t,n=e,a=o;cc._RF.push(n,"b4cd7q+iUtPfbQrPF8kuXLN","GAD_Base");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("GAD_Configs"),u=i("GADGameEnumData"),d=i("GAD_DataMgr"),h=i("GAD_PlayerMgr"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderGroups=[],e._groupID=0,e._moveSpeed=100,e._maxSpeed=100,e._va=0,e._state=p.emGADRoleState.None,e._tagID=0,e._colliderTags=[],e}return s(e,t),Object.defineProperty(e.prototype,"isDie",{get:function(){return this._state==p.emGADRoleState.Die},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIdle",{get:function(){return this._state==p.emGADRoleState.Idle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMove",{get:function(){return this._state==p.emGADRoleState.Move},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAttack",{get:function(){return this._state==p.emGADRoleState.Attack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUseful",{get:function(){return this._state!=p.emGADRoleState.None&&this._state!=p.emGADRoleState.Die},enumerable:!1,configurable:!0}),e.prototype.initTagID=function(){this._tagID=h.default.getInstance().getTagID()},e.prototype.getGroupID=function(){return this._groupID},e.prototype.getTagID=function(){return this._tagID},e.prototype.setGroupID=function(t){this._groupID=t},e.prototype.addColliderTagID=function(t){this._colliderTags.push(t)},e.prototype.hasColliderTagID=function(t){return-1!=this._colliderTags.indexOf(t)},e.prototype.addColliderGroupID=function(t){this._colliderGroups.push(t)},e.prototype.getRoleType=function(){return this._roleType},e.prototype.hasColliderGroupID=function(t){return-1!=this._colliderGroups.indexOf(t)},e.prototype.updatePos=function(t){this.node.y-=t*this._moveSpeed,this.node.zIndex=2e3-this.node.y},e.prototype.changeSpeed=function(){var t=d.default.getInstance().getParam(u.enumGADBasicCfg.SpeedAdditionSegs,[]);if(t&&0!=t.length)for(var e=Math.abs(this.node.y-.5*cc.winSize.height)/cc.winSize.height,o=t.length-1;o>=0;o--)if(e>=t[o][0]){this._maxSpeed=t[o][1],this._va=t[o][2];break}},e.prototype.canRemoveScreen=function(){return this.node.y<.5*-cc.winSize.height-this.node.height*this.node.scaleY-20},e.prototype.getSize=function(){return this.node.getContentSize()},e.prototype.getScaleSize=function(){var t=this.getSize();return cc.size(t.width*this.node.scaleX,t.height*this.node.scaleY)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.getWorldColliderRectWithFixed=function(t,e){var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position);return t=t||this.node.width*this.node.scaleX,e=e||this.node.height*this.node.scaleY,cc.rect(i.x-o.x*t,i.y-o.y*e,t,e)},e.prototype.setRoleState=function(t){this._state=t},e.prototype.bulletHited=function(){return 0},e.prototype.removeFromScreen=function(){},e.prototype.getWorldPos=function(t){return this.node.convertToWorldSpaceAR(t)},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],GAD_Bubble:[function(t,e,o){"use strict";cc._RF.push(e,"426c43AwctCzZPD41BC1vTx","GAD_Bubble");var i=t,n=e,a=o;cc._RF.push(n,"426c43AwctCzZPD41BC1vTx","GAD_Bubble");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("GAD_Configs"),p=i("GAD_Base"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.icon=null,e._cardID=0,e._cfg=null,e}return s(e,t),e.prototype.setCardID=function(t){this._cardID=t},e.prototype.getCardID=function(){return this._cardID},e.prototype.start=function(){var t=this;this.node.active=!0,this._cardID>0?this.loadSpriteFrame(l.emGADBundles.imgs,"js_b/tx_"+this._cardID,function(e){t.icon.spriteFrame=e}):this.loadSpriteFrame(l.emGADBundles.imgs,"bubbles/"+this._cfg.resName,function(e){t.icon.spriteFrame=e}),this.text.string="+"+this._cfg.buffPara},e.prototype.init=function(t,e){this.initTagID(),this._cfg=t,this._cardID=e},e.prototype.getCfg=function(){return this._cfg},c([h(cc.Label)],e.prototype,"text",void 0),c([h(cc.Sprite)],e.prototype,"icon",void 0),c([d],e)}(p.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],GAD_BuffTips:[function(t,e,o){"use strict";cc._RF.push(e,"50c99Gr1HZCbrHnKCh7mPDw","GAD_BuffTips");var i=t,n=e,a=o;cc._RF.push(n,"50c99Gr1HZCbrHnKCh7mPDw","GAD_BuffTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("GAD_DataMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffImgs=[],e}return s(e,t),e.prototype.start=function(){},e.prototype.getImg=function(t){for(var e=0;e<this.buffImgs.length;e++)if(this.buffImgs[e].name==t)return this.buffImgs[e];return null},e.prototype.show=function(t){var e=this,o=u.default.getInstance().getBuffTypeCfg(t);this.node.getComponent(cc.Sprite).spriteFrame=this.getImg(o.buffImage),this.node.opacity=0,this.node.active=!0,this.node.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(1),cc.fadeOut(.2),cc.callFunc(function(){e.node.active=!1,p.PoolMgr.getInstance().freeNode("pbt_buff_img",e.node)})))},c([f([cc.SpriteFrame])],e.prototype,"buffImgs",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],GAD_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"7192744fWNEvKUOudo6hxGH","GAD_BulletEffect");var i=e,n=o;cc._RF.push(i,"7192744fWNEvKUOudo6hxGH","GAD_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],GAD_Bullet:[function(t,e,o){"use strict";cc._RF.push(e,"0a7a7UYMUhK/r9xZdhcFN/r","GAD_Bullet");var i=t,n=e,a=o;cc._RF.push(n,"0a7a7UYMUhK/r9xZdhcFN/r","GAD_Bullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("GAD_Configs"),p=i("GADGameEnumData"),u=i("GAD_DataMgr"),d=i("GAD_PlayerMgr"),h=i("GAD_Base"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spIcon=null,e._flyDis=0,e._hideDis=0,e._atkDamage=0,e._cfg=null,e}return s(e,t),e.prototype.start=function(){var t=this;this.loadPrefab(l.emGADBundles.prefabs,"bullets/PBT_Bullet_"+this._cfg.id,function(e){var o=cc.instantiate(e);o.parent=t.node,o.setPosition(0,0)}),this.setRoleState(l.emGADRoleState.Move)},e.prototype.init=function(t,e){this.initTagID(),this._atkDamage=e,this._roleType=l.emGADRoleType.Bullet,this._cfg=t,this._moveSpeed=u.default.getInstance().getParam(p.enumGADBasicCfg.swordFlySpeed,300),this._maxSpeed=this._moveSpeed,this._hideDis=u.default.getInstance().getParam(p.enumGADBasicCfg.swordFLlyDistance,300),this._flyDis=0},e.prototype.checkAutoDie=function(){return this._flyDis>=this._hideDis},e.prototype.update=function(t){this.isUseful&&d.default.getInstance().getState()==l.emGADGameState.Game&&(t=Math.min(t,.02),this.node.y+=this._moveSpeed*t,this._flyDis+=this._moveSpeed*t)},e.prototype.onDie=function(){var t=this;this.setRoleState(l.emGADRoleState.Die),cc.tween(this.node).to(.1,{opacity:0}).call(function(){t.node.destroy()}).start()},e.prototype.removeFromScreen=function(){this.setRoleState(l.emGADRoleState.Die),this.node.destroy()},e.prototype.getAtkDamage=function(){return this._atkDamage},c([g(cc.Sprite)],e.prototype,"spIcon",void 0),c([m],e)}(h.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],GAD_CardItem:[function(t,e,o){"use strict";cc._RF.push(e,"c9b92IcY/lA34PU/T5mUpAa","GAD_CardItem");var i=t,n=e,a=o;cc._RF.push(n,"c9b92IcY/lA34PU/T5mUpAa","GAD_CardItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("GAD_Configs"),p=i("GAD_Base"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBg=null,e.spRoleIcon=null,e.lblName=null,e.spBar=null,e.bgImgs=[],e.lblLv=null,e._cfg=null,e._atkDamage=0,e._lv=1,e.OFF_Y=30,e.SPEED=500,e}return s(e,t),e.prototype.init=function(t){this.initTagID(),this._cfg=t,this.initView(),this._lv=1,this._atkDamage=this._cfg.basicATK,this.updateLv()},e.prototype.hideView=function(){this.node.active=!1},e.prototype.getCardCfg=function(){return this._cfg},e.prototype.initView=function(){var t=this;this.lblName.string=this._cfg.name,this.loadSpriteFrame(l.emGADBundles.imgs,"js/"+this._cfg.icon,function(e){t.spRoleIcon.spriteFrame=e})},e.prototype.refreshHpBar=function(t){this.spBar.fillRange=t},e.prototype.playAttack=function(t,e,o){this.sendEvent(l.emGADEventName.GAD_Shoot_Bullet,t,o||this.node.convertToWorldSpaceAR(cc.v2(0,.35*this.node.height)),this)},e.prototype.start=function(){this.ndBg.getComponent(cc.Sprite).spriteFrame=this.bgImgs[this._cfg.quality-1]},e.prototype.updateLv=function(){this.lblLv.string=this._lv.toString()},e.prototype.addLev=function(t){if(this._lv>=this._cfg.cardLevel)return!1;this._lv+=t,this._atkDamage+=this._cfg.cardATK,this.updateLv()},e.prototype.getAtkDamage=function(t){var e=t+this._atkDamage;return e<0?0:e},c([h(cc.Node)],e.prototype,"ndBg",void 0),c([h(cc.Sprite)],e.prototype,"spRoleIcon",void 0),c([h(cc.Label)],e.prototype,"lblName",void 0),c([h(cc.Sprite)],e.prototype,"spBar",void 0),c([h([cc.SpriteFrame])],e.prototype,"bgImgs",void 0),c([h(cc.Label)],e.prototype,"lblLv",void 0),c([d],e)}(p.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],GAD_Cards:[function(t,e,o){"use strict";cc._RF.push(e,"e02ea3cU8dDQIkbfrzWHsRt","GAD_Cards");var i=t,n=e,a=o;cc._RF.push(n,"e02ea3cU8dDQIkbfrzWHsRt","GAD_Cards");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("GAD_Configs"),u=i("GADGameEnumData"),d=i("GAD_DataMgr"),h=i("GAD_PlayerMgr"),f=i("GAD_Base"),m=i("GAD_CardItem"),g=cc._decorator,y=g.ccclass,v=g.property,_=[cc.v2(-67,-90),cc.v2(67,-90),cc.v2(-67,-220),cc.v2(67,-220),cc.v2(-67,-350),cc.v2(67,-350)],b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefabCarItem=null,e.ndCardRoot=null,e.spPropName=null,e.lblHP=null,e.spBr=null,e.ndRoot=null,e.maxHp=100,e.hp=100,e.atkCDInterval=1e3,e.atkCD=1e3,e.cdParam=0,e.atkDamage=0,e.maxBulletCnt=6,e.bulletLimit=6,e._edge={left:1e4,right:-1e4,top:-2e4,bottom:2e4},e._cards=[],e._RangeType=2,e._isAttacking=!1,e.OFF_Y=30,e.SPEED=500,e}return s(e,t),e.prototype.setMaxHp=function(t,e){this.maxHp=t,e&&(this.hp=this.maxHp),this.refreshBar()},e.prototype.refreshBar=function(){var t=Math.min(1,Math.max(0,this.hp/this.maxHp));this.spBr.fillRange=t,this.lblHP.string=""+Math.floor(this.hp)},e.prototype.onLoad=function(){this.initTagID()},e.prototype.start=function(){0==this._RangeType?this.node.y=.5*-cc.winSize.height+15:2==this._RangeType&&(this.node.y=.5*-cc.winSize.height+p.GADConfig.BottomHeight-70),this.maxBulletCnt=d.default.getInstance().getParam(u.enumGADBasicCfg.bulletLimit,6),this.bulletLimit=d.default.getInstance().getParam(u.enumGADBasicCfg.memberLimit,6);var t=d.default.getInstance().getParam(u.enumGADBasicCfg.basicbullet,1);this.addMember(t),this.atkDamage=this._cards[0].getCardCfg().basicATK,this.setMaxHp(d.default.getInstance().getParam(u.enumGADBasicCfg.basicHP,20),!0);var e=d.default.getInstance().getParam(u.enumGADBasicCfg.basicASPD,1);this.atkCDInterval=e,this.atkCD=this.atkCDInterval,this.setRoleState(p.emGADRoleState.Idle)},e.prototype.addMember=function(t){void 0===t&&(t=1);for(var e=0;e<t;e++){if(this.ndCardRoot.children.length>=this.maxBulletCnt)return;var o=this.randomMemberCard();o&&this.addCardItem(o)}},e.prototype.subMember=function(t){void 0===t&&(t=1);for(var e=0;e<t;e++){if(this._cards.length<=1)return;var o=this._cards.pop();if(h.default.getInstance().removeCard(o.getCardCfg().id),o.node.destroy(),this._cards.length<=this.bulletLimit){var i=this.ndCardRoot.getComponent(cc.Layout);i.resizeMode=cc.Layout.ResizeMode.CONTAINER,i.updateLayout()}}},e.prototype.addCardItem=function(t){if(!this.checkIsExit(t.id)){var e=cc.instantiate(this.prefabCarItem);e.parent=this.ndCardRoot;var o=e.getComponent(m.default);if(this._cards.push(o),o.init(t),this._cards.length>this.bulletLimit){this.ndCardRoot.setContentSize(514,200);var i=this.ndCardRoot.getComponent(cc.Layout);i.resizeMode=cc.Layout.ResizeMode.CHILDREN,i.updateLayout()}h.default.getInstance().addCard(t.id),e.y=-100,this.refreshBar()}},e.prototype.updateSizePos=function(){this._edge={left:1e4,right:-1e4,top:-2e4,bottom:2e4};var t=this.ndCardRoot;if(2==this._RangeType)for(var e=0;e<this._cards.length;e++)this._cards[e].node.setPosition(_[e]);else{var o=t.children.length;if(1==o){var i=t.children[0];0==this._RangeType?i.setPosition(0,.5*i.height):i.setPosition(0,.5*-i.height)}else{var n=0;for(e=0;e<3;e++){for(var a=0;a<2;a++){var r=this._cards[n].node,s=(.5*r.width+3)*(a%2==0?-1:1),c=0;if(0==this._RangeType?(c=.5*r.height+(r.height-50)*e,r.zIndex=10-e):(c=-(.5*r.height+(r.height-50)*e),r.zIndex=e),r.setPosition(s,c),++n>=o)break}if(n>=o)break}}}this.updateEdge(),this.updateEdgePos(),1==this._RangeType&&(this.node.y=.5*-cc.winSize.height+Math.abs(this._edge.top-this._edge.bottom)+15)},e.prototype.updateEdgePos=function(){if(2==this._RangeType){var t=.5*this.ndCardRoot.width;this.node.x+t>p.GADConfig.WallWidth?this.node.x=p.GADConfig.WallWidth-t:this.node.x-t<-p.GADConfig.WallWidth&&(this.node.x=-p.GADConfig.WallWidth+t)}else{var e=Math.abs(.5*Math.abs(this._edge.right-this._edge.left));this.node.x+e>p.GADConfig.WallWidth&&(this.node.x=p.GADConfig.WallWidth-e),this.node.x-e<-p.GADConfig.WallWidth&&(this.node.x=-p.GADConfig.WallWidth+e)}},e.prototype.updateEdge=function(){for(var t=0;t<this._cards.length;t++){var e=this._cards[t].node,o=.5*e.width,i=.5*e.height;e.x-o<this._edge.left&&(this._edge.left=e.x-o),e.x+o>this._edge.right&&(this._edge.right=e.x+o),e.y-i<this._edge.bottom&&(this._edge.bottom=e.y-i),e.y+i>this._edge.top&&(this._edge.top=e.y+i)}},e.prototype.checkIsExit=function(t){for(var e=0;e<this._cards.length;e++)if(this._cards[e].getCardCfg().id==t)return!0;return!1},e.prototype.randomMemberCard=function(){for(var t=d.default.getInstance().getAllMembers(),e=[],o=0;o<t.length;o++)this.checkIsExit(t[o].id)||e.push(t[o]);return e.length>0?e[Math.floor(Math.random()*e.length)]:null},e.prototype.showPropTips=function(){},e.prototype.getCDParam=function(){return Math.max(1+this.cdParam,1)},e.prototype.updateCD=function(t){this.atkCD-=t*this.getCDParam(),this.atkCD<=0&&(this._isAttacking||(this.atkCD=this.atkCDInterval,this.playAttack()))},e.prototype.playAttack=function(){this._isAttacking=!0;var t=h.default.getInstance().getGroupID();l.AudioMgr.getInstance().playEffectFree(p.GAD_AudioId.attack2);for(var e=Math.min(1,1/this.getCDParam()),o=this._cards.length,i=d.default.getInstance().getParam(u.enumGADBasicCfg.BulletSpace,10),n=.5*-(25*o+i*(o-1)),a=0;a<o;a++){var r=void 0;if(o>1){var s=n+12.5+(25+i)*a;r=this.node.convertToWorldSpaceAR(cc.v2(s,-10))}this._cards[a].playAttack(t,e,r)}this.ndRoot.stopAllActions();var c=this.OFF_Y-this.ndRoot.y;cc.tween(this.ndRoot).to(c/this.SPEED/e,{y:this.OFF_Y}).to(this.OFF_Y/this.SPEED/e,{y:0}).start(),this._isAttacking=!1},e.prototype.checkCollider=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);for(var i=this.ndCardRoot.children.length-1;i>=0;i--){var n=this.ndCardRoot.children[i].getComponent(m.default);if(n.getWorldColldierRect(e,o).intersects(t.getWorldColliderRectWithFixed()))return n}return null},e.prototype.addCardLev=function(t,e){for(var o=0;o<this._cards.length;o++)if(this._cards[o].getCardCfg().id==t)return l.AudioMgr.getInstance().playEffectFree(p.GAD_AudioId.Cards),this._cards[o].addLev(e),this.atkDamage+=this._cards[o].getCardCfg().cardATK,!0;return!1},e.prototype.addAtkDamage=function(t){this.atkDamage+=t,this.atkDamage=Math.max(1,this.atkDamage)},e.prototype.getAtkDamage=function(){return this.atkDamage},e.prototype.addBuff=function(t,e){var o=!0;switch(t){case u.enumGADBuffTypeCfg.SpeedPlus:this.cdParam+=e;break;case u.enumGADBuffTypeCfg.SpeedSub:this.cdParam-=e;break;case u.enumGADBuffTypeCfg.ATKplus:this.addAtkDamage(e||0);break;case u.enumGADBuffTypeCfg.ATKsub:this.addAtkDamage(0-(e||0));break;case u.enumGADBuffTypeCfg.memberPlus:this.addMember(Math.max(0,Math.floor(e)));break;case u.enumGADBuffTypeCfg.memberSub:this.subMember(Math.max(0,Math.floor(e)));break;case u.enumGADBuffTypeCfg.HPplus:this.maxHp+=e,this.hp=Math.max(0,Math.min(this.hp+e,this.maxHp)),this.showHpTips(e),this.refreshBar();break;case u.enumGADBuffTypeCfg.HPsub:this.maxHp-=e;var i=this.hp;this.hp=Math.max(0,Math.min(this.hp-e,this.maxHp)),this.hp<=0&&(this.hp=1,e=i-this.hp),e>0&&this.showHpTips(-e),this.refreshBar();break;case u.enumGADBuffTypeCfg.speedMultiply:this.cdParam=(0==this.cdParam?1:this.cdParam)*e;break;case u.enumGADBuffTypeCfg.speedDivision:0!=e&&(this.cdParam/=e);break;case u.enumGADBuffTypeCfg.ATKMultiply:this.atkDamage*=e,this.atkDamage=Math.max(1,this.atkDamage);break;case u.enumGADBuffTypeCfg.ATKDivision:0!=e&&(this.atkDamage/=e),this.atkDamage=Math.max(1,this.atkDamage);break;default:o=!1}o&&(l.AudioMgr.getInstance().playEffectFree(p.GAD_AudioId.Cards),this.showPropTips(t))},e.prototype.enermyHit=function(t){this.hp-=t;var e=p.emGADHitState.None;return this.hp<=0?(this.hp=0,e=p.emGADHitState.HitDie,this.sendEvent(p.emGADEventName.GAD_Player_Die)):(e=p.emGADHitState.HitHurt,this.sendEvent(p.emGADEventName.GAD_Show_Warn)),this.showHpTips(-t),this.refreshBar(),e},e.prototype.showHpTips=function(t){this.sendEvent(p.emGADEventName.GAD_Show_Hit_Text,t,this.getWorldPos(cc.v2(0,this._edge.top)))},e.prototype.getCardItem=function(t){for(var e=0;e<this._cards.length;e++)if(this._cards[e].getCardCfg().id==t)return this._cards[e];return null},c([v(cc.Prefab)],e.prototype,"prefabCarItem",void 0),c([v(cc.Node)],e.prototype,"ndCardRoot",void 0),c([v(cc.Sprite)],e.prototype,"spPropName",void 0),c([v(cc.Label)],e.prototype,"lblHP",void 0),c([v(cc.Sprite)],e.prototype,"spBr",void 0),c([v(cc.Node)],e.prototype,"ndRoot",void 0),c([y],e)}(f.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],GAD_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"9284cxjnAJDLL92zrwvgKpT","GAD_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"9284cxjnAJDLL92zrwvgKpT","GAD_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.emGADHitState=l.emGADGameState=l.emGADRoleState=l.emGADRoleType=l.emGADEventName=l.GAD_AudioCF=l.GAD_AudioId=l.GAD_UICF=l.GADConfig=l.emGADBundles=l.GAD_UIID=void 0,function(t){t.UIGame="GAD_UIGame",t.UIResult="GAD_UIResult",t.UISetting="GAD_UISetting"}(a=l.GAD_UIID||(l.GAD_UIID={})),function(t){t.prefabs="gad_prefabs",t.audios="gad_audios",t.imgs="gad_imgs",t.configs="gad_configs"}(r=l.emGADBundles||(l.emGADBundles={})),l.GADConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.GAD_UICF=((i={})[a.UIGame]={prefab:"ui/GAD_UIGame",name:"GAD_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/GAD_UIResult",name:"GAD_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/GAD_UISetting",name:"GAD_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.Levels="GAD_Levels",t.Cards="GAD_Cards",t.fail="GAD_fail",t.attack2="GAD_attack2",t.victory="GAD_victory",t.strike="GAD_strike"}(s=l.GAD_AudioId||(l.GAD_AudioId={})),l.GAD_AudioCF=((n={})[s.Levels]={path:"Levels",bundle:r.audios},n[s.Cards]={path:"Cards",bundle:r.audios},n[s.victory]={path:"victory",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.attack2]={path:"attack2",bundle:r.audios},n[s.strike]={path:"strike",bundle:r.audios},n),function(t){t.GAD_Player_Die="gad_player_die",t.GAD_Shoot_Bullet="gad_shoot_bullet",t.GAD_Show_Hit_Text="gad_show_hit_text",t.GAD_Show_Warn="gad_show_warn",t.GAD_Bubble_Buf="gad_add_bubble_buf",t.GAD_Show_Hit_Effect="gad_hit_effect",t.GAD_Show_Buff_Tip="gad_show_buff_tip",t.GAD_Setting_Back="gad_setting_back"}(l.emGADEventName||(l.emGADEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emGADRoleType||(l.emGADRoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emGADRoleState||(l.emGADRoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emGADGameState||(l.emGADGameState={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emGADHitState||(l.emGADHitState={})),cc._RF.pop(),cc._RF.pop()},{}],GAD_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"63040Bi7wFHOpvrlOPhvmm3","GAD_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"63040Bi7wFHOpvrlOPhvmm3","GAD_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("GAD_Configs"),d=i("GADGameEnumData"),h=cc._decorator,f=h.ccclass,m=(h.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t){var e=this,o=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var i=this.getUrlParam("isRemote");i&&"1"==i&&(o=!0)}o?c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"xinhhui/BraveTower/configs2",fileName:"GameJsonCfg.json"},function(o,i){if(o&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(e.data=JSON.parse(n.data),console.log(e.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emGADBundles.configs,"GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.initCfgData=function(){u.GADConfig.WallWidth=.5*this.getParam(d.enumGADBasicCfg.WallWidth,750),u.GADConfig.EnemyFixedWidth=this.getParam(d.enumGADBasicCfg.EnemyFixedWidth,188)},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicCfg[t]?this.data.basicCfg[t].para:e},t.prototype.getAllMembers=function(){return this.data.memberCfg},t.prototype.getWaveCfgs=function(t){return this.data["levelCfg_"+t]||this.data.levelCfg_1},t.prototype.isBuffType=function(t){for(var e=0;e<this.data.buffTypeCfg.length;e++)if(this.data.buffTypeCfg[e].buffType==t)return!0;return!1},t.prototype.getBuffTypeCfg=function(t){for(var e=0;e<this.data.buffTypeCfg.length;e++)if(this.data.buffTypeCfg[e].buffType==t)return this.data.buffTypeCfg[e];return null},t.prototype.getBubbleCfg=function(t){for(var e=0;e<this.data.bubbleCfg.length;e++)if(this.data.bubbleCfg[e].typeBubble==t)return this.data.bubbleCfg[e];return null},t.prototype.getEnemyCfg=function(t){for(var e=0;e<this.data.enemyCfg.length;e++)if(this.data.enemyCfg[e].id==t)return this.data.enemyCfg[e];return null},e=r([f],t)}());a.default=m,cc._RF.pop(),cc._RF.pop()},{}],GAD_Door:[function(t,e,o){"use strict";cc._RF.push(e,"e4f3eiME6VMb6LnQSQRrpfw","GAD_Door");var i=t,n=e,a=o;cc._RF.push(n,"e4f3eiME6VMb6LnQSQRrpfw","GAD_Door");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("Utils"),u=i("GAD_Configs"),d=i("GADGameEnumData"),h=i("GAD_DataMgr"),f=i("GAD_Base"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.door=null,e.skeHitEffect=null,e.doorImgs=[],e.nd_bl=null,e.ndLeft=null,e.ndRight=null,e._hitEffectValue=0,e._maxWidth=500,e._minWidth=100,e._DoorEdge=0,e._coolTime=-1,e._targetWidth=300,e._step=0,e}return s(e,t),e.prototype.onLoad=function(){this._roleType=u.emGADRoleType.Door},e.prototype.getBufType=function(){return this._bufType},e.prototype.getValue=function(){return this._value},e.prototype.start=function(){this.setRoleState(u.emGADRoleState.Move)},e.prototype.init=function(t,e){this.initTagID(),this._moveSpeed=h.default.getInstance().getParam(d.enumGADBasicCfg.moveSpeed),this._maxSpeed=this._moveSpeed,this._roleType=u.emGADRoleType.Door,this._originPos=this.node.position.clone(),this.setRoleState(u.emGADRoleState.Move),this._bufType=t,this._initBuffCfg(e),this._targetWidth=300,this._step=0,this._minWidth=h.default.getInstance().getParam(d.enumGADBasicCfg.minimumWidth,100),this._maxWidth=h.default.getInstance().getParam(d.enumGADBasicCfg.maxWidth,500),this.node.x>0?this._DoorEdge=this.node.x+.5*this._targetWidth:this.node.x<0&&(this._DoorEdge=this.node.x-.5*this._targetWidth)},e.prototype.resetSize=function(t){this._targetWidth=t,this._step=0,this.node.width=t,this.ndLeft.x=.5*-this.node.width+.5*this.ndLeft.width,this.ndRight.x=.5*this.node.width-.5*this.ndRight.width,this.nd_bl.width=this.node.width-20,this.node.x>0?this._DoorEdge=this.node.x+.5*this._targetWidth:this.node.x<0&&(this._DoorEdge=this.node.x-.5*this._targetWidth)},e.prototype._initBuffCfg=function(t){var e,o,i,n;this._value=t,this._cfg=h.default.getInstance().getBuffTypeCfg(this._bufType),0==this._hitEffectValue&&(this._hitEffectValue=(null===(e=this._cfg)||void 0===e?void 0:e.hitEffect)||0),this._cfg&&(this.text.node.color="red"==(null===(o=this._cfg)||void 0===o?void 0:o.color)?cc.color().fromHEX("#ff4e49"):cc.color().fromHEX("#ffffff"),this.door.spriteFrame=this.doorImgs["red"==(null===(i=this._cfg)||void 0===i?void 0:i.color)?1:0],this.text.string=p.Utils.StringFormat((null===(n=this._cfg)||void 0===n?void 0:n.buffWord)||"",this.accurateNum(this._value,1)))},e.prototype.accurateNum=function(t,e){return t.toFixed(e)-0},e.prototype.update=function(t){this._coolTime-=t,0!=this._step&&this.updateWidth(this._step)},e.prototype.bulletHited=function(t){if(this._coolTime>0)return u.emGADHitState.NoHurt;if(!this.isUseful||!this.node.active||this.hasColliderGroupID(t.getGroupID()))return u.emGADHitState.None;if(l.AudioMgr.getInstance().playEffectFree(u.GAD_AudioId.strike),this._coolTime=h.default.getInstance().getParam(d.enumGADBasicCfg.IntervalTime,.1),this.addColliderTagID(t.getTagID()),this.addColliderGroupID(t.getGroupID()),[d.enumGADBuffTypeCfg.SpeedPlus,d.enumGADBuffTypeCfg.ATKplus,d.enumGADBuffTypeCfg.HPplus,d.enumGADBuffTypeCfg.memberPlus,d.enumGADBuffTypeCfg.levelPlus,d.enumGADBuffTypeCfg.speedMultiply,d.enumGADBuffTypeCfg.ATKMultiply].indexOf(this._bufType)>=0)if(this._value=this._value+this._hitEffectValue,d.enumGADBuffTypeCfg.memberPlus==this._bufType){var e=h.default.getInstance().getParam(d.enumGADBasicCfg.bulletChange);this._value>e&&(this._value=e)}else d.enumGADBuffTypeCfg.speedMultiply!=this._bufType&&d.enumGADBuffTypeCfg.SpeedPlus!=this._bufType||(e=h.default.getInstance().getParam(d.enumGADBasicCfg.speedLimit),this._value>e&&(this._value=e));else switch(this._value=this._value-this._hitEffectValue,this._bufType){case d.enumGADBuffTypeCfg.SpeedSub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumGADBuffTypeCfg.SpeedPlus);break;case d.enumGADBuffTypeCfg.ATKsub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumGADBuffTypeCfg.ATKplus);break;case d.enumGADBuffTypeCfg.HPsub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumGADBuffTypeCfg.HPplus);break;case d.enumGADBuffTypeCfg.memberSub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumGADBuffTypeCfg.memberPlus);break;case d.enumGADBuffTypeCfg.levelSub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumGADBuffTypeCfg.levelPlus);break;case d.enumGADBuffTypeCfg.speedDivision:this._value<=0&&(this._value=this._hitEffectValue,this._value=Math.abs(this._value),this._bufType=d.enumGADBuffTypeCfg.speedMultiply);break;case d.enumGADBuffTypeCfg.ATKDivision:this._value<=0&&(this._value=this._hitEffectValue,this._value=Math.abs(this._value),this._bufType=d.enumGADBuffTypeCfg.ATKMultiply)}return this._initBuffCfg(this._value),u.emGADHitState.HitHurt},e.prototype.removeFromScreen=function(){this.node.destroy()},e.prototype.onDie=function(){var t=this;this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){t.removeFromScreen()})))},e.prototype.scaleWidth=function(t){this._targetWidth+=t,this._targetWidth>this._maxWidth?this._targetWidth=this._maxWidth:this._targetWidth<this._minWidth&&(this._targetWidth=this._minWidth),this._step=(this._targetWidth-this.node.width)/10},e.prototype.getScaleWidth=function(t){return t>0?this._targetWidth>=this._maxWidth?0:Math.min(t,this._maxWidth-this._targetWidth):t<0?this._targetWidth<=this._minWidth?0:Math.max(Math.abs(t),this._targetWidth-this._minWidth):0},e.prototype.updateWidth=function(t){var e=this.node.width;this.node.width+=t,this._step<0?this.node.width<=this._targetWidth&&(this.node.width=this._targetWidth,this._step=0,t=-Math.abs(e-this._targetWidth)):this._step>0&&this.node.width>=this._targetWidth&&(this.node.width=this._targetWidth,this._step=0,t=Math.abs(e-this._targetWidth)),this.ndLeft.x=.5*-this.node.width+.5*this.ndLeft.width,this.ndRight.x=.5*this.node.width-.5*this.ndRight.width,this.nd_bl.width=this.node.width-20,this._DoorEdge<0?this.node.x=this._DoorEdge+.5*this.node.width:this._DoorEdge>0&&(this.node.x=this._DoorEdge-.5*this.node.width)},c([y(cc.Label)],e.prototype,"text",void 0),c([y(cc.Sprite)],e.prototype,"door",void 0),c([y(sp.Skeleton)],e.prototype,"skeHitEffect",void 0),c([y([cc.SpriteFrame])],e.prototype,"doorImgs",void 0),c([y(cc.Node)],e.prototype,"nd_bl",void 0),c([y(cc.Node)],e.prototype,"ndLeft",void 0),c([y(cc.Node)],e.prototype,"ndRight",void 0),c([g],e)}(f.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],GAD_Enemy_Ani:[function(t,e,o){"use strict";cc._RF.push(e,"6d786dJ1ihN17J8jaOkqYMZ","GAD_Enemy_Ani");var i=e,n=o;cc._RF.push(i,"6d786dJ1ihN17J8jaOkqYMZ","GAD_Enemy_Ani");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ani=null,e._attackFunc=null,e._attackCompleteFunc=null,e}return r(e,t),e.prototype.start=function(){},e.prototype.Attack=function(){this._attackFunc&&this._attackFunc(),this._attackFunc=null},e.prototype.playAttack=function(t,e){var o=this;this._attackFunc=t,this._attackCompleteFunc=e,this.ani.play("pbt_enemy_attack"),this.ani.on("finished",function(){o._attackCompleteFunc&&o._attackCompleteFunc(),o._attackCompleteFunc=null,console.log("playAttack finished")})},e.prototype.playMove=function(){this.ani.currentClip&&"pbt_enemy_move"==this.ani.currentClip.name||this.ani.play("pbt_enemy_move")},s([p(cc.Animation)],e.prototype,"ani",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],GAD_Enermy:[function(t,e,o){"use strict";cc._RF.push(e,"2a6d0+9IShIVKwMshMAUgNG","GAD_Enermy");var i=t,n=e,a=o;cc._RF.push(n,"2a6d0+9IShIVKwMshMAUgNG","GAD_Enermy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("GAD_Configs"),u=i("GADGameEnumData"),d=i("GAD_DataMgr"),h=i("GAD_PlayerMgr"),f=i("GAD_Base"),m=i("GAD_Bubble"),g=i("GAD_Enemy_Ani"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ske_die=null,e.ske_hit=null,e.ske_stu=null,e.ani=null,e.ndShadow=null,e.spIcon=null,e.ndBubbleRoot=null,e.lblHP=null,e.ndCollider=null,e.prefabBubble=null,e._bubbleCtrl=null,e._hp=0,e._enemyID=0,e._isAttack=!1,e._isRolling=!1,e}return s(e,t),e.prototype.start=function(){this.setRoleState(p.emGADRoleState.Move),this.ani.playMove()},e.prototype.getHp=function(){return this._hp},e.prototype.init=function(t,e){var o;if(this.initTagID(),this._roleType=p.emGADRoleType.Enemy,this._moveSpeed=d.default.getInstance().getParam(u.enumGADBasicCfg.moveSpeed),this._maxSpeed=this._moveSpeed,this._originPos=this.node.position.clone(),this._hp=e,this.updateHp(),t.indexOf(",")>=0){var i=t.split(",").map(function(t){return Number(t)});this._enemyID=i[0],o=d.default.getInstance().getBubbleCfg(i[1])}else this._enemyID=Number(t),o=null;if(this._enermyCfg=d.default.getInstance().getEnemyCfg(this._enemyID),this.ndCollider.setContentSize(this._enermyCfg.width,this._enermyCfg.height),o){if(!this._bubbleCtrl){var n=cc.instantiate(this.prefabBubble);n.parent=this.ndBubbleRoot,this._bubbleCtrl=n.getComponent(m.default)}var a=0;u.enumGADBuffTypeCfg.levelPlus!=o.buffType&&u.enumGADBuffTypeCfg.levelSub!=o.buffType||(a=h.default.getInstance().getCardByRandom()),this._bubbleCtrl.init(o,a)}this.initEnermy()},e.prototype.getAtkPower=function(){return this._enermyCfg.atk},e.prototype.initEnermy=function(){var t=this;this.loadSpriteFrame(p.emGADBundles.imgs,"enemys/enemy_"+this._enemyID,function(e){t.spIcon.spriteFrame=e,t.scheduleOnce(function(){t.node.setContentSize(t.spIcon.node.getContentSize()),t.lblHP.node.setPosition(0,t.node.height+15),t._bubbleCtrl&&(t._bubbleCtrl.node.setPosition(0,t.node.height+5),t.lblHP.node.setPosition(0,t.node.height+25))})})},e.prototype.updateHp=function(){this.lblHP.string=""+this._hp},e.prototype.removeFromScreen=function(){this.node.destroy()},e.prototype.playAttack=function(t,e){var o=this;this._isAttack||this.ani.playAttack(function(){e&&e()},function(){o._isAttack=!1,o.ani.playMove()})},e.prototype.onDie=function(){var t=this;if(this.setRoleState(p.emGADRoleState.Die),this.lblHP.node.active=!1,this.ndBubbleRoot.active=!1,this.ske_die.node.active=!0,this.ndCollider.active=!1,this.ske_die.setAnimation(0,Math.random()<.5?"animation":"animation2",!1),this.ske_die.setCompleteListener(function(){t.node.destroy()}),this.ndShadow.active=!1,this.spIcon.node.runAction(cc.fadeOut(.2)),this._bubbleCtrl){var e=this._bubbleCtrl.node.convertToWorldSpaceAR(cc.Vec2.ZERO);this.sendEvent(p.emGADEventName.GAD_Bubble_Buf,this._bubbleCtrl.getCfg(),e,this._bubbleCtrl.getCardID())}},e.prototype.bulletHited=function(t,e){return!this.isUseful||this.hasColliderTagID(t.getTagID())?p.emGADHitState.None:(this._hp-=e,this.updateHp(),l.AudioMgr.getInstance().playEffectFree(p.GAD_AudioId.strike),this.addColliderTagID(t.getTagID()),this._hp<=0?(this.onDie(),p.emGADHitState.HitDie):p.emGADHitState.HitHurt)},e.prototype.playHpRoll=function(){this._isRolling||(this._isRolling=!0,this.scheduleLabelRoll(),this.schedule(this.scheduleLabelRoll,.05))},e.prototype.scheduleLabelRoll=function(){var t=Number(this.lblHP.string);t!=this._hp?(t>this._hp?t=Math.max(0,t-1):(t+=1,t=Math.min(t+1,this._hp)),this.lblHP.string=""+t,t==this._hp&&(this.unschedule(this.scheduleLabelRoll),this._isRolling=!1)):(this.unschedule(this.scheduleLabelRoll),this._isRolling=!1)},e.prototype.getWorldColliderRectWithFixed=function(t,e){var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position);return t=t||this._enermyCfg.width,e=e||this._enermyCfg.height,cc.rect(i.x-o.x*t,i.y-o.y*e,t,e)},c([_(sp.Skeleton)],e.prototype,"ske_die",void 0),c([_(sp.Skeleton)],e.prototype,"ske_hit",void 0),c([_(sp.Skeleton)],e.prototype,"ske_stu",void 0),c([_(g.default)],e.prototype,"ani",void 0),c([_(cc.Node)],e.prototype,"ndShadow",void 0),c([_(cc.Sprite)],e.prototype,"spIcon",void 0),c([_(cc.Node)],e.prototype,"ndBubbleRoot",void 0),c([_(cc.Label)],e.prototype,"lblHP",void 0),c([_(cc.Node)],e.prototype,"ndCollider",void 0),c([_(cc.Prefab)],e.prototype,"prefabBubble",void 0),c([v],e)}(f.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],GAD_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"ba191kSuDxAw6VQgmLYX8CE","GAD_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"ba191kSuDxAw6VQgmLYX8CE","GAD_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("GAD_UserData"),s=i("GADGameEnumData"),c=i("GAD_DataMgr"),l=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t.prototype.getLevel=function(){return(this._userData.getLevel()-1)%c.default.getInstance().getParam(s.enumGADBasicCfg.MaxLevel,2)+1},t.prototype.addLevel=function(){this._userData.addLevel()},t.prototype.getMapIndex=function(){return this._userData.getLevel()},t}();a.default=l,cc._RF.pop(),cc._RF.pop()},{}],GAD_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"2d6207pDWJND5GWUHSfFZOs","GAD_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"2d6207pDWJND5GWUHSfFZOs","GAD_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("GAD_Configs"),f=i("GAD_BuffTips"),m=i("GAD_PlayerMgr"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.tipPools=[],e}return s(e,t),e.prototype.onLoad=function(){var t=this;p.PoolMgr.getInstance().creatrePool("pbt_hit_effect",this.hitEffect,5),p.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2);var e=m.default.getInstance().getMapIndex();this.loadSpriteFrame(h.emGADBundles.imgs,"backs/cj_"+(e<10?"0":"")+e,function(e){t.spBack.spriteFrame=e})},e.prototype.start=function(){var t=this;this.addEvent(h.emGADEventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(h.emGADEventName.GAD_Show_Warn,this.playWarn),this.addEvent(h.emGADEventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(h.emGADEventName.GAD_Show_Buff_Tip,this.showBuffTip),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){m.default.getInstance().getState()==h.emGADGameState.Game&&(m.default.getInstance().setState(h.emGADGameState.Pause),u.UIMgr.getInstance().openUI(h.GAD_UIID.UISetting,d.UIID.UINONE,function(e){e?m.default.getInstance().setState(h.emGADGameState.Game):t.sendEvent(h.emGADEventName.GAD_Setting_Back)}))})},e.prototype.onShowHitText=function(t,e){var o,i=this;(o=this.tipPools.length>0?this.tipPools.pop():cc.instantiate(this.ndTipRoot.children[0])).parent=this.ndTipRoot,o.active=!0,o.getComponent(cc.Label).string=(t>0?"+":"")+t,o.color=t>0?cc.color().fromHEX("#0bff16"):cc.color().fromHEX("#ff4e49");var n=this.ndTipRoot.convertToNodeSpaceAR(cc.v2(e.x,e.y));o.setPosition(n.x,n.y),o.opacity=255,cc.tween(o).by(.3,{y:80}).to(.1,{opacity:0}).call(function(){o.removeFromParent(),i.tipPools.push(o)}).start()},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.ndWarn),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.ndWarn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.ndWarn),t.ndWarn.active=!1}).start()},e.prototype.showHitEffect=function(t,e){var o=this.node.convertToNodeSpaceAR(t),i=p.PoolMgr.getInstance().getNode("pbt_hit_effect");e==h.emGADRoleType.Door?i.parent=this.doorHitEffctRoot:i.parent=this.node,i.setPosition(o),i.active=!0,i.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),i.getComponent(sp.Skeleton).setCompleteListener(function(){i.active=!1,p.PoolMgr.getInstance().freeNode("pbt_hit_effect",i)})},e.prototype.showBuffTip=function(t,e){var o=p.PoolMgr.getInstance().getNode("pbt_buff_img");o.parent=this.node;var i=this.node.convertToNodeSpaceAR(e);o.setPosition(i),o.getComponent(f.default).show(t)},c([v(cc.Node)],e.prototype,"ndTipRoot",void 0),c([v(cc.Node)],e.prototype,"ndWarn",void 0),c([v(cc.Node)],e.prototype,"btnPause",void 0),c([v(cc.Node)],e.prototype,"hitEffect",void 0),c([v(cc.Node)],e.prototype,"ndBuffImg",void 0),c([v(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([v(cc.Sprite)],e.prototype,"spBack",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],GAD_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"dacb15ygd1COpaw205lHJD4","GAD_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"dacb15ygd1COpaw205lHJD4","GAD_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("UIMgr"),u=i("Config"),d=i("GAD_Configs"),h=i("GAD_Bullet"),f=i("GAD_Cards"),m=i("GAD_Door"),g=i("GAD_Enermy"),y=i("GADGameEnumData"),v=i("GAD_DataMgr"),_=i("GAD_PlayerMgr"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.roleRoot=null,e.ndFence=null,e._cardCtrl=null,e._bullets=[],e._waveRoles=[],e._curWave=0,e._waveDistance=300,e._doorScaleWidth=20,e._roadWidth=700,e._fenceLine=-300,e}return s(e,t),e.prototype.onLoad=function(){this._waveLevelCfgs=v.default.getInstance().getWaveCfgs(_.default.getInstance().getLevel())},e.prototype.start=function(){var t=this;this._cardCtrl=this.ndCardGroup.getComponent(f.default),this.initEvents(),this._waveDistance=v.default.getInstance().getParam(y.enumGADBasicCfg.roundDistance,300),this._doorScaleWidth=v.default.getInstance().getParam(y.enumGADBasicCfg.width,20),this._roadWidth=Math.min(2*d.GADConfig.WallWidth,cc.winSize.width),this.buildWave(),this.scheduleOnce(function(){t._fenceLine=.5*-cc.winSize.height+d.GADConfig.BottomHeight,t.ndFence.y=t._fenceLine,_.default.getInstance().setState(d.emGADGameState.Game)})},e.prototype.initEvents=function(){var t=this;this.addEvent(d.emGADEventName.GAD_Shoot_Bullet,this.onShootBullet),this.addEvent(d.emGADEventName.GAD_Player_Die,function(){t.openResultView(1)}),this.addEvent(d.emGADEventName.GAD_Setting_Back,function(){t.openResultView(0)}),this.addEvent(d.emGADEventName.GAD_Bubble_Buf,function(e,o,i){e&&(i>0?t._cardCtrl.addCardLev(i,e.buffPara):t._cardCtrl.addBuff(e.buffType,e.buffPara),t.sendEvent(d.emGADEventName.GAD_Show_Buff_Tip,e.buffType,o))}),this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(_.default.getInstance().getState()==d.emGADGameState.Game){var o=e.getDeltaX();t.ndCardGroup.x+=o,t._cardCtrl.updateEdgePos()}})},e.prototype.update=function(t){if(_.default.getInstance().getState()==d.emGADGameState.Game){t=Math.min(t,.02),this._cardCtrl.updateCD(t);for(var e=[],o=[],i=0;i<this._waveRoles.length;i++){(C=this._waveRoles[i]).updatePos(t);var n=C.getRoleType();if(n==d.emGADRoleType.Door&&o.push(C),n==d.emGADRoleType.Enemy){if(C.node.y<=this._fenceLine){var a=C;this._cardCtrl.enermyHit(a.getAtkPower()),a.onDie(),this._waveRoles.splice(i,1),i--}}else n==d.emGADRoleType.Door&&C.node.y<=this._cardCtrl.node.y&&e.push(C)}if(e.length>0){var r,s,c=!1,l=1e5,p=null,u=this._cardCtrl.node.x;for(i=0;i<e.length;i++){if(u>=(r=e[i]).node.x-.5*r.getSize().width&&u<=r.node.x+.5*r.getSize().width){(s=r.node.convertToWorldSpaceAR(cc.Vec2.ZERO)).y+=.5*r.node.height,this._cardCtrl.addBuff(r.getBufType(),r.getValue()),this.sendEvent(d.emGADEventName.GAD_Show_Buff_Tip,r.getBufType(),s),this._cardCtrl.addColliderGroupID(r.getGroupID());var h=r.getGroupID();c=!0;for(var f=0;f<o.length;f++)o[f].getGroupID()==h&&(g=this._waveRoles.indexOf(o[f]))>=0&&(this._waveRoles.splice(g,1),o[f].onDie())}else{var m=Math.abs(u-r.node.x);m<l&&(l=m,p=r)}if(c)break}if(!c&&p)for((s=(r=p).node.convertToWorldSpaceAR(cc.Vec2.ZERO)).y+=.5*r.node.height,this._cardCtrl.addBuff(r.getBufType(),r.getValue()),this.sendEvent(d.emGADEventName.GAD_Show_Buff_Tip,r.getBufType(),s),this._cardCtrl.addColliderGroupID(r.getGroupID()),h=r.getGroupID(),f=0;f<o.length;f++){var g;o[f].getGroupID()==h&&(g=this._waveRoles.indexOf(o[f]))>=0&&(this._waveRoles.splice(g,1),o[f].onDie())}}var y=[],v=function(t){for(var e=0,o=0;o<y.length;o++)y[o]==t&&e++;return e},b=[];for(i=0;i<this._bullets.length;i++){var B=this._bullets[i];if(B.checkAutoDie())B.onDie(),this._bullets.splice(i,1),i--;else if(B.isUseful)for(var I=B.getWorldColldierRect(),P=0;P<this._waveRoles.length;P++){var C;if((C=this._waveRoles[P]).isUseful){var D=C.getScaleSize(),T=C.getRoleType()==d.emGADRoleType.Enemy?d.GADConfig.EnemyFixedWidth:D.width,S=C.getWorldColliderRectWithFixed(T,D.height);if(I.intersects(S)){var A=v(C.getTagID());y.push(C.getTagID());var k=C.bulletHited(B,B.getAtkDamage(),A);if(C.isDie&&(this._waveRoles.splice(P,1),P--),k>0){if(this.sendEvent(d.emGADEventName.GAD_Show_Hit_Effect,B.node.convertToWorldSpaceAR(cc.Vec2.ZERO),C.getRoleType()),B.removeFromScreen(),this._bullets.splice(i,1),i--,C.getRoleType()==d.emGADRoleType.Door){for(var w=0;w<this._waveRoles.length;w++)if(this._waveRoles[w].getGroupID()==C.getGroupID()&&this._waveRoles[w].getTagID()!=C.getTagID()){var N=C,R=this._waveRoles[w],M=N.getScaleWidth(this._doorScaleWidth),O=R.getScaleWidth(-this._doorScaleWidth);if(M>0&&O>0){var E=Math.min(M,O);N.scaleWidth(E),R.scaleWidth(-E)}break}b.push(B.getGroupID())}break}}}}}for(i=0;i<this._bullets.length;i++)b.indexOf(this._bullets[i].getGroupID())>=0&&(this.sendEvent(d.emGADEventName.GAD_Show_Hit_Effect,this._bullets[i].node.convertToWorldSpaceAR(cc.Vec2.ZERO),d.emGADRoleType.Door),this._bullets[i].removeFromScreen(),this._bullets.splice(i,1),i--);this.buildWave()}},e.prototype.needBuildWave=function(){return 0==this._waveRoles.length||this._waveRoles[this._waveRoles.length-1].node.y<=.5*cc.winSize.height},e.prototype.openResultView=function(t){var e=this;_.default.getInstance().getState()!=d.emGADGameState.Over&&(_.default.getInstance().setState(d.emGADGameState.Over),this.scheduleOnce(function(){p.UIMgr.getInstance().openUI(d.GAD_UIID.UIResult,u.UIID.UINONE,e._curWave)},t))},e.prototype.buildWave=function(){var t=this._waveLevelCfgs;if(this._curWave>=t.length)0==this._waveRoles.length&&this.openResultView(0);else for(;this.needBuildWave();){var e=t[this._curWave],o=_.default.getInstance().getGroupID(),i=e.roundDistance?e.roundDistance:this._waveDistance,n=this._cardCtrl.node.y+i;this._waveRoles.length>0&&(n=this._waveRoles[this._waveRoles.length-1].node.y+i),this._curWave>0&&n<.5*cc.winSize.height&&(n=.5*cc.winSize.height);for(var a=[],r=1;r<8;r++)e["position"+r]&&a.push(e["position"+r]);var s=this._roadWidth/a.length,c=.5*-this._roadWidth;for(r=0;r<a.length;r++){var l=a[r];if(l){var p=c+.5*s+s*r,u=l.split(",");if(v.default.getInstance().isBuffType(u[0])){var d=cc.instantiate(this.prefabDoor);d.parent=this.roleRoot,d.setPosition(p,n);var h=d.getComponent(m.default);h.init(u[0],Number(u[1])),h.setGroupID(o),h.resetSize(s),this._waveRoles.push(h)}else{var f=cc.instantiate(this.prefabEnemy);f.parent=this.roleRoot,f.setPosition(p,n);var y=f.getComponent(g.default);y.init(u[0],Number(u[1])),y.setGroupID(o),this._waveRoles.push(y)}}}if(this._curWave++,this._curWave>=t.length)return}},e.prototype.onShootBullet=function(t,e,o){var i=cc.instantiate(this.prefabBullet);i.parent=this.ndBulletRoot;var n=this.ndBulletRoot.convertToNodeSpaceAR(e);i.setPosition(n);var a=i.getComponent(h.default);a.setGroupID(t);var r=Math.round(this._cardCtrl.getAtkDamage());a.init(o.getCardCfg(),r),this._bullets.push(a)},c([I(cc.Node)],e.prototype,"ndCardGroup",void 0),c([I(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([I(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([I(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([I(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([I(cc.Node)],e.prototype,"roleRoot",void 0),c([I(cc.Node)],e.prototype,"ndFence",void 0),c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],GAD_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"2569fdHfc5Fe62fUea89kAT","GAD_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"2569fdHfc5Fe62fUea89kAT","GAD_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("GAD_Configs"),d=i("GAD_DataMgr"),h=i("GAD_App"),f=i("UIMgr"),m=i("Config"),g=i("GAD_PlayerMgr"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e}return s(e,t),e.prototype.init=function(t){this._levIndex=t},e.prototype.start=function(){var t=this,e=d.default.getInstance().getWaveCfgs(g.default.getInstance().getLevel()),o=this._levIndex>=e.length,i=!1;o&&g.default.getInstance().addLevel(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){i||(i=!0,h.default.instance.exit_App(o?20:0))}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){i||(i=!0,f.UIMgr.getInstance().closeById(u.GAD_UIID.UIGame),t.scheduleOnce(function(){f.UIMgr.getInstance().openUIOfCallback(u.GAD_UIID.UIGame,m.UIID.UINONE,function(){t.closeUI()})}))});var n=Math.min(Math.max(0,this._levIndex/e.length),1);this.lblBar.string=Math.floor(100*n)+"%",cc.tween(this.spBar).delay(.3).to(.5,{fillRange:n}).start(),this.ndWin.active=o,this.ndFail.active=!o,this.ndTop.y=o?141.512:112,this.ndBar.y=o?-86.812:32,this.btn.y=o?-210.709:-114,this.lblRwd.string="20",p.AudioMgr.getInstance().stopMusic(u.GADConfig.BgMusic),p.AudioMgr.getInstance().playEffectFree(o?u.GAD_AudioId.victory:u.GAD_AudioId.fail)},c([_(cc.Label)],e.prototype,"lblBar",void 0),c([_(cc.Sprite)],e.prototype,"spBar",void 0),c([_(cc.Node)],e.prototype,"ndWin",void 0),c([_(cc.Node)],e.prototype,"ndFail",void 0),c([_(cc.Node)],e.prototype,"ndTop",void 0),c([_(cc.Node)],e.prototype,"ndBar",void 0),c([_(cc.Node)],e.prototype,"btn",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Label)],e.prototype,"lblRwd",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],GAD_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"824736iBYlIOohKv1jIImbA","GAD_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"824736iBYlIOohKv1jIImbA","GAD_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("GAD_PlayerMgr"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.btnPlay=null,e.gm=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.onEnable=function(){this.musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!1),t.closeUI()}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()}),(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&this.gm.on(cc.Node.EventType.TOUCH_END,function(){console.log("gmmmmmmm"),f.default.getInstance().addLevel()})},c([y(cc.Slider)],e.prototype,"musicSlider",void 0),c([y(cc.Slider)],e.prototype,"effectSlider",void 0),c([y(cc.Node)],e.prototype,"btnClose",void 0),c([y(cc.Node)],e.prototype,"btnBackHome",void 0),c([y(cc.Node)],e.prototype,"btnPlay",void 0),c([y(cc.Node)],e.prototype,"gm",void 0),c([g],e)}(p.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],GAD_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"9ea96Vb+SVBGLEhXAWEhwWt","GAD_UserData");var i=t,n=e,a=o;cc._RF.push(n,"9ea96Vb+SVBGLEhXAWEhwWt","GAD_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"gad_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],GameBuff:[function(t,e,o){"use strict";cc._RF.push(e,"f5f23CsE4xE+J4RnjicenR3","GameBuff");var i=t,n=e,a=o;cc._RF.push(n,"f5f23CsE4xE+J4RnjicenR3","GameBuff");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("EventMgr"),c=i("LogMgr"),l=i("GameEnumData"),p=i("DataMgr"),u=i("BraveTowerEnum"),d=i("GameCtrl"),h=cc._decorator,f=h.ccclass,m=(h.property,function(){}),g=function(){function t(t){this.buffList=[],this.gameCtrl=t}return t.prototype.hasBuff=function(t){for(var e=0;e<this.buffList.length;e++)if(this.buffList[e].id===t)return!0;return!1},t.prototype.hasBuffType=function(t){for(var e=0;e<this.buffList.length;e++)if(this.buffList[e].id===t)return!0;return!1},t.prototype.addBuff=function(t){for(var e=function(e){var i=t[e],n=new m;n.id=i;var a=p.DataMgr.getInstance().getBuffCfg(i);switch(n.type=a.buffType,n.value=a.value,o.buffList.push(n),a.buffType){case l.BraveTowerEnumBuffType.BuffType04:o.gameCtrl.gameData.enemyList.forEach(function(t){return t.upMoveSpeed()});break;case l.BraveTowerEnumBuffType.BuffType06:n.time=n.value[0];break;case l.BraveTowerEnumBuffType.BuffType07:o.gameCtrl.gamePlayInfo.addMax(n.value[0]);break;case l.BraveTowerEnumBuffType.BuffType08:o.gameCtrl.ctrUI.upBtnView();break;case l.BraveTowerEnumBuffType.BuffType09:o.gameCtrl.ctrUI.upCardProbability();break;case l.BraveTowerEnumBuffType.BuffType10:o.gameCtrl.addGoldNum(n.value[0]);break;case l.BraveTowerEnumBuffType.BuffType11:case l.BraveTowerEnumBuffType.BuffType12:n.time=n.value[0],o.gameCtrl.ctrUI.upBtnView();break;case l.BraveTowerEnumBuffType.BuffType25:n.time=0;var r=p.DataMgr.getInstance().getTiesCfg(l.BraveTowerEnumTiesCfg.Ties05),s=[];r.effectList.forEach(function(t){s.push(t.cardId)}),n.data50=s;break;case l.BraveTowerEnumBuffType.BuffType26:case l.BraveTowerEnumBuffType.BuffType27:case l.BraveTowerEnumBuffType.BuffType37:case l.BraveTowerEnumBuffType.BuffType43:n.time=0;break;case l.BraveTowerEnumBuffType.BuffType29:var u=p.DataMgr.getInstance().getTiesCfg(l.BraveTowerEnumTiesCfg.Ties06),d=[];n.data54={},u.effectList.forEach(function(t){d.push(t.cardId);var e=p.DataMgr.getInstance().getCardCfg(t.cardId);n.data54[e.quality]||(n.data54[e.quality]=[]),n.data54[e.quality].push(t.cardId)}),n.data50=d,c.LogMgr.getInstance().debug("buff54",n)}},o=this,i=0;i<t.length;i++)e(i);this.gameCtrl.needUpdateCardData=!0,s.EventMgr.getInstance().emit(u.BraveTowerEventName.UpdateGameUI,3),this.gameCtrl.resumeGame()},t.prototype.getCardBuffTime=function(t,e){var o=this,i=0,n=this.getBuff(l.BraveTowerEnumBuffID.BuffID54),a=this.getBuff(l.BraveTowerEnumBuffID.BuffID62),r=this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties10),s=function(){var t=o.getBuff(l.BraveTowerEnumBuffID.BuffID72),e=o.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties15);if(t&&e){for(var i=0;i<e.cardList.length;i++){var n=e.cardList[i],a=o.gameCtrl.ctrUI.getCard(n);if(!a||a.starNum<u.BraveTowerParameter.SkillUnlockStar2)return 0}return t.value[0]}return 0};switch(e){case d.CardBuffAddType.Attack:this.getBuffList(l.BraveTowerEnumBuffType.BuffType01).forEach(function(t){i+=t.value[0]}),n&&n.data54[1].includes(t)&&(i+=n.value[0]);var c=this.getBuff(l.BraveTowerEnumBuffID.BuffID57),h=this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties08);if(1==u.BraveTowerSwitch.SkillTYpe()&&h&&c&&(i+=c.value[0]),2==u.BraveTowerSwitch.SkillTYpe()){var f=this.gameCtrl.ctrUI.getCard(t);c&&h&&h.cardList.includes(t)&&f&&f.starNum>=u.BraveTowerParameter.SkillUnlockStar2&&(i+=c.value[0])}r&&a&&a.time>=a.value[0]&&(i+=a.value[1]);var m=this.getBuff(l.BraveTowerEnumBuffID.BuffID68);m&&this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties13)&&(i+=m.value[0]),i+=s();break;case d.CardBuffAddType.AttackSpeed:this.getBuffList(l.BraveTowerEnumBuffType.BuffType02).forEach(function(t){i+=t.value[0]}),n&&n.data54[3].includes(t)&&(i+=n.value[2]),r&&a&&a.time>=a.value[0]&&(i+=a.value[1]),i+=s();break;case d.CardBuffAddType.Stun:break;case d.CardBuffAddType.Crit:this.getBuffList(l.BraveTowerEnumBuffType.BuffType03).forEach(function(t){i+=t.value[0]});var g=this.getBuff(l.BraveTowerEnumBuffID.BuffID44);if(g){for(var y=0,v=(f=this.gameCtrl.ctrUI.getAllCardList(),0);v<f.length;v++){var _=f[v];2==p.DataMgr.getInstance().getCardCfg(_.cardId).Gender&&y++}y>g.value[1]&&(y=g.value[1]),i+=y*g.value[0]}n&&n.data54[2].includes(t)&&(i+=n.value[1]);var b=this.getBuff(l.BraveTowerEnumBuffID.BuffID63);b&&this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties11)&&(i+=b.value[0]);break;case d.CardBuffAddType.CritDamage:break;case d.CardBuffAddType.SkillCD:var B=this.getBuff(l.BraveTowerEnumBuffID.BuffID39);if(B){var I=this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties01);I&&I.cardList.includes(t)&&(i=B.value[0])}}return i},t.prototype.getBuffList=function(t){for(var e=[],o=0;o<this.buffList.length;o++){var i=this.buffList[o];i.type===t&&e.push(i)}return e},t.prototype.getBuff=function(t){for(var e=0;e<this.buffList.length;e++){var o=this.buffList[e];if(o.id===t)return o}return null},t.prototype.startRound=function(){for(var t=0;t<this.buffList.length;t++){var e=this.buffList[t];switch(e.type){case l.BraveTowerEnumBuffType.BuffType05:var o=this.gameCtrl.gamePlayInfo.hpMax*e.value[0];this.gameCtrl.gamePlayInfo.addHp(o);break;case l.BraveTowerEnumBuffType.BuffType06:case l.BraveTowerEnumBuffType.BuffType12:e.time=e.value[0];break;case l.BraveTowerEnumBuffType.BuffType11:e.time--}}},t.prototype.endRound=function(){for(var t=0;t<this.buffList.length;t++){var e=this.buffList[t];switch(e.type){case l.BraveTowerEnumBuffType.BuffType25:case l.BraveTowerEnumBuffType.BuffType43:e.time++,e.time>e.value[1]&&(e.time=e.value[1]);break;case l.BraveTowerEnumBuffType.BuffType26:if(this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties05)){var o=Math.pow(1+e.value[1],e.time);this.gameCtrl.addGoldNum(Math.floor(o*e.value[0])),c.LogMgr.getInstance().debug("buff51",e.time,o,o*e.value[0]),e.time++,e.time>e.value[2]&&(e.time=e.value[2])}break;case l.BraveTowerEnumBuffType.BuffType44:e.time=0}}},t.prototype.playAttacked=function(t){for(var e=t,o=1,i=0;i<this.buffList.length;i++){var n=this.buffList[i];if(n.type==l.BraveTowerEnumBuffType.BuffType06&&n.time>0){n.time--,e=n.value[1];break}n.id==l.BraveTowerEnumBuffID.BuffID41&&this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties01)&&(o-=n.value[0])}return c.LogMgr.getInstance().debug("\u57fa\u5730\u53d7\u51fb","\u4f24\u5bb3",t,"\u57fa\u6570",e,"\u52a0\u6210",o,"\u6700\u7ec8\u4f24\u5bb3",e*o),e*o},t.prototype.isFree=function(){for(var t=0;t<this.buffList.length;t++){var e=this.buffList[t];if(e.type==l.BraveTowerEnumBuffType.BuffType12&&e.time>0)return!0}return!1},t.prototype.doFree=function(){for(var t=0;t<this.buffList.length;t++){var e=this.buffList[t];if(e.type==l.BraveTowerEnumBuffType.BuffType12&&e.time>0)return e.time--,!0}return!1},t.prototype.addBuff62=function(t){for(var e=0;e<this.buffList.length;e++){var o=this.buffList[e];o.id==l.BraveTowerEnumBuffID.BuffID62&&(o.time+=t)}},r([f],t)}();a.default=g,cc._RF.pop(),cc._RF.pop()},{}],GameCtrlData:[function(t,e,o){"use strict";cc._RF.push(e,"b6b89CAXKNHPZ/0kD8z0tyD","GameCtrlData");var i=t,n=e,a=o;cc._RF.push(n,"b6b89CAXKNHPZ/0kD8z0tyD","GameCtrlData");var r=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0}),a.GameCtrlData=void 0;var s=i("LogMgr"),c=i("Utils"),l=i("GameEnumData"),p=i("DataMgr"),u=i("PlayerMgr"),d=i("BraveTowerEnum"),h=function(){function t(t){this.gameStage=d.BraveTowerGameStage.Preparation,this.levelCfg=null,this.goldNum=0,this.playerBullets=[],this.playerSkillList=[],this.enemyList=[],this.roundNum=1,this.enemyGenerateList=[],this.buffList=[],this.nextTime=0,this.nextTimeMax=0,this.gameCtrl=t}return t.prototype.initData=function(t,e){switch(this.gameMode=t,t){case d.BraveTowerGameMode.Normal:this.levelCfg=p.DataMgr.getInstance().getLevelCfgById(e);break;case d.BraveTowerGameMode.Boss:this.levelCfg=p.DataMgr.getInstance().getChallengeCfg(e);break;default:console.error("\u6e38\u620f\u6a21\u5f0f\u9519\u8bef")}this.goldNum=parseInt(p.DataMgr.getInstance().getParamCfg(l.BraveTowerEnumParamsCfg.Params08)),this.playerBullets=[],this.playerSkillList=[],this.enemyList=[],this.roundNum=0,this.nextTimeMax=Number(p.DataMgr.getInstance().getParamCfg(l.BraveTowerEnumParamsCfg.Params02))},t.prototype.endGame=function(){this.gameStage=d.BraveTowerGameStage.GameOver,this.gameCtrl.ndArrow.removeAllChildren(),this.playerBullets=[],this.gameCtrl.ndSkill.removeAllChildren(),this.playerSkillList=[],this.enemyList.forEach(function(t){t.onRelease()}),this.enemyList=[]},t.prototype.restartGame=function(){this.goldNum=parseInt(p.DataMgr.getInstance().getParamCfg(l.BraveTowerEnumParamsCfg.Params08)),this.playerBullets=[],this.playerSkillList=[],this.enemyList=[],this.roundNum=0},t.prototype.onUpdate=function(t){if(this.enemyGenerateList.length>0){if(this.enemyGenerateList[0].time-=t,this.enemyGenerateList[0].time<=0){var e=this.enemyGenerateList.shift();this.gameCtrl.addEnemyById(e.id,e.hp,e.attack),0==this.enemyGenerateList.length&&this.endRound()}}else this.nextTime>=0&&(this.nextTime-=t,this.nextTime<0&&this.startRound());for(var o=0;o<this.enemyList.length;o++)this.enemyList[o].onUpdate(t);var i=r(this.enemyList);for(i.sort(function(t,e){return e.getWpos().y-t.getWpos().y}),i.forEach(function(t,e){t.node.zIndex=e}),o=0;o<this.playerBullets.length;o++)this.playerBullets[o].onUpdate(t);for(o=0;o<this.playerSkillList.length;o++)this.playerSkillList[o].onUpdate(t)},t.prototype.startRound=function(){this.gameCtrl.ctrUI.ndTime.active=!1,this.roundNum>=this.levelCfg.wareList.length||(this.initEnemyGenerateList(),this.roundNum++,this.gameCtrl.ctrUI.updateRoundNum(),this.gameCtrl.gameSkillBuff.addBuffSkill39(2),this.gameCtrl.gameTrammel.addTies12(),this.gameCtrl.gameBuff.startRound(),this.gameCtrl.ctrUI.upBtnView())},t.prototype.initEnemyGenerateList=function(){this.nextTime=0,this.enemyGenerateList=[];for(var t=this.levelCfg.wareList[this.roundNum],e=Number(p.DataMgr.getInstance().getParamCfg(l.BraveTowerEnumParamsCfg.Params01)),o=0;o<t.wave.length;o++)for(var i=t.wave[o],n=0;n<i[1];n++)this.enemyGenerateList.push({time:e,id:i[0],hp:t.pa,attack:t.pa1})},t.prototype.endRound=function(){s.LogMgr.getInstance().debug("\u56de\u5408\u7ed3\u675f"),this.nextTime=this.nextTimeMax,this.gameMode==d.BraveTowerGameMode.Normal&&u.PlayerMgr.getInstance().getUserData().passOrder(this.levelCfg.id,this.roundNum-1),this.gameCtrl.gameSkillBuff.addBuffSkill15();var t=this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties05);if(t){var e=t.val[c.Utils.randomRang(0,t.val.length)];s.LogMgr.getInstance().debug("Ties05:",e),this.gameCtrl.addGoldNum(e)}if(2==d.BraveTowerSwitch.SkillTYpe()){var o=this.gameCtrl.gameTrammel.getTies(l.BraveTowerEnumTiesCfg.Ties08);o&&this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card15)&&(e=o[l.BraveTowerEnumCardCfg.Card15][0],s.LogMgr.getInstance().debug("Ties08:",e),this.gameCtrl.addGoldNum(e))}if(this.gameCtrl.gameBuff.endRound(),this.gameCtrl.ctrUI.upCardView(),this.levelCfg.wareList[this.roundNum-1].animation&&this.gameCtrl.ctrEffect.showBoss(),u.PlayerMgr.getInstance().getSetData().getAuto()){var i=parseInt(p.DataMgr.getInstance().getParamCfg(l.BraveTowerEnumParamsCfg.Params07));this.gameCtrl.addGoldNum(i),this.nextTime=0}else this.gameCtrl.ctrUI.ndTime.active=!0},t.prototype.delPlayerBullet=function(t){for(var e=0;e<this.playerBullets.length;e++)if(this.playerBullets[e].uuid==t.uuid){this.playerBullets.splice(e,1);break}},t.prototype.delCardBullt=function(t){for(var e=0;e<this.playerBullets.length;e++){var o=this.playerBullets[e];o.ctrParent.uuid==t.uuid&&(o.ctrParent.doAttackEnd(o),e--)}},t.prototype.delEnemy=function(t){for(var e=0;e<this.enemyList.length;e++)if(this.enemyList[e].uuid==t.uuid){this.enemyList.splice(e,1);break}u.PlayerMgr.getInstance().getTaskData().addCoreCombatKillNum(),this.tryEndGame()},t.prototype.tryEndGame=function(){return this.enemyList.length>0?0:this.enemyGenerateList.length>0?1:this.roundNum<this.levelCfg.wareList.length?2:void this.gameCtrl.endGame(!0)},t}();a.GameCtrlData=h,cc._RF.pop(),cc._RF.pop()},{}],GameCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"65461WqnrNBBLfrvZlg0Fo+","GameCtrl");var i=t,n=e,a=o;cc._RF.push(n,"65461WqnrNBBLfrvZlg0Fo+","GameCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.CardBuffAddType=void 0;var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("LogMgr"),d=i("ResourceMgr"),h=i("SdkMgr"),f=i("UIMgr"),m=i("Utils"),g=i("Config"),y=i("GameTrackDataEvent"),v=i("GameEnumData"),_=i("DataMgr"),b=i("PlayerMgr"),B=i("BraveTowerEnum"),I=i("GameCtrlData"),P=i("GamePlayInfo"),C=i("ItemEnemy"),D=i("ItemEnemyBase"),T=i("GameBuff"),S=i("GameEffect"),A=i("GameSkillBuff"),k=i("GameTram"),w=i("GameUICtrl"),N=cc._decorator,R=N.ccclass,M=N.property,O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctrUI=null,e.ctrEffect=null,e.ndArrow=null,e.ndSkill=null,e.ndEnemy=null,e.ndEnemyArrow=null,e.btnTest1=null,e.btnTest2=null,e.gameData=null,e.gameSkillBuff=null,e.gameTrammel=null,e.gameBuff=null,e.gamePlayInfo=null,e.speedList=[1,1.5,2,2.5],e.openSpeed=!1,e.time=0,e.needUpdateCardData=!1,e.outWeight=50,e.topWeight=50,e.timeSpeed=1,e.rankInfo=[],e.addBuff=1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,this.gameData=new I.GameCtrlData(this),this.gameSkillBuff=new A.default(this),this.gameTrammel=new k.default(this),this.gameBuff=new T.default(this),this.gamePlayInfo=new P.GamePlayInfo(this)},e.prototype.start=function(){var t=this;this.initEventListener(),this.node.getChildByName("ndLine1").active=!1,this.node.getChildByName("ndLine2").active=!1,this.node.getChildByName("ndLine1").y=B.BraveTowerParameter.BaseY,this.node.getChildByName("ndLine2").y=B.BraveTowerParameter.ForceSplitLine,this.btnTest1.on(cc.Node.EventType.TOUCH_END,function(){for(var e=t.gameData.enemyList,o=0;o<e.length;o++)e[o].addBuff(D.Buff.stun,3)}),this.btnTest2.on(cc.Node.EventType.TOUCH_END,function(){for(var e=t.gameData.enemyList,o=0;o<e.length;o++)e[o].addBuff(D.Buff.slow,3,.5)}),this.timeSpeed=b.PlayerMgr.getInstance().getSetData().getSpeed(),this.initBtnListener(),this.initBtnView()},e.prototype.initEventListener=function(){var t=this;this.addEvent(B.BraveTowerEventName.GameSuspend,function(e){e?t.pauseGame():t.resumeGame()}),this.addEvent(B.BraveTowerEventName.GameOver,this.endGame),this.addEvent(B.BraveTowerEventName.SpeedChange,this.onSpeedChange)},e.prototype.initBtnListener=function(){var t=this,e=this.ctrUI.btnSpeed.getChildByName("ndInfo");this.ctrUI.btnSpeed.on(cc.Node.EventType.TOUCH_END,function(){t.openSpeed=!t.openSpeed,e.active=t.openSpeed},this);for(var o=function(o){var i=e.children[o],n=parseInt(i.name.slice(6));i.on(cc.Node.EventType.TOUCH_END,function(e){e.stopPropagation(),b.PlayerMgr.getInstance().getSetData().getSpeedAd(n)?(t.timeSpeed=n,b.PlayerMgr.getInstance().getSetData().setSpeed(n),t.onSpeedChange(),t.initBtnView()):b.PlayerMgr.getInstance().getSetData().getSpeedAd(n-1)&&(t.pauseGame(),h.SdkMgr.getInstance().playVideo(h.AdType.AdFreeTime,function(){var e;b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.Accelerate),b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.Accelerate_X,(e=b.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?e:Math.floor((e-1)/5)+5),t.resumeGame(),t.timeSpeed=n,b.PlayerMgr.getInstance().getSetData().setSpeed(n),b.PlayerMgr.getInstance().getSetData().setSpeedAd(n),t.onSpeedChange(),t.initBtnView()},function(){t.resumeGame()}))})},i=0;i<e.children.length;i++)o(i);this.ctrUI.btnAddCoin.getChildByName("ndTips").active=!1,this.ctrUI.btnAddCoin.on(cc.Node.EventType.TOUCH_END,function(){1.5!=t.addBuff&&(t.pauseGame(),f.UIMgr.getInstance().openUI(g.UIID.UIAddCoin,g.UIID.UIGame,function(e){var o;e&&(b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.More_silver_coin),b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.More_silver_coin_X,(o=b.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?o:Math.floor((o-1)/5)+5),t.addBuff=1.5,t.ctrUI.btnAddCoin.getChildByName("ndTips").active=!0),t.resumeGame()}))}),this.ctrUI.btnCoinBub.on(cc.Node.EventType.TOUCH_END,function(){t.pauseGame(),h.SdkMgr.getInstance().playVideo(h.AdType.AdFreeTime,function(){var e;b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.Coin_bubbles),b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.Coin_bubbles_X,(e=b.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?e:Math.floor((e-1)/5)+5);var o=_.DataMgr.getInstance().getParamCfg(v.BraveTowerEnumParamsCfg.Params14).split(","),i=parseInt(o[Math.min(t.gameData.roundNum-1,o.length-1)]);t.addGoldNum(i),t.resumeGame()},function(){t.resumeGame()})})},e.prototype.initBtnView=function(){this.ctrUI.btnSpeed.getChildByName("labSpeed").getComponent(cc.Label).string="x"+this.timeSpeed;var t=this.ctrUI.btnSpeed.getChildByName("ndInfo");t.active=this.openSpeed;for(var e=0;e<t.children.length;e++){var o=t.children[e],i=parseInt(o.name.slice(6));o.getChildByName("labName").getComponent(cc.Label).string="x"+i,b.PlayerMgr.getInstance().getSetData().getSpeedAd(i)?(o.getChildByName("ndVideo").active=!1,o.getChildByName("labName").color=cc.Color.WHITE):(b.PlayerMgr.getInstance().getSetData().getSpeedAd(i-1)?o.getChildByName("ndVideo").active=!0:o.getChildByName("ndVideo").active=!1,o.getChildByName("labName").color=(new cc.Color).fromHEX("#687077"))}},e.prototype.initData=function(t,e){void 0===e&&(e=1),this.gameData.initData(t,e),this.ctrEffect.initData(this),this.ctrUI.initData(this),this.gamePlayInfo.initData()},e.prototype.getSpeed=function(){return this.speedList[this.timeSpeed-1]},e.prototype.startGame=function(){this.gameData.gameStage=B.BraveTowerGameStage.GameIng,p.AudioMgr.getInstance().playMusic(g.AudioId.Levels,B.BraveTowerParameter.BGMusic),this.gameData.startRound(),this.ctrUI.startGame()},e.prototype.update=function(t){var e=t*this.getSpeed();switch(e=Math.min(e,.5),this.gameData.gameStage){case B.BraveTowerGameStage.GameIng:this.gameData.onUpdate(e),this.gameSkillBuff.onUpTime(e),this.gameTrammel.onUpTime(e),this.ctrUI.onUpdate(e),this.needUpdateCardData&&this.ctrUI.upCardData(),this.needUpdateCardData=!1,this.time+=e,this.time>=1&&(this.time=0,this.sendEvent(B.BraveTowerEventName.UpdateGameUI,2))}},e.prototype.pauseGame=function(){this.gameData.gameStage=B.BraveTowerGameStage.Suspend;for(var t=0;t<this.gameData.enemyList.length;t++)this.gameData.enemyList[t].isDead()||this.gameData.enemyList[t].onPauseAni()},e.prototype.resumeGame=function(){this.gameData.gameStage=B.BraveTowerGameStage.GameIng;for(var t=0;t<this.gameData.enemyList.length;t++)this.gameData.enemyList[t].onResumeAni()},e.prototype.endGame=function(t){var e=this;void 0===t&&(t=!1),this.gameData.gameStage!=B.BraveTowerGameStage.GameOver&&(this.gameData.gameStage=B.BraveTowerGameStage.GameOver,t&&this.gameData.gameMode==B.BraveTowerGameMode.Normal&&(b.PlayerMgr.getInstance().getUserData().passStage(this.gameData.levelCfg.id),b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.finish_lv_X,this.gameData.levelCfg.id),this.sendEvent(B.BraveTowerEventName.GamePass)),f.UIMgr.getInstance().openUIOfCallback(g.UIID.UIGameResult,g.UIID.UIGame,function(){e.gameData.endGame(),e.ctrUI.endGame()},t,function(){e.restartGame()}))},e.prototype.restartGame=function(){this.gameSkillBuff=new A.default(this),this.gameTrammel=new k.default(this),this.gameBuff=new T.default(this),this.gamePlayInfo=new P.GamePlayInfo(this),this.gamePlayInfo.initData(),this.gameData.restartGame(),this.ctrUI.restartGame(),this.rankInfo=[],this.addBuff=1,this.ctrUI.btnAddCoin.getChildByName("ndTips").active=!1,this.sendEvent(B.BraveTowerEventName.GameRestart),this.startGame()},e.prototype.addEnemyById=function(t,e,o){var i=this,n=_.DataMgr.getInstance().getEnemyCfg(t),a=B.BraveTowerPoolName.EnemyName+"_"+n.id;d.ResourceMgr.getInstance().getNode(a,n.bundle,n.prefab,function(n){n.setParent(i.ndEnemy),n.active=!0;var a=cc.v2(m.Utils.randomRang(i.outWeight,cc.winSize.width-i.outWeight),cc.winSize.height-i.topWeight),r=i.ndEnemy.convertToNodeSpaceAR(a);n.setPosition(r);var s=n.getComponent(C.default);s?(s.initData(t,e,o),i.gameData.enemyList.push(s)):console.error("ItemEnemy\u7ec4\u4ef6\u4e0d\u5b58\u5728")})},e.prototype.onSpeedChange=function(){this.ctrUI.btnSpeed.getChildByName("labSpeed").getComponent(cc.Label).string=this.timeSpeed+"X";for(var t=0;t<this.gameData.enemyList.length;t++)this.gameData.enemyList[t].onSpeedChange()},e.prototype.addCardDamge=function(t,e){for(var o=0;o<this.rankInfo.length;o++){var i=this.rankInfo[o];if(i.cardId==t){i.num+=e;break}}},e.prototype.addCardTime=function(t,e){for(var o=!0,i=0;i<this.rankInfo.length;i++){var n=this.rankInfo[i];if(n.cardId==t){n.time+=e,o=!1;break}}o&&this.rankInfo.push({cardId:t,num:0,time:e})},e.prototype.getGoldNum=function(){return this.gameData.goldNum},e.prototype.addGoldNum=function(t){t=Math.ceil(t*this.addBuff),this.gameData.goldNum+=t,b.PlayerMgr.getInstance().getTaskData().addCoreCombatGetCoinNum(t),this.ctrUI.upGoldView(),this.ctrUI.aniGold(t),this.gameTrammel.getTies(v.BraveTowerEnumTiesCfg.Ties08)&&(this.needUpdateCardData=!0)},e.prototype.subGoldNum=function(t){return!(this.gameData.goldNum<t||(this.gameData.goldNum-=t,this.ctrUI.upGoldView(),this.gameTrammel.getTies(v.BraveTowerEnumTiesCfg.Ties08)&&(this.needUpdateCardData=!0),0))},e.prototype.addEx=function(t){this.gamePlayInfo.exp+=t,this.gamePlayInfo.exp>=this.gamePlayInfo.expMax&&(this.pauseGame(),this.gamePlayInfo.addLevel(),f.UIMgr.getInstance().openUI(g.UIID.UISelectBuff,g.UIID.UIGame)),this.ctrUI.upEXView()},e.prototype.getEnemyByWeight=function(){for(var t=[],e=[],o=0;o<this.gameData.enemyList.length;o++){var i=this.gameData.enemyList[o];i.canFind()&&t.push(i)}return t.length>0?(t.sort(function(t,e){return t.node.y-e.node.y}),t[0]):e[m.Utils.randomRang(0,e.length)]},e.prototype.getEnemysByWeight=function(t){for(var e=[],o=[],i=[],n=0;n<this.gameData.enemyList.length;n++){var a=this.gameData.enemyList[n];a.canFind()&&(a.node.y<B.BraveTowerParameter.ForceSplitLine?o.push(a):i.push(a))}for(o.sort(function(t,e){return t.node.y-e.node.y});t>o.length+i.length;)e.push.apply(e,o),e.push.apply(e,i),t-=o.length+i.length;for(var r=0;r<t;r++)if(o.length>0)e.push(o[0]),o.splice(0,1);else{var s=m.Utils.randomRang(0,i.length);e.push(i[s]),i.splice(s,1)}return e},e.prototype.getNearestEnemy=function(){for(var t,e=0;e<this.gameData.enemyList.length;e++){var o=this.gameData.enemyList[e];o.canFind()&&(t?t.node.y>o.node.y&&(t=o):t=o)}return t},e.prototype.getRandomEnemy=function(){for(var t=[],e=0;e<this.gameData.enemyList.length;e++){var o=this.gameData.enemyList[e];o.canFind()&&t.push(o)}return t[m.Utils.randomRang(0,t.length)]},e.prototype.doEnemyAttack=function(t,e){u.LogMgr.getInstance().debug("\u654c\u65b9\u653b\u51fb",t,e);var o=this.gameBuff.playAttacked(t);o<=0||(this.sendEvent(B.BraveTowerEventName.ScreenShake),this.gamePlayInfo.subHp(o))},e.prototype.getCardBuffTime=function(t,e){var o=this.gameSkillBuff.getCardBuffTime(t,e);return(o+=this.gameTrammel.getCardBuffTime(t,e))+this.gameBuff.getCardBuffTime(t,e)},c([M({type:w.default,tooltip:"\u5361\u724c\u8282\u70b9"})],e.prototype,"ctrUI",void 0),c([M({type:S.default,tooltip:"\u5361\u724c\u8282\u70b9"})],e.prototype,"ctrEffect",void 0),c([M({type:cc.Node,tooltip:"\u6211\u65b9\u5b50\u5f39\u8282\u70b9"})],e.prototype,"ndArrow",void 0),c([M({type:cc.Node,tooltip:"\u6211\u65b9\u6280\u80fd\u8282\u70b9"})],e.prototype,"ndSkill",void 0),c([M({type:cc.Node,tooltip:"\u654c\u4eba\u8282\u70b9"})],e.prototype,"ndEnemy",void 0),c([M({type:cc.Node,tooltip:"\u654c\u4eba\u5b50\u5f39\u8282\u70b9"})],e.prototype,"ndEnemyArrow",void 0),c([M({type:cc.Node,tooltip:"\u7729\u6655"})],e.prototype,"btnTest1",void 0),c([M({type:cc.Node,tooltip:"\u51cf\u901f"})],e.prototype,"btnTest2",void 0),o=c([R],e)}(l.default);a.default=O,function(t){t[t.Attack=1]="Attack",t[t.AttackSpeed=2]="AttackSpeed",t[t.Stun=3]="Stun",t[t.Crit=4]="Crit",t[t.CritDamage=5]="CritDamage",t[t.SkillCD=6]="SkillCD"}(a.CardBuffAddType||(a.CardBuffAddType={})),cc._RF.pop(),cc._RF.pop()},{}],GameDailyData:[function(t,e,o){"use strict";cc._RF.push(e,"c50286854tG876vUmMTiG5R","GameDailyData");var i=t,n=e,a=o;cc._RF.push(n,"c50286854tG876vUmMTiG5R","GameDailyData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.GameDailyData=void 0;var c=i("BaseData"),l=i("Config"),p=i("BraveTowerEnum"),u=function(){this.time=0,this.signDay=0,this.signReward=0,this.bossEnter=[],this.lotteryTimes=[],this.freeLottery=0,this.onlineTime=0,this.onlineTimeReward=[],this.sweepNum=0,this.sweepTime=0,this.subGameTime=0,this.subGameTime2=0,this.subGameTime3=0,this.subGameTime4=0,this.subGameTime5=0,this.subGameTime6=0,this.subGameTime7=0,this.subGameTime8=0,this.version=1},d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ecrypt=!1,e.aliseMap={time:"1",signDay:"2",signReward:"3",bossEnter:"4",lotteryTimes:"5",freeLottery:"6",onlineTime:"7",onlineTimeReward:"8",sweepNum:"9",sweepTime:"a",subGameTime:"b",subGameTime2:"c",subGameTime3:"d",subGameTime4:"e",subGameTime5:"f",subGameTime6:"g",subGameTime7:"h",subGameTime8:"i",version:"Z"},e.gameKey=l.GameConfig.AppCacheName+"GameDailyData",e.vesion=1,e}return s(e,t),e.prototype.createData=function(){return this.data=new u,this.data},e.prototype.initData=function(){p.BraveTowerGameUtils.compareIsToday2(this.data.time)||this.initDailyData(),this.data.freeLottery||(this.data.freeLottery=0),this.data.onlineTime||(this.data.onlineTime=0,this.data.onlineTimeReward=[]),this.data.sweepTime||(this.data.sweepTime=Date.now(),this.data.sweepNum=0,this.data.subGameTime=0),this.data.subGameTime2||(this.data.subGameTime2=0),this.data.subGameTime3||(this.data.subGameTime3=0),this.data.subGameTime4||(this.data.subGameTime4=0),this.data.subGameTime5||(this.data.subGameTime5=0),this.data.subGameTime6||(this.data.subGameTime6=0),this.data.subGameTime7||(this.data.subGameTime7=0),this.data.subGameTime8||(this.data.subGameTime8=0),this.saveData()},e.prototype.initDailyData=function(){this.data.time=Date.now(),this.data.signReward>0&&(this.data.signDay++,this.data.signReward=0),this.data.bossEnter=[],this.data.lotteryTimes=[],this.data.freeLottery=0,this.data.onlineTime=0,this.data.onlineTimeReward=[]},e.prototype.getSignDay=function(){return this.data.signDay},e.prototype.getSignReward=function(){return this.data.signReward},e.prototype.sign=function(t){var e=1<<t;this.data.signReward+=e,this.saveData()},e.prototype.getBossEnter=function(t){return this.data.bossEnter[t]||0},e.prototype.addBossEnter=function(t){this.data.bossEnter[t]=(this.data.bossEnter[t]||0)+1,this.saveData()},e.prototype.getLotteryTimes=function(t){return this.data.lotteryTimes[t]||0},e.prototype.addLotteryTimes=function(t,e){return void 0===e&&(e=1),this.data.lotteryTimes[t]=(this.data.lotteryTimes[t]||0)+e,this.saveData(),this.data.lotteryTimes[t]},e.prototype.getFreeLottery=function(){return this.data.freeLottery},e.prototype.addFreeLottery=function(t){return void 0===t&&(t=1),this.data.freeLottery+=t,this.saveData(),this.data.freeLottery},e.prototype.getOnlineTime=function(){return this.data.onlineTime},e.prototype.addOnlineTime=function(t){return void 0===t&&(t=1),this.data.onlineTime+=t,this.saveData(),this.data.onlineTime},e.prototype.getOnlineTimeReward=function(t){return this.data.onlineTimeReward[t]},e.prototype.setOnlineTimeReward=function(t){this.data.onlineTimeReward[t]=1,this.saveData()},e.prototype.getSweepNum=function(){return this.data.sweepNum},e.prototype.addSweepNum=function(t){return void 0===t&&(t=1),0==this.data.sweepNum&&(this.data.sweepTime=Date.now()),this.data.sweepNum+=t,this.saveData(),this.data.sweepNum},e.prototype.setSweepNum=function(t){this.data.sweepNum=t,this.saveData()},e.prototype.getSweepTime=function(){return this.data.sweepTime},e.prototype.setSweepTime=function(t){this.data.sweepTime=t,this.saveData()},e.prototype.getSubGameTime=function(){return this.data.subGameTime},e.prototype.setSubGameTime=function(t){this.data.subGameTime=t,this.saveData()},e.prototype.getSubGameTime2=function(){return this.data.subGameTime2},e.prototype.setSubGameTime2=function(t){this.data.subGameTime2=t,this.saveData()},e.prototype.getSubGameTime3=function(){return this.data.subGameTime3},e.prototype.setSubGameTime3=function(t){this.data.subGameTime3=t,this.saveData()},e.prototype.getSubGameTime4=function(){return this.data.subGameTime4},e.prototype.setSubGameTime4=function(t){this.data.subGameTime4=t,this.saveData()},e.prototype.getSubGameTime5=function(){return this.data.subGameTime5},e.prototype.setSubGameTime5=function(t){this.data.subGameTime5=t,this.saveData()},e.prototype.getSubGameTime6=function(){return this.data.subGameTime6},e.prototype.setSubGameTime6=function(t){this.data.subGameTime6=t,this.saveData()},e.prototype.getSubGameTime7=function(){return this.data.subGameTime7},e.prototype.setSubGameTime7=function(t){this.data.subGameTime7=t,this.saveData()},e.prototype.getSubGameTime8=function(){return this.data.subGameTime8},e.prototype.setSubGameTime8=function(t){this.data.subGameTime8=t,this.saveData()},e.prototype.getSubGameTimeByID=function(t){return 1==t?this.getSubGameTime():2==t?this.getSubGameTime2():3==t?this.getSubGameTime3():4==t?this.getSubGameTime4():5==t?this.getSubGameTime5():6==t?this.getSubGameTime6():7==t?this.getSubGameTime7():8==t?this.getSubGameTime8():void 0},e.prototype.setSubGameTimeByID=function(t,e){1==t?this.setSubGameTime(e):2==t?this.setSubGameTime2(e):3==t?this.setSubGameTime3(e):4==t?this.setSubGameTime4(e):5==t?this.setSubGameTime5(e):6==t?this.setSubGameTime6(e):7==t?this.setSubGameTime7(e):7==t&&this.setSubGameTime8(e)},e}(c.BaseData);a.GameDailyData=d,cc._RF.pop(),cc._RF.pop()},{}],GameData:[function(t,e,o){"use strict";cc._RF.push(e,"62303xKiPFJn6vULyxEWJxB","GameData");var i=e,n=o;cc._RF.push(i,"62303xKiPFJn6vULyxEWJxB","GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emGameDataKeys=void 0,function(t){t.BUFFarray="BUFFarray",t.BuffCfg="BuffCfg",t.CardCfg="CardCfg",t.CardQualityCfg="CardQualityCfg",t.ChallengeCfg="ChallengeCfg",t.EnemyCfg="EnemyCfg",t.giftCfg="giftCfg",t.GoodsCfg="GoodsCfg",t.LevelCfg="LevelCfg",t.paramsCfg="paramsCfg",t.ShopBoxCfg="ShopBoxCfg",t.DrawCardsReward="DrawCardsReward",t.SigninCfg="SigninCfg",t.DailyTasksCfg="DailyTasksCfg",t.AchieveCfg="AchieveCfg",t.AchieveTreasureChest="AchieveTreasureChest",t.TiesCfg="TiesCfg",t.rewardCfg="rewardCfg"}(n.emGameDataKeys||(n.emGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],GameEffect:[function(t,e,o){"use strict";cc._RF.push(e,"a8e5445IvlHsort67uBMi77","GameEffect");var i=t,n=e,a=o;cc._RF.push(n,"a8e5445IvlHsort67uBMi77","GameEffect");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("ResourceMgr"),h=i("Config"),f=i("DataMgr"),m=i("PlayerMgr"),g=i("BraveTowerEnum"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndDam=null,e.ndTies=null,e.ndSkill=null,e.aniBoss=null,e.aniTies13=null,e.labList=[],e.showList=[],e.nodeList=[],e.nodeList1=[],e.index1=0,e}return s(e,t),e.prototype.initData=function(t){this.gameCtrl=t,this.ndDam.active=!1,this.ndTies.active=!1,this.ndSkill.active=!1,this.aniBoss.node.active=!1,this.aniTies13.node.active=!1},e.prototype.showDamageNum=function(t,e,o){var i=this,n=this.labList.shift();n||(n=cc.instantiate(this.ndDam)).setParent(this.node),n.active=!0;var a=this.node.convertToNodeSpaceAR(t);n.setPosition(a);var r=n.getComponentInChildren(cc.Label);switch(r.string=Math.ceil(e).toFixed(0),n.children[0].active=!1,o){case 0:r.node.color=(new cc.Color).fromHEX("#ffffff");break;case 1:r.node.color=(new cc.Color).fromHEX("#ff2824");break;case 2:r.node.color=(new cc.Color).fromHEX("#ffee24"),n.children[0].active=!0,r.string="+"+Math.ceil(e).toFixed(0)}cc.tween(n).set({scale:0,opacity:255}).show().by(.1/this.gameCtrl.getSpeed(),{scale:1,y:20},{easing:"cubicOut"}).by(.7/this.gameCtrl.getSpeed(),{scale:-.5,y:50,opacity:-100}).hide().call(function(){i.labList.push(n)}).start()},e.prototype.changeCard=function(t){var e=this,o=m.PlayerMgr.getInstance().getCardTies(t),i=function(t){for(var o=e.gameCtrl.gameTrammel.tiesInfo,i=0;i<o.length;i++){var n=o[i];if(n.id==t)return n}return null};o.sort(function(t,e){var o=i(t),n=f.DataMgr.getInstance().getTiesCfg(t);return(o?o.cardList.length:0)>=n.effectList.length?-1:t-e}),o.forEach(function(t){e.showTies(t)})},e.prototype.showTies=function(t){var e=this,o=this.nodeList.shift();o||(o=cc.instantiate(this.ndTies)).setParent(this.node),o.active=!0,o.setPosition(this.ndTies.position),this.showList.forEach(function(t){cc.tween(t).by(.18,{y:85}).start()}),this.showList.push(o);var i=f.DataMgr.getInstance().getTiesCfg(t);this.loadSpriteFrame(g.BraveTowerBundelName.IconTies,i.icon,function(t){o.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t});var n=function(){for(var o=e.gameCtrl.gameTrammel.tiesInfo,i=0;i<o.length;i++){var n=o[i];if(n.id==t)return n}return null}();o.getChildByName("labName").getComponent(cc.Label).string=this.T(i.name)+" "+(n?n.cardList.length:0)+"/"+i.effectList.length,o.getChildByName("labName").color=(new cc.Color).fromHEX((n?n.cardList.length:0)>=i.effectList.length?"#ffdb56":"#FFFFFF"),cc.tween(o).set({scale:0,opacity:255}).to(.2,{scale:1},{easing:"cubicOut"}).delay(.5).to(1,{scale:0,opacity:0}).call(function(){o.active=!1,e.nodeList.push(o);for(var t=0;t<e.showList.length;t++)if(e.showList[t].uuid==o.uuid){e.showList.splice(t,1);break}}).start()},e.prototype.showSkill=function(t,e,o){var i=this,n=this.nodeList1.shift();n||(n=cc.instantiate(this.ndSkill)).setParent(this.node),n.active=!0,n.setPosition(cc.misc.clampf(o.x-cc.winSize.width/2,-300,300),-156);var a=f.DataMgr.getInstance().getCardCfg(t);this.loadSpriteFrame(g.BraveTowerBundelName.IconSkill,a.CardSkillCfg[e].icon,function(t){n.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),n.getChildByName("labName").getComponent(cc.Label).string=""+this.T(a.CardSkillCfg[e].name),cc.tween(n).set({opacity:0,scale:.6}).to(.5,{opacity:255,position:cc.v3(cc.misc.clampf(o.x-cc.winSize.width/2,-300,300),-130)},{easing:"cubicOut"}).delay(1.5).to(.5,{opacity:0}).call(function(){n.active=!1,i.nodeList1.push(n)}).start()},e.prototype.showBoss=function(){var t=this;this.aniBoss.node.active=!0,this.aniBoss.setAnimation(0,"animation",!1),this.aniBoss.setCompleteListener(function(){t.aniBoss.setCompleteListener(null),t.aniBoss.node.active=!1})},e.prototype.showBulletHit=function(t){var e=this;this.index1>10||(this.index1++,d.ResourceMgr.getInstance().getNode(g.BraveTowerPoolName.EffectEnemyHitName,g.BraveTowerBundelName.Effect,g.BraveTowerPrefabName.EffectHit,function(o){o.setParent(e.node),o.active=!0;var i=e.node.convertToNodeSpaceAR(t);o.setPosition(i);var n=o.getComponentInChildren(sp.Skeleton);n.timeScale=e.gameCtrl.getSpeed(),n.setAnimation(0,"animation",!1),n.setCompleteListener(function(){e.index1--,n.setCompleteListener(null),u.PoolMgr.getInstance().freeNode(g.BraveTowerPoolName.EffectEnemyHitName,o)})}))},e.prototype.showEnemyDie=function(t){var e=this;d.ResourceMgr.getInstance().getNode(g.BraveTowerPoolName.EffectEnemyDeadName,g.BraveTowerBundelName.Effect,g.BraveTowerPrefabName.EffectDie,function(o){o.setParent(e.node),o.active=!0;var i=e.node.convertToNodeSpaceAR(t);o.setPosition(i);var n=o.getComponentInChildren(sp.Skeleton);n.timeScale=e.gameCtrl.getSpeed(),n.setAnimation(0,"animation",!1),n.setCompleteListener(function(){n.setCompleteListener(null),u.PoolMgr.getInstance().freeNode(g.BraveTowerPoolName.EffectEnemyDeadName,o)})})},e.prototype.showStun=function(t,e){var o=this;d.ResourceMgr.getInstance().getNode(g.BraveTowerPoolName.EffectStunName,g.BraveTowerBundelName.Effect,g.BraveTowerPrefabName.EffectStun,function(i){i.setParent(t.ndEffect),i.setPosition(0,0,0),i.active=!0;var n=i.getComponentInChildren(sp.Skeleton);n.timeScale=o.gameCtrl.getSpeed(),n.setAnimation(0,"animation",!0),e&&e(i)})},e.prototype.showSlow=function(t,e){var o=this;d.ResourceMgr.getInstance().getNode(g.BraveTowerPoolName.EffectSlowName,g.BraveTowerBundelName.Effect,g.BraveTowerPrefabName.EffectSlow,function(i){i.setParent(t.ndEffect),i.setPosition(0,0,0),i.active=!0;var n=i.getComponentInChildren(sp.Skeleton);n.timeScale=o.gameCtrl.getSpeed(),n.setAnimation(0,"ani1",!0),e&&e(i)})},e.prototype.showHeal=function(t){var e=this;d.ResourceMgr.getInstance().getNode(g.BraveTowerPoolName.EffectRecoveryName,g.BraveTowerBundelName.Effect,g.BraveTowerPrefabName.EffectRecovery,function(o){o.setParent(e.node),o.active=!0;var i=e.node.convertToNodeSpaceAR(t);o.setPosition(i);var n=o.getComponentInChildren(sp.Skeleton);n.timeScale=e.gameCtrl.getSpeed(),n.setAnimation(0,"hit",!1),n.setCompleteListener(function(){n.setCompleteListener(null),u.PoolMgr.getInstance().freeNode(g.BraveTowerPoolName.EffectRecoveryName,o)})})},e.prototype.showTies13=function(){var t=this;this.aniTies13.node.active=!0,this.aniTies13.setAnimation(0,"animation",!1),p.AudioMgr.getInstance().playEffect(h.AudioId.dialogue,"Ties13_1"),p.AudioMgr.getInstance().playEffect(h.AudioId.bajie,"Ties13_2"),this.aniTies13.setCompleteListener(function(){t.aniTies13.setCompleteListener(null),t.aniTies13.node.active=!1});for(var e=this.gameCtrl.ctrUI.getAllCardList(),o=function(o){var i=e[o].node.convertToWorldSpaceAR(cc.v3(0,100,0));d.ResourceMgr.getInstance().getNode(g.BraveTowerPoolName.EffectTies13Name,g.BraveTowerBundelName.Effect,"Ties13",function(e){e.setParent(t.node),e.active=!0;var o=t.node.convertToNodeSpaceAR(i);e.setPosition(o),e.scale=.8,cc.tween(e).by(2,{y:50},{easing:"cubicOut"}).call(function(){e.active=!1,u.PoolMgr.getInstance().freeNode(g.BraveTowerPoolName.EffectTies13Name,e)}).start()})},i=0;i<e.length;i++)o(i)},c([_({type:cc.Node,tooltip:"\u4f24\u5bb3\u6570\u5b57"})],e.prototype,"ndDam",void 0),c([_({type:cc.Node,tooltip:"\u7f81\u7eca"})],e.prototype,"ndTies",void 0),c([_({type:cc.Node,tooltip:"\u7f81\u7eca"})],e.prototype,"ndSkill",void 0),c([_({type:sp.Skeleton,tooltip:"boss\u52a8\u753b"})],e.prototype,"aniBoss",void 0),c([_({type:sp.Skeleton,tooltip:"boss\u52a8\u753b"})],e.prototype,"aniTies13",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"80f4dWRIVNHvZ5zx+sIgMeT","GameEnumData");var i=e,n=o;cc._RF.push(i,"80f4dWRIVNHvZ5zx+sIgMeT","GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.BraveTowerEnumTiesCfg=n.BraveTowerEnumParamsCfg=n.BraveTowerEnumGoodsCfg=n.BraveTowerEnumCardCfg=n.BraveTowerEnumBuffID=n.BraveTowerEnumBuffType=void 0,function(t){t[t.BuffType01=1]="BuffType01",t[t.BuffType02=2]="BuffType02",t[t.BuffType03=3]="BuffType03",t[t.BuffType04=4]="BuffType04",t[t.BuffType05=5]="BuffType05",t[t.BuffType06=6]="BuffType06",t[t.BuffType07=7]="BuffType07",t[t.BuffType08=8]="BuffType08",t[t.BuffType09=9]="BuffType09",t[t.BuffType10=10]="BuffType10",t[t.BuffType11=11]="BuffType11",t[t.BuffType12=12]="BuffType12",t[t.BuffType13=13]="BuffType13",t[t.BuffType14=14]="BuffType14",t[t.BuffType15=15]="BuffType15",t[t.BuffType16=16]="BuffType16",t[t.BuffType17=17]="BuffType17",t[t.BuffType18=18]="BuffType18",t[t.BuffType19=19]="BuffType19",t[t.BuffType20=20]="BuffType20",t[t.BuffType21=21]="BuffType21",t[t.BuffType22=22]="BuffType22",t[t.BuffType23=23]="BuffType23",t[t.BuffType24=24]="BuffType24",t[t.BuffType25=25]="BuffType25",t[t.BuffType26=26]="BuffType26",t[t.BuffType27=27]="BuffType27",t[t.BuffType28=28]="BuffType28",t[t.BuffType29=29]="BuffType29",t[t.BuffType30=30]="BuffType30",t[t.BuffType31=31]="BuffType31",t[t.BuffType32=32]="BuffType32",t[t.BuffType33=33]="BuffType33",t[t.BuffType34=34]="BuffType34",t[t.BuffType35=35]="BuffType35",t[t.BuffType36=36]="BuffType36",t[t.BuffType37=37]="BuffType37",t[t.BuffType38=38]="BuffType38",t[t.BuffType39=39]="BuffType39",t[t.BuffType40=40]="BuffType40",t[t.BuffType41=41]="BuffType41",t[t.BuffType42=42]="BuffType42",t[t.BuffType43=43]="BuffType43",t[t.BuffType44=44]="BuffType44",t[t.BuffType45=45]="BuffType45",t[t.BuffType46=46]="BuffType46",t[t.BuffType47=47]="BuffType47"}(n.BraveTowerEnumBuffType||(n.BraveTowerEnumBuffType={})),function(t){t[t.BuffID39=39]="BuffID39",t[t.BuffID40=40]="BuffID40",t[t.BuffID41=41]="BuffID41",t[t.BuffID42=42]="BuffID42",t[t.BuffID43=43]="BuffID43",t[t.BuffID44=44]="BuffID44",t[t.BuffID45=45]="BuffID45",t[t.BuffID46=46]="BuffID46",t[t.BuffID47=47]="BuffID47",t[t.BuffID48=48]="BuffID48",t[t.BuffID49=49]="BuffID49",t[t.BuffID50=50]="BuffID50",t[t.BuffID51=51]="BuffID51",t[t.BuffID52=52]="BuffID52",t[t.BuffID53=53]="BuffID53",t[t.BuffID54=54]="BuffID54",t[t.BuffID55=55]="BuffID55",t[t.BuffID56=56]="BuffID56",t[t.BuffID57=57]="BuffID57",t[t.BuffID58=58]="BuffID58",t[t.BuffID59=59]="BuffID59",t[t.BuffID60=60]="BuffID60",t[t.BuffID61=61]="BuffID61",t[t.BuffID62=62]="BuffID62",t[t.BuffID63=63]="BuffID63",t[t.BuffID64=64]="BuffID64",t[t.BuffID65=65]="BuffID65",t[t.BuffID66=66]="BuffID66",t[t.BuffID67=67]="BuffID67",t[t.BuffID68=68]="BuffID68",t[t.BuffID69=69]="BuffID69",t[t.BuffID70=70]="BuffID70",t[t.BuffID71=71]="BuffID71",t[t.BuffID72=72]="BuffID72"}(n.BraveTowerEnumBuffID||(n.BraveTowerEnumBuffID={})),function(t){t[t.Card01=1001]="Card01",t[t.Card02=1002]="Card02",t[t.Card03=1003]="Card03",t[t.Card04=1004]="Card04",t[t.Card05=1005]="Card05",t[t.Card06=1006]="Card06",t[t.Card07=1007]="Card07",t[t.Card08=1008]="Card08",t[t.Card09=1009]="Card09",t[t.Card10=1010]="Card10",t[t.Card11=1011]="Card11",t[t.Card12=1012]="Card12",t[t.Card13=1013]="Card13",t[t.Card14=1014]="Card14",t[t.Card15=1015]="Card15",t[t.Card16=1016]="Card16",t[t.Card17=1017]="Card17",t[t.Card18=1018]="Card18"}(n.BraveTowerEnumCardCfg||(n.BraveTowerEnumCardCfg={})),function(t){t[t.Coin=2001]="Coin",t[t.Diamond=2002]="Diamond",t[t.Coupon=2003]="Coupon",t[t.BlueCard=2004]="BlueCard",t[t.PurpleCard=2005]="PurpleCard",t[t.GoldCard=2006]="GoldCard",t[t.SilverCoin=2007]="SilverCoin",t[t.AchievePoint=2008]="AchievePoint"}(n.BraveTowerEnumGoodsCfg||(n.BraveTowerEnumGoodsCfg={})),function(t){t[t.Params01=1]="Params01",t[t.Params02=2]="Params02",t[t.Params03=3]="Params03",t[t.Params04=4]="Params04",t[t.Params05=5]="Params05",t[t.Params06=6]="Params06",t[t.Params07=7]="Params07",t[t.Params08=8]="Params08",t[t.Params09=9]="Params09",t[t.Params10=10]="Params10",t[t.Params11=11]="Params11",t[t.Params12=12]="Params12",t[t.Params13=13]="Params13",t[t.Params14=14]="Params14",t[t.Params15=15]="Params15",t[t.Params16=16]="Params16",t[t.Params17=17]="Params17",t[t.Params18=18]="Params18",t[t.Params19=19]="Params19",t[t.Params20=20]="Params20",t[t.Params21=21]="Params21",t[t.Params22=22]="Params22",t[t.Params23=23]="Params23",t[t.Params24=24]="Params24",t[t.Params25=25]="Params25",t[t.Params26=26]="Params26",t[t.Params27=27]="Params27",t[t.Params28=28]="Params28",t[t.Params29=29]="Params29",t[t.Params30=30]="Params30",t[t.Params31=31]="Params31",t[t.Params32=32]="Params32",t[t.Params33=33]="Params33",t[t.Params34=34]="Params34",t[t.Params35=35]="Params35",t[t.Params36=36]="Params36",t[t.Params37=37]="Params37",t[t.Params38=38]="Params38",t[t.Params39=39]="Params39",t[t.Params40=40]="Params40",t[t.Params41=41]="Params41",t[t.Params42=42]="Params42",t[t.Params43=43]="Params43",t[t.Params44=44]="Params44",t[t.Params45=45]="Params45"}(n.BraveTowerEnumParamsCfg||(n.BraveTowerEnumParamsCfg={})),function(t){t[t.Ties01=1]="Ties01",t[t.Ties02=2]="Ties02",t[t.Ties03=3]="Ties03",t[t.Ties04=4]="Ties04",t[t.Ties05=5]="Ties05",t[t.Ties06=6]="Ties06",t[t.Ties07=7]="Ties07",t[t.Ties08=8]="Ties08",t[t.Ties09=9]="Ties09",t[t.Ties10=10]="Ties10",t[t.Ties11=11]="Ties11",t[t.Ties12=12]="Ties12",t[t.Ties13=13]="Ties13",t[t.Ties14=14]="Ties14",t[t.Ties15=15]="Ties15"}(n.BraveTowerEnumTiesCfg||(n.BraveTowerEnumTiesCfg={})),cc._RF.pop(),cc._RF.pop()},{}],GameGuideData:[function(t,e,o){"use strict";cc._RF.push(e,"0284aK2rV1I8btCK3uenXmV","GameGuideData");var i=t,n=e,a=o;cc._RF.push(n,"0284aK2rV1I8btCK3uenXmV","GameGuideData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.GuideData=void 0;var c=i("BaseData"),l=(i("BasePlatform"),i("PlatformSetting"),i("Config")),p=function(){this.currentId=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=2,e.ecrypt=!1,e.aliseMap={currentId:"1"},e.gameKey=l.GameConfig.AppCacheName+"guide",e.endId=[8,10],e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(){9==this.data.currentId&&(this.data.currentId=10,this.saveData())},e.prototype.getCurrentId=function(){return this.data.currentId},e.prototype.addCurrentId=function(t){void 0===t&&(t=!0),this.data.currentId+=1,t&&this.saveData()},e.prototype.setCurrentId=function(t){this.data.currentId=t,this.saveData()},e.prototype.getGuideEnd=function(t){return this.data.currentId>=this.endId[t-1]&&(this.data.currentId,this.endId[this.endId.length-1],!0)},e}(c.BaseData);a.GuideData=u,cc._RF.pop(),cc._RF.pop()},{}],GamePlayInfo:[function(t,e,o){"use strict";cc._RF.push(e,"ca128RKSA1OFpuSmRpp9Xb/","GamePlayInfo");var i=t,n=e,a=o;cc._RF.push(n,"ca128RKSA1OFpuSmRpp9Xb/","GamePlayInfo"),Object.defineProperty(a,"__esModule",{value:!0}),a.GamePlayInfo=void 0;var r=i("GameEnumData"),s=i("DataMgr"),c=function(){function t(t){this.baseHpMax=100,this.addNum=0,this.hp=50,this.hpMax=100,this.exp=0,this.expMax=100,this.level=1,this.gameCtrl=t,this.baseHpMax=parseInt(s.DataMgr.getInstance().getParamCfg(r.BraveTowerEnumParamsCfg.Params10)),this.addNum=0}return t.prototype.initData=function(){this.hpMax=this.baseHpMax,this.hp=this.hpMax,this.gameCtrl.ctrUI.upHpView(),this.level=1,this.exp=0;var t=this.gameCtrl.gameData.levelCfg.UpgradaCfg[this.level-1];this.expMax=t.value,this.gameCtrl.ctrUI.upEXView()},t.prototype.addHp=function(t){this.hp+=t,this.hp>this.hpMax&&(this.hp=this.hpMax),this.gameCtrl.ctrUI.upHpView(),this.gameCtrl.gameSkillBuff.addBuffSkill36(),this.gameCtrl.gameSkillBuff.addBuffSkill39(1);var e=this.gameCtrl.ctrUI.labProHp.node;this.gameCtrl.ctrEffect.showHeal(e.convertToWorldSpaceAR(cc.v2(0,0))),this.gameCtrl.needUpdateCardData=!0},t.prototype.subHp=function(t){this.hp-=t,this.hp<0&&(this.hp=0,this.gameCtrl.endGame(!1)),this.gameCtrl.ctrUI.upHpView(),this.gameCtrl.gameSkillBuff.addBuffSkill36(),this.gameCtrl.gameSkillBuff.addBuffSkill39(1),this.gameCtrl.gameBuff.addBuff62(t/this.hpMax),this.gameCtrl.needUpdateCardData=!0},t.prototype.addMax=function(t){this.addNum+=t;var e=this.hpMax-this.hp;this.hpMax=this.baseHpMax*(1+this.addNum),this.hp=this.hpMax-e,this.gameCtrl.ctrUI.upHpView()},t.prototype.addLevel=function(){this.level++,this.exp=this.expMax-this.exp;var t=this.gameCtrl.gameData.levelCfg.UpgradaCfg[this.level-1];t||(t=this.gameCtrl.gameData.levelCfg.UpgradaCfg[this.gameCtrl.gameData.levelCfg.UpgradaCfg.length-1]),this.expMax=t.value,this.gameCtrl.ctrUI.upEXView(),this.gameCtrl.ctrUI.upCardProbability()},t}();a.GamePlayInfo=c,cc._RF.pop(),cc._RF.pop()},{}],GameSetData:[function(t,e,o){"use strict";cc._RF.push(e,"362a5RVl5lCwZA3TO2CH5Ch","GameSetData");var i=t,n=e,a=o;cc._RF.push(n,"362a5RVl5lCwZA3TO2CH5Ch","GameSetData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.GameSetData=void 0;var c=i("BaseData"),l=i("Config"),p=function(){this.effect=!0,this.speed=1,this.speedAd=[1],this.auto=!1,this.showTab=0,this.listTime={},this.version=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=2,e.ecrypt=!1,e.aliseMap={effect:"1",speed:"2",speedAd:"3",version:"Z"},e.gameKey=l.GameConfig.AppCacheName+"setData",e.vesion=1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(){this.data.listTime||(this.data.listTime={},this.saveData())},e.prototype.getEffect=function(){return this.data.effect},e.prototype.setEffect=function(t){this.data.effect=t,this.saveData()},e.prototype.getSpeed=function(){return this.data.speed},e.prototype.setSpeed=function(t){this.data.speed=t,this.saveData()},e.prototype.getSpeedAd=function(t){return this.data.speedAd[t-1]},e.prototype.setSpeedAd=function(t){this.data.speedAd[t-1]=1,this.saveData()},e.prototype.getAuto=function(){return this.data.auto},e.prototype.setAuto=function(t){this.data.auto=t,this.saveData()},e.prototype.getShowTab=function(){return this.data.showTab},e.prototype.setShowTab=function(t){this.data.showTab=t,this.saveData()},e.prototype.getTimeByKey=function(t){return this.data.listTime[t]||(this.data.listTime[t]=0),this.data.listTime[t]},e.prototype.setTimeByKey=function(t,e){this.data.listTime[t]=e,this.saveData()},e.prototype.addTimeByKey=function(t){return this.data.listTime[t]||(this.data.listTime[t]=0),this.data.listTime[t]++,this.saveData(),this.data.listTime[t]},e}(c.BaseData);a.GameSetData=u,cc._RF.pop(),cc._RF.pop()},{}],GameShareData:[function(t,e,o){"use strict";cc._RF.push(e,"240ddIAdclBXaCCFKKO9/Bk","GameShareData");var i=t,n=e,a=o;cc._RF.push(n,"240ddIAdclBXaCCFKKO9/Bk","GameShareData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.ShareData=void 0;var c=i("BaseData"),l=i("LogMgr"),p=i("SdkMgr"),u=i("TimeUtils"),d=i("UIUtils"),h=i("Config"),f=function(){this.path="",this.dayShareNum=0,this.daylastShareTime=-1},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aliseMap={path:"1",dayShareNum:"2",daylastShareTime:"3"},e.protoId=3,e.gameKey=h.GameConfig.AppCacheName+"shareData",e.timeTotalStop=15,e.needRecordVideo=!0,e.recordTime=0,e.canShare=!1,e.isStart=!1,e.isPause=!1,e.isStop=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new f,this.data},e.prototype.initData=function(t){t||-1!=this.data.daylastShareTime&&(u.TimeUtils.compareIsToday(this.data.daylastShareTime)||(this.data.daylastShareTime=-1,this.data.dayShareNum=0,this.saveData()))},e.prototype.startRecord=function(){this.needRecordVideo&&(l.LogMgr.getInstance().debug("\u5f00\u59cb\u5f55\u5c4f"),this.isStart=!0,this.isPause=!1,p.SdkMgr.getInstance().recordScreen(),this.needRecordVideo=!1,this.canShare=!1,d.UIUtils.schedule(this.secondUpdate,this,1),this.data.path="",this.saveData())},e.prototype.playRecord=function(){this.isStart?this.isPause?this.restartRecord():this.pauseRecord():this.startRecord()},e.prototype.pauseRecord=function(){this.isStart&&(p.SdkMgr.getInstance().pauseRecord(),this.isPause=!0,l.LogMgr.getInstance().debug("\u6682\u505c\u5f55\u5c4f"))},e.prototype.restartRecord=function(){this.isPause&&(this.isPause=!1,p.SdkMgr.getInstance().restartRecord(),l.LogMgr.getInstance().debug("\u91cd\u65b0\u5f55\u5c4f"))},e.prototype.stopRecord=function(t,e){var o=this;this.recordTime<=0||(d.UIUtils.unSchedule(this.secondUpdate,this),this.isStart=!1,this.isPause=!1,p.SdkMgr.getInstance().stopRecord(t,function(t){o.data.path=t,o.recordTime>=15&&(o.canShare=!0),o.isStop=!0,o.recordTime=0,o.saveData(),e&&e()}))},e.prototype.getSharePath=function(){return this.data.path},e.prototype.getCanShare=function(){return this.recordTime>=15||this.canShare},e.prototype.getRecordTime=function(){return this.recordTime},e.prototype.toShare=function(t,e){var o=this;p.SdkMgr.getInstance().share(this.data.path,function(){o.data.path="",t&&o.data.dayShareNum++,o.needRecordVideo=!0,o.canShare=!1,o.isStop=!1,o.clearData(),o.saveData(),e&&e()})},e.prototype.getTodayCanShare=function(){return!0},e.prototype.secondUpdate=function(){this.isPause||(this.recordTime++,this.recordTime>=290&&this.stopRecord(!1))},e.prototype.checkStop=function(t){return this.isStop?(t&&t(),!0):(this.recordTime>=this.timeTotalStop||this.recordTime>=290)&&(this.stopRecord(!1,t),!0)},e.prototype.clearData=function(){this.isStop=!1,this.isStart=!1,this.needRecordVideo=!0,this.data.path="",this.recordTime=0,this.saveData()},e}(c.BaseData);a.ShareData=m,cc._RF.pop(),cc._RF.pop()},{}],GameSkillBuff:[function(t,e,o){"use strict";cc._RF.push(e,"b391dBH0c5PvZgxSwTEA83n","GameSkillBuff");var i=t,n=e,a=o;cc._RF.push(n,"b391dBH0c5PvZgxSwTEA83n","GameSkillBuff");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.CardBuffType=void 0;var s,c=i("LogMgr"),l=i("GameEnumData"),p=i("DataMgr"),u=i("BraveTowerEnum"),d=i("GameCtrl"),h=cc._decorator,f=h.ccclass,m=(h.property,function(){function t(t){this.cardBuffTime=[],this.gameCtrl=t}return t.prototype.onUpTime=function(t){for(var e=0;e<this.cardBuffTime.length;e++){var o=this.cardBuffTime[e];-1!=o.time&&(o.time-=t,o.time<=0&&(this.cardBuffTime.splice(e,1),this.gameCtrl.needUpdateCardData=!0,e--))}},t.prototype.onUpdateCard=function(){this.addBuffSkill14(),this.addBuffSkill15(),this.addBuffSkill30(),this.addBuffSkill33(),this.gameCtrl.needUpdateCardData=!0},t.prototype.addBuffSkill14=function(){var t=this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card05);t&&t.starNum>=u.BraveTowerParameter.SkillUnlockStar1&&this.gameCtrl.ctrUI.getAllCardList().length<t.ctrCard.awakList[1].val[0]?this.setCardBuffTime(s.Skill14,-1,t.ctrCard.awakList[1].val[1]):this.delCardBuff(s.Skill14)},t.prototype.addBuffSkill15=function(){var t=this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card05);if(t&&t.starNum>=u.BraveTowerParameter.SkillUnlockStar2){var e=this.gameCtrl.gameData.roundNum;c.LogMgr.getInstance().debug("Skill15",t.ctrCard.awakList[2].val[0],e),this.setCardBuffTime(s.Skill15,-1,t.ctrCard.awakList[2].val[0]*e)}},t.prototype.addBuffSkill21=function(){var t=this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card07);if(t&&t.starNum>=u.BraveTowerParameter.SkillUnlockStar2){for(var e=0,o=0;o<this.cardBuffTime.length;o++)this.cardBuffTime[o].id==s.Skill21&&e++;c.LogMgr.getInstance().debug("Skill21",e),e<t.ctrCard.awakList[2].val[1]&&(c.LogMgr.getInstance().debug("Skill21",t.ctrCard.awakList[2].val[0]),this.addCardBuffTime(s.Skill21,-1,t.ctrCard.awakList[2].val[0],[l.BraveTowerEnumCardCfg.Card07]))}},t.prototype.addBuffSkill30=function(){var t=this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card10);if(t&&t.starNum>=u.BraveTowerParameter.SkillUnlockStar2){for(var e=this.gameCtrl.ctrUI.getAllCardList(),o=!0,i=0;i<e.length;i++){var n=e[i];if(2==p.DataMgr.getInstance().getCardCfg(n.cardId).Gender){o=!1;break}}o?this.setCardBuffTime(s.Skill30,-1,t.ctrCard.awakList[2].val[0],[l.BraveTowerEnumCardCfg.Card10]):this.delCardBuff(s.Skill30)}else this.delCardBuff(s.Skill30)},t.prototype.addBuffSkill33=function(){var t=this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card11);if(t&&t.starNum>=u.BraveTowerParameter.SkillUnlockStar2){for(var e=this.gameCtrl.ctrUI.getAllCardList(),o=0,i=0;i<e.length;i++){var n=e[i];2==p.DataMgr.getInstance().getCardCfg(n.cardId).Gender&&o++}c.LogMgr.getInstance().debug("Skill33",o),this.setCardBuffTime(s.Skill33,-1,t.ctrCard.awakList[2].val[0]*o,[l.BraveTowerEnumCardCfg.Card11])}else this.delCardBuff(s.Skill33)},t.prototype.addBuffSkill36=function(){var t=this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card12);t&&t.starNum>=u.BraveTowerParameter.SkillUnlockStar2&&this.gameCtrl.gamePlayInfo.hp>=this.gameCtrl.gamePlayInfo.hpMax?this.setCardBuffTime(s.Skill36,-1,t.ctrCard.awakList[2].val[0]):this.delCardBuff(s.Skill36)},t.prototype.addBuffSkill39=function(t){var e=this.gameCtrl.ctrUI.getCard(l.BraveTowerEnumCardCfg.Card13);if(e&&e.starNum>=u.BraveTowerParameter.SkillUnlockStar2){if(2==t&&this.gameCtrl.gamePlayInfo.hp<this.gameCtrl.gamePlayInfo.hpMax)return void this.gameCtrl.gamePlayInfo.addHp(e.ctrCard.awakList[2].val[1]);this.gameCtrl.gamePlayInfo.hp>=this.gameCtrl.gamePlayInfo.hpMax?this.setCardBuffTime(s.Skill39,-1,e.ctrCard.awakList[2].val[0],[l.BraveTowerEnumCardCfg.Card13]):this.delCardBuff(s.Skill39)}else this.delCardBuff(s.Skill39)},t.prototype.setCardBuffTime=function(t,e,o,i,n){void 0===i&&(i=null),void 0===n&&(n=null);for(var a=!0,r=0;r<this.cardBuffTime.length;r++){var s=this.cardBuffTime[r];s.id==t&&(s.time=e,s.num=o,s.cardList1=i,s.cardList2=n,a=!1)}a&&this.cardBuffTime.push({id:t,time:e,num:o,cardList1:i,cardList2:n}),this.gameCtrl.needUpdateCardData=!0},t.prototype.addCardBuffTime=function(t,e,o,i,n){void 0===i&&(i=null),void 0===n&&(n=null),this.cardBuffTime.push({id:t,time:e,num:o,cardList1:i,cardList2:n}),this.gameCtrl.needUpdateCardData=!0},t.prototype.delCardBuff=function(t){for(var e=0;e<this.cardBuffTime.length;e++)this.cardBuffTime[e].id==t&&(this.cardBuffTime.splice(e,1),this.gameCtrl.needUpdateCardData=!0,e--)},t.prototype.hasCardBuff=function(t){for(var e=0;e<this.cardBuffTime.length;e++)if(this.cardBuffTime[e].id==t)return!0;return!1},t.prototype.getCardBuffTime=function(t,e){var o=0,i=[];switch(e){case d.CardBuffAddType.Attack:i=[s.Skill11,s.Skill14,s.Skill15,s.Skill21,s.Skill30,s.Skill33,s.Skill36,s.Skill39,s.Skill46];break;case d.CardBuffAddType.AttackSpeed:i=[s.Skill24,s.Skill251,s.Skill252,s.Skill49];break;case d.CardBuffAddType.Stun:i=[s.Skill47];break;case d.CardBuffAddType.Crit:i=[s.Skill52]}for(var n=0;n<this.cardBuffTime.length;n++){var a=this.cardBuffTime[n];if(i.includes(a.id)){if(a.cardList2&&a.cardList2.includes(t))continue;if(!a.cardList1){o+=a.num;continue}a.cardList1.includes(t)&&(o+=a.num)}}return o},r([f],t)}());a.default=m,function(t){t[t.Skill11=1]="Skill11",t[t.Skill14=2]="Skill14",t[t.Skill15=3]="Skill15",t[t.Skill21=4]="Skill21",t[t.Skill24=5]="Skill24",t[t.Skill251=6]="Skill251",t[t.Skill252=7]="Skill252",t[t.Skill28=8]="Skill28",t[t.Skill30=9]="Skill30",t[t.Skill33=10]="Skill33",t[t.Skill36=11]="Skill36",t[t.Skill39=12]="Skill39",t[t.Skill46=13]="Skill46",t[t.Skill47=14]="Skill47",t[t.Skill49=15]="Skill49",t[t.Skill52=16]="Skill52"}(s=a.CardBuffType||(a.CardBuffType={})),cc._RF.pop(),cc._RF.pop()},{}],GameSpawnCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f2808I7HxxEmKJ4iB25Vqmq","GameSpawnCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f2808I7HxxEmKJ4iB25Vqmq","GameSpawnCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.CellType=a.CellInfo=void 0;var l,p=i("RoleCtrl"),u=i("WeaponCtrl"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(){};a.CellInfo=m,function(t){t[t.Rule=1]="Rule",t[t.Error=2]="Error"}(l=a.CellType||(a.CellType={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tree=null,e.sword=null,e.treeNodes=[],e.swordNodes=[],e.vec3_2=new cc.Vec3(0,0,0),e.viewSize=new cc.Size(750,750),e.sizeTree=new cc.Size(120,120),e.mapInfo={},e.cellType=l.Error,e.initFlag=!1,e.gameStatus=0,e.timeMax=20,e.timeNow=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,this.viewSize.width=cc.view.getVisibleSize().width/1.2,this.viewSize.height=cc.view.getVisibleSize().height},e.prototype.start=function(){var t=p.default.instance.node.getPosition(),e=new cc.Vec3(t.x,t.y,0);this.updatePlayerTile(e)},e.prototype.initData=function(){var t=this.onPosToGrid(this.vec3_2),e=Math.ceil(this.viewSize.height/this.sizeTree.height),o=Math.ceil(this.viewSize.width/this.sizeTree.width);for(var i in this.mapInfo)Object.prototype.hasOwnProperty.call(this.mapInfo,i)&&(this.mapInfo[i].out=!0);for(var n=-Math.floor(e/2)-2;n<Math.floor(e/2)+2;n++)for(var a=-Math.floor(o/2)-2;a<Math.floor(o/2)+2;a++)this.onInfo(t.row+n,t.col+a).out=!1},e.prototype.onPosToGrid=function(t){var e,o=Math.floor(t.y/this.sizeTree.height);switch(this.cellType){case l.Rule:e=Math.floor(t.x/this.sizeTree.width);break;case l.Error:e=o%2==0?Math.floor(t.x/this.sizeTree.width):Math.floor((t.x-this.sizeTree.width/2)/this.sizeTree.width)}return{row:o,col:e}},e.prototype.onInfo=function(t,e){if(!this.mapInfo[t+"#"+e]){var o=new m;switch(o.pos=cc.v2(e*this.sizeTree.width,t*this.sizeTree.height),this.cellType){case 2:t%2==0||(o.pos.x+=this.sizeTree.width/2)}for(var i=this.node.getComponents(cc.PolygonCollider),n=3,a=0;a<i.length;a++){var r=i[a];if(cc.Intersection.pointInPolygon(o.pos,r.points))switch(r.tag){case 1:n=1,o.time=[0,10,1];break;case 2:n=2}if(3!=n)break}o.type=n,o.status=0;var s=this.sizeTree.width-this.tree.width,c=this.sizeTree.height-this.tree.height;o.treePos=cc.v2(s<=0?0:(Math.random()-.5)*s,c<=0?0:(Math.random()-.5)*c),this.mapInfo[t+"#"+e]=o}return this.mapInfo[t+"#"+e]},e.prototype.upMap=function(t){var e=this,o=0,i=function(t,i){var n;if(!(o>=10))if(t.out)t.tree&&(-1!==(n=e.treeNodes.indexOf(t))&&e.treeNodes.splice(n,1),t.tree.destroy(),t.tree=null),t.sword&&(-1!==(n=e.swordNodes.indexOf(t))&&e.swordNodes.splice(n,1),t.sword.destroy(),t.sword=null);else switch(t.status){case 0:t.tree||t.sword||(Math.random()<.95?(t.tree=cc.instantiate(e.tree),t.tree.setParent(e.node),t.tree.active=!0,t.tree.setPosition(t.pos.x+t.treePos.x,t.pos.y+t.treePos.y),t.tree.name=i,o++,e.treeNodes.push(t)):(t.sword=cc.instantiate(e.sword),t.sword.setParent(e.node),t.sword.active=!0,t.sword.setPosition(t.pos.x+t.treePos.x,t.pos.y+t.treePos.y),t.sword.name=i,o++,e.swordNodes.push(t)));break;case 1:t.tree&&(t.tree.destroy(),t.tree=null),t.sword&&(t.sword.destroy(),t.sword=null);break;case 2:t.tree||(t.tree=cc.instantiate(e.tree),t.tree.setParent(e.node),t.tree.active=!0,t.tree.setPosition(t.pos.x+t.treePos.x,t.pos.y+t.treePos.y),o++,t.tree.name=i,e.treeNodes.push(t));var a=cc.clamp01(t.time[0]/t.time[2]);t.tree.setScale(a,a,a)}};for(var n in this.mapInfo)if(Object.prototype.hasOwnProperty.call(this.mapInfo,n))switch((s=this.mapInfo[n]).type){case 2:switch(s.status){case 1:s.time[0]+=t,s.time[0]>=s.time[1]&&(s.status=2,s.time[0]=0);break;case 2:s.time[0]+=t,s.time[0]>=s.time[2]&&(s.status=0,s.time[0]=0)}i(s,n);break;case 3:i(s,n)}for(var a=[],r=0;r<this.node.children.length;r++){var s=this.node.children[r];a.push({y:s.getPosition().y,node:s})}a.sort(function(t,e){return e.y-t.y});for(var c=0;c<a.length;c++)(s=a[c]).node.setSiblingIndex(c)},e.prototype.updatePlayerTile=function(t){this.vec3_2=t,this.initData(),this.initFlag=!0},e.prototype.update=function(t){this.initFlag&&(this.upMap(t),this.updateTime(t))},e.prototype.updateTime=function(t){2!=this.gameStatus&&(0==this.gameStatus?(this.timeNow+=t,Math.floor(this.timeNow),this.timeNow>=this.timeMax&&(this.gameStatus=1,this.timeNow=0)):this.gameStatus)},e.prototype.getTreesNearPlayer=function(t,e){for(var o=[],i=0,n=this.treeNodes;i<n.length;i++){var a=n[i],r=a.tree.convertToWorldSpaceAR(cc.Vec3.ZERO),s=t.x-r.x,c=t.y-r.y;s*s+c*c<=e*e&&o.push(a)}return o},e.prototype.getSwordNearPlayer=function(t,e){for(var o=0,i=this.swordNodes;o<i.length;o++){var n=i[o],a=n.sword.convertToWorldSpaceAR(cc.Vec3.ZERO),r=t.x-a.x,s=t.y-a.y;if(r*r+s*s<=e*e){n.status=1;var c=this.swordNodes.indexOf(n);-1!==c&&this.swordNodes.splice(c,1),n.sword.destroy(),n.sword=null,u.default.instance.addWeapon(1)}}},e.prototype.treeDown=function(t){var e=this.onPosToGrid(t),o=this.onInfo(e.row,e.col);if(o&&o.tree){o.status=1;var i=this.treeNodes.indexOf(o);-1!==i&&this.treeNodes.splice(i,1),o.tree.destroy(),o.tree=null}},c([f(cc.Node)],e.prototype,"tree",void 0),c([f(cc.Node)],e.prototype,"sword",void 0),o=c([h],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],GameTaskData:[function(t,e,o){"use strict";cc._RF.push(e,"9a351Xf6yBKn6wiMOe37LDa","GameTaskData");var i=t,n=e,a=o;cc._RF.push(n,"9a351Xf6yBKn6wiMOe37LDa","GameTaskData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.GameTaskData=a.TaskInfo=void 0;var c=i("BaseData"),l=i("Config"),p=i("BraveTowerEnum"),u=i("DataMgr");a.TaskInfo=function(){};var d=function(){this.time=0,this.taskList=[],this.achievements=[],this.achievePoint=0,this.achievePointGet=[],this.version=1},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ecrypt=!1,e.aliseMap={time:"1",taskList:"2",achievements:"3",achievePoint:"4",achievePointGet:"5",id:"2a",level:"2b",type:"2c",num:"2d",max:"2e",isGet:"2f",version:"Z"},e.gameKey=l.GameConfig.AppCacheName+"GameTaskData",e.vesion=1,e}return s(e,t),e.prototype.createData=function(){return this.data=new d,this.data},e.prototype.initData=function(t){if(t)for(var e=u.DataMgr.getInstance().getAchieveCfgList(),o=0;o<e.length;o++){var i=e[o];if(1==i.Linear){var n={id:i.ID,level:1,type:i.type,num:0,max:i.para,isGet:!1};this.data.achievements.push(n)}}p.BraveTowerGameUtils.compareIsToday2(this.data.time)||this.initDailyData(),this.saveData()},e.prototype.initDailyData=function(){this.data.time=Date.now(),this.data.taskList=[];for(var t=u.DataMgr.getInstance().getTaskCfgList(),e=0;e<t.length;e++){var o=t[e],i={id:o.ID,level:1,type:o.type,num:0,max:o.para,isGet:!1};this.data.taskList.push(i)}this.addLoginDay()},e.prototype.getTaskList=function(){return this.data.taskList},e.prototype.getTaskReward=function(t){for(var e=0;e<this.data.taskList.length;e++){var o=this.data.taskList[e];if(o.id==t){o.isGet=!0,this.addDailyTaskNum(),this.saveData();break}}},e.prototype.getAchieveList=function(){return this.data.achievements},e.prototype.getAchieveReward=function(t){for(var e=0;e<this.data.achievements.length;e++){var o=this.data.achievements[e];if(o.id==t){var i=u.DataMgr.getInstance().getAchieveCfg(o.id);this.data.achievePoint+=i.AchieveDrop;var n=u.DataMgr.getInstance().getAchieveCfgByLevel(o.type,o.level+1);n?(o.id=n.ID,o.level=n.Linear,o.max=n.para):o.isGet=!0,this.saveData();break}}},e.prototype.getAchievePoint=function(){return this.data.achievePoint},e.prototype.getAchieveGetList=function(){return this.data.achievePointGet},e.prototype.addAchieveGet=function(t){this.data.achievePointGet[t]=1,this.saveData()},e.prototype.addLoginDay=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.LoginDays&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.LoginDays&&(o.num+=t)}this.saveData()},e.prototype.addDailyTaskNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.achievements.length;e++){var o=this.data.achievements[e];o.type==p.BraveTowerTaskType.DailyTaskNum&&(o.num+=t)}this.saveData()},e.prototype.addMainMapNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.MainMapNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.MainMapNum&&(o.num+=t)}this.saveData()},e.prototype.setMainMapProgress=function(){for(var t=0;t<this.data.taskList.length;t++)(e=this.data.taskList[t]).type==p.BraveTowerTaskType.MainMapProgress&&e.num;for(t=0;t<this.data.achievements.length;t++){var e;(e=this.data.achievements[t]).type==p.BraveTowerTaskType.MainMapProgress&&e.num}this.saveData()},e.prototype.setCardNum=function(t){for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.CardNum&&(o.num=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.CardNum&&(o.num=t)}this.saveData()},e.prototype.addCardLevel=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.CardLevel&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.CardLevel&&(o.num+=t)}this.saveData()},e.prototype.addDailyMapNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.DailyMapNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.DailyMapNum&&(o.num+=t)}this.saveData()},e.prototype.addRecruitNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.RecruitNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.RecruitNum&&(o.num+=t)}this.saveData()},e.prototype.addGetGold=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.GetGold&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.GetGold&&(o.num+=t)}this.saveData()},e.prototype.addCoreCombatKillNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.CoreCombatKillNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.CoreCombatKillNum&&(o.num+=t)}this.saveData()},e.prototype.addCoreCombatBuyCardNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.CoreCombatBuyCardNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.CoreCombatBuyCardNum&&(o.num+=t)}this.saveData()},e.prototype.addCoreCombatGetCoinNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.CoreCombatGetCoinNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.CoreCombatGetCoinNum&&(o.num+=t)}this.saveData()},e.prototype.addCoreCombatRefreshCardNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.CoreCombatRefreshCardNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.CoreCombatRefreshCardNum&&(o.num+=t)}this.saveData()},e.prototype.addAdNum=function(t){void 0===t&&(t=1);for(var e=0;e<this.data.taskList.length;e++)(o=this.data.taskList[e]).type==p.BraveTowerTaskType.AdNum&&(o.num+=t);for(e=0;e<this.data.achievements.length;e++){var o;(o=this.data.achievements[e]).type==p.BraveTowerTaskType.AdNum&&(o.num+=t)}this.saveData()},e}(c.BaseData);a.GameTaskData=h,cc._RF.pop(),cc._RF.pop()},{}],GameTrackDataEvent:[function(t,e,o){"use strict";cc._RF.push(e,"f641fBVlsdJaJ0/5J0ECoGg","GameTrackDataEvent");var i,n,a=e,r=o;cc._RF.push(a,"f641fBVlsdJaJ0/5J0ECoGg","GameTrackDataEvent"),Object.defineProperty(r,"__esModule",{value:!0}),r.EventCF=r.TrackId=void 0,function(t){t[t.dau=0]="dau",t[t.guide1=1]="guide1",t[t.guide2=2]="guide2",t[t.guide3=3]="guide3",t[t.guide4=4]="guide4",t[t.guide5=5]="guide5",t[t.guide6=6]="guide6",t[t.guide7=7]="guide7",t[t.guide8=8]="guide8",t[t.guide9=9]="guide9",t[t.add_desktop=10]="add_desktop",t[t.add_sidebar=11]="add_sidebar",t[t.levels_lv_X=12]="levels_lv_X",t[t.finish_lv_X=13]="finish_lv_X",t[t.extension_X_Y=14]="extension_X_Y",t[t.game_instance_X=15]="game_instance_X",t[t.Parkour_card=16]="Parkour_card",t[t.Walls_shooting=17]="Walls_shooting",t[t.Coins=18]="Coins",t[t.Diamonds=19]="Diamonds",t[t.Double_sign=20]="Double_sign",t[t.Draw_cards=21]="Draw_cards",t[t.Draw_cards10=22]="Draw_cards10",t[t.Gain_replace=23]="Gain_replace",t[t.Gain_all=24]="Gain_all",t[t.Victory_doubled=25]="Victory_doubled",t[t.Silver_coin=26]="Silver_coin",t[t.More_silver_coin=27]="More_silver_coin",t[t.Accelerate=28]="Accelerate",t[t.Extension_bubble=29]="Extension_bubble",t[t.Hero_card=30]="Hero_card",t[t.Copy_unlock=31]="Copy_unlock",t[t.Coin_bubbles=32]="Coin_bubbles",t[t.Gold_bubbles=33]="Gold_bubbles",t[t.Parkour_run=34]="Parkour_run",t[t.Walls_defended=35]="Walls_defended",t[t.Fight_dragon=36]="Fight_dragon",t[t.Help_girl=37]="Help_girl",t[t.Flying_Stone=38]="Flying_Stone",t[t.Girl_run=39]="Girl_run",t[t.Grab_Dragon_Balls=40]="Grab_Dragon_Balls",t[t.double_dragons=41]="double_dragons",t[t.Gacha=42]="Gacha",t[t.mahjong=43]="mahjong",t[t.pkkunlun=44]="pkkunlun",t[t.xinchun=45]="xinchun",t[t.conjure=46]="conjure",t[t.paopaolong=47]="paopaolong",t[t.paopaolong2=48]="paopaolong2",t[t.Demon_Roulette=49]="Demon_Roulette",t[t.Knife_pdd=50]="Knife_pdd",t[t.bullet_falls=51]="bullet_falls",t[t.xingqiu_Dragon=52]="xingqiu_Dragon",t[t.Backpack_Defense=53]="Backpack_Defense",t[t.Backpack_Defense2=54]="Backpack_Defense2",t[t.defense_line=55]="defense_line",t[t.wheel_pk=56]="wheel_pk",t[t.TD_breach=57]="TD_breach",t[t.BH_line=58]="BH_line",t[t.Drifting_World=59]="Drifting_World",t[t.Coins_X=60]="Coins_X",t[t.Diamonds_X=61]="Diamonds_X",t[t.Double_sign_X=62]="Double_sign_X",t[t.Draw_cards_X=63]="Draw_cards_X",t[t.Draw_cards10_X=64]="Draw_cards10_X",t[t.Gain_replace_X=65]="Gain_replace_X",t[t.Gain_all_X=66]="Gain_all_X",t[t.Victory_doubled_X=67]="Victory_doubled_X",t[t.Silver_coin_X=68]="Silver_coin_X",t[t.More_silver_coin_X=69]="More_silver_coin_X",t[t.Accelerate_X=70]="Accelerate_X",t[t.Extension_bubble_X=71]="Extension_bubble_X",t[t.Hero_card_X=72]="Hero_card_X",t[t.Copy_unlock_X=73]="Copy_unlock_X",t[t.Coin_bubbles_X=74]="Coin_bubbles_X",t[t.Gold_bubbles_X=75]="Gold_bubbles_X",t[t.Parkour_run_X=76]="Parkour_run_X",t[t.Walls_defended_X=77]="Walls_defended_X",t[t.Fight_dragon_X=78]="Fight_dragon_X",t[t.Help_girl_X=79]="Help_girl_X",t[t.Flying_Stone_X=80]="Flying_Stone_X",t[t.Girl_run_X=81]="Girl_run_X",t[t.Grab_Dragon_Balls_X=82]="Grab_Dragon_Balls_X",t[t.double_dragons_X=83]="double_dragons_X",t[t.Gacha_X=84]="Gacha_X",t[t.mahjong_X=85]="mahjong_X",t[t.pkkunlun_X=86]="pkkunlun_X",t[t.xinchun_X=87]="xinchun_X",t[t.conjure_X=88]="conjure_X",t[t.paopaolong_X=89]="paopaolong_X",t[t.paopaolong2_X=90]="paopaolong2_X",t[t.Demon_Roulette_X=91]="Demon_Roulette_X",t[t.Knife_pdd_X=92]="Knife_pdd_X",t[t.bullet_falls_X=93]="bullet_falls_X",t[t.xingqiu_Dragon_X=94]="xingqiu_Dragon_X",t[t.Backpack_Defense_X=95]="Backpack_Defense_X",t[t.Backpack_Defense2_X=96]="Backpack_Defense2_X",t[t.defense_line_X=97]="defense_line_X",t[t.wheel_pk_X=98]="wheel_pk_X",t[t.TD_breach_X=99]="TD_breach_X",t[t.BH_line_X=100]="BH_line_X",t[t.Drifting_World_X=101]="Drifting_World_X",t[t.time_1=102]="time_1",t[t.time_3=103]="time_3",t[t.time_5=104]="time_5",t[t.time_7=105]="time_7",t[t.time_10=106]="time_10",t[t.time_15=107]="time_15",t[t.time_20=108]="time_20",t[t.time_30=109]="time_30",t[t.dau_day_X=110]="dau_day_X",t[t.notice_X_Y=111]="notice_X_Y"}(n=r.TrackId||(r.TrackId={})),r.EventCF=((i={})[n.dau]={eventKey:"dau",eventValue:"dau",onlyOne:!0,info:"\u65e5\u6d3b\u4eba\u6570",alias:"1"},i[n.guide1]={eventKey:"guide",eventValue:"guide1",onlyOne:!0,info:"[\u5f15\u5bfc] \u8fdb\u5165\u4e3b\u754c\u9762\u7684\u4eba\u6570",alias:"2"},i[n.guide2]={eventKey:"guide",eventValue:"guide2",onlyOne:!0,info:"[\u5c40\u5185\u5f15\u5bfc] \u70b9\u51fb\u8fdb\u5165\u6e38\u620f",alias:"3"},i[n.guide3]={eventKey:"guide",eventValue:"guide3",onlyOne:!0,info:"[\u5c40\u5185\u5f15\u5bfc]\u70b9\u51fb\u8d2d\u4e70\u5361\u724c",alias:"4"},i[n.guide4]={eventKey:"guide",eventValue:"guide4",onlyOne:!0,info:"[\u5c40\u5185\u5f15\u5bfc]\u70b9\u51fb\u7f81\u7eca\u4fe1\u606f",alias:"5"},i[n.guide5]={eventKey:"guide",eventValue:"guide5",onlyOne:!0,info:"[\u5c40\u5185\u5f15\u5bfc]\u70b9\u51fb\u6269\u5efa",alias:"6"},i[n.guide6]={eventKey:"guide",eventValue:"guide6",onlyOne:!0,info:"[\u5c40\u5185\u5f15\u5bfc] \u70b9\u51fb\u5237\u65b0",alias:"7"},i[n.guide7]={eventKey:"guide",eventValue:"guide7",onlyOne:!0,info:"[\u5c40\u5185\u5f15\u5bfc]\u70b9\u51fb\u8d2d\u4e70\u5361\u724c",alias:"8"},i[n.guide8]={eventKey:"guide",eventValue:"guide8",onlyOne:!0,info:"[\u5916\u56f4\u5f15\u5bfc]\u70b9\u51fb\u62bd\u5361\u529f\u80fd\u6309\u94ae",alias:"9"},i[n.guide9]={eventKey:"guide",eventValue:"guide9",onlyOne:!0,info:"[\u5916\u56f4\u5f15\u5bfc]\u70b9\u51fb\u5355\u6b21\u62bd\u5361",alias:"10"},i[n.add_desktop]={eventKey:"guide",eventValue:"add_desktop",onlyOne:!0,info:"\u6dfb\u52a0\u684c\u9762\u2014\u2014\u6296\u97f3\u6e20\u9053\u4e13\u5c5e",alias:"11"},i[n.add_sidebar]={eventKey:"guide",eventValue:"add_sidebar",onlyOne:!0,info:"\u6dfb\u52a0\u4fa7\u8fb9\u680f\u2014\u2014\u6296\u97f3\u6e20\u9053\u4e13\u5c5e",alias:"12"},i[n.levels_lv_X]={eventKey:"lv",eventValue:"levels_lv_",onlyOne:!0,info:"\u4e3b\u754c\u9762\u2014\u9996\u6b21\u8fdb\u5165\u7b2cX\u5173\u7684\u4eba\u6570",alias:"13"},i[n.finish_lv_X]={eventKey:"lv",eventValue:"finish_lv_",onlyOne:!0,info:"\u4e3b\u754c\u9762\u2014\u901a\u5173\u7b2cX\u5173\u7684\u4eba\u6570\uff08X=\u5173\u5361id\uff09\uff0c\u4ec5\u7edf\u8ba1\u4e00\u6b21",alias:"14"},i[n.extension_X_Y]={eventKey:"lv",eventValue:"extension_",onlyOne:!1,info:"\u5bf9\u5c40\u5185\u2014\u6269\u5efa\u7684\u6b21\u6570\uff08X=\u5173\u5361id\uff0cY=1,2,3,4,5\uff09",alias:"15"},i[n.game_instance_X]={eventKey:"lv",eventValue:"game_instance_X",onlyOne:!0,info:"\u4e3b\u754c\u9762\u2014\u526f\u672c\u7684\u8fdb\u5165\u4eba\u6570\uff08X=\u526f\u672cid\uff09\uff0c\u4ec5\u7edf\u8ba1\u4e00\u6b21",alias:"16"},i[n.Parkour_card]={eventKey:"lv",eventValue:"Parkour_card",onlyOne:!0,info:"\u4e3b\u754c\u9762\u5361\u724c\u8dd1\u9177\u2014\u8fdb\u5165\u7b2cX\u5173\u7684\u4eba\u6570\uff0c\u4ec5\u7edf\u8ba1\u4e00\u6b21",alias:"70"},i[n.Walls_shooting]={eventKey:"lv",eventValue:"Walls_shooting",onlyOne:!0,info:"\u4e3b\u754c\u9762\u5b88\u536b\u57ce\u5899-\u8fdb\u5165\u7b2cX\u5173\u7684\u4eba\u6570\uff0c\u4ec5\u7edf\u8ba1\u4e00\u6b21",alias:"73"},i[n.Coins]={eventKey:"video",eventValue:"coins",onlyOne:!1,info:"\u4e3b\u9875\u2014\u91d1\u5e01\u8d2d\u4e70",alias:"17"},i[n.Diamonds]={eventKey:"video",eventValue:"Diamonds",onlyOne:!1,info:"\u4e3b\u9875\u2014\u94bb\u77f3\u8d2d\u4e70",alias:"18"},i[n.Double_sign]={eventKey:"video",eventValue:"double_sign",onlyOne:!1,info:"\u7b7e\u5230\u2014\u53cc\u500d\u9886\u53d6\uff08\u518d\u9886\u4e00\u6b21\uff09",alias:"19"},i[n.Draw_cards]={eventKey:"video",eventValue:"Draw_cards",onlyOne:!1,info:"\u62bd\u5361\u2014\u5355\u6b21",alias:"20"},i[n.Draw_cards10]={eventKey:"video",eventValue:"Draw_cards10",onlyOne:!1,info:"\u62bd\u5361\u2014\u5341\u8fde\u62bd",alias:"21"},i[n.Gain_replace]={eventKey:"video",eventValue:"Gain_replace",onlyOne:!1,info:"\u589e\u76ca\u2014\u6362\u4e00\u6279",alias:"22"},i[n.Gain_all]={eventKey:"video",eventValue:"Gain_all",onlyOne:!1,info:"\u589e\u76ca\u2014\u5168\u90fd\u8981",alias:"23"},i[n.Victory_doubled]={eventKey:"video",eventValue:"Victory_doubled",onlyOne:!1,info:"\u5bf9\u5c40\u2014\u7ed3\u7b97\u7ffb\u500d",alias:"24"},i[n.Silver_coin]={eventKey:"video",eventValue:"Silver_coin",onlyOne:!1,info:"\u5bf9\u5c40\u2014\u94f6\u5e01\u8d2d\u4e70",alias:"25"},i[n.More_silver_coin]={eventKey:"video",eventValue:"More_silver_coin",onlyOne:!1,info:"\u5bf9\u5c40\u2014\u94f6\u5e01\u52a0\u6210",alias:"26"},i[n.Accelerate]={eventKey:"video",eventValue:"Accelerate",onlyOne:!1,info:"\u5bf9\u5c40\u2014\u52a0\u901f",alias:"27"},i[n.Extension_bubble]={eventKey:"video",eventValue:"Extension_bubble",onlyOne:!1,info:"\u5bf9\u5c40\u2014\u6269\u5efa\u6c14\u6ce1",alias:"28"},i[n.Hero_card]={eventKey:"video",eventValue:"Hero_card",onlyOne:!1,info:"\u5bf9\u5c40\u2014\u82f1\u96c4\u5361",alias:"29"},i[n.Copy_unlock]={eventKey:"video",eventValue:"Copy_unlock",onlyOne:!1,info:"\u526f\u672c\u2014\u95e8\u7968",alias:"30"},i[n.Coin_bubbles]={eventKey:"video",eventValue:"Coin_bubbles",onlyOne:!1,info:"\u5bf9\u5c40-\u94f6\u5e01\u6c14\u6ce1",alias:"66"},i[n.Gold_bubbles]={eventKey:"video",eventValue:"Gold_bubbles",onlyOne:!1,info:"\u5347\u7ea7-\u91d1\u5e01\u8d2d\u4e70",alias:"67"},i[n.Parkour_run]={eventKey:"video",eventValue:"Parkour_run",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u5361\u724c\u8dd1\u9177",alias:"71"},i[n.Walls_defended]={eventKey:"video",eventValue:"Walls_shooting",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u5b88\u536b\u57ce\u5899",alias:"74"},i[n.Fight_dragon]={eventKey:"video",eventValue:"Fight_dragon",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u6253\u5927\u9f99",alias:"76"},i[n.Help_girl]={eventKey:"video",eventValue:"Help_girl",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u62ef\u6551\u5c0f\u7f8e",alias:"77"},i[n.Flying_Stone]={eventKey:"video",eventValue:"Flying_Stone",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u98de\u5929\u6a2a\u77f3",alias:"78"},i[n.Girl_run]={eventKey:"video",eventValue:"Girl_run",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u5c0f\u7f8e\u5feb\u8dd1",alias:"79"},i[n.Grab_Dragon_Balls]={eventKey:"video",eventValue:"Grab_Dragon_Balls",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u62a2\u9f99\u73e0",alias:"80"},i[n.double_dragons]={eventKey:"video",eventValue:"double_dragons",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u53cc\u9f99\u620f\u73e0",alias:"81"},i[n.Gacha]={eventKey:"video",eventValue:"Gacha",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u626d\u86cb\u4e4b\u6218",alias:"82"},i[n.mahjong]={eventKey:"video",eventValue:"mahjong",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u9ebb\u5c06\u9f99",alias:"83"},i[n.pkkunlun]={eventKey:"video",eventValue:"pkkunlun",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u5bf9\u51b3\u6606\u4ed1",alias:"84"},i[n.xinchun]={eventKey:"video",eventValue:"xinchun",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u65b0\u6625\u6253\u86c7",alias:"85"},i[n.conjure]={eventKey:"video",eventValue:"conjure",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u795e\u5668\u53ec\u5524",alias:"86"},i[n.paopaolong]={eventKey:"video",eventValue:"paopaolong",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u6ce1\u6ce1\u9f99",alias:"87"},i[n.paopaolong2]={eventKey:"video",eventValue:"paopaolong2",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u6ce1\u6ce1\u9f992",alias:"88"},i[n.Demon_Roulette]={eventKey:"video",eventValue:"Demon_Roulette",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u6076\u9b54\u8f6e\u76d8",alias:"89"},i[n.Knife_pdd]={eventKey:"video",eventValue:"Knife_pdd",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u8f6c\u5200\u62fc\u591a\u591a",alias:"90"},i[n.bullet_falls]={eventKey:"video",eventValue:"bullet_falls",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u6389\u5b50\u5f39",alias:"91"},i[n.xingqiu_Dragon]={eventKey:"video",eventValue:"xingqiu_Dragon",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u661f\u7403\u9f99",alias:"110"},i[n.Backpack_Defense]={eventKey:"video",eventValue:"Backpack_Defense",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u80cc\u5305\u9632\u7ebf",alias:"112"},i[n.Backpack_Defense2]={eventKey:"video",eventValue:"Backpack_Defense2",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u80cc\u5305\u9632\u7ebf2",alias:"114"},i[n.defense_line]={eventKey:"video",eventValue:"defense_line",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u6700\u7ec8\u9632\u7ebf",alias:"116"},i[n.wheel_pk]={eventKey:"video",eventValue:"wheel_pk",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u8f6c\u76d8\u5bf9\u51b3",alias:"118"},i[n.TD_breach]={eventKey:"video",eventValue:"TD_breach",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u5854\u9632\u5c42\u5c42\u7834",alias:"120"},i[n.BH_line]={eventKey:"video",eventValue:"BH_line",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u9ed1\u6d1e\u9632\u7ebf",alias:"122"},i[n.Drifting_World]={eventKey:"video",eventValue:"Drifting_World",onlyOne:!1,info:"\u4e3b\u754c\u9762-\u6f02\u6d41\u4e16\u754c",alias:"124"},i[n.Coins_X]={eventKey:"pay",eventValue:"Coins_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u91d1\u5e01\u8d2d\u4e70\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"52"},i[n.Diamonds_X]={eventKey:"pay",eventValue:"Diamonds_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u94bb\u77f3\u8d2d\u4e70\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"53"},i[n.Double_sign_X]={eventKey:"pay",eventValue:"Double_sign_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u53cc\u500d\u9886\u53d6\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"54"},i[n.Draw_cards_X]={eventKey:"pay",eventValue:"Draw_cards_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u5355\u6b21\u8d2d\u4e70\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"55"},i[n.Draw_cards10_X]={eventKey:"pay",eventValue:"Draw_cards10_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u5341\u8fde\u62bd\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"56"},i[n.Gain_replace_X]={eventKey:"pay",eventValue:"Gain_replace_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u6362\u4e00\u6279\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"57"},i[n.Gain_all_X]={eventKey:"pay",eventValue:"Gain_all_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u5168\u90fd\u8981\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"58"},i[n.Victory_doubled_X]={eventKey:"pay",eventValue:"Victory_doubled_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u7ed3\u7b97\u7ffb\u500d\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"59"},i[n.Silver_coin_X]={eventKey:"pay",eventValue:"Silver_coin_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u94f6\u5e01\u8d2d\u4e70\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"60"},i[n.More_silver_coin_X]={eventKey:"pay",eventValue:"More_silver_coin_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u94f6\u5e01\u52a0\u6210\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"61"},i[n.Accelerate_X]={eventKey:"pay",eventValue:"Accelerate_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u52a0\u901f\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"62"},i[n.Extension_bubble_X]={eventKey:"pay",eventValue:"Extension_bubble_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u6269\u5efa\u6c14\u6ce1\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"63"},i[n.Hero_card_X]={eventKey:"pay",eventValue:"Hero_card_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u82f1\u96c4\u5361\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"64"},i[n.Copy_unlock_X]={eventKey:"pay",eventValue:"Copy_unlock_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u526f\u672c-\u95e8\u7968\u8ba1\u8d39\u70b9\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"65"},i[n.Coin_bubbles_X]={eventKey:"pay",eventValue:"Coin_bubbles_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u5bf9\u5c40-\u94f6\u5e01\u6c14\u6ce1\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"68"},i[n.Gold_bubbles_X]={eventKey:"pay",eventValue:"Gold_bubbles_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u5347\u7ea7-\u91d1\u5e01\u8d2d\u4e70\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(14),\u7edf\u8ba1\uff09",alias:"69"},i[n.Parkour_run_X]={eventKey:"pay",eventValue:"Parkour_run_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u5361\u724c\u8dd1\u9177\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(15),\u7edf\u8ba1\uff09",alias:"72"},i[n.Walls_defended_X]={eventKey:"pay",eventValue:"Walls_shooting_X",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u5b88\u536b\u57ce\u5899\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(15),\u7edf\u8ba1\uff09",alias:"75"},i[n.Fight_dragon_X]={eventKey:"pay",eventValue:"Fight_dragon_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u6253\u5927\u9f99\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(18),\u7edf\u8ba1\uff09",alias:"94"},i[n.Help_girl_X]={eventKey:"pay",eventValue:"Help_girl_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u62ef\u6551\u5c0f\u7f8e\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(19),\u7edf\u8ba1\uff09",alias:"95"},i[n.Flying_Stone_X]={eventKey:"pay",eventValue:"Flying_Stone_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u98de\u5929\u6a2a\u77f3\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(20),\u7edf\u8ba1\uff09",alias:"96"},i[n.Girl_run_X]={eventKey:"pay",eventValue:"Girl_run_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u5c0f\u7f8e\u5feb\u8dd1\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(21),\u7edf\u8ba1\uff09",alias:"97"},i[n.Grab_Dragon_Balls_X]={eventKey:"pay",eventValue:"Grab_Dragon_Balls_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u62a2\u9f99\u73e0\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(22),\u7edf\u8ba1\uff09",alias:"98"},i[n.double_dragons_X]={eventKey:"pay",eventValue:"double_dragons_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u53cc\u9f99\u620f\u73e0\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(23),\u7edf\u8ba1\uff09",alias:"99"},i[n.Gacha_X]={eventKey:"pay",eventValue:"Gacha_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u626d\u86cb\u4e4b\u6218\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(24),\u7edf\u8ba1\uff09",alias:"100"},i[n.mahjong_X]={eventKey:"pay",eventValue:"mahjong_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u9ebb\u5c06\u9f99\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(25),\u7edf\u8ba1\uff09",alias:"101"},i[n.pkkunlun_X]={eventKey:"pay",eventValue:"pkkunlun_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u5bf9\u51b3\u6606\u4ed1\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(26),\u7edf\u8ba1\uff09",alias:"102"},i[n.xinchun_X]={eventKey:"pay",eventValue:"xinchun_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u65b0\u6625\u6253\u86c7\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(27),\u7edf\u8ba1\uff09",alias:"103"},i[n.conjure_X]={eventKey:"pay",eventValue:"conjure_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u795e\u5668\u53ec\u5524\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(28),\u7edf\u8ba1\uff09",alias:"104"},i[n.paopaolong_X]={eventKey:"pay",eventValue:"paopaolong_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u6ce1\u6ce1\u9f99\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(29),\u7edf\u8ba1\uff09",alias:"105"},i[n.paopaolong2_X]={eventKey:"pay",eventValue:"paopaolong2_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u6ce1\u6ce1\u9f992\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(30),\u7edf\u8ba1\uff09",alias:"106"},i[n.Demon_Roulette_X]={eventKey:"pay",eventValue:"Demon_Roulette_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u6076\u9b54\u8f6e\u76d8\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(31),\u7edf\u8ba1\uff09",alias:"107"},i[n.Knife_pdd_X]={eventKey:"pay",eventValue:"Knife_pdd_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u8f6c\u5200\u62fc\u591a\u591a\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(32),\u7edf\u8ba1\uff09",alias:"108"},i[n.bullet_falls_X]={eventKey:"pay",eventValue:"bullet_falls_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u6389\u5b50\u5f39\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"109"},i[n.xingqiu_Dragon_X]={eventKey:"pay",eventValue:"xingqiu_Dragon_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u661f\u7403\u9f99\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"111"},i[n.Backpack_Defense_X]={eventKey:"pay",eventValue:"Backpack_Defense_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u80cc\u5305\u9632\u7ebf\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"113"},i[n.Backpack_Defense2_X]={eventKey:"pay",eventValue:"Backpack_Defense2_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u80cc\u5305\u9632\u7ebf2\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"115"},i[n.defense_line_X]={eventKey:"pay",eventValue:"defense_line_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u6700\u7ec8\u9632\u7ebf\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"117"},i[n.wheel_pk_X]={eventKey:"pay",eventValue:"wheel_pk_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u8f6c\u76d8\u5bf9\u51b3\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"119"},i[n.TD_breach_X]={eventKey:"pay",eventValue:"TD_breach_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u5854\u9632\u5c42\u5c42\u7834\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"121"},i[n.BH_line_X]={eventKey:"pay",eventValue:"BH_line_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u9ed1\u6d1e\u9632\u7ebf\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"123"},i[n.Drifting_World_X]={eventKey:"pay",eventValue:"Drifting_World_",onlyOne:!1,info:"\u7528\u6237\u5728\u7b2cX\u5173\u65f6\u89c2\u770b\u4e86\u4e3b\u754c\u9762-\u6f02\u6d41\u4e16\u754c\uff08X=\u5173\u5361id\uff0c\u524d5\u5173\u6bcf\u5173\u7edf\u8ba1\uff081/2/3/4/5)\uff0c\u540e\u63096-10\u5173(6)\uff0c11-15(7)\uff0c16-20(8)\uff0c21-25(9)\uff0c26-30(10)\uff0c31-35\uff0811\uff09,36-40\uff0812\uff09,41-45(13),46-50(33),\u7edf\u8ba1\uff09",alias:"125"},i[n.time_1]={eventKey:"time",eventValue:"time_1",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u52301m",alias:"32"},i[n.time_3]={eventKey:"time",eventValue:"time_3",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u52303m",alias:"33"},i[n.time_5]={eventKey:"time",eventValue:"time_5",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u52305m",alias:"34"},i[n.time_7]={eventKey:"time",eventValue:"time_7",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u52307m",alias:"35"},i[n.time_10]={eventKey:"time",eventValue:"time_10",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u523010m",alias:"36"},i[n.time_15]={eventKey:"time",eventValue:"time_15",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u523015m",alias:"37"},i[n.time_20]={eventKey:"time",eventValue:"time_20",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u523020m",alias:"38"},i[n.time_30]={eventKey:"time",eventValue:"time_30",onlyOne:!0,info:"\u5728\u7ebf\u65f6\u957f\u8fbe\u523030m",alias:"39"},i[n.dau_day_X]={eventKey:"time",eventValue:"dau_day_",onlyOne:!0,info:"\u7edf\u8ba1\u6d3b\u8dc3\u7528\u6237\u7b2cX\u5929",alias:"43"},i[n.notice_X_Y]={eventKey:"notice",eventValue:"notice_",onlyOne:!1,info:"\u53cd\u9988\u4e0e\u6295\u8bc9\u754c\u9762\u9009\u9879\u7edf\u8ba1\uff08X=1~4,1=\u865a\u5047\u5ba3\u4f20,2=\u6570\u636e\u4e22\u5931,3=\u6e38\u620f\u5361\u6b7b,4=\u65e0\u6cd5\u770b\u5e7f\u544a,Y=\u53cd\u9988\u7684\u6587\u5b57\u5185\u5bb9\uff09",alias:"51"},i),cc._RF.pop(),cc._RF.pop()},{}],GameTrackData:[function(t,e,o){"use strict";cc._RF.push(e,"c692c8MFWtGD5V9rWmFTtrA","GameTrackData");var i=t,n=e,a=o;cc._RF.push(n,"c692c8MFWtGD5V9rWmFTtrA","GameTrackData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.TrackData=void 0;var c=i("BaseData"),l=i("BasePlatform"),p=i("Appcfg"),u=i("AppManager"),d=i("PlatformManager"),h=i("TimeUtils"),f=i("Utils"),m=i("Config"),g=i("GameTrackDataEvent"),y=function(){this.abName=null,this.dynamicAbName=null,this.isGet=!1,this.versionName=null,this.appStore=0,this.needConvert=0,this.day=1,this.listTime={}},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=4,e.ecrypt=!1,e.aliseMap={abName:"a",dynamicAbName:"b",isGet:"c",versionName:"d",appStore:"e",needConvert:"f",daytime:"g",day:"h",listTime:"A"},e.gameKey=m.GameConfig.AppCacheName+"trackdata",e.eventCF={},e}return s(e,t),e.prototype.createData=function(){return this.data=new y,this.data.versionName=this.getVersionConf(),this.saveData(),this.data},e.prototype.initData=function(t){t||!this.data.daytime?(this.data.daytime=(new Date).getTime(),this.data.day=1):this.setCurentDay(),this.eventCF=g.EventCF,this.convertData()},e.prototype.convertData=function(){if(this.data.needConvert&&0==this.data.needConvert)for(var t in this.data)for(var e in this.eventCF){var o=this.eventCF[e].eventKey+this.eventCF[e].eventValue;this.eventCF[e].alias&&-1!=t.indexOf(o)&&(this.data[t.replace(o,this.eventCF[e].alias)]=this.data[t],delete this.data[t])}this.data.needConvert=1,this.saveData()},e.prototype.getVersionName=function(){return this.data.versionName?this.data.versionName:this.getVersionConf()},e.prototype.getVersionConf=function(){var t=u.IAppManager.getUMConf(),e=u.IAppManager.getSwitchVersion(t);return e||(e="1.0.0"),String(e)},e.prototype.getSdkAbName=function(t){var e=this;this.data.isGet=!1,null!=this.data.abName&&this.data.isGet?t&&t(this.data.abName):this.requestAbName(function(o){e.data.isGet=!0,e.data.abName=null==o?"C":o,t&&t(e.data.abName),e.saveData()})},e.prototype.setToAppStore=function(){this.data.appStore=1,this.saveData()},e.prototype.getToAppStore=function(){return 1==this.data.appStore},e.prototype.getAbType=function(){return this.data.abName?this.data.abName:"C"},e.prototype.getDynamicAbType=function(){return this.data.dynamicAbName?this.data.dynamicAbName:"C"},e.prototype.requestAbName=function(t){var e=this,o=u.IAppManager.getABTestType();o==p.ABTestType.NO_AB&&(this.abTestUser="C");var i=function(t){var o=["C"],i=null;if(1==t?o=["A","B","D"]:2==t?o=["A"]:3==t?o=["B"]:4==t?o=["D"]:5==t?o=["A","B"]:6==t?o=["A","D"]:7==t?o=["B","D"]:8==t?(o=["A"],i=["A"]):9==t?(o=["B"],i=["B"]):10==t?(o=["D"],i=["D"]):o=["C"],null==e.data.abName){var n=o[Math.floor(Math.random()*o.length)];e.abTestUser=n,e.data.dynamicAbName=n}else i?e.data.dynamicAbName=i[Math.floor(Math.random()*i.length)]:null==e.data.dynamicAbName&&(e.data.dynamicAbName=e.data.abName),e.abTestUser=e.data.abName};if(d.PlatformManager.currentPlatform==l.Platform.EDITOR){var n=window.location.href.split("?abType=");n.length>1?(this.abTestUser=n[n.length-1],this.data.dynamicAbName=n[n.length-1]):i(f.Utils.randomRang(1,11))}if(o==p.ABTestType.A_fixed?this.abTestUser="A":o==p.ABTestType.B_fixed?this.abTestUser="B":o==p.ABTestType.D_fixed&&(this.abTestUser="D"),this.abTestUser)t&&t(this.abTestUser);else{var a=u.IAppManager.getABDConf();if(!a)return console.log("\u6ca1\u6709ab\u914d\u7f6e"),this.abTestUser="C",null!=this.data.abName&&(this.abTestUser=this.data.abName),void(t&&t(this.abTestUser));var r=u.IAppManager.getABVersion(a.switchId);null==r?(this.abTestUser="C",null!=this.data.abName&&(this.abTestUser=this.data.abName)):i(r),t&&t(this.abTestUser)}},e.prototype.youmengTrack=function(t,e,o){var i,n=this.eventCF[t],a=!0,r=n.eventValue;if(e&&(r+=e),o&&(r=r+"_"+o),n.alias&&(i=n.alias,n.saveKey||(e&&(i+="_"+e),o&&(i+="_"+o))),!n.condition||!this.data[n.condition]){if(n.preEvent&&!e){if(!this.data[n.preEvent])return}else if(n.preEvent&&e&&!this.data[n.preEvent+e])return;if(n.onlyOne&&(this.data[n.eventKey+r]&&(a=!1),i&&this.data[i]&&(a=!1)),a&&n.saveKey){if(this.data[n.eventKey+n.eventValue])return;if(i&&this.data[i.replace(e,"")])return}if(t==g.TrackId.dau){var s=this.data[n.eventKey+n.eventValue];if(s){var c=Number(s);if(h.TimeUtils.compareIsToday(c))return;a=!0}else a=!0}if(a){if(n.maxNum){if(i){if(null==(l=this.data[i.replace(e,"")])&&(l=0),l>=n.maxNum+1)return;l+=1,this.data[i]=1,this.data[i.replace(e,"")]=l}else{var l,p=this.data[n.eventKey+n.eventValue];if(p?p++:p=1,(l=this.data[n.eventKey+r])?l++:l=1,p>=n.maxNum+1)return;n.saveKey?this.data[n.eventKey+n.eventValue]=p:(this.data[n.eventKey+n.eventValue]=p,this.data[n.eventKey+r]=l)}this.saveData()}else n.onlyOne&&(i?this.data[i]=1:n.saveKey?this.data[n.eventKey+n.eventValue]=1:this.data[n.eventKey+r]=1,t==g.TrackId.dau&&(this.data[n.eventKey+n.eventValue]=h.TimeUtils.GetTimeBySecond()),this.saveData());this.data.abName||(this.data.abName="C",this.saveData());var u=n.eventKey;"videoday"==n.eventKey&&(u+=this.getCrunetDay()),d.PlatformManager.getInstance().youmengTrack(u,"user"+this.data.abName,this.getVersionName()+"_"+r,n.info)}}},e.prototype.getCrunetDay=function(){return this.data.day<8?this.data.day+"":this.data.day>=8&&this.data.day<=10?"8_10":this.data.day>=11&&this.data.day<=15?"11_15":"16_30"},e.prototype.setCurentDay=function(){this.data.daytime||(this.data.daytime=(new Date).getTime());var t=h.TimeUtils.overDay(this.data.daytime)+1+1;this.data.day=t,this.saveData()},e.prototype.getTimeByKey=function(t){return this.data.listTime[t]||(this.data.listTime[t]=0),this.data.listTime[t]},e.prototype.setTimeByKey=function(t,e){this.data.listTime[t]=e,this.saveData()},e.prototype.addTimeByKey=function(t){return this.data.listTime[t]||(this.data.listTime[t]=0),this.data.listTime[t]++,this.saveData(),this.data.listTime[t]},e}(c.BaseData);a.TrackData=v,cc._RF.pop(),cc._RF.pop()},{}],GameTram:[function(t,e,o){"use strict";cc._RF.push(e,"a3607bgkgVLp493wmr5lVXs","GameTram");var i=t,n=e,a=o;cc._RF.push(n,"a3607bgkgVLp493wmr5lVXs","GameTram");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.TiesBuffType=void 0;var s,c=i("AudioMgr"),l=i("EventMgr"),p=i("LogMgr"),u=i("Config"),d=i("GameEnumData"),h=i("DataMgr"),f=i("PlayerMgr"),m=i("BraveTowerEnum"),g=i("ItemCard"),y=i("ItemEnemyBase"),v=i("GameCtrl"),_=cc._decorator,b=_.ccclass,B=(_.property,function(){function t(t){this.tiesInfo=[],this.activeTies=[],this.tiesBuffList=[],this.tiesKeepBuffList=[],this.tiesBuffTime=[],this.skillNum=0,this.killNum=0,this.gameCtrl=t}return t.prototype.onUpdateTies=function(){var t=this;this.tiesInfo=[];for(var e=function(e,o){for(var i=!0,n=0;n<t.tiesInfo.length;n++){var a=t.tiesInfo[n];if(a.id==o){a.cardList.push(e),i=!1;break}}if(i){var r=h.DataMgr.getInstance().getTiesCfg(o),s=[];r.effectList.forEach(function(t){s.push(t.cardId)}),t.tiesInfo.push({id:o,cardList:[e],allCardList:s})}},o=0;o<this.gameCtrl.ctrUI.cardItemList.length;o++){var i=this.gameCtrl.ctrUI.cardItemList[o];if(i.status!=g.ItemCardStatus.None)for(var n=f.PlayerMgr.getInstance().getCardTies(i.cardId),a=0;a<n.length;a++)e(i.cardId,n[a])}this.tiesInfo.sort(function(t,e){return t.cardList.length<t.allCardList.length&&e.cardList.length>=e.allCardList.length?1:t.cardList.length>=t.allCardList.length&&e.cardList.length<e.allCardList.length?-1:t.id-e.id}),l.EventMgr.getInstance().emit(m.BraveTowerEventName.UpdateGameUI,1),this.onActiveTies()},t.prototype.onActiveTies=function(){for(var t=this,e=[],o=0;o<this.tiesInfo.length;o++)(n=this.tiesInfo[o]).cardList.length>=n.allCardList.length&&e.push(n.id);var i=[];for(o=0;o<this.activeTies.length;o++){var n=this.activeTies[o];i.push(n.id)}e.sort(),i.sort();for(var a=0,r=0;a<e.length&&r<i.length;)e[a]==i[r]?(e.splice(a,1),i.splice(r,1)):e[a]<i[r]?a++:r++;0==e.length&&0==i.length||(e.forEach(function(e){for(var o=h.DataMgr.getInstance().getTiesCfg(e),i={id:o.id,val:o.vaule,cardList:[]},n=0;n<o.effectList.length;n++){var a=o.effectList[n];i[a.cardId]=a.vaule,i.cardList.push(a.cardId)}t.activeTies.push(i),c.AudioMgr.getInstance().playEffect(u.AudioId.Bonds,"effTies")}),i.forEach(function(e){for(var o=0;o<t.activeTies.length;o++)if(t.activeTies[o].id==e){t.activeTies.splice(o,1);break}}),p.LogMgr.getInstance().info("\u7f81\u7eca",e,i,this.activeTies),this.upTiesData(),this.gameCtrl.needUpdateCardData=!0)},t.prototype.upTiesData=function(){this.tiesBuffList=[];for(var t=0;t<this.activeTies.length;t++){for(var e=this.activeTies[t],o=h.DataMgr.getInstance().getTiesCfg(e.id),i=[],n=0;n<o.effectList.length;n++){var a=o.effectList[n];i.push(this.gameCtrl.ctrUI.getCard(a.cardId))}switch(o.id){case d.BraveTowerEnumTiesCfg.Ties01:var r=-1,c=-1;for(n=0;n<i.length;n++){var l=(a=i[n]).getAttack();(-1==r||l>r)&&(r=l,c=a.cardId)}var p=[];for(n=0;n<i.length;n++)(a=i[n]).cardId==c||p.push(a.cardId);this.addTiesBuffTime(s.Ties01,e.val[0],[c]),this.addTiesBuffTime(s.Ties01,e.val[1],p);break;case d.BraveTowerEnumTiesCfg.Ties06:for(r=-1,c=-1,n=0;n<i.length;n++)l=(a=i[n]).getAttack(),(-1==r||l>r)&&(r=l,c=a.cardId);e.date=c;break;case d.BraveTowerEnumTiesCfg.Ties09:this.setTiesBuffTime(s.Ties09,e.val[0],0);break;case d.BraveTowerEnumTiesCfg.Ties12:this.addTiesBuffTime(s.Ties12,0);break;case d.BraveTowerEnumTiesCfg.Ties13:this.setTiesBuffTime(s.Ties13,e.val[0],0),this.setTiesBuffTime(s.Ties13_1,e.val[2],e.val[1]),this.gameCtrl.ctrEffect.showTies13()}}},t.prototype.addTiesBuffTime=function(t,e,o,i){void 0===o&&(o=null),void 0===i&&(i=null),this.tiesBuffList.push({id:t,num:e,cardList1:o,cardList2:i})},t.prototype.getTies=function(t){for(var e=0;e<this.activeTies.length;e++){var o=this.activeTies[e];if(o.id==t)return o}return null},t.prototype.addSkill=function(){var t=this,e=this.getTies(d.BraveTowerEnumTiesCfg.Ties01);e&&function(e){for(var o=!0,i=0;i<t.tiesKeepBuffList.length;i++)if(t.tiesKeepBuffList[i].id==e){o=!1;break}return o}(s.Ties01_1011)&&(this.skillNum++,p.LogMgr.getInstance().info("\u7f81\u7eca01-1011",this.skillNum),this.skillNum>=e[d.BraveTowerEnumCardCfg.Card11][0]&&this.tiesKeepBuffList.push({id:s.Ties01_1011,num:e[d.BraveTowerEnumCardCfg.Card11][1],cardList1:[d.BraveTowerEnumCardCfg.Card11],cardList2:null}));var o=this.getTies(d.BraveTowerEnumTiesCfg.Ties02);o&&(o.date?(o.date++,o.date>o.val[1]&&(o.date=o.val[1])):o.date=1)},t.prototype.getCardBuffTime=function(t,e){var o=0,i=[];switch(e){case v.CardBuffAddType.Attack:i=[s.Ties041,s.Ties101,s.Ties103];break;case v.CardBuffAddType.AttackSpeed:i=[s.Ties03,s.Ties042,s.Ties102,s.Ties104,s.Ties13_1];break;case v.CardBuffAddType.Stun:break;case v.CardBuffAddType.Crit:i=[s.Ties04_1016,s.Ties11_1017];break;case v.CardBuffAddType.CritDamage:i=[s.Ties02,s.Ties12];break;case v.CardBuffAddType.SkillCD:i=[s.Ties01,s.Ties01_1011]}for(var n=0;n<this.tiesBuffList.length;n++){var a=this.tiesBuffList[n];if(i.includes(a.id)){if(a.cardList2&&a.cardList2.includes(t))continue;if(!a.cardList1){o+=a.num;continue}a.cardList1.includes(t)&&(o+=a.num)}}for(n=0;n<this.tiesKeepBuffList.length;n++)if(a=this.tiesKeepBuffList[n],i.includes(a.id)){if(a.cardList2&&a.cardList2.includes(t))continue;if(!a.cardList1){o+=a.num;continue}a.cardList1.includes(t)&&(o+=a.num)}for(n=0;n<this.tiesBuffTime.length;n++)if(a=this.tiesBuffTime[n],i.includes(a.id)){if(a.cardList2&&a.cardList2.includes(t))continue;if(!a.cardList1){o+=a.num;continue}a.cardList1.includes(t)&&(o+=a.num)}return o},t.prototype.setTiesBuffTime=function(t,e,o,i,n){void 0===i&&(i=null),void 0===n&&(n=null);for(var a=!0,r=0;r<this.tiesBuffTime.length;r++){var s=this.tiesBuffTime[r];s.id==t&&(s.time=e,s.num=o,s.cardList1=i,s.cardList2=n,a=!1)}a&&this.tiesBuffTime.push({id:t,time:e,num:o,cardList1:i,cardList2:n}),this.gameCtrl.needUpdateCardData=!0},t.prototype.onUpTime=function(t){for(var e,o=function(o){var n=i.tiesBuffTime[o];if(-1==n.time)return e=o,"continue";if(n.time-=t,n.time<=0)switch(n.id){case s.Ties09:var a=i.getTies(d.BraveTowerEnumTiesCfg.Ties09);a?(n.time=a.val[0],i.gameCtrl.gameData.enemyList.forEach(function(t){return t.addBuff(y.Buff.slow,a.val[1],a.val[2])})):(i.tiesBuffTime.splice(o,1),i.gameCtrl.needUpdateCardData=!0,o--);break;case s.Ties13:var r=i.getTies(d.BraveTowerEnumTiesCfg.Ties13);r?(n.time=r.val[0],i.setTiesBuffTime(s.Ties13_1,r.val[2],r.val[1]),i.gameCtrl.ctrEffect.showTies13()):(i.tiesBuffTime.splice(o,1),o--),i.gameCtrl.needUpdateCardData=!0;break;default:i.tiesBuffTime.splice(o,1),i.gameCtrl.needUpdateCardData=!0,o--}e=o},i=this,n=0;n<this.tiesBuffTime.length;n++)o(n),n=e},t.prototype.addTies10=function(){var t=this.getTies(d.BraveTowerEnumTiesCfg.Ties10);t&&(this.killNum++,this.killNum>=t.val[0]&&(this.killNum=0,this.setTiesBuffTime(s.Ties101,t.val[2],t.val[1],t.cardList),this.setTiesBuffTime(s.Ties102,t.val[2],t.val[1],t.cardList),this.setTiesBuffTime(s.Ties103,t.val[2],.5*t.val[1],null,t.cardList),this.setTiesBuffTime(s.Ties104,t.val[2],.5*t.val[1],null,t.cardList),this.gameCtrl.needUpdateCardData=!0))},t.prototype.addTies12=function(){var t=this.getTies(d.BraveTowerEnumTiesCfg.Ties12);if(t&&(t.date||(t.date=0),t.date<t.val[2])){var e=Math.floor(this.gameCtrl.gamePlayInfo.hp*t.val[0]);this.gameCtrl.gamePlayInfo.subHp(e),t.date++;for(var o=0;o<this.tiesBuffList.length;o++){var i=this.tiesBuffList[o];i.id==s.Ties12&&(i.num=t.date*t.val[1])}this.gameCtrl.needUpdateCardData=!0}},t.prototype.addBuff=function(){l.EventMgr.getInstance().emit(m.BraveTowerEventName.UpdateGameUI,3)},r([b],t)}());a.default=B,function(t){t[t.Ties01=1]="Ties01",t[t.Ties01_1011=2]="Ties01_1011",t[t.Ties02=3]="Ties02",t[t.Ties03=4]="Ties03",t[t.Ties041=5]="Ties041",t[t.Ties042=6]="Ties042",t[t.Ties04_1016=7]="Ties04_1016",t[t.Ties06=8]="Ties06",t[t.Ties09=9]="Ties09",t[t.Ties101=10]="Ties101",t[t.Ties102=11]="Ties102",t[t.Ties103=12]="Ties103",t[t.Ties104=13]="Ties104",t[t.Ties11_1017=14]="Ties11_1017",t[t.Ties12=15]="Ties12",t[t.Ties13=16]="Ties13",t[t.Ties13_1=17]="Ties13_1"}(s=a.TiesBuffType||(a.TiesBuffType={})),cc._RF.pop(),cc._RF.pop()},{}],GameUICtrl:[function(t,e,o){"use strict";cc._RF.push(e,"d829eY5DvpAuYrVydPH2Y58","GameUICtrl");var i=t,n=e,a=o;cc._RF.push(n,"d829eY5DvpAuYrVydPH2Y58","GameUICtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("BasePlatform"),d=i("PlatformSetting"),h=i("AudioMgr"),f=i("SdkMgr"),m=i("UIMgr"),g=i("Utils"),y=i("Config"),v=i("TextConfig"),_=i("GameTrackDataEvent"),b=i("GameEnumData"),B=i("DataMgr"),I=i("PlayerMgr"),P=i("BraveTowerEnum"),C=i("ItemCard"),D=i("ItemHp"),T=i("GameCtrl"),S=cc._decorator,A=S.ccclass,k=S.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnSpeed=null,e.btnAddCoin=null,e.btnCoinBub=null,e.labRound=null,e.ndEx=null,e.ctrBossHp=null,e.ndHeroItem=null,e.ndHero=null,e.sprProHp=null,e.labProHp=null,e.ndBuy=null,e.labGold=null,e.ndAniGold=null,e.btnRefresh=null,e.btnAdd=null,e.ndTime=null,e.ndCardBuy=[],e.cardItemList=[],e.cardList=[],e.refreskNum=0,e.refreshNum=0,e.addNumList=[],e.addNum=0,e.aniGoldQueue=[],e.canShow=!0,e.labList=[],e.cardProbability=[],e.isAni=!1,e.shopList=[],e.isVideo=!0,e.videoRefreshNum=0,e.bossList=[],e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.ctrBossHp.node.active=!1,this.ndHeroItem.active=!1,this.ndAniGold.active=!1,this.ndTime.active=!1,this.ndCardBuy=[],this.ndBuy.children.forEach(function(e){if(e.name.startsWith("ndItem")){var o=parseInt(e.name.replace("ndItem",""));t.ndCardBuy[o-1]=e}}),this.btnCoinBub.active=P.BraveTowerSwitch.BuyCoinBubble()},e.prototype.start=function(){var t=this;this.btnRefresh.on(cc.Node.EventType.TOUCH_END,function(){if(t.gameCtrl.gameData.gameStage!=P.BraveTowerGameStage.GameOver)if(t.gameCtrl.subGoldNum(t.refreskNum))I.PlayerMgr.getInstance().getTaskData().addCoreCombatRefreshCardNum(),t.onRefresh(),t.refreshNum++,t.gameCtrl.gameBuff.doFree(),t.upBtnView();else{var e=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params14).split(","),o=parseInt(e[Math.min(t.gameCtrl.gameData.roundNum-1,e.length-1)]);t.gameCtrl.pauseGame(),m.UIMgr.getInstance().openUI(y.UIID.UIAddGold,y.UIID.UIGame,b.BraveTowerEnumGoodsCfg.SilverCoin,o,function(e){var i;e&&(I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Silver_coin),I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Silver_coin_X,(i=I.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?i:Math.floor((i-1)/5)+5),t.gameCtrl.addGoldNum(o)),t.gameCtrl.resumeGame()})}},this),this.btnAdd.on(cc.Node.EventType.TOUCH_END,function(){if(t.gameCtrl.gameData.gameStage!=P.BraveTowerGameStage.GameOver)if(t.gameCtrl.subGoldNum(t.addNum))t.onAdd();else{var e=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params14).split(","),o=parseInt(e[Math.min(t.gameCtrl.gameData.roundNum-1,e.length-1)]);t.gameCtrl.pauseGame(),m.UIMgr.getInstance().openUI(y.UIID.UIAddGold,y.UIID.UIGame,b.BraveTowerEnumGoodsCfg.SilverCoin,o,function(e){var i;e&&(I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Silver_coin),I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Silver_coin_X,(i=I.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?i:Math.floor((i-1)/5)+5),t.gameCtrl.addGoldNum(o)),t.gameCtrl.resumeGame()})}},this);for(var e=function(e){var i=o.ndCardBuy[e];i.getChildByName("ndInfo").active=!1,i.getChildByName("ndLock").active=!0,i.on(cc.Node.EventType.TOUCH_END,function(){if(t.gameCtrl.gameData.gameStage!=P.BraveTowerGameStage.GameOver&&!t.isAni){h.AudioMgr.getInstance().playAudioButtonClicked();var o=t.onBuy(e);switch(o){case 5:case 4:case 3:t.gameCtrl.pauseGame(),f.SdkMgr.getInstance().playVideo(f.AdType.AdFreeTime,function(){var o,n,a,r=t.shopList[e];I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Hero_card),I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Hero_card_X,(a=I.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?a:Math.floor((a-1)/5)+5);var s=!0,c=!1;if(s)for(var p=0;p<t.cardItemList.length;p++)if((d=t.cardItemList[p])&&d.cardId==r){d.addLevel(),h.AudioMgr.getInstance().playEffect(y.AudioId.Cards,"card"),s=!1;break}if(s)for(var u=0;u<t.cardItemList.length;u++){var d;if((d=t.cardItemList[u])&&0==d.cardId){d.init(r),c=!0,s=!1;break}}if(t.gameCtrl.resumeGame(),s)return i.getChildByName("ndInfo").attr(((o={})[l.isVideo]=6,o)),i.getChildByName("ndInfo").attr(((n={})[l.price]=0,n)),void t.upCardView();t.gameCtrl.gameTrammel.onUpdateTies(),t.gameCtrl.gameSkillBuff.onUpdateCard(),c&&t.gameCtrl.ctrEffect.changeCard(r),t.onBuyEnd()},function(){t.gameCtrl.resumeGame()});break;case 1:case 2:t.gameCtrl.gameTrammel.onUpdateTies(),t.gameCtrl.gameSkillBuff.onUpdateCard();var n=t.shopList[e];if(1==o&&t.gameCtrl.ctrEffect.changeCard(n),6==i.getChildByName("ndInfo")[l.isVideo])t.onBuyEnd();else{var a=B.DataMgr.getInstance().getCardCfg(n);t.gameCtrl.subGoldNum(a.price)&&t.onBuyEnd()}break;case-1:for(var r=0,s=0;s<t.cardItemList.length;s++)t.cardItemList[s].cardId>0&&r++;r>=P.BraveTowerParameter.MaxDeckNum?m.UIMgr.getInstance().openUI(y.UIID.UITips,y.UIID.UIGame,t.T(v.TextConfig.Tips11)):m.UIMgr.getInstance().openUI(y.UIID.UITips,y.UIID.UIGame,t.T(v.TextConfig.Tips10));break;case-2:var c=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params14).split(","),p=parseInt(c[Math.min(t.gameCtrl.gameData.roundNum-1,c.length-1)]);t.gameCtrl.pauseGame(),m.UIMgr.getInstance().openUI(y.UIID.UIAddGold,y.UIID.UIGame,b.BraveTowerEnumGoodsCfg.SilverCoin,p,function(e){var o;e&&(I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Silver_coin),I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Silver_coin_X,(o=I.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?o:Math.floor((o-1)/5)+5),t.gameCtrl.addGoldNum(p)),t.gameCtrl.resumeGame()});break;case-3:m.UIMgr.getInstance().openUI(y.UIID.UITips,y.UIID.UIGame,t.T(v.TextConfig.Tips13))}}},o)},o=this,i=0;i<this.ndCardBuy.length;i++)e(i);this.ndTime.on(cc.Node.EventType.TOUCH_END,function(){if(t.gameCtrl.gameData.gameStage==P.BraveTowerGameStage.GameIng){var e=t.gameCtrl.gameData.nextTimeMax-t.gameCtrl.gameData.nextTime,o=parseInt(B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params07)),i=.1*Math.floor(e)*o;t.gameCtrl.addGoldNum(Math.ceil(o-i)),t.gameCtrl.gameData.nextTime=0}},this),this.labRound.node.on(cc.Node.EventType.TOUCH_END,function(){(f.SdkMgr.getInstance().getCheckVersion(d.SwitchID.ShenHe_ABD)||d.PlatformSetting.currentPlatform==u.Platform.EDITOR)&&T.default.instance.addGoldNum(100)},this)},e.prototype.initData=function(t){var e=this;this.gameCtrl=t,this.bossList=[this.ctrBossHp];for(var o=function(t){var o=cc.instantiate(i.ndHeroItem);o.parent=i.ndHero,o.active=!0,o.setPosition(0,0);var n=o.getComponent(C.default);0==t?n.init(0):t<=P.BraveTowerSwitch.VideoUnlockGridNum()?n.init(-2):n.init(-1),i.cardItemList[t]=n,n.ndBg.on(cc.Node.EventType.TOUCH_END,function(){e.onClick(t)},i)},i=this,n=0;n<P.BraveTowerParameter.MaxDeckNum;n++)o(n);this.upGoldView(),this.addNumList=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params04).split(",").map(function(t){return parseInt(t)}),this.addNum=this.addNumList[0],this.upBtnView(),this.updateRoundNum(),this.upCardProbability();var a=B.DataMgr.getInstance().getCardCfgList();for(n=0;n<a.length;n++){var r=a[n];I.PlayerMgr.getInstance().getUserData().getCardById(r.id)&&(this.cardList[r.quality-1]||(this.cardList[r.quality-1]=[]),this.cardList[r.quality-1].push(r))}},e.prototype.initView=function(){},e.prototype.startGame=function(){this.onRefresh()},e.prototype.restartGame=function(){this.refreshNum=0,this.upGoldView(),this.updateRoundNum(),this.upBtnView();for(var t=0;t<this.cardItemList.length;t++){var e=this.cardItemList[t];0==t?e.init(0):t<=P.BraveTowerSwitch.VideoUnlockGridNum()?e.init(-2):e.init(-1)}this.upCardProbability(),this.videoRefreshNum=0,this.onRefresh()},e.prototype.upHpView=function(){this.sprProHp.fillRange=cc.misc.clamp01(this.gameCtrl.gamePlayInfo.hp/this.gameCtrl.gamePlayInfo.hpMax),this.labProHp.string=Math.round(this.gameCtrl.gamePlayInfo.hp)+"/"+Math.round(this.gameCtrl.gamePlayInfo.hpMax)},e.prototype.upGoldView=function(){this.labGold.string=P.BraveTowerGameUtils.numberFomat(this.gameCtrl.getGoldNum())},e.prototype.aniGold=function(t){this.aniGoldQueue.push(t),this.aniGold2()},e.prototype.aniGold2=function(){var t=this;if(this.canShow)if(0!=this.aniGoldQueue.length){this.canShow=!1;var e=this.labList.shift();if(!e){e=cc.instantiate(this.ndAniGold);var o=this.ndAniGold.parent.getChildByName("ndParent");e.setParent(o)}e.setSiblingIndex(0),e.active=!0;var i=e.children[0];i.getComponentInChildren(cc.Label).string="+"+this.aniGoldQueue.shift(),cc.tween(i).set({scaleY:0,y:0}).to(.1/this.gameCtrl.getSpeed(),{scaleY:1}).call(function(){t.canShow=!0,t.aniGold2()}).delay(.5/this.gameCtrl.getSpeed()).call(function(){e.active=!1,t.labList.push(e)}).start()}else this.canShow=!0},e.prototype.updateRoundNum=function(){switch(this.gameCtrl.gameData.gameMode){case P.BraveTowerGameMode.Normal:this.labRound.string=g.Utils.StringFormat(this.T(v.TextConfig.Game01),this.gameCtrl.gameData.roundNum,this.gameCtrl.gameData.levelCfg.wareList.length);break;case P.BraveTowerGameMode.Boss:this.labRound.string=g.Utils.StringFormat(this.T(v.TextConfig.Game02),this.gameCtrl.gameData.roundNum)}var t=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params14).split(","),e=parseInt(t[Math.min(this.gameCtrl.gameData.roundNum-1,t.length-1)]);this.btnCoinBub.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=P.BraveTowerGameUtils.numberFomat(e)},e.prototype.upEXView=function(){this.ndEx.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=cc.misc.clamp01(this.gameCtrl.gamePlayInfo.exp/this.gameCtrl.gamePlayInfo.expMax),this.ndEx.getChildByName("labLevel").getComponent(cc.Label).string=""+this.gameCtrl.gamePlayInfo.level},e.prototype.upBtnView=function(){for(var t=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params03).split("|"),e=0;e<t.length;e++){var o=t[e].split(",").map(function(t){return parseInt(t)});if(o[1]>=this.refreshNum){this.refreskNum=o[0];break}}var i=this.refreskNum,n=1;if(this.gameCtrl.gameBuff.isFree())i=0;else{var a=this.gameCtrl.gameBuff.getBuffList(b.BraveTowerEnumBuffType.BuffType11);for(e=0;e<a.length;e++)(r=a[e]).time>=0&&(i-=r.value[1]);for(a=this.gameCtrl.gameBuff.getBuffList(b.BraveTowerEnumBuffType.BuffType08),e=0;e<a.length;e++){var r;n-=(r=a[e]).value[0]}}this.refreskNum=Math.round(i*n),this.refreskNum<0&&(this.refreskNum=0),this.btnRefresh.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=P.BraveTowerGameUtils.numberFomat(this.refreskNum);var s=0;for(e=0;e<P.BraveTowerParameter.MaxDeckNum;e++){var c=this.cardItemList[e];-1!=c.cardId&&-2!=c.cardId&&s++}s<P.BraveTowerParameter.MaxDeckNum?(this.btnAdd.active=!0,this.addNum=this.addNumList[s-1],this.btnAdd.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=P.BraveTowerGameUtils.numberFomat(this.addNum),this.btnAdd.getChildByName("labPro").getComponent(cc.Label).string=s+"/"+P.BraveTowerParameter.MaxDeckNum):this.btnAdd.active=!1},e.prototype.upCardProbability=function(){var t=this,e=this.gameCtrl.gameData.levelCfg.UpgradaCfg[this.gameCtrl.gamePlayInfo.level-1];e||(e=this.gameCtrl.gameData.levelCfg.UpgradaCfg[this.gameCtrl.gameData.levelCfg.UpgradaCfg.length-1]);for(var o=e.CardsProbability,i=this.gameCtrl.gameBuff.getBuffList(b.BraveTowerEnumBuffType.BuffType09),n=[0,0,0,0],a=0;a<i.length;a++){var r=i[a];n[2]+=r.value[0],n[3]+=r.value[1]}var s=0;for(this.cardProbability=[],a=0;a<o.length;a++){var c=o[a];s+=c[1]+n[c[0]],this.cardProbability.push({id:c[0],weight:c[1]+n[c[0]]})}this.cardProbability.push({id:1,weight:100-s}),this.ndBuy.children.forEach(function(e){if(e.name.startsWith("ndQua")){for(var o=parseInt(e.name.replace("ndQua","")),i=void 0,n=0;n<t.cardProbability.length;n++){var a=t.cardProbability[n];if(a.id==o){i=a;break}}e.getChildByName("labQua").getComponent(cc.Label).string=i.weight.toFixed(0)+"%"}})},e.prototype.onUpdate=function(t){for(var e=0;e<this.cardItemList.length;e++){var o=this.cardItemList[e];o&&o.cardId>0&&o.onUpdate(t)}this.ndTime.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=cc.misc.clamp01(this.gameCtrl.gameData.nextTime/this.gameCtrl.gameData.nextTimeMax)},e.prototype.onClick=function(t){var e=this,o=this.cardItemList[t];if(0!=o.cardId)if(-1!=o.cardId){if(-2==o.cardId)return T.default.instance.pauseGame(),void f.SdkMgr.getInstance().playVideo(f.AdType.AdFreeTime,function(){var t;I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Extension_bubble),I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Extension_bubble_X,(t=I.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?t:Math.floor((t-1)/5)+5),T.default.instance.resumeGame(),e.onAdd()},function(){T.default.instance.resumeGame()});h.AudioMgr.getInstance().playAudioButtonClicked(),m.UIMgr.getInstance().openUI(y.UIID.UIGameCardSell,y.UIID.UIGame,t,o.ctrCard),T.default.instance.pauseGame()}else console.log(2);else console.log(1)},e.prototype.onRefresh=function(){var t=this;this.shopList=[];var e=parseInt(B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params15));if(this.isVideo=this.videoRefreshNum>=e,this.videoRefreshNum++,console.log("\u5237\u65b0\u6b21\u6570",this.isVideo,this.videoRefreshNum,P.BraveTowerSwitch.ForceTiesCard()),this.isVideo&&P.BraveTowerSwitch.ForceTiesCard()){var o=[],i=function(t){for(var e=T.default.instance.gameTrammel.tiesInfo,o=0;o<e.length;o++){var i=e[o];if(i.id==t)return i}return null};if((m=this.cardList[1])&&m.length>0)for(var n=0;n<m.length;n++)for(var a=m[n],r=I.PlayerMgr.getInstance().getCardTies(a.id),s=0;s<r.length;s++)(c=i(y=r[s]))&&c.cardList.length+1==c.allCardList.length&&o.push({id:a.id,weight:1});if((m=this.cardList[2])&&m.length>0)for(n=0;n<m.length;n++)for(a=m[n],r=I.PlayerMgr.getInstance().getCardTies(a.id),s=0;s<r.length;s++){var c;(c=i(y=r[s]))&&c.cardList.length+1==c.allCardList.length&&o.push({id:a.id,weight:1})}if(0==o.length)for(console.log("***\u51d1\u7f81\u7eca  \u672a\u6ee1\u7ea7"),s=0;s<this.cardItemList.length;s++)if((y=this.cardItemList[s])&&y.cardId>0&&y.starNum<P.BraveTowerParameter.SkillUnlockStar2){var p=B.DataMgr.getInstance().getCardCfg(y.cardId);p.quality>=2&&o.push({id:p.id,weight:this.cardProbability[p.quality-1].weight})}if(0==o.length)for(console.log("***\u51d1\u7f81\u7eca  \u672a\u62e5\u6709",this.cardList),(m=[]).push.apply(m,this.cardList[2]),m.push.apply(m,this.cardList[3]),n=0;n<m.length;n++)a=m[n],!this.getCard(a.id)&&o.push({id:a.id,weight:1});console.log("***\u51d1\u7f81\u7eca\u7684\u5361\u724c",o.toString()),o.length>0&&((u=g.Utils.weight_rand(o))&&this.shopList.push(u.id),console.log("\u51d1\u7f81\u7eca\u7684\u5361\u724c2",null==u?void 0:u.id))}if(1==P.BraveTowerSwitch.CardRefreshType())do{var u=g.Utils.weight_rand(this.cardProbability);if((m=this.cardList[u.id-1])&&0!=m.length){var d=m[g.Utils.randomRang(0,m.length)].id;-1==this.shopList.indexOf(d)&&this.shopList.push(d)}}while(this.shopList.length<3);else{o=[];for(var h=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params17).split(",").map(function(t){return parseInt(t)}),f=0;f<this.cardProbability.length;f++){var m,y=this.cardProbability[f];if((m=this.cardList[y.id-1])&&m.length>0)for(n=0;n<m.length;n++)a=m[n],o.push({id:a.id,weight:y.weight*h[a.quality-1]})}do{u=g.Utils.weight_rand(o),-1==this.shopList.indexOf(u.id)&&this.shopList.push(u.id)}while(this.shopList.length<3)}if(!I.PlayerMgr.getInstance().getGuideData().getGuideEnd(1)){var v=I.PlayerMgr.getInstance().getGuideData().getCurrentId();2==v&&(this.shopList=[b.BraveTowerEnumCardCfg.Card03,b.BraveTowerEnumCardCfg.Card03,b.BraveTowerEnumCardCfg.Card03]),6==v&&(this.shopList=[b.BraveTowerEnumCardCfg.Card15,b.BraveTowerEnumCardCfg.Card15,b.BraveTowerEnumCardCfg.Card15])}var _=function(e,o){var i,n,a=e.getChildByName("ndInfo"),r=B.DataMgr.getInstance().getCardCfg(o);a.getChildByName("labName").getComponent(cc.Label).string=t.T(r.name),t.loadSpriteFrame(P.BraveTowerBundelName.Icon,g.Utils.StringFormat(P.BraveTowerImgName.CardQuality,r.quality),function(t){a.getComponent(cc.Sprite).spriteFrame=t}),t.loadSpriteFrame(P.BraveTowerBundelName.IconCard,r.icon,function(t){a.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t});for(var s=a.getChildByName("layTies"),c=I.PlayerMgr.getInstance().getCardTies(o),p=Math.max(s.childrenCount,c.length),u=function(e){var o=s.children[e];if(o||((o=cc.instantiate(s.children[0])).setParent(s),o.x=0),c[e]){o.active=!0;var i=B.DataMgr.getInstance().getTiesCfg(c[e]);t.loadSpriteFrame(P.BraveTowerBundelName.IconTies,i.icon,function(t){o.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),o.getChildByName("labName").getComponent(cc.Label).string=t.T(i.name)}else o.active=!1},d=0;d<p;d++)u(d);switch(function(e){var o=0,i=t.getCard(e);if(i&&i.starNum>=P.BraveTowerParameter.SkillUnlockStar2)return-1;for(var n=0;n<t.cardItemList.length;n++)if((r=t.cardItemList[n])&&r.cardId==e){o=1;break}if(0==o){var a=t.gameCtrl.gameTrammel.tiesInfo;for(n=0;n<a.length;n++){var r;(r=a[n]).allCardList.includes(e)&&(o=2)}}return o}(o)){case-1:case 0:a.getChildByName("ndAni").active=!1,a.getChildByName("labTips").active=!1;break;case 1:a.getChildByName("ndAni").active=!0,a.getChildByName("labTips").active=!1,a.getChildByName("ndAni").getComponent(sp.Skeleton).setAnimation(0,"green",!0);break;case 2:a.getChildByName("ndAni").active=!1,a.getChildByName("labTips").active=!0}var h=0;if(t.isVideo&&r.quality>=2){var f=t.getCard(o);if(0==h&&f&&f.starNum<P.BraveTowerParameter.SkillUnlockStar2&&(h=3),0==h){var m=t.gameCtrl.gameTrammel.tiesInfo;for(d=0;d<m.length;d++){var y=m[d];if(y.allCardList.includes(o)&&!y.cardList.includes(o)&&y.cardList.length+1==y.allCardList.length){h=4;break}}}0!=h||f||(h=5)}if(a.attr(((i={})[l.isVideo]=h,i)),h)a.getChildByName("Layout").active=!1,a.getChildByName("ndVideo").active=!0,t.isVideo=!1,t.videoRefreshNum=0;else{a.getChildByName("Layout").active=!0,a.getChildByName("ndVideo").active=!1;var v=r.price,_=t.gameCtrl.gameBuff.getBuff(b.BraveTowerEnumBuffID.BuffID50);if(_&&_.data50.includes(o)){var C=1;C-=_.value[0]*_.time,v=Math.floor(v*C)}a.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=P.BraveTowerGameUtils.numberFomat(v),a.attr(((n={})[l.price]=v,n))}};this.isAni=!0;var C=function(e){var o=D.ndCardBuy[e];cc.tween(o).to(.1,{scaleX:0}).call(function(){o.getChildByName("ndInfo").active=!0,o.getChildByName("ndLock").active=!1,_(o,t.shopList[e])}).to(.1,{scaleX:1}).call(function(){t.isAni=!1}).start()},D=this;for(s=0;s<this.ndCardBuy.length;s++)C(s)},e.prototype.onBuy=function(t){if(0==this.shopList.length)return 0;for(var e=this.shopList[t],o=0,i=0;i<P.BraveTowerParameter.MaxDeckNum;i++)this.cardItemList[i].cardId>0&&o++;var n=this.ndCardBuy[t].getChildByName("ndInfo"),a=n[l.isVideo];if(a&&6!=a){for(var r=0;r<this.cardItemList.length;r++)if((u=this.cardItemList[r])&&u.cardId==e)return u.starNum>=P.BraveTowerParameter.SkillUnlockStar2?-3:a;return o>=P.BraveTowerParameter.MaxDeckNum?-1:a}var s=n[l.price];if(this.gameCtrl.gameData.goldNum<s)return-2;for(var c=0;c<this.cardItemList.length;c++)if((u=this.cardItemList[c])&&u.cardId==e)return u.starNum>=P.BraveTowerParameter.SkillUnlockStar2?-3:(u.addLevel(),h.AudioMgr.getInstance().playEffect(y.AudioId.Cards,"card"),2);for(var p=0;p<this.cardItemList.length;p++){var u;if((u=this.cardItemList[p])&&0==u.cardId)return u.init(e),1}return-1},e.prototype.onBuyEnd=function(){this.shopList=[];for(var t=function(t){var o=e.ndCardBuy[t];cc.tween(o).to(.1,{scaleX:0}).call(function(){o.getChildByName("ndInfo").active=!1,o.getChildByName("ndLock").active=!0}).to(.2,{scaleX:1}).start()},e=this,o=0;o<this.ndCardBuy.length;o++)t(o);I.PlayerMgr.getInstance().getTaskData().addCoreCombatBuyCardNum()},e.prototype.onAdd=function(){for(var t=0,e=0;e<P.BraveTowerParameter.MaxDeckNum;e++){var o=this.cardItemList[e];if(-1==o.cardId||-2==o.cardId){t=e;break}}this.cardItemList[t].init(0);var i=P.BraveTowerSwitch.VideoUnlockGridNum();for(e=1;e<=i&&!(t+e>=P.BraveTowerParameter.MaxDeckNum);e++)this.cardItemList[t+e].init(-2);this.upBtnView()},e.prototype.onSell=function(t){var e=this.cardItemList[t],o=e.cardId;this.gameCtrl.gameData.delCardBullt(e.ctrCard),e.onSell(),this.gameCtrl.gameSkillBuff.onUpdateCard(),this.gameCtrl.gameTrammel.onUpdateTies(),this.upCardView(),this.gameCtrl.ctrEffect.changeCard(o)},e.prototype.getCard=function(t){for(var e=0;e<this.cardItemList.length;e++){var o=this.cardItemList[e];if(o&&o.cardId==t)return o}return null},e.prototype.getAllCardList=function(){for(var t=[],e=0;e<this.cardItemList.length;e++){var o=this.cardItemList[e];o&&o.cardId>0&&t.push(o)}return t},e.prototype.upCardData=function(){for(var t=0;t<this.cardItemList.length;t++){var e=this.cardItemList[t];e&&e.cardId>0&&e.updateView()}},e.prototype.upCardView=function(){var t=this;if(this.shopList&&0!=this.shopList.length)for(var e=function(e,o){var i,n=e.getChildByName("ndInfo"),a=B.DataMgr.getInstance().getCardCfg(o);switch(function(e){var o=0,i=t.getCard(e);if(i&&i.starNum>=P.BraveTowerParameter.SkillUnlockStar2)return-1;for(var n=0;n<t.cardItemList.length;n++)if((r=t.cardItemList[n])&&r.cardId==e){o=1;break}if(0==o){var a=t.gameCtrl.gameTrammel.tiesInfo;for(n=0;n<a.length;n++){var r;(r=a[n]).allCardList.includes(e)&&(o=2)}}return o}(o)){case-1:case 0:n.getChildByName("ndAni").active=!1,n.getChildByName("labTips").active=!1;break;case 1:n.getChildByName("ndAni").active=!0,n.getChildByName("labTips").active=!1,n.getChildByName("ndAni").getComponent(sp.Skeleton).setAnimation(0,"green",!0);break;case 2:n.getChildByName("ndAni").active=!1,n.getChildByName("labTips").active=!0}var r=n[l.isVideo];if(6==r){n.getChildByName("Layout").active=!0,n.getChildByName("ndVideo").active=!1;var s=n[l.price]||0;n.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=P.BraveTowerGameUtils.numberFomat(s)}else if(r)n.getChildByName("Layout").active=!1,n.getChildByName("ndVideo").active=!0;else{n.getChildByName("Layout").active=!0,n.getChildByName("ndVideo").active=!1,s=a.price;var c=t.gameCtrl.gameBuff.getBuff(b.BraveTowerEnumBuffID.BuffID50);if(c&&c.data50.includes(o)){var p=1;p-=c.value[0]*c.time,s=Math.floor(s*p)}n.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=P.BraveTowerGameUtils.numberFomat(s),n.attr(((i={})[l.price]=s,i))}},o=0;o<this.ndCardBuy.length;o++)e(this.ndCardBuy[o],this.shopList[o])},e.prototype.getBossHp=function(){var t=this.bossList.shift();if(!t){var e=cc.instantiate(this.ctrBossHp.node);e.setParent(this.ctrBossHp.node.parent),t=e.getComponent(D.ItemHp)}return t.node.setSiblingIndex(this.ctrBossHp.node.parent.childrenCount),t},e.prototype.freeBossHp=function(t){t.setShow(!1),this.bossList.push(t)},e.prototype.endGame=function(){var t=this;this.bossList=[],this.ctrBossHp.node.parent.children.forEach(function(e){var o=e.getComponent(D.ItemHp);o.setShow(!1),t.bossList.push(o)})},c([k({type:cc.Node,tooltip:"\u901f\u5ea6"})],e.prototype,"btnSpeed",void 0),c([k({type:cc.Node,tooltip:"\u94f6\u5e01\u52a0\u6210"})],e.prototype,"btnAddCoin",void 0),c([k({type:cc.Node,tooltip:"\u94f6\u5e01\u6c14\u6ce1"})],e.prototype,"btnCoinBub",void 0),c([k({type:cc.Label,tooltip:"\u56de\u5408\u6570"})],e.prototype,"labRound",void 0),c([k({type:cc.Node,tooltip:"\u7ecf\u9a8c"})],e.prototype,"ndEx",void 0),c([k({type:D.ItemHp,tooltip:"boss\u8840\u6761"})],e.prototype,"ctrBossHp",void 0),c([k({type:cc.Node,tooltip:"\u5361\u724c"})],e.prototype,"ndHeroItem",void 0),c([k({type:cc.Node,tooltip:"\u5361\u724c\u8282\u70b9"})],e.prototype,"ndHero",void 0),c([k({type:cc.Sprite,tooltip:"\u8840\u6761"})],e.prototype,"sprProHp",void 0),c([k({type:cc.Label,tooltip:"\u8840\u6761"})],e.prototype,"labProHp",void 0),c([k({type:cc.Node,tooltip:"\u5546\u5e97"})],e.prototype,"ndBuy",void 0),c([k({type:cc.Label,tooltip:"\u91d1\u5e01"})],e.prototype,"labGold",void 0),c([k({type:cc.Node,tooltip:"\u91d1\u5e01"})],e.prototype,"ndAniGold",void 0),c([k({type:cc.Node,tooltip:"\u5237\u65b0\u6309\u94ae"})],e.prototype,"btnRefresh",void 0),c([k({type:cc.Node,tooltip:"\u6269\u5efa\u6309\u94ae"})],e.prototype,"btnAdd",void 0),c([k({type:cc.Node,tooltip:"\u6ce2\u6b21\u95f4\u9694\u6309\u94ae"})],e.prototype,"ndTime",void 0),c([A],e)}(p.default);a.default=w,function(t){t.isVideo="isVideo",t.price="price"}(l||(l={})),cc._RF.pop(),cc._RF.pop()},{}],GameUserData:[function(t,e,o){"use strict";cc._RF.push(e,"22154alMEtAGoLXMFlsRGCT","GameUserData");var i=t,n=e,a=o;cc._RF.push(n,"22154alMEtAGoLXMFlsRGCT","GameUserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.UserData=a.CardInfo=a.ThirdUserInfo=void 0;var c=i("BaseData"),l=i("EventMgr"),p=i("LanguageMgr"),u=i("Config"),d=i("BraveTowerEnum"),h=i("GameEnumData"),f=i("DataMgr");a.ThirdUserInfo=function(){},a.CardInfo=function(){};var m=function(){this.goldNum=0,this.diamondNum=0,this.couponNum=0,this.freeNum=[],this.curStage=1,this.maxStage=1,this.maxOrder=0,this.rewardInfo=[],this.CardList=[],this.drawTimes=0,this.drawVideoTimes=[],this.drawList=[],this.tag1=!1,this.version=1},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={playerName:"1",thridUserInfo:"2",goldNum:"3",diamondNum:"4",couponNum:"5",freeNum:"6",curStage:"7",maxStage:"8",maxOrder:"9",rewardInfo:"a",CardList:"b",drawTimes:"c",drawVideoTimes:"d",drawList:"e",id:"ba",level:"bb",curNum:"bc",maxNum:"bd",getNum:"be",tag1:"f",version:"Z"},e.gameKey=u.GameConfig.AppCacheName+"udata",e.isNewUser=!1,e.vesion=1,e}return s(e,t),e.prototype.createData=function(){return this.data=new m,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getIsNewUser=function(){return this.isNewUser},e.prototype.reloadConfig=function(){if(this.isNewUser||0==this.data.CardList.length)for(var t=f.DataMgr.getInstance().getParamCfg(h.BraveTowerEnumParamsCfg.Params06).split(","),e=0;e<t.length;e++){var o=t[e];this.addCardNum(parseInt(o),1)}(this.isNewUser||!this.data.tag1&&0==this.data.diamondNum)&&(this.data.tag1=!0,this.data.diamondNum=parseInt(f.DataMgr.getInstance().getParamCfg(h.BraveTowerEnumParamsCfg.Params16)),console.log(this.data.diamondNum),this.saveData())},e.prototype.getPlayerName=function(){return p.LanguageMgr.getInstance().T(this.data.playerName)},e.prototype.setPlayerName=function(t){this.data.playerName=t,this.saveData()},e.prototype.getThirdInfo=function(){return this.data.thridUserInfo},e.prototype.setThirdInfo=function(t){this.data.thridUserInfo=t,this.saveData()},e.prototype.getGoldNum=function(){return this.data.goldNum},e.prototype.addGoldNum=function(t){this.data.goldNum+=t,this.saveData(),l.EventMgr.getInstance().emit(u.EventName.RefreshGold,t,!0)},e.prototype.subGoldNum=function(t){return!(this.data.goldNum<t||(this.data.goldNum-=t,l.EventMgr.getInstance().emit(u.EventName.RefreshGold,t,!1),this.saveData(),0))},e.prototype.getDiamondNum=function(){return this.data.diamondNum},e.prototype.setDiamondNum=function(t){this.data.diamondNum=t,this.saveData()},e.prototype.addDiamondNum=function(t){this.data.diamondNum+=t,this.saveData(),l.EventMgr.getInstance().emit(u.EventName.RefreshDiamond,t,!0)},e.prototype.subDiamondNum=function(t){return!(this.data.diamondNum<t||(this.data.diamondNum-=t,l.EventMgr.getInstance().emit(u.EventName.RefreshDiamond,t,!1),this.saveData(),0))},e.prototype.getCouponNum=function(){return this.data.couponNum},e.prototype.setCouponNum=function(t){this.data.couponNum=t,this.saveData()},e.prototype.addCouponNum=function(t){this.data.couponNum+=t,this.saveData()},e.prototype.subCouponNum=function(t){return!(this.data.couponNum<t||(this.data.couponNum-=t,this.saveData(),0))},e.prototype.getFreeNum=function(t){return this.data.freeNum[t]||0},e.prototype.setFreeNum=function(t,e){this.data.freeNum[t]=e,l.EventMgr.getInstance().emit(d.BraveTowerEventName.UpdateAllShard),this.saveData()},e.prototype.addFreeNum=function(t,e){this.data.freeNum[t]=(this.data.freeNum[t]||0)+e,l.EventMgr.getInstance().emit(d.BraveTowerEventName.UpdateAllShard),this.saveData()},e.prototype.subFreeNum=function(t,e){return!(this.data.freeNum[t]<e||(this.data.freeNum[t]-=e,l.EventMgr.getInstance().emit(d.BraveTowerEventName.UpdateAllShard),this.saveData(),0))},e.prototype.getStage=function(){return this.data.curStage},e.prototype.getMaxStage=function(){return this.data.maxStage},e.prototype.getMaxOrder=function(){return this.data.maxOrder},e.prototype.setStage=function(t){this.data.curStage=t,this.saveData()},e.prototype.passOrder=function(t,e){t<this.data.maxStage||e>this.data.maxOrder&&(this.data.maxOrder=e,this.saveData())},e.prototype.passStage=function(t){t>=this.data.maxStage&&(this.data.maxStage=t+1,this.data.maxOrder=0,this.saveData())},e.prototype.getStageReward=function(t,e){return!(!this.data.rewardInfo||!this.data.rewardInfo[t-1])&&(this.data.rewardInfo[t-1]&1<<e-1)>0},e.prototype.getStageRewardInfo=function(t,e){this.data.rewardInfo||(this.data.rewardInfo=[]),this.data.rewardInfo[t-1]||(this.data.rewardInfo[t-1]=0),this.data.rewardInfo[t-1]|=1<<e-1,this.saveData()},e.prototype.getCardById=function(t){for(var e=0;e<this.data.CardList.length;e++){var o=this.data.CardList[e];if(o.id==t)return o}return null},e.prototype.addCardNum=function(t,e){var o=this.getCardById(t);o?(o.curNum+=e,o.getNum+=e):e>0&&this.data.CardList.push({id:t,level:1,curNum:e-1,getNum:e-1}),this.saveData()},e.prototype.getCardList=function(){return this.data.CardList},e.prototype.updateCard=function(t){var e=this.getCardById(t),o=f.DataMgr.getInstance().getCardCfg(t),i=f.DataMgr.getInstance().getCardQualityCfg(o.quality).levelInfo[e.level-1].fragment;return e.level++,e.curNum<i?(this.subFreeNum(o.quality-1,i-e.curNum),e.curNum=0):e.curNum-=i,this.saveData(),e.level},e.prototype.getDrawTimes=function(){return this.data.drawTimes},e.prototype.addDrawTimes=function(t){this.data.drawTimes+=t,this.saveData()},e.prototype.getDrawList=function(){return this.data.drawList},e.prototype.addDrawList=function(t){this.data.drawList[t]=1,this.saveData()},e.prototype.cleanDrawList=function(t){this.data.drawTimes-=t,this.data.drawList=[],this.saveData()},e.prototype.getDrawVideoTimes=function(t){return this.data.drawVideoTimes[t]||0},e.prototype.addDrawVideoTimes=function(t,e){return void 0===e&&(e=1),this.data.drawVideoTimes[t]=(this.data.drawVideoTimes[t]||0)+e,this.saveData(),this.data.drawVideoTimes[t]},e.prototype.subDrawVideoTimes=function(t,e){this.data.drawVideoTimes[t]=(this.data.drawVideoTimes[t]||0)-e,this.saveData()},e}(c.BaseData);a.UserData=g,cc._RF.pop(),cc._RF.pop()},{}],HOLD_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"829fevlUKFIxLq8C7M+Te0a","HOLD_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"829fevlUKFIxLq8C7M+Te0a","HOLD_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("PoolMgr"),h=i("NodeLib"),f=i("Hold_Configs"),m=i("Hold_GameCtrl"),g=i("Hold_extraBuffItem"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.extraBuffArr=[],e.pro_sprBgSup=null,e.pro_hitLayer=null,e.pro_ndWarn=null,e.effectArrMaxNum=20,e.effectArr=[],e.smallDieEffcetNum=30,e.smallDieEffcetArr=[],e.bigDieEffcetNum=20,e.bigDieEffcetArr=[],e.pro_btn_pause=null,e.pro_pauseLayer=null,e.isPause=!1,e.lockSpacePause=!1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,this.initProperty(),this.initEvent(),this.weblinkLabel.active=l.Platform.WEB_LINK==u.PlatformSetting.currentPlatform},e.prototype.start=function(){},e.prototype.initEvent=function(){this.addEvent(f.emHOLDEventName.hold_attackEffect,this.showEffect),this.addEvent(f.emHOLDEventName.hold_hurtRed,this.playWarn),this.addEvent(f.emHOLDEventName.hold_screenShake,this.onScreenShake),this.addEvent(f.emHOLDEventName.hold_spacePause,this.doSpacePause),this.addEvent(f.emHOLDEventName.hold_addExtreaBuff,this.addExtreaBuff),this.initBtnListener()},e.prototype.initBtnListener=function(){var t=this;this.pro_btn_pause.on(cc.Node.EventType.TOUCH_END,function(){t.doPauseDown()}),this.pro_pauseLayer.children[1].on(cc.Node.EventType.TOUCH_END,function(){t.lockSpacePause=!0,t.openUI(f.HOLD_UIID.UISetting,function(){t.pro_btn_pause.active=!0,t.pro_pauseLayer.active=!1,m.default.instance.setGameState(1),t.isPause=!1,t.lockSpacePause=!1})}),this.pro_pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pro_btn_pause.active=!0,t.pro_pauseLayer.active=!1,m.default.instance.setGameState(1),t.isPause=!1})},e.prototype.doSpacePause=function(){m.default.instance.getIsStart()&&!this.lockSpacePause&&(this.pro_btn_pause.active?this.doPauseDown():(this.pro_btn_pause.active=!0,this.pro_pauseLayer.active=!1,m.default.instance.setGameState(1),this.isPause=!1))},e.prototype.doPauseDown=function(){m.default.instance.getIsStart()&&(m.default.instance.setGameState(0),this.isPause=!0,this.pro_btn_pause.active=!1,this.pro_pauseLayer.active=!0)},e.prototype.initProperty=function(){this.pro_hitLayer=h.default.findChildByName(this.node,"hitLayer"),this.pro_ndWarn=h.default.findChildByName(this.node,"ndWarn"),this.pro_sprBgSup=h.default.findChildByName(this.node,"bg"),this.pro_btn_pause=h.default.findChildByName(this.node,"btn_pause"),this.pro_pauseLayer=h.default.findChildByName(this.node,"pauseLayer")},e.prototype.showEffect=function(t,e){var o=this,i=this.getEffectNode(e),n=i.parent.convertToNodeSpaceAR(t);i.setPosition(n),i.active=!0;var a=i.getComponent(cc.Animation);a.play();var r=a.defaultClip.duration;r/=a.defaultClip.speed,this.scheduleOnce(function(){o.freeEffectNode(i,e),i.active=!1},r)},e.prototype.playWarn=function(){var t=this;this.pro_ndWarn.active||(cc.Tween.stopAllByTarget(this.pro_ndWarn),this.pro_ndWarn.active=!0,cc.tween(this.pro_ndWarn).to(.2,{opacity:255}).to(.2,{opacity:0}).call(function(){t.pro_ndWarn.active=!1}).start())},e.prototype.freeEffectNode=function(t,e){e==f.HoldEffectType.smallDie?this.smallDieEffcetArr.length>this.smallDieEffcetNum?d.PoolMgr.getInstance().freeNode(f.poolName.smallDieEffect,t):this.smallDieEffcetArr.push(t):e==f.HoldEffectType.bigDie?this.bigDieEffcetArr.length>this.bigDieEffcetNum?d.PoolMgr.getInstance().freeNode(f.poolName.bigDieEffect,t):this.bigDieEffcetArr.push(t):this.effectArr.length>this.effectArrMaxNum?d.PoolMgr.getInstance().freeNode(f.poolName.effect,t):this.effectArr.push(t)},e.prototype.getEffectNode=function(t){return t==f.HoldEffectType.smallDie?this.getSmallDieEffectNode():t==f.HoldEffectType.bigDie?this.getBigDieEffectNode():this.getNormalEffectNode()},e.prototype.getBigDieEffectNode=function(){var t=this.bigDieEffcetArr.pop();return t||((t=d.PoolMgr.getInstance().getNode(f.poolName.bigDieEffect)).parent=this.getEffcetParent("bigDieEffect")),t.scale=1,t},e.prototype.getSmallDieEffectNode=function(){var t=this.smallDieEffcetArr.pop();return t||((t=d.PoolMgr.getInstance().getNode(f.poolName.smallDieEffect)).parent=this.getEffcetParent("smallDieEffect")),t.scale=1,t},e.prototype.getNormalEffectNode=function(){var t=this.effectArr.pop();return t||((t=d.PoolMgr.getInstance().getNode(f.poolName.effect)).parent=this.getEffcetParent("normalDieEffect")),t.scale=.5,t},e.prototype.getEffcetParent=function(t){var e=this.pro_hitLayer.getChildByName(t);return e||((e=new cc.Node(t)).parent=this.pro_hitLayer),e},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.pro_sprBgSup),this.pro_sprBgSup,cc.tween(this.pro_sprBgSup).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-10,-10)}).by(.05,{position:cc.v3(20,10)}).by(.05,{position:cc.v3(-20,0)}).by(.05,{position:cc.v3(20,-10)}).by(.05,{position:cc.v3(-10,10)}).set({position:cc.v3(0,0)}).start()},e.prototype.addExtreaBuff=function(t){var e=cc.instantiate(this.extraBuffLayer.children[0]);e.active=!0,e.parent=this.extraBuffLayer;var o=e.getComponent(g.default);o.initBuffInfo(t),this.extraBuffArr.push(o)},e.prototype.update=function(t){var e=this;0==this.extraBuffArr.length||this.isPause||this.extraBuffArr.forEach(function(o,i){o.node.y-=200*t,o.node.y-o.node.height/2<m.default.instance.getDieLayer().y&&(o.doDestroyDown(),e.extraBuffArr.splice(i,1))})},c([_(cc.Node)],e.prototype,"extraBuffLayer",void 0),c([_(cc.Node)],e.prototype,"weblinkLabel",void 0),o=c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],HOLD_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"cfd3d2scRlIS46D3PTNMFFr","HOLD_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"cfd3d2scRlIS46D3PTNMFFr","HOLD_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("NodeLib"),u=i("Hold_App"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ndWin=null,e.pro_ndFail=null,e.pro_btn=null,e.isWin=!1,e.pro_progressLabel=null,e.progress=0,e}return s(e,t),e.prototype.init=function(t,e){this.isWin=t,this.progress=e},e.prototype.initproperty=function(){this.pro_ndWin=p.default.findChildByName(this.node,"pro_ndWin"),this.pro_ndFail=p.default.findChildByName(this.node,"pro_ndFail"),this.pro_btn=p.default.findChildByName(this.node,"pro_btn"),this.pro_progress=p.default.findChildByName(this.node,"pro_progress").getComponent(cc.Sprite),this.pro_progressLabel=p.default.findChildByName(this.node,"pro_progressLabel").getComponent(cc.Label)},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initView(),this.pro_btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.pro_ndFail.active=!this.isWin,this.pro_ndWin.active=this.isWin,this.isWin&&(this.progress=100),this.pro_progress.fillRange=this.progress/100,this.pro_progressLabel.string=this.progress+"%"},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],HOLD_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"2be7dnKqxlBJajZu0vCCa7M","HOLD_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"2be7dnKqxlBJajZu0vCCa7M","HOLD_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("NodeLib"),m=i("Hold_GameCtrl"),g=i("Hold_App"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_musicSlider=null,e.pro_effectSlider=null,e.pro_btnClose=null,e.pro_btnBackHome=null,e.pro_btnPlay=null,e.pro_gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.initproperty=function(){this.pro_musicSlider=f.default.findChildByName(this.node,"pro_musicSlider").getComponent(cc.Slider),this.pro_effectSlider=f.default.findChildByName(this.node,"pro_effectSlider").getComponent(cc.Slider),this.pro_btnClose=f.default.findChildByName(this.node,"pro_btnClose"),this.pro_btnBackHome=f.default.findChildByName(this.node,"pro_btnBackHome"),this.pro_btnPlay=f.default.findChildByName(this.node,"pro_btnPlay"),this.pro_gmNode=f.default.findChildByName(this.node,"pro_gmNode"),this.pro_musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.pro_effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.pro_musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.pro_effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.pro_musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.pro_effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.pro_musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.pro_gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&m.default.instance.openGmButtom()}),this.pro_effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.pro_btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.pro_btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){g.default.instance.exit_App(0)}),this.pro_btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([v],e)}(p.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],Hold_App:[function(t,e,o){"use strict";cc._RF.push(e,"4295d6GqQ1JYb2YD85tGrDl","Hold_App");var i=t,n=e,a=o;cc._RF.push(n,"4295d6GqQ1JYb2YD85tGrDl","Hold_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("EventMgr"),c=i("UIMgr"),l=i("Config"),p=i("Hold_Configs"),u=i("Hold_DataMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(t){t.keyCode==cc.macro.KEY.space&&s.EventMgr.getInstance().emit(p.emHOLDEventName.hold_spacePause)}),this.addTouchEvent(),this._exitCall=e;var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(p.HOLD_UIID.UIGame,l.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(p.HOLD_AudioId.bgm,p.HOLDConfig.BgMusic)})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(p.HOLD_UICF),r.AudioMgr.getInstance().addAdConf(p.HOLD_AudioCF),u.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){c.UIMgr.getInstance().closeById(p.HOLD_UIID.UIGame),c.UIMgr.getInstance().closeById(p.HOLD_UIID.UIResult),c.UIMgr.getInstance().closeById(p.HOLD_UIID.UISetting),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],Hold_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"98ccaAwDcRHjoBgItxveayK","Hold_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"98ccaAwDcRHjoBgItxveayK","Hold_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.HoldTreasureType=l.emHOLDBuffType=l.belongCamp=l.heroPropertyType=l.AIState=l.bulletDir=l.poolName=l.emHOLDGameState=l.HoldEffectType=l.emHOLDEventName=l.HOLD_AudioCF=l.Hold_AudioIDType=l.HOLD_AudioId=l.HOLD_UICF=l.HOLDConfig=l.emHOLDBundles=l.HOLD_UIID=void 0,function(t){t.UIGame="HOLD_UIGame",t.UIResult="HOLD_UIResult",t.UISetting="HOLD_UISetting"}(a=l.HOLD_UIID||(l.HOLD_UIID={})),function(t){t.prefabs="hold_prefabs",t.audios="hold_audios",t.imgs="hold_imgs",t.configs="hold_configs"}(r=l.emHOLDBundles||(l.emHOLDBundles={})),l.HOLDConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.HOLD_UICF=((i={})[a.UIGame]={prefab:"ui/HOLD_UIGame",name:"HOLD_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/HOLD_UIResult",name:"HOLD_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/HOLD_UISetting",name:"HOLD_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.arrow="arrow",t.blood="blood",t.boomerang="boomerang",t.bullet="bullet",t.calabash="calabash",t.dragonHit="dragonHit",t.firefan="firefan",t.freeze="freeze",t.icebreak="icebreak",t.peacock="peacock",t.sleArrow="sleArrow",t.sword="sword",t.treasure="treasure",t.turret="turret",t.bgm="bgm",t.hurt="hurt"}(s=l.HOLD_AudioId||(l.HOLD_AudioId={})),function(t){t.weapon="weapon",t.role="role",t.bullet="bullet"}(l.Hold_AudioIDType||(l.Hold_AudioIDType={})),l.HOLD_AudioCF=((n={})[s.bullet]={path:"bullet",bundle:r.audios},n[s.arrow]={path:"arrow",bundle:r.audios},n[s.blood]={path:"blood",bundle:r.audios},n[s.boomerang]={path:"boomerang",bundle:r.audios},n[s.calabash]={path:"calabash",bundle:r.audios},n[s.dragonHit]={path:"dragonHit",bundle:r.audios},n[s.firefan]={path:"firefan",bundle:r.audios},n[s.freeze]={path:"freeze",bundle:r.audios},n[s.icebreak]={path:"icebreak",bundle:r.audios},n[s.peacock]={path:"peacock",bundle:r.audios},n[s.sleArrow]={path:"sleArrow",bundle:r.audios},n[s.sword]={path:"sword",bundle:r.audios},n[s.treasure]={path:"treasure",bundle:r.audios},n[s.turret]={path:"turret",bundle:r.audios},n[s.bgm]={path:"bgm",bundle:r.audios},n[s.hurt]={path:"hurt",bundle:r.audios},n),function(t){t.hold_attackEffect="hold_attackEffect",t.hold_hurtRed="hold_hurtRed",t.hold_screenShake="hold_screenShake",t.hold_spacePause="hold_spacePause",t.hold_addExtreaBuff="hold_addExtreaBuff"}(l.emHOLDEventName||(l.emHOLDEventName={})),function(t){t.hit="hit",t.bigDie="bigDie",t.smallDie="smallDie"}(l.HoldEffectType||(l.HoldEffectType={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emHOLDGameState||(l.emHOLDGameState={})),function(t){t.bullet="bullet",t.enemy="enemy",t.effect="effect",t.weapon="weapon",t.smallDieEffect="smallDieEffect",t.bigDieEffect="bigDieEffect"}(l.poolName||(l.poolName={})),function(t){t.None="None",t.up="up",t.down="down",t.left="left",t.right="right"}(l.bulletDir||(l.bulletDir={}));var p=function(){function t(){}return t.None="None",t.static="static",t.Move="move",t}();l.AIState=p,function(t){t[t.attackPower=1]="attackPower",t[t.attackSpeed=2]="attackSpeed",t[t.penetrate=3]="penetrate",t[t.critChance=4]="critChance",t[t.bulletCount=5]="bulletCount",t[t.skillInterval=6]="skillInterval",t[t.skillTimer=7]="skillTimer"}(l.heroPropertyType||(l.heroPropertyType={})),function(t){t[t.hero=1]="hero",t[t.enemy=2]="enemy"}(l.belongCamp||(l.belongCamp={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul",t.skillInterval="skillInterval"}(l.emHOLDBuffType||(l.emHOLDBuffType={})),function(t){t.leftTreasure="leftTreasure",t.rightTreasure="rightTreasure"}(l.HoldTreasureType||(l.HoldTreasureType={}));var u=function(){function t(){}return t.testID=0,t}();l.Global=u,cc._RF.pop(),cc._RF.pop()},{}],Hold_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a5f46xOyp5O47xVojRl2UG9","Hold_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"a5f46xOyp5O47xVojRl2UG9","Hold_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("Hold_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/holdCenter/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emHOLDBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getCharacterCfg=function(){return this.data.characterCfg},t.prototype.getEnemyCfg=function(){return this.data.enemyCfg},t.prototype.getEnemyCfgByID=function(t){for(var e=this.data.enemyCfg,o=0;o<e.length;o++)if(e[o].enemyID==t)return e[o]},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLeftBuffCfg=function(){return this.data.leftTreasureCfg},t.prototype.getRightBuffCfg=function(){return this.data.rightTreasureCfg},t.prototype.getBuffTypeCfgByName=function(t){for(var e=this.data.buffTypeCfg,o=0;o<e.length;o++)if(e[o].buffType==t)return e[o]},t.prototype.getWeaponCfgByID=function(t){for(var e=this.data.weaponCfg,o=0;o<e.length;o++)if(e[o].weaponID==t)return e[o]},t.prototype.getWeaponCfg=function(){return this.data.weaponCfg},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],Hold_EnemyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"5f5a5eavvtCSo9z7tiwdMdj","Hold_EnemyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"5f5a5eavvtCSo9z7tiwdMdj","Hold_EnemyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Hold_Configs"),u=i("Hold_DataMgr"),d=i("Hold_EnemyItem"),h=i("Hold_GameCtrl"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentLevel=0,e.levelCfg=[],e.monsterZindex=0,e.canSpawnNextWave=!0,e.remainingDistance=0,e.isEnd=!1,e.bossArr=[],e}return s(e,t),e.prototype.spawnNextWave=function(){if(this.isEnd)this.isEnd=!0;else{var t=this.levelCfg[this.currentLevel],e=t.enemyID,o=t.enemyHp,i=t.enemyATK,n=t.enemyMove,a=t.distance,r=t.enemyAmountX,s=t.enemyAmountY,c=t.distanceY,u=-this.node.width/2,h=this.node.width/(r-1),f=cc.winSize.height/2+c;if(1==r)f+=(y=l.PoolMgr.getInstance().getNode(p.poolName.enemy+e)).height,y.zIndex=this.monsterZindex--,y.parent=this.node,y.x=0,y.y=f,(v=y.getComponent(d.default)).init(e,o,i,n,0,t.buffDoor),this.bossArr.push(v);else for(var m=0;m<r;m++)for(var g=0;g<s;g++){var y;(y=l.PoolMgr.getInstance().getNode(p.poolName.enemy+e)).zIndex=this.monsterZindex--,y.parent=this.node;var v,_=g%2==0?0:h/3;y.x=u+h*m+_,y.y=f+c*g,(v=y.getComponent(d.default)).init(e,o,i,n,g*c)}this.currentLevel++,this.remainingDistance=a,this.canSpawnNextWave=!1,this.levelCfg[this.currentLevel]||(this.isEnd=!0)}},e.prototype.getEnemies=function(){return this.node.children.map(function(t){return t.getComponent(d.default)}).filter(function(t){return t})},e.prototype.getBoss=function(){return this.bossArr},e.prototype.isCurrentWaveFinished=function(){return this.remainingDistance<=0},e.prototype.tryWinGame=function(){this.isEnd&&0===this.getEnemies().length&&h.default.instance.doGameOver(!0,100)},e.prototype.frozenMonster=function(t){this.getEnemies().forEach(function(e){e.frozenMonster(t)})},e.prototype.initParam=function(){this.levelCfg=u.default.getInstance().getLevelCfg()},e.prototype.onLoad=function(){this.initParam()},e.prototype.onUpdate=function(t){this.canSpawnNextWave||(this.remainingDistance-=t*this.levelCfg[this.currentLevel-1].enemyMove,this.isCurrentWaveFinished()&&(this.canSpawnNextWave=!0,this.spawnNextWave())),this.getEnemies().forEach(function(e){e.onUpdate(t)})},c([m],e)}(cc.Component));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],Hold_EnemyItem:[function(t,e,o){"use strict";cc._RF.push(e,"01503tn5MNO1qtwgphJtYB5","Hold_EnemyItem");var i=t,n=e,a=o;cc._RF.push(n,"01503tn5MNO1qtwgphJtYB5","Hold_EnemyItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("PoolMgr"),d=i("Hold_Configs"),h=i("Hold_DataMgr"),f=i("Hold_GameCtrl"),m=i("linePos"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpNode=null,e.hpProgress=null,e.pro_ani=null,e.radius=20,e.hp=0,e.maxHp=0,e.atk=0,e.moveSpeed=0,e.enemyID=0,e.worldPos=null,e.baseScale=1,e.isDestroy=!1,e.doorBuff="",e.frozenColor=cc.color().fromHEX("46a98a"),e}return s(e,t),e.prototype.init=function(t,e,o,i,n,a){void 0===a&&(a=""),this.enemyID=t,this.hp=e,this.maxHp=e,this.atk=o,this.moveSpeed=i;var r=h.default.getInstance().getEnemyCfgByID(t);this.baseScale=r.size,this.doorBuff=a,this.initState(),this.worldPos=this.node.convertToWorldSpaceAR(cc.v3(0,0,0)),this.worldPos.z+=n},e.prototype.takeDamage=function(t,e){if(void 0===e&&(e=!1),!this.isDestroy){if(this.hp-=t,e){var o=this.node.convertToWorldSpaceAR(cc.v3(0,0));p.EventMgr.getInstance().emit(d.emHOLDEventName.hold_attackEffect,o)}this.hp<this.maxHp&&(this.hpNode.active=!0),this.updateHpProgress(),this.hp<=0&&this.die()}},e.prototype.attack=function(t){t.takeDamage(this.atk),l.AudioMgr.getInstance().playEffect(d.HOLD_AudioId.hurt),p.EventMgr.getInstance().emit(d.emHOLDEventName.hold_hurtRed),p.EventMgr.getInstance().emit(d.emHOLDEventName.hold_screenShake)},e.prototype.IsBoss=function(){return 4==this.enemyID},e.prototype.frozenMonster=function(t){0==t?(this.pro_ani.pause(),this.pro_ani.node.color=this.frozenColor):(this.pro_ani.resume(),this.pro_ani.node.color=cc.color().fromHEX("ffffff"))},e.prototype.updateHpProgress=function(){this.hpProgress.fillRange=this.hp/this.maxHp},e.prototype.initState=function(){this.hpNode.active=!1,this.hpProgress.fillRange=1,this.pro_ani.node.color=cc.color().fromHEX("ffffff"),this.isDestroy=!1,this.pro_ani.play()},e.prototype.die=function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0));4==this.enemyID?(p.EventMgr.getInstance().emit(d.emHOLDEventName.hold_attackEffect,t,d.HoldEffectType.bigDie),""!=this.doorBuff&&p.EventMgr.getInstance().emit(d.emHOLDEventName.hold_addExtreaBuff,this.doorBuff)):p.EventMgr.getInstance().emit(d.emHOLDEventName.hold_attackEffect,t,d.HoldEffectType.smallDie),f.default.instance.getRoleCtrl().addKillNum(),this.isDestroy=!0,this.node.removeFromParent(),u.PoolMgr.getInstance().freeNode(d.poolName.enemy+this.enemyID,this.node),f.default.instance.getEnemyCtrl().tryWinGame()},e.prototype.onUpdate=function(t){if(!this.isDestroy){var e=this.moveSpeed*t;this.perspective(e),this.checkAttack()}},e.prototype.perspective=function(t){this.worldPos.y-=t,this.worldPos.z-=t;var e=m.PerspectiveLine.getInstance().getScreenPosition(this.worldPos.x,this.worldPos.y,this.worldPos.z,.8),o=this.node.parent.convertToNodeSpaceAR(cc.v2(e.x,e.y));this.node.setPosition(o.x,o.y),this.node.setScale(e.scale*this.baseScale)},e.prototype.checkAttack=function(){var t=f.default.instance.getDieLayer().y+this.node.height*this.node.scale/2;if(this.node.y<t){var e=f.default.instance.getRoleCtrl();this.attack(e),this.die()}},e.prototype.onLoad=function(){this.hpNode=this.node.getChildByName("hpNode"),this.hpProgress=this.hpNode.getChildByName("hpProgress").getComponent(cc.Sprite),this.pro_ani=this.node.getChildByName("ani").getComponent(cc.Animation)},c([y],e)}(cc.Component));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],Hold_GM:[function(t,e,o){"use strict";cc._RF.push(e,"6201afCQ/ZPwapoSJ336qd0","Hold_GM");var i=t,n=e,a=o;cc._RF.push(n,"6201afCQ/ZPwapoSJ336qd0","Hold_GM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Hold_DataMgr"),p=i("Hold_GameCtrl"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.weaponType=null,e.attackPower=null,e}return s(e,t),e.prototype.WeaponBtn=function(){var t=parseInt(this.weaponType.string),e=parseInt(this.attackPower.string);this.addWeapon(t,e)},e.prototype.addWeapon=function(t,e){var o=l.default.getInstance().getWeaponCfgByID(t),i={weaponType:t,weaponPara0:e,weaponPara1:o.weaponPara1,weaponPara2:o.weaponPara2,weaponPara3:o.weaponPara3};p.default.instance.getWeaponCtrl().addWeapon(i)},e.prototype.start=function(){},c([h(cc.EditBox)],e.prototype,"weaponType",void 0),c([h(cc.EditBox)],e.prototype,"attackPower",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],Hold_GameCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"b8d7dzWgIZMGqD3SQHtNy3+","Hold_GameCtrl");var i=t,n=e,a=o;cc._RF.push(n,"b8d7dzWgIZMGqD3SQHtNy3+","Hold_GameCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("NodeLib"),d=i("Hold_Configs"),h=i("Hold_DataMgr"),f=i("linePos"),m=i("Hold_EnemyCtrl"),g=i("Hold_RoleCtrl"),y=i("Hold_buffCtrl"),v=i("Hold_weaponCtrl"),_=i("Hold_rightBuffCtrl"),b=i("UIMgr"),B=i("Config"),I=cc._decorator,P=I.ccclass,C=I.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gmNode=null,e.pro_roleCtrl=null,e.pro_enemyCtrl=null,e.pro_dieLayer=null,e.pro_buffCtrl=null,e.pro_weaponCtrl=null,e.pro_rightBuffCtrl=null,e.bulletLayer=null,e.gameState=0,e.enemyState=0,e.poolNum=0,e.bulletGrid=new Map,e.enemyGrid=new Map,e.maxEnemyNum=10,e.isStart=!1,e.frozenNum=0,e.isEnd=!1,e}var o;return s(e,t),o=e,e.prototype.openGmButtom=function(){this.gmNode.active=!0},e.prototype.getRoleCtrl=function(){return this.pro_roleCtrl},e.prototype.getWeaponCtrl=function(){return this.pro_weaponCtrl},e.prototype.getRightBuffCtrl=function(){return this.pro_rightBuffCtrl},e.prototype.getEnemyCtrl=function(){return this.pro_enemyCtrl},e.prototype.getBulletLayerByIndex=function(t){for(var e=this.bulletLayer.children,o=0;o<e.length;o++)if(e[o].name=="layer"+t)return e[o];var i=new cc.Node;return i.name="layer"+t,this.bulletLayer.addChild(i),i},e.prototype.getDieLayer=function(){return this.pro_dieLayer},e.prototype.damageEnemiesInRange=function(t,e,o){this.pro_enemyCtrl.getEnemies().forEach(function(i){t.sub(i.node.position).mag()<=e&&i.takeDamage(o)})},e.prototype.damageEnemiesInRect=function(t,e,o,i,n){void 0===n&&(n=null),t=this.node.convertToNodeSpaceAR(t),this.pro_enemyCtrl.getEnemies().forEach(function(a){cc.Intersection.rectRect(cc.rect(t.x-e/2,t.y-o/2,e,o),cc.rect(a.node.x-a.node.width*a.node.scale/2,a.node.y-a.node.height*a.node.scale/2,a.node.width,a.node.height))&&(n?n.has(a)||(n.add(a),a.takeDamage(i)):a.takeDamage(i))})},e.prototype.checkCollisionWithEnemies=function(t,e){var o=!1;return this.pro_enemyCtrl.getEnemies().forEach(function(i){var n=t.sub(i.node.position).mag(),a=i.radius*i.node.scale;n<e+a&&(o=!0)}),o},e.prototype.getMinYEnemyPos=function(){var t=1e4;return this.pro_enemyCtrl.getEnemies().forEach(function(e){e.node.y<t&&(t=e.node.y)}),this.node.convertToWorldSpaceAR(cc.v2(0,t)).y},e.prototype.setEnemyCtrlState=function(t){0==t?(this.enemyState=t,this.frozenNum++,this.pro_enemyCtrl.frozenMonster(0)):1==t&&(this.frozenNum--,this.frozenNum<=0&&(this.enemyState=t,this.pro_enemyCtrl.frozenMonster(1)))},e.prototype.getMaxEnemyNum=function(){for(var t=h.default.getInstance().getLevelCfg(),e=0;e<t.length;e++)this.maxEnemyNum+=t[e].enemyAmountX*t[e].enemyAmountY;return this.maxEnemyNum},e.prototype.doGameOver=function(t,e){this.isEnd||(this.isEnd=!0,this.gameState=0,b.UIMgr.getInstance().openUI(d.HOLD_UIID.UIResult,B.UIID.UINONE,t,e))},e.prototype.setGameState=function(t){this.gameState=t},e.prototype.getIsStart=function(){return this.isStart},e.prototype.initPool=function(){var t=this;this.poolNum+=h.default.getInstance().getCharacterCfg().length,h.default.getInstance().getCharacterCfg().forEach(function(e){t.loadPrefab(d.emHOLDBundles.prefabs,"item/bullets/bullet"+e.characterID,function(o){p.PoolMgr.getInstance().creatrePool(d.poolName.bullet+e.characterID,o),t.tryStartGame()})});var e=h.default.getInstance().getEnemyCfg();this.poolNum+=e.length,e.forEach(function(e){t.loadPrefab(d.emHOLDBundles.prefabs,"item/enemeys/enemy_"+e.enemyID,function(o){p.PoolMgr.getInstance().creatrePool(d.poolName.enemy+e.enemyID,o),t.tryStartGame()})});var o=h.default.getInstance().getWeaponCfg();this.poolNum+=o.length,o.forEach(function(e){t.loadPrefab(d.emHOLDBundles.prefabs,"item/weapons/weapon_"+e.weaponID,function(o){p.PoolMgr.getInstance().creatrePool(d.poolName.weapon+e.weaponID,o),t.tryStartGame()})}),this.poolNum+=3,this.loadPrefab(d.emHOLDBundles.prefabs,"item/enemy_hit_fps",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.effect,e),t.tryStartGame()}),this.loadPrefab(d.emHOLDBundles.prefabs,"item/smallDieEffect",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.smallDieEffect,e),t.tryStartGame()}),this.loadPrefab(d.emHOLDBundles.prefabs,"item/bigDieEffect",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.bigDieEffect,e),t.tryStartGame()})},e.prototype.tryStartGame=function(){this.poolNum--,this.poolNum<=0&&(this.gameState=1,this.enemyState=1,this.pro_roleCtrl.addHero(),this.pro_enemyCtrl.spawnNextWave(),this.isStart=!0)},e.prototype.initProperty=function(){this.pro_roleCtrl=u.default.findChildByName(this.node,"roleLayer").getComponent(g.default),this.pro_enemyCtrl=u.default.findChildByName(this.node,"enemyLayer").getComponent(m.default),this.pro_buffCtrl=u.default.findChildByName(this.node,"buffLayer").getComponent(y.default),this.pro_rightBuffCtrl=u.default.findChildByName(this.node,"roleLayer").getComponent(_.default),this.pro_weaponCtrl=u.default.findChildByName(this.node,"weaponLayer").getComponent(v.default),this.bulletLayer=u.default.findChildByName(this.node,"bulletLayer"),this.pro_dieLayer=u.default.findChildByName(this.node,"dieLayer");var t=this.pro_dieLayer.convertToWorldSpaceAR(cc.v2(0,0)).y,e={x:cc.winSize.width/2,y:cc.winSize.height/2};f.PerspectiveLine.getInstance().init(3e3,1,0,t,e)},e.prototype.initEventListen=function(){},e.prototype.initTouchEvent=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.pro_roleCtrl.onMove(e.getDeltaX())})},e.prototype.updateGrids=function(){var t=this;this.bulletGrid.clear(),this.enemyGrid.clear(),this.pro_roleCtrl.getFlyingBullets().forEach(function(e){var o=t.getGridKey(e.node.getPosition());t.bulletGrid.has(o)||t.bulletGrid.set(o,[]),t.bulletGrid.get(o).push(e)}),this.pro_enemyCtrl.getEnemies().forEach(function(e){var o=t.getGridKey(e.node.getPosition());if(e.IsBoss()){var i=t.getGridKey(cc.v2(e.node.x+50,e.node.y-150)),n=t.getGridKey(cc.v2(e.node.x-50,e.node.y-150)),a=t.getGridKey(cc.v2(e.node.x,e.node.y-150));t.enemyGrid.has(i)||t.enemyGrid.set(i,[]),t.enemyGrid.has(n)||t.enemyGrid.set(n,[]),t.enemyGrid.has(a)||t.enemyGrid.set(a,[]),t.enemyGrid.get(i).push(e),t.enemyGrid.get(n).push(e),t.enemyGrid.get(a).push(e)}t.enemyGrid.has(o)||t.enemyGrid.set(o,[]),t.enemyGrid.get(o).push(e)})},e.prototype.getGridKey=function(t){return Math.floor(t.x/100)+","+Math.floor(t.y/100)},e.prototype.checkCollisions=function(){var t=this;this.bulletGrid.forEach(function(e,o){if(t.enemyGrid.has(o)){var i=t.enemyGrid.get(o);e.forEach(function(e){i.forEach(function(o){t.isCollidingWithRect(e,o)&&t.handleCollision(e,o)})})}}),this.checkBulletBuffCollisions(),this.checkEnemyAttacks()},e.prototype.checkBulletBuffCollisions=function(){var t=this;this.bulletGrid.forEach(function(e){e.forEach(function(e){t.pro_buffCtrl.getBuffItems().forEach(function(o){t.isCollidingWithRect(e,o)&&!e.getIsDestroy()&&t.handleBulletBuffCollision(e,o)})})})},e.prototype.handleBulletBuffCollision=function(t,e){t.recycle(),e.takeDamage()},e.prototype.checkEnemyAttacks=function(){var t=this,e=this.getDieLayer().y;this.pro_enemyCtrl.getEnemies().forEach(function(o){o.node.y<e&&(o.attack(t.pro_roleCtrl),o.node.removeFromParent())})},e.prototype.isColliding=function(t,e){if(!t.getIsDestroy())return t.node.position.sub(e.node.position).mag()<t.radius*t.node.scale+e.radius*e.node.scale},e.prototype.isCollidingWithRect=function(t,e){if(!t.getIsDestroy()){var o=t.node.position,i=e.node.position,n=t.radius*t.node.scale,a=e.node.width*e.node.scale,r=e.node.height*e.node.scale,s=Math.abs(o.x-i.x),c=Math.abs(o.y-i.y);return s<=a/2+n&&c<=r/2+n}},e.prototype.handleCollision=function(t,e){t.recycle(),e.takeDamage(this.pro_roleCtrl.getCriticalDamage())},e.prototype.onLoad=function(){o.instance=this,this.initProperty(),this.initPool()},e.prototype.start=function(){this.initTouchEvent()},e.prototype.update=function(t){0!=this.gameState&&(this.pro_roleCtrl.onUpdate(t),1==this.enemyState&&this.pro_enemyCtrl.onUpdate(t),this.pro_buffCtrl.onUpdate(t),this.pro_weaponCtrl.onUpdate(t),this.updateGrids(),this.checkCollisions())},e.instance=null,c([C(cc.Node)],e.prototype,"gmNode",void 0),o=c([P],e)}(l.default);a.default=D,cc._RF.pop(),cc._RF.pop()},{}],Hold_RoleCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"3b1d7y85YJKQ7qgkXwt4cNr","Hold_RoleCtrl");var i=t,n=e,a=o;cc._RF.push(n,"3b1d7y85YJKQ7qgkXwt4cNr","Hold_RoleCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NodeLib"),u=i("hold_GameEnumData"),d=i("Hold_DataMgr"),h=i("Hold_RoleItem"),f=i("Hold_GameCtrl"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroList=[],e.heroLottery=[],e.pro_roleItem=null,e.pro_roleHpProgress=null,e.attackPower=0,e.hp=0,e.attackSpeed=0,e.criticalChance=0,e.criticalMultiple=0,e.bulletCount=0,e.bulletSpeed=0,e.speedPlusTimes=0,e.killNum=0,e}return s(e,t),e.prototype.onMove=function(t){this.pro_roleItem.parent.x+=t},e.prototype.getRolePosition=function(){return this.pro_roleItem.parent.position},e.prototype.modifyProperty=function(t,e){switch(t){case u.enumBuffTypeCfg.ATKplus:this.attackPower+=e;break;case u.enumBuffTypeCfg.ATKsub:this.attackPower-=e;break;case u.enumBuffTypeCfg.ATKmul:this.attackPower*=e;break;case u.enumBuffTypeCfg.ATKdiv:this.attackPower/=e;break;case u.enumBuffTypeCfg.BulletPlus:this.bulletCount+=e;break;case u.enumBuffTypeCfg.Bulletsub:this.bulletCount-=e;break;case u.enumBuffTypeCfg.SpeedPlus:this.attackSpeed+=e;break;case u.enumBuffTypeCfg.SpeedSub:this.attackSpeed/=e;break;case u.enumBuffTypeCfg.critPlus:this.criticalChance+=e;break;case u.enumBuffTypeCfg.critDamPlus:this.criticalMultiple+=e;break;case u.enumBuffTypeCfg.character:this.addHero()}},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.getCriticalDamage=function(){var t=Math.random(),e=this.attackPower;return t<=this.criticalChance&&(e*=this.criticalMultiple),e},e.prototype.getHp=function(){return this.hp},e.prototype.getAttackSpeed=function(){return 1/(this.attackSpeed/this.speedPlusTimes)},e.prototype.getCriticalChance=function(){return this.criticalChance},e.prototype.getCriticalMultiple=function(){return this.criticalMultiple},e.prototype.getBulletCount=function(){return this.bulletCount},e.prototype.getBulletSpeed=function(){return this.bulletSpeed},e.prototype.getFlyingBullets=function(){var t=[];for(var e in this.heroList){var o=this.heroList[e];t=t.concat(o.getFlyingBullets())}return t},e.prototype.getCanColliderWithDoorBullets=function(){var t=[];for(var e in this.heroList){var o=this.heroList[e];t=t.concat(o.getCanColliderWithDoorBullets())}return t},e.prototype.addHero=function(){var t=this.heroLottery[Math.floor(Math.random()*this.heroLottery.length)];this.heroLottery.splice(this.heroLottery.indexOf(t),1);var e=cc.instantiate(this.pro_roleItem);e.active=!0,this.pro_roleItem.parent.addChild(e);var o=e.getComponent(h.default);o.initHero(this,t),this.heroList.push(o),this.initRolePosition(e)},e.prototype.initRolePosition=function(t){var e=this.heroList.length,o=new cc.Vec2(0,0),i=Math.floor(e/2);if(0==i)t.setPosition(o);else{var n=e%2?1:-1;o.x+=n*i*50,o.y-=50*i,t.setPosition(o)}},e.prototype.takeDamage=function(t){this.hp-=t,this.updateHpProgress(),this.hp<=0&&(this.hp=0,this.onDeath())},e.prototype.addKillNum=function(){this.killNum++},e.prototype.updateHpProgress=function(){this.pro_roleHpProgress.fillRange=this.hp/d.default.getInstance().getParam(u.enumBasicParaCfg.baseHP)},e.prototype.onDeath=function(){console.log("\u89d2\u8272\u6b7b\u4ea1");var t=this.killNum/f.default.instance.getMaxEnemyNum();t=Math.floor(100*t),f.default.instance.doGameOver(!1,t)},e.prototype.initHeroParams=function(){this.attackPower=d.default.getInstance().getParam(u.enumBasicParaCfg.basicATK),this.hp=d.default.getInstance().getParam(u.enumBasicParaCfg.baseHP),this.attackSpeed=d.default.getInstance().getParam(u.enumBasicParaCfg.basicASPD),this.criticalChance=d.default.getInstance().getParam(u.enumBasicParaCfg.basicCrit),this.criticalMultiple=d.default.getInstance().getParam(u.enumBasicParaCfg.critDamage),this.speedPlusTimes=d.default.getInstance().getParam(u.enumBasicParaCfg.speedPlusTimes),this.bulletSpeed=d.default.getInstance().getParam(u.enumBasicParaCfg.bulletFlySpeed),this.bulletCount=d.default.getInstance().getParam(u.enumBasicParaCfg.basicBullet)},e.prototype.initHeroLottery=function(){this.heroLottery=[];for(var t=d.default.getInstance().getCharacterCfg(),e=0;e<t.length;e++){var o=t[e].characterID;this.heroLottery.push(o)}},e.prototype.initProperty=function(){this.pro_roleItem=p.default.findChildByName(this.node,"roleItem"),this.pro_roleHpProgress=p.default.findChildByName(this.node,"roleHpProgress").getComponent(cc.Sprite)},e.prototype.onLoad=function(){this.initProperty(),this.initHeroLottery()},e.prototype.start=function(){this.initHeroParams()},e.prototype.onUpdate=function(t){for(var e in this.heroList)this.heroList[e].onUpdate(t)},c([g],e)}(l.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],Hold_RoleItem:[function(t,e,o){"use strict";cc._RF.push(e,"3c4c0Gp7P1NWJSbOuBsnYHC","Hold_RoleItem");var i=t,n=e,a=o;cc._RF.push(n,"3c4c0Gp7P1NWJSbOuBsnYHC","Hold_RoleItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("Hold_Configs"),h=i("Hold_GameCtrl"),f=i("Hold_bulletItem"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroAniArr=[],e.pro_bulletPos=null,e.bulletArr=[],e.flyingBullet=[],e.bulletMaxDistance=2e3,e.parentCtrl=null,e.bulletPoolName="Hold_bulletItem",e.characterID=0,e.maxBulletLenth=20,e.lineClass=null,e.nowAttackTime=0,e.lastAttackTime=0,e.bullteAudioID=0,e.maxBulletAudioID=3,e}return s(e,t),e.prototype.initHero=function(t,e){this.parentCtrl=t,this.bulletPoolName=d.poolName.bullet+e,this.characterID=e,this.node.getComponent(sp.Skeleton).skeletonData=this.getSkeletonByindex(e);var o="djdh_"+e;this.node.getComponent(sp.Skeleton).setAnimation(0,o,!0),11==e&&(this.node.scale=.85)},e.prototype.recycleBullet=function(t,e){void 0===e&&(e=!1);for(var o=0;o<this.flyingBullet.length;o++)if(this.flyingBullet[o].uuid==t.uuid){var i=t.node.convertToWorldSpaceAR(new cc.Vec2(0,0));e||(this.sendEvent(d.emHOLDEventName.hold_attackEffect,i,d.HoldEffectType.hit),p.AudioMgr.getInstance().playEffect(d.HOLD_AudioId.dragonHit,d.Hold_AudioIDType.bullet)),t.node.y=-1e4,this.flyingBullet.splice(o,1),this.bulletArr.length<this.maxBulletLenth?this.bulletArr.push(t):u.PoolMgr.getInstance().freeNode(this.bulletPoolName,t.node);break}},e.prototype.pushBullet=function(t){this.flyingBullet.push(t)},e.prototype.getFlyingBullets=function(){return this.flyingBullet},e.prototype.getCanColliderWithDoorBullets=function(){return this.flyingBullet.filter(function(t){return t.getCanColliderWithDoor()})},e.prototype.getSkeletonByindex=function(t){var e="djdh_"+t;for(var o in this.heroAniArr)if(this.heroAniArr[o].name==e)return this.heroAniArr[o]},e.prototype.getBullet=function(){var t=this.bulletArr.pop();if(!t){var e=u.PoolMgr.getInstance().getNode(this.bulletPoolName);e.parent=h.default.instance.getBulletLayerByIndex(this.characterID),t=e.getComponent(f.default)}return t},e.prototype.contrlBullet=function(t){for(var e=0;e<this.flyingBullet.length;e++){var o=this.flyingBullet[e];o&&o.onUpdate(t*this.parentCtrl.getBulletSpeed()*100)}},e.prototype.updateFire=function(t){this.nowAttackTime+=t,this.nowAttackTime-this.lastAttackTime>this.parentCtrl.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime)},e.prototype.fireBullets=function(){this.bullteAudioID++,this.bullteAudioID%=this.maxBulletAudioID,p.AudioMgr.getInstance().playEffect(d.HOLD_AudioId.bullet,d.Hold_AudioIDType.role+this.bullteAudioID);for(var t=this.parentCtrl.getBulletCount(),e=t%2?30*-Math.floor(t/2):30*-Math.floor(t/2)+20,o=this.node.y+150,i=0;i<t;i++){var n=this.getBullet(),a=cc.v2(e+30*i,o),r=this.node.convertToWorldSpaceAR(a);a=n.node.parent.convertToNodeSpaceAR(r),n.node.setPosition(a),n.initBullet(this,this.bulletPoolName,this.bulletMaxDistance,30),this.flyingBullet.push(n)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.updateFire(t),this.contrlBullet(t)},c([y(sp.SkeletonData)],e.prototype,"heroAniArr",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],Hold_buffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"775f2QFui9P8L/jJGLDgGE8","Hold_buffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"775f2QFui9P8L/jJGLDgGE8","Hold_buffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("linePos"),u=i("Hold_buffItem"),d=i("Hold_DataMgr"),h=i("hold_GameEnumData"),f=i("Hold_Configs"),m=i("Hold_bulletItem"),g=i("Hold_GameCtrl"),y=function(t,e,o,i,n,a,r,s){void 0===s&&(s=1.4),this.perspectiveFactorMulty=1.4,this.treasureCfg=t,this.baseScale=e,this.distance=o,this.layerNode=i,this.worldPosArr=n,this.speed=a,this.infoName=r},v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.leftBuff=null,e.rightBuff=null,e.leftBuffArr=[],e.rightBuffArr=[],e.leftBuffWorldArr=[],e.rightBuffWorldArr=[],e.leftBaseScale=1.4,e.rightBaseScale=1.4,e.maxShowNum=7,e.layerInfoMap=new Map,e}return s(e,t),e.prototype.getBuffItems=function(){var t=[],e=this.leftBuffArr.length;e>0&&this.leftBuffArr[e-1].active&&t.push(this.leftBuffArr[e-1].getComponent(u.default));var o=this.rightBuffArr.length;return o>0&&this.rightBuffArr[o-1].active&&t.push(this.rightBuffArr[o-1].getComponent(u.default)),t},e.prototype.onBuffDestroyed=function(t){var e,o=t.parent.children;e=t.x>0?this.rightBuffWorldArr:this.leftBuffWorldArr;for(var i=o.length-2;i>=0;i--){var n=o[i],a=e[o.length-i-2];n.getComponent(u.default).setWorldPos(a)}var r=o.length-1-this.maxShowNum;r>0&&o[r]&&(o[r].active=!0),t.removeFromParent()},e.prototype.initProperty=function(){this.leftBuff=this.node.getChildByName("leftBuff"),this.rightBuff=this.node.getChildByName("rightBuff"),this.leftBuffArr=this.leftBuff.getChildByName("itemLayer").children,this.rightBuffArr=this.rightBuff.getChildByName("itemLayer").children,this.initListen()},e.prototype.initListen=function(){var t=this.leftBuff.getChildByName("collider"),e=this.rightBuff.getChildByName("collider"),o=t.getChildByName("doorHit"),i=e.getChildByName("doorHit");o.getComponent(sp.Skeleton).setCompleteListener(function(t){"effect"==t.animation.name&&(o.active=!1)}),i.getComponent(sp.Skeleton).setCompleteListener(function(t){"effect"==t.animation.name&&(i.active=!1)})},e.prototype.initView=function(){var t=this;this.layerInfoMap.set(f.HoldTreasureType.leftTreasure,new y(d.default.getInstance().getLeftBuffCfg(),this.leftBaseScale,300,this.leftBuff.getChildByName("itemLayer"),this.leftBuffWorldArr,d.default.getInstance().getParam(h.enumBasicParaCfg.speedleftDrop),f.HoldTreasureType.leftTreasure)),this.layerInfoMap.set(f.HoldTreasureType.rightTreasure,new y(d.default.getInstance().getRightBuffCfg(),this.rightBaseScale,200,this.rightBuff.getChildByName("itemLayer"),this.rightBuffWorldArr,d.default.getInstance().getParam(h.enumBasicParaCfg.speedrightDrop),f.HoldTreasureType.rightTreasure)),this.layerInfoMap.forEach(function(e){t.doInitViewDown(e)})},e.prototype.doInitViewDown=function(t){for(var e=t.treasureCfg,o=t.baseScale,i=t.distance,n=t.layerNode,a=t.worldPosArr,r=t.speed,s=t.perspectiveFactorMulty,c=t.infoName,l=e.length,d=n.children[0],h=d.getPosition(),f=0;f<l;f++){var m=cc.instantiate(d),g=h.x,y=h.y+i*f,v=new cc.Vec3(g,y,0),_=((v=n.convertToWorldSpaceAR(v)).y-770)*s,b=p.PerspectiveLine.getInstance().getScreenPosition(v.x,v.y,_,o),B=b.x,I=b.y,P=b.scale,C=n.convertToNodeSpaceAR(cc.v2(B,I));m.setPosition(C.x,C.y),m.setScale(P),a.push(cc.v3(v.x,v.y,_)),n.addChild(m),m.getComponent(u.default).initParams(this,r,o,c,e[f]),f<this.maxShowNum?m.active=!0:m.active=!1,m.zIndex=l-f+20}d.removeFromParent()},e.prototype.checkBulletCollisionsWithBuffColliders=function(){var t=this,e=this.leftBuff.getChildByName("collider"),o=this.rightBuff.getChildByName("collider");g.default.instance.getRoleCtrl().getCanColliderWithDoorBullets().forEach(function(i){if(t.isCollidingWithCollider(i,e))i.getComponent(m.default).instantiateBullet(3),(n=e.getChildByName("doorHit")).active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"effect",!1);else if(t.isCollidingWithCollider(i,o)){var n;i.getComponent(m.default).instantiateBullet(2),(n=o.getChildByName("doorHit")).active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"effect",!1)}})},e.prototype.isCollidingWithCollider=function(t,e){var o=t.node.convertToWorldSpaceAR(cc.v2(0,0)),i=e.convertToWorldSpaceAR(cc.v2(0,0)),n=o.sub(i).mag(),a=e.width/2;return n<t.radius+a},e.prototype.onUpdate=function(){this.checkBulletCollisionsWithBuffColliders()},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.initView()},c([_],e)}(l.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],Hold_buffItem:[function(t,e,o){"use strict";cc._RF.push(e,"14510q4TUFHhIFSHq+PGMHF","Hold_buffItem");var i=t,n=e,a=o;cc._RF.push(n,"14510q4TUFHhIFSHq+PGMHF","Hold_buffItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("stringLib"),u=i("Hold_Configs"),d=i("Hold_DataMgr"),h=i("linePos"),f=i("Hold_GameCtrl"),m=i("AudioMgr"),g=function(t){this.weaponParam=t},y=function(t,e){this.buffType=t,this.infoNum=e},v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgAtlas=null,e.hpNumLabel=null,e.treasureOpen=null,e.hpNum=0,e.radius=60,e.moveSpeed=.1,e.baseScale=1.4,e.buffType="",e.leftItemCfg=null,e.rightItemCfg=null,e.leftItemInfo=null,e.rightItemInfo=null,e.isRemove=!1,e}return s(e,t),e.prototype.initParams=function(t,e,o,i,n){this.parentCtrl=t,this.moveSpeed=e,this.baseScale=o,this.buffType=i,this.isRemove=!1,this.initItemCfg(n),this.initView(),this.updateHpLabel()},e.prototype.setWorldPos=function(t){var e=h.PerspectiveLine.getInstance().getScreenPosition(t.x,t.y,t.z,this.baseScale),o=this.node.parent.convertToNodeSpaceAR(cc.v2(e.x,e.y)),i=new cc.Vec3(o.x,o.y,0);this.moveToTarget(i,e.scale)},e.prototype.takeDamage=function(){this.isRemove||(this.reduceHp(),this.hpNum<=0&&(this.treasureOpen.active=!0,this.buffType===u.HoldTreasureType.rightTreasure?this.treasureOpen.getComponent(sp.Skeleton).setAnimation(0,"open",!1):this.buffType===u.HoldTreasureType.leftTreasure&&this.treasureOpen.getComponent(sp.Skeleton).setAnimation(0,"open2",!1),m.AudioMgr.getInstance().playEffect(u.HOLD_AudioId.treasure),this.hideView()))},e.prototype.reduceHp=function(){this.hpNum--,this.hpNum<0&&(this.hpNum=0),this.updateHpLabel()},e.prototype.hideView=function(){for(var t in this.isRemove=!0,this.node.children)"treasureOpen"!=this.node.children[t].name&&(this.node.children[t].active=!1)},e.prototype.doDestroyDown=function(){if(this.buffType===u.HoldTreasureType.rightTreasure){var t=f.default.instance.getRightBuffCtrl();t&&t.handleRightBuffDestroyed(this.rightItemInfo.buffType,this.rightItemInfo.infoNum)}else this.buffType===u.HoldTreasureType.leftTreasure&&f.default.instance.getWeaponCtrl().addWeapon(this.leftItemInfo.weaponParam);this.parentCtrl.onBuffDestroyed(this.node)},e.prototype.moveToTarget=function(t,e){cc.tween(this.node).to(this.moveSpeed,{position:t,scale:e}).start()},e.prototype.initItemCfg=function(t){switch(this.buffType){case u.HoldTreasureType.leftTreasure:this.leftItemCfg=t;break;case u.HoldTreasureType.rightTreasure:this.rightItemCfg=t}},e.prototype.initRightItem=function(){this.hpNum=this.rightItemCfg.rightHp;var t=this.rightItemCfg.buffType.split("|"),e=t[Math.floor(Math.random()*t.length)].split(",");this.rightItemInfo=new y(e[0],Number(e[1]));var o=d.default.getInstance().getBuffTypeCfgByName(this.rightItemInfo.buffType),i=o.icon;this.node.getChildByName("buffIcon").getComponent(cc.Sprite).spriteFrame=this.getSpriteFrame(i),this.node.getChildByName("property").getComponent(cc.Label).string=p.default.getStringText2(o.buffWord,this.rightItemInfo.infoNum)},e.prototype.getSpriteFrame=function(t){return this.imgAtlas.getSpriteFrame(t)},e.prototype.initLeftItem=function(){this.hpNum=this.leftItemCfg.leftHp;var t=this.leftItemCfg.weaponID.split(","),e=Number(t[Math.floor(Math.random()*t.length)]),o=d.default.getInstance().getWeaponCfgByID(e),i={weaponType:e,weaponPara0:this.leftItemCfg.weaponATK,weaponPara1:o.weaponPara1||0,weaponPara2:o.weaponPara2,weaponPara3:o.weaponPara3||0},n=o.weaponIcon;this.leftItemInfo=new g(i),this.node.getChildByName("buffIcon").getComponent(cc.Sprite).spriteFrame=this.getSpriteFrame(n),this.node.getChildByName("property").getComponent(cc.Label).string=o.weaponName},e.prototype.updateHpLabel=function(){this.hpNumLabel&&(this.hpNumLabel.string=this.hpNum.toString())},e.prototype.initView=function(){switch(this.buffType){case u.HoldTreasureType.leftTreasure:this.initLeftItem();break;case u.HoldTreasureType.rightTreasure:this.initRightItem()}},e.prototype.onLoad=function(){var t=this;this.hpNumLabel=this.node.getChildByName("hpNumLabel").getComponent(cc.Label),this.treasureOpen=this.node.getChildByName("treasureOpen"),this.treasureOpen.getComponent(sp.Skeleton).setCompleteListener(function(e){"open"!=e.animation.name&&"open2"!=e.animation.name||(t.treasureOpen.active=!1,t.doDestroyDown())})},e.prototype.onUpdate=function(){this.hpNum<=0&&this.node.removeFromParent()},c([b(cc.SpriteAtlas)],e.prototype,"imgAtlas",void 0),c([_],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],Hold_bulletItem:[function(t,e,o){"use strict";cc._RF.push(e,"5e0afpU7vhLX5SI+5Og+dY9","Hold_bulletItem");var i=t,n=e,a=o;cc._RF.push(n,"5e0afpU7vhLX5SI+5Og+dY9","Hold_bulletItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("linePos"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.radius=10,e.parentCtrl=null,e.poolName="Hold_bulletItem",e.maxDistance=1e3,e.gapWidth=10,e.worldPos=null,e.isDestroy=!1,e.offsetX=0,e.offsetY=0,e.initialLocalPos=null,e.canCopy=!0,e}var o;return s(e,t),o=e,e.prototype.initBullet=function(t,e,o,i,n){void 0===n&&(n=!0),this.parentCtrl=t,this.poolName=e,this.maxDistance=o,this.gapWidth=i,this.offsetX=0,this.offsetY=0,this.node.angle=0,this.node.scale=1,this.isDestroy=!1,this.node.active=!0,this.canCopy=n,this.initialLocalPos=this.node.position.clone(),this.worldPos=this.node.parent.convertToWorldSpaceAR(this.node.position)},e.prototype.initIstanteBullet=function(t,e,o,i,n,a,r,s,c,l,p,u){this.parentCtrl=t,this.poolName=e,this.maxDistance=o,this.gapWidth=i,this.offsetX=n,this.offsetY=a,this.node.angle=r,this.node.scale=s,this.isDestroy=c,this.canCopy=l,this.initialLocalPos=p,this.worldPos=u},e.prototype.instantiateBullet=function(t){if(this.canCopy){this.canCopy=!1;for(var e=1;e<t;e++){var i=l.PoolMgr.getInstance().getNode(this.poolName);i.parent=this.node.parent;var n=this.worldPos.clone();n.x=n.x+this.gapWidth*e;var a=this.initialLocalPos.clone();a.x+=this.gapWidth*e,i.getComponent(o).initIstanteBullet(this.parentCtrl,this.poolName,this.maxDistance,this.gapWidth,this.offsetX,this.offsetY,this.node.angle,this.node.scale,!1,!1,a,n),this.parentCtrl.pushBullet(i.getComponent(o))}}},e.prototype.recycle=function(t){var e=this;void 0===t&&(t=!1),this.isDestroy||(this.isDestroy=!0,this.scheduleOnce(function(){e.parentCtrl.recycleBullet(e,t)}))},e.prototype.getIsDestroy=function(){return this.isDestroy},e.prototype.getCanColliderWithDoor=function(){return this.canCopy},e.prototype.perspective=function(t){this.worldPos.y+=t,this.worldPos.z+=t;var e=p.PerspectiveLine.getInstance().getScreenPosition(this.worldPos.x,this.worldPos.y,this.worldPos.z,1),o=this.node.parent.convertToNodeSpaceAR(cc.v2(e.x,e.y));this.offsetX=o.x-this.initialLocalPos.x,this.offsetY=o.y-this.initialLocalPos.y,this.node.setPosition(o.x,o.y),this.node.setScale(e.scale);var i=Math.atan2(this.offsetY,this.offsetX)*(180/Math.PI);this.node.angle=i-90},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.isDestroy||(this.perspective(t),this.maxDistance-=Math.abs(t),this.maxDistance<=0&&this.recycle(!0))},c([h],e.prototype,"radius",void 0),o=c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],Hold_extraBuffItem:[function(t,e,o){"use strict";cc._RF.push(e,"fc7e3pbEGxLD4huByT0WxNW","Hold_extraBuffItem");var i=t,n=e,a=o;cc._RF.push(n,"fc7e3pbEGxLD4huByT0WxNW","Hold_extraBuffItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("stringLib"),p=i("Hold_DataMgr"),u=i("Hold_GameCtrl"),d=function(t,e){this.buffType=t,this.buffValue=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.leftBuffProperty=null,e.rightBuffProperty=null,e.leftInfo=null,e.rightInfo=null,e.moveSpeed=200,e}return s(e,t),e.prototype.initBuffInfo=function(t){var e=this.getRandomArr(t.split("|"),2),o=e[0],i=e[1];this.leftInfo=new d(o.split(",")[0],Number(o.split(",")[1])),this.rightInfo=new d(i.split(",")[0],Number(i.split(",")[1])),this.initBuffView()},e.prototype.getRandomArr=function(t,e){for(var o=[],i=0;i<e;i++){var n=Math.floor(Math.random()*t.length);o.push(t[n]),t.splice(n,1)}return o},e.prototype.initBuffView=function(){var t=p.default.getInstance().getBuffTypeCfgByName(this.leftInfo.buffType);this.leftBuffProperty.string=l.default.getStringText2(t.buffWord,this.leftInfo.buffValue),t=p.default.getInstance().getBuffTypeCfgByName(this.rightInfo.buffType),this.rightBuffProperty.string=l.default.getStringText2(t.buffWord,this.rightInfo.buffValue)},e.prototype.doDestroyDown=function(){u.default.instance.getRoleCtrl().getRolePosition().x<0?u.default.instance.getRoleCtrl().modifyProperty(this.leftInfo.buffType,this.leftInfo.buffValue):u.default.instance.getRoleCtrl().modifyProperty(this.rightInfo.buffType,this.rightInfo.buffValue),this.node.destroy()},e.prototype.start=function(){},c([m(cc.Label)],e.prototype,"leftBuffProperty",void 0),c([m(cc.Label)],e.prototype,"rightBuffProperty",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],Hold_rightBuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c1ba3aPFC9GRL8usUtLdUcP","Hold_rightBuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c1ba3aPFC9GRL8usUtLdUcP","Hold_rightBuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Hold_RoleCtrl"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleCtrl=null,e}return s(e,t),e.prototype.onLoad=function(){this.roleCtrl=this.node.getComponent(l.default)},e.prototype.handleRightBuffDestroyed=function(t,e){this.roleCtrl.modifyProperty(t,e)},c([u],e)}(cc.Component));a.default=d,cc._RF.pop(),cc._RF.pop()},{}],Hold_weaponCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"9cf10DD/0tDIKNb1wFdNdvE","Hold_weaponCtrl");var i=t,n=e,a=o;cc._RF.push(n,"9cf10DD/0tDIKNb1wFdNdvE","Hold_weaponCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("Hold_Configs"),d=i("WeaponBase"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.weaponPos=cc.v2(0,0),e.weaponList=[],e}return s(e,t),e.prototype.addWeapon=function(t){var e=t.weaponType,o=p.PoolMgr.getInstance().getNode(u.poolName.weapon+e).getComponent(d.WeaponBase);this.weaponList.push(o);var i=o.node;this.node.addChild(i),i.setPosition(this.weaponPos),o.init(t)},e.prototype.resycleWeapon=function(t){this.weaponList=this.weaponList.filter(function(e){return e!=t})},e.prototype.onLoad=function(){this.weaponPos=this.node.getChildByName("weaponPos").getPosition()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.weaponList.forEach(function(e){e.onUpdate(t)})},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],HomeBattleCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"ebd88bJVR9NbI7J0xrAXetK","HomeBattleCtrl");var i=t,n=e,a=o;cc._RF.push(n,"ebd88bJVR9NbI7J0xrAXetK","HomeBattleCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BALL_App"),p=i("BTY_App"),u=i("DB_App"),d=i("DRA_App"),h=i("GAD_App"),f=i("PBT_App"),m=i("RUN_App"),g=i("STO_App"),y=i("subgameTime"),v=i("common_Configs"),_=i("Common_PlayerMgr"),b=i("BaseCtrl"),B=i("BasePlatform"),I=i("Appcfg"),P=i("PlatformSetting"),C=i("AudioMgr"),D=i("PlatformManager"),T=i("ResourceMgr"),S=i("SdkMgr"),A=i("TweenMgr"),k=i("UIMgr"),w=i("Utils"),N=i("Main"),R=i("Config"),M=i("TextConfig"),O=i("BraveTowerEnum"),E=i("ItemGood"),L=i("GameTrackDataEvent"),x=i("GameEnumData"),F=i("DataMgr"),G=i("PlayerMgr"),U=i("UISubEnter"),j=cc._decorator,H=j.ccclass,W=j.property,V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnSetting=null,e.btnSign=null,e.btnTask=null,e.btnOnline=null,e.btnSideBoard=null,e.btnAddDesktop=null,e.btnExchangeCode=null,e.ndLevelInfo=null,e.ndLevelShow=null,e.btnLeft=null,e.btnRight=null,e.ndBoxShow=null,e.btnBattle=null,e.btnSweep=null,e.subGameList=null,e.newBtnSubEnter=null,e.isEnter=!1,e.subMap=new Map,e}return s(e,t),e.prototype.start=function(){this.initEventListener(),this.initBtnListener(),this.cfgList=F.DataMgr.getInstance().getLevelCfgList(),this.selectStage=Math.min(this.cfgList.length,G.PlayerMgr.getInstance().getUserData().getMaxStage()),this.lockSubPlay1=parseInt(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params21)),this.lockSubPlay2=parseInt(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params23)),this.initView(),this.initBtnView(),this.initSubView(),P.PlatformSetting.currentPlatform==B.Platform.EDITOR&&(this.node.getChildByName("ndBg").children[0].active=!1)},e.prototype.onEnable=function(){var t=this;this.onUpdateTask(),null!=this.selectStage&&(this.selectStage=Math.min(this.cfgList.length,G.PlayerMgr.getInstance().getUserData().getMaxStage()),this.initView(),this.initBtnView()),this.showBtnRed(),this.onTimeUpdate(),this.schedule(function(){G.PlayerMgr.getInstance().getGuideData().getGuideEnd(2)?t.sendEvent(I.BaseEventName.RefreshReport,!1):t.sendEvent(I.BaseEventName.RefreshReport,!0,t.btn_Report.convertToWorldSpaceAR(cc.Vec2.ZERO))},.1)},e.prototype.initEventListener=function(){this.addEvent(O.BraveTowerEventName.UpdateFuncRedPoint,this.showBtnRed),this.addEvent(O.BraveTowerEventName.TimeUpdate,this.onTimeUpdate),this.addEvent(O.BraveTowerEventName.TimeUpdate,this.refreshSubView)},e.prototype.initBtnListener=function(){var t=this;this.btnSetting.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UISetting,R.UIID.UINONE)},this),this.btnSign.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UISign,R.UIID.UINONE)},this),this.btnTask.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UITaskAndAchieve,R.UIID.UINONE)},this),this.btnOnline.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UIOnlineReward,R.UIID.UINONE)},this),this.btnLeft.on(cc.Node.EventType.TOUCH_END,function(){t.aniChangeLevel(-1)},this),this.btnRight.on(cc.Node.EventType.TOUCH_END,function(){t.aniChangeLevel(1)},this),this.btnBattle.on(cc.Node.EventType.TOUCH_END,function(){N.default.instance.startGame(O.BraveTowerGameMode.Normal,t.selectStage),G.PlayerMgr.getInstance().getTrackData().youmengTrack(L.TrackId.levels_lv_X,t.selectStage)}),this.btnSweep.on(cc.Node.EventType.TOUCH_END,function(){if(G.PlayerMgr.getInstance().getDailyData().getSweepNum()>=parseInt(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params19)))k.UIMgr.getInstance().openUI(R.UIID.UITips,R.UIID.UINONE,t.T(M.TextConfig.Tips18));else{for(var e=G.PlayerMgr.getInstance().getUserData().getMaxStage(),o=t.cfgList[e-2].sweepReward,i=[],n=0;n<o.length;n++){var a=o[n];i.push({id:a[0],num:a[1]})}var r=G.PlayerMgr.getInstance().onRewardToStr(i);G.PlayerMgr.getInstance().addRewardPop(r),C.AudioMgr.getInstance().playEffect(R.AudioId.treasure),G.PlayerMgr.getInstance().getDailyData().addSweepNum(),t.onTimeUpdate()}},this);var e=P.PlatformSetting.currentPlatform==B.Platform.BYTEDANCE||P.PlatformSetting.currentPlatform==B.Platform.KuaiShou;this.btnSideBoard.active=e,this.btnAddDesktop.active=e,this.btnSideBoard.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UISideBoard,R.UIID.UINONE)},this),this.btnAddDesktop.on(cc.Node.EventType.TOUCH_END,function(){t.onClickShortCut()}),this.btnExchangeCode.active=P.PlatformSetting.currentPlatform==B.Platform.BYTEDANCE||P.PlatformSetting.currentPlatform==B.Platform.WEB_LINK||P.PlatformSetting.currentPlatform==B.Platform.EDITOR,this.btnExchangeCode.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UIExchangeCode,R.UIID.UINONE)},this),this.btn_Report.active=!S.SdkMgr.getInstance().getCheckVersion(P.SwitchID.ShenHe)&&(D.PlatformManager.currentPlatform==B.Platform.WECHAT||D.PlatformManager.currentPlatform==B.Platform.BYTEDANCE||D.PlatformManager.currentPlatform==B.Platform.EDITOR||D.PlatformManager.currentPlatform==B.Platform.KuaiShou),this.btn_Report.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UIReport,R.UIID.UIHome)});for(var o=function(e){var o=i.ndBoxShow.getChildByName("ndTag"+(e+1));o.on(cc.Node.EventType.TOUCH_END,function(){var i=G.PlayerMgr.getInstance().getUserData().getMaxStage(),n=G.PlayerMgr.getInstance().getUserData().getMaxOrder(),a=G.PlayerMgr.getInstance().getUserData().getStageReward(t.selectStage,e+1),r=t.cfgList[t.selectStage-1].waveBox;r||(r=[5,10,15]);var s=r[e];if(a)k.UIMgr.getInstance().openUI(R.UIID.UITips,R.UIID.UINONE,M.TextConfig.Tips01);else if(i>t.selectStage||n>=s){G.PlayerMgr.getInstance().getUserData().getStageRewardInfo(t.selectStage,e+1);for(var c=t.cfgList[t.selectStage-1].wave[e],l=[],p=0;p<c.length;p++){var u=c[p];l.push({id:u[0],num:u[1]})}var d=G.PlayerMgr.getInstance().onRewardToStr(l);G.PlayerMgr.getInstance().addRewardPop(d),t.initView(),C.AudioMgr.getInstance().playEffect(R.AudioId.treasure),t.sendEvent(O.BraveTowerEventName.UpdateRedPoint,4)}else t.showReward(o,e)})},i=this,n=0;n<3;n++)o(n)},e.prototype.showReward=function(t,e){var o=this.ndBoxShow.getChildByName("ndTips");if(cc.Tween.stopAllByTarget(o),o.active&&o.tagUUID==t.uuid)o.active=!1;else{o.active=!0,o.x=t.x,o.attr({tagUUID:t.uuid}),cc.tween(o).set({scale:0}).to(.2,{scale:1},{easing:"quintOut"}).start();for(var i=this.cfgList[this.selectStage-1].wave[e],n=o.getChildByName("ndLayout"),a=Math.max(i.length,n.childrenCount),r=function(t){if(i[t]){var e=function(e){e.node.active=!0,e.initView(i[t][0],i[t][1])},o=n.children[t];o?e(o.getComponent(E.default)):T.ResourceMgr.getInstance().getNode(O.BraveTowerPoolName.ItemGood,O.BraveTowerBundelName.Icon,O.BraveTowerPrefabName.ItemGood,function(t){t.setParent(n),t.y=5,t.scale=.7;var o=t.getComponent(E.default);e(o)},5)}else n.children[t]&&(n.children[t].active=!1)},s=0;s<a;s++)r(s);n.getComponent(cc.Layout).updateLayout();var c=o.convertToWorldSpaceAR(cc.v2(-n.width/2,0));if(c.x<50)n.x=50-c.x;else{var l=o.convertToWorldSpaceAR(cc.v2(n.width/2,0));l.x>cc.winSize.width-50?n.x=cc.winSize.width-50-l.x:n.x=0}}},e.prototype.onClickShortCut=function(){D.PlatformManager.getInstance().addShortcut(null,function(t){if("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u6210\u529f"==t&&(k.UIMgr.getInstance().openUI(R.UIID.UITips,R.UIID.UINONE,"\u6dfb\u52a0\u684c\u9762\u6210\u529f"),G.PlayerMgr.getInstance().getTrackData().youmengTrack(L.TrackId.add_desktop),0==G.PlayerMgr.getInstance().getTrackData().getTimeByKey(O.TimeByKey.AddDeck))){G.PlayerMgr.getInstance().getTrackData().setTimeByKey(O.TimeByKey.AddDeck,1);var e=parseInt(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params12));G.PlayerMgr.getInstance().getUserData().addDiamondNum(e)}})},e.prototype.initView=function(){var t=this,e=this.cfgList[this.selectStage-1],o=G.PlayerMgr.getInstance().getUserData().getMaxStage();this.ndLevelInfo.getChildByName("labName").getComponent(cc.Label).string=this.T(e.name),this.ndLevelInfo.getChildByName("labOrder").getComponent(cc.Label).string=w.Utils.StringFormat(this.T(M.TextConfig.Text02),e.id<o?e.wareList.length:G.PlayerMgr.getInstance().getUserData().getMaxOrder()),(S.SdkMgr.getInstance().getCheckVersion(P.SwitchID.ShenHe_ABD)||P.PlatformSetting.currentPlatform==B.Platform.WEB_LINK||P.PlatformSetting.currentPlatform==B.Platform.EDITOR)&&this.ndLevelInfo.getChildByName("labOrder").on(cc.Node.EventType.TOUCH_END,function(){G.PlayerMgr.getInstance().getUserData().passStage(o),t.initView()}),this.loadSpriteFrame(O.BraveTowerBundelName.Map,e.img,function(e){t.ndLevelShow.getChildByName("sprBg").getComponent(cc.Sprite).spriteFrame=e}),this.loadSpriteFrame(O.BraveTowerBundelName.Enemy,"icon/"+e.model,function(e){t.ndLevelShow.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=e}),this.ndBoxShow.getChildByName("ndTips").active=!1,this.ndBoxShow.getChildByName("ndTips").attr({tagUUID:null});var i=G.PlayerMgr.getInstance().getUserData().getMaxOrder(),n=e.waveBox;n||(n=[5,10,15]);for(var a=0;a<n.length;a++){var r=n[a];(s=this.ndBoxShow.getChildByName("ndTag"+(a+1))).children.forEach(function(t){t.active=!1}),s.getChildByName("labNum").active=!0,s.getChildByName("labNum").getComponent(cc.Label).string=w.Utils.StringFormat(this.T(M.TextConfig.Game02),r),G.PlayerMgr.getInstance().getUserData().getStageReward(this.selectStage,a+1)?s.getChildByName("ndOpen").active=!0:(s.getChildByName("ndClose").active=!0,o>this.selectStage||i>=r?(s.getChildByName("ndRed").active=!0,A.TweenMgr.getInstance().playHeartAni(s.getChildByName("ndClose"))):(s.getChildByName("ndClose").scale=1,A.TweenMgr.getInstance().stopTween(s.getChildByName("ndClose"))))}for(a=1;a<=10;a++){var s=this.ndBoxShow.getChildByName("ndNode"+a);o>this.selectStage?s.children[0].active=!0:s.children[0].active=10*(i-n[0])/(n[n.length-1]-n[0])>=a}},e.prototype.initBtnView=function(){var t=G.PlayerMgr.getInstance().getUserData().getMaxStage();this.btnLeft.active=this.selectStage>1,this.btnRight.active=this.selectStage<this.cfgList.length&&(this.selectStage<t||P.PlatformSetting.currentPlatform==B.Platform.WEB_LINK||S.SdkMgr.getInstance().getCheckVersion(P.SwitchID.ShenHe_ABD));for(var e=G.PlayerMgr.getInstance().getUserData().getMaxOrder(),o=!1,i=!1,n=this.selectStage-1;n>0;n--){(s=(r=this.cfgList[n-1]).waveBox)||(s=[5,10,15]);for(var a=0;a<s.length;a++)if(!G.PlayerMgr.getInstance().getUserData().getStageReward(r.id,a+1)){o=!0;break}if(o)break}for(n=this.selectStage+1;n<=t;n++){var r,s;if(!(r=this.cfgList[n-1]))break;for((s=r.waveBox)||(s=[5,10,15]),a=0;a<s.length;a++)if(!G.PlayerMgr.getInstance().getUserData().getStageReward(r.id,a+1)&&(r.id<t||e>=s[a])){i=!0;break}if(i)break}this.btnLeft.getChildByName("ndRed").active=o,this.btnRight.getChildByName("ndRed").active=i,this.btnSweep.active=t>1},e.prototype.aniChangeLevel=function(t){this.selectStage+=t,this.initView(),this.initBtnView()},e.prototype.onUpdateTask=function(){},e.prototype.showBtnRed=function(){var t=G.PlayerMgr.getInstance().getDailyData().getSignReward();this.btnSign.getChildByName("ndRed").active=0==t;var e=!1;if(!e)for(var o=G.PlayerMgr.getInstance().getTaskData().getTaskList(),i=0;i<o.length;i++)if(!(c=o[i]).isGet&&c.num>=c.max){e=!0;break}if(!e){var n=G.PlayerMgr.getInstance().getTaskData().getAchieveList();for(i=0;i<n.length;i++)if(!(c=n[i]).isGet&&c.num>=c.max){e=!0;break}}if(!e){var a=F.DataMgr.getInstance().getAchieveTreasureChestList(),r=G.PlayerMgr.getInstance().getTaskData().getAchieveGetList(),s=G.PlayerMgr.getInstance().getTaskData().getAchievePoint();for(i=0;i<a.length;i++){var c=a[i];if(1!=r[i]&&s>=c.NeedAchieveNum){e=!0;break}}}this.btnTask.getChildByName("ndRed").active=e},e.prototype.showRed=function(){for(var t=G.PlayerMgr.getInstance().getUserData().getMaxStage(),e=G.PlayerMgr.getInstance().getUserData().getMaxOrder(),o=F.DataMgr.getInstance().getLevelCfgList(),i=1;i<=t;i++){var n=o[i-1];if(!n)break;var a=n.waveBox;a||(a=[5,10,15]);for(var r=0;r<a.length;r++)if(!G.PlayerMgr.getInstance().getUserData().getStageReward(n.id,r+1)&&(n.id<t||e>=a[r]))return!0}return!1},e.prototype.onTimeUpdate=function(){for(var t=G.PlayerMgr.getInstance().getDailyData().getOnlineTime(),e=F.DataMgr.getInstance().getRewardList(),o=!1,i=0;i<e.length;i++)if(t>=60*e[i].condition&&!G.PlayerMgr.getInstance().getDailyData().getOnlineTimeReward(i)){o=!0;break}this.btnOnline.getChildByName("ndRed").active=o;var n=Date.now(),a=G.PlayerMgr.getInstance().getDailyData().getSweepTime(),r=G.PlayerMgr.getInstance().getDailyData().getSweepNum(),s=parseInt(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params20)),c=Math.floor((n-a)/1e3/60/s);c>0&&(G.PlayerMgr.getInstance().getDailyData().setSweepTime(n),c>r?G.PlayerMgr.getInstance().getDailyData().setSweepNum(0):G.PlayerMgr.getInstance().getDailyData().setSweepNum(r-c),r=G.PlayerMgr.getInstance().getDailyData().getSweepNum());var l=parseInt(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params19));this.btnSweep.getChildByName("labName").getComponent(cc.Label).string=w.Utils.StringFormat(this.T(M.TextConfig.Text32),l-r,l),0==r?this.btnSweep.getChildByName("labTime").active=!1:(this.btnSweep.getChildByName("labTime").active=!0,this.btnSweep.getChildByName("labTime").getComponent(cc.Label).string=O.BraveTowerGameUtils.SecondToHours(60*s-Math.floor((n-a)/1e3)))},e.prototype.initSubView=function(){this.newBtnSubEnter.on(cc.Node.EventType.TOUCH_END,function(){k.UIMgr.getInstance().openUI(R.UIID.UISubEnter,R.UIID.UINONE)}),this.initParam(),this.refreshSubView(),this.hideButtomView(),this.initSubButton()},e.prototype.initParam=function(){for(var t in this.subGameList.children){var e=this.subGameList.children[t];this.doInitParamDown(e.name)}},e.prototype.doInitParamDown=function(t){var e;if("a"==t){var o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params34)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params35)),n="\u53cc\u9f99\u620f\u73e0",a=L.TrackId.double_dragons;e=new U.subEnterObj(o,i,n,a,L.TrackId.double_dragons_X)}else"b"==t?(o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params32)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params33)),n="\u62a2\u9f99\u73e0",a=L.TrackId.Grab_Dragon_Balls,e=new U.subEnterObj(o,i,n,a,L.TrackId.Grab_Dragon_Balls_X)):"c"==t?(o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params30)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params31)),n="\u5c0f\u7f8e\u5feb\u8dd1",a=L.TrackId.Girl_run,e=new U.subEnterObj(o,i,n,a,L.TrackId.Girl_run_X)):"d"==t?(o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params28)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params29)),n="\u98de\u6765\u6a2a\u77f3",a=L.TrackId.Flying_Stone,e=new U.subEnterObj(o,i,n,a,L.TrackId.Flying_Stone_X)):"e"==t?(o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params26)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params27)),n="\u89e3\u6551\u5c0f\u7f8e",a=L.TrackId.Help_girl,e=new U.subEnterObj(o,i,n,a,L.TrackId.Help_girl_X)):"f"==t?(o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params24)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params25)),n="\u51fb\u9000\u6076\u9f99",a=L.TrackId.Fight_dragon,e=new U.subEnterObj(o,i,n,a,L.TrackId.Fight_dragon_X)):"g"==t?(o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params22)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params23)),n="\u5b88\u536b\u57ce\u5899",a=L.TrackId.Walls_defended,e=new U.subEnterObj(o,i,n,a,L.TrackId.Walls_defended_X)):"h"==t&&(o=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params18)),i=Number(F.DataMgr.getInstance().getParamCfg(x.BraveTowerEnumParamsCfg.Params21)),n="\u5361\u724c\u8dd1\u9177",a=L.TrackId.Parkour_run,e=new U.subEnterObj(o,i,n,a,L.TrackId.Parkour_run_X));this.subMap[t]=e},e.prototype.hideButtomView=function(){for(var t=this.subGameList.children.length,e=this.subGameList.children,o=0;o<t;o++)this.checkISHideInSdk(o)||this.checkISHideInWebLink(o)?e[o].active=!1:e[o].active=!0},e.prototype.checkISHideInSdk=function(t){return!!S.SdkMgr.getInstance().getCheckVersion(P.SwitchID.ShenHe)&&-1!=[].indexOf(t)},e.prototype.checkISHideInWebLink=function(t){return P.PlatformSetting.currentPlatform==B.Platform.WEB_LINK&&-1!=[].indexOf(t)},e.prototype.initSubButton=function(){var t=this,e=function(e){var i=o.subGameList.children[e],n=Number(e);o.initSubButtonView(i,n),i.on(cc.Node.EventType.TOUCH_END,function(){t.EnterSubPlay(n,i.name)})},o=this;for(var i in this.subGameList.children)e(i)},e.prototype.initSubButtonView=function(t){var e=t.getChildByName("labName"),o=t.getChildByName("labInfo"),i=this.subMap[t.name];e.getComponent(cc.Label).string=i.subPlayName,o.getComponent(cc.Label).string=v.subGameTextCfg.subDesc},e.prototype.getClassByIndex=function(t){return"a"==t?u.default:"b"==t?l.default:"c"==t?m.default:"d"==t?g.default:"e"==t?p.default:"f"==t?d.default:"g"==t?h.default:"h"==t?f.default:void 0},e.prototype.EnterSubPlay=function(t,e){var o=this,i=G.PlayerMgr.getInstance().getUserData().getMaxStage(),n=this.subMap[e];if(i<=n.subPlayStage)k.UIMgr.getInstance().openUI(R.UIID.UITips,R.UIID.UINONE,w.Utils.StringFormat(this.T(v.subGameTextCfg.subTips),n.subPlayStage+1));else{var a=Date.now(),r=_.default.getInstance().getSubUserData().getSubgameTimeByIndex(e),s=Math.floor((a-r)/1e3),c=function(){o.getClassByIndex(e).instance.enter_App(function(){k.UIMgr.getInstance().getUIById(R.UIID.UIHome).node.active=!1,y.subTimeGame.instance.initSubTimer(e)},function(t){k.UIMgr.getInstance().getUIById(R.UIID.UIHome).node.active=!0,y.subTimeGame.instance.closeSubTimer(),t&&G.PlayerMgr.getInstance().getUserData().addDiamondNum(t),_.default.getInstance().getSubUserData().setSubgameTimeByIndex(e)},!1,t)};s<n.subPlayTime?S.SdkMgr.getInstance().playVideo(S.AdType.AdFreeTime,function(){var t;G.PlayerMgr.getInstance().getTrackData().youmengTrack(n.subTrackId),G.PlayerMgr.getInstance().getTrackData().youmengTrack(n.Add_TrackId,(t=G.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?t:Math.floor((t-1)/5)+5),c()}):c()}},e.prototype.refreshSubView=function(){var t=Date.now(),e=G.PlayerMgr.getInstance().getUserData().getMaxStage();for(var o in this.subGameList.children){Number(o);var i=this.subGameList.children[o],n=this.subMap[i.name],a=n.subPlayStage,r=_.default.getInstance().getSubUserData().getSubgameTimeByIndex(i.name),s=n.subPlayTime;this.onSubView(i,e,a,t,r,s)}},e.prototype.onSubView=function(t,e,o,i,n,a){if(e>o){var r=Math.floor((i-n)/1e3);t.getChildByName("ndMask").active=r<a,t.getChildByName("Layout").active=r<a,t.getChildByName("labInfo").active=!1,r<a&&(t.getChildByName("Layout").getChildByName("labTime").getComponent(cc.Label).string=a-r+"s")}else t.getChildByName("ndMask").active=!0,t.getChildByName("Layout").active=!1,t.getChildByName("labInfo").active=!0},c([W({type:cc.Node,tooltip:"\u8bbe\u7f6e"})],e.prototype,"btnSetting",void 0),c([W({type:cc.Node,tooltip:"\u7b7e\u5230"})],e.prototype,"btnSign",void 0),c([W({type:cc.Node,tooltip:"\u4efb\u52a1"})],e.prototype,"btnTask",void 0),c([W({type:cc.Node,tooltip:"\u5728\u7ebf\u5956\u52b1"})],e.prototype,"btnOnline",void 0),c([W({type:cc.Node,tooltip:"\u5165\u53e3"})],e.prototype,"btnSideBoard",void 0),c([W({type:cc.Node,tooltip:"\u6dfb\u52a0\u684c\u9762"})],e.prototype,"btnAddDesktop",void 0),c([W({type:cc.Node,tooltip:"\u5151\u6362\u7801"})],e.prototype,"btnExchangeCode",void 0),c([W({type:cc.Node,tooltip:"\u53cd\u9988"})],e.prototype,"btn_Report",void 0),c([W({type:cc.Node,tooltip:"\u5173\u5361\u4fe1\u606f"})],e.prototype,"ndLevelInfo",void 0),c([W({type:cc.Node,tooltip:"\u5173\u5361\u5c55\u793a"})],e.prototype,"ndLevelShow",void 0),c([W({type:cc.Node,tooltip:"\u5de6\u4fa7\u6309\u94ae"})],e.prototype,"btnLeft",void 0),c([W({type:cc.Node,tooltip:"\u53f3\u4fa7\u6309\u94ae"})],e.prototype,"btnRight",void 0),c([W({type:cc.Node,tooltip:"\u5b9d\u7bb1\u5c55\u793a"})],e.prototype,"ndBoxShow",void 0),c([W({type:cc.Node,tooltip:"\u6218\u6597\u6309\u94ae"})],e.prototype,"btnBattle",void 0),c([W({type:cc.Node,tooltip:"\u626b\u8361\u6309\u94ae"})],e.prototype,"btnSweep",void 0),c([W(cc.Node)],e.prototype,"subGameList",void 0),c([W({type:cc.Node,tooltip:"\u526f\u73a9\u6cd5\u5165\u53e3"})],e.prototype,"newBtnSubEnter",void 0),c([H],e)}(b.default);a.default=V,cc._RF.pop(),cc._RF.pop()},{}],HomeBossCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e848bG5v+VGS4JnUgEAqT7U","HomeBossCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e848bG5v+VGS4JnUgEAqT7U","HomeBossCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("List"),u=i("ResourceMgr"),d=i("SdkMgr"),h=i("Utils"),f=i("Main"),m=i("TextConfig"),g=i("BraveTowerEnum"),y=i("ItemGood"),v=i("GameTrackDataEvent"),_=i("DataMgr"),b=i("PlayerMgr"),B=cc._decorator,I=B.ccclass,P=B.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndList=null,e}return s(e,t),e.prototype.start=function(){this.initEventListener(),this.initBtnListener(),this.cfgList=_.DataMgr.getInstance().getChallengeCfgList(),this.ndList.tmpNode.active=!1,this.ndList.numItems=this.cfgList.length},e.prototype.initEventListener=function(){},e.prototype.initBtnListener=function(){},e.prototype.initTopView=function(){},e.prototype.initBtnView=function(){},e.prototype.initListItem=function(t,e){var o=this;t.active=!0;var i=this.cfgList[e];t.getChildByName("labName").getComponent(cc.Label).string=this.T(i.name);for(var n=t.getChildByName("layReward"),a=Math.max(i.reward.length,n.childrenCount),r=function(t){var e=n.children[t],o=i.reward[t];e?o?(e.active=!0,e.getComponent(y.default).initView(o[0],o[1])):e.active=!1:u.ResourceMgr.getInstance().getNode(g.BraveTowerPoolName.ItemGood,g.BraveTowerBundelName.Icon,g.BraveTowerPrefabName.ItemGood,function(t){t.setParent(n),t.y=0,(e=t).active=!0,e.getComponent(y.default).initView(o[0],o[1])})},s=0;s<a;s++)r(s);var c=b.PlayerMgr.getInstance().getDailyData().getBossEnter(e);t.getChildByName("labTime").getComponent(cc.Label).string=h.Utils.StringFormat(this.T(m.TextConfig.Text25),i.time-c,i.time);var l=t.getChildByName("btnJoin");l.children[0].children[0].active=c>=i.time,l.off(cc.Node.EventType.TOUCH_END),l.on(cc.Node.EventType.TOUCH_END,function(){var t=function(){o.ndList.updateItem(e),f.default.instance.startGame(g.BraveTowerGameMode.Boss,i.id),b.PlayerMgr.getInstance().getTrackData().youmengTrack(v.TrackId.game_instance_X,i.id)};c>=i.time?d.SdkMgr.getInstance().playVideo(d.AdType.AdFreeTime,function(){var e;b.PlayerMgr.getInstance().getTrackData().youmengTrack(v.TrackId.Copy_unlock),b.PlayerMgr.getInstance().getTrackData().youmengTrack(v.TrackId.Copy_unlock_X,(e=b.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?e:Math.floor((e-1)/5)+5),t()}):(b.PlayerMgr.getInstance().getDailyData().addBossEnter(e),t())},this)},c([P({type:p.default,tooltip:"\u5361\u724c"})],e.prototype,"ndList",void 0),c([I],e)}(l.default);a.default=C,cc._RF.pop(),cc._RF.pop()},{}],HomeCardCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"93e10RCv81A6oJuucRX4HTW","HomeCardCtrl");var i=t,n=e,a=o;cc._RF.push(n,"93e10RCv81A6oJuucRX4HTW","HomeCardCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("List"),u=i("AudioMgr"),d=i("UIMgr"),h=i("Utils"),f=i("Config"),m=i("TextConfig"),g=i("BraveTowerEnum"),y=i("DataMgr"),v=i("PlayerMgr"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndType1=null,e.ndType2=null,e.ndType3=null,e.ndTies=null,e.ndTiesItem=null,e.listCard=null,e}return s(e,t),e.prototype.onEnable=function(){this.sendEvent(g.BraveTowerEventName.ShowTop,!1),this.initData(),this.initTopView(),this.listCard.numItems=this.cardInfoList.length},e.prototype.onDisable=function(){this.sendEvent(g.BraveTowerEventName.ShowTop,!0)},e.prototype.start=function(){this.initEventListener(),this.initBtnListener(),this.ndTiesItem.active=!1,this.listCard.tmpNode.active=!1,this.initBtnView(),this.refreshCard()},e.prototype.initData=function(){this.tiesInfoList=[],this.cardInfoList=[];for(var t=y.DataMgr.getInstance().getTiesCfgList(),e=0;e<t.length;e++){for(var o={cfg:r=t[e],cardList:[],hasCardList:[]},i=0;i<r.effectList.length;i++){var n=r.effectList[i];o.cardList.push(n.cardId),(s=v.PlayerMgr.getInstance().getUserData().getCardById(n.cardId))&&o.hasCardList.push(n.cardId)}this.tiesInfoList.push(o)}this.tiesInfoList.sort(function(t,e){return t.hasCardList.length<t.cardList.length&&e.hasCardList.length>=e.cardList.length?1:t.hasCardList.length>=t.cardList.length&&e.hasCardList.length<e.cardList.length?-1:t.cfg.id-e.cfg.id});var a=y.DataMgr.getInstance().getCardCfgList();for(e=0;e<a.length;e++){var r=a[e],s=v.PlayerMgr.getInstance().getUserData().getCardById(r.id);this.cardInfoList.push({cfg:r,info:s,ties:v.PlayerMgr.getInstance().getCardTies(r.id)})}this.cardInfoList.sort(function(t,e){return t.info&&e.info?t.cfg.quality==e.cfg.quality?t.info.level==e.info.level?t.cfg.id-e.cfg.id:e.info.level-t.info.level:e.cfg.quality-t.cfg.quality:t.info&&!e.info?-1:e.info&&!t.info?1:t.cfg.quality==e.cfg.quality?t.cfg.id-e.cfg.id:e.cfg.quality-t.cfg.quality})},e.prototype.initEventListener=function(){var t=this;this.addEvent(g.BraveTowerEventName.UpdateAllShard,this.refreshCard),this.addEvent(g.BraveTowerEventName.UpdateRedPoint,function(e){8&e&&(t.initData(),t.initTopView(),t.listCard.numItems=t.cardInfoList.length)})},e.prototype.initBtnListener=function(){},e.prototype.refreshCard=function(){this.ndType1.getChildByName("labNum").getComponent(cc.Label).string=""+v.PlayerMgr.getInstance().getUserData().getFreeNum(0),this.ndType2.getChildByName("labNum").getComponent(cc.Label).string=""+v.PlayerMgr.getInstance().getUserData().getFreeNum(1),this.ndType3.getChildByName("labNum").getComponent(cc.Label).string=""+v.PlayerMgr.getInstance().getUserData().getFreeNum(2)},e.prototype.initTopView=function(){for(var t=this,e=Math.max(this.ndTies.childrenCount-1,this.tiesInfoList.length),o=function(e){var o=i.ndTies.children[e+1],n=i.tiesInfoList[e];o||((o=cc.instantiate(i.ndTiesItem)).setParent(i.ndTies),o.on(cc.Node.EventType.TOUCH_END,function(){var e=o.cfgIndex;d.UIMgr.getInstance().openUI(f.UIID.UITiesInfo,f.UIID.UINONE,t.tiesInfoList[e])},i)),o.attr({cfgIndex:e}),n?(o.active=!0,i.loadSpriteFrame(g.BraveTowerBundelName.IconTies,n.cfg.icon,function(t){o.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),o.getChildByName("labName").getComponent(cc.Label).string=i.T(n.cfg.name),o.getChildByName("labPro").getComponent(cc.Label).string=n.hasCardList.length+"/"+n.cardList.length,o.getChildByName("labName").color=(new cc.Color).fromHEX(n.hasCardList.length>=n.cardList.length?"#ffdb56":"#FFFFFF"),o.getChildByName("labPro").color=(new cc.Color).fromHEX(n.hasCardList.length>=n.cardList.length?"#ffdb56":"#FFFFFF")):o.active=!1},i=this,n=0;n<e;n++)o(n)},e.prototype.initBtnView=function(){},e.prototype.initListItem=function(t,e){t.active=!0;var o=this.cardInfoList[e];t.attr({cfgIndex:e}),t.getChildByName("labName").getComponent(cc.Label).string=this.T(o.cfg.name),this.loadSpriteFrame(g.BraveTowerBundelName.Icon,h.Utils.StringFormat(g.BraveTowerImgName.CardQuality,o.cfg.quality),function(o){t.cfgIndex==e&&(t.getComponent(cc.Sprite).spriteFrame=o)}),this.loadSpriteFrame(g.BraveTowerBundelName.IconCard,o.cfg.icon,function(o){t.cfgIndex==e&&(t.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=o)});for(var i=t.getChildByName("layTies"),n=Math.max(i.childrenCount,o.ties.length),a=function(n){var a=i.children[n],s=o.ties[n];if(a)if(s){a.active=!0;var c=y.DataMgr.getInstance().getTiesCfg(s);r.loadSpriteFrame(g.BraveTowerBundelName.IconTies,c.icon,function(o){t.cfgIndex==e&&(a.getComponent(cc.Sprite).spriteFrame=o)})}else a.active=!1;else(a=cc.instantiate(i.children[0])).setParent(i),a.x=0,a.active=!0,c=y.DataMgr.getInstance().getTiesCfg(s),r.loadSpriteFrame(g.BraveTowerBundelName.IconTies,c.icon,function(o){t.cfgIndex==e&&(a.getComponent(cc.Sprite).spriteFrame=o)})},r=this,s=0;s<n;s++)a(s);var c=t.getChildByName("ndNormal"),l=t.getChildByName("ndLock");if(o.info){c.active=!0,l.active=!1,c.getChildByName("labLevel").getComponent(cc.Label).string="Lv."+o.info.level;var p=y.DataMgr.getInstance().getCardQualityCfg(o.cfg.quality),_=p.levelInfo[o.info.level-1].fragment;o.info.level>=p.levelInfo.length?(c.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=1,c.getChildByName("labPro").getComponent(cc.Label).string="Max"):(c.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=o.info.curNum/_,c.getChildByName("labPro").getComponent(cc.Label).string=o.info.curNum+"/"+_);var b=c.getChildByName("ndArr");cc.Tween.stopAllByTarget(b);var B=v.PlayerMgr.getInstance().getUserData().getFreeNum(o.cfg.quality-1);o.info.curNum+B>=_?(b.active=!0,cc.tween(b).to(.5,{y:-75}).to(.5,{y:-65}).union().repeatForever().start()):b.active=!1}else c.active=!1,l.active=!0,o.cfg.lockStage?l.getChildByName("labLock").getComponent(cc.Label).string=h.Utils.StringFormat(this.T(m.TextConfig.Text19),o.cfg.lockStage):l.getChildByName("labLock").getComponent(cc.Label).string=this.T(m.TextConfig.Text10);t.off(cc.Node.EventType.TOUCH_END),t.on(cc.Node.EventType.TOUCH_END,function(){u.AudioMgr.getInstance().playAudioButtonClicked(),d.UIMgr.getInstance().openUI(f.UIID.UICardInfo,f.UIID.UINONE,o)},this)},e.prototype.showRed=function(){this.initData();for(var t=0;t<this.cardInfoList.length;t++){var e=this.cardInfoList[t];if(e.info){var o=y.DataMgr.getInstance().getCardQualityCfg(e.cfg.quality).levelInfo[e.info.level-1].fragment,i=v.PlayerMgr.getInstance().getUserData().getFreeNum(e.cfg.quality-1);if(e.info.curNum+i>=o)return!0}}return!1},c([B({type:cc.Node,tooltip:"\u9876\u90e8"})],e.prototype,"ndType1",void 0),c([B({type:cc.Node,tooltip:"\u9876\u90e8"})],e.prototype,"ndType2",void 0),c([B({type:cc.Node,tooltip:"\u9876\u90e8"})],e.prototype,"ndType3",void 0),c([B({type:cc.Node,tooltip:"\u7f81\u7eca"})],e.prototype,"ndTies",void 0),c([B({type:cc.Node,tooltip:"\u7f81\u7eca\u7ec4\u4ef6"})],e.prototype,"ndTiesItem",void 0),c([B({type:p.default,tooltip:"\u5361\u724c"})],e.prototype,"listCard",void 0),c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],HomeShopCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"b18e2RSAbRKSKnxzEqjWg7K","HomeShopCtrl");var i=t,n=e,a=o;cc._RF.push(n,"b18e2RSAbRKSKnxzEqjWg7K","HomeShopCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("Appcfg"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("UIMgr"),m=i("Utils"),g=i("Config"),y=i("TextConfig"),v=i("BraveTowerEnum"),_=i("GameTrackDataEvent"),b=i("GameEnumData"),B=i("DataMgr"),I=i("PlayerMgr"),P=cc._decorator,C=P.ccclass,D=P.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTop=null,e.btnFree=null,e.btnSingle=null,e.btnTen=null,e.btnSingleVideo=null,e.btnTenVideo=null,e.skeleton=null,e.btnOdds=null,e.fragMax=[],e.cardList=[],e.isLoad=!1,e.rewardList=[],e.isAni=!1,e}return s(e,t),e.prototype.onLoad=function(){this.cfgDrawList=B.DataMgr.getInstance().getDrawCardsRewardList(),this.cfgBoxList=B.DataMgr.getInstance().getShopBoxCfgList()},e.prototype.onEnable=function(){this.isLoad&&this.initBtnView()},e.prototype.start=function(){this.isLoad=!0,this.initData(),this.initEventListener(),this.initBtnListener(),this.skeleton.setAnimation(0,l.idle,!0),this.initTopView(),this.initBtnView()},e.prototype.initData=function(){for(var t=B.DataMgr.getInstance().getCardQualityCfgList(),e=0;e<t.length;e++){for(var o=t[e],i=0,n=0;n<o.levelInfo.length;n++)i+=o.levelInfo[n].fragment;this.fragMax[o.id-1]=i}var a=B.DataMgr.getInstance().getCardCfgList();for(e=0;e<a.length;e++)o=a[e],this.cardList[o.quality-1]||(this.cardList[o.quality-1]=[]),this.cardList[o.quality-1].push(o)},e.prototype.initEventListener=function(){this.addEvent(u.BaseEventName.CloseUI,this.onCloseUI)},e.prototype.initBtnListener=function(){var t=this;this.ndTop.getChildByName("ndBox1").on(cc.Node.EventType.TOUCH_END,function(){for(var e=I.PlayerMgr.getInstance().getUserData().getDrawList(),o=t.cfgDrawList.length-2,i=0;i<t.cfgDrawList.length-1;i++)if(1!=e[i]){o=i;break}f.UIMgr.getInstance().openUI(g.UIID.UIShopBox,g.UIID.UIHome,o,1)},this),this.ndTop.getChildByName("ndBox2").on(cc.Node.EventType.TOUCH_END,function(){for(var e=I.PlayerMgr.getInstance().getUserData().getDrawList(),o=t.cfgDrawList.length-2,i=0;i<t.cfgDrawList.length-1;i++)if(1!=e[i]){o=i;break}f.UIMgr.getInstance().openUI(g.UIID.UIShopBox,g.UIID.UIHome,o+1,2)},this);var e=function(e){var o=t.canDraw(e),i=t.cfgBoxList[e];switch(o){case-1:return void f.UIMgr.getInstance().openUI(g.UIID.UITips,g.UIID.UIHome,t.T(y.TextConfig.Tips02));case 0:var n=B.DataMgr.getInstance().getGoodsCfgById(i.Consume[0]);return void f.UIMgr.getInstance().openUI(g.UIID.UITips,g.UIID.UIHome,m.Utils.StringFormat(t.T(y.TextConfig.Tips03),t.T(n.name)));case 1:return void h.SdkMgr.getInstance().playVideo(h.AdType.AdFreeTime,function(){var o=function(){var t=I.PlayerMgr.getInstance().getUserData().getMaxStage();return t<=5?t:Math.floor((t-1)/5)+5};1==e&&(I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Draw_cards),I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Draw_cards_X,o())),3==e&&(I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Draw_cards10),I.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Draw_cards10_X,o())),I.PlayerMgr.getInstance().getUserData().addDrawVideoTimes(i.id)>=i.VideoNum&&(I.PlayerMgr.getInstance().getUserData().subDrawVideoTimes(i.id,i.VideoNum),I.PlayerMgr.getInstance().getDailyData().addLotteryTimes(i.id),t.getReward(e)),t.initBtnView()});case 2:t.subGood(i.FirstConsume[0],i.FirstConsume[1]),t.initBtnView();break;case 3:t.subGood(i.Consume[0],i.Consume[1])}t.getReward(e)};this.btnFree.on(cc.Node.EventType.TOUCH_END,function(){I.PlayerMgr.getInstance().getDailyData().addFreeLottery(),t.getReward(0),t.initBtnView()},this),this.btnSingle.on(cc.Node.EventType.TOUCH_END,function(){e(0)},this),this.btnSingleVideo.on(cc.Node.EventType.TOUCH_END,function(){e(1)},this),this.btnTen.on(cc.Node.EventType.TOUCH_END,function(){e(2)},this),this.btnTenVideo.on(cc.Node.EventType.TOUCH_END,function(){e(3)},this),this.btnOdds.on(cc.Node.EventType.TOUCH_END,function(){f.UIMgr.getInstance().openUI(g.UIID.UIShopOdds,g.UIID.UIHome)},this)},e.prototype.initTopView=function(){for(var t=I.PlayerMgr.getInstance().getUserData().getDrawTimes(),e=I.PlayerMgr.getInstance().getUserData().getDrawList(),o=this.cfgDrawList.length-2,i=0;i<this.cfgDrawList.length-1;i++)if(1!=e[i]){o=i;break}var n,a=this.ndTop.getChildByName("sprPro").getComponent(cc.Sprite),r=this.ndTop.getChildByName("ndBox1"),s=this.ndTop.getChildByName("ndBox2");a.fillRange=0==o?t/this.cfgDrawList[o+1].AccumulateNum:(t-this.cfgDrawList[o-1].AccumulateNum)/(this.cfgDrawList[o+1].AccumulateNum-this.cfgDrawList[o-1].AccumulateNum),(n=r.getChildByName("ndLight")).active=t>=this.cfgDrawList[o].AccumulateNum&&1!=e[o],v.BraveTowerGameUtils.aniAngle(n),r.getChildByName("labPro").getComponent(cc.Label).string=t+"/"+this.cfgDrawList[o].AccumulateNum,(n=s.getChildByName("ndLight")).active=t>=this.cfgDrawList[o+1].AccumulateNum&&1!=e[o+1],v.BraveTowerGameUtils.aniAngle(n),s.getChildByName("labPro").getComponent(cc.Label).string=t+"/"+this.cfgDrawList[o+1].AccumulateNum,this.sendEvent(v.BraveTowerEventName.UpdateRedPoint,2)},e.prototype.initBtnView=function(){var t=I.PlayerMgr.getInstance().getDailyData().getFreeLottery();this.btnFree.active=t<1,this.btnSingle.active=t>=1;var e=this.btnSingle.getChildByName("Layout"),o=!1;if((r=this.cfgBoxList[0]).FirstConsume&&this.hasGood(r.FirstConsume[0],r.FirstConsume[1])&&(o=!0),o){var i=B.DataMgr.getInstance().getGoodsCfgById(r.FirstConsume[0]);this.loadSpriteFrame(v.BraveTowerBundelName.Icon,i.icon,function(t){e.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),e.getChildByName("labNum").getComponent(cc.Label).string=v.BraveTowerGameUtils.numberFomat(r.FirstConsume[1])}else i=B.DataMgr.getInstance().getGoodsCfgById(r.Consume[0]),this.loadSpriteFrame(v.BraveTowerBundelName.Icon,i.icon,function(t){e.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),e.getChildByName("labNum").getComponent(cc.Label).string=v.BraveTowerGameUtils.numberFomat(r.Consume[1]);var n=this.btnTen.getChildByName("Layout");o=!1,(r=this.cfgBoxList[2]).FirstConsume&&this.hasGood(r.FirstConsume[0],r.FirstConsume[1])&&(o=!0),o?(i=B.DataMgr.getInstance().getGoodsCfgById(r.FirstConsume[0]),this.loadSpriteFrame(v.BraveTowerBundelName.Icon,i.icon,function(t){n.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),n.getChildByName("labNum").getComponent(cc.Label).string="("+this.getGoodNum(r.FirstConsume[0])+"/"+v.BraveTowerGameUtils.numberFomat(r.FirstConsume[1])+")"):(i=B.DataMgr.getInstance().getGoodsCfgById(r.Consume[0]),this.loadSpriteFrame(v.BraveTowerBundelName.Icon,i.icon,function(t){n.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),n.getChildByName("labNum").getComponent(cc.Label).string=v.BraveTowerGameUtils.numberFomat(r.Consume[1])),this.btnTen.getChildByName("ndTips").getComponentInChildren(cc.Label).string=this.T(r.Label);var a=this.btnTenVideo.getChildByName("Layout"),r=this.cfgBoxList[3];a.getChildByName("labNum").getComponent(cc.Label).string="("+I.PlayerMgr.getInstance().getUserData().getDrawVideoTimes(r.id)+"/"+r.VideoNum+")",r.DayLimitation&&-1!=r.DayLimitation?this.btnTenVideo.getChildByName("labName").getComponent(cc.Label).string=m.Utils.StringFormat(this.T(y.TextConfig.Tips04),r.DayLimitation-I.PlayerMgr.getInstance().getDailyData().getLotteryTimes(r.id)):this.btnTenVideo.getChildByName("labName").getComponent(cc.Label).string=""},e.prototype.canDraw=function(t){var e=this.cfgBoxList[t];return e.VideoNum?e.DayLimitation&&-1!=e.DayLimitation?I.PlayerMgr.getInstance().getDailyData().getLotteryTimes(e.id)<e.DayLimitation?1:-1:1:e.FirstConsume&&this.hasGood(e.FirstConsume[0],e.FirstConsume[1])?2:this.hasGood(e.Consume[0],e.Consume[1])?3:0},e.prototype.getGoodNum=function(t){var e=0;switch(t){case b.BraveTowerEnumGoodsCfg.Coin:e=I.PlayerMgr.getInstance().getUserData().getGoldNum();break;case b.BraveTowerEnumGoodsCfg.Diamond:e=I.PlayerMgr.getInstance().getUserData().getDiamondNum();break;case b.BraveTowerEnumGoodsCfg.Coupon:e=I.PlayerMgr.getInstance().getUserData().getCouponNum();break;case b.BraveTowerEnumGoodsCfg.BlueCard:e=I.PlayerMgr.getInstance().getUserData().getFreeNum(0);break;case b.BraveTowerEnumGoodsCfg.PurpleCard:e=I.PlayerMgr.getInstance().getUserData().getFreeNum(1);break;case b.BraveTowerEnumGoodsCfg.GoldCard:e=I.PlayerMgr.getInstance().getUserData().getFreeNum(2);break;default:return 0}return e},e.prototype.hasGood=function(t,e){var o=0;switch(t){case b.BraveTowerEnumGoodsCfg.Coin:o=I.PlayerMgr.getInstance().getUserData().getGoldNum();break;case b.BraveTowerEnumGoodsCfg.Diamond:o=I.PlayerMgr.getInstance().getUserData().getDiamondNum();break;case b.BraveTowerEnumGoodsCfg.Coupon:o=I.PlayerMgr.getInstance().getUserData().getCouponNum();break;case b.BraveTowerEnumGoodsCfg.BlueCard:o=I.PlayerMgr.getInstance().getUserData().getFreeNum(0);break;case b.BraveTowerEnumGoodsCfg.PurpleCard:o=I.PlayerMgr.getInstance().getUserData().getFreeNum(1);break;case b.BraveTowerEnumGoodsCfg.GoldCard:o=I.PlayerMgr.getInstance().getUserData().getFreeNum(2);break;default:return!1}return o>=e},e.prototype.subGood=function(t,e){switch(t){case b.BraveTowerEnumGoodsCfg.Coin:I.PlayerMgr.getInstance().getUserData().subGoldNum(e);break;case b.BraveTowerEnumGoodsCfg.Diamond:I.PlayerMgr.getInstance().getUserData().subDiamondNum(e);break;case b.BraveTowerEnumGoodsCfg.Coupon:I.PlayerMgr.getInstance().getUserData().subCouponNum(e);break;case b.BraveTowerEnumGoodsCfg.BlueCard:I.PlayerMgr.getInstance().getUserData().subFreeNum(0,e);break;case b.BraveTowerEnumGoodsCfg.PurpleCard:I.PlayerMgr.getInstance().getUserData().subFreeNum(1,e);break;case b.BraveTowerEnumGoodsCfg.GoldCard:I.PlayerMgr.getInstance().getUserData().subFreeNum(2,e);break;default:return!1}return!0},e.prototype.getReward=function(t){if(!this.isAni){var e=this.cfgBoxList[t],o=1;e.OutQuality&&(o=10),I.PlayerMgr.getInstance().getTaskData().addRecruitNum(o);for(var i=I.PlayerMgr.getInstance().getUserData().getMaxStage(),n=[],a=0;a<e.Quality.length;a++)for(var r=e.Quality[a],s=0;s<this.cardList[r[0]-1].length;s++){var c=this.cardList[r[0]-1][s];c.lockStage&&c.lockStage>=i||n.push({id:c.id,weight:r[1]})}for(this.rewardList=[],a=0;a<o;a++){var l=void 0;if(0==a&&e.OutQuality){var p=this.cardList[e.OutQuality-1];l=p[m.Utils.randomRang(0,p.length)].id}else l=m.Utils.weight_rand(n).id;var u=I.PlayerMgr.getInstance().getUserData().getCardById(l);if(u){var d=B.DataMgr.getInstance().getCardCfg(l);if(this.fragMax[d.quality-1]<=u.getNum){var h=B.DataMgr.getInstance().getParamCfg(b.BraveTowerEnumParamsCfg.Params05).split(",");I.PlayerMgr.getInstance().getUserData().addGoldNum(parseInt(h[d.quality-1])),I.PlayerMgr.getInstance().getTaskData().addGetGold(parseInt(h[d.quality-1]))}else I.PlayerMgr.getInstance().getUserData().addCardNum(l,1);this.rewardList.push({id:l,isNew:!1})}else I.PlayerMgr.getInstance().getUserData().addCardNum(l,1),this.rewardList.push({id:l,isNew:!0})}I.PlayerMgr.getInstance().getUserData().addDrawTimes(o),this.playSkeleton(),this.initTopView(),this.sendEvent(v.BraveTowerEventName.UpdateRedPoint,8)}},e.prototype.playSkeleton=function(){var t=this;d.AudioMgr.getInstance().playEffect(g.AudioId.Draw),this.isAni=!0,this.sendEvent(u.BaseEventName.blocktouch,!1);var e=this.skeleton.node.parent,o=cc.tween(e).to(.05,{position:cc.v3(2,2,0)}).to(.1,{position:cc.v3(-2,-2,0)}).to(.05,{position:cc.v3(0,0,0)}).union().repeatForever();o.start(),cc.tween(e).to(1,{scale:1.5},{easing:"quartOut"}).call(function(){t.skeleton.setAnimation(0,l.open,!1),o.stop(),e.setPosition(0,0,0)}).to(.8,{scale:1}).call(function(){t.isAni=!1,t.sendEvent(u.BaseEventName.blocktouch,!0),t.skeleton.setAnimation(0,l.idle,!0),f.UIMgr.getInstance().openUI(g.UIID.UIRewardCard,g.UIID.UINONE,t.rewardList)}).start()},e.prototype.onCloseUI=function(t,e){t==g.UIID.UIShopBox&&e&&(this.initTopView(),this.initBtnView(),this.sendEvent(v.BraveTowerEventName.UpdateRedPoint,10))},e.prototype.showRed=function(){var t,e=this,o=function(t){var o=B.DataMgr.getInstance().getShopBoxCfgList()[t];return o.VideoNum?o.DayLimitation?I.PlayerMgr.getInstance().getDailyData().getLotteryTimes(o.id)<o.DayLimitation?1:-1:1:o.FirstConsume&&e.hasGood(o.FirstConsume[0],o.FirstConsume[1])?2:e.hasGood(o.Consume[0],o.Consume[1])?3:0};if(2==(t=o(0))||3==t)return!0;if(2==(t=o(2))||3==t)return!0;for(var i=I.PlayerMgr.getInstance().getUserData().getDrawTimes(),n=I.PlayerMgr.getInstance().getUserData().getDrawList(),a=B.DataMgr.getInstance().getDrawCardsRewardList(),r=a.length-2,s=0;s<a.length-1;s++)if(1!=n[s]){r=s;break}return i>=a[r].AccumulateNum&&1!=n[r]||i>=a[r+1].AccumulateNum&&1!=n[r+1]},c([D({type:cc.Node,tooltip:"\u5b9d\u7bb1\u8fdb\u5ea6"})],e.prototype,"ndTop",void 0),c([D({type:cc.Node,tooltip:"\u514d\u8d39\u62bd\u5956"})],e.prototype,"btnFree",void 0),c([D({type:cc.Node,tooltip:"\u5355\u62bd\u6309\u94ae"})],e.prototype,"btnSingle",void 0),c([D({type:cc.Node,tooltip:"\u5341\u62bd\u6309\u94ae"})],e.prototype,"btnTen",void 0),c([D({type:cc.Node,tooltip:"\u5355\u62bd\u89c6\u9891\u6309\u94ae"})],e.prototype,"btnSingleVideo",void 0),c([D({type:cc.Node,tooltip:"\u5341\u62bd\u89c6\u9891\u6309\u94ae"})],e.prototype,"btnTenVideo",void 0),c([D({type:sp.Skeleton,tooltip:"\u62bd\u5361\u52a8\u753b"})],e.prototype,"skeleton",void 0),c([D({type:cc.Node,tooltip:"\u62bd\u5361\u6982\u7387"})],e.prototype,"btnOdds",void 0),c([C],e)}(p.default);a.default=T,function(t){t.idle="idle",t.open="open"}(l||(l={})),cc._RF.pop(),cc._RF.pop()},{}],HttpMgr:[function(t,e,o){"use strict";cc._RF.push(e,"42ee6Jx1bBC86XD6EEtNiA3","HttpMgr");var i=t,n=e,a=o;cc._RF.push(n,"42ee6Jx1bBC86XD6EEtNiA3","HttpMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.HttpMgr=void 0;var r=i("BasePlatform"),s=i("PlatformSetting"),c=function(){function t(){}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.httpGet=function(t,e,o){var i=new XMLHttpRequest;if(e){var n="";Object.keys(e).forEach(function(t){n+=t+"="+encodeURIComponent(e[t])+"&"}),""!==n&&(t=t+"?"+(n=n.substr(0,n.lastIndexOf("&"))))}i.open("GET",t,!0),i.setRequestHeader("Access-Control-Allow-Origin","*"),i.setRequestHeader("Access-Control-Allow-Methods","GET, POST"),i.setRequestHeader("Access-Control-Allow-Headers","x-requested-with,content-type"),i.setRequestHeader("Content-Type","application/json"),s.PlatformSetting.currentPlatform!=r.Platform.KuaiShou&&i.setRequestHeader("Accept-Encoding","gzip"),i.onreadystatechange=function(){if(4===i.readyState){var t=i.responseText;i.status>=200&&i.status<300?(i.statusText,o(!0,t)):o(!1,"")}},i.ontimeout=function(){o&&o(null)},i.onerror=function(){o&&o(null)},i.send()},t.prototype.httpPost=function(e,o,i,n){void 0===e&&(e=null);var a=null;e&&(n?a=JSON.stringify(e):(a="",Object.keys(e).forEach(function(t){a+=t+"="+encodeURIComponent(e[t])+"&"}),""!==a&&(a=a.substr(0,a.lastIndexOf("&")))));var c=i,l=new XMLHttpRequest;l.timeout=7e3,l.open("POST",c,!0),l.setRequestHeader("Access-Control-Allow-Origin","*"),l.setRequestHeader("Access-Control-Allow-Methods","GET, POST"),l.setRequestHeader("Access-Control-Allow-Headers","x-requested-with,content-type"),n?l.setRequestHeader("Content-Type","application/json"):l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.PlatformSetting.currentPlatform!=r.Platform.KuaiShou&&(l.setRequestHeader("Connection","close"),l.setRequestHeader("Accept-Encoding","gzip")),l.onreadystatechange=function(){if(4===l.readyState)if(l.status>=200&&l.status<400){var e=l.responseText;t.isPass(e)&&o&&o(e)}else o&&o(null)},l.ontimeout=function(){o&&o(null)},l.onerror=function(){o&&o(null)},a?l.send(a):l.send()},t.isPass=function(){return!0},t}();a.HttpMgr=c,cc._RF.pop(),cc._RF.pop()},{}],ImplodeManager:[function(t,e,o){"use strict";cc._RF.push(e,"99f39jiXwdJCZ4P0wNFBLEq","ImplodeManager");var i=e,n=o;cc._RF.push(i,"99f39jiXwdJCZ4P0wNFBLEq","ImplodeManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.ImplodeManager=void 0;var a=function(){function t(){this.KSsfzt=!0,this.hasAd=!0,this.hasBanner=!0,this.hasInsertAd=!0,this.hasVideoAd=!0}return t.prototype.getLaunchOptionsSync=function(){},t.prototype.isKSsfzt=function(){return this.KSsfzt},t.prototype.hasVerify=function(){return!1},t.prototype.getCode=function(){},t.prototype.pauseRecord=function(){},t.prototype.resumeRecord=function(){},t.prototype.verifyKey=function(){},t.prototype.checkCanOpenSideBar=function(){},t.prototype.openSideBar=function(){},t.prototype.closeNativeAd=function(){},t.prototype.toAppStore=function(){},t.prototype.addNotify=function(){},t.prototype.needDouyVefiy=function(){},t.prototype.interVefiy=function(){},t.prototype.showNative=function(){},t.prototype.hideNative=function(){},t.prototype.showInterNative=function(){},t.prototype.hideInterNative=function(){},t.prototype.canShowBtnMore=function(){return!1},t.prototype.canShowEnergyForverVersion=function(){return!0},t.prototype.shareVideo=function(){},t.prototype.showFloatIconAd=function(){},t.prototype.hideFloatIconAd=function(){},t.prototype.canCare=function(){return!1},t.prototype.canShare=function(){return!0},t.prototype.initTrack=function(){},t.prototype.getUserInfo=function(t){t(null,null)},t.prototype.shareImg=function(t){console.log("\u5206\u4eab"),t&&t()},t.prototype.follow=function(){},t.prototype.showGamePortalAd=function(){},t.prototype.addShortcut=function(t,e){e&&(e("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u6210\u529f"),console.log("\u6dfb\u52a0\u684c\u9762\u6210\u529f"))},t.prototype.checkShortcut=function(t,e){e&&e(!0)},t.prototype.gameVersion=function(){return"1.0.4"},t.prototype.insertAdSwitchVersion=function(){return 7},t.prototype.caidanSwitchVersion=function(){return 2},t.prototype.initNativeAd=function(){},t.prototype.showNativeAd=function(){},t.prototype.youmengTrack=function(){},t.prototype.goToSuperXiuXian=function(){},t.prototype.showBlockAd=function(){},t.prototype.hideBlockAd=function(){},t.prototype.initSdk=function(){this.rewardedVideoAd=gamebox.createRewardedVideoAd()},t.prototype.login=function(){},t.prototype.pay=function(){},t.prototype.share=function(t,e){var o=cc.sys.localStorage.getItem("sfkqlhgvideoId");null!=o&&""!==o&&null!=o?this.recorder.publishVideo({video:o,callback:function(t){null!=t&&null!=t||e&&(cc.sys.localStorage.setItem("sfkqlhgvideoId",""),e())}}):e("\u8fd8\u6ca1\u6709\u5206\u4eab\u7684\u5185\u5bb9")},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.showInsertAd=function(t,e){e&&e()},t.prototype.showVideoAd=function(t,e,o){var i=this,n=this,a=function t(e){console.log(e),o&&o(),n.rewardedVideoAd.offError(t),n.rewardedVideoAd.offClose(r),n.rewardedVideoAd.offCompleted(s)},r=function t(e){console.info("RewardedVideo onClose"+e),o&&o(),n.rewardedVideoAd.offError(a),n.rewardedVideoAd.offClose(t),n.rewardedVideoAd.offCompleted(s)},s=function t(i){console.log("res:=======>",i),i&&2002==i.code||void 0===i?(console.log("\u6210\u529f\u56de\u8c03"),e&&setTimeout(function(){e()},500)):(console.log("\u5931\u8d25\u56de\u8c03"),o&&setTimeout(function(){o()},500)),n.rewardedVideoAd.offError(a),n.rewardedVideoAd.offClose(r),n.rewardedVideoAd.offCompleted(t)};this.rewardedVideoAd.onError(a),this.rewardedVideoAd.onClose(r),this.rewardedVideoAd.onCompleted(s),this.rewardedVideoAd.show().catch(function(){i.rewardedVideoAd.load().then(function(){return i.rewardedVideoAd.show()}).catch(function(t){console.log("\u6fc0\u52b1\u89c6\u9891 \u5e7f\u544a\u663e\u793a\u5931\u8d25",t)})})},t.prototype.otherFun=function(){},t.prototype.homeToBackgroud=function(){},t.prototype.backgroudToHome=function(){},t.prototype.openNotify=function(){},t.prototype.registerNotify=function(){},t.prototype.deleteNotify=function(){},t.prototype.shark=function(){},t.prototype.openShare=function(){},t.prototype.recordVideo=function(){this.recorder=ks.getGameRecorder(),this.recorder.on("start",function(){}),this.recorder.on("error",function(){}),this.recorder.start()},t.prototype.stopRecorderManager=function(t,e){this.recorder.on("stop",function(t){t&&t.videoID&&(cc.sys.localStorage.setItem("sfkqlhgvideoId",t.videoID),e&&e(t.videoID))}),this.recorder.stop()},t.prototype.setLanguage=function(){return"CN"},t.prototype.exit=function(){},t}();n.ImplodeManager=a,cc._RF.pop(),cc._RF.pop()},{}],InitCard:[function(t,e,o){"use strict";cc._RF.push(e,"52280pDs9dI8b8WkVtJiMGA","InitCard");var i=t,n=e,a=o;cc._RF.push(n,"52280pDs9dI8b8WkVtJiMGA","InitCard");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCardCtrl"),p=cc._decorator,u=p.ccclass,d=p.menu,h=(p.property,p.requireComponent,p.executeInEditMode),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.start=function(){for(var t,e,o=this.node.getComponents(l.default),i=0;i<o.length;i++){var n=o[i];n.sprBg?t=n:e=n}e.sprBg=t.sprBg,e.sprIcon=t.sprIcon,e.sprPro=t.sprPro,e.lblName=t.lblName,e.lblAtk=t.lblAtk,e.lblStar=t.lblStar,t.destroy(),this.destroy()},c([u,d("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/InitCard"),h],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],InitLab:[function(t,e,o){"use strict";cc._RF.push(e,"a732c7n0epMT7aAZdujx0r1","InitLab");var i=e,n=o;cc._RF.push(i,"a732c7n0epMT7aAZdujx0r1","InitLab");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.menu,u=(c.property,c.requireComponent,c.executeInEditMode),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.start=function(){this.node.scale=.5;var t=this.node.getComponent(cc.Label);t||(t=this.node.addComponent(cc.Label)),t.enableBold=!0;var e=this.node.getComponent(cc.LabelOutline);e||(e=this.node.addComponent(cc.LabelOutline)),e.color=cc.Color.BLACK,e.width=4;var o=this.node.getComponent(cc.LabelShadow);o||(o=this.node.addComponent(cc.LabelShadow)),o.color=cc.Color.BLACK,o.offset=cc.v2(0,-4),o.blur=0,this.destroy()},s([l,p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/InitLabel"),u],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],IosManager:[function(t,e,o){"use strict";cc._RF.push(e,"ac68brqS5pPp5dddhvdjsy2","IosManager");var i=e,n=o;cc._RF.push(i,"ac68brqS5pPp5dddhvdjsy2","IosManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.IosManager=void 0;var a=function(){function t(){}return t.prototype.needDouyVefiy=function(){},t.prototype.interVefiy=function(){},t.prototype.showNative=function(){},t.prototype.hideNative=function(){},t.prototype.showInterNative=function(){},t.prototype.hideInterNative=function(){},t.prototype.showFloatIconAd=function(){},t.prototype.hideFloatIconAd=function(){},t.prototype.canCare=function(){return!1},t.prototype.canShowBtnMore=function(){return!1},t.prototype.canShowEnergyForverVersion=function(){return!0},t.prototype.hasVerify=function(){return!1},t.prototype.initSdk=function(t,e){e&&e(null)},t.prototype.login=function(t,e){e&&e(null)},t.prototype.pay=function(t,e){e&&e(null)},t.prototype.share=function(t,e){e&&e(null)},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.showInsertAd=function(){},t.prototype.showVideoAd=function(){},t.prototype.videoCallback=function(){},t.prototype.toAppStore=function(){},t.prototype.toAppStoreCallback=function(){},t.prototype.otherFun=function(){},t.prototype.shark=function(){},t.prototype.canShare=function(){return!1},t.prototype.recordVideo=function(){},t.prototype.shareVideo=function(){},t.prototype.stopRecorderManager=function(){},t.prototype.setLanguage=function(){return"zh"},t.prototype.initTrack=function(){},t.prototype.youmengTrack=function(){},t.prototype.openNotify=function(){},t.prototype.addNotify=function(){},t.prototype.showGamePortalAd=function(){},t.prototype.initNativeAd=function(){},t.prototype.showNativeAd=function(){},t.prototype.closeNativeAd=function(){},t.prototype.getUserInfo=function(){},t.prototype.shareImg=function(){},t.prototype.addShortcut=function(){},t.prototype.checkShortcut=function(){},t}();n.IosManager=a,cc._RF.pop(),cc._RF.pop()},{}],ItemCardBullt:[function(t,e,o){"use strict";cc._RF.push(e,"c0169QCPtFNFLbjU7KLOFkk","ItemCardBullt");var i=t,n=e,a=o;cc._RF.push(n,"c0169QCPtFNFLbjU7KLOFkk","ItemCardBullt");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=cc._decorator,d=u.ccclass,h=u.property;!function(t){t[t.Normal=0]="Normal",t[t.Wait=1]="Wait",t[t.Dead=2]="Dead"}(l||(l={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e.numKeepTime=.5,e.status=l.Normal,e.tagWpos=cc.v2(),e.ctrParent=null,e.speed=2e3,e.vec_1=cc.v2(),e.vec_2=cc.v2(),e.keeptime=0,e}return s(e,t),e.prototype.initData=function(t,e,o){this.tagWpos=t.clone(),this.ctrParent=e,this.tag=o,this.status=l.Normal,this.vec_1=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),cc.Vec2.subtract(this.vec_2,this.tagWpos,this.vec_1),cc.Vec2.normalize(this.vec_2,this.vec_2);var i=Math.atan2(this.vec_2.y,this.vec_2.x);this.node.angle=180*i/Math.PI-90,this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},e.prototype.onUpdate=function(t){switch(this.status){case l.Normal:this.vec_1=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),cc.Vec2.subtract(this.vec_2,this.tagWpos,this.vec_1);var e=Math.min(this.speed*t,this.vec_2.len());if(0==e)return void this.onWait();cc.Vec2.normalize(this.vec_2,this.vec_2),cc.Vec2.multiplyScalar(this.vec_2,this.vec_2,e),cc.Vec2.add(this.vec_1,this.vec_1,this.vec_2),this.vec_2=this.node.parent.convertToNodeSpaceAR(this.vec_1),this.node.setPosition(this.vec_2);break;case l.Wait:this.keeptime-=t,this.keeptime<=0&&this.onDie()}},e.prototype.onWait=function(){this.status=l.Wait,this.ndBullet.active=!1,this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.stopSystem()}),this.keeptime=this.numKeepTime,this.ctrParent.doAttack(this.tag)},e.prototype.onDie=function(){this.status=l.Dead,this.ctrParent.doAttackEnd(this)},e.prototype.onRelease=function(){this.status=l.Dead,this.node.destroy()},c([h({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),c([h({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),c([h({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),c([h({type:Number,tooltip:"\u7b49\u5f85\u65f6\u95f4"})],e.prototype,"numKeepTime",void 0),c([d],e)}(p.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],ItemCard:[function(t,e,o){"use strict";cc._RF.push(e,"10f41/P4DRLd77kB6aawHIM","ItemCard");var i=t,n=e,a=o;cc._RF.push(n,"10f41/P4DRLd77kB6aawHIM","ItemCard");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.ItemCardStatus=void 0;var l,p=i("BaseCtrl"),u=i("DataMgr"),d=i("PlayerMgr"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("BaseCardCtrl"),g=cc._decorator,y=g.ccclass,v=g.property;!function(t){t[t.None=-2]="None",t[t.Loading=-1]="Loading",t[t.Normal=0]="Normal",t[t.AttackOut=1]="AttackOut",t[t.AttackBack=2]="AttackBack"}(l=a.ItemCardStatus||(a.ItemCardStatus={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBg=null,e.ndInfo=null,e.status=l.None,e.moveSpeed=500,e.moveLen=20,e.moveDown=-15,e.vec_3=cc.v3(0,0,0),e}return s(e,t),e.prototype.init=function(t){switch(this.cardId=t,t){case-2:this.ndBg.children[0].active=!1,this.ndBg.children[1].active=!1,this.ndBg.children[2].active=!0,this.ndInfo.active=!1,this.status=l.None;break;case-1:this.ndBg.children[0].active=!0,this.ndBg.children[1].active=!1,this.ndBg.children[2].active=!1,this.ndInfo.active=!1,this.status=l.None;break;case 0:this.ndBg.children[0].active=!1,this.ndBg.children[1].active=!0,this.ndBg.children[2].active=!1,this.ndInfo.active=!1,this.ctrCard&&(this.ctrCard.node.destroy(),this.ctrCard=null),this.status=l.None;break;default:this.ndBg.children[0].active=!1,this.ndBg.children[1].active=!0,this.ndBg.children[2].active=!1,this.ndInfo.active=!0,this.ndInfo.setPosition(0,this.moveDown),this.initData()}},e.prototype.initData=function(){var t=this;this.starNum=1,this.status=l.Loading;var e=u.DataMgr.getInstance().getCardCfg(this.cardId);this.loadPrefab(h.BraveTowerBundelName.GameCard,e.prafab,function(e){var o=cc.instantiate(e);o.setParent(t.ndInfo),o.setPosition(cc.Vec3.ZERO),o.active=!0,t.ctrCard=o.getComponent(m.default),t.ctrCard.init(t.cardId),t.ctrCard.setLevel(t.starNum),t.ndInfo.scale=[.75,.8125,.875,.9375,1][t.starNum-1],t.status=l.Normal})},e.prototype.updateView=function(){var t;null===(t=this.ctrCard)||void 0===t||t.upData()},e.prototype.addLevel=function(t){var e;void 0===t&&(t=1),this.starNum+=t,null===(e=this.ctrCard)||void 0===e||e.setLevel(this.starNum),this.ndInfo.scale=[.75,.8125,.875,.9375,1][this.starNum-1]},e.prototype.onSell=function(){this.ctrCard.onSell(),this.init(0)},e.prototype.onUpdate=function(t){if(this.status!=l.None&&this.status!=l.Loading)switch(this.ctrCard.onUpdate(t,1),f.default.instance.addCardTime(this.cardId,t),this.ctrCard.skilltime>=this.ctrCard.starInfo.skilltime&&this.ctrCard.doSkillStart(),this.ctrCard.sprPro.fillRange=cc.misc.clamp01(this.ctrCard.skilltime/this.ctrCard.starInfo.skilltime),this.status){case l.Normal:if(this.ctrCard.onUpdate(t,2),this.ctrCard.atktime>=1){var e=f.default.instance.getEnemyByWeight();e&&(this.status=l.AttackOut,this.ctrCard.doAttackStart(e))}break;case l.AttackOut:this.ndInfo.getPosition(this.vec_3),this.vec_3.y+=t*this.moveSpeed,this.vec_3.y>=this.moveLen&&(this.vec_3.y=this.moveLen,this.status=l.AttackBack),this.ndInfo.setPosition(this.vec_3);break;case l.AttackBack:this.ndInfo.getPosition(this.vec_3),this.vec_3.y-=t*this.moveSpeed,this.vec_3.y<=this.moveDown&&(this.vec_3.y=this.moveDown,this.status=l.Normal),this.ndInfo.setPosition(this.vec_3)}},e.prototype.getAttack=function(){var t=u.DataMgr.getInstance().getCardCfg(this.cardId);return d.PlayerMgr.getInstance().getCardAttack(t.id)*(1+t.starAtk[this.starNum-1])},c([v({type:cc.Node,tooltip:"\u7bad\u5934\u8282\u70b9"})],e.prototype,"ndBg",void 0),c([v({type:cc.Node,tooltip:"\u7bad\u5934\u8282\u70b9"})],e.prototype,"ndInfo",void 0),c([y],e)}(p.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],ItemEnemyBase:[function(t,e,o){"use strict";cc._RF.push(e,"1936bekedBMTavSuj68jFKa","ItemEnemyBase");var i=t,n=e,a=o;cc._RF.push(n,"1936bekedBMTavSuj68jFKa","ItemEnemyBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.TimerName=a.Buff=a.State=a.AniName=void 0;var l,p,u,d,h=i("BaseCtrl"),f=i("AudioMgr"),m=i("LogMgr"),g=i("PoolMgr"),y=i("ResourceMgr"),v=i("Config"),_=i("GameEnumData"),b=i("DataMgr"),B=i("BraveTowerEnum"),I=i("GameCtrl"),P=i("ItemHp"),C=cc._decorator,D=C.ccclass,T=C.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprIcon=null,e.ndHp=null,e.ndEffect=null,e.ani=null,e.aniPlay=null,e.buffList=[],e.buffEffectList=[],e.timer={},e.JumpBackSpeed=500,e.vec_3=cc.v3(),e.tagList=[],e.moveSpeed=0,e}return s(e,t),e.prototype.onLoad=function(){this.ani=this.node.getComponent(cc.Animation)},e.prototype.initData=function(t,e,o){var i=this;this.state=p.move,this.aniPlay=this.ani.play(l.move),this.aniPlay.speed=I.default.instance.getSpeed(),this.cfg=b.DataMgr.getInstance().getEnemyCfg(t),this.upMoveSpeed(),this.attackNum=this.cfg.atk*o,this.hpMax=this.cfg.hp*e,this.hp=this.hpMax,this.buffList=[],this.node.scale=this.cfg.size,this.cfg.isBoss?(this.hpctrl=I.default.instance.ctrUI.getBossHp(),this.hpctrl.setHp(this.hp,this.hpMax),this.hpctrl.setShow(!0)):this.hpctrl?this.hpctrl.setHp(this.hp,this.hpMax):y.ResourceMgr.getInstance().getNode(B.BraveTowerPoolName.ItemHp,B.BraveTowerBundelName.Enemy,"ItemHp",function(t){t.setParent(i.ndHp),t.active=!0,t.setPosition(cc.Vec3.ZERO);var e=t.getComponent(P.ItemHp);if(!e)return console.error("ItemHp\u7ec4\u4ef6\u4e0d\u5b58\u5728"),void t.destroy();i.hpctrl=e,i.hpctrl.setHp(i.hp,i.hpMax)})},e.prototype.onUpdate=function(t){for(var e=0;e<this.buffList.length;e++){if((r=this.buffList[e]).type==u.vertigo){var o=r.data;-1!=o.timeMax&&(o.time+=t,o.time>=o.timeMax&&(this.onBuffDam(o.attNum),o.time=0))}r.type==u.jumpBack&&r.data<=0?(this.buffList.splice(e,1),e--):-1!=r.time&&(r.time-=t,r.time<=0&&(this.delBuff(r.type),e--))}var i=this.getBuff(u.jumpBack);if(i&&i.data>0&&(this.node.getPosition(this.vec_3),this.vec_3.y+=this.JumpBackSpeed*t,i.data-=this.JumpBackSpeed*t,this.node.setPosition(this.vec_3)),!this.getBuff(u.stun)&&!i)switch(this.state){case p.move:var n=1,a=this.getBuffList(u.slow);for(e=0;e<a.length;e++){var r=a[e];n-=Number.isNaN(r.data)?0:r.data}n<0&&(n=0);var s=this.moveSpeed*n;this.node.getPosition(this.vec_3);var c=this.vec_3.y;this.vec_3.y-=s*t,Number.isNaN(this.vec_3.y)?this.vec_3.y=c:this.node.setPosition(this.vec_3),this.vec_3.y-this.cfg.attLen<=B.BraveTowerParameter.BaseY&&(this.vec_3.y=B.BraveTowerParameter.BaseY+this.cfg.attLen,this.node.setPosition(this.vec_3),this.doAttack());break;case p.wait:this.timer[d.attackInterval]+=t*this.cfg.attSpeed,this.timer[d.attackInterval]>=1&&this.doAttack();break;case p.dead:this.onFree()}},e.prototype.getWpos=function(){return this.node.convertToWorldSpaceAR(cc.Vec2.ZERO)},e.prototype.onAttackEnd=function(){this.state!=p.dead&&(this.aniPlay=this.ani.play(l.idel),this.aniPlay.speed=I.default.instance.getSpeed(),this.state=p.wait)},e.prototype.addTag=function(t){this.tagList.push(t)},e.prototype.onAttacked=function(t,e){var o;f.AudioMgr.getInstance().playEffectFree(v.AudioId.strike,1,5);for(var i=0;i<this.tagList.length;i++)if(this.tagList[i]==e){this.tagList.splice(i,1);break}var n=t,a=1,r=this.getBuff(u.vertigo);r&&(a+=r.data.sum*r.data.addNum[1]);var s=this.getBuffList(u.weak);for(i=0;i<s.length;i++)a+=s[i].data;var c=I.default.instance.gameBuff.getBuff(_.BraveTowerEnumBuffID.BuffID55);c&&this.getBuff(u.stun)&&I.default.instance.gameTrammel.getTies(_.BraveTowerEnumTiesCfg.Ties07)&&(a+=c.value[0]);var l=I.default.instance.gameBuff.getBuff(_.BraveTowerEnumBuffID.BuffID59);return l&&this.getBuff(u.slow)&&I.default.instance.gameTrammel.getTies(_.BraveTowerEnumTiesCfg.Ties09)&&(a+=l.value[0]),this.hp-=n*a,this.hp<=0&&(this.hp=0),null===(o=this.hpctrl)||void 0===o||o.setHp(this.hp,this.hpMax),0==this.hp&&this.onDead(),n*a},e.prototype.onBuffDam=function(t){var e;I.default.instance.ctrEffect.showDamageNum(this.getWpos(),t,0),this.hp-=t,this.hp<=0&&(this.hp=0),null===(e=this.hpctrl)||void 0===e||e.setHp(this.hp,this.hpMax),0==this.hp&&this.onDead()},e.prototype.onDead=function(t){void 0===t&&(t=!1),this.state=p.dead,this.tagList=[];for(var e=0;e<this.buffList.length;e++)if((o=this.buffList[e]).node)switch(o.type){case u.stun:g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.EffectStunName,o.node);break;case u.slow:g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.EffectSlowName,o.node)}for(this.buffList=[],e=0;e<this.buffEffectList.length;e++){var o;if((o=this.buffEffectList[e]).node)switch(o.type){case u.stun:g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.EffectStunName,o.node);break;case u.slow:g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.EffectSlowName,o.node)}}this.buffEffectList=[],this.hpctrl&&(this.cfg.isBoss?I.default.instance.ctrUI.freeBossHp(this.hpctrl):g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.ItemHp,this.hpctrl.node)),this.hpctrl=null,t||(I.default.instance.ctrEffect.showEnemyDie(this.getWpos()),I.default.instance.addEx(this.cfg.ProduceExperience))},e.prototype.onFree=function(){I.default.instance.gameData.delEnemy(this);var t=B.BraveTowerPoolName.EnemyName+"_"+this.cfg.id;g.PoolMgr.getInstance().freeNode(t,this.node)},e.prototype.onRelease=function(){this.onDead(!0);var t=B.BraveTowerPoolName.EnemyName+"_"+this.cfg.id;g.PoolMgr.getInstance().freeNode(t,this.node)},e.prototype.getDamger=function(){for(var t=this.cfg.atk,e=1,o=this.getBuffList(u.damageDown),i=0;i<o.length;i++)e-=o[i].data;var n=this.getBuff(u.damageDown2);n&&(e-=n.data);var a=this.getBuff(u.damageDown3);return a&&(e-=a.data),(t=Math.floor(t*e))<0&&(t=0),t},e.prototype.getGold=function(){return this.cfg.ProduceSilverCoin},e.prototype.canFind=function(){return this.state!=p.dead},e.prototype.canAttack=function(t){if(this.state==p.dead)return!1;for(var e=!0,o=0;o<this.tagList.length;o++)if(this.tagList[o]==t){e=!1;break}return!e},e.prototype.isDead=function(){return!cc.isValid(this)||this.state==p.dead},e.prototype.onSpeedChange=function(){this.aniPlay.speed=I.default.instance.getSpeed()},e.prototype.upMoveSpeed=function(){for(var t=this.cfg.moveSpeed,e=1,o=I.default.instance.gameBuff.getBuffList(_.BraveTowerEnumBuffType.BuffType04),i=0;i<o.length;i++)e-=o[i].value[0];(e=Math.max(e,.1))<1&&I.default.instance.ctrEffect.showSlow(this,function(t){g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.EffectSlowName,t)}),this.moveSpeed=t*e,m.LogMgr.getInstance().debug("\u79fb\u52a8\u901f\u5ea6---\u300b",this.moveSpeed)},e.prototype.onPauseAni=function(){this.ani.pause()},e.prototype.onResumeAni=function(){this.ani.resume()},e.prototype.addBuff=function(t,e,o){var i=this;if(this.state!=p.dead){var n=this.getBuff(t);switch(t){case u.stun:var a=I.default.instance.gameTrammel.getTies(_.BraveTowerEnumTiesCfg.Ties07),r=I.default.instance.gameBuff.getBuff(_.BraveTowerEnumBuffID.BuffID55);a&&r&&(e*=1+r.value[0]),n?n.time=Math.max(n.time,e):(this.buffList.push({type:t,time:e}),I.default.instance.ctrEffect.showStun(this,function(e){i.setBuff(t,e)}));break;case u.slow:n||I.default.instance.ctrEffect.showSlow(this,function(e){i.setBuff2(t,e)}),this.buffList.push({type:t,time:e,data:o});break;case u.weak:case u.damageDown:this.buffList.push({type:t,time:e,data:o});break;case u.damageDown2:case u.damageDown3:n||this.buffList.push({type:t,time:e,data:o});break;case u.jumpBack:this.cfg.isBoss||(n?n.data=o:this.buffList.push({type:t,time:e,data:o}));break;case u.vertigo:var s=void 0;if(n?(s=n.data.sum,n.data.sum+=o.addNum[0],n.data.buff=o.buff):(s=0,n={type:t,time:e,data:{sum:o.addNum[0],addNum:o.addNum,buff:o.buff,time:0,timeMax:o.timeMax,attNum:o.attNum}},this.buffList.push(n)),n.data.buff)for(var c=s+1;c<=n.data.sum;c++)c%n.data.buff[0]==0&&this.addBuff(u.stun,n.data.buff[1])}}},e.prototype.getBuff=function(t){for(var e=0;e<this.buffList.length;e++){var o=this.buffList[e];if(o.type==t)return o}return null},e.prototype.getBuffList=function(t){for(var e=[],o=0;o<this.buffList.length;o++){var i=this.buffList[o];i.type==t&&e.push(i)}return e},e.prototype.setBuff=function(t,e){var o=this.getBuff(t);o?o.node=e:e.destroy()},e.prototype.setBuff2=function(t,e){for(var o=!0,i=0;i<this.buffEffectList.length;i++){var n=this.buffEffectList[i];if(n.type==t){n.node=e,o=!1;break}}o&&this.buffEffectList.push({type:t,node:e})},e.prototype.delBuff=function(t){for(var e=!1,o=0;o<this.buffList.length;o++)if((i=this.buffList[o]).type==t){switch(t){case u.stun:i.node&&g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.EffectStunName,i.node);break;case u.slow:e=!0}this.buffList.splice(o,1);break}if(e&&0==this.getBuffList(u.slow).length)for(o=0;o<this.buffEffectList.length;o++){var i;if((i=this.buffEffectList[o]).type==t){i.node&&g.PoolMgr.getInstance().freeNode(B.BraveTowerPoolName.EffectSlowName,i.node);break}}},c([T({type:cc.Sprite,tooltip:"\u602a\u7269\u56fe\u50cf"})],e.prototype,"sprIcon",void 0),c([T({type:cc.Node,tooltip:"\u8840\u6761\u8282\u70b9"})],e.prototype,"ndHp",void 0),c([T({type:cc.Node,tooltip:"\u7279\u6548\u8282\u70b9"})],e.prototype,"ndEffect",void 0),c([D],e)}(h.default);a.default=S,function(t){t.move="move",t.idel="idel",t.attack="attack",t.vertigo="vertigo"}(l=a.AniName||(a.AniName={})),function(t){t[t.move=0]="move",t[t.wait=1]="wait",t[t.attack=2]="attack",t[t.dead=3]="dead"}(p=a.State||(a.State={})),function(t){t[t.stun=0]="stun",t[t.slow=1]="slow",t[t.vertigo=2]="vertigo",t[t.weak=3]="weak",t[t.damageDown=4]="damageDown",t[t.damageDown2=5]="damageDown2",t[t.damageDown3=6]="damageDown3",t[t.jumpBack=7]="jumpBack"}(u=a.Buff||(a.Buff={})),(d=a.TimerName||(a.TimerName={})).attackInterval="attackInterval",cc._RF.pop(),cc._RF.pop()},{}],ItemEnemyBoss:[function(t,e,o){"use strict";cc._RF.push(e,"40a1cLNRz1CwbNJ7trwNqdq","ItemEnemyBoss");var i=t,n=e,a=o;cc._RF.push(n,"40a1cLNRz1CwbNJ7trwNqdq","ItemEnemyBoss");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("GameCtrl"),p=i("ItemEnemyBase"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initData=function(e,o,i){t.prototype.initData.call(this,e,o,i),this.node.getChildByName("ndLen").active=!1,this.node.getChildByName("ndLen").height=this.cfg.attLen},e.prototype.doAttack=function(){this.state=p.State.attack,this.aniPlay=this.ani.play(p.AniName.attack),this.aniPlay.speed=l.default.instance.getSpeed(),this.timer[p.TimerName.attackInterval]=0,l.default.instance.doEnemyAttack(this.getDamger(),1)},c([d],e)}(p.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],ItemEnemy:[function(t,e,o){"use strict";cc._RF.push(e,"f44c5l2UBpJC6iy0bRkkzfv","ItemEnemy");var i=t,n=e,a=o;cc._RF.push(n,"f44c5l2UBpJC6iy0bRkkzfv","ItemEnemy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("GameCtrl"),p=i("ItemEnemyBase"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initData=function(e,o,i){t.prototype.initData.call(this,e,o,i),this.node.getChildByName("ndLen").active=!1,this.node.getChildByName("ndLen").height=this.cfg.attLen},e.prototype.doAttack=function(){this.state=p.State.attack,this.aniPlay=this.ani.play(p.AniName.attack),this.aniPlay.speed=l.default.instance.getSpeed(),this.timer[p.TimerName.attackInterval]=0,l.default.instance.doEnemyAttack(this.getDamger(),1)},c([d],e)}(p.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],ItemGood:[function(t,e,o){"use strict";cc._RF.push(e,"0918c3g0TlGeZy3WEFMHwa6","ItemGood");var i=t,n=e,a=o;cc._RF.push(n,"0918c3g0TlGeZy3WEFMHwa6","ItemGood");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("DataMgr"),u=i("BraveTowerEnum"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndLight=null,e.sprBg=null,e.sprIcon=null,e.labNum=null,e}return s(e,t),e.prototype.start=function(){u.BraveTowerGameUtils.aniAngle(this.ndLight)},e.prototype.initView=function(t,e,o){var i=this;void 0===o&&(o=!1);var n=p.DataMgr.getInstance().getGoodsCfgById(t);this.loadSpriteFrame(u.BraveTowerBundelName.Icon,n.sprBg,function(t){i.sprBg.spriteFrame=t}),this.loadSpriteFrame(u.BraveTowerBundelName.Icon,n.icon,function(t){i.sprIcon.spriteFrame=t}),-1==e?this.labNum.node.active=!1:(this.labNum.node.active=!0,this.labNum.string=u.BraveTowerGameUtils.numberFomat(e)),this.ndLight.active=!!o},c([f({type:cc.Node,tooltip:"\u5149"})],e.prototype,"ndLight",void 0),c([f({type:cc.Sprite,tooltip:"\u80cc\u666f"})],e.prototype,"sprBg",void 0),c([f({type:cc.Sprite,tooltip:"\u56fe\u6807"})],e.prototype,"sprIcon",void 0),c([f({type:cc.Label,tooltip:"\u6570\u91cf"})],e.prototype,"labNum",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],ItemHp:[function(t,e,o){"use strict";cc._RF.push(e,"1d9e61aLuxCdJ/4unAXKHnV","ItemHp");var i=t,n=e,a=o;cc._RF.push(n,"1d9e61aLuxCdJ/4unAXKHnV","ItemHp");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.ItemHp=void 0;var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndHp=null,e.sprProTop=null,e}return s(e,t),e.prototype.setHp=function(t,e){this.sprProTop.fillRange=cc.misc.clamp01(t/e),this.ndHp.active=0!=t&&t!=e},e.prototype.setShow=function(t){this.ndHp.active=t},c([d(cc.Node)],e.prototype,"ndHp",void 0),c([d(cc.Sprite)],e.prototype,"sprProTop",void 0),c([u("ItemHp")],e)}(l.default);a.ItemHp=h,cc._RF.pop(),cc._RF.pop()},{}],KSManager:[function(t,e,o){"use strict";cc._RF.push(e,"d401aN+AipKmZRsb6z0GhKk","KSManager");var i=t,n=e,a=o;cc._RF.push(n,"d401aN+AipKmZRsb6z0GhKk","KSManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.KSManager=void 0;var r=i("BasePlatform"),s=i("PlatformConfig"),c=i("PlatformSetting"),l=function(){function t(){this.hasAd=!0,this.hasBanner=!0,this.hasInsertAd=!0,this.hasVideoAd=!0}return t.prototype.youmengRevenue=function(){},t.prototype.pauseRecord=function(){},t.prototype.resumeRecord=function(){},t.prototype.verifyKey=function(){},t.prototype.getSceneId=function(){},t.prototype.setStorage=function(){},t.prototype.getStorage=function(){return null},t.prototype.closeNativeAd=function(){},t.prototype.hasVerify=function(){return!1},t.prototype.toAppStore=function(){},t.prototype.addNotify=function(){},t.prototype.needDouyVefiy=function(){},t.prototype.interVefiy=function(){},t.prototype.showNative=function(){},t.prototype.hideNative=function(){},t.prototype.showInterNative=function(){},t.prototype.hideInterNative=function(){},t.prototype.canShowBtnMore=function(){return!1},t.prototype.canShowEnergyForverVersion=function(){return!0},t.prototype.shareVideo=function(){},t.prototype.showFloatIconAd=function(){},t.prototype.hideFloatIconAd=function(){},t.prototype.canCare=function(){return!1},t.prototype.initSdk=function(){var t=s.AdConfig[c.PlatformSetting.currentApp][r.Platform.KuaiShou].videoId;this.rewardedVideoAd=ks.createRewardedVideoAd({adUnitId:t,multiton:!0,multitonRewardMsg:["\u94bb\u77f3x10"],multitonRewardTimes:1,progressTip:!1}),this.systemInfo=ks.getSystemInfoSync()},t.prototype.canShare=function(){return!1},t.prototype.initTrack=function(){},t.prototype.getUserInfo=function(t){ks.login({success:function(e){console.log("\u767b\u5f55\u6210\u529f:"+JSON.stringify(e)),ks.authorize({scope:"scope.userInfo",success:function(){ks.getUserInfo({success:function(e){e?t(e.userName,e.userHead):t(null,null),console.log("head"+JSON.stringify(e.userHead))},fail:function(e){t(null,null),console.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25: "+JSON.stringify(e))},complete:function(){}})},fail:function(e){t(null,null),console.log("\u6388\u6743\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25: "+JSON.stringify(e))},complete:function(){}})},fail:function(e){console.log("\u767b\u5f55\u5931\u8d25:"+JSON.stringify(e)),t(null,null)}})},t.prototype.getSystemInfo=function(){return this.systemInfo},t.prototype.shareImg=function(t){console.log("\u5206\u4eab"),ks.shareAppMessage({success:function(e){console.log("\u5206\u4eab\u6210\u529f",e),t&&t()},fail:function(){},complete:function(){}})},t.prototype.follow=function(){},t.prototype.showGamePortalAd=function(){},t.prototype.addShortcut=function(t,e){ks.addShortcut({success:function(){e&&(e(!0),console.log("\u6dfb\u52a0\u684c\u9762\u6210\u529f"))},fail:function(t){-10005===t.code?console.log("\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd"):e&&(e("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u5931\u8d25"),console.log("\u6dfb\u52a0\u684c\u9762\u5931\u8d25",t.msg))}})},t.prototype.checkShortcut=function(t,e){ks.checkShortcut({success:function(t){console.log("\u662f\u5426\u5df2\u6dfb\u52a0\u5feb\u6377\u65b9\u5f0f",t.installed),t.installed?e&&e(!0):e&&e(!1)},fail:function(t){-10005===t.code?(e&&e(!0),console.log("\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd")):e&&(console.log("\u68c0\u67e5\u5feb\u6377\u65b9\u5f0f\u5931\u8d25",t.msg),e(!0))}})},t.prototype.gameVersion=function(){return"1.0.3"},t.prototype.insertAdSwitchVersion=function(){return 7},t.prototype.caidanSwitchVersion=function(){return 2},t.prototype.initNativeAd=function(){},t.prototype.showNativeAd=function(){},t.prototype.youmengTrack=function(t,e,o){sfdata.SfTrackData.instance.trackEvent(t,e,o),ks.uma&&(e&&o?"userA"==e?ks.uma.trackEvent(t,{userA:o}):"userB"==e?ks.uma.trackEvent(t,{userB:o}):"userC"==e?ks.uma.trackEvent(t,{userC:o}):"userD"==e&&ks.uma.trackEvent(t,{userD:o}):ks.uma.trackEvent(t))},t.prototype.goToSuperXiuXian=function(){},t.prototype.showBlockAd=function(){},t.prototype.hideBlockAd=function(){},t.prototype.login=function(){},t.prototype.pay=function(){},t.prototype.share=function(t,e){var o=localStorage.getItem("sfkqlhgvideoId");null!=o&&""!==o&&null!=o?this.recorder.publishVideo({video:o,callback:function(t){null!=t&&null!=t||e&&(localStorage.setItem("sfkqlhgvideoId",""),e())}}):e("\u8fd8\u6ca1\u6709\u5206\u4eab\u7684\u5185\u5bb9")},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.showInsertAd=function(t,e){e&&e()},t.prototype.showVideoAd=function(t,e,o){var i=this,n=function(t){console.log(t),o&&o()};this.rewardedVideoAd.onError(n),this.rewardedVideoAd.onClose(function t(a){a&&a.isEnded||void 0===a?(a.count?1==a.count?console.log("\u53ea\u770b\u4e00\u6b21"):console.log("\u770b\u4e86\u4e24\u6b21"):console.log("\u600e\u4e48\u627e\u4e0d\u5230"),console.log("\u5feb\u624b\u76f4\u6295\u56de\u8c03"),sfks.IKsSDK.instance.incidentReturn(),e&&e()):o&&o(),i.rewardedVideoAd.offError(n),i.rewardedVideoAd.offClose(t)}),this.rewardedVideoAd.show().then(function(){return console.log("\u6fc0\u52b1\u89c6\u9891 \u5e7f\u544a\u663e\u793a")})},t.prototype.otherFun=function(){},t.prototype.homeToBackgroud=function(){},t.prototype.backgroudToHome=function(){},t.prototype.openNotify=function(){},t.prototype.registerNotify=function(){},t.prototype.deleteNotify=function(){},t.prototype.shark=function(){},t.prototype.openShare=function(){},t.prototype.recordVideo=function(){this.recorder=ks.getGameRecorder(),this.recorder.on("start",function(){}),this.recorder.on("error",function(){}),this.recorder.start()},t.prototype.stopRecorderManager=function(t,e){this.recorder.on("stop",function(t){t&&t.videoID&&(localStorage.setItem("sfkqlhgvideoId",t.videoID),e&&e(t.videoID))}),this.recorder.stop()},t.prototype.setLanguage=function(){return"CN"},t.prototype.exit=function(){},t.prototype.checkCanOpenSideBar=function(t){ks.checkCommonUse?ks.checkCommonUse({success:function(e){console.log("\u8bbe\u4e3a\u5e38\u7528\u67e5\u8be2\u7ed3\u679c\u4e3a\uff1a"+e.isCommonUse),t(e.isCommonUse)},fail:function(e){-10005===e.code?console.log("\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd"):(t(!1),console.log("\u8bbe\u4e3a\u5e38\u7528\u67e5\u8be2\u5931\u8d25",e.msg))}}):(console.log("\u627e\u4e0d\u5230API"),t(!1))},t.prototype.openSideBar=function(t){ks.addCommonUse?ks.addCommonUse({success:function(){console.log("\u6dfb\u52a0\u4fa7\u8fb9\u680f\u6210\u529f"),t&&t(!0)},fail:function(e){-10005===e.code&&console.log("\u6682\u4e0d\u652f\u6301\u8be5\u529f\u80fd",e),console.log("\u8bbe\u4e3a\u5e38\u7528\u5931\u8d25",e.msg),t&&t(!1)}}):(console.log("\u6ca1\u6709\u627e\u5230API"),t&&t(!1))},t}();a.KSManager=l,cc._RF.pop(),cc._RF.pop()},{}],LabelPlus:[function(t,e,o){"use strict";cc._RF.push(e,"80a9cOuqOFHQLCOKoZabFcU","LabelPlus");var i=e,n=o;cc._RF.push(i,"80a9cOuqOFHQLCOKoZabFcU","LabelPlus");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.start=function(){},s([l],e)}(cc.Label));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],LanguageMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a4129gp1IZPuLMnmeyFSgVu","LanguageMgr");var i=t,n=e,a=o;cc._RF.push(n,"a4129gp1IZPuLMnmeyFSgVu","LanguageMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.LanguageMgr=void 0;var r=i("DataMgr"),s=i("Appcfg"),c=function(){function t(){this.currentLan=s.LanguageType.zh}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.setCurrentLanguage=function(t){this.currentLan=t},t.prototype.getCurrentLanguage=function(){return this.currentLan},t.prototype.getImgstr=function(t){var e=this.currentLan;return e==s.LanguageType.en?t+"-y":e==s.LanguageType.jp?t+"-r":e==s.LanguageType.zh_tw?t+"-f":t},t.prototype.T=function(t){return r.DataMgr.getInstance().T(t,this.currentLan)},t}();a.LanguageMgr=c,cc._RF.pop(),cc._RF.pop()},{}],ListItem:[function(t,e,o){"use strict";cc._RF.push(e,"91fcdIYRxBK0bbIvoQydoMe","ListItem");var i=e,n=o;cc._RF.push(i,"91fcdIYRxBK0bbIvoQydoMe","ListItem");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c,l=cc._decorator,p=l.ccclass,u=l.property,d=l.disallowMultiple,h=l.menu,f=l.executionOrder;!function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"}(c||(c={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=c.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return r(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case c.TOGGLE:this.selectedFlag.active=t;break;case c.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this.selectedMode==c.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},e.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,o){if(void 0===o&&(o=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var i=new cc.Component.EventHandler;return i.target=o||t.node,i.component=t.comName,i.handler=e,i}},e.prototype.showAni=function(t,e,o){var i,n=this;switch(t){case 0:i=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{y:2*n.node.height});break;case 1:i=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{x:2*n.node.width});break;case 2:i=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{y:-2*n.node.height});break;case 3:i=cc.tween(n.node).to(.2,{scale:.7}).by(.3,{x:-2*n.node.width});break;default:i=cc.tween(n.node).to(.3,{scale:.1})}(e||o)&&i.call(function(){if(o){n.list._delSingleItem(n.node);for(var t=n.list.displayData.length-1;t>=0;t--)if(n.list.displayData[t].id==n.listId){n.list.displayData.splice(t,1);break}}e()}),i.start()},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},s([u({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),s([u({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),s([u({type:cc.Enum(c),tooltip:!1})],e.prototype,"selectedMode",void 0),s([u({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],e.prototype,"selectedFlag",void 0),s([u({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==c.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),s([u({tooltip:!1})],e.prototype,"adaptiveSize",void 0),s([p,d(),h("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),f(-5001)],e)}(cc.Component);n.default=m,cc._RF.pop(),cc._RF.pop()},{}],List:[function(t,e,o){"use strict";cc._RF.push(e,"1896anh1MNKtpXpHYMe5dn5","List");var i=t,n=e,a=o;cc._RF.push(n,"1896anh1MNKtpXpHYMe5dn5","List");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p,u,d=cc._decorator,h=d.ccclass,f=d.property,m=d.disallowMultiple,g=d.menu,y=d.executionOrder,v=d.requireComponent,_=i("ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(l||(l={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(p||(p={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(u||(u={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=l.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=p.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=u.NONE,e.repeatEventSingle=!1,e.selectedEvent=new cc.Component.EventHandler,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return s(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,o=this;switch(o.selectedMode){case u.SINGLE:if(!o.repeatEventSingle&&t==o._selectedId)return;e=o.getItemByListId(t);var i=void 0;if(o._selectedId>=0?o._lastSelectedId=o._selectedId:o._lastSelectedId=null,o._selectedId=t,e&&((i=e.getComponent(_.default)).selected=!0),o._lastSelectedId>=0&&o._lastSelectedId!=o._selectedId){var n=o.getItemByListId(o._lastSelectedId);n&&(n.getComponent(_.default).selected=!1)}o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],e,t%this._actualNumItems,null==o._lastSelectedId?null:o._lastSelectedId%this._actualNumItems);break;case u.MULT:if(!(e=o.getItemByListId(t)))return;i=e.getComponent(_.default),o._selectedId>=0&&(o._lastSelectedId=o._selectedId),o._selectedId=t;var a=!i.selected;i.selected=a;var r=o.multSelected.indexOf(t);a&&r<0?o.multSelected.push(t):!a&&r>=0&&o.multSelected.splice(r,1),o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],e,t%this._actualNumItems,null==o._lastSelectedId?null:o._lastSelectedId%this._actualNumItems,a)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=p.PAGE||(e.curPageNum=e.nearestListId);else{e.cyclic&&(e._resizeContent(),e._numItems=e._cyclicNum*e._numItems);var o=e.content.getComponent(cc.Layout);if(o&&(o.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var i=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,n=0;n<i;n++)e._createOrUpdateItem2(n);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(n=0;n<e._numItems;n++)e._createOrUpdateItem2(n);e.displayItemNum=e._numItems}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){var t=this;cc.isValid(t._itemTmp)&&t._itemTmp.destroy(),cc.isValid(t.tmpNode)&&t.tmpNode.destroy(),t._pool&&t._pool.clear()},e.prototype.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==l.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=p.ADHERING&&t._slideMode!=p.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var o=e-1;e=o*o*o*o*o+1}var i=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),n=this._scrollView.getScrollEndedEventTiming(),a=Math.abs(e-1)<=n;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),a&&(this._scrollView._autoScrolling=!1);var r=i.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(r),a),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var o=t.getComponent(_.default),i=!1;switch(o||(i=!0),i&&(e.selectedMode=u.NONE),(o=t.getComponent(cc.Widget))&&o.enabled&&(e._needUpdateWidget=!0),e.selectedMode==u.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var n=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((n+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var a=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((a+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var o=e._getFixedSize(null);t=e._leftGap+o.val+e._itemSize.width*(e._numItems-o.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e._customSize?(o=e._getFixedSize(null),t=e._topGap+o.val+e._itemSize.height*(e._numItems-o.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*i+e._lineGap*(i-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var n=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*n+e._columnGap*(n-1)+e._rightGap}}var a=e.content.getComponent(cc.Layout);if(a&&(a.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var r=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,r-=e._cyclicPos1,e._cyclicNum=Math.ceil(r/e._allItemSizeNoEdge)+1;var s=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+s,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+s*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=s*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var c=e._lack&&e.lackCenter||!e.lackSlide?.1:0,l=e._lack?(e._sizeType?e.node.height:e.node.width)-c:e.cyclic?e._cyclicAllItemSize:e._allItemSize;l<0&&(l=0),e._sizeType?e.content.height=l:e.content.width=l},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var o=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),i=this._sizeType?cc.v2(0,o):cc.v2(o,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)))}}var n,a,r,s;if(this._calcViewPos(),this._sizeType?(n=this.viewTop,r=this.viewBottom):(a=this.viewRight,s=this.viewLeft),this._virtual){this.displayData=[];var c=void 0,l=0,p=this._numItems-1;if(this._customSize)for(var u=!1;l<=p&&!u;l++)switch(c=this._calcItemPos(l),this._align){case cc.Layout.Type.HORIZONTAL:c.right>=s&&c.left<=a?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.Type.VERTICAL:c.bottom<=n&&c.top>=r?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:c.bottom<=n&&c.top>=r?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.AxisDirection.VERTICAL:c.right>=s&&c.left<=a?this.displayData.push(c):0!=l&&this.displayData.length>0&&(u=!0)}}else{var d=this._itemSize.width+this._columnGap,h=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:l=(s-this._leftGap)/d,p=(a-this._leftGap)/d;break;case 2:l=(-a-this._rightGap)/d,p=(-s-this._rightGap)/d;break;case 3:l=(-n-this._topGap)/h,p=(-r-this._topGap)/h;break;case 4:l=(r-this._bottomGap)/h,p=(n-this._bottomGap)/h}for(l=Math.floor(l)*this._colLineNum,p=Math.ceil(p)*this._colLineNum,l<0&&(l=0),--p>=this._numItems&&(p=this._numItems-1);l<=p;l++)this.displayData.push(this._calcItemPos(l))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var f=this._lastDisplayData.length,m=this.displayItemNum!=f;if(m&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(t,e){return t-e}),m=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[f-1]),this._forceUpdate||m)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var g=0;g<this.displayItemNum;g++)this._createOrUpdateItem(this.displayData[g]);this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,o,i,n,a,r,s,c;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var l=this._getFixedSize(t);a=this._leftGap+(this._itemSize.width+this._columnGap)*(t-l.count)+(l.val+this._columnGap*l.count),e=(p=this._customSize[t])>0?p:this._itemSize.width}else a=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return this.lackCenter&&(a-=this._leftGap,a+=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,left:a,right:r=a+e,x:a+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(l=this._getFixedSize(t),r=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-l.count)-(l.val+this._columnGap*l.count),e=(p=this._customSize[t])>0?p:this._itemSize.width):(r=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),this.lackCenter&&(r+=this._rightGap,r-=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,right:r,left:a=r-e,x:a+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(l=this._getFixedSize(t),i=-this._topGap-(this._itemSize.height+this._lineGap)*(t-l.count)-(l.val+this._lineGap*l.count),o=(p=this._customSize[t])>0?p:this._itemSize.height):(i=-this._topGap-(this._itemSize.height+this._lineGap)*t,o=this._itemSize.height),this.lackCenter&&(i+=this._topGap,i-=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:i,bottom:n=i-o,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*o};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var p;return this._customSize?(l=this._getFixedSize(t),n=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-l.count)+(l.val+this._lineGap*l.count),o=(p=this._customSize[t])>0?p:this._itemSize.height):(n=this._bottomGap+(this._itemSize.height+this._lineGap)*t,o=this._itemSize.height),this.lackCenter&&(n-=this._bottomGap,n+=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:i=n+o,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*o}}case cc.Layout.Type.GRID:var u=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c=(n=(i=-this._topGap-(this._itemSize.height+this._lineGap)*u)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:i=(n=this._bottomGap+(this._itemSize.height+this._lineGap)*u)+this._itemSize.height,c=n+this._itemTmp.anchorY*this._itemSize.height}switch(s=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:s+=this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s+=(1-this._itemTmp.anchorX)*this._itemSize.width,s-=(1-this.content.anchorX)*this.content.width,s*=-1}return{id:t,top:i,bottom:n,x:s,y:c};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:r=(a=this._leftGap+(this._itemSize.width+this._columnGap)*u)+this._itemSize.width,s=a+this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s=(a=(r=-this._rightGap-(this._itemSize.width+this._columnGap)*u)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,s+=(1-this.content.anchorX)*this.content.width}switch(c=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c-=(1-this._itemTmp.anchorY)*this._itemSize.height,c+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:c-=this._itemTmp.anchorY*this._itemSize.height,c+=this.content.anchorY*this.content.height,c*=-1}return{id:t,left:a,right:r,x:s,y:c}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var o={id:t,x:e.x,y:e.y};return this._sizeType?(o.top=e.y+e.height*(1-e.anchorY),o.bottom=e.y-e.height*e.anchorY):(o.left=e.x-e.width*e.anchorX,o.right=e.x+e.width*(1-e.anchorX)),o},e.prototype.getItemPos=function(t){return this._virtual||this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,o=0;for(var i in this._customSize)parseInt(i)<t&&(e+=this._customSize[i],o++);return{val:e,count:o}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(t.curScrollIsTouch=!1,null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&cc.tween(e).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}t._onScrolling(),t._slideMode!=p.ADHERING||t.adhering?t._slideMode==p.PAGE&&(null!=t._beganPos&&t.curScrollIsTouch?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView.hasNestedViewGroup(t,e)&&(this.curScrollIsTouch=!0,t.eventPhase!==cc.Event.AT_TARGET||t.target!==this.node)){for(var o=t.target;null==o._listId&&o.parent;)o=o.parent;this._scrollItem=null!=o._listId?o:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==p.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==p.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var o=this;o._scrollView.hasNestedViewGroup(t,e)||t.simulate||(o._scrollPos=null,o._slideMode==p.ADHERING?(o.adhering&&(o._adheringBarrier=!0),o.adhere()):o._slideMode==p.PAGE&&(null!=o._beganPos?o._pageAdhere():o.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){if(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height){this._customSize||(this._customSize={});var e=this._sizeType?t.height:t.width;this._customSize[t._listId]!=e&&(this._customSize[t._listId]=e,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,o=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>o)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var o=this.displayData[e];o&&this._createOrUpdateItem(o)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==p.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==p.PAGE&&(this.curPageNum=this.nearestListId)},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var o=this._pool.size()>0;if(e=o?this._pool.get():cc.instantiate(this._itemTmp),o&&cc.isValid(e)||(e=cc.instantiate(this._itemTmp),o=!1),e._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),o&&this._needUpdateWidget){var i=e.getComponent(cc.Widget);i&&i.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var n=e.getComponent(_.default);e.listItem=n,n&&(n.listId=t.id,n.list=this,n._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,o=this.content.children[t];o?this._forceUpdate&&this.renderEvent&&(o._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,t%this._actualNumItems)):((o=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(o),e=o.getComponent(_.default),o.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,t%this._actualNumItems)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>u.NONE){var e=t.node;switch(this.selectedMode){case u.SINGLE:t.selected=this.selectedId==e._listId;break;case u.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},e.prototype._resetItemSize=function(){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),o=this.getItemPos(e._listId);e.setPosition(o.x,o.y)},e.prototype.setMultSelected=function(t,e){var o=this;if(o.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)o.multSelected=t;else{var i=void 0,n=void 0;if(e)for(var a=t.length-1;a>=0;a--)i=t[a],(n=o.multSelected.indexOf(i))<0&&o.multSelected.push(i);else for(a=t.length-1;a>=0;a--)i=t[a],(n=o.multSelected.indexOf(i))>=0&&o.multSelected.splice(n,1)}o._forceUpdate=!0,o._onScrolling()}},e.prototype.getMultSelected=function(){return this.multSelected},e.prototype.hasMultSelected=function(t){return this.multSelected&&this.multSelected.indexOf(t)>=0},e.prototype.delMultSelected=function(){this.multSelected=[]},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,o=t.length;e<o;e++){var i=t[e],n=this.getItemByListId(i);n&&cc.Component.EventHandler.emitEvents([this.renderEvent],n,i%this._actualNumItems)}}},e.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){if(this.content)for(var e=this.content.childrenCount-1;e>=0;e--){var o=this.content.children[e];if(o._listId==t)return o}},e.prototype._getOutsideItem=function(){for(var t,e=[],o=this.content.childrenCount-1;o>=0;o--)t=this.content.children[o],this.displayData.find(function(e){return e.id==t._listId})||e.push(t);return e},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var o=t[e];if(!this._scrollItem||o._listId!=this._scrollItem._listId){o.isCached=!0,this._pool.put(o);for(var i=this._lastDisplayData.length-1;i>=0;i--)if(this._lastDisplayData[i]==o._listId){this._lastDisplayData.splice(i,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,o){var i=this;if(!i.checkInited()||i.cyclic||!i._virtual)return cc.error("This function is not allowed to be called!");if(!e)return cc.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(i._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var n,a=i.getItemByListId(t);if(a){n=a.getComponent(_.default),i._aniDelRuning=!0,i._aniDelCB=e,i._aniDelItem=a,i._aniDelBeforePos=a.position,i._aniDelBeforeScale=a.scale;var r=i.displayData[i.displayData.length-1].id,s=n.selected;n.showAni(o,function(){var o,n,c;if(r<i._numItems-2&&(o=r+1),null!=o){var l=i._calcItemPos(o);i.displayData.push(l),i._virtual?i._createOrUpdateItem(l):i._createOrUpdateItem2(o)}else i._numItems--;if(i.selectedMode==u.SINGLE)s?i._selectedId=-1:i._selectedId-1>=0&&i._selectedId--;else if(i.selectedMode==u.MULT&&i.multSelected.length){var p=i.multSelected.indexOf(t);p>=0&&i.multSelected.splice(p,1);for(var d=i.multSelected.length-1;d>=0;d--)(m=i.multSelected[d])>=t&&i.multSelected[d]--}if(i._customSize){i._customSize[t]&&delete i._customSize[t];var h={},f=void 0;for(var m in i._customSize){f=i._customSize[m];var g=parseInt(m);h[g-(g>=t?1:0)]=f}i._customSize=h}for(d=null!=o?o:r;d>=t+1;d--)if(a=i.getItemByListId(d)){var y=i._calcItemPos(d-1);n=cc.tween(a).to(.2333,{position:cc.v2(y.x,y.y)}),d<=t+1&&(c=!0,n.call(function(){i._aniDelRuning=!1,e(t),delete i._aniDelCB})),n.start()}c||(i._aniDelRuning=!1,e(t),i._aniDelCB=null)},!0)}else e(t)},e.prototype.scrollTo=function(t,e,o,i){void 0===e&&(e=.5),void 0===o&&(o=null),void 0===i&&(i=!1);var n=this;if(n.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=n._numItems&&(t=n._numItems-1),!n._virtual&&n._layout&&n._layout.enabled&&n._layout.updateLayout();var a,r,s=n.getItemPos(t);if(!s)return!1;switch(n._alignCalcType){case 1:a=s.left,a-=null!=o?n.node.width*o:n._leftGap,s=cc.v2(a,0);break;case 2:a=s.right-n.node.width,a+=null!=o?n.node.width*o:n._rightGap,s=cc.v2(a+n.content.width,0);break;case 3:r=s.top,r+=null!=o?n.node.height*o:n._topGap,s=cc.v2(0,-r);break;case 4:r=s.bottom+n.node.height,r-=null!=o?n.node.height*o:n._bottomGap,s=cc.v2(0,-r+n.content.height)}var c=n.content.getPosition();c=Math.abs(n._sizeType?c.y:c.x);var l=n._sizeType?s.y:s.x;Math.abs((null!=n._scrollPos?n._scrollPos:c)-l)>.5&&(n._scrollView.scrollToOffset(s,e),n._scrollToListId=t,n._scrollToEndTime=(new Date).getTime()/1e3+e,n._scrollToSo=n.scheduleOnce(function(){if(n._adheringBarrier||(n.adhering=n._adheringBarrier=!1),n._scrollPos=n._scrollToListId=n._scrollToEndTime=n._scrollToSo=null,i){var e=n.getItemByListId(t);e&&cc.tween(e).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}},e+.1),e<=0&&n._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,o,i,n,a,r=this;r.nearestListId=null,r._virtual&&r._calcViewPos(),o=r.viewTop,i=r.viewRight,n=r.viewBottom,a=r.viewLeft;for(var s=!1,c=0;c<r.content.childrenCount&&!s;c+=r._colLineNum)if(t=r._virtual?r.displayData[c]:r._calcExistItemPos(c))switch(e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:t.right>=a&&(r.nearestListId=t.id,a>e&&(r.nearestListId+=r._colLineNum),s=!0);break;case 2:t.left<=i&&(r.nearestListId=t.id,i<e&&(r.nearestListId+=r._colLineNum),s=!0);break;case 3:t.bottom<=o&&(r.nearestListId=t.id,o<e&&(r.nearestListId+=r._colLineNum),s=!0);break;case 4:t.top>=n&&(r.nearestListId=t.id,n>e&&(r.nearestListId+=r._colLineNum),s=!0)}if((t=r._virtual?r.displayData[r.displayItemNum-1]:r._calcExistItemPos(r._numItems-1))&&t.id==r._numItems-1)switch(e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:i>e&&(r.nearestListId=t.id);break;case 2:a<e&&(r.nearestListId=t.id);break;case 3:n<e&&(r.nearestListId=t.id);break;case 4:o>e&&(r.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var o=this;if(o.checkInited())return o._slideMode!=p.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=o._numItems||o.curPageNum!=t&&(o.curPageNum=t,o.pageChangeEvent&&cc.Component.EventHandler.emitEvents([o.pageChangeEvent],t),o.scrollTo(t,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var o=cc.instantiate(e._itemTmp);e.content.addChild(o);for(var i=0;i<t;i++)cc.Component.EventHandler.emitEvents([e.renderEvent],o,i),o.height==e._itemSize.height&&o.width==e._itemSize.width||(e._customSize[i]=e._sizeType?o.height:o.width);return Object.keys(e._customSize).length||(e._customSize=null),o.removeFromParent(),o.destroy&&o.destroy(),e._customSize}},c([f({type:cc.Enum(l),tooltip:!1})],e.prototype,"templateType",void 0),c([f({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==l.NODE}})],e.prototype,"tmpNode",void 0),c([f({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==l.PREFAB}})],e.prototype,"tmpPrefab",void 0),c([f()],e.prototype,"_slideMode",void 0),c([f({type:cc.Enum(p),tooltip:!1})],e.prototype,"slideMode",null),c([f({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==p.PAGE}})],e.prototype,"pageDistance",void 0),c([f({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==p.PAGE}})],e.prototype,"pageChangeEvent",void 0),c([f()],e.prototype,"_virtual",void 0),c([f({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),c([f({tooltip:!1,visible:function(){var t=this.slideMode==p.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),c([f({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),c([f({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),c([f({type:cc.Integer})],e.prototype,"_updateRate",void 0),c([f({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),c([f({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),c([f({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),c([f({type:cc.Enum(u),tooltip:!1})],e.prototype,"selectedMode",void 0),c([f({tooltip:!1,visible:function(){return this.selectedMode==u.SINGLE}})],e.prototype,"repeatEventSingle",void 0),c([f({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>u.NONE}})],e.prototype,"selectedEvent",void 0),c([f({serializable:!1})],e.prototype,"_numItems",void 0),c([h,m(),g("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),v(cc.ScrollView),y(-5e3)],e)}(cc.Component);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],LiveMgr:[function(t,e,o){"use strict";cc._RF.push(e,"77a8e+mVslIloQ7SgM1Z8+H","LiveMgr");var i=t,n=e,a=o;cc._RF.push(n,"77a8e+mVslIloQ7SgM1Z8+H","LiveMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("Config"),s=i("SocketMgr"),c=i("HttpMgr"),l=i("UIMgr"),p=globalThis.electronAPI,u=function(){function t(){this.url2="wss://yuema.sfplay.net/live/socket",this.roomUrl="https://yuema.sfplay.net/live/getRoomInfo",this.count=60,this.appId="tte23b94867d0dbf4510"}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.init=function(t){var e=this;void 0===t&&(t=!1),p&&!t?(p.ongetToken(function(t,o){for(var i=null,n=0;n<o.length;n++){var a=o[n];if(-1!=a.indexOf("-token=")){i=a.replace("-token=","");break}}e.startSocket(i)}),p.getToken()):(this.roomId="xlh1234567891011121314",s.default.getInstance().startSocket(this.url2,this.roomId,this.appId,!0),s.default.getInstance().setOnMsg(function(t){e.onMsg(t)}))},t.prototype.startSocket=function(t){var e=this;t?c.HttpMgr.getInstance().httpPost({token:t,appId:this.appId},function(o){if(o){var i=JSON.parse(o);i&&0==i.code&&i.data?(e.roomId=i.data.room_id,s.default.getInstance().startSocket(e.url2,e.roomId,e.appId),s.default.getInstance().setOnMsg(function(t){e.onMsg(t)})):e.count>0?setTimeout(function(){e.count--,e.startSocket(t)},1e3):l.UIMgr.getInstance().openUI(r.UIID.UITips,r.UIID.UINONE,"\u8fde\u63a5\u670d\u52a1\u5668\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u6e38\u620f")}else e.count>0?setTimeout(function(){e.count--,e.startSocket(t)},1e3):l.UIMgr.getInstance().openUI(r.UIID.UITips,r.UIID.UINONE,"\u8fde\u63a5\u670d\u52a1\u5668\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u6e38\u620f")},this.roomUrl):l.UIMgr.getInstance().openUI(r.UIID.UITips,r.UIID.UINONE,"\u83b7\u53d6token\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u6e38\u620f")},t.prototype.sendTestMsg=function(t,e){var o={roomId:this.roomId,appId:this.appId,type:t,list:e};c.HttpMgr.getInstance().httpPost(o,function(t){console.log(t)},"https://yuema.sfplay.net/live/test/liveMsg",!0)},t.prototype.onMsg=function(t){console.log("\u63a5\u6536\u5230\u6d88\u606f\uff1a",t)},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],Loading:[function(t,e,o){"use strict";cc._RF.push(e,"41b57as2OZEuZ652LPFYv15","Loading");var i=t,n=e,a=o;cc._RF.push(n,"41b57as2OZEuZ652LPFYv15","Loading");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Common_PlayerMgr"),p=i("BasePlatform"),u=i("Appcfg"),d=i("PlatformSetting"),h=i("AudioMgr"),f=i("EventMgr"),m=i("LogMgr"),g=i("PlatformManager"),y=i("PoolMgr"),v=i("ResCacheMgr"),_=i("ResourceMgr"),b=i("SdkMgr"),B=i("UIMgr"),I=i("WechatEventMgr"),P=i("ServerDataMgr"),C=i("Config"),D=i("TextConfig"),T=i("BraveTowerEnum"),S=i("GameTrackDataEvent"),A=i("DataMgr"),k=i("PlayerMgr"),w=cc._decorator,N=w.ccclass,R=w.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiRoot=null,e.logo=null,e.tips=null,e.progressBar=null,e.soft=null,e.ndBg=null,e.process=0,e.sceneName="Main",e}return s(e,t),e.prototype.onLoad=function(){d.PlatformSetting.currentPlatform==p.Platform.WECHAT&&m.LogMgr.getInstance().init(),cc.director.preloadScene(this.sceneName)},e.prototype.start=function(){var t=this;cc.game.addPersistRootNode(this.uiRoot),this.progressBar.fillRange=0,this.tips.string=D.TextConfig.Guide0,g.PlatformManager.getInstance().init(),I.WechatEventMgr.getInstance().init(),v.ResCacheMgr.getInstance().init(),B.UIMgr.getInstance().addUICnf(C.UICF),B.UIMgr.getInstance().Init(this.uiRoot),h.AudioMgr.getInstance().init(C.AudioCF),f.EventMgr.getInstance().on(u.BaseEventName.Loading,this,this.setProcessLoad),b.SdkMgr.getInstance().requestCheckVersion(function(){P.ServerdataMgr.init(function(){t.setProcessLoad(u.LoadingProcess.StartLoading)})}),console.log("\u5f53\u524d\u5e94\u7528",d.PlatformSetting.currentApp),console.log("\u5f53\u524d\u6e20\u9053",d.PlatformSetting.currentPlatform)},e.prototype.setProcessLoad=function(t){var e=this;switch(this.process=t/100,t){case u.LoadingProcess.StartLoading:this.tips.string=D.TextConfig.Guide0,A.DataMgr.getInstance().preload();break;case u.LoadingProcess.ExcelCfg:this.tips.string=D.TextConfig.Guide1,k.PlayerMgr.getInstance().preload(),l.default.getInstance().preload();break;case u.LoadingProcess.PlayerCfg:k.PlayerMgr.getInstance().getTrackData().youmengTrack(S.TrackId.dau),this.tips.string=D.TextConfig.Guide2,_.ResourceMgr.getInstance().getNode(T.BraveTowerPoolName.ItemGood,T.BraveTowerBundelName.Icon,T.BraveTowerPrefabName.ItemGood,function(t){y.PoolMgr.getInstance().freeNode(T.BraveTowerPoolName.ItemGood,t),e.setProcessLoad(u.LoadingProcess.ResCfg)},10);break;case u.LoadingProcess.ResCfg:this.tips.string=D.TextConfig.Guide2,_.ResourceMgr.getInstance().loadBundle("BraveTowerPrefab",function(){e.setProcessLoad(u.LoadingProcess.EndLoading)});break;case u.LoadingProcess.EndLoading:this.tips.string=D.TextConfig.Guide3;var o=cc.sys.localStorage.getItem("isReadsfplay.netricy");d.PlatformSetting.currentPlatform!=p.Platform.OPPO&&d.PlatformSetting.currentPlatform!=p.Platform.EDITOR||o?cc.director.loadScene(this.sceneName):B.UIMgr.getInstance().openUI(C.UIID.PopUserPrivacy,C.UIID.UINONE)}this.progressBar.fillRange=this.process},e.prototype.preloadUI=function(){},e.prototype.loadLogo=function(){},c([R(cc.Node)],e.prototype,"uiRoot",void 0),c([R(cc.Sprite)],e.prototype,"logo",void 0),c([R(cc.Label)],e.prototype,"tips",void 0),c([R(cc.Sprite)],e.prototype,"progressBar",void 0),c([R(cc.Label)],e.prototype,"soft",void 0),c([R(cc.Node)],e.prototype,"ndBg",void 0),c([N],e)}(cc.Component);a.default=M,cc._RF.pop(),cc._RF.pop()},{}],LogMgr:[function(t,e,o){"use strict";cc._RF.push(e,"66888k6K8BMX5FlnhFjgbWs","LogMgr");var i=t,n=e,a=o;cc._RF.push(n,"66888k6K8BMX5FlnhFjgbWs","LogMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.LogMgr=void 0;var r=i("Config"),s=i("BasePlatform"),c=i("PlatformSetting"),l=function(){function t(){}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.init=function(){var t=this;"undefined"!=typeof tt?tt.getLaunchOptionsSync().scene&&tt.onError(function(e){var o=e.msg+e.stack;t.uploadDyLog(o)}):"undefined"!=typeof wx?wx.onError(function(e){t.uploadDyLog(JSON.stringify(e))}):window.onerror=function(){},window.addEventListener("unhandledrejection",function(e){var o,i,n={type:"promise_rejection",reason:(null===(o=e.reason)||void 0===o?void 0:o.message)||"Unhandled promise rejection",stack:(null===(i=e.reason)||void 0===i?void 0:i.stack)||"",timestamp:(new Date).toISOString()};t.uploadDyLog(JSON.stringify(n)),e.preventDefault()})},t.prototype.debug=function(t,e){cc.debug&&console.log(t,e)},t.prototype.info=function(t,e){console.log(t,e)},t.prototype.error=function(t,e){console.error(t,e)},t.prototype.uploadDyLog=function(t){var e=this;if(t)if(c.PlatformSetting.currentPlatform==s.Platform.BYTEDANCE)if(this.logger)this.logger&&this.logger.info(t);else{var o=tt.getSystemInfoSync();if(o.appName==r.ByteAppName.douyin_lite||o.appName==r.ByteAppName.Douyin||o.appName==r.ByteAppName.live_stream){if(!tt.getLogManager)return;tt.login({force:!1,success:function(){e.logger=tt.getLogManager({syncToConsole:!0,level:1}),e.logger&&e.logger.info(t)}})}}else if(c.PlatformSetting.currentPlatform==s.Platform.WECHAT){var i=wx.getRealtimeLogManager?wx.getRealtimeLogManager():null;if(!i&&void 0===t)return;i.error(t)}},t.instance=null,t}();a.LogMgr=l,cc._RF.pop(),cc._RF.pop()},{}],Main:[function(t,e,o){"use strict";cc._RF.push(e,"bdd5dhrRU5Cjq9Jm8O/mMt1","Main");var i=t,n=e,a=o;cc._RF.push(n,"bdd5dhrRU5Cjq9Jm8O/mMt1","Main");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BALL_App"),p=i("DRA_App"),u=i("BasePlatform"),d=i("PlatformSetting"),h=i("EventMgr"),f=i("ResourceMgr"),m=i("SdkMgr"),g=i("UIMgr"),y=i("UIUtils"),v=i("Config"),_=i("BraveTowerEnum"),b=i("GameTrackDataEvent"),B=i("GameUserData"),I=i("PlayerMgr"),P=i("UITop"),C=cc._decorator,D=C.ccclass,T=(C.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childTouch=!1,e.directNum=-1,e.isFitHeight=!1,e.isFitWidth=!1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,cc.game.setFrameRate(59),g.UIMgr.getInstance().getChildByName("UILoading").zIndex=9999,this.adapt(),this.preloadRes()},e.prototype.hideLoading=function(){g.UIMgr.getInstance().getChildByName("UILoading")&&g.UIMgr.getInstance().getChildByName("UILoading").destroy()},e.prototype.start=function(){var t=this;cc.game.setFrameRate(59),this.checkIsDirect(),-1==this.directNum?this.infactOpen():1==this.directNum?p.default.instance.enter_App(function(){t.hideLoading()},function(){t.infactOpen(),t.addBlockTouch()},!0):2==this.directNum&&l.default.instance.enter_App(function(){t.hideLoading()},function(){t.infactOpen(),t.addBlockTouch()},!0)},e.prototype.addBlockTouch=function(){},e.prototype.removeBlockTouch=function(){this.blockNode&&(this.blockNode.removeFromParent(),this.blockNode.destroy(),this.blockNode=null)},e.prototype.infactOpen=function(){var t=this;I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.guide1),g.UIMgr.getInstance().openUI(v.UIID.UITouch,v.UIID.UINONE),g.UIMgr.getInstance().openUI(v.UIID.UIReportTop,v.UIID.UINONE),g.UIMgr.getInstance().openUIOfCallback(v.UIID.UITop,v.UIID.UINONE,function(e){t.uiTop=e.getComponent(P.default),t.uiTop.node.active=!1,g.UIMgr.getInstance().openUIOfCallback(v.UIID.UIHome,v.UIID.UINONE,function(){-1!=t.directNum?o.instance.startGame(_.BraveTowerGameMode.Normal,1,!0):t.hideLoading()})}),y.UIUtils.schedule(this.addTime,this,1);var e=I.PlayerMgr.getInstance().getTrackData().getCrunetDay();I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.dau_day_X,e)},e.prototype.checkIsDirect=function(){this.directNum=-1,u.Platform.BYTEDANCE==d.PlatformSetting.currentPlatform&&(tt.getLaunchOptionsSync().query.guanka?this.directNum=1:tt.getLaunchOptionsSync().query.qiang&&(this.directNum=2))},e.prototype.addTime=function(){if(I.PlayerMgr.getInstance().getTrackData().getTimeByKey(_.TimeByKey.OnLineTime)<=1800)switch(I.PlayerMgr.getInstance().getTrackData().addTimeByKey(_.TimeByKey.OnLineTime)){case 60:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_1);break;case 180:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_3);break;case 300:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_5);break;case 420:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_7);break;case 600:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_10);break;case 900:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_15);break;case 1200:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_20);break;case 1800:I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.time_30)}I.PlayerMgr.getInstance().getDailyData().addOnlineTime(),h.EventMgr.getInstance().emit(_.BraveTowerEventName.TimeUpdate)},e.prototype.checkUserInfo=function(t){var e=I.PlayerMgr.getInstance().getUserData();e.getPlayerName()?t&&t():m.SdkMgr.getInstance().getUserInfo(function(o,i){var n=new B.ThirdUserInfo;o&&(e.setPlayerName(o),n.userName=o),i&&(n.imgUrl=i),o||i?e.setThirdInfo(n):e.setPlayerName("\u6211"),t&&t()})},e.prototype.preloadRes=function(){if(v.GameConfig.PreBundle.length>0)for(var t=0;t<v.GameConfig.PreBundle.length;t++){var e=v.GameConfig.PreBundle[t];f.ResourceMgr.getInstance().preload(e,v.GameConfig.PreBundleList[t])}},e.prototype.adapt=function(){var t=cc.winSize.width/cc.winSize.height,e=cc.Canvas.instance.designResolution.width/cc.Canvas.instance.designResolution.height;t<=1&&t<=e?this.setFitWidth():this.setFitHeight()},e.prototype.setFitHeight=function(){cc.Canvas.instance.fitHeight=!0,cc.Canvas.instance.fitWidth=!1,this.isFitHeight=!0},e.prototype.setFitWidth=function(){cc.Canvas.instance.fitHeight=!1,cc.Canvas.instance.fitWidth=!0,this.isFitWidth=!0},e.prototype.getFitHeight=function(){return this.isFitHeight},e.prototype.startGame=function(t,e,o){switch(void 0===o&&(o=!1),t){case _.BraveTowerGameMode.Normal:I.PlayerMgr.getInstance().getTaskData().addMainMapNum();break;case _.BraveTowerGameMode.Boss:I.PlayerMgr.getInstance().getTaskData().addDailyMapNum()}g.UIMgr.getInstance().openUIOfCallback(v.UIID.UIGame,v.UIID.UINONE,function(){g.UIMgr.getInstance().getUIById(v.UIID.UIHome).node.active=!1},t,e,o)},e.prototype.endGame=function(){this.uiTop.node.active=!0},o=c([D],e)}(cc.Component));a.default=T,cc._RF.pop(),cc._RF.pop()},{}],MapCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"100e0CmodRHCKeDDPfSuhiS","MapCtrl");var i=t,n=e,a=o;cc._RF.push(n,"100e0CmodRHCKeDDPfSuhiS","MapCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("TileManager"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapPrefab=null,e.bgs=[],e.treePrefab=null,e.treesRoot=null,e.tileManager=null,e.playerTileX=0,e.playerTileY=0,e.lastTileX=0,e.lastTileY=0,e.MapPool=[],e.moveX=0,e.moveY=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,this.initParm()},e.prototype.initParm=function(){this.baseWidth=Math.floor(cc.winSize.width),this.baseHeight=Math.floor(cc.winSize.height),this.left=-this.baseWidth,this.right=this.baseWidth,this.up=this.baseHeight,this.down=-this.baseHeight;for(var t=0;t<9;t++){var e=cc.instantiate(this.mapPrefab);e.width=this.baseWidth,e.height=this.baseHeight,this.MapPool.push(e)}for(var o=0,i=-1;i<=1;i++)for(var n=-1;n<=1;n++){var a=this.MapPool[o];a.setParent(this.node),a.x=i*this.baseWidth,a.y=n*this.baseHeight,o++}},e.prototype.checkNode=function(t,e){this.moveX+=t,this.moveY+=e,this.moveX>=this.baseWidth/3?this.moveBGx(1):this.moveX<=-this.baseWidth/3&&this.moveBGx(-1),this.moveY>=this.baseHeight/2?this.moveBGy(1):this.moveY<=-this.baseHeight/2&&this.moveBGy(-1)},e.prototype.moveBGx=function(t){for(var e=0;e<9;e++){var o=this.MapPool[e];o.getPosition().x===(1===t?this.left:this.right)&&(o.x+=3*this.baseWidth*t)}this.left+=this.baseWidth*t,this.right+=this.baseWidth*t,this.moveX+=this.baseWidth*-t},e.prototype.moveBGy=function(t){for(var e=0;e<9;e++){var o=this.MapPool[e];o.getPosition().y===(1===t?this.down:this.up)&&(o.y+=3*this.baseHeight*t)}this.down+=this.baseHeight*t,this.up+=this.baseHeight*t,this.moveY+=this.baseHeight*-t},c([d(cc.Prefab)],e.prototype,"mapPrefab",void 0),c([d([cc.SpriteFrame])],e.prototype,"bgs",void 0),c([d(cc.Prefab)],e.prototype,"treePrefab",void 0),c([d(cc.Node)],e.prototype,"treesRoot",void 0),c([d(l.default)],e.prototype,"tileManager",void 0),o=c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],NEW_App:[function(t,e,o){"use strict";cc._RF.push(e,"a4561cT9mlPLq9GV2lz8STG","NEW_App");var i=t,n=e,a=o;cc._RF.push(n,"a4561cT9mlPLq9GV2lz8STG","NEW_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("EventMgr"),c=i("UIMgr"),l=i("Config"),p=i("NEW_Configs"),u=i("NEW_DataMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(t){t.keyCode==cc.macro.KEY.space&&s.EventMgr.getInstance().emit(p.emNEWEventName.spacePause)}),this.addTouchEvent(),this._exitCall=e;var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(p.NEW_UIID.UIGame,l.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(p.NEW_AudioId.bgm,p.NEWConfig.BgMusic)})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(p.NEW_UICF),r.AudioMgr.getInstance().addAdConf(p.NEW_AudioCF),u.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){c.UIMgr.getInstance().closeById(p.NEW_UIID.UIGame),c.UIMgr.getInstance().closeById(p.NEW_UIID.UIResult),c.UIMgr.getInstance().closeById(p.NEW_UIID.UISetting),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],NEW_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"006a5U5NxNFvZvieMVJ63BQ","NEW_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"006a5U5NxNFvZvieMVJ63BQ","NEW_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("NodeLib"),d=i("NEW_Configs"),h=i("NEW_BloodItem"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_blood=null,e.bloodArr=[],e.maxItemNum=30,e.nowItemNum=0,e}return s(e,t),e.prototype.initProperty=function(){this.pro_blood=u.default.findChildByName(this.node,"blood")},e.prototype.initPool=function(){p.PoolMgr.getInstance().creatrePool(d.poolName.bloodText,this.pro_blood)},e.prototype.createBlood=function(t,e,o){if(!(this.nowItemNum>=this.maxItemNum)){this.nowItemNum++;var i=this.bloodArr.pop();i||((i=p.PoolMgr.getInstance().getNode(d.poolName.bloodText)).parent=this.node);var n=i.getComponent(h.default);i.setPosition(o),n.resumeNode(),n.isCirt(e,t,this)}},e.prototype.recycleBlood=function(t){this.nowItemNum--,this.bloodArr.push(t)},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.initPool()},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],NEW_BloodItem:[function(t,e,o){"use strict";cc._RF.push(e,"a9a72m1llhDmaIO58YaTf3h","NEW_BloodItem");var i=t,n=e,a=o;cc._RF.push(n,"a9a72m1llhDmaIO58YaTf3h","NEW_BloodItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Utils"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentCtrl=null,e}return s(e,t),e.prototype.isCirt=function(t,e,o){this.parentCtrl||(this.parentCtrl=o),t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e.toString()):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e.toString()),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255,this.node.active=!0;var e=l.Utils.randomRang(-30,30),o=l.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){t.node.active=!1,t.parentCtrl.recycleBlood(t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.opacity=255},e.prototype.onLoad=function(){},e.prototype.start=function(){},c([d(cc.Node)],e.prototype,"isCritState",void 0),c([d(cc.Label)],e.prototype,"critLabel",void 0),c([d(cc.Label)],e.prototype,"commonLabel",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],NEW_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"cfdceiiRM9H+Zm9M1KJUiRL","NEW_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"cfdceiiRM9H+Zm9M1KJUiRL","NEW_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("new_GameEnumData"),u=i("NEW_DataMgr"),d=i("new_gameCtrl"),h=i("NEW_BuffItem"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t,e){this.index=0,this.item=null,this.index=t,this.item=e}),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffList=[],e.contrlBuffList=[],e.pro_buff=null,e.buffMoveSpeed=100,e.aimDistaceY=0,e.haveBuff=!1,e.buffGapTime=0,e.buffTime=.5,e}return s(e,t),e.prototype.initProperty=function(){this.pro_buff=this.node.getChildByName("pro_buff")},e.prototype.initParam=function(){this.buffMoveSpeed=100*u.default.getInstance().getParam(p.enumBasicParaCfg.buffMove),this.pro_buff.y=cc.winSize.height/2+150;var t=d.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroLayer().y;this.aimDistaceY=Math.abs(t-this.pro_buff.y)-150},e.prototype.addBuff=function(t){var e;if(e=u.default.getInstance().getLevelCfgByID(t)){if(e.buffType){var o=cc.instantiate(this.pro_buff);o.active=!0;var i=o.getComponent(h.default),n=new g(t,i);o.parent=this.node,this.buffList.push(n)}}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.removeBuff=function(t){for(var e=0;e<this.contrlBuffList.length;e++)if(this.contrlBuffList[e].uuid==t.uuid){this.contrlBuffList[e].node.removeFromParent(),this.contrlBuffList.splice(e,1);break}},e.prototype.doInitBuffDown=function(){if(0!=this.buffList.length){var t=this.buffList.shift(),e=t.item,o=d.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList();this.contrlBuffList.push(e),e.initNode(t.index,o,this.buffMoveSpeed,this,this.aimDistaceY),this.haveBuff=!0}},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.initParam()},e.prototype.onUpdate=function(t){this.haveBuff?(this.buffGapTime+=t,this.buffGapTime>=this.buffTime&&(this.buffGapTime=0,this.haveBuff=!1)):this.doInitBuffDown();for(var e=0;e<this.contrlBuffList.length;e++)this.contrlBuffList[e].onUpdate(t)},c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],NEW_BuffItem:[function(t,e,o){"use strict";cc._RF.push(e,"ab34dpYbMFIN6l6i/dKH/Ws","NEW_BuffItem");var i=t,n=e,a=o;cc._RF.push(n,"ab34dpYbMFIN6l6i/dKH/Ws","NEW_BuffItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("Utils"),d=i("NodeLib"),h=i("NEW_Configs"),f=i("NEW_DataMgr"),m=i("new_gameCtrl"),g=i("NEW_HeroItem"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e){this.name=t,this.weight=e},B=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=null),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.pro_node1=null,e.pro_node2=null,e.nodeObj1=new B,e.nodeObj2=new B,e.heroList=[],e.buffMoveSpeed=0,e.parentCtrl=null,e.moveDistance=0,e}return s(e,t),e.prototype.initProperty=function(){this.pro_node1=d.default.findChildByName(this.node,"node1"),this.pro_node2=d.default.findChildByName(this.node,"node2")},e.prototype.initNode=function(t,e,o,i,n){var a;if(this.buffMoveSpeed=o,this.moveDistance=n,this.parentCtrl=i,a=f.default.getInstance().getLevelCfgByID(t)){if(a.buffType)if(this.heroList=e,1==a.buffType){var r=this.getResult(),s=this.getResult(),c=this.getPropertyResultArr(r,s,a);(0==r||1==r||2==r)&&this.initPropertyNode(r,c[0],this.pro_node1,this.nodeObj1),(0==s||1==s||2==s)&&this.initPropertyNode(s,c[1],this.pro_node2,this.nodeObj2)}else if(2==a.buffType){if(0==(r=this.getResult())){var l=this.getPropertyResult(a.buff1,r);this.initPropertyNode(r,l[0],this.pro_node1,this.nodeObj1)}else 1==r?(l=this.getPropertyResult(a.buff2?a.buff2:a.buff1,r),this.initPropertyNode(r,l[0],this.pro_node1,this.nodeObj1)):2==r&&(l=this.getPropertyResult(a.buff3?a.buff3:a.buff1,r),this.initPropertyNode(r,l[0],this.pro_node1,this.nodeObj1));var p=this.getNewRole();this.initNewNode(p[0],this.pro_node2,this.nodeObj2)}else p=this.getNewRole(2),this.initNewNode(p[0],this.pro_node1,this.nodeObj1),this.initNewNode(p[1],this.pro_node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getResult=function(){var t=f.default.getInstance().getBuffOddsCfgByAmount(this.heroList.length),e=[],o=t.buff1Odds+t.buff2Odds+t.buff3Odds;e.push(t.buff1Odds),e.push(t.buff2Odds),e.push(t.buff3Odds);for(var i=Math.random()*o,n=0;n<e.length;n++)if((i-=e[n])<=0)return n},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=this.heroList.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t));if(3==this.heroList[e].getIndex()){for(var i=0;i<o.length;i++)if(o[i].includes("penetrate")){o.splice(i,1);break}}else if(this.heroList[e].isMaxAttackSpeed())for(i=0;i<o.length;i++)if(o[i].includes("speed")){o.splice(i,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=[],o=this.heroList[0].getIndex(),i=this.heroList[1]?this.heroList[1].getIndex():-1;for(var n in this.heroList){var a=this.heroList[n].getIndex(),r=f.default.getInstance().getMateOddsCfgByID(a);e=e.concat(this.createRoleLottery(r.mateOdds.split("|"),o,i))}for(var s=[];t--;){var c=Number(u.Utils.weight_rand(e).name);for(n=0;n<e.length;n++)if(c==Number(e[n].name)){e.splice(n,1);break}s.push(c)}return s},e.prototype.createRoleLottery=function(t,e,o){var i=[];for(var n in t){var a=t[n].split(","),r=Number(a[0]),s=Number(a[1]);if(e!=r&&r!=o){var c=new b(r.toString(),s);i.push(c)}}return i},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=this.heroList[t].getIndex(),r=f.default.getInstance().getCharacterByID(a);this.loadSpriteFrame(h.emNEWBundles.imgs,"js_b/"+r.image,function(r){n.initPropertyView(o,r,e,a),n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=f.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=n.heroList[t].node,c.buffType==h.emNEWBuffType.speedPlus?i.type=h.heroPropertyType.attackSpeed:c.buffType==h.emNEWBuffType.ATKmul||c.buffType==h.emNEWBuffType.ATKplus?i.type=h.heroPropertyType.attackPower:c.buffType==h.emNEWBuffType.penetratePlus?i.type=h.heroPropertyType.penetrate:c.buffType==h.emNEWBuffType.bulletPlus?i.type=h.heroPropertyType.bulletCount:c.buffType==h.emNEWBuffType.critPlus?i.type=h.heroPropertyType.critChance:c.buffType==h.emNEWBuffType.skillMul&&(i.type=h.heroPropertyType.skillTimer)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=f.default.getInstance().getCharacterByID(i).characterName,p=f.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon"),s=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(h.emNEWBundles.imgs,"js_b/"+s.image,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=f.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffect(h.NEW_AudioId.buff,h.NEW_AudioId.buff);var t=m.default.instance.getPro_buttomCtrl().getHeroCtrl();t.checkHeroPosX()?this.nodeObj1.isNew?t.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?t.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.active=!1,this.buffMoveSpeed=0,this.parentCtrl.removeBuff(this)},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;e.getComponent(g.default).modifyAttribute(o,t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.node.y-=this.buffMoveSpeed*t,this.moveDistance-=this.buffMoveSpeed*t,this.moveDistance<=0&&this.doReward()},c([_(cc.SpriteFrame)],e.prototype,"sp",void 0),c([v],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],NEW_BulletBaseItem:[function(t,e,o){"use strict";cc._RF.push(e,"869e1YnVNZBzZpKLH/q9y+9","NEW_BulletBaseItem");var i=t,n=e,a=o;cc._RF.push(n,"869e1YnVNZBzZpKLH/q9y+9","NEW_BulletBaseItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("Utils"),u=i("NEW_Configs"),d=i("NEW_DataMgr"),h=i("new_gameCtrl"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.penetrate=0,e.lastAttackID=-1,e.lastDir=u.bulletDir.None,e.velocity=cc.Vec3.ZERO,e.angle=0,e.isDestroy=!1,e.isBounceBullet=!1,e.canBounce=!1,e.screnSize=null,e.hitTimes=0,e.isBounceWithDragon=!1,e.basePenetrate=0,e.appearTime=0,e}return s(e,t),e.prototype.initParam=function(t,e,o,i,n){this.range=t,this.penetrate=e,this.flySpeed=o,this.hero=i,this.appearTime=n,this.isDestroy=!1,this.isBounceBullet=!1,this.canBounce=!1;var a=i.getIndex();3!=a&&17!=a||this.initBounceBullet(a)},e.prototype.doResycleNoBounceBulletDown=function(){var t=this;this.isDestroy=!0,this.lastAttackID=-1,this.node.y=-1e4,this.scheduleOnce(function(){t.hero.recycleBullet(t)})},e.prototype.initBounceBullet=function(t){this.initAngle(),this.lastDir=u.bulletDir.None,this.isBounceBullet=!0,this.screnSize=h.default.instance.getBulletBoundary(),this.hitTimes=d.default.getInstance().getCharacterByID(t).hitTimes,3==t?(this.penetrate=100,this.isBounceWithDragon=!1):this.isBounceWithDragon=!0},e.prototype.resycleBullet=function(){this.isDestroy||(this.isBounceBullet?this.doResycleBounceBulletDown():(this.penetrate--,this.penetrate<0&&this.doResycleNoBounceBulletDown()))},e.prototype.doResycleBounceBulletDown=function(){this.hitTimes--,this.hitTimes<=0&&this.doResycleNoBounceBulletDown(),this.isBounceWithDragon&&(this.penetrate--,this.penetrate<0&&this.bounceWithDragon())},e.prototype.checkCollision=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),e=this.lastAttackID,o=this.hero.getIsCirt(),i=this.hero.getCirtDamage(o),n=h.default.instance.getPro_topCtrl().checkCollision(t,e,i,o);-1!=n&&(this.lastAttackID=n,this.resycleBullet())},e.prototype.bounceWithDragon=function(){this.penetrate=this.hero.getPenetrate(),this.lastDir=u.bulletDir.None,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()},e.prototype.overSide=function(t,e){t.x,e.leftBoundary,t.x,e.rightBoundary,t.y,e.downBoundary,t.y,e.upBoundary},e.prototype.initAngle=function(){var t=p.Utils.randomRang(-45,45);this.angle=t;var e=(t+90)*(Math.PI/180),o=new cc.Vec3(Math.cos(e),Math.sin(e),0);this.velocity=o.multiplyScalar(100*this.flySpeed),this.changeAngle()},e.prototype.changeAngle=function(){this.lastAttackID=-1,this.node.angle=this.angle},e.prototype.onUpdateBullet1=function(t){this.node.y+=this.flySpeed*t*100,this.node.y>=this.range&&this.resycleBullet()},e.prototype.onUpdateBullet2=function(t){this.node.y>this.screnSize.downBoundary&&(this.canBounce=!0),this.node.x+=this.velocity.x*t,this.node.y+=this.velocity.y*t;var e=this.screnSize;this.overSide(this.node.position,e);var o=this.node.position;this.canBounce&&(o.x<e.leftBoundary&&this.lastDir!=u.bulletDir.left&&(this.lastDir=u.bulletDir.left,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),o.x>e.rightBoundary&&this.lastDir!=u.bulletDir.right&&(this.lastDir=u.bulletDir.right,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),o.y<e.downBoundary&&this.lastDir!=u.bulletDir.down&&(this.lastDir=u.bulletDir.down,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()),o.y>e.upBoundary&&this.lastDir!=u.bulletDir.up&&(this.lastDir=u.bulletDir.up,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()))},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.isDestroy||(this.appearTime-=t,this.appearTime<=0?this.doResycleNoBounceBulletDown():(this.isBounceBullet?this.onUpdateBullet2(t):this.onUpdateBullet1(t),this.checkCollision()))},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],NEW_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"50f3bqO74FDiKa3MqxTLKdP","NEW_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"50f3bqO74FDiKa3MqxTLKdP","NEW_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.emNEWBuffType=l.heroPropertyType=l.bulletDir=l.poolName=l.emNEWGameState=l.emNEWEventName=l.NEW_AudioCF=l.NEW_AudioId=l.NEW_UICF=l.NEWConfig=l.emNEWBundles=l.NEW_UIID=void 0,function(t){t.UIGame="NEW_UIGame",t.UIResult="NEW_UIResult",t.UISetting="NEW_UISetting"}(a=l.NEW_UIID||(l.NEW_UIID={})),function(t){t.prefabs="new_prefabs",t.audios="new_audios",t.imgs="new_imgs",t.configs="new_configs"}(r=l.emNEWBundles||(l.emNEWBundles={})),l.NEWConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.NEW_UICF=((i={})[a.UIGame]={prefab:"ui/NEW_UIGame",name:"NEW_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/NEW_UIResult",name:"NEW_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/NEW_UISetting",name:"NEW_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.doubleSword="doubleSword",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.dragonHit="dragonHit",t.rake="rake",t.typhoon="typhoon",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.barrier="barrier",t.dragonBallGet="dragonBallGet",t.dragonBallShow="dragonBallShow",t.electric="electric",t.fireball="fireball",t.ice="ice",t.icebreak="icebreak",t.lightningBullet="lightningBullet",t.magic="magic",t.wind="wind",t.moon="moon",t.boomerang="boomerang",t.boom="boom",t.moonGod="moonGod",t.lightDragonBall="lightDragonBall",t.over="over",t.bluePalm="bluePalm",t.summon="summon",t.levelup="levelup",t.chi="chi",t.congrat="congrat",t.gang="gang",t.peng="peng"}(s=l.NEW_AudioId||(l.NEW_AudioId={})),l.NEW_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.dragonHit]={path:"dragonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.dragonBallGet]={path:"dragonBallGet",bundle:r.audios},n[s.barrier]={path:"barrier",bundle:r.audios},n[s.dragonBallShow]={path:"dragonBallShow",bundle:r.audios},n[s.electric]={path:"electric",bundle:r.audios},n[s.fireball]={path:"fireball",bundle:r.audios},n[s.ice]={path:"ice",bundle:r.audios},n[s.icebreak]={path:"icebreak",bundle:r.audios},n[s.lightningBullet]={path:"lightningBullet",bundle:r.audios},n[s.magic]={path:"magic",bundle:r.audios},n[s.wind]={path:"wind",bundle:r.audios},n[s.moon]={path:"moon",bundle:r.audios},n[s.boomerang]={path:"boomerang",bundle:r.audios},n[s.boom]={path:"boom",bundle:r.audios},n[s.moonGod]={path:"moonGod",bundle:r.audios},n[s.lightDragonBall]={path:"lightDragonBall",bundle:r.audios},n[s.over]={path:"over",bundle:r.audios},n[s.bluePalm]={path:"bluePalm",bundle:r.audios},n[s.summon]={path:"bluePalm",bundle:r.audios},n[s.levelup]={path:"levelup",bundle:r.audios},n[s.chi]={path:"chi",bundle:r.audios},n[s.congrat]={path:"congrat",bundle:r.audios},n[s.gang]={path:"gang",bundle:r.audios},n[s.peng]={path:"peng",bundle:r.audios},n),function(t){t.GAD_Player_Die="new_gad_player_die",t.GAD_Shoot_Bullet="new_gad_shoot_bullet",t.GAD_Show_Hit_Text="new_gad_show_hit_text",t.GAD_Show_Warn="new_gad_show_warn",t.GAD_Bubble_Buf="new_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="new_gad_hit_effect",t.GAD_Show_Buff_Tip="new_gad_show_buff_tip",t.GAD_Setting_Back="new_gad_setting_back",t.pause="new_pause",t.resume="new_resume",t.skillPause="new_skillPause",t.skillResume="new_skillResume",t.buff="new_buff",t.blood="new_blood",t.newTarm="new_newTarm",t.new_loot="new_loot",t.new_ball_tips=" new_ball_tips",t.loseBlood="new_loseBlood",t.screenShake="new_screenShake",t.warn="new_warn",t.hitEffect="new_hitEffect",t.destroy="new_destroy",t.spacePause="new_spacePause"}(l.emNEWEventName||(l.emNEWEventName={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emNEWGameState||(l.emNEWGameState={})),function(t){t.blood="new_blood",t.destroy="new_destroy",t.effect="new_effect",t.box="new_box",t.body="new_body",t.new_item="new_item",t.bulletName="NEW_Bullet_",t.CardSkill="CardSkill",t.MateSkill="mateSkill",t.bloodText="new_bloodText",t.body_num="body_num",t.body_box="body_box",t.body_link="body_link",t.body_blood="body_blood",t.body_destroy="body_destroy",t.Bullet_skill="Bullet_skill"}(l.poolName||(l.poolName={})),function(t){t.None="None",t.up="up",t.down="down",t.left="left",t.right="right"}(l.bulletDir||(l.bulletDir={})),function(t){t[t.attackPower=1]="attackPower",t[t.attackSpeed=2]="attackSpeed",t[t.penetrate=3]="penetrate",t[t.critChance=4]="critChance",t[t.bulletCount=5]="bulletCount",t[t.skillInterval=6]="skillInterval",t[t.skillTimer=7]="skillTimer"}(l.heroPropertyType||(l.heroPropertyType={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emNEWBuffType||(l.emNEWBuffType={}));var p=function(){function t(){}return t.testID=0,t}();l.Global=p,cc._RF.pop(),cc._RF.pop()},{}],NEW_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"b9c08MAAFZJILIdH/WrAI5h","NEW_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"b9c08MAAFZJILIdH/WrAI5h","NEW_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("NEW_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_new/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emNEWBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getDragonBallShowCfg=function(){return this.data.dragonBallShowCfg},t.prototype.getDragonBallCfg=function(){return this.data.dragonBallCfg},t.prototype.getDragonBallCfgBYid=function(t){var e=this.data.dragonBallCfg;for(var o in e)if(e[o].dragonBallID==t)return e[o]},t.prototype.getMateOddsCfgByID=function(t){var e=this.data.mateOddsCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getBuffOddsCfgByAmount=function(t){var e=this.data.buffOddsCfg;for(var o in e)if(e[o].charAmount==t)return e[o]},t.prototype.getTaskCfg=function(){return this.data.taskCfg},t.prototype.getTaskCfgByID=function(t){var e=this.data.taskCfg;for(var o in e)if(e[o].taskID==t)return e[o]},t.prototype.getMahjongCfgByID=function(t){var e=this.data.mahjongCfg;for(var o in e)if(e[o].mahID==t)return e[o]},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],NEW_DragonBaseItem:[function(t,e,o){"use strict";cc._RF.push(e,"641fdqQk5FH9LIcA623DYh1","NEW_DragonBaseItem");var i=t,n=e,a=o;cc._RF.push(n,"641fdqQk5FH9LIcA623DYh1","NEW_DragonBaseItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("NodeLib"),f=i("NEW_Configs"),m=i("NEW_DataMgr"),g=i("new_gameCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteFrameArr=[],e.pro_Ani=null,e.nowIndex=0,e.dragonPath=[],e._isDestroy=!1,e.preNode=null,e.parent_Ctrl=null,e.mahjongID=1,e.gapNum=0,e.isFirst=!1,e.isLast=!1,e.testID=0,e}var o;return s(e,t),o=e,e.prototype.initParam=function(t,e,o,i,n,a,r,s){void 0===i&&(i=0),void 0===n&&(n=""),void 0===a&&(a=null),void 0===r&&(r=1),void 0===s&&(s=!1),this.node.active=!0,this.parent_Ctrl=o,this.nowIndex=Math.max(t,0),this.dragonPath=e,this._isDestroy=!1,this.itemPoolName=n,this.node.angle=this.getAngle(),this.gapNum=i,n==f.poolName.body_num&&(this.pro_Ani.node.active=!1,this.setMahjongID(r),this.isFirst=s),f.poolName.body_link,this.setPreNode(a)},e.prototype.doDestroy=function(){this._isDestroy||(this._isDestroy=!0,this.node.active=!1,this.itemPoolName==f.poolName.body_num&&(this.pro_Ani.node.active=!1))},e.prototype.doDestroyTweenDown=function(){if(this.itemPoolName==f.poolName.body_box||this.isFirst){var t=this.getNodeScaleX(),e=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.sendEvent(f.emNEWEventName.destroy,this.itemPoolName,e,this.node.angle,t)}},e.prototype.setPreNode=function(t){this.preNode=t},e.prototype.setIsLast=function(){this.isLast=!0},e.prototype.consoleNowIndex=function(){console.log("\u5f53\u524d\u8282\u70b9\u662f\u7b2c",this.testID,"\u4e2a\u8282\u70b9  ","\u6240\u5728\u70b9\u4f4d\u662f",this.nowIndex)},e.prototype.getNowIndex=function(){return this.nowIndex},e.prototype.getGapNum=function(){return this.gapNum},e.prototype.getIsDestroy=function(){return this._isDestroy},e.prototype.informPre=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=0),this.preNode&&(t&&(this.doDestroy(),e=this.gapNum),this.preNode=this.getInfactPre(),this.preNode.getComponent(o).setNodePosition(0,this.node.angle,e))},e.prototype.setLight=function(t){if(this.itemPoolName==f.poolName.body_num)for(var e in t)if(t[e]==this.mahjongID)return this.pro_Ani.node.active=!0,void this.pro_Ani.setAnimation(0,"animation",!0)},e.prototype.hideLight=function(t){this.itemPoolName==f.poolName.body_num&&this.mahjongID==t&&(this.pro_Ani.node.active=!1)},e.prototype.setMahjongID=function(t){this.mahjongID=t;var e=m.default.getInstance().getMahjongCfgByID(t);this.node.getComponent(cc.Sprite).spriteFrame=this.getSpriteFrameByName(e.image)},e.prototype.getAngle=function(){var t=this.dragonPath[this.nowIndex],e=this.dragonPath[this.nowIndex+1],o=e.sub(t);return e.x<t.x?90-180*o.signAngle(cc.v2(0,-1))/Math.PI:e.x>t.x?90-180*o.signAngle(cc.v2(0,1))/Math.PI:void 0},e.prototype.getSpriteFrameByName=function(t){for(var e in this.spriteFrameArr)if(this.spriteFrameArr[e].name==t)return this.spriteFrameArr[e];return null},e.prototype.getNodeScaleX=function(){var t=this.dragonPath[this.nowIndex],e=this.dragonPath[this.nowIndex+1].sub(t);return e.x<0?1:e.x>0?-1:void 0},e.prototype.getInfactPre=function(){for(var t=this.preNode;t&&!t.active;)t.getComponent(o).removeInParent(),t=t.getComponent(o).preNode;return t},e.prototype.setNodePosition=function(t,e,o){var i=this;this.informPre(!1,o),this.nowIndex-=o,this.node.angle=e;var n=this.dragonPath[this.nowIndex];this.node.setPosition(n),this.preNode||(this.node.scaleX=this.getNodeScaleX()),this.preNode||"die"!=this.node.getComponent(sp.Skeleton).animation&&(this.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1),this.node.getComponent(sp.Skeleton).setCompleteListener(function(){i.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}))},e.prototype.removeInParent=function(){p.PoolMgr.getInstance().freeNode(this.itemPoolName,this.node),this.parent_Ctrl.removeBodyItem(this)},e.prototype.onLoad=function(){var t=h.default.findChildByName(this.node,"pro_Ani");t&&(this.pro_Ani=t.getComponent(sp.Skeleton))},e.prototype.start=function(){},e.prototype.onUpdate=function(t,e){if(!this._isDestroy){if(this.nowIndex+=e,this.nowIndex>=this.dragonPath.length-1)return u.UIMgr.getInstance().openUI(f.NEW_UIID.UIResult,d.UIID.UINONE),void g.default.instance.onGameOver();var o=this.dragonPath[this.nowIndex];this.node.setPosition(o),this.node.angle=this.getAngle(),this.preNode||(this.node.scaleX=this.getNodeScaleX()),this.isLast&&(this.node.scaleX=-this.getNodeScaleX())}},c([_(cc.SpriteFrame)],e.prototype,"spriteFrameArr",void 0),o=c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],NEW_DragonBloodItem:[function(t,e,o){"use strict";cc._RF.push(e,"3ac2d/6GJxP16Tkscm+zpwq","NEW_DragonBloodItem");var i=t,n=e,a=o;cc._RF.push(n,"3ac2d/6GJxP16Tkscm+zpwq","NEW_DragonBloodItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("NEW_Configs"),d=i("new_gameCtrl"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_collider=null,e.pro_hpLabel=null,e.targetNode=null,e.childCtrlArr=[],e._isDestroy=!1,e.parent_Ctrl=null,e.mahjongID=-1,e.canBeHit=!1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_collider=this.node.getChildByName("pro_collider"),this.pro_hpLabel=this.node.getChildByName("pro_hpLabel").getComponent(cc.Label),this.canBeHit=!1},e.prototype.initParam=function(t,e,o,i,n,a,r){void 0===r&&(r=-1),this.pro_hpLabel.string=t+"",this.mahjongID=r,1==e?(this.pro_collider.setContentSize(cc.size(130,130)),this.pro_hpLabel.node.color=cc.color(255,255,255),this.pro_hpLabel.node.position=cc.v3(0,o-30,0)):(this.pro_collider.setContentSize(cc.size(300,150)),this.pro_hpLabel.node.color=cc.color().fromHEX("#fff449"),this.pro_hpLabel.node.position=cc.v3(0,-o,0)),this.node.active=!0,this.targetNode=i,this.parent_Ctrl=n,this._isDestroy=!1,this.index=a},e.prototype.doCanbeHitDown=function(){this.canBeHit=!0},e.prototype.addChildNode=function(t){this.childCtrlArr.push(t)},e.prototype.checkCollision=function(t,e,o){return!(this._isDestroy||!this.canBeHit||!this.inRange(t)||(this.sendEvent(u.emNEWEventName.hitEffect,t),this.loseHP(e,t,o),0))},e.prototype.checkRangeCollision=function(t,e){if(this._isDestroy||!this.canBeHit)return!1;if(this.getWorldColldierRect().intersects(t)){var o=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.loseHP(e,o,!1)}},e.prototype.checkInSkillRange=function(t){if(this._isDestroy)return null;var e=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);return Math.abs(e.x-t.x)<100?this.node:null},e.prototype.loseHP=function(t,e,o){p.AudioMgr.getInstance().playEffect(u.NEW_AudioId.dragonHit,u.NEW_AudioId.dragonHit);var i=parseInt(this.pro_hpLabel.string)-t;this.pro_hpLabel.string=i+"",this.sendEvent(u.emNEWEventName.loseBlood,t,e,o),i<=0&&this.doDie()},e.prototype.doDie=function(){var t=this;p.AudioMgr.getInstance().playEffect(u.NEW_AudioId.burn,u.NEW_AudioId.burn),this._isDestroy=!0,this.node.active=!1,this.parent_Ctrl.removeBloodItem(this),this.targetNode=null,this.sendEvent(u.emNEWEventName.screenShake),-1!=this.mahjongID&&this.commitTask(),d.default.instance.getPro_buttomCtrl().getBuffCtrl().addBuff(this.index),this.node.removeFromParent();for(var e=this.childCtrlArr.length,o=function(o){i.childCtrlArr[o].doDestroyTweenDown(),i.scheduleOnce(function(){t.childCtrlArr[o].informPre(!0)},.05*(e-o))},i=this,n=0;n<this.childCtrlArr.length;n++)o(n)},e.prototype.commitTask=function(){d.default.instance.getPro_topCtrl().getMahjongCtrl().commitTask(this.mahjongID)},e.prototype.inRange=function(t){var e=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);return cc.rect(e.x-this.pro_collider.width/2,e.y-this.pro_collider.height/2,this.pro_collider.width,this.pro_collider.height).contains(t)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(){if(!this._isDestroy&&this.targetNode){var t=this.targetNode.getPosition(),e=this.targetNode.parent.convertToWorldSpaceAR(t),o=this.node.parent.convertToNodeSpaceAR(e);this.node.setPosition(o),this.node.angle=this.targetNode.angle}},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],NEW_ExtraBuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"a0725DvC6RFgqIOMyxUZS8m","NEW_ExtraBuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"a0725DvC6RFgqIOMyxUZS8m","NEW_ExtraBuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("NodeLib"),d=i("NEW_Configs"),h=i("new_GameEnumData"),f=i("NEW_DataMgr"),m=i("new_gameCtrl"),g=cc._decorator,y=g.ccclass;g.property,function(t){t.skillcd="skillcd",t.speedup="speedup",t.froze="froze",t.penetrate="penetrate"}(l||(l={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_LabelNode=null,e.pro_windNode=null,e.pro_skillNode=null,e.pro_iceNode=null,e.labelShowTime=0,e.isShowLabel=!1,e.remainTime=0,e.iceSkillTime=0,e.iceState=!1,e.windSkillTime=0,e.windState=!1,e.windChangeSpeed=0,e.reduceCdSkillTime=0,e.reduceCdState=!1,e.reduceCdSkillChange=0,e.penetrateSkillTime=0,e.penetrateState=!1,e.windSkillArr=[],e.reduceCdSkillArr=[],e}return s(e,t),e.prototype.initProperty=function(){this.pro_LabelNode=u.default.findChildByName(this.node,"pro_LabelNode"),this.pro_windNode=u.default.findChildByName(this.node,"pro_windNode"),this.pro_skillNode=u.default.findChildByName(this.node,"pro_skillNode"),this.pro_iceNode=u.default.findChildByName(this.node,"pro_iceNode")},e.prototype.initParam=function(){this.labelShowTime=f.default.getInstance().getParam(h.enumBasicParaCfg.tipsStayTime)},e.prototype.test=function(t,e){var o=parseInt(e),i=f.default.getInstance().getTaskCfgByID(o);this.addExtraBuff(i)},e.prototype.addExtraBuff=function(t){var e=t.finishDes;this.showLabelNode(e,t.tipsIcon);var o=t.buffType;switch(o){case l.speedup:case l.skillcd:this.doContinueSkillDown(t,o);break;case l.froze:this.doIceSkillDown(t);break;case l.penetrate:this.doLightningSkillDown(t)}},e.prototype.resumeExtraBuff=function(t){var e=m.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList();if(this.iceState&&(this.iceSkillTime-=t,this.iceSkillTime<=0&&this.resumeIceSkill()),this.windState&&(this.windSkillTime-=t,this.windSkillTime<=0)){for(var o in this.windState=!1,this.windSkillArr)this.windSkillArr[o].removeFromParent();this.windSkillArr=[];for(var i=0;i<e.length;i++)e[i].setWindState(!1)}if(this.reduceCdState&&(this.reduceCdSkillTime-=t,this.reduceCdSkillTime<=0)){for(var o in this.reduceCdState=!1,this.reduceCdSkillArr)this.reduceCdSkillArr[o].removeFromParent();for(this.reduceCdSkillArr=[],i=0;i<e.length;i++)e[i].setReduceCdState(!1)}if(this.penetrateState&&(this.penetrateSkillTime-=t,this.penetrateSkillTime<=0))for(this.penetrateState=!1,i=0;i<e.length;i++)e[i].setLightState(!1)},e.prototype.listenAniEnd=function(){var t=this,e=this.pro_iceNode.getComponent(sp.Skeleton);e.setCompleteListener(function(o){"dj_1"==o.animation.name?e.setAnimation(0,"dj_2",!0):"dj_3"==o.animation.name&&(t.pro_iceNode.active=!1)})},e.prototype.doConinueSkill=function(){this.windState&&this.skillContinueEffect(l.speedup),this.reduceCdState&&this.skillContinueEffect(l.skillcd),this.penetrateState&&this.doContinueLightningSkill()},e.prototype.doContinueSkillDown=function(t,e){var o,i;e==l.speedup?(this.windState=!0,this.windChangeSpeed=t.buffPara1,this.windSkillTime=t.buffPara2,o=this.pro_windNode,i=this.windSkillArr):e==l.skillcd&&(this.reduceCdState=!0,this.reduceCdSkillChange=t.buffPara1,this.reduceCdSkillTime=t.buffPara2,o=this.pro_skillNode,i=this.reduceCdSkillArr);for(var n=m.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList(),a=0;a<n.length;a++){var r=cc.instantiate(o);r.active=!0,r.parent=n[a].node,r.getComponent(sp.Skeleton).setAnimation(0,"animation",!0),e==l.speedup?n[a].setWindState(!0,this.windChangeSpeed):e==l.skillcd&&n[a].setReduceCdState(!0,this.reduceCdSkillChange),i.push(r)}},e.prototype.skillContinueEffect=function(t){var e,o,i;t==l.speedup?(e=this.windSkillArr,o=this.windChangeSpeed,i=this.pro_windNode):t==l.skillcd&&(e=this.reduceCdSkillArr,o=this.reduceCdSkillChange,i=this.pro_skillNode);for(var n=m.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList(),a=e.length;a<n.length;a++){var r=cc.instantiate(i);r.active=!0,r.parent=n[a].node,r.getComponent(sp.Skeleton).setAnimation(0,"animation",!0),t==l.speedup?n[a].setWindState(!0,o):t==l.skillcd&&n[a].setReduceCdState(!0,o),e.push(r)}},e.prototype.doIceSkillDown=function(t){this.iceState=!0,this.iceSkillTime=t.buffPara1,this.pro_iceNode.active=!0,this.pro_iceNode.getComponent(sp.Skeleton).setAnimation(0,"dj_1",!1),m.default.instance.getPro_topCtrl().setIceState(!0)},e.prototype.resumeIceSkill=function(){this.iceState=!1,this.pro_iceNode.getComponent(sp.Skeleton).setAnimation(0,"dj_3",!1),m.default.instance.getPro_topCtrl().setIceState(!1)},e.prototype.doLightningSkillDown=function(t){var e=m.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList();this.penetrateState=!0,this.penetrateSkillTime=t.buffPara1;for(var o=0;o<e.length;o++)e[o].setLightState(!0)},e.prototype.doContinueLightningSkill=function(){for(var t=m.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList(),e=0;e<t.length;e++)t[e].setLightState(!0)},e.prototype.showLabelNode=function(t,e){var o=this;this.loadSpriteFrame(d.emNEWBundles.imgs,"extraBuff/"+e,function(e){o.pro_LabelNode.getComponentInChildren(cc.Sprite).spriteFrame=e,o.isShowLabel=!0,o.remainTime=o.labelShowTime,o.pro_LabelNode.active=!0,o.pro_LabelNode.getComponentInChildren(cc.Label).string=t})},e.prototype.hideLabelNode=function(){this.isShowLabel=!1,this.pro_LabelNode.active=!1},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.initParam(),this.listenAniEnd()},e.prototype.onUpdate=function(t){this.isShowLabel&&(this.remainTime-=t,this.remainTime<=0&&this.hideLabelNode()),this.doConinueSkill(),this.resumeExtraBuff(t)},c([y],e)}(p.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],NEW_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1c98fl85wFI/Y6awYCSyF69","NEW_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1c98fl85wFI/Y6awYCSyF69","NEW_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NodeLib"),u=i("new_GameEnumData"),d=i("NEW_DataMgr"),h=i("new_gameCtrl"),f=i("NEW_HeroItem"),m=i("NEW_SkillCtrl"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_heroLayer=null,e.pro_skillCtrl=null,e.pro_Item=null,e.heroList=[],e.tempTime=0,e.haveTempHero=!1,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_heroLayer=this.node.getChildByName("pro_heroLayer"),this.pro_Item=this.node.getChildByName("pro_Item"),this.pro_skillCtrl=p.default.findChildByName(this.node,"pro_skillCtrl").getComponent(m.default)},e.prototype.addFirstHero=function(){for(var t=d.default.getInstance().getCharacter(),e=[],o=0;o<t.length;o++)14!=t[o].characterID&&e.push(t[o].characterID);var i=Math.floor(Math.random()*e.length);this.addHero(e[i])},e.prototype.moveHero=function(t){this.pro_heroLayer.x+=t},e.prototype.addHero=function(t){if(this.getHeroList().length>=3)console.error("\u82f1\u96c4\u6570\u91cf\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650");else{h.default.instance.getPro_buttomCtrl().getTarmCtrl().pushCard(t);var e=cc.instantiate(this.pro_Item);e.active=!0;var o=e.getComponent(f.default);e.parent=this.pro_heroLayer,this.heroList.push(o);var i=0;1==this.heroList.length?i=d.default.getInstance().getParam(u.enumBasicParaCfg.basicATK):2==this.heroList.length?i=d.default.getInstance().getParam(u.enumBasicParaCfg.secondCharATK):3==this.heroList.length&&(i=d.default.getInstance().getParam(u.enumBasicParaCfg.thirdCharATK)),o.initParam(t,i,this.pro_skillCtrl)}},e.prototype.removeHero=function(t){h.default.instance.getBullletLayerByHeroIndex(t).removeAllChildren();for(var e=0;e<this.heroList.length;e++)if(this.heroList[e].getIndex()==t){this.heroList[e].node.removeFromParent(),this.heroList.splice(e,1);break}},e.prototype.getHeroWorldPos=function(){var t=this.pro_heroLayer.x+this.pro_heroLayer.width/2,e=this.pro_heroLayer.y;return this.pro_heroLayer.parent.convertToWorldSpaceAR(cc.v2(t,e))},e.prototype.addTempHero=function(t,e,o,i,n){var a=cc.instantiate(this.pro_Item);this.haveTempHero=!0,a.active=!0;var r=a.getComponent(f.default);a.parent=this.pro_heroLayer,this.heroList.push(r),r.initTempHero(t,e,o,n),this.tempTime=i},e.prototype.getHeroItemCtrlByIndex=function(t){for(var e=0;e<this.heroList.length;e++)if(this.heroList[e].getIndex()==t)return this.heroList[e]},e.prototype.getHeroList=function(){var t=[];for(var e in this.heroList)14!=this.heroList[e].getIndex()&&t.push(this.heroList[e]);return t},e.prototype.checkHeroPosX=function(){return this.pro_heroLayer.x<=0},e.prototype.getHeroLayer=function(){return this.pro_heroLayer.getComponent(cc.Widget).updateAlignment(),this.pro_heroLayer},e.prototype.onLoad=function(){this.initPorperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.haveTempHero&&(this.tempTime-=t,this.tempTime<=0&&(this.haveTempHero=!1,this.removeHero(14)));for(var e=0;e<this.heroList.length;e++)this.heroList[e].onUpdate(t);this.pro_skillCtrl.onUpdate(t)},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],NEW_HeroItem:[function(t,e,o){"use strict";cc._RF.push(e,"6446bnRqTlH37VnHcoLunVm","NEW_HeroItem");var i=t,n=e,a=o;cc._RF.push(n,"6446bnRqTlH37VnHcoLunVm","NEW_HeroItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("NodeLib"),h=i("NEW_Configs"),f=i("new_GameEnumData"),m=i("NEW_DataMgr"),g=i("new_gameCtrl"),y=i("NEW_BulletBaseItem"),v=cc._decorator,_=v.ccclass,b=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_heroBgIcon=null,e.pro_icon=null,e.pro_itemName=null,e.pro_percentIcon=null,e.pro_skillIcon=null,e.pro_bulletPos=null,e.pro_skillAni=null,e.pro_buffAni=null,e.bulletArr=[],e.flyingBullet=[],e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.maxAttackSpeed=12,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.skillTimer=0,e.skillMultiplier=0,e.speedInfactTimer=1,e.maxBulletNum=1e4,e.bulletTime=0,e.skillCtrl=null,e.isTemp=!1,e.windState=!1,e.windChangeSpeed=0,e.reduceCdState=!1,e.reduceCdSkillChange=0,e.lightState=!1,e.bullteAudioID=0,e.maxBulletAudioID=3,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_heroBgIcon=this.node.getComponent(cc.Sprite),this.pro_icon=d.default.findChildByName(this.node,"pro_icon").getComponent(cc.Sprite),this.pro_itemName=d.default.findChildByName(this.node,"pro_itemName").getComponent(cc.Label),this.pro_percentIcon=d.default.findChildByName(this.node,"pro_percentIcon").getComponent(cc.Sprite),this.pro_skillIcon=d.default.findChildByName(this.node,"pro_skillIcon").getComponent(cc.Sprite),this.pro_bulletPos=d.default.findChildByName(this.node,"pro_bulletPos").getPosition(),this.pro_skillAni=d.default.findChildByName(this.node,"pro_skillAni").getComponent(sp.Skeleton),this.pro_buffAni=d.default.findChildByName(this.node,"pro_buffAni").getComponent(sp.Skeleton)},e.prototype.modifyAttribute=function(t,e,o,i,n){switch(this.doAddBuffTween(),t){case h.heroPropertyType.attackPower:this.modifyAttackPower(e,o);break;case h.heroPropertyType.attackSpeed:this.modifyAttackSpeed(e,o);break;case h.heroPropertyType.penetrate:this.modifyPenetrate(e,o,i,n);break;case h.heroPropertyType.critChance:this.modifyCritChance(e,o);break;case h.heroPropertyType.bulletCount:this.modifyBulletCount(e,o);break;case h.heroPropertyType.skillInterval:this.modifySkillInterval(o,.5);break;case h.heroPropertyType.skillTimer:this.modifySkillMultiplier(o);break;default:console.warn("Unknown attribute: "+t)}},e.prototype.initParam=function(t,e,o){this.attackPower=e,this.heroIndex=t,this.skillCtrl=o,this.bulletCount=m.default.getInstance().getParam(f.enumBasicParaCfg.basicBullet),this.initHeroData()},e.prototype.initTempHero=function(t,e,o,i){this.attackPower=e,this.heroIndex=t,this.attackSpeedMultiplier=o,this.bulletCount=i,this.initHeroData(),this.isTemp=!0},e.prototype.recycleBullet=function(t){for(var e=0;e<this.flyingBullet.length;e++)if(this.flyingBullet[e].uuid==t.uuid){this.flyingBullet.splice(e,1),this.bulletArr.push(t);break}},e.prototype.getIndex=function(){return this.heroIndex},e.prototype.setWindState=function(t,e){void 0===e&&(e=0),this.windState=t,this.windChangeSpeed=e},e.prototype.setReduceCdState=function(t,e){void 0===e&&(e=0),this.reduceCdState=t,this.reduceCdSkillChange=e},e.prototype.setLightState=function(t){this.lightState=t},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.getPenetrate=function(){return this.penetrate},e.prototype.getAttackSpeed=function(){return this.attackSpeedMultiplier},e.prototype.isMaxAttackSpeed=function(){return this.attackSpeedMultiplier>=this.maxAttackSpeed},e.prototype.getBulletCount=function(){return this.bulletCount},e.prototype.getIsCirt=function(){return Math.random()<this.critChance},e.prototype.getCirtDamage=function(t){return t?this.critMultiplier*this.attackPower:this.attackPower},e.prototype.initHeroData=function(){this.attackSpeed=m.default.getInstance().getParam(f.enumBasicParaCfg.basicASPD),this.penetrate=m.default.getInstance().getParam(f.enumBasicParaCfg.basicPenetrate),this.flySpeed=m.default.getInstance().getParam(f.enumBasicParaCfg.bulletFlySpeed),this.critChance=m.default.getInstance().getParam(f.enumBasicParaCfg.basicCrit),this.critMultiplier=m.default.getInstance().getParam(f.enumBasicParaCfg.critDamage),this.maxBulletNum=1e4;var t=m.default.getInstance().getCharacterByID(this.heroIndex);this.skillInterval=t.skillCDtime,this.skillMultiplier=t.skillATK,this.skillAudioName=t.skillSound,this.speedInfactTimer=t.characterASPD,t.disappearTime?this.bulletTime=t.disappearTime:this.bulletTime=999999,this.bulletPoolName=h.poolName.bulletName+this.heroIndex,this.lastAttackTime=0,this.initView()},e.prototype.initView=function(){var t=this,e=this.heroIndex,o=m.default.getInstance().getCharacterByID(e);this.loadSpriteFrame(h.emNEWBundles.imgs,"backs/"+o.cardColor,function(e){t.pro_heroBgIcon.spriteFrame=e}),this.loadSpriteFrame(h.emNEWBundles.imgs,"js/js_"+e,function(e){t.pro_icon.spriteFrame=e}),this.loadSpriteFrame(h.emNEWBundles.imgs,"skill/"+o.skillIcon,function(e){t.pro_skillIcon.spriteFrame=e}),this.pro_itemName.string=o.characterName},e.prototype.doAddBuffTween=function(){var t=this;this.pro_buffAni.node.active=!0,this.pro_buffAni.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.pro_buffAni.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.pro_buffAni.node.active=!1},.1)})},e.prototype.modifyAttackPower=function(t,e){1==t?this.attackPower+=e:this.attackPower*=e,this.attackPower=Math.floor(this.attackPower)},e.prototype.modifyAttackSpeed=function(t,e){this.attackSpeedMultiplier+=e/m.default.getInstance().getParam(f.enumBasicParaCfg.speedPlusTimes)},e.prototype.modifyPenetrate=function(t,e,o,i){1==t?this.penetrate+=e:2==t?this.penetrate*=e:3==t&&(this.penetrate+e>o?this.modifyAttackSpeed(1,i):this.penetrate+=e)},e.prototype.modifyCritChance=function(t,e){1==t?this.critChance+=e:2==t?this.critChance*=e:3==t&&(this.critChance>=1?this.modifyBulletCount(1,1):this.critChance+=e)},e.prototype.modifyBulletCount=function(t,e){1==t?this.bulletCount+=e:this.bulletCount*=e},e.prototype.modifySkillInterval=function(t,e){var o=this.skillInterval*(1-t);(o=Number(o.toFixed(2)))<e&&(o=e),this.skillInterval=o},e.prototype.modifySkillMultiplier=function(t){this.skillMultiplier*=t},e.prototype.updateFire=function(t){this.nowAttackTime+=t,this.nowAttackTime-this.lastAttackTime>this._AttackSpeed&&(this.lightState?this.fireLightBullets():this.fireBullets(),this.lastAttackTime=this.nowAttackTime)},e.prototype.fireBullets=function(){this.bullteAudioID++,this.bullteAudioID%=this.maxBulletAudioID,p.AudioMgr.getInstance().playEffect(h.NEW_AudioId.bullet,this.bulletPoolName+this.bullteAudioID);for(var t=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,e=0;e<this.bulletCount;e++){var o=this.getBullet(),i=cc.v2(t+30*e,this.node.y),n=this.node.convertToWorldSpaceAR(i);i=o.node.parent.convertToNodeSpaceAR(n),o.node.setPosition(i),o.initParam(this.bulletRange,this.penetrate,this.flySpeed,this,this.bulletTime),this.flyingBullet.push(o)}},e.prototype.fireLightBullets=function(){p.AudioMgr.getInstance().playEffect(h.NEW_AudioId.lightningBullet,this.bulletPoolName+this.bullteAudioID);var t=u.PoolMgr.getInstance().getNode(h.poolName.Bullet_skill);t.parent=g.default.instance.getBullletLayerByHeroIndex("Skill");var e=cc.v2(0,this.node.y),o=this.node.convertToWorldSpaceAR(e);e=t.parent.convertToNodeSpaceAR(o),t.setPosition(e),t.getComponentInChildren(cc.Animation).play(),this.lightDamage(t,Math.floor(this.attackPower*this.bulletCount*1.5)),this.scheduleOnce(function(){u.PoolMgr.getInstance().freeNode(h.poolName.Bullet_skill,t)},.1)},e.prototype.lightDamage=function(t,e){g.default.instance.getPro_topCtrl().checkRangeSkill(this.getWorldColldierRect(t),e)},e.prototype.getWorldColldierRect=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var i=t.getAnchorPoint(),n=t.convertToWorldSpaceAR(cc.Vec2.ZERO),a=(t.width+e)*t.scaleX,r=(t.height+o)*t.scaleY;return cc.rect(n.x-i.x*a,n.y-i.y*r,a,r)},e.prototype.getBullet=function(){if(this.flyingBullet.length>=this.maxBulletNum)for(var t in this.flyingBullet)if(this.flyingBullet[t]){this.flyingBullet[t].doResycleNoBounceBulletDown();break}var e=this.bulletArr.pop();if(!e){var o=u.PoolMgr.getInstance().getNode(this.bulletPoolName);o.parent=g.default.instance.getBullletLayerByHeroIndex(this.heroIndex),e=o.getComponent(y.default)}return e},e.prototype.contrlBullet=function(t){for(var e=0;e<this.flyingBullet.length;e++){var o=this.flyingBullet[e];o&&o.onUpdate(t)}},Object.defineProperty(e.prototype,"_AttackSpeed",{get:function(){var t=this.speedInfactTimer*this.attackSpeedMultiplier;return this.windChangeSpeed&&(t+=this.windChangeSpeed),t<this.speedInfactTimer&&(t=this.speedInfactTimer),this.attackSpeed/t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_skillInterval",{get:function(){var t=this.skillInterval;return this.reduceCdState&&(t=this.reduceCdSkillChange),t},enumerable:!1,configurable:!0}),e.prototype.contrlSkill=function(t){this.isTemp||(this.skillTimer+=t,this.updateSkillBar(),this.skillTimer>=this._skillInterval&&this.useSkill())},e.prototype.updateSkillBar=function(){var t=this.skillTimer/this._skillInterval;this.pro_percentIcon.fillRange=t},e.prototype.useSkill=function(){var t=this,e=this.attackPower*this.skillMultiplier,o=this.node.convertToWorldSpaceAR(this.pro_bulletPos);this.pro_skillAni.node.active=!0,this.pro_skillAni.setAnimation(0,"animation",!1),this.pro_skillAni.setCompleteListener(function(){t.pro_skillAni.node.active=!1}),this.skillCtrl.useSkill(this.heroIndex,e,o)&&(this.skillTimer=0)},e.prototype.onLoad=function(){this.initPorperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.updateFire(t),this.contrlBullet(t),this.contrlSkill(t)},c([_],e)}(l.default));a.default=b,cc._RF.pop(),cc._RF.pop()},{}],NEW_MahjongCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1d5abUCxTBIlYdpk/ZFLf+U","NEW_MahjongCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1d5abUCxTBIlYdpk/ZFLf+U","NEW_MahjongCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("NodeLib"),d=i("NEW_Configs"),h=i("NEW_DataMgr"),f=i("new_gameCtrl"),m=i("NEW_ExtraBuffCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mahjongSpArr=[],e.pro_Layer=null,e.pro_Item=null,e.pro_Node=null,e.pro_Label=null,e.pro_ExtraBuffCtrl=null,e.taskCfgList=[],e.nowMahjongList=[],e.needLightMahjongArr=[],e.taskNum=0,e.isLock=!1,e.nowTaskcfg=null,e.addAttackPower=0,e}return s(e,t),e.prototype.initProperty=function(){this.pro_Layer=u.default.findChildByName(this.node,"pro_Layer"),this.pro_Item=u.default.findChildByName(this.node,"pro_Item"),this.pro_Node=u.default.findChildByName(this.node,"pro_Node"),this.pro_Ani=u.default.findChildByName(this.node,"pro_Ani").getComponent(sp.Skeleton),this.pro_addAni=u.default.findChildByName(this.node,"pro_addAni").getComponent(sp.Skeleton),this.pro_Label=u.default.findChildByName(this.node,"pro_Label").getComponent(cc.Label),this.pro_ExtraBuffCtrl=u.default.findChildByName(this.node,"pro_ExtraBuffCtrl"),this.isLock=!1},e.prototype.setExtraBuffOnUpdate=function(t){this.pro_ExtraBuffCtrl.getComponent(m.default).onUpdate(t)},e.prototype.commitTask=function(t){if(!this.isLock){var e=!1;for(var o in this.needLightMahjongArr)if((a=this.needLightMahjongArr[o])==t){e=!0,this.needLightMahjongArr.splice(parseInt(o),1);break}for(var o in e&&-1==this.needLightMahjongArr.indexOf(t)&&f.default.instance.getPro_topCtrl().hideLight(t),this.pro_Layer.children){var i=parseInt(o),n=this.pro_Layer.children[i],a=this.nowMahjongList[i];if(n.childrenCount>0){var r=n.children[0];if(a==t)return void this.doCommitTaskDown(r)}}}},e.prototype.getNowTaskCfg=function(){return this.nowTaskcfg},e.prototype.getNeedLightMahjongArr=function(){return this.needLightMahjongArr},e.prototype.doCommitTaskDown=function(t){t.removeFromParent(),this.taskNum--,p.AudioMgr.getInstance().playEffect(d.NEW_AudioId.levelup,"mahjong1"),this.pro_addAni.node.active=!0,this.pro_addAni.setAnimation(0,"animation",!1),this.taskNum<=0&&(this.isLock=!0,this.pro_Ani.node.active=!0,this.pro_Ani.setAnimation(0,this.nowTaskcfg.taskSound,!1))},e.prototype.initLorrey=function(){this.taskCfgList=h.default.getInstance().getTaskCfg()},e.prototype.refreshTask=function(){var t=Math.floor(Math.random()*this.taskCfgList.length);this.nowTaskcfg=this.taskCfgList[t],this.pro_Layer.removeAllChildren();var e=h.default.getInstance().getBuffByKey(this.nowTaskcfg.buffType);this.refreshTaskLabel(e,this.nowTaskcfg),this.nowMahjongList=[],this.needLightMahjongArr=[],this.taskNum=0,this.nowTaskcfg.mahID1&&this.createMahjong(this.nowTaskcfg.mahID1),this.nowTaskcfg.mahID2&&this.createMahjong(this.nowTaskcfg.mahID2),this.nowTaskcfg.mahID3&&this.createMahjong(this.nowTaskcfg.mahID3),this.nowTaskcfg.mahID4&&this.createMahjong(this.nowTaskcfg.mahID4)},e.prototype.refreshTaskLabel=function(){},e.prototype.createAttackNum=function(t){var e=f.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroList(),o=0;for(var i in e){var n=e[i].getAttackPower();o=Math.max(o,n)}var a=Math.floor(o*t);return(a=Math.max(50,a))-a%10},e.prototype.createMahjong=function(t){this.nowMahjongList.push(t),this.needLightMahjongArr.push(t),this.taskNum++;var e=cc.instantiate(this.pro_Item);this.pro_Layer.addChild(e),e.active=!0;var o=h.default.getInstance().getMahjongCfgByID(t);e.getComponent(cc.Sprite).spriteFrame=this.getMahgonSpritframeByName(o.image)},e.prototype.doBuffDown=function(){p.AudioMgr.getInstance().playEffect(this.nowTaskcfg.taskSound,"mahjong"),this.pro_ExtraBuffCtrl.getComponent(m.default).addExtraBuff(this.nowTaskcfg)},e.prototype.getMahgonSpritframeByName=function(t){for(var e in this.mahjongSpArr){var o=this.mahjongSpArr[e];if(o.name==t)return o}return null},e.prototype.changeLightMahjong=function(){f.default.instance.getPro_topCtrl().showLight(this.needLightMahjongArr)},e.prototype.doRefreshTaskTween=function(){var t=this;this.doBuffDown();var e=this.pro_Node.width;cc.tween(this.pro_Node).by(.5,{x:e}).delay(.2).call(function(){t.refreshTask(),t.changeLightMahjong()}).by(.5,{x:-e}).call(function(){t.isLock=!1}).start()},e.prototype.onLoad=function(){var t=this;this.initProperty(),this.pro_Ani.setCompleteListener(function(){t.doRefreshTaskTween()}),this.pro_addAni.setCompleteListener(function(){})},e.prototype.start=function(){this.initLorrey(),this.refreshTask()},c([v(cc.SpriteFrame)],e.prototype,"mahjongSpArr",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],NEW_MateIconItem:[function(t,e,o){"use strict";cc._RF.push(e,"7cccaYoM4lFaLtq+lRW7tiz","NEW_MateIconItem");var i=t,n=e,a=o;cc._RF.push(n,"7cccaYoM4lFaLtq+lRW7tiz","NEW_MateIconItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NEW_DataMgr"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_cdLabel=null,e.pro_skillLabel=null,e.pro_cdPercent=null,e.pro_skillIcon=null,e.pro_spNode=null,e.maxCDTime=0,e.cdTime=0,e.mateID=1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_cdLabel=this.node.getChildByName("pro_cdLabel").getComponent(cc.Label),this.pro_skillLabel=this.node.getChildByName("pro_skillLabel").getComponent(cc.Label),this.pro_cdPercent=this.node.getChildByName("pro_cdPercent").getComponent(cc.Sprite),this.pro_skillIcon=this.node.getComponent(cc.Sprite),this.pro_spNode=this.node.getChildByName("pro_spNode").getComponent(sp.Skeleton)},e.prototype.initNode=function(t,e,o){this.pro_skillIcon.spriteFrame=e,this.mateID=t,this.mateSkillCtrl=o,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=p.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=t.mateCDtime},e.prototype.initView=function(){var t=p.default.getInstance().getMateCfgByID(this.mateID);this.pro_skillLabel.string=t.mateName,this.pro_cdPercent.fillRange=0,this.pro_cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){var t=this;this.cdTime<=0&&(this.mateSkillCtrl.useSkill(this.mateID),this.scheduleOnce(function(){t.initStartUseSkill()},.1))},e.prototype.initStartUseSkill=function(){this.pro_cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.pro_cdLabel.string=this.cdTime+"",this.pro_cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.pro_cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.pro_cdLabel.node.active=!1,this.pro_spNode.node.active=!0,this.pro_spNode.setAnimation(0,"animation",!1),this.pro_spNode.setCompleteListener(function(){e.pro_spNode.node.active=!1})):this.pro_cdLabel.string=this.cdTime.toFixed(0)},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],NEW_MateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"f5be8jTd8dMUIgIaQxCSdmi","NEW_MateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"f5be8jTd8dMUIgIaQxCSdmi","NEW_MateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("NEW_Configs"),h=i("NEW_DataMgr"),f=i("new_gameCtrl"),m=i("NEW_MateSkillItem"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.useSkill=function(t){var e=u.PoolMgr.getInstance().getNode(d.poolName.MateSkill+t);this.node.addChild(e),e.setPosition(0,0),this.doUseSkillDown(e,t)},e.prototype.doUseSkillDown=function(t,e){var o=t.getComponent(m.default),i=h.default.getInstance().getMateCfgByID(e);p.AudioMgr.getInstance().playEffect(i.mateSound,"mateSkill");var n=i.mateRole.split(","),a=parseInt(n[0]),r=parseInt(n[1]),s=[],c=f.default.instance.getPro_buttomCtrl().getHeroCtrl();s.push(c.getHeroItemCtrlByIndex(a)),s.push(c.getHeroItemCtrlByIndex(r));var l=Math.max(s[0].getAttackPower(),s[1].getAttackPower()),u=i.mateSkillATK*l;o.useSkill(u,e,s)},e.prototype.start=function(){},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],NEW_MateSkillItem:[function(t,e,o){"use strict";cc._RF.push(e,"a2636JsntBLpa7Cov/mxHMY","NEW_MateSkillItem");var i=t,n=e,a=o;cc._RF.push(n,"a2636JsntBLpa7Cov/mxHMY","NEW_MateSkillItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("NodeLib"),u=i("NEW_Configs"),d=i("NEW_DataMgr"),h=i("new_gameCtrl"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_spAni=null,e.index=0,e.damage=0,e.heroItemArr=[],e}return s(e,t),e.prototype.initProperty=function(){this.pro_spAni=p.default.findChildByName(this.node,"spAni").getComponent(sp.Skeleton)},e.prototype.useSkill=function(t,e,o){if(this.heroItemArr=l(o),d.default.getInstance().getMateCfgByID(e),this.index=e,this.pro_spAni.setAnimation(0,"animation",!1),7!=e)this.node.setPosition(0,h.default.instance.getPro_topCtrl().getHeadY());else{var i=h.default.instance.getPro_buttomCtrl().getHeroCtrl().getHeroWorldPos(),n=this.node.parent.convertToNodeSpaceAR(i);this.node.setPosition(n)}this.damage=t},e.prototype.doMateSkillCtrl=function(t,e){1==t?this.doMateSkill1(e):2==t?this.doMateSkill2(e):3==t?this.doMateSkill3(e):4==t?this.doMateSkill4(e):5==t?this.doMateSkill5(e):6==t?this.doMateSkill6(e):7==t&&this.doMateSkill7(e)},e.prototype.doMateSkill1=function(t){for(var e in this.heroItemArr)this.heroItemArr[e].modifyAttribute(u.heroPropertyType.attackSpeed,1,Number(t.matePara))},e.prototype.doMateSkill2=function(t){var e=Math.max(this.heroItemArr[0].getAttackPower(),this.heroItemArr[1].getAttackPower()),o=Math.floor(e*Number(t.matePara));for(var i in this.heroItemArr)this.heroItemArr[i].modifyAttribute(u.heroPropertyType.attackPower,1,o)},e.prototype.doMateSkill3=function(t){var e=Number(t.matePara);h.default.instance.getPro_topCtrl().doSkillPause(e)},e.prototype.doMateSkill4=function(t){for(var e in this.heroItemArr){var o=Math.floor(2*Math.random()),i=Number(t.matePara.split(",")[o]),n=this.heroItemArr[e];i<1?n.modifyAttribute(u.heroPropertyType.critChance,3,i):n.modifyAttribute(u.heroPropertyType.bulletCount,1,i)}},e.prototype.doMateSkill5=function(t){var e=Number(t.matePara.split(",")[0]),o=Number(t.matePara.split(",")[1]);for(var i in this.heroItemArr)this.heroItemArr[i].modifyAttribute(u.heroPropertyType.skillInterval,1,e,o)},e.prototype.doMateSkill6=function(t){var e=Number(t.matePara.split(",")[0]),o=Number(t.matePara.split(",")[1]);for(var i in this.heroItemArr)this.heroItemArr[i].modifyAttribute(u.heroPropertyType.penetrate,3,e,5,o)},e.prototype.doMateSkill7=function(t){var e=Math.max(this.heroItemArr[0].getAttackPower(),this.heroItemArr[1].getAttackPower()),o=Math.max(this.heroItemArr[0].getAttackSpeed(),this.heroItemArr[1].getAttackSpeed()),i=t.matePara.split(","),n=Math.floor(e*Number(i[0])),a=Math.floor(o*Number(i[1])),r=Number(i[2]),s=Math.min(this.heroItemArr[0].getBulletCount(),this.heroItemArr[1].getBulletCount());h.default.instance.getPro_buttomCtrl().getHeroCtrl().addTempHero(14,n,a,r,s)},e.prototype.doAttack=function(){h.default.instance.getPro_topCtrl().checkRangeSkill(this.getWorldColldierRect(0,0),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onLoad=function(){var t=this;this.initProperty(),this.pro_spAni.setEventListener(function(e,o){var i=d.default.getInstance().getMateCfgByID(t.index);"attack"==o.data.name&&(t.doMateSkillCtrl(t.index,i),t.doAttack())}),this.pro_spAni.setCompleteListener(function(){t.node.removeFromParent()})},e.prototype.start=function(){},e.prototype.onUpdate=function(){},c([m],e)}(cc.Component));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],NEW_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e9539JMKjBEsazvJ65zwWz6","NEW_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e9539JMKjBEsazvJ65zwWz6","NEW_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("NEW_Configs"),h=i("NEW_DataMgr"),f=i("NEW_SkillItem"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_banner=null,e.isSkill=!1,e.rawDelayTime=1.5,e.delayTime=1.5,e.nowSkillCtrlArr=[],e.skillNodeMap=new Map,e}return s(e,t),e.prototype.initProperty=function(){this.pro_banner=this.node.getChildByName("pro_banner")},e.prototype.useSkill=function(t,e,o){return this.showBanner(t),this.doUseSkillDown(t,e,o),!0},e.prototype.doUseSkillDown=function(t,e,o){var i,n=h.default.getInstance().getCharacterByID(t);p.AudioMgr.getInstance().playEffect(n.skillSound,"skill"),(i=u.PoolMgr.getInstance().getNode(d.poolName.CardSkill+t)).parent=this.node;var a=this.node.convertToNodeSpaceAR(o);i.setPosition(a);var r=i.getComponent(f.default);this.nowSkillCtrlArr.push(r),r.useSkill(a,e,t,this)},e.prototype.removeSkillCtrl=function(t){for(var e in this.nowSkillCtrlArr)if(this.nowSkillCtrlArr[e].uuid==t.uuid){var o=parseInt(e);this.nowSkillCtrlArr[e].node.removeFromParent(),this.nowSkillCtrlArr.splice(o,1);break}},e.prototype.changeDelayTime=function(t){t/2<this.delayTime&&(this.delayTime=t/2-.15)},e.prototype.resumeDelayTime=function(){this.delayTime=this.rawDelayTime},e.prototype.showBanner=function(t){var e=cc.instantiate(this.pro_banner);e.parent=this.pro_banner.parent,this.loadSpriteFrame(d.emNEWBundles.imgs,"banner/banner"+t,function(t){e.getComponent(cc.Sprite).spriteFrame=t,e.active=!0});var o=Number((this.delayTime/3).toFixed(1));cc.tween(e).by(o,{x:e.width}).delay(o).by(o,{x:-e.width}).call(function(){e.removeFromParent()}).start()},e.prototype.onLoad=function(){this.initProperty()},e.prototype.onUpdate=function(t){for(var e=0;e<this.nowSkillCtrlArr.length;e++)this.nowSkillCtrlArr[e].onUpdate(t)},c([g],e)}(l.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],NEW_SkillItem:[function(t,e,o){"use strict";cc._RF.push(e,"65cddtgPGxKn66twZtPk+8X","NEW_SkillItem");var i=t,n=e,a=o;cc._RF.push(n,"65cddtgPGxKn66twZtPk+8X","NEW_SkillItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("new_gameCtrl"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canMove=!1,e.offWidth=0,e.offHeight=0,e.aimNode=null,e.pro_spAni=null,e.pro_sub1=null,e.pro_sub2=null,e.parent_Ctrl=null,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_spAni=this.node.getChildByName("spAni").getComponent(sp.Skeleton),this.pro_sub1=this.node.getChildByName("pro_sub1"),this.pro_sub2=this.node.getChildByName("pro_sub2")},e.prototype.useSkill=function(t,e,o,i){this.parent_Ctrl=i,this.scheduleOnce(function(){},5),this.index=o,this.skillSpeed=this.speed,this.damage=e;var n=this.node.parent.convertToWorldSpaceAR(t);this.aimNode=p.default.instance.getPro_topCtrl().getCloserChildNode(n),this.flyDis=this.aimNode.y-this.node.y,this["useSkill"+o](t)},e.prototype.getBodyHeadY=function(){return p.default.instance.getPro_topCtrl().getHeadY()},e.prototype.useSkill1=function(){var t=this;this.canMove=!1,this.node.setPosition(0,this.aimNode.y-300),this.pro_spAni.setAnimation(0,"hit",!1);var e=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65),this.offHeight=300},e.prototype.useSkill3=function(){var t=this;this.canMove=!1,this.node.setPosition(0,this.aimNode.y-100),this.pro_spAni.setAnimation(0,"cedz",!1);var e=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65)},e.prototype.useSkill4=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill6=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,this.aimNode.y),this.pro_spAni.setAnimation(0,"hit",!1);var o=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill7=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill8=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill10=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,this.aimNode.y),this.pro_spAni.setAnimation(0,"animation",!1);var o=this.pro_spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill11=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.pro_spAni.setAnimation(0,"bullet",!1),this.pro_sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.pro_sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)},e.prototype.useSkill17=function(){var t=this;this.canMove=!1,this.node.setPosition(0,this.aimNode.y-100),this.pro_spAni.setAnimation(0,"ssxdz",!1);var e=this.pro_spAni.getCurrent(0).animation.duration;this.offHeight=100,this.scheduleOnce(function(){t.doAttack()},e-2)},e.prototype.doAttack=function(){p.default.instance.getPro_topCtrl().checkRangeSkill(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onLoad=function(){var t=this;this.initProperty(),this.pro_spAni.setCompleteListener(function(e){"bullet"!=(e.animation?e.animation.name:"unknown")&&t.parent_Ctrl.removeSkillCtrl(t)}),this.pro_spAni.setEventListener(function(t,e){e.data.name})},e.prototype.start=function(){},e.prototype.onUpdate=function(){var t=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed,this.flyDis-=this.skillSpeed,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){t.pro_sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),t.pro_sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.pro_spAni.setAnimation(0,"hit",!1),this.doAttack()))},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],NEW_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"d58d0KhOrFJE75fipKbIPhc","NEW_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"d58d0KhOrFJE75fipKbIPhc","NEW_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NEW_Configs"),u=i("NEW_DataMgr"),d=i("NEW_MateIconItem"),h=i("NEW_MateSkillCtrl"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_mateBanner=null,e.pro_mateIconLayer=null,e.pro_mateSkillCtrl=null,e.tarmMap=new Map,e.isTureTarmMap=new Map,e.pro_mateItemArr=[],e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_mateBanner=this.node.getChildByName("pro_mateBanner"),this.pro_mateIconLayer=this.node.getChildByName("pro_mateIconLayer"),this.pro_mateSkillCtrl=this.node.getChildByName("pro_mateSkillCtrl")},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.doTarmDown(e[0]),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},e.prototype.doTarmDown=function(t){var e=this;this.loadSpriteFrame(p.emNEWBundles.imgs,"mateIcon/mateIcon_"+t,function(o){e.loadPrefab(p.emNEWBundles.prefabs,"item/mateIcon",function(i){var n=cc.instantiate(i);e.pro_mateIconLayer.addChild(n),n.getComponent(d.default).initNode(t,o,e.pro_mateSkillCtrl.getComponent(h.default)),e.pro_mateItemArr.push(n.getComponent(d.default))})}),this.showBanner(t)},e.prototype.showBanner=function(t){var e=this,o=this.delayTime;this.loadSpriteFrame(p.emNEWBundles.imgs,"mateBanner/mateBanner_"+t,function(t){e.pro_mateBanner.getComponent(cc.Sprite).spriteFrame=t,e.pro_mateBanner.active=!0,cc.tween(e.pro_mateBanner).by(o/2,{x:e.pro_mateBanner.width}).delay(o/2).call(function(){e.pro_mateBanner.x=-cc.winSize.width/2-e.pro_mateBanner.width/2}).start()})},e.prototype.onLoad=function(){this.initProperty(),this.pro_mateBanner.x=-cc.winSize.width/2-this.pro_mateBanner.width/2},e.prototype.start=function(){},e.prototype.onUpdate=function(t){for(var e=0;e<this.pro_mateItemArr.length;e++)this.pro_mateItemArr[e].refreshSkillView(t)},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],NEW_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"4ae48tqt9JNQbzgheFSVXWK","NEW_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"4ae48tqt9JNQbzgheFSVXWK","NEW_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("PoolMgr"),h=i("NodeLib"),f=i("NEW_Configs"),m=i("new_gameCtrl"),g=i("NEW_BloodCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgTexture=null,e.pro_bg=null,e.pro_layer=null,e.pro_hitLayer=null,e.pro_bloodLayerCtrl=null,e.pro_destroyLayer=null,e.pro_beginNode=null,e.pro_weblinkLabel=null,e.pro_btn_pause=null,e.pro_pauseLayer=null,e.pro_heroBaneer=null,e.pro_mateBanner=null,e.pro_fence=null,e.pro_hit=null,e.pro_warn=null,e.lockSpacePause=!1,e}var o;return s(e,t),o=e,e.prototype.init=function(t){this.bgTexture=t},e.prototype.initListenEvent=function(){this.addEvent(f.emNEWEventName.loseBlood,this.showLoseLabel),this.addEvent(f.emNEWEventName.hitEffect,this.showHitEffect),this.addEvent(f.emNEWEventName.screenShake,this.onScreenShake),this.addEvent(f.emNEWEventName.warn,this.playWarn),this.addEvent(f.emNEWEventName.destroy,this.doBodyDestroy),this.addEvent(f.emNEWEventName.spacePause,this.doSpacePause)},e.prototype.initBtnListener=function(){var t=this;this.pro_btn_pause.on(cc.Node.EventType.TOUCH_END,function(){t.doPauseDown()}),this.pro_pauseLayer.children[1].on(cc.Node.EventType.TOUCH_END,function(){t.lockSpacePause=!0,t.openUI(f.NEW_UIID.UISetting,function(){t.pro_btn_pause.active=!0,t.pro_pauseLayer.active=!1,t.sendEvent(f.emNEWEventName.resume),t.lockSpacePause=!1})}),this.pro_pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pro_btn_pause.active=!0,t.pro_pauseLayer.active=!1,t.sendEvent(f.emNEWEventName.resume)})},e.prototype.doSpacePause=function(){m.default.instance.getGameState()==f.emNEWGameState.None||this.lockSpacePause||(this.pro_btn_pause.active?this.doPauseDown():(this.pro_btn_pause.active=!0,this.pro_pauseLayer.active=!1,this.sendEvent(f.emNEWEventName.resume)))},e.prototype.doPauseDown=function(){m.default.instance.getGameState()!=f.emNEWGameState.None&&(this.sendEvent(f.emNEWEventName.pause),this.pro_btn_pause.active=!1,this.pro_pauseLayer.active=!0)},e.prototype.initProperty=function(){this.pro_bg=h.default.findChildByName(this.node.parent,"pro_bg"),this.pro_layer=h.default.findChildByName(this.node,"layer"),this.pro_bloodLayerCtrl=h.default.findChildByName(this.pro_layer,"bloodLayer").getComponent(g.default),this.pro_hitLayer=h.default.findChildByName(this.pro_layer,"hitLayer"),this.pro_destroyLayer=h.default.findChildByName(this.pro_layer,"destroyLayer"),this.pro_beginNode=h.default.findChildByName(this.node,"beginNode"),this.pro_weblinkLabel=h.default.findChildByName(this.node,"weblinkLabel"),this.pro_btn_pause=h.default.findChildByName(this.node,"btn_pause"),this.pro_pauseLayer=h.default.findChildByName(this.node,"pauseLayer"),this.pro_heroBaneer=h.default.findChildByName(this.node,"heroBaneer"),this.pro_mateBanner=h.default.findChildByName(this.node,"mateBanner"),this.pro_fence=h.default.findChildByName(this.node,"fence");var t=h.default.findChildByName(this.node,"item");this.pro_hit=h.default.findChildByName(t,"hit"),this.pro_warn=h.default.findChildByName(t,"warn")},e.prototype.initview=function(){this.pro_weblinkLabel.active=l.Platform.WEB_LINK==u.PlatformSetting.currentPlatform},e.prototype.showLoseLabel=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=!1);var i=this.pro_bloodLayerCtrl.node.convertToNodeSpaceAR(e);this.pro_bloodLayerCtrl.createBlood(t,o,i)},e.prototype.showHitEffect=function(t){var e=d.PoolMgr.getInstance().getNode(f.poolName.effect);e.parent=this.pro_hitLayer;var o=this.pro_hitLayer.convertToNodeSpaceAR(t);e.setPosition(o),e.active=!0,e.opacity=255,e.getComponent(cc.Animation).play(),this.scheduleOnce(function(){e.active=!1,d.PoolMgr.getInstance().freeNode(f.poolName.effect,e)},.2)},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.pro_warn),this.pro_warn.active=!0,cc.tween(this.pro_warn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.pro_warn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.pro_warn),t.pro_warn.active=!1}).start()},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.pro_bg),cc.tween(this.pro_bg).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-5,-5)}).by(.05,{position:cc.v3(10,5)}).by(.05,{position:cc.v3(-10,0)}).by(.05,{position:cc.v3(10,-5)}).by(.05,{position:cc.v3(-5,5)}).set({position:cc.v3(0,0)}).start()},e.prototype.doBodyDestroy=function(t,e,o,i){var n;t==f.poolName.body_box&&(n="baoyixia"),t==f.poolName.body_num&&(n="baosanxia");var a=t==f.poolName.body_box?.8:1,r=this.pro_destroyLayer.convertToNodeSpaceAR(e),s=d.PoolMgr.getInstance().getNode(f.poolName.body_destroy);s.parent=this.pro_destroyLayer,s.angle=o,s.setPosition(r),s.active=!0,s.scaleX=i,s.getComponent(sp.Skeleton).setAnimation(0,n,!1),s.getComponent(sp.Skeleton).timeScale=a,s.getComponent(sp.Skeleton).setCompleteListener(function(){d.PoolMgr.getInstance().freeNode(f.poolName.body_destroy,s)})},e.prototype.onLoad=function(){o.instance=this,this.initProperty()},e.prototype.start=function(){this.initview(),this.initListenEvent(),this.initBtnListener()},o=c([v],e)}(p.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],NEW_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"609d9cC5/ZPvYn0Imvpp6uj","NEW_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"609d9cC5/ZPvYn0Imvpp6uj","NEW_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("NodeLib"),u=i("NEW_App"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ndWin=null,e.pro_ndFail=null,e.pro_btn=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.initproperty=function(){this.pro_ndWin=p.default.findChildByName(this.node,"pro_ndWin"),this.pro_ndFail=p.default.findChildByName(this.node,"pro_ndFail"),this.pro_btn=p.default.findChildByName(this.node,"pro_btn")},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initView(),this.pro_btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.pro_ndFail.active=!this.isWin,this.pro_ndWin.active=this.isWin},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],NEW_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"30934UkcT9B5bStMHstnIN4","NEW_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"30934UkcT9B5bStMHstnIN4","NEW_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("NodeLib"),m=i("new_gameCtrl"),g=i("NEW_App"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_musicSlider=null,e.pro_effectSlider=null,e.pro_btnClose=null,e.pro_btnBackHome=null,e.pro_btnPlay=null,e.pro_gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.initproperty=function(){this.pro_musicSlider=f.default.findChildByName(this.node,"pro_musicSlider").getComponent(cc.Slider),this.pro_effectSlider=f.default.findChildByName(this.node,"pro_effectSlider").getComponent(cc.Slider),this.pro_btnClose=f.default.findChildByName(this.node,"pro_btnClose"),this.pro_btnBackHome=f.default.findChildByName(this.node,"pro_btnBackHome"),this.pro_btnPlay=f.default.findChildByName(this.node,"pro_btnPlay"),this.pro_gmNode=f.default.findChildByName(this.node,"pro_gmNode"),this.pro_musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.pro_effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.pro_musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.pro_effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.pro_musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.pro_effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.pro_musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.pro_gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&m.default.instance.openGmButtom()}),this.pro_effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.pro_btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.pro_btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){g.default.instance.exit_App(0)}),this.pro_btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([v],e)}(p.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],NetInterface:[function(t,e,o){"use strict";cc._RF.push(e,"d9f8b+CV69FyKwnUdCjOtad","NetInterface");var i=e,n=o;cc._RF.push(i,"d9f8b+CV69FyKwnUdCjOtad","NetInterface"),Object.defineProperty(n,"__esModule",{value:!0}),n.DefStringProtocol=void 0;var a=function(){function t(){}return t.prototype.getHeadlen=function(){return 0},t.prototype.getHearbeat=function(){return""},t.prototype.getPackageLen=function(t){return t.toString().length},t.prototype.checkPackage=function(){return!0},t.prototype.getPackageId=function(){return 0},t}();n.DefStringProtocol=a,cc._RF.pop(),cc._RF.pop()},{}],NetManager:[function(t,e,o){"use strict";cc._RF.push(e,"d8cd5el6GBGTYTW+N8b8EuJ","NetManager");var i=e,n=o;cc._RF.push(i,"d8cd5el6GBGTYTW+N8b8EuJ","NetManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.NetManager=void 0;var a=function(){function t(){this._channels={}}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.setNetNode=function(t,e){void 0===e&&(e=0),this._channels[e]=t},t.prototype.removeNetNode=function(t){delete this._channels[t]},t.prototype.connect=function(t,e){return void 0===e&&(e=0),!!this._channels[e]&&this._channels[e].connect(t)},t.prototype.send=function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o=0);var i=this._channels[o];return!!i&&i.send(t,e)},t.prototype.request=function(t,e,o,i,n,a){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===a&&(a=0);var r=this._channels[a];r&&r.request(t,e,o,i,n)},t.prototype.requestUnique=function(t,e,o,i,n,a){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===a&&(a=0);var r=this._channels[a];return!!r&&r.requestUnique(t,e,o,i,n)},t.prototype.close=function(t,e,o){if(void 0===o&&(o=0),this._channels[o])return this._channels[o].closeSocket(t,e)},t._instance=null,t}();n.NetManager=a,cc._RF.pop(),cc._RF.pop()},{}],NetNode:[function(t,e,o){"use strict";cc._RF.push(e,"57f0fB90kNBUJ98yyu+jxjx","NetNode");var i,n,a=e,r=o;cc._RF.push(a,"57f0fB90kNBUJ98yyu+jxjx","NetNode"),Object.defineProperty(r,"__esModule",{value:!0}),r.NetNode=r.NetNodeState=r.NetTipsType=void 0,function(t){t[t.Connecting=0]="Connecting",t[t.ReConnecting=1]="ReConnecting",t[t.Requesting=2]="Requesting"}(i=r.NetTipsType||(r.NetTipsType={})),function(t){t[t.Closed=0]="Closed",t[t.Connecting=1]="Connecting",t[t.Checking=2]="Checking",t[t.Working=3]="Working"}(n=r.NetNodeState||(r.NetNodeState={}));var s=function(){function t(){this._connectOptions=null,this._autoReconnect=0,this._isSocketInit=!1,this._isSocketOpen=!1,this._state=n.Closed,this._socket=null,this._networkTips=null,this._protocolHelper=null,this._connectedCallback=null,this._disconnectCallback=null,this._callbackExecuter=null,this._fixtime=1500,this._needFixSeedHeard=!0,this._fixSeedTimer=null,this._SeedTimer=null,this._keepAliveTimer=null,this._receiveMsgTimer=null,this._reconnectTimer=null,this._heartTime=1e3,this._receiveTime=6e6,this._reconnetTimeOut=1e3,this._requests=Array(),this._listener={}}return t.prototype.init=function(t,e,o,i){void 0===o&&(o=null),void 0===i&&(i=null),console.log("NetNode init socket"),this._socket=t,this._protocolHelper=e,this._networkTips=o,this._callbackExecuter=i||function(t,e){t.callback.call(t.target,0,e)}},t.prototype.setOnServerStatus=function(t){this.onServerStatus=t},t.prototype.connect=function(t){return!(!this._socket||this._state!=n.Closed||(this._isSocketInit||this.initSocket(),this._state=n.Connecting,this._socket.connect(t)?(null==this._connectOptions&&(this._autoReconnect=t.autoReconnect),this._connectOptions=t,console.log("NetNode start socket"),this.updateNetTips(i.Connecting,!0),0):(this.updateNetTips(i.Connecting,!1),1)))},t.prototype.initSocket=function(){var t=this;this._socket.onConnected=function(e){t.onConnected(e)},this._socket.onMessage=function(e){t.onMessage(e)},this._socket.onError=function(e){t.onError(e)},this._socket.onClosed=function(e){t.onClosed(e)},this._isSocketInit=!0},t.prototype.updateNetTips=function(t,e){this._networkTips&&(t==i.Requesting?this._networkTips.requestTips(e):t==i.Connecting?this._networkTips.connectTips(e):t==i.ReConnecting&&this._networkTips.reconnectTips(e))},t.prototype.onConnected=function(){var t=this;this.onServerStatus&&this.onServerStatus(0),console.log("NetNode onConnected!"),this._isSocketOpen=!0,null!==this._connectedCallback?(this._state=n.Checking,this._connectedCallback(function(){t.onChecked()})):this.onChecked(),console.log("NetNode onConnected! state ="+this._state),this._SeedTimer=setInterval(function(){t._needFixSeedHeard&&t.send(t._protocolHelper.getHearbeat())},this._fixtime)},t.prototype.onChecked=function(){if(console.log("NetNode onChecked!"),this._state=n.Working,this.updateNetTips(i.Connecting,!1),this.updateNetTips(i.ReConnecting,!1),console.log("NetNode flush "+this._requests.length+" request"),this._requests.length>0){for(var t=0;t<this._requests.length;){var e=this._requests[t];this._socket.send(e.buffer),null==e.rspObject||e.rspCmd<=0?this._requests.splice(t,1):++t}this.updateNetTips(i.Requesting,this.request.length>0)}},t.prototype.onMessage=function(t){if(this._protocolHelper.checkPackage(t)){this.resetReceiveMsgTimer(),this.resetFixSeedMsgTimer();var e=this._protocolHelper.getPackageId(t);if(console.log("NetNode onMessage rspCmd = "+e),this._requests.length>0){for(var o in this._requests){var n=this._requests[o];if(n.rspCmd==e){console.log("NetNode execute request rspcmd "+e),this._callbackExecuter(n.rspObject,t),this._requests.splice(parseInt(o),1);break}}console.log("NetNode still has "+this._requests.length+" request watting"),0==this._requests.length&&this.updateNetTips(i.Requesting,!1)}var a=this._listener[e];if(null!=a)for(var r=0,s=a;r<s.length;r++){var c=s[r];console.log("NetNode execute listener cmd "+e),this._callbackExecuter(c,t)}}else console.error("NetNode checkHead Error")},t.prototype.onError=function(t){console.error(t),this.onServerStatus&&this.onServerStatus(-1)},t.prototype.onClosed=function(){var t=this;this.clearTimer(),this.onServerStatus&&this.onServerStatus(-1),console.log("socket closed......"),!this._disconnectCallback||this._disconnectCallback()?this.isAutoReconnect()?(this.updateNetTips(i.ReConnecting,!0),this._reconnectTimer=setTimeout(function(){t._socket.close(),t._state=n.Closed,t.connect(t._connectOptions),t._autoReconnect>0&&(t._autoReconnect-=1)},this._reconnetTimeOut)):this._state=n.Closed:console.log("disconnect return!")},t.prototype.close=function(t,e){this.clearTimer(),this._listener={},this._requests.length=0,this._networkTips&&(this._networkTips.connectTips(!1),this._networkTips.reconnectTips(!1),this._networkTips.requestTips(!1)),this._socket?this._socket.close(t,e):this._state=n.Closed},t.prototype.closeSocket=function(t,e){this._socket&&this._socket.close(t,e)},t.prototype.send=function(t,e){return void 0===e&&(e=!1),this._state==n.Working||e?(console.log("socket send ..."),this._socket.send(t)):this._state==n.Checking||this._state==n.Connecting?(this._requests.push({buffer:t,rspCmd:0,rspObject:null}),console.log("NetNode socket is busy, push to send buffer, current state is "+this._state),!0):(console.error("NetNode request error! current state is "+this._state),!1)},t.prototype.request=function(t,e,o,a,r){void 0===a&&(a=!0),void 0===r&&(r=!1),(this._state==n.Working||r)&&this._socket.send(t),console.log("NetNode request with timeout for "+e),this._requests.push({buffer:t,rspCmd:e,rspObject:o}),a&&this.updateNetTips(i.Requesting,!0)},t.prototype.requestUnique=function(t,e,o,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1);for(var a=0;a<this._requests.length;++a)if(this._requests[a].rspCmd==e)return console.log("NetNode requestUnique faile for "+e),!1;return this.request(t,e,o,i,n),!0},t.prototype.setResponeHandler=function(t,e,o){return null==e?(console.error("NetNode setResponeHandler error "+t),!1):(this._listener[t]=[{target:o,callback:e}],!0)},t.prototype.addResponeHandler=function(t,e,o){if(null==e)return console.error("NetNode addResponeHandler error "+t),!1;var i={target:o,callback:e};return null==this._listener[t]?this._listener[t]=[i]:-1==this.getNetListenersIndex(t,i)&&this._listener[t].push(i),!0},t.prototype.removeResponeHandler=function(t,e,o){if(null!=this._listener[t]&&null!=e){var i=this.getNetListenersIndex(t,{target:o,callback:e});-1!=i&&this._listener[t].splice(i,1)}},t.prototype.cleanListeners=function(t){void 0===t&&(t=-1),-1==t?this._listener={}:this._listener[t]=null},t.prototype.getNetListenersIndex=function(t,e){for(var o=-1,i=0;i<this._listener[t].length;i++){var n=this._listener[t][i];if(n.callback==e.callback&&n.target==e.target){o=i;break}}return o},t.prototype.resetFixSeedMsgTimer=function(){var t=this;this._needFixSeedHeard=!1,null!==this._fixSeedTimer&&clearTimeout(this._fixSeedTimer),this._fixSeedTimer=setTimeout(function(){t._needFixSeedHeard=!0},this._fixtime)},t.prototype.resetReceiveMsgTimer=function(){var t=this;null!==this._receiveMsgTimer&&clearTimeout(this._receiveMsgTimer),this._receiveMsgTimer=setTimeout(function(){console.warn("NetNode recvieMsgTimer close socket!"),t._socket.close()},this._receiveTime)},t.prototype.resetHearbeatTimer=function(){var t=this;null!==this._keepAliveTimer&&clearTimeout(this._keepAliveTimer),this._keepAliveTimer=setTimeout(function(){console.log("NetNode keepAliveTimer send Hearbeat"),t.send(t._protocolHelper.getHearbeat())},this._heartTime)},t.prototype.clearTimer=function(){null!==this._SeedTimer&&clearTimeout(this._SeedTimer),null!==this._receiveMsgTimer&&clearTimeout(this._receiveMsgTimer),null!==this._keepAliveTimer&&clearTimeout(this._keepAliveTimer),null!==this._reconnectTimer&&clearTimeout(this._reconnectTimer)},t.prototype.isAutoReconnect=function(){return 0!=this._autoReconnect},t.prototype.rejectReconnect=function(){this._autoReconnect=0,this.clearTimer()},t}();r.NetNode=s,cc._RF.pop(),cc._RF.pop()},{}],NodeLib:[function(t,e,o){"use strict";cc._RF.push(e,"9cc7bSAxcBMAqI6tL3sO+P4","NodeLib");var i=e,n=o;cc._RF.push(i,"9cc7bSAxcBMAqI6tL3sO+P4","NodeLib"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(){}return t.getChildLabel=function(e,o){var i=t.findChildByName(e,o).getComponent(cc.Label);if(i)return i},t.getChildSprite=function(e,o){var i=t.findChildByName(e,o).getComponent(cc.Sprite);if(i)return i},t.getChildRichText=function(e,o){var i=t.findChildByName(e,o).getComponent(cc.RichText);if(i)return i},t.getChildSlider=function(e,o){var i=t.findChildByName(e,o).getComponent(cc.Slider);if(i)return i},t.findChildByName=function(e,o){if(!e||!o)return null;if(e.name===o)return e;for(var i=e.children,n=0;n<i.length;n++){var a=t.findChildByName(i[n],o);if(a)return a}return null},t}();n.default=a,cc._RF.pop(),cc._RF.pop()},{}],OppoManager:[function(t,e,o){"use strict";cc._RF.push(e,"42da7ebB7dBz4hm5iMqYl33","OppoManager");var i=e,n=o;cc._RF.push(i,"42da7ebB7dBz4hm5iMqYl33","OppoManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.OppoManager=void 0;var a=function(){function t(){this.hasAd=!0,this.hasBanner=!0,this.hasInsertAd=!0,this.hasVideoAd=!0,this.hasShare=!1,this.BannerAd=null,this.showBannerTime=0,this.showVideoTime=0,this.BannerAdHight=0,this.BannerAdWight=0,this.stub="",this.isShowBanner=!1,this.nativeAd=null,this.currentAdId=1,this.canShowBanner=!1,this.gamePortalAd=null,this.isSupportGamePortalAd=!0,this.VideoMap=new Map}return t.prototype.closeNativeAd=function(){},t.prototype.hasVerify=function(){return!1},t.prototype.toAppStore=function(){},t.prototype.addNotify=function(){},t.prototype.needDouyVefiy=function(){},t.prototype.interVefiy=function(){},t.prototype.showNative=function(){},t.prototype.hideNative=function(){},t.prototype.showInterNative=function(){},t.prototype.hideInterNative=function(){},t.prototype.canShowBtnMore=function(){return!0},t.prototype.canShowEnergyForverVersion=function(){return!0},t.prototype.showFloatIconAd=function(){},t.prototype.hideFloatIconAd=function(){},t.prototype.canCare=function(){return!1},t.prototype.addShortcut=function(){},t.prototype.checkShortcut=function(){},t.prototype.shareImg=function(){},t.prototype.getUserInfo=function(t){t(null,null)},t.prototype.videoCallback=function(){},t.prototype.canShare=function(){return!1},t.prototype.initTrack=function(){},t.prototype.goToSuperXiuXian=function(){},t.prototype.showBlockAd=function(){},t.prototype.hideBlockAd=function(){},t.prototype.youmengTrack=function(){},t.prototype.initNativeAd=function(t,e){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{var o=this,i=function(t){console.log("\u539f\u751f\u5e7f\u544a\u52a0\u8f7d",t.adList),e&&e(t.adList),t.adList[0]&&o.nativeAd.reportAdShow({adId:t.adList[0].adId})},n=function(t){console.log("\u539f\u751f\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",t),e&&e(null)};this.nativeAd&&(this.nativeAd.offLoad(i),this.nativeAd.offError(n),this.nativeAd.destroy(),this.nativeAd=null),this.nativeAd=qg.createNativeAd({adUnitId:"311595"}),this.nativeAd.onError(n),this.nativeAd.onLoad(i),this.nativeAd.load()}},t.prototype.showNativeAd=function(t){this.nativeAd&&this.nativeAd.reportAdClick({adId:t})},t.prototype.shareVideo=function(){},t.prototype.initSdk=function(){var t=this;if(cc.sys.platform===cc.sys.WECHAT_GAME);else{var e=qg.createRewardedVideoAd({adUnitId:"1941195"});this.VideoMap.set(1,e);var o=qg.getSystemInfoSync(),i=o.screenWidth;o.platformVersionCode>=1051&&(this.BannerAd=qg.createBannerAd({adUnitId:"319288",style:{left:0,top:0,width:i}}),this.BannerAd.onResize(function(e){console.log(e.width,e.height),t.BannerAdHight=e.height,t.BannerAdWight=e.width,t.BannerAd.style.top=o.screenHeight-t.BannerAdHight,t.BannerAd.style.left=o.screenWidth/2-t.BannerAdWight/2+50}),this.BannerAd.onError(function(){}),this.BannerAd.onLoad(function(){})),o.platformVersionCode>=1076?this.gameBannerAd=qg.createGameBannerAd({adUnitId:"319303"}):console.log("\u5feb\u5e94\u7528\u5e73\u53f0\u7248\u672c\u53f7\u4f4e\u4e8e1076\uff0c\u6682\u4e0d\u652f\u6301\u4e92\u63a8\u76d2\u5b50\u76f8\u5173 API"),setTimeout(function(){t.canShowBanner=!0},6e4),o.platformVersionCode>=1076?(this.isSupportGamePortalAd=!0,this.gamePortalAd=qg.createGamePortalAd({adUnitId:"319306"})):(this.isSupportGamePortalAd=!1,console.log("\u5feb\u5e94\u7528\u5e73\u53f0\u7248\u672c\u53f7\u4f4e\u4e8e1076\uff0c\u6682\u4e0d\u652f\u6301\u4e92\u63a8\u76d2\u5b50\u76f8\u5173 API"))}},t.prototype.login=function(){},t.prototype.pay=function(){},t.prototype.share=function(){},t.prototype.showGamePortalAd=function(t,e){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{if(!this.isSupportGamePortalAd&&e)return void e(null);var o=this;null!=o.showGamePortalAd?(o.gamePortalAd.onLoad(function(){o.gamePortalAd.show().then(function(){}).catch(function(t){e&&e("\u6682\u65e0\u5185\u5bb9,\u8bf7\u7a0d\u540e\u518d\u8bd5"),console.log("show fail1 with:"+t.errCode+","+t.errMsg)})}),o.gamePortalAd.load().then(function(){}).catch(function(t){e&&e("\u6682\u65e0\u5185\u5bb9,\u8bf7\u7a0d\u540e\u518d\u8bd5"),console.log("load fail with:"+t.errCode+","+t.errMsg)})):e&&e(null)}},t.prototype.showBanner=function(t){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{var e=this;if(this.gameBannerAd&&"ADResult"==t)this.gameBannerAd.show().then(function(){console.log("show success")}).catch(function(t){console.log("show fail with:"+t.errCode+","+t.errMsg),null!=e.BannerAd&&e.canShowBanner&&e.BannerAd.show().then(function(){}).catch(function(t){console.log("banner\u5e7f\u544a\u5c55\u793a\u5931\u8d25",JSON.stringify(t))})});else{if(null==e.BannerAd)return;e.canShowBanner&&e.BannerAd.show().then(function(){}).catch(function(t){console.log("banner\u5e7f\u544a\u5c55\u793a\u5931\u8d25",JSON.stringify(t))})}}},t.prototype.hideBanner=function(){cc.sys.platform===cc.sys.WECHAT_GAME||(this.gameBannerAd&&this.gameBannerAd.hide().then(function(){console.log("hide success")}).catch(function(t){console.log("hide fail with:"+t.errCode+","+t.errMsg)}),null!=this.BannerAd&&this.BannerAd.hide())},t.prototype.showInsertAd=function(t,e){e&&e()},t.prototype.showVideoAd=function(t,e,o){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{var i=this.VideoMap.get(1);i.load();var n=function t(){i.show(),i.offLoad(t)};i.onLoad(n);var a=function t(){o("\u6682\u65f6\u6ca1\u6709\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),i.offError(t)};i.onError(a),i.onClose(function t(r){r&&r.isEnded?e&&e():o("\u64ad\u653e\u4e2d\u9014\u9000\u51fa\uff0c\u65e0\u6e38\u620f\u5956\u52b1"),i.offClose(t),i.offError(a),i.offLoad(n)})}},t.prototype.homeToBackgroud=function(){},t.prototype.backgroudToHome=function(){},t.prototype.openNotify=function(){},t.prototype.registerNotify=function(){},t.prototype.deleteNotify=function(){},t.prototype.otherFun=function(t,e){cc.sys.platform===cc.sys.WECHAT_GAME||qg.hasShortcutInstalled({success:function(t){0==t&&qg.installShortcut({success:function(){e&&e(!0)},fail:function(){},complete:function(){}})},fail:function(){e&&e(!1)},complete:function(){}})},t.prototype.shark=function(t){1==t?qg.vibrateLong({success:function(){},fail:function(){},complete:function(){}}):qg.vibrateShort({success:function(){},fail:function(){},complete:function(){}})},t.prototype.getInvertTime=function(){return 0},t.prototype.recordVideo=function(){},t.prototype.stopRecorderManager=function(){},t.prototype.setLanguage=function(){return null},t.prototype.showPushApp=function(t,e,o){o&&o()},t.prototype.exit=function(t,e,o){o&&o()},t}();n.OppoManager=a,cc._RF.pop(),cc._RF.pop()},{}],PBTGameData:[function(t,e,o){"use strict";cc._RF.push(e,"defed9e7SZLfZCYFZepFKfm","PBTGameData");var i=e,n=o;cc._RF.push(i,"defed9e7SZLfZCYFZepFKfm","PBTGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emPBTGameDataKeys=void 0,function(t){t.basicCfg="basicCfg",t.enemyCfg="enemyCfg",t.levelCfg="levelCfg",t.buffTypeCfg="buffTypeCfg",t.bubbleCfg="bubbleCfg",t.memberCfg="memberCfg"}(n.emPBTGameDataKeys||(n.emPBTGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],PBTGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"26eaffP06RC3ZKF8fA5jXop","PBTGameEnumData");var i=e,n=o;cc._RF.push(i,"26eaffP06RC3ZKF8fA5jXop","PBTGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumPBTBuffTypeCfg=n.enumPBTBasicCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicbullet=2]="basicbullet",t[t.basicHP=3]="basicHP",t[t.moveSpeed=4]="moveSpeed",t[t.roundDistance=5]="roundDistance",t[t.swordFlySpeed=6]="swordFlySpeed",t[t.sideRoadSpeed=7]="sideRoadSpeed",t[t.swordFLlyDistance=8]="swordFLlyDistance",t[t.memberLimit=9]="memberLimit",t[t.WallWidth=10]="WallWidth",t[t.EnemyFixedWidth=11]="EnemyFixedWidth",t[t.SpeedAdditionSegs=12]="SpeedAdditionSegs",t[t.BulletSpace=13]="BulletSpace",t[t.width=14]="width",t[t.maxWidth=15]="maxWidth",t[t.minimumWidth=16]="minimumWidth",t[t.IntervalTime=17]="IntervalTime"}(n.enumPBTBasicCfg||(n.enumPBTBasicCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.memberPlus="memberPlus",t.memberSub="memberSub",t.HPplus="HPplus",t.HPsub="HPsub",t.levelPlus="levelPlus",t.levelSub="levelSub",t.speedMultiply="speedMultiply",t.speedDivision="speedDivision",t.ATKMultiply="ATKMultiply",t.ATKDivision="ATKDivision"}(n.enumPBTBuffTypeCfg||(n.enumPBTBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],PBT_App:[function(t,e,o){"use strict";cc._RF.push(e,"e15fcXykAZCzbXsiyguC16l","PBT_App");var i=t,n=e,a=o;cc._RF.push(n,"e15fcXykAZCzbXsiyguC16l","PBT_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("PBT_Configs"),p=i("PBT_DataMgr"),u=i("PBT_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e){var o=this;console.log("pbt  pbt pbt pbt"),this.addTouchEvent(),this._exitCall=e;var i=function(){o._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.PBT_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),o.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.PBT_AudioId.Levels,l.PBTConfig.BgMusic)})};this._isInited?i():(s.UIMgr.getInstance().addUICnf(l.PBT_UICF),r.AudioMgr.getInstance().addAdConf(l.PBT_AudioCF),p.default.getInstance().load(function(){p.default.getInstance().initCfgData(),u.default.getInstance().preload(function(){i()})}))},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.PBT_UIID.UIGame),s.UIMgr.getInstance().closeById(l.PBT_UIID.UIResult),s.UIMgr.getInstance().closeById(l.PBT_UIID.UISetting),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=999999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],PBT_Base:[function(t,e,o){"use strict";cc._RF.push(e,"2fc50HfALFCp5YboBaVUbL/","PBT_Base");var i=t,n=e,a=o;cc._RF.push(n,"2fc50HfALFCp5YboBaVUbL/","PBT_Base");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PBT_Configs"),u=i("PBTGameEnumData"),d=i("PBT_DataMgr"),h=i("PBT_PlayerMgr"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._colliderGroups=[],e._groupID=0,e._moveSpeed=100,e._maxSpeed=100,e._va=0,e._state=p.emPBTRoleState.None,e._tagID=0,e._colliderTags=[],e}return s(e,t),Object.defineProperty(e.prototype,"isDie",{get:function(){return this._state==p.emPBTRoleState.Die},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIdle",{get:function(){return this._state==p.emPBTRoleState.Idle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMove",{get:function(){return this._state==p.emPBTRoleState.Move},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAttack",{get:function(){return this._state==p.emPBTRoleState.Attack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUseful",{get:function(){return this._state!=p.emPBTRoleState.None&&this._state!=p.emPBTRoleState.Die},enumerable:!1,configurable:!0}),e.prototype.initTagID=function(){this._tagID=h.default.getInstance().getTagID()},e.prototype.getGroupID=function(){return this._groupID},e.prototype.getTagID=function(){return this._tagID},e.prototype.setGroupID=function(t){this._groupID=t},e.prototype.addColliderTagID=function(t){this._colliderTags.push(t)},e.prototype.hasColliderTagID=function(t){return-1!=this._colliderTags.indexOf(t)},e.prototype.addColliderGroupID=function(t){this._colliderGroups.push(t)},e.prototype.getRoleType=function(){return this._roleType},e.prototype.hasColliderGroupID=function(t){return-1!=this._colliderGroups.indexOf(t)},e.prototype.updatePos=function(t){this.node.y-=t*this._moveSpeed,this.node.zIndex=2e3-this.node.y},e.prototype.changeSpeed=function(){var t=d.default.getInstance().getParam(u.enumPBTBasicCfg.SpeedAdditionSegs,[]);if(t&&0!=t.length)for(var e=Math.abs(this.node.y-.5*cc.winSize.height)/cc.winSize.height,o=t.length-1;o>=0;o--)if(e>=t[o][0]){this._maxSpeed=t[o][1],this._va=t[o][2];break}},e.prototype.canRemoveScreen=function(){return this.node.y<.5*-cc.winSize.height-this.node.height*this.node.scaleY-20},e.prototype.getSize=function(){return this.node.getContentSize()},e.prototype.getScaleSize=function(){var t=this.getSize();return cc.size(t.width*this.node.scaleX,t.height*this.node.scaleY)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.getWorldColliderRectWithFixed=function(t,e){var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position);return t=t||this.node.width*this.node.scaleX,e=e||this.node.height*this.node.scaleY,cc.rect(i.x-o.x*t,i.y-o.y*e,t,e)},e.prototype.setRoleState=function(t){this._state=t},e.prototype.bulletHited=function(){return 0},e.prototype.removeFromScreen=function(){},e.prototype.getWorldPos=function(t){return this.node.convertToWorldSpaceAR(t)},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],PBT_Bubble:[function(t,e,o){"use strict";cc._RF.push(e,"a357atSk79GlJYsECRXlR7v","PBT_Bubble");var i=t,n=e,a=o;cc._RF.push(n,"a357atSk79GlJYsECRXlR7v","PBT_Bubble");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PBT_Configs"),p=i("PBT_Base"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.icon=null,e._cardID=0,e._cfg=null,e}return s(e,t),e.prototype.setCardID=function(t){this._cardID=t},e.prototype.getCardID=function(){return this._cardID},e.prototype.start=function(){var t=this;this.node.active=!0,this._cardID>0?this.loadSpriteFrame(l.emPBTBundles.imgs,"js_b/tx_"+this._cardID,function(e){t.icon.spriteFrame=e}):this.loadSpriteFrame(l.emPBTBundles.imgs,"bubbles/"+this._cfg.resName,function(e){t.icon.spriteFrame=e}),this.text.string="+"+this._cfg.buffPara},e.prototype.init=function(t,e){this.initTagID(),this._cfg=t,this._cardID=e},e.prototype.getCfg=function(){return this._cfg},c([h(cc.Label)],e.prototype,"text",void 0),c([h(cc.Sprite)],e.prototype,"icon",void 0),c([d],e)}(p.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],PBT_BuffTips:[function(t,e,o){"use strict";cc._RF.push(e,"c779cI5KMRG9pv8QNjVhWSM","PBT_BuffTips");var i=t,n=e,a=o;cc._RF.push(n,"c779cI5KMRG9pv8QNjVhWSM","PBT_BuffTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("PBT_DataMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buffImgs=[],e}return s(e,t),e.prototype.start=function(){},e.prototype.getImg=function(t){for(var e=0;e<this.buffImgs.length;e++)if(this.buffImgs[e].name==t)return this.buffImgs[e];return null},e.prototype.show=function(t){var e=this,o=u.default.getInstance().getBuffTypeCfg(t);this.node.getComponent(cc.Sprite).spriteFrame=this.getImg(o.buffImage),this.node.opacity=0,this.node.active=!0,this.node.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(1),cc.fadeOut(.2),cc.callFunc(function(){e.node.active=!1,p.PoolMgr.getInstance().freeNode("pbt_buff_img",e.node)})))},c([f([cc.SpriteFrame])],e.prototype,"buffImgs",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],PBT_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"15d25ml9GlBMrOOZQw6WBqs","PBT_BulletEffect");var i=e,n=o;cc._RF.push(i,"15d25ml9GlBMrOOZQw6WBqs","PBT_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],PBT_Bullet:[function(t,e,o){"use strict";cc._RF.push(e,"76533aVLmZKHrE7w2SZZS+p","PBT_Bullet");var i=t,n=e,a=o;cc._RF.push(n,"76533aVLmZKHrE7w2SZZS+p","PBT_Bullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PBT_Configs"),p=i("PBTGameEnumData"),u=i("PBT_DataMgr"),d=i("PBT_PlayerMgr"),h=i("PBT_Base"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spIcon=null,e._flyDis=0,e._hideDis=0,e._atkDamage=0,e._cfg=null,e}return s(e,t),e.prototype.start=function(){var t=this;this.loadPrefab(l.emPBTBundles.prefabs,"bullets/PBT_Bullet_"+this._cfg.id,function(e){var o=cc.instantiate(e);o.parent=t.node,o.setPosition(0,0)}),this.setRoleState(l.emPBTRoleState.Move)},e.prototype.init=function(t,e){this.initTagID(),this._atkDamage=e,this._roleType=l.emPBTRoleType.Bullet,this._cfg=t,this._moveSpeed=u.default.getInstance().getParam(p.enumPBTBasicCfg.swordFlySpeed,300),this._maxSpeed=this._moveSpeed,this._hideDis=u.default.getInstance().getParam(p.enumPBTBasicCfg.swordFLlyDistance,300),this._flyDis=0},e.prototype.checkAutoDie=function(){return this._flyDis>=this._hideDis},e.prototype.update=function(t){this.isUseful&&d.default.getInstance().getState()==l.emPBTGameState.Game&&(t=Math.min(t,.02),this.node.y+=this._moveSpeed*t,this._flyDis+=this._moveSpeed*t)},e.prototype.onDie=function(){var t=this;this.setRoleState(l.emPBTRoleState.Die),cc.tween(this.node).to(.1,{opacity:0}).call(function(){t.node.destroy()}).start()},e.prototype.removeFromScreen=function(){this.setRoleState(l.emPBTRoleState.Die),this.node.destroy()},e.prototype.getAtkDamage=function(){return this._atkDamage},c([g(cc.Sprite)],e.prototype,"spIcon",void 0),c([m],e)}(h.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],PBT_CardItem:[function(t,e,o){"use strict";cc._RF.push(e,"c56baiOLDlFFZzeT0rhEwIA","PBT_CardItem");var i=t,n=e,a=o;cc._RF.push(n,"c56baiOLDlFFZzeT0rhEwIA","PBT_CardItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PBT_Configs"),p=i("PBT_Base"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBg=null,e.spRoleIcon=null,e.lblName=null,e.spBar=null,e.bgImgs=[],e.lblLv=null,e._cfg=null,e._atkDamage=0,e._lv=1,e.OFF_Y=30,e.SPEED=500,e}return s(e,t),e.prototype.init=function(t){this.initTagID(),this._cfg=t,this.initView(),this._lv=1,this._atkDamage=this._cfg.basicATK,this.updateLv()},e.prototype.getCardCfg=function(){return this._cfg},e.prototype.initView=function(){var t=this;this.lblName.string=this._cfg.name,this.loadSpriteFrame(l.emPBTBundles.imgs,"js/"+this._cfg.icon,function(e){t.spRoleIcon.spriteFrame=e})},e.prototype.refreshHpBar=function(t){this.spBar.fillRange=t},e.prototype.playAttack=function(t,e,o){this.ndBg.stopAllActions();var i=this.OFF_Y-this.ndBg.y;cc.tween(this.ndBg).to(i/this.SPEED/e,{y:this.OFF_Y}).to(this.OFF_Y/this.SPEED/e,{y:0}).start(),this.sendEvent(l.emPBTEventName.PBT_Shoot_Bullet,t,o||this.node.convertToWorldSpaceAR(cc.v2(0,.35*this.node.height)),this)},e.prototype.start=function(){this.ndBg.getComponent(cc.Sprite).spriteFrame=this.bgImgs[this._cfg.quality-1]},e.prototype.updateLv=function(){this.lblLv.string=this._lv.toString()},e.prototype.addLev=function(t){if(this._lv>=this._cfg.cardLevel)return!1;this._lv+=t,this._atkDamage+=this._cfg.cardATK,this.updateLv()},e.prototype.getAtkDamage=function(t){var e=t+this._atkDamage;return e<0?0:e},c([h(cc.Node)],e.prototype,"ndBg",void 0),c([h(cc.Sprite)],e.prototype,"spRoleIcon",void 0),c([h(cc.Label)],e.prototype,"lblName",void 0),c([h(cc.Sprite)],e.prototype,"spBar",void 0),c([h([cc.SpriteFrame])],e.prototype,"bgImgs",void 0),c([h(cc.Label)],e.prototype,"lblLv",void 0),c([d],e)}(p.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],PBT_Cards:[function(t,e,o){"use strict";cc._RF.push(e,"39afaU5sUREKrGjmUiL0+Z0","PBT_Cards");var i=t,n=e,a=o;cc._RF.push(n,"39afaU5sUREKrGjmUiL0+Z0","PBT_Cards");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("PBT_Configs"),u=i("PBTGameEnumData"),d=i("PBT_DataMgr"),h=i("PBT_PlayerMgr"),f=i("PBT_Base"),m=i("PBT_CardItem"),g=cc._decorator,y=g.ccclass,v=g.property,_=[cc.v2(-67,-90),cc.v2(67,-90),cc.v2(-67,-220),cc.v2(67,-220),cc.v2(-67,-350),cc.v2(67,-350)],b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefabCarItem=null,e.ndCardRoot=null,e.spPropName=null,e.lblHP=null,e.maxHp=100,e.hp=100,e.atkCDInterval=1e3,e.atkCD=1e3,e.cdParam=0,e.atkDamage=0,e._edge={left:1e4,right:-1e4,top:-2e4,bottom:2e4},e._cards=[],e._RangeType=2,e._isAttacking=!1,e}return s(e,t),e.prototype.setMaxHp=function(t,e){this.maxHp=t,e&&(this.hp=this.maxHp),this.refreshBar()},e.prototype.refreshBar=function(){for(var t=Math.min(1,Math.max(0,this.hp/this.maxHp)),e=0;e<this._cards.length;e++)this._cards[e].refreshHpBar(t);this.lblHP.string=""+Math.floor(this.hp)},e.prototype.onLoad=function(){this.initTagID()},e.prototype.start=function(){0==this._RangeType?this.node.y=.5*-cc.winSize.height+15:2==this._RangeType&&(this.node.y=455+.5*-cc.winSize.height);var t=d.default.getInstance().getParam(u.enumPBTBasicCfg.basicbullet,1);this.addMember(t),this.atkDamage=this._cards[0].getCardCfg().basicATK,this.setMaxHp(d.default.getInstance().getParam(u.enumPBTBasicCfg.basicHP,20),!0);var e=d.default.getInstance().getParam(u.enumPBTBasicCfg.basicASPD,1);this.atkCDInterval=e,this.atkCD=this.atkCDInterval,this.setRoleState(p.emPBTRoleState.Idle)},e.prototype.addMember=function(t){void 0===t&&(t=1);for(var e=0;e<t;e++){if(this.ndCardRoot.children.length>=6)return;var o=this.randomMemberCard();o&&this.addCardItem(o)}},e.prototype.subMember=function(t){void 0===t&&(t=1);for(var e=0;e<t;e++){if(this._cards.length<=1)return;var o=this._cards.pop();h.default.getInstance().removeCard(o.getCardCfg().id),o.node.destroy()}},e.prototype.addCardItem=function(t){if(!this.checkIsExit(t.id)){var e=cc.instantiate(this.prefabCarItem);e.parent=this.ndCardRoot;var o=e.getComponent(m.default);o.init(t),this._cards.push(o),h.default.getInstance().addCard(t.id),this.updateSizePos(),this.refreshBar()}},e.prototype.updateSizePos=function(){this._edge={left:1e4,right:-1e4,top:-2e4,bottom:2e4};var t=this.ndCardRoot;if(2==this._RangeType)for(var e=0;e<this._cards.length;e++)this._cards[e].node.setPosition(_[e]);else{var o=t.children.length;if(1==o){var i=t.children[0];0==this._RangeType?i.setPosition(0,.5*i.height):i.setPosition(0,.5*-i.height)}else{var n=0;for(e=0;e<3;e++){for(var a=0;a<2;a++){var r=this._cards[n].node,s=(.5*r.width+3)*(a%2==0?-1:1),c=0;if(0==this._RangeType?(c=.5*r.height+(r.height-50)*e,r.zIndex=10-e):(c=-(.5*r.height+(r.height-50)*e),r.zIndex=e),r.setPosition(s,c),++n>=o)break}if(n>=o)break}}}this.updateEdge(),this.updateEdgePos(),1==this._RangeType&&(this.node.y=.5*-cc.winSize.height+Math.abs(this._edge.top-this._edge.bottom)+15)},e.prototype.updateEdgePos=function(){if(2==this._RangeType){var t=this._cards[0].node.x-.5*this._cards[0].node.width,e=this._cards[this._cards.length>1?1:0],o=e.node.x+.5*e.node.width;this.node.x+o>p.PBTConfig.WallWidth&&(this.node.x=p.PBTConfig.WallWidth-o),this.node.x+t<-p.PBTConfig.WallWidth&&(this.node.x=-p.PBTConfig.WallWidth-t)}else{var i=Math.abs(.5*Math.abs(this._edge.right-this._edge.left));this.node.x+i>p.PBTConfig.WallWidth&&(this.node.x=p.PBTConfig.WallWidth-i),this.node.x-i<-p.PBTConfig.WallWidth&&(this.node.x=-p.PBTConfig.WallWidth+i)}},e.prototype.updateEdge=function(){for(var t=0;t<this._cards.length;t++){var e=this._cards[t].node,o=.5*e.width,i=.5*e.height;e.x-o<this._edge.left&&(this._edge.left=e.x-o),e.x+o>this._edge.right&&(this._edge.right=e.x+o),e.y-i<this._edge.bottom&&(this._edge.bottom=e.y-i),e.y+i>this._edge.top&&(this._edge.top=e.y+i)}},e.prototype.checkIsExit=function(t){for(var e=0;e<this._cards.length;e++)if(this._cards[e].getCardCfg().id==t)return!0;return!1},e.prototype.randomMemberCard=function(){for(var t=d.default.getInstance().getAllMembers(),e=[],o=0;o<t.length;o++)this.checkIsExit(t[o].id)||e.push(t[o]);return e.length>0?e[Math.floor(Math.random()*e.length)]:null},e.prototype.showPropTips=function(){},e.prototype.getCDParam=function(){return Math.max(1+this.cdParam,1)},e.prototype.updateCD=function(t){this.atkCD-=t*this.getCDParam(),this.atkCD<=0&&(this._isAttacking||(this.atkCD=this.atkCDInterval,this.playAttack()))},e.prototype.playAttack=function(){this._isAttacking=!0;var t=h.default.getInstance().getGroupID();l.AudioMgr.getInstance().playEffectFree(p.PBT_AudioId.attack2);for(var e=Math.min(1,1/this.getCDParam()),o=this._cards.length,i=d.default.getInstance().getParam(u.enumPBTBasicCfg.BulletSpace,10),n=.5*-(25*o+i*(o-1)),a=0;a<o;a++){var r=void 0;if(o>1){var s=n+12.5+(25+i)*a;r=this.node.convertToWorldSpaceAR(cc.v2(s,-10))}this._cards[a].playAttack(t,e,r)}this._isAttacking=!1},e.prototype.checkCollider=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);for(var i=this.ndCardRoot.children.length-1;i>=0;i--){var n=this.ndCardRoot.children[i].getComponent(m.default);if(n.getWorldColldierRect(e,o).intersects(t.getWorldColliderRectWithFixed()))return n}return null},e.prototype.addCardLev=function(t,e){for(var o=0;o<this._cards.length;o++)if(this._cards[o].getCardCfg().id==t)return l.AudioMgr.getInstance().playEffectFree(p.PBT_AudioId.Cards),this._cards[o].addLev(e),this.atkDamage+=this._cards[o].getCardCfg().cardATK,!0;return!1},e.prototype.addAtkDamage=function(t){this.atkDamage+=t,this.atkDamage=Math.max(1,this.atkDamage)},e.prototype.getAtkDamage=function(){return this.atkDamage},e.prototype.addBuff=function(t,e){var o=!0;switch(t){case u.enumPBTBuffTypeCfg.SpeedPlus:this.cdParam+=e;break;case u.enumPBTBuffTypeCfg.SpeedSub:this.cdParam-=e;break;case u.enumPBTBuffTypeCfg.ATKplus:this.addAtkDamage(e||0);break;case u.enumPBTBuffTypeCfg.ATKsub:this.addAtkDamage(0-(e||0));break;case u.enumPBTBuffTypeCfg.memberPlus:this.addMember(Math.max(0,Math.floor(e)));break;case u.enumPBTBuffTypeCfg.memberSub:this.subMember(Math.max(0,Math.floor(e)));break;case u.enumPBTBuffTypeCfg.HPplus:this.maxHp+=e,this.hp=Math.max(0,Math.min(this.hp+e,this.maxHp)),this.showHpTips(e),this.refreshBar();break;case u.enumPBTBuffTypeCfg.HPsub:this.maxHp-=e;var i=this.hp;this.hp=Math.max(0,Math.min(this.hp-e,this.maxHp)),this.hp<=0&&(this.hp=1,e=i-this.hp),e>0&&this.showHpTips(-e),this.refreshBar();break;case u.enumPBTBuffTypeCfg.speedMultiply:this.cdParam=(0==this.cdParam?1:this.cdParam)*e;break;case u.enumPBTBuffTypeCfg.speedDivision:0!=e&&(this.cdParam/=e);break;case u.enumPBTBuffTypeCfg.ATKMultiply:this.atkDamage*=e,this.atkDamage=Math.max(1,this.atkDamage);break;case u.enumPBTBuffTypeCfg.ATKDivision:0!=e&&(this.atkDamage/=e),this.atkDamage=Math.max(1,this.atkDamage);break;default:o=!1}o&&(l.AudioMgr.getInstance().playEffectFree(p.PBT_AudioId.Cards),this.showPropTips(t))},e.prototype.enermyHit=function(t){this.hp-=t;var e=p.emPBTHitState.None;return this.hp<=0?(this.hp=0,e=p.emPBTHitState.HitDie,this.sendEvent(p.emPBTEventName.PBT_Player_Die)):(e=p.emPBTHitState.HitHurt,this.sendEvent(p.emPBTEventName.PBT_Show_Warn)),this.showHpTips(-t),this.refreshBar(),e},e.prototype.showHpTips=function(t){this.sendEvent(p.emPBTEventName.PBT_Show_Hit_Text,t,this.getWorldPos(cc.v2(0,this._edge.top)))},e.prototype.getCardItem=function(t){for(var e=0;e<this._cards.length;e++)if(this._cards[e].getCardCfg().id==t)return this._cards[e];return null},c([v(cc.Prefab)],e.prototype,"prefabCarItem",void 0),c([v(cc.Node)],e.prototype,"ndCardRoot",void 0),c([v(cc.Sprite)],e.prototype,"spPropName",void 0),c([v(cc.Label)],e.prototype,"lblHP",void 0),c([y],e)}(f.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],PBT_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"c96d0ctD0RCubUUZVYuwx0T","PBT_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"c96d0ctD0RCubUUZVYuwx0T","PBT_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.emPBTHitState=l.emPBTGameState=l.emPBTRoleState=l.emPBTRoleType=l.emPBTEventName=l.PBT_AudioCF=l.PBT_AudioId=l.PBT_UICF=l.PBTConfig=l.emPBTBundles=l.PBT_UIID=void 0,function(t){t.UIGame="PBT_UIGame",t.UIResult="PBT_UIResult",t.UISetting="PBT_UISetting"}(a=l.PBT_UIID||(l.PBT_UIID={})),function(t){t.prefabs="pbt_prefabs",t.audios="pbt_audios",t.imgs="pbt_imgs",t.configs="pbt_configs"}(r=l.emPBTBundles||(l.emPBTBundles={})),l.PBTConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG"},l.PBT_UICF=((i={})[a.UIGame]={prefab:"ui/PBT_UIGame",name:"PBT_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/PBT_UIResult",name:"PBT_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/PBT_UISetting",name:"PBT_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.Levels="PBT_Levels",t.Cards="PBT_Cards",t.fail="PBT_fail",t.attack2="PBT_attack2",t.victory="PBT_victory",t.strike="PBT_strike"}(s=l.PBT_AudioId||(l.PBT_AudioId={})),l.PBT_AudioCF=((n={})[s.Levels]={path:"Levels",bundle:r.audios},n[s.Cards]={path:"Cards",bundle:r.audios},n[s.victory]={path:"victory",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.attack2]={path:"attack2",bundle:r.audios},n[s.strike]={path:"strike",bundle:r.audios},n),function(t){t.PBT_Player_Die="pbt_player_die",t.PBT_Shoot_Bullet="pbt_shoot_bullet",t.PBT_Show_Hit_Text="pbt_show_hit_text",t.PBT_Show_Warn="pbt_show_warn",t.PBT_Bubble_Buf="pbt_add_bubble_buf",t.PBT_Show_Hit_Effect="pbt_hit_effect",t.PBT_Show_Buff_Tip="pbt_show_buff_tip",t.PBT_Setting_Back="pbt_setting_back"}(l.emPBTEventName||(l.emPBTEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emPBTRoleType||(l.emPBTRoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emPBTRoleState||(l.emPBTRoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emPBTGameState||(l.emPBTGameState={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emPBTHitState||(l.emPBTHitState={})),cc._RF.pop(),cc._RF.pop()},{}],PBT_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a4d77C3nM9AHLJ1u3VMeqxD","PBT_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"a4d77C3nM9AHLJ1u3VMeqxD","PBT_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("HttpMgr"),c=i("ResourceMgr"),l=i("PBT_Configs"),p=i("PBTGameEnumData"),u=cc._decorator,d=u.ccclass,h=(u.property,function(){function t(){this._isRemote=!1,this._mapIndex=1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.setMapIndex=function(t){this._mapIndex=t},t.prototype.load=function(t){var e=this;this._isRemote?s.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"xinhhui/BraveTower/configs",fileName:"GameJsonCfg.json"},function(o,i){if(o&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(e.data=JSON.parse(n.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):c.ResourceMgr.getInstance().loadRes(l.emPBTBundles.configs,"GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.initCfgData=function(){l.PBTConfig.WallWidth=.5*this.getParam(p.enumPBTBasicCfg.WallWidth,750),l.PBTConfig.EnemyFixedWidth=this.getParam(p.enumPBTBasicCfg.EnemyFixedWidth,188)},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicCfg[t]?this.data.basicCfg[t].para:e},t.prototype.getAllMembers=function(){return this.data.memberCfg},t.prototype.getWaveCfgs=function(){return this.data["levelCfg_"+this._mapIndex]||this.data.levelCfg_1},t.prototype.isBuffType=function(t){for(var e=0;e<this.data.buffTypeCfg.length;e++)if(this.data.buffTypeCfg[e].buffType==t)return!0;return!1},t.prototype.getBuffTypeCfg=function(t){for(var e=0;e<this.data.buffTypeCfg.length;e++)if(this.data.buffTypeCfg[e].buffType==t)return this.data.buffTypeCfg[e];return null},t.prototype.getBubbleCfg=function(t){for(var e=0;e<this.data.bubbleCfg.length;e++)if(this.data.bubbleCfg[e].typeBubble==t)return this.data.bubbleCfg[e];return null},t.prototype.getEnemyCfg=function(t){for(var e=0;e<this.data.enemyCfg.length;e++)if(this.data.enemyCfg[e].id==t)return this.data.enemyCfg[e];return null},t.prototype.getMapIndex=function(){return this._mapIndex},e=r([d],t)}());a.default=h,cc._RF.pop(),cc._RF.pop()},{}],PBT_Door:[function(t,e,o){"use strict";cc._RF.push(e,"2e487VqfbJKe4eGDZ1NzM0I","PBT_Door");var i=t,n=e,a=o;cc._RF.push(n,"2e487VqfbJKe4eGDZ1NzM0I","PBT_Door");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("Utils"),u=i("PBT_Configs"),d=i("PBTGameEnumData"),h=i("PBT_DataMgr"),f=i("PBT_Base"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.door=null,e.skeHitEffect=null,e.doorImgs=[],e.nd_bl=null,e.ndLeft=null,e.ndRight=null,e._hitEffectValue=0,e._maxWidth=500,e._minWidth=100,e._DoorEdge=0,e._coolTime=-1,e._targetWidth=300,e._step=0,e}return s(e,t),e.prototype.onLoad=function(){this._roleType=u.emPBTRoleType.Door},e.prototype.getBufType=function(){return this._bufType},e.prototype.getValue=function(){return this._value},e.prototype.start=function(){this.setRoleState(u.emPBTRoleState.Move)},e.prototype.init=function(t,e){this.initTagID(),this._moveSpeed=h.default.getInstance().getParam(d.enumPBTBasicCfg.moveSpeed),this._maxSpeed=this._moveSpeed,this._roleType=u.emPBTRoleType.Door,this._originPos=this.node.position.clone(),this.setRoleState(u.emPBTRoleState.Move),this._bufType=t,this._initBuffCfg(e),this._targetWidth=300,this._step=0,this._minWidth=h.default.getInstance().getParam(d.enumPBTBasicCfg.minimumWidth,100),this._maxWidth=h.default.getInstance().getParam(d.enumPBTBasicCfg.maxWidth,500),this.node.x>0?this._DoorEdge=this.node.x+.5*this._targetWidth:this.node.x<0&&(this._DoorEdge=this.node.x-.5*this._targetWidth)},e.prototype.resetSize=function(t){console.log(t),this._targetWidth=t,this._step=0,this.node.width=t,this.ndLeft.x=.5*-this.node.width+.5*this.ndLeft.width,this.ndRight.x=.5*this.node.width-.5*this.ndRight.width,this.nd_bl.width=this.node.width-20,this.node.x>0?this._DoorEdge=this.node.x+.5*this._targetWidth:this.node.x<0&&(this._DoorEdge=this.node.x-.5*this._targetWidth)},e.prototype.getScaleWidth=function(t){return t>0?this._targetWidth>=this._maxWidth?0:Math.min(t,this._maxWidth-this._targetWidth):t<0?this._targetWidth<=this._minWidth?0:Math.max(Math.abs(t),this._targetWidth-this._minWidth):0},e.prototype._initBuffCfg=function(t){var e,o,i,n;this._value=t,this._cfg=h.default.getInstance().getBuffTypeCfg(this._bufType),0==this._hitEffectValue&&(this._hitEffectValue=(null===(e=this._cfg)||void 0===e?void 0:e.hitEffect)||0),this._cfg&&(this.text.node.color="red"==(null===(o=this._cfg)||void 0===o?void 0:o.color)?cc.color().fromHEX("#ff4e49"):cc.color().fromHEX("#ffffff"),this.door.spriteFrame=this.doorImgs["red"==(null===(i=this._cfg)||void 0===i?void 0:i.color)?1:0],this.text.string=p.Utils.StringFormat((null===(n=this._cfg)||void 0===n?void 0:n.buffWord)||"",this.accurateNum(this._value,1)))},e.prototype.accurateNum=function(t,e){return t.toFixed(e)-0},e.prototype.update=function(t){this._coolTime-=t,0!=this._step&&this.updateWidth(this._step)},e.prototype.bulletHited=function(t){if(this._coolTime>0)return u.emPBTHitState.NoHurt;if(!this.isUseful||!this.node.active||this.hasColliderGroupID(t.getGroupID()))return u.emPBTHitState.None;if(l.AudioMgr.getInstance().playEffectFree(u.PBT_AudioId.strike),this._coolTime=h.default.getInstance().getParam(d.enumPBTBasicCfg.IntervalTime,.1),this.addColliderTagID(t.getTagID()),this.addColliderGroupID(t.getGroupID()),[d.enumPBTBuffTypeCfg.SpeedPlus,d.enumPBTBuffTypeCfg.ATKplus,d.enumPBTBuffTypeCfg.HPplus,d.enumPBTBuffTypeCfg.memberPlus,d.enumPBTBuffTypeCfg.levelPlus,d.enumPBTBuffTypeCfg.speedMultiply,d.enumPBTBuffTypeCfg.ATKMultiply].indexOf(this._bufType)>=0)this._value=this._value+this._hitEffectValue,this._value>1&&d.enumPBTBuffTypeCfg.memberPlus==this._bufType&&(this._value=1);else switch(this._value=this._value-this._hitEffectValue,this._bufType){case d.enumPBTBuffTypeCfg.SpeedSub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumPBTBuffTypeCfg.SpeedPlus);break;case d.enumPBTBuffTypeCfg.ATKsub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumPBTBuffTypeCfg.ATKplus);break;case d.enumPBTBuffTypeCfg.HPsub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumPBTBuffTypeCfg.HPplus);break;case d.enumPBTBuffTypeCfg.memberSub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumPBTBuffTypeCfg.memberPlus);break;case d.enumPBTBuffTypeCfg.levelSub:this._value<=0&&(this._value=Math.abs(this._value),this._bufType=d.enumPBTBuffTypeCfg.levelPlus);break;case d.enumPBTBuffTypeCfg.speedDivision:this._value<=0&&(this._value=this._hitEffectValue,this._value=Math.abs(this._value),this._bufType=d.enumPBTBuffTypeCfg.speedMultiply);break;case d.enumPBTBuffTypeCfg.ATKDivision:this._value<=0&&(this._value=this._hitEffectValue,this._value=Math.abs(this._value),this._bufType=d.enumPBTBuffTypeCfg.ATKMultiply)}return this._initBuffCfg(this._value),u.emPBTHitState.HitHurt},e.prototype.removeFromScreen=function(){this.node.destroy()},e.prototype.onDie=function(){var t=this;this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){t.removeFromScreen()})))},e.prototype.scaleWidth=function(t){this._targetWidth+=t,this._targetWidth>this._maxWidth?this._targetWidth=this._maxWidth:this._targetWidth<this._minWidth&&(this._targetWidth=this._minWidth),this._step=(this._targetWidth-this.node.width)/10},e.prototype.updateWidth=function(t){var e=this.node.width;this.node.width+=t,this._step<0?this.node.width<=this._targetWidth&&(this.node.width=this._targetWidth,this._step=0,t=-Math.abs(e-this._targetWidth)):this._step>0&&this.node.width>=this._targetWidth&&(this.node.width=this._targetWidth,this._step=0,t=Math.abs(e-this._targetWidth)),this.ndLeft.x=.5*-this.node.width+.5*this.ndLeft.width,this.ndRight.x=.5*this.node.width-.5*this.ndRight.width,this.nd_bl.width=this.node.width-20,this._DoorEdge<0?this.node.x=this._DoorEdge+.5*this.node.width:this._DoorEdge>0&&(this.node.x=this._DoorEdge-.5*this.node.width)},c([y(cc.Label)],e.prototype,"text",void 0),c([y(cc.Sprite)],e.prototype,"door",void 0),c([y(sp.Skeleton)],e.prototype,"skeHitEffect",void 0),c([y([cc.SpriteFrame])],e.prototype,"doorImgs",void 0),c([y(cc.Node)],e.prototype,"nd_bl",void 0),c([y(cc.Node)],e.prototype,"ndLeft",void 0),c([y(cc.Node)],e.prototype,"ndRight",void 0),c([g],e)}(f.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],PBT_Enemy_Ani:[function(t,e,o){"use strict";cc._RF.push(e,"3d688pEHYtDmZul6zp7r5MX","PBT_Enemy_Ani");var i=e,n=o;cc._RF.push(i,"3d688pEHYtDmZul6zp7r5MX","PBT_Enemy_Ani");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ani=null,e._attackFunc=null,e._attackCompleteFunc=null,e}return r(e,t),e.prototype.start=function(){},e.prototype.Attack=function(){this._attackFunc&&this._attackFunc(),this._attackFunc=null},e.prototype.playAttack=function(t,e){var o=this;this._attackFunc=t,this._attackCompleteFunc=e,this.ani.play("pbt_enemy_attack"),this.ani.on("finished",function(){o._attackCompleteFunc&&o._attackCompleteFunc(),o._attackCompleteFunc=null,console.log("playAttack finished")})},e.prototype.playMove=function(){this.ani.currentClip&&"pbt_enemy_move"==this.ani.currentClip.name||this.ani.play("pbt_enemy_move")},s([p(cc.Animation)],e.prototype,"ani",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],PBT_Enermy:[function(t,e,o){"use strict";cc._RF.push(e,"055096llmBLH4tSU0de2Y7s","PBT_Enermy");var i=t,n=e,a=o;cc._RF.push(n,"055096llmBLH4tSU0de2Y7s","PBT_Enermy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("PBT_Configs"),u=i("PBTGameEnumData"),d=i("PBT_DataMgr"),h=i("PBT_PlayerMgr"),f=i("PBT_Base"),m=i("PBT_Bubble"),g=i("PBT_Enemy_Ani"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ske_die=null,e.ske_hit=null,e.ske_stu=null,e.ani=null,e.ndShadow=null,e.spIcon=null,e.ndBubbleRoot=null,e.lblHP=null,e.ndCollider=null,e.prefabBubble=null,e._bubbleCtrl=null,e._hp=0,e._enemyID=0,e._isAttack=!1,e._isRolling=!1,e}return s(e,t),e.prototype.start=function(){this.setRoleState(p.emPBTRoleState.Move),this.ani.playMove()},e.prototype.getHp=function(){return this._hp},e.prototype.init=function(t,e){var o;if(this.initTagID(),this._roleType=p.emPBTRoleType.Enemy,this._moveSpeed=d.default.getInstance().getParam(u.enumPBTBasicCfg.moveSpeed),this._maxSpeed=this._moveSpeed,this._originPos=this.node.position.clone(),this._hp=e,this.updateHp(),t.indexOf(",")>=0){var i=t.split(",").map(function(t){return Number(t)});this._enemyID=i[0],o=d.default.getInstance().getBubbleCfg(i[1])}else this._enemyID=Number(t),o=null;if(this._enermyCfg=d.default.getInstance().getEnemyCfg(this._enemyID),this.ndCollider.setContentSize(this._enermyCfg.width,this._enermyCfg.height),o){if(!this._bubbleCtrl){var n=cc.instantiate(this.prefabBubble);n.parent=this.ndBubbleRoot,this._bubbleCtrl=n.getComponent(m.default)}var a=0;u.enumPBTBuffTypeCfg.levelPlus!=o.buffType&&u.enumPBTBuffTypeCfg.levelSub!=o.buffType||(a=h.default.getInstance().getCardByRandom()),this._bubbleCtrl.init(o,a)}this.initEnermy()},e.prototype.getAtkPower=function(){return this._enermyCfg.atk},e.prototype.initEnermy=function(){var t=this;this.loadSpriteFrame(p.emPBTBundles.imgs,"enemys/enemy_"+this._enemyID,function(e){t.spIcon.spriteFrame=e,t.scheduleOnce(function(){t.node.setContentSize(t.spIcon.node.getContentSize()),t.lblHP.node.setPosition(0,t.node.height+15),t._bubbleCtrl&&(t._bubbleCtrl.node.setPosition(0,t.node.height+5),t.lblHP.node.setPosition(0,t.node.height+25))})})},e.prototype.updateHp=function(){this.lblHP.string=""+this._hp},e.prototype.removeFromScreen=function(){this.node.destroy()},e.prototype.playAttack=function(t,e){var o=this;this._isAttack||this.ani.playAttack(function(){e&&e()},function(){o._isAttack=!1,o.ani.playMove()})},e.prototype.onDie=function(){var t=this;if(this.setRoleState(p.emPBTRoleState.Die),this.lblHP.node.active=!1,this.ndBubbleRoot.active=!1,this.ske_die.node.active=!0,this.ndCollider.active=!1,this.ske_die.setAnimation(0,Math.random()<.5?"animation":"animation2",!1),this.ske_die.setCompleteListener(function(){t.node.destroy()}),this.ndShadow.active=!1,this.spIcon.node.runAction(cc.fadeOut(.2)),this._bubbleCtrl){var e=this._bubbleCtrl.node.convertToWorldSpaceAR(cc.Vec2.ZERO);this.sendEvent(p.emPBTEventName.PBT_Bubble_Buf,this._bubbleCtrl.getCfg(),e,this._bubbleCtrl.getCardID())}},e.prototype.bulletHited=function(t,e){return!this.isUseful||this.hasColliderTagID(t.getTagID())?p.emPBTHitState.None:(this._hp-=e,this.updateHp(),l.AudioMgr.getInstance().playEffectFree(p.PBT_AudioId.strike),this.addColliderTagID(t.getTagID()),this._hp<=0?(this.onDie(),p.emPBTHitState.HitDie):p.emPBTHitState.HitHurt)},e.prototype.playHpRoll=function(){this._isRolling||(this._isRolling=!0,this.scheduleLabelRoll(),this.schedule(this.scheduleLabelRoll,.05))},e.prototype.scheduleLabelRoll=function(){var t=Number(this.lblHP.string);t!=this._hp?(t>this._hp?t=Math.max(0,t-1):(t+=1,t=Math.min(t+1,this._hp)),this.lblHP.string=""+t,t==this._hp&&(this.unschedule(this.scheduleLabelRoll),this._isRolling=!1)):(this.unschedule(this.scheduleLabelRoll),this._isRolling=!1)},e.prototype.getWorldColliderRectWithFixed=function(t,e){var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position);return t=t||this._enermyCfg.width,e=e||this._enermyCfg.height,cc.rect(i.x-o.x*t,i.y-o.y*e,t,e)},c([_(sp.Skeleton)],e.prototype,"ske_die",void 0),c([_(sp.Skeleton)],e.prototype,"ske_hit",void 0),c([_(sp.Skeleton)],e.prototype,"ske_stu",void 0),c([_(g.default)],e.prototype,"ani",void 0),c([_(cc.Node)],e.prototype,"ndShadow",void 0),c([_(cc.Sprite)],e.prototype,"spIcon",void 0),c([_(cc.Node)],e.prototype,"ndBubbleRoot",void 0),c([_(cc.Label)],e.prototype,"lblHP",void 0),c([_(cc.Node)],e.prototype,"ndCollider",void 0),c([_(cc.Prefab)],e.prototype,"prefabBubble",void 0),c([v],e)}(f.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],PBT_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"9d3dd1Xo0hKVLItu+NzlsVQ","PBT_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"9d3dd1Xo0hKVLItu+NzlsVQ","PBT_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("Utils"),s=i("PBT_UserData"),c=i("PBT_DataMgr"),l=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[],c.default.getInstance().setMapIndex(r.Utils.randomRang(1,4))},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new s.default,this._userData.getData(),t&&t()},t}();a.default=l,cc._RF.pop(),cc._RF.pop()},{}],PBT_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"ea47c6Ap0hEi6s8g/W35GGx","PBT_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"ea47c6Ap0hEi6s8g/W35GGx","PBT_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("PBT_Configs"),f=i("PBT_BuffTips"),m=i("PBT_DataMgr"),g=i("PBT_PlayerMgr"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.tipPools=[],e}return s(e,t),e.prototype.onLoad=function(){var t=this;p.PoolMgr.getInstance().creatrePool("pbt_hit_effect",this.hitEffect,5),p.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2);var e=m.default.getInstance().getMapIndex();this.loadSpriteFrame(h.emPBTBundles.imgs,"backs/cj_"+(e<10?"0":"")+e,function(e){t.spBack.spriteFrame=e})},e.prototype.start=function(){var t=this;this.addEvent(h.emPBTEventName.PBT_Show_Hit_Text,this.onShowHitText),this.addEvent(h.emPBTEventName.PBT_Show_Warn,this.playWarn),this.addEvent(h.emPBTEventName.PBT_Show_Hit_Effect,this.showHitEffect),this.addEvent(h.emPBTEventName.PBT_Show_Buff_Tip,this.showBuffTip),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){g.default.getInstance().getState()==h.emPBTGameState.Game&&(g.default.getInstance().setState(h.emPBTGameState.Pause),u.UIMgr.getInstance().openUI(h.PBT_UIID.UISetting,d.UIID.UINONE,function(e){e?g.default.getInstance().setState(h.emPBTGameState.Game):t.sendEvent(h.emPBTEventName.PBT_Setting_Back)}))})},e.prototype.onShowHitText=function(t,e){var o,i=this;(o=this.tipPools.length>0?this.tipPools.pop():cc.instantiate(this.ndTipRoot.children[0])).parent=this.ndTipRoot,o.active=!0,o.getComponent(cc.Label).string=(t>0?"+":"")+t,o.color=t>0?cc.color().fromHEX("#0bff16"):cc.color().fromHEX("#ff4e49");var n=this.ndTipRoot.convertToNodeSpaceAR(cc.v2(e.x,e.y));o.setPosition(n.x,n.y),o.opacity=255,cc.tween(o).by(.3,{y:80}).to(.1,{opacity:0}).call(function(){o.removeFromParent(),i.tipPools.push(o)}).start()},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.ndWarn),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.ndWarn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.ndWarn),t.ndWarn.active=!1}).start()},e.prototype.showHitEffect=function(t,e){var o=this.node.convertToNodeSpaceAR(t),i=p.PoolMgr.getInstance().getNode("pbt_hit_effect");e==h.emPBTRoleType.Door?i.parent=this.doorHitEffctRoot:i.parent=this.node,i.setPosition(o),i.active=!0,i.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),i.getComponent(sp.Skeleton).setCompleteListener(function(){i.active=!1,p.PoolMgr.getInstance().freeNode("pbt_hit_effect",i)})},e.prototype.showBuffTip=function(t,e){var o=p.PoolMgr.getInstance().getNode("pbt_buff_img");o.parent=this.node;var i=this.node.convertToNodeSpaceAR(e);o.setPosition(i),o.getComponent(f.default).show(t)},c([_(cc.Node)],e.prototype,"ndTipRoot",void 0),c([_(cc.Node)],e.prototype,"ndWarn",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"hitEffect",void 0),c([_(cc.Node)],e.prototype,"ndBuffImg",void 0),c([_(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([_(cc.Sprite)],e.prototype,"spBack",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],PBT_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"f1e470ll8NM1rWpItDpP7Ln","PBT_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"f1e470ll8NM1rWpItDpP7Ln","PBT_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("UIMgr"),u=i("Config"),d=i("PBT_Configs"),h=i("PBT_Bullet"),f=i("PBT_Cards"),m=i("PBT_Door"),g=i("PBT_Enermy"),y=i("PBTGameEnumData"),v=i("PBT_DataMgr"),_=i("PBT_PlayerMgr"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.roleRoot=null,e._cardCtrl=null,e._bullets=[],e._waveRoles=[],e._curWave=0,e._waveDistance=300,e._doorScaleWidth=20,e.segments=[],e}return s(e,t),e.prototype.start=function(){this._cardCtrl=this.ndCardGroup.getComponent(f.default),this.initEvents(),this._waveDistance=v.default.getInstance().getParam(y.enumPBTBasicCfg.roundDistance,300),this._doorScaleWidth=v.default.getInstance().getParam(y.enumPBTBasicCfg.width,20);for(var t=Math.min(2*d.PBTConfig.WallWidth,cc.winSize.width),e=t/4,o=0;o<4;o++)this.segments.push(.5*-t+.5*e+e*o);this.buildWave(),this.scheduleOnce(function(){_.default.getInstance().setState(d.emPBTGameState.Game)})},e.prototype.initEvents=function(){var t=this;this.addEvent(d.emPBTEventName.PBT_Shoot_Bullet,this.onShootBullet),this.addEvent(d.emPBTEventName.PBT_Player_Die,function(){t.openResultView(1)}),this.addEvent(d.emPBTEventName.PBT_Setting_Back,function(){t.openResultView(0)}),this.addEvent(d.emPBTEventName.PBT_Bubble_Buf,function(e,o,i){e&&(i>0?t._cardCtrl.addCardLev(i,e.buffPara):t._cardCtrl.addBuff(e.buffType,e.buffPara),t.sendEvent(d.emPBTEventName.PBT_Show_Buff_Tip,e.buffType,o))}),this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(_.default.getInstance().getState()==d.emPBTGameState.Game){var o=e.getDeltaX();t.ndCardGroup.x+=o,t._cardCtrl.updateEdgePos()}})},e.prototype.update=function(t){var e=this;if(_.default.getInstance().getState()==d.emPBTGameState.Game){t=Math.min(t,.02),this._cardCtrl.updateCD(t);for(var o={pbt:null,dis:1e5,card:null},i={pbt:null,dis:1e5,card:null},n=0;n<this._waveRoles.length;n++)if((I=this._waveRoles[n]).updatePos(t),I.canRemoveScreen())I.removeFromScreen(),this._waveRoles.splice(n,1),n--;else{var a=I.getRoleType(),r=this._cardCtrl.checkCollider(I,0,50);if(r&&!this._cardCtrl.hasColliderGroupID(I.getGroupID())){var s=I.node.convertToWorldSpaceAR(cc.Vec3.ZERO),c=r.node.convertToWorldSpaceAR(cc.Vec3.ZERO),l=s.sub(c).mag();switch(a){case d.emPBTRoleType.Door:l<o.dis&&(o.pbt=I,o.dis=l,o.card=r);break;case d.emPBTRoleType.Enemy:l<i.dis&&(i.pbt=I,i.dis=l,i.card=r)}}}if(o.pbt&&o.card){var p=o.pbt;this._cardCtrl.addBuff(p.getBufType(),p.getValue());var u=p.node.convertToWorldSpaceAR(cc.Vec2.ZERO);u.y+=.5*p.node.height,this.sendEvent(d.emPBTEventName.PBT_Show_Buff_Tip,p.getBufType(),u),this._cardCtrl.addColliderGroupID(p.getGroupID());var h=this._waveRoles.indexOf(p);for(h>=0&&(this._waveRoles.splice(h,1),p.onDie()),n=0;n<this._waveRoles.length;n++)if(this._waveRoles[n].getGroupID()==p.getGroupID()){this._waveRoles[n].onDie(),this._waveRoles.splice(n,1);break}}if(i.pbt&&i.card){var f=i.pbt;this._cardCtrl.addColliderGroupID(f.getGroupID()),f.playAttack(f.node.x<this._cardCtrl.node.x?-1:1,function(){e._cardCtrl.enermyHit(f.getAtkPower())})}var m=[],g=function(t){for(var e=0,o=0;o<m.length;o++)m[o]==t&&e++;return e},y=[];for(n=0;n<this._bullets.length;n++){var v=this._bullets[n];if(v.checkAutoDie())v.onDie(),this._bullets.splice(n,1),n--;else if(v.isUseful)for(var b=v.getWorldColldierRect(),B=0;B<this._waveRoles.length;B++){var I;if((I=this._waveRoles[B]).isUseful){var P=I.getScaleSize(),C=I.getRoleType()==d.emPBTRoleType.Enemy?d.PBTConfig.EnemyFixedWidth:P.width,D=I.getWorldColliderRectWithFixed(C,P.height);if(b.intersects(D)){var T=g(I.getTagID());m.push(I.getTagID());var S=I.bulletHited(v,v.getAtkDamage(),T);if(I.isDie&&(this._waveRoles.splice(B,1),B--),S>0){if(this.sendEvent(d.emPBTEventName.PBT_Show_Hit_Effect,v.node.convertToWorldSpaceAR(cc.Vec2.ZERO),I.getRoleType()),v.removeFromScreen(),this._bullets.splice(n,1),n--,I.getRoleType()==d.emPBTRoleType.Door){for(var A=0;A<this._waveRoles.length;A++)if(this._waveRoles[A].getGroupID()==I.getGroupID()&&this._waveRoles[A].getTagID()!=I.getTagID()){var k=I,w=this._waveRoles[A],N=k.getScaleWidth(this._doorScaleWidth),R=w.getScaleWidth(-this._doorScaleWidth);if(N>0&&R>0){var M=Math.min(N,R);k.scaleWidth(M),w.scaleWidth(-M)}break}y.push(v.getGroupID())}break}}}}}for(n=0;n<this._bullets.length;n++)y.indexOf(this._bullets[n].getGroupID())>=0&&(this.sendEvent(d.emPBTEventName.PBT_Show_Hit_Effect,this._bullets[n].node.convertToWorldSpaceAR(cc.Vec2.ZERO),d.emPBTRoleType.Door),this._bullets[n].removeFromScreen(),this._bullets.splice(n,1),n--);this.buildWave()}},e.prototype.needBuildWave=function(){return 0==this._waveRoles.length||this._waveRoles[this._waveRoles.length-1].node.y<=.5*cc.winSize.height},e.prototype.openResultView=function(t){var e=this;_.default.getInstance().getState()!=d.emPBTGameState.Over&&(_.default.getInstance().setState(d.emPBTGameState.Over),this.scheduleOnce(function(){p.UIMgr.getInstance().openUI(d.PBT_UIID.UIResult,u.UIID.UINONE,e._curWave)},t))},e.prototype.buildWave=function(){var t=v.default.getInstance().getWaveCfgs();if(this._curWave>=t.length)0==this._waveRoles.length&&this.openResultView(0);else for(;this.needBuildWave();){for(var e=t[this._curWave],o=[],i=_.default.getInstance().getGroupID(),n=1;n<5;n++)e["position"+n]&&e["position"+n+"Para"]&&o.push({posIndex:n,type:e["position"+n],value:e["position"+n+"Para"]});var a=e.roundDistance?e.roundDistance:this._waveDistance,r=this._cardCtrl.node.y+a;for(this._waveRoles.length>0&&(r=this._waveRoles[this._waveRoles.length-1].node.y+a),this._curWave>0&&r<.5*cc.winSize.height&&(r=.5*cc.winSize.height),n=0;n<o.length;n++){var s=o[n].type,c=o[n].posIndex-1;if(v.default.getInstance().isBuffType(s)){var l=cc.instantiate(this.prefabDoor);l.parent=this.roleRoot,l.setPosition(c<2?.5*(this.segments[0]+this.segments[1]):.5*(this.segments[2]+this.segments[3]),r);var p=l.getComponent(m.default);p.init(s,o[n].value),p.resetSize(d.PBTConfig.WallWidth),p.setGroupID(i),this._waveRoles.push(p)}else if(s.indexOf(",")>=0||!isNaN(Number(s))){var u=cc.instantiate(this.prefabEnemy);u.parent=this.roleRoot,u.setPosition(this.segments[c],r);var h=u.getComponent(g.default);h.init(s,o[n].value),h.setGroupID(i),this._waveRoles.push(h)}}if(this._curWave++,this._curWave>=t.length)return}},e.prototype.onShootBullet=function(t,e,o){var i=cc.instantiate(this.prefabBullet);i.parent=this.ndBulletRoot;var n=this.ndBulletRoot.convertToNodeSpaceAR(e);i.setPosition(n);var a=i.getComponent(h.default);a.setGroupID(t);var r=Math.round(this._cardCtrl.getAtkDamage());a.init(o.getCardCfg(),r),this._bullets.push(a)},c([I(cc.Node)],e.prototype,"ndCardGroup",void 0),c([I(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([I(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([I(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([I(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([I(cc.Node)],e.prototype,"roleRoot",void 0),c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],PBT_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"708121VIuBPUYAK7eGN5OWU","PBT_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"708121VIuBPUYAK7eGN5OWU","PBT_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("PBT_Configs"),d=i("PBT_DataMgr"),h=i("PBT_App"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.lblRwd=null,e}return s(e,t),e.prototype.init=function(t){this._levIndex=t},e.prototype.start=function(){var t=d.default.getInstance().getWaveCfgs(),e=this._levIndex>=t.length;this.btn.on(cc.Node.EventType.TOUCH_END,function(){h.default.instance.exit_App(e?20:0)});var o=Math.min(Math.max(0,this._levIndex/t.length),1);this.lblBar.string=Math.floor(100*o)+"%",cc.tween(this.spBar).delay(.3).to(.5,{fillRange:o}).start(),this.ndWin.active=e,this.ndFail.active=!e,this.ndTop.y=e?141.512:112,this.ndBar.y=e?-86.812:32,this.btn.y=e?-210.709:-114,this.lblRwd.string="20",p.AudioMgr.getInstance().stopMusic(u.PBTConfig.BgMusic),p.AudioMgr.getInstance().playEffectFree(e?u.PBT_AudioId.victory:u.PBT_AudioId.fail)},c([g(cc.Label)],e.prototype,"lblBar",void 0),c([g(cc.Sprite)],e.prototype,"spBar",void 0),c([g(cc.Node)],e.prototype,"ndWin",void 0),c([g(cc.Node)],e.prototype,"ndFail",void 0),c([g(cc.Node)],e.prototype,"ndTop",void 0),c([g(cc.Node)],e.prototype,"ndBar",void 0),c([g(cc.Node)],e.prototype,"btn",void 0),c([g(cc.Label)],e.prototype,"lblRwd",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],PBT_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"3ea36+4S8VJGqR0nT2eNLBK","PBT_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"3ea36+4S8VJGqR0nT2eNLBK","PBT_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.btnPlay=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.onEnable=function(){this.musicSlider.progress=p.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=p.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),p.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),p.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!1),t.closeUI()}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([h(cc.Slider)],e.prototype,"musicSlider",void 0),c([h(cc.Slider)],e.prototype,"effectSlider",void 0),c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"btnBackHome",void 0),c([h(cc.Node)],e.prototype,"btnPlay",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],PBT_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"830201K0DRIDLo6p3X3mMBj","PBT_UserData");var i=t,n=e,a=o;cc._RF.push(n,"830201K0DRIDLo6p3X3mMBj","PBT_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={},e.gameKey=l.GameConfig.AppCacheName+"pbt_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],PlatformConfig:[function(t,e,o){"use strict";cc._RF.push(e,"7abe2bKAsJDVJEZCP3slJy+","PlatformConfig");var i,n,a,r,s,c,l,p,u,d,h,f,m,g,y,v,_,b,B=t,I=e,P=o;cc._RF.push(I,"7abe2bKAsJDVJEZCP3slJy+","PlatformConfig"),Object.defineProperty(P,"__esModule",{value:!0}),P.WechatAppInfo=P.ServerDataCfg=P.AdConfig=P.UM_VERSION=P.SWCF=P.ABSettingCF=P.ABCF=void 0;var C=B("BasePlatform"),D=B("Appcfg"),T=B("PlatformSetting");P.ABCF=((i={})[T.AppName.Main]=((n={})[D.ABD_ENV.DEV]={switchId:1708},n[D.ABD_ENV.PRO]={switchId:1707},n),i[T.AppName.YSJXD]=((a={})[D.ABD_ENV.DEV]={switchId:1720},a[D.ABD_ENV.PRO]={switchId:1719},a),i[T.AppName.WXDDJ]=((r={})[D.ABD_ENV.DEV]={switchId:1928},r[D.ABD_ENV.PRO]={switchId:1927},r),i),P.ABSettingCF=((s={})[T.AppName.Main]=((c={})[C.Platform.EDITOR]={type:D.ABTestType.A_fixed},c[C.Platform.BYTEDANCE]={type:D.ABTestType.AB_Test},c[C.Platform.WEB_LINK]={type:D.ABTestType.A_fixed},c[C.Platform.VIVO]={type:D.ABTestType.A_fixed},c[C.Platform.Implode]={type:D.ABTestType.A_fixed},c[C.Platform.ANDROID_233]={type:D.ABTestType.A_fixed},c[C.Platform.OPPO]={type:D.ABTestType.A_fixed},c[C.Platform.WECHAT]={type:D.ABTestType.A_fixed},c),s[T.AppName.YSJXD]=((l={})[C.Platform.BYTEDANCE]={type:D.ABTestType.NO_AB},l[C.Platform.WECHAT]={type:D.ABTestType.AB_Test},l),s[T.AppName.WXDDJ]=((p={})[C.Platform.BYTEDANCE]={type:D.ABTestType.A_fixed},p),s),P.SWCF=((u={})[T.AppName.Main]=((d={})[T.SwitchID.ShenHe]={appId:1705,h5_wechat:5,h5_bytedance:60,h5_oppo:0,h5_vivo:0,h5_qq:0,h5_kuaikan:0,android_google:0,android_vivo:0,android_233:0,android_4399:0,android_xiaomi:0,h5_baidu:0,ios:0},d[T.SwitchID.ShenHe_ABD]={appId:1706,h5_wechat:5,h5_bytedance:60,h5_oppo:0,h5_vivo:0,h5_qq:0,h5_kuaikan:0,android_google:0,android_vivo:0,android_233:0,android_4399:0,android_xiaomi:0,h5_baidu:0,ios:0},d),u[T.AppName.YSJXD]=((h={})[T.SwitchID.ShenHe]={appId:1717,h5_wechat:1,h5_bytedance:0,h5_oppo:0,h5_vivo:0,h5_qq:0,h5_kuaikan:0,android_google:0,android_vivo:0,android_233:0,android_4399:0,android_xiaomi:0,h5_baidu:0,ios:0},h[T.SwitchID.ShenHe_ABD]={appId:1718,h5_wechat:1,h5_bytedance:0,h5_oppo:0,h5_vivo:0,h5_qq:0,h5_kuaikan:0,android_google:0,android_vivo:0,android_233:0,android_4399:0,android_xiaomi:0,h5_baidu:0,ios:0},h),u[T.AppName.WXDDJ]=((f={})[T.SwitchID.ShenHe]={appId:1925,h5_wechat:0,h5_bytedance:1,h5_oppo:0,h5_vivo:0,h5_qq:0,h5_kuaikan:0,android_google:0,android_vivo:0,android_233:0,android_4399:0,android_xiaomi:0,h5_baidu:0,ios:0},f[T.SwitchID.ShenHe_ABD]={appId:1926,h5_wechat:0,h5_bytedance:1,h5_oppo:0,h5_vivo:0,h5_qq:0,h5_kuaikan:0,android_google:0,android_vivo:0,android_233:0,android_4399:0,android_xiaomi:0,h5_baidu:0,ios:0},f),u),P.UM_VERSION=((m={})[T.AppName.Main]={h5_wechat:"1.0.4",h5_bytedance:"1.6.0",h5_oppo:"1.0.0",h5_vivo:"1.0.1",h5_qq:"1.0.0",h5_kuaikan:"1",android_google:"1.0.0",android_vivo:"1.0.0",android_233:"1.0.0",android_4399:"1.0.0",android_xiaomi:"1.0.0",h5_baidu:"1.0.0",ios:"1.0.0",editor:"1.0.0",android_ohayoo:"1.0.0",android_bytedance:"1.0.0",Google:"1.0.0",kuaishou:"1.0.0",huawei:"1.0.0",weblink:"1.0.0",Implode:"1.0.0"},m[T.AppName.YSJXD]={h5_bytedance:"1.0.0",h5_wechat:"1.0.6",h5_kuaikan:"1.0.0",editor:"1.0.0"},m[T.AppName.WXDDJ]={h5_bytedance:"1.0.0",h5_wechat:"1.0.0",weblink:"1.0.0"},m),P.AdConfig=((g={})[T.AppName.Main]=((y={})[C.Platform.WECHAT]={videoId:"adunit-8a9c2e14c19ab6aa",multitonVideoId:"adunit-8a9c2e14c19ab6aa",appTitle:"\u9b54\u6027\u5927\u5192\u9669",templateId:"33",insertId:"44",bannerId:"55",splashId:"66",nativeId:"77788"},y[C.Platform.BYTEDANCE]={videoId:"11n2jd3bi1pclb8jh1",multitonVideoId:"11n2jd3bi1pclb8jh1",appTitle:"\u9b54\u6027\u5927\u5192\u9669",insertId:"dd",bannerId:"dd",splashId:"dd",nativeId:"dd"},y[C.Platform.EDITOR]={},y[C.Platform.WEB_LINK]={},y),g[T.AppName.YSJXD]=((v={})[C.Platform.BYTEDANCE]={},v[C.Platform.WECHAT]={videoId:"adunit-934e485dfde3cc58",multitonVideoId:"adunit-934e485dfde3cc58",appTitle:"\u5f02\u4e16\u754c\u5c0f\u961f"},v),g[T.AppName.WXDDJ]=((_={})[C.Platform.BYTEDANCE]={videoId:"tuqibaatnha4e33c48",multitonVideoId:"tuqibaatnha4e33c48",appTitle:"\u65e0\u9650\u5927\u5bf9\u51b3"},_),g),P.ServerDataCfg=((b={})[T.AppName.Main]={wechatOpened:!0,douyinOpened:!0,serverdataid:216},b[T.AppName.YSJXD]={wechatOpened:!0,douyinOpened:!1,serverdataid:231},b[T.AppName.WXDDJ]={wechatOpened:!1,douyinOpened:!0,serverdataid:406},b),function(t){t[t.APP_ID=3]="APP_ID"}(P.WechatAppInfo||(P.WechatAppInfo={})),cc._RF.pop(),cc._RF.pop()},{}],PlatformManager:[function(t,e,o){"use strict";cc._RF.push(e,"12479gU5UZCYZQwVmRaTNyH","PlatformManager");var i=t,n=e,a=o;cc._RF.push(n,"12479gU5UZCYZQwVmRaTNyH","PlatformManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.PlatformManager=void 0;var r=i("BasePlatform"),s=i("UIMgr"),c=i("AndroidManager"),l=i("ByteDanceManager"),p=i("OppoManager"),u=i("VivoManager"),d=i("WechatManager"),h=i("KSManager"),f=i("WebLinkManager"),m=i("EditorManager"),g=i("IosManager"),y=i("Config"),v=i("PlatformSetting"),_=i("ImplodeManager"),b=function(){function t(){}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){switch(t.currentPlatform){case r.Platform.ANDROID_233:this.currentPaltform=new c.AndroidManager,window.AndroidManager=this.currentPaltform;break;case r.Platform.BYTEDANCE:this.currentPaltform=new l.BytedanceManager;break;case r.Platform.OPPO:this.currentPaltform=new p.OppoManager;break;case r.Platform.VIVO:this.currentPaltform=new u.VivoManager;break;case r.Platform.Ios:this.currentPaltform=new g.IosManager;break;case r.Platform.WECHAT:this.currentPaltform=new d.WechatManager;break;case r.Platform.KuaiShou:this.currentPaltform=new h.KSManager;break;case r.Platform.Implode:this.currentPaltform=new _.ImplodeManager;break;default:t.currentPlatform==r.Platform.WEB_LINK?this.currentPaltform=new f.WebLinkManager:this.currentPaltform=new m.EditorManager}t.currentPlatform!=r.Platform.WEB_LINK||cc.sys.platform==cc.sys.ALIPAY_GAME||-1!=window.location.href.indexOf("game2.sfplay.net")||-1!=window.location.href.indexOf("localhost")||-1!=window.location.href.indexOf("192.168.2")||-1!=window.location.href.indexOf("172.18.0")||-1!=window.location.href.indexOf("192.168.1")?this.initSdk():s.UIMgr.getInstance().addBlockTouch()},t.prototype.initSdk=function(){this.currentPaltform||(this.currentPaltform=new m.EditorManager),this.currentPaltform.initSdk()},t.prototype.getIsZhiTou=function(){return t.currentPlatform==r.Platform.BYTEDANCE&&this.currentPaltform.getIsZhiTouUser()},t.prototype.getEnableRemoteCfg=function(){return t.currentPlatform==r.Platform.EDITOR&&this.currentPaltform.getEnableRemoteCfg()},t.prototype.showBanner=function(t,e){this.currentPaltform.showBanner(t,e)},t.prototype.shark=function(t,e){this.currentPaltform.shark(t,e)},t.prototype.hideBanner=function(t,e){this.currentPaltform.hideBanner(t,e)},t.prototype.showInsertAd=function(t,e){this.currentPaltform.showInsertAd(t,e)},t.prototype.getLaunchOptionsSync=function(t){this.currentPaltform.getLaunchOptionsSync?this.currentPaltform.getLaunchOptionsSync(t):t&&t()},t.prototype.getUserInfo=function(t){this.currentPaltform.getUserInfo?this.currentPaltform.getUserInfo(t):t&&t(null,null)},t.prototype.showVideoAd=function(t,e,o,i){this.currentPaltform.showVideoAd(t,o,i,e)},t.prototype.playMultitonVideo=function(t,e,o,i,n,a){this.currentPaltform.playMultitonVideo&&this.currentPaltform.playMultitonVideo(t,e,o,i,n,a)},t.prototype.checkShortcut=function(t,e){this.currentPaltform.checkShortcut&&this.currentPaltform.checkShortcut(t,e)},t.prototype.addShortcut=function(t,e){this.currentPaltform.addShortcut&&this.currentPaltform.addShortcut(t,e)},t.prototype.otherFun=function(t,e){this.currentPaltform.otherFun(t,e)},t.prototype.recordVideo=function(t,e){this.currentPaltform.recordVideo(t,e)},t.prototype.stopRecorderManager=function(t,e,o){this.currentPaltform.stopRecorderManager(t,e,o)},t.prototype.youmengTrack=function(t,e,o,i){this.currentPaltform.youmengTrack(t,e,o,i)},t.prototype.hasVerify=function(){return this.currentPaltform.hasVerify()},t.prototype.getNativeCode=function(t){this.currentPaltform.getCode&&this.currentPaltform.getCode(t)},t.prototype.canShare=function(){return!!this.currentPaltform.canShare&&this.currentPaltform.canShare()},t.prototype.pauseRecord=function(){this.currentPaltform.pauseRecord&&this.currentPaltform.pauseRecord()},t.prototype.resumeRecord=function(){this.currentPaltform.resumeRecord&&this.currentPaltform.resumeRecord()},t.prototype.shareVideo=function(t,e){this.currentPaltform.shareVideo&&this.currentPaltform.shareVideo(t,e)},t.prototype.toAppStore=function(t){this.currentPaltform.toAppStore&&this.currentPaltform.toAppStore(t)},t.prototype.openNotify=function(){this.currentPaltform.openNotify&&this.currentPaltform.openNotify()},t.prototype.shareImg=function(t,e){this.currentPaltform.shareImg&&this.currentPaltform.shareImg(t,e)},t.prototype.getSystem=function(){return this.currentPaltform.getSystem?this.currentPaltform.getSystem():y.SystemPlatform.UNKNOWN},t.prototype.checkCanOpenSideBar=function(e){this.currentPaltform.checkCanOpenSideBar?this.currentPaltform.checkCanOpenSideBar(e):t.currentPlatform==r.Platform.EDITOR?e(!0):e(!1)},t.prototype.openSideBar=function(t){this.currentPaltform.openSideBar?this.currentPaltform.openSideBar(t):t(!0)},t.prototype.isFromBroadside=function(t){return!this.currentPaltform.isFromBroadside||this.currentPaltform.isFromBroadside(t)},t.currentPlatform=v.PlatformSetting.currentPlatform,t}();a.PlatformManager=b,cc._RF.pop(),cc._RF.pop()},{}],PlatformSetting:[function(t,e,o){"use strict";cc._RF.push(e,"593e92DzeNHDKjOzov10u69","PlatformSetting");var i=t,n=e,a=o;cc._RF.push(n,"593e92DzeNHDKjOzov10u69","PlatformSetting"),Object.defineProperty(a,"__esModule",{value:!0}),a.PlatformSetting=a.SwitchID=a.AppName=void 0;var r,s=i("BasePlatform");(function(t){t.Main="Main",t.YSJXD="YSJXD",t.WXDDJ="WXDDJ"})(r=a.AppName||(a.AppName={})),function(t){t[t.ShenHe=0]="ShenHe",t[t.ShenHe_ABD=1]="ShenHe_ABD"}(a.SwitchID||(a.SwitchID={}));var c=function(){function t(){}return t.currentApp=r.Main,t.currentPlatform=s.Platform.WEB_LINK,t}();a.PlatformSetting=c,cc._RF.pop(),cc._RF.pop()},{}],PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a031fojBN1NlYGcg1sGyLFU","PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"a031fojBN1NlYGcg1sGyLFU","PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.GoodsInfo=a.PlayerMgr=void 0;var r=i("Appcfg"),s=i("EventMgr"),c=i("LogMgr"),l=i("UIMgr"),p=i("Config"),u=i("BraveTowerEnum"),d=i("GameDailyData"),h=i("GameGuideData"),f=i("GameSetData"),m=i("GameTaskData"),g=i("GameTrackData"),y=i("GameUserData"),v=i("GameEnumData"),_=i("DataMgr"),b=function(){function t(){this.isLoaded=!1,this.mapCardToTies=new Map}return t.getInstance=function(){return null==this.instance&&(this.instance=new t,this.instance.initData()),this.instance},t.prototype.initData=function(){},t.prototype.preload=function(){var t=this;this.isLoaded||(this.isLoaded=!0,this.udata=new y.UserData,this.udata.getData(),this.setData=new f.GameSetData,this.setData.getData(),this.guideData=new h.GuideData,this.guideData.getData(),this.trackData=new g.TrackData,this.trackData.getData(),this.dailyData=new d.GameDailyData,this.dailyData.getData(),this.taskData=new m.GameTaskData,this.taskData.getData(),this.trackData.getSdkAbName(function(e){c.LogMgr.getInstance().debug("\u7528\u6237\u7c7b\u578b\uff1a"+e,""),_.DataMgr.getInstance().reloadConfig(e,function(){s.EventMgr.getInstance().emit(r.BaseEventName.Loading,r.LoadingProcess.PlayerCfg),t.reloadConfig()})}))},t.prototype.reloadConfig=function(){this.udata.reloadConfig()},t.prototype.reloadDataFromServer=function(){this.udata=new y.UserData,this.udata.getData(),this.setData=new f.GameSetData,this.setData.getData(),this.guideData=new h.GuideData,this.guideData.getData(),this.trackData=new g.TrackData,this.trackData.getData(),this.dailyData=new d.GameDailyData,this.dailyData.getData(),this.taskData=new m.GameTaskData,this.taskData.getData()},t.prototype.getServerData=function(){return this.data},t.prototype.setServerData=function(t){this.data=t},t.prototype.getAbType=function(){return this.trackData.getAbType()},t.prototype.getDynamicAbType=function(){return this.trackData.getDynamicAbType()},t.prototype.getGuideData=function(){return this.guideData},t.prototype.getUserData=function(){return this.udata},t.prototype.getTrackData=function(){return this.trackData},t.prototype.getSetData=function(){return this.setData},t.prototype.getDailyData=function(){return this.dailyData},t.prototype.getTaskData=function(){return this.taskData},t.prototype.onStrToReward=function(t){for(var e=[],o=t.split(p.GameConfig.splitCount),i=0;i<o.length;i++)if(!(o[i].length<=0)){var n=o[i].split(p.GameConfig.splitNum),a=Number(n[0]),r=Number(n[1]);e.push(new B(a,r))}return e},t.prototype.onRewardToStr=function(t){for(var e="",o=0;o<t.length;o++){var i=t[o];e+=i.id+p.GameConfig.splitNum+i.num+p.GameConfig.splitCount}return e.substring(0,e.length-1)},t.prototype.addRewards=function(t,e,o){void 0===e&&(e=1);for(var i=t.split(p.GameConfig.splitCount),n=0;n<i.length;n++)if(!(i[n].length<=0)){var a=i[n].split(p.GameConfig.splitNum),r=Number(a[0]),c=Number(a[1])*e;switch(r){case v.BraveTowerEnumGoodsCfg.Coin:this.udata.addGoldNum(c),o&&s.EventMgr.getInstance().emit(p.EventName.AniGold,o),this.taskData.addGetGold(c);break;case v.BraveTowerEnumGoodsCfg.Diamond:this.udata.addDiamondNum(c),o&&s.EventMgr.getInstance().emit(p.EventName.AniDiamond,o);break;case v.BraveTowerEnumGoodsCfg.Coupon:this.udata.addCouponNum(c);break;case v.BraveTowerEnumGoodsCfg.BlueCard:this.udata.addFreeNum(0,c);break;case v.BraveTowerEnumGoodsCfg.PurpleCard:this.udata.addFreeNum(1,c);break;case v.BraveTowerEnumGoodsCfg.GoldCard:this.udata.addFreeNum(2,c);break;default:console.error("\u672a\u77e5\u7684\u5956\u52b1\u7c7b\u578b",i[n])}}s.EventMgr.getInstance().emit(u.BraveTowerEventName.UpdateRedPoint,31)},t.prototype.addRewardPop=function(t){this.addRewards(t),l.UIMgr.getInstance().openUI(p.UIID.UIReward,p.UIID.UINONE,t)},t.prototype.getCardTies=function(t){if(this.mapCardToTies.has(t))return this.mapCardToTies.get(t);for(var e=[],o=_.DataMgr.getInstance().getTiesCfgList(),i=0;i<o.length;i++)for(var n=o[i],a=0;a<n.effectList.length;a++)n.effectList[a].cardId==t&&e.push(n.id);return this.mapCardToTies.set(t,e),e},t.prototype.getCardAttack=function(t){var e=this.udata.getCardById(t),o=_.DataMgr.getInstance().getCardCfg(t);return e?o.attNum+function(t,e){for(var o=0,i=1;i<t;i++){for(var n=e[0],a=0;a<e.length&&!(e[a][0]>i);a++)n=a<e.length-1?e[a+1]:e[e.length-1];o+=n[1]}return o}(e.level,o.AttGradeAdd):o.attNum},t.prototype.getCardAttackNext=function(t){var e=this.udata.getCardById(t),o=_.DataMgr.getInstance().getCardCfg(t);return e?o.attNum+function(t,e){for(var o=0,i=1;i<t;i++){for(var n=e[0],a=0;a<e.length&&!(e[a][0]>i);a++)n=a<e.length-1?e[a+1]:e[e.length-1];o+=n[1]}return o}(e.level+1,o.AttGradeAdd):o.attNum},t}();a.PlayerMgr=b;var B=function(t,e){this.id=t,this.num=e};a.GoodsInfo=B,cc._RF.pop(),cc._RF.pop()},{}],PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"20ec7h/8G9PQZ8e/5M6Hnno","PoolMgr");var i=e,n=o;cc._RF.push(i,"20ec7h/8G9PQZ8e/5M6Hnno","PoolMgr"),Object.defineProperty(n,"__esModule",{value:!0}),n.PoolMgr=n.PoolNode=void 0;var a=function(){function t(){this._isReady=!1,this._createCount=0,this._warterMark=50,this._node=null,this._nodes=new cc.NodePool}return t.prototype.init=function(t,e){this._node=t,this._isReady=!0;for(var o=0;o<e;o++){var i=cc.instantiate(t);this._createCount++,this._nodes.put(i)}},t.prototype.getNode=function(){return this._nodes.size()>0?this._nodes.get():this._node&&cc.isValid(this._node)?(this._createCount++,cc.instantiate(this._node)):null},t.prototype.freeNode=function(t){t&&cc.isValid(t)?this._warterMark<this._nodes.size()?(this._createCount--,t.destroy()):(t.removeFromParent(),this._nodes.put(t)):this._createCount--},t.prototype.setWaterMark=function(t){this._warterMark=t},t.prototype.destory=function(){this._createCount-=this._nodes.size();for(var t=0;t<this._nodes.size();t++){var e=this._nodes.get(t);e&&e.destroy()}this._nodes.clear()},t}();n.PoolNode=a;var r=function(){function t(){this.poolMap=new Map}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.creatrePool=function(t,e,o){if(void 0===o&&(o=1),this.poolMap.has(t)){var i=this.poolMap.get(t);i.destory(),i=null}var n=new a;e&&n.init(e,o),this.poolMap.set(t,n)},t.prototype.getNode=function(t){if(!this.poolMap.has(t))return null;var e=this.poolMap.get(t).getNode();return cc.isValid(e)?e:null},t.prototype.checkHasPool=function(t){return this.poolMap.has(t)},t.prototype.freeNode=function(t,e){this.poolMap.has(t)?this.poolMap.get(t).freeNode(e):e.destroy()},t.prototype.clearPool=function(t){if(t){var e=this.poolMap.get(t);e&&cc.isValid(e)&&e.destory(),this.poolMap.delete(t)}else this.poolMap.forEach(function(t){t&&cc.isValid(t)&&t.destory()}),this.poolMap.clear()},t.instance=null,t}();n.PoolMgr=r,cc._RF.pop(),cc._RF.pop()},{}],PopUserPrivacy:[function(t,e,o){"use strict";cc._RF.push(e,"3a45fNCS0ZM5LYaTKFjlliF","PopUserPrivacy");var i=t,n=e,a=o;cc._RF.push(n,"3a45fNCS0ZM5LYaTKFjlliF","PopUserPrivacy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.PopUserPrivacy=void 0;var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClick=null,e.btnClick2=null,e.btnAgree=null,e.btnDisagree=null,e.btnBack=null,e.userPrivacyNode=null,e.itemLabel=null,e.titleLabel=null,e.textArr=[],e.ind=0,e.NoUI=!1,e.isCloseUI=!1,e}return s(e,t),e.prototype.init=function(t){this.isclose=!1,this.NoUI=!(!t||1!=t)},e.prototype.setTitle=function(){u.PlatformManager.currentPlatform==l.Platform.KuaiShou?this.titleLabel.string="\u9690\u79c1\u6743\u4fdd\u62a4\u653f\u7b56-\u5feb\u624b\u5c0f\u6e38\u620f":this.titleLabel.string="\u9690\u79c1\u6743\u4fdd\u62a4\u653f\u7b56"},e.prototype.setTitle2=function(){u.PlatformManager.currentPlatform==l.Platform.KuaiShou?this.titleLabel.string="\u7528\u6237\u534f\u8bae\u653f\u7b56-\u5feb\u624b\u5c0f\u6e38\u620f":this.titleLabel.string="\u7528\u6237\u534f\u8bae\u653f\u7b56"},e.prototype.onClick1=function(){var t=this;this.gameData&&this.onDestroyA(function(){t.setTitle(),t.textArr=t.gameData.PrivacyCfg,t.userPrivacyNode.active=!0,t.schedule(t.updateText2,.01)})},e.prototype.onClick2=function(){var t=this;this.gameData&&this.onDestroyA(function(){t.setTitle2(),t.textArr=t.gameData.PrivacyCfg2,t.userPrivacyNode.active=!0,t.schedule(t.updateText2,.01)})},e.prototype.onLoad=function(){var t=this;this.btnClick.on(cc.Node.EventType.TOUCH_END,function(){t.onClick1()},this),this.btnClick2.on(cc.Node.EventType.TOUCH_END,function(){t.onClick2()},this),this.btnAgree.on(cc.Node.EventType.TOUCH_END,function(){cc.sys.localStorage.setItem("isReadsfplay.netricy","true"),console.log(cc.director.getScene().name),cc.director.loadScene("Main"),t.closeUI()},this),this.btnDisagree.on(cc.Node.EventType.TOUCH_END,function(){cc.game.end()},this),this.btnBack.on(cc.Node.EventType.TOUCH_END,function(){1==t.NoUI&&t.closeUI(),t.userPrivacyNode.active=!1},this),cc.assetManager.loadBundle("configPrivacy",function(e,o){e||o.load("GameJsonCfg",cc.JsonAsset,function(e,o){e?console.error("\u52a0\u8f7d\u9519\u8bef%s",JSON.stringify(e)):(t.gameData=o.json,1==t.NoUI&&t.onClick1()),cc.assetManager.releaseAsset(o)})})},e.prototype.start=function(){},e.prototype.setText=function(t){var e=cc.instantiate(this.itemLabel);e.active=!0,this.itemLabel.parent.addChild(e),e.getComponent(cc.Label).string=t},e.prototype.onClose=function(){this.isCloseUI=!0},e.prototype.onDestroyA=function(t){if(this.ind=0,this.itemLabel.parent.children[2])for(var e=2;e<this.itemLabel.parent.children.length;e++)this.itemLabel.parent.children[e].destroy(),e+1==this.itemLabel.parent.children.length&&t&&t();else t&&t()},e.prototype.updateText2=function(){if(this.isCloseUI)this.unschedule(this.updateText2);else{var t=this.textArr[this.ind];if(t){for(var e=Math.floor(t.content.length/23),o=23,i=0,n=0;n<e;n++){var a=t.content.substring(i,o);i+=23,o+=23,this.setText(a)}t.content.length%23!=0&&this.setText(t.content.substring(t.content.length-t.content.length%23,t.content.length)),this.ind++,this.ind>=this.textArr.length&&this.unschedule(this.updateText2)}}},c([f(cc.Node)],e.prototype,"btnClick",void 0),c([f(cc.Node)],e.prototype,"btnClick2",void 0),c([f(cc.Node)],e.prototype,"btnAgree",void 0),c([f(cc.Node)],e.prototype,"btnDisagree",void 0),c([f(cc.Node)],e.prototype,"btnBack",void 0),c([f(cc.Node)],e.prototype,"userPrivacyNode",void 0),c([f(cc.Node)],e.prototype,"itemLabel",void 0),c([f(cc.Label)],e.prototype,"titleLabel",void 0),c([h],e)}(p.default);a.PopUserPrivacy=m,cc._RF.pop(),cc._RF.pop()},{}],QuadTree:[function(t,e,o){"use strict";cc._RF.push(e,"e9a32rx3g1PiKTQmCHFzru2","QuadTree");var i=e,n=o;cc._RF.push(i,"e9a32rx3g1PiKTQmCHFzru2","QuadTree"),Object.defineProperty(n,"__esModule",{value:!0}),n.Quadtree=void 0;var a=function(){function t(t,e,o,i){void 0===e&&(e=10),void 0===o&&(o=4),void 0===i&&(i=0),this.max_objects=e,this.max_levels=o,this.level=i,this.bounds=t,this.objects=[],this.nodes=[]}return t.prototype.split=function(){var e=this.level+1,o=this.bounds.width/2,i=this.bounds.height/2,n=this.bounds.x,a=this.bounds.y;this.nodes[0]=new t({x:n+o,y:a,width:o,height:i},this.max_objects,this.max_levels,e),this.nodes[1]=new t({x:n,y:a,width:o,height:i},this.max_objects,this.max_levels,e),this.nodes[2]=new t({x:n,y:a+i,width:o,height:i},this.max_objects,this.max_levels,e),this.nodes[3]=new t({x:n+o,y:a+i,width:o,height:i},this.max_objects,this.max_levels,e)},t.prototype.getIndex=function(t){var e=[],o=this.bounds.x+this.bounds.width/2,i=this.bounds.y+this.bounds.height/2,n=t.y<i,a=t.x<o,r=t.x+t.width>o,s=t.y+t.height>i;return n&&r&&e.push(0),a&&n&&e.push(1),a&&s&&e.push(2),r&&s&&e.push(3),e},t.prototype.insert=function(t){var e,o=0;if(this.nodes.length)for(e=this.getIndex(t),o=0;o<e.length;o++)this.nodes[e[o]].insert(t);else if(this.objects.push(t),this.objects.length>this.max_objects&&this.level<this.max_levels){for(this.nodes.length||this.split(),o=0;o<this.objects.length;o++){e=this.getIndex(this.objects[o]);for(var i=0;i<e.length;i++)this.nodes[e[i]].insert(this.objects[o])}this.objects=[]}},t.prototype.retrieve=function(t){var e=this.getIndex(t),o=this.objects;if(this.nodes.length)for(var i=0;i<e.length;i++)o=o.concat(this.nodes[e[i]].retrieve(t));return o=o.filter(function(t,e){return o.indexOf(t)>=e})},t.prototype.retrieveTree=function(t){var e=this.getIndex(t),o=this.objects;if(this.nodes.length)for(var i=0;i<e.length;i++)o=o.concat(this.nodes[e[i]].retrieve(t));return o.filter(function(e){return e.x>=t.x&&e.y>=t.y&&e.x+e.width<=t.x+t.width&&e.y+e.height<=t.y+t.height})},t.prototype.clear=function(){this.objects=[];for(var t=0;t<this.nodes.length;t++)this.nodes.length&&this.nodes[t].clear();this.nodes=[]},t.prototype.remove=function(t){var e=this.objects.indexOf(t);if(-1!==e)return this.objects.splice(e,1),!0;if(this.nodes.length>0){for(var o=!1,i=this.getIndex(t),n=0;n<i.length;n++)o=this.nodes[i[n]].remove(t)||o;return o}return!1},t}();n.Quadtree=a,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_APP:[function(t,e,o){"use strict";cc._RF.push(e,"1ae15i16mlNRZGJyt4iOoP1","RCPDD_APP");var i=t,n=e,a=o;cc._RF.push(n,"1ae15i16mlNRZGJyt4iOoP1","RCPDD_APP"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("DMD_DataMgr"),p=i("RCPDD_Config"),u=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e,r.AudioMgr.getInstance().pauseAllMusic();var n=function(){i._isInited=!0,s.UIMgr.getInstance().openUIOfCallback(p.RCPDD_UIID.RCPDD_UIGame,c.UIID.UINONE,function(){s.UIMgr.getInstance().closeById(c.UIID.UISubEnter),t&&t(),i.removeTouchEvent()})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(p.RCPDD_UICF),r.AudioMgr.getInstance().addAdConf(p.RCPDD_Audio),l.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),s.UIMgr.getInstance().closeById(p.RCPDD_UIID.RCPDD_UIGame),s.UIMgr.getInstance().closeById(p.RCPDD_UIID.RCPDD_UIGameOver),s.UIMgr.getInstance().closeById(p.RCPDD_UIID.RCPDD_UISetting),this._exitCall&&this._exitCall(),this._exitCall=null},t.prototype.removeTouchEvent=function(){},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_Config:[function(t,e,o){"use strict";cc._RF.push(e,"cf41fAZs7BA1b97cnPs/4Wu","RCPDD_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"cf41fAZs7BA1b97cnPs/4Wu","RCPDD_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.RoleAsePath=l.EObjectType=l.RCPDD_GameState=l.RCPDD_Type=l.RCPDD_AnimName=l.RCPDD_EventName=l.RCPDD_Audio=l.RCPDD_BundleName=l.RCPDD_AudioId=l.RCPDD_UICF=l.RCPDD_UIID=void 0,function(t){t.RCPDD_UIGame="RCPDD_UIGame",t.RCPDD_UISelectBuff="RCPDD_UISelectBuff",t.RCPDD_UIDoor="RCPDD_UIDoor",t.RCPDD_UIGameOver="RCPDD_UIGameOver",t.RCPDD_UISelectSolderRole="RCPDD_UISelectSolderRole",t.RCPDD_UIToolTips="RCPDD_UIToolTips",t.RCPDD_UISetting="RCPDD_UISetting"}(a=l.RCPDD_UIID||(l.RCPDD_UIID={})),l.RCPDD_UICF=((i={})[a.RCPDD_UIGame]={prefab:"ui/RCPDD_UIGame",name:"RCPDD_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:"RCPDD_Prefabs"},i[a.RCPDD_UISelectBuff]={prefab:"ui/RCPDD_UISelectBuff",name:"RCPDD_UISelectBuff",showTop:!0,showMult:!1,zIndex:1100,bundleName:"RCPDD_Prefabs"},i[a.RCPDD_UIDoor]={prefab:"ui/RCPDD_UIDoor",name:"RCPDD_UIDoor",showTop:!0,showMult:!1,zIndex:1100,bundleName:"RCPDD_Prefabs"},i[a.RCPDD_UIGameOver]={prefab:"ui/RCPDD_UIGameOver",name:"RCPDD_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:"RCPDD_Prefabs"},i[a.RCPDD_UISelectSolderRole]={prefab:"ui/RCPDD_UISelectSolderRole",name:"RCPDD_UISelectSolderRole",showTop:!0,showMult:!1,zIndex:1100,bundleName:"RCPDD_Prefabs"},i[a.RCPDD_UIToolTips]={prefab:"ui/RCPDD_UIToolTips",name:"RCPDD_UIToolTips",showTop:!0,showMult:!1,zIndex:1100,bundleName:"RCPDD_Prefabs"},i[a.RCPDD_UISetting]={prefab:"ui/RCPDD_UISetting",name:"RCPDD_UISetting",showTop:!0,showMult:!1,zIndex:1100,bundleName:"RCPDD_Prefabs"},i),function(t){t.die="die",t.prop="prop",t.boss="BOSSlaixi",t.bossyuyin="bossyuyin",t.coll="coll",t.shield="shield",t.upToolLv="upToolLv",t.shouji="shouji"}(r=l.RCPDD_AudioId||(l.RCPDD_AudioId={})),function(t){t.Prefabs="RCPDD_Prefabs",t.Sprite="RCPDD_Sprite",t.Audio="RCPDD_Audio",t.SpAnim="RCPDD_SpAnim"}(s=l.RCPDD_BundleName||(l.RCPDD_BundleName={})),l.RCPDD_Audio=((n={})[r.die]={path:"die",bundle:s.Audio},n[r.prop]={path:"prop",bundle:s.Audio},n[r.coll]={path:"coll",bundle:s.Audio},n[r.shield]={path:"shield",bundle:s.Audio},n[r.upToolLv]={path:"upToolLv",bundle:s.Audio},n[r.boss]={path:"BOSSlaixi",bundle:s.Audio},n[r.bossyuyin]={path:"bossyuyin",bundle:s.Audio},n[r.shouji]={path:"shouji",bundle:s.Audio},n),function(t){t.TouchStart="TouchStart",t.TouchMove="TouchMove",t.TouchEnd="TouchEnd",t.GM_AddTool="GM_AddTool",t.GM_Up="GM_Up",t.CameraMove="CameraMove",t.CameraPos="CameraPos",t.PlayerGetExp="PlayerGetExp",t.UpToolLevel="UpToolLevel",t.RefreshData="RefreshData",t.KillEnemy="KillEnemy",t.ChalBOSS="ChalBOSS",t.ShakeCamera="ShakeCamera",t.ObtainBuff="ObtainBuff",t.SetGameState="SetGameState",t.PlaySkills="PlaySkills",t.ActivateSkills="ActivateSkills",t.PickupSolderRole="PickupSolderRole",t.CloseDoor="CloseDoor"}(l.RCPDD_EventName||(l.RCPDD_EventName={})),function(t){t.idle="idle",t.move="move",t.die="die"}(l.RCPDD_AnimName||(l.RCPDD_AnimName={})),function(t){t[t.Player=0]="Player",t[t.Enemy=1]="Enemy"}(l.RCPDD_Type||(l.RCPDD_Type={})),function(t){t[t.Pause=0]="Pause",t[t.Fight=1]="Fight"}(l.RCPDD_GameState||(l.RCPDD_GameState={})),function(t){t[t.None=0]="None",t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Prop=4]="Prop",t[t.Minion=8]="Minion",t[t.Door=16]="Door",t[t.Skill=32]="Skill",t[t.SolderRole=64]="SolderRole"}(l.EObjectType||(l.EObjectType={})),l.RoleAsePath={1:{path:"soilder_1/soilder_1",ID:11},2:{path:"soilder_2/soilder_2",ID:12},3:{path:"soilder_3/soilder_3",ID:1},4:{path:"soilder_4/soilder_4",ID:7},5:{path:"djdh_2/djdh_2",ID:2},6:{path:"djdh_4/djdh_4",ID:4},7:{path:"djdh_5/djdh_5",ID:5},8:{path:"djdh_9/djdh_9",ID:9},9:{path:"djdh_13/djdh_13",ID:13},10:{path:"djdh_15/djdh_15",ID:15},11:{path:"djdh_6/djdh_6",ID:6},12:{path:"djdh_8/djdh_8",ID:8},13:{path:"djdh_10/djdh_10",ID:10},14:{path:"djdh_14/djdh_14",ID:14},15:{path:"djdh_16/djdh_16",ID:16},16:{path:"djdh_17/djdh_17",ID:17},17:{path:"djdh_18/djdh_18",ID:18},18:{path:"djdh_3/djdh_3",ID:3}},cc._RF.pop(),cc._RF.pop()},{}],RCPDD_DieEff:[function(t,e,o){"use strict";cc._RF.push(e,"e2ec9RV5H1OQb0JL/m3gcG5","RCPDD_DieEff");var i=t,n=e,a=o;cc._RF.push(n,"e2ec9RV5H1OQb0JL/m3gcG5","RCPDD_DieEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim=this.node.getComponent(sp.Skeleton),this.spAnim.setAnimation(0,"animation",!1),this.spAnim.setCompleteListener(function(e){"animation"==e.animation.name&&t.node.destroy()})},c([u],e)}(l.default));a.default=d,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_Door:[function(t,e,o){"use strict";cc._RF.push(e,"21a4bmttaZHyK7Kj2R2youh","RCPDD_Door");var i=t,n=e,a=o;cc._RF.push(n,"21a4bmttaZHyK7Kj2R2youh","RCPDD_Door");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RCPDD_Config"),u=i("RCPDD_QuadtreeItem"),d=i("RCPDD_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.quadtreeItem=null,e}return s(e,t),e.prototype.start=function(){this.quadtreeItem=this.getComponent(u.default),this.quadtreeItem.collisionMask=p.EObjectType.Player,d.default.Instance.addItem(this.quadtreeItem),this.addEvent(p.RCPDD_EventName.ChalBOSS,this.onDie)},e.prototype.removeThis=function(){d.default.Instance.removeItem(this.quadtreeItem)},e.prototype.onDisable=function(){this.removeThis()},e.prototype.onDie=function(){this.removeThis(),this.node.destroy()},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_EnemyNode:[function(t,e,o){"use strict";cc._RF.push(e,"39926ni0clMcIze/dR/62VB","RCPDD_EnemyNode");var i=t,n=e,a=o;cc._RF.push(n,"39926ni0clMcIze/dR/62VB","RCPDD_EnemyNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("RCPDD_Config"),u=i("RCPDD_EvolutionDataMgr"),d=i("RCPDD_GameManager"),h=i("RCPDD_RoleBase"),f=i("RCPDD_QuadtreeManager"),m=i("RCPDD_QuadtreeItem"),g=i("UIMgr");!function(t){t[t.Wandering=0]="Wandering",t[t.Chasing=1]="Chasing",t[t.Fleeing=2]="Fleeing"}(l||(l={}));var y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ying=null,e.type=p.RCPDD_Type.Enemy,e.downExp=0,e.aiState=l.Wandering,e.searchTimer=0,e.searchInterval=0,e.searchRadius=400,e.searchMaxInterval=10,e.searchMaxTimer=0,e.minDistance=80,e.attackTarget=null,e.wanderTargetPosition=null,e.wanderTimer=0,e.wanderInterval=0,e.isBoss=!1,e.isEscape=!1,e.spineAnimID=0,e.playerFriendTime=10,e.graphics=null,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.ying=cc.find("ying",this.node),this.quadtreeItem=this.getComponent(m.default),this.quadtreeItem.collisionMask=p.EObjectType.Player|p.EObjectType.Enemy|p.EObjectType.Prop|p.EObjectType.Minion,d.default.Instance.addItem(this.quadtreeItem),this.isBoss||(this.addEvent(p.RCPDD_EventName.RefreshData,this.refreshData),this.addEvent(p.RCPDD_EventName.ChalBOSS,this.chalBOSS))},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.init=function(t,e,o,i){var n=this;void 0===i&&(i=p.RCPDD_Type.Enemy),this.spineAnimID=o,this.loadResFromBundle(p.RCPDD_BundleName.SpAnim,p.RoleAsePath[o].path,sp.SkeletonData,function(t){n.spineAnim.skeletonData=t,n.spineAnimID<=4?n.spineAnim.setAnimation(0,p.RCPDD_AnimName.move,!0):n.spineAnim.setAnimation(0,p.RCPDD_AnimName.idle,!0)}),this.ying.active=o>4,i==p.RCPDD_Type.Player?(this.type=i,this.playerFriendTime=10,this.node.name="PlayerFriend",this.isDie=!0,setTimeout(function(){n.isDie=!1,n.addTool(t,e),n.toolLevel=e,n.refreshWandering(),n.searchInterval=n.random(3,5),n.moveSpeed=n.random(120,220),n.initData()},500)):this.isBoss?(this.refreshWandering(),this.searchRadius=500,this.searchInterval=this.random(3,5),this.moveSpeed=210,this.radius=120,this.maxHp=350,this.nowHp=this.maxHp,this.toolLevel=8,this.atkForce=u.default.getInstance().getAtk(this.toolLevel).Attack,this.toolFew=300,this.addTool(this.toolFew,this.toolLevel)):(this.addTool(t,e),this.toolLevel=e,this.refreshWandering(),this.searchInterval=this.random(3,5),this.moveSpeed=this.random(120,220),this.initData())},e.prototype.initData=function(){this.atkForce=u.default.getInstance().getAtk(this.toolLevel).Attack,this.maxHp=u.default.getInstance().getRoleInfo().HeroHp,this.nowHp=this.maxHp,this.downExp=u.default.getInstance().getRoleInfo().HeroEx},e.prototype.refreshData=function(){var t=this.nowHp/this.maxHp;this.downExp=u.default.getInstance().getRoleInfo().HeroEx,this.maxHp=u.default.getInstance().getRoleInfo().HeroHp,this.nowHp=d.default.Instance.round(this.maxHp*t)},e.prototype.gm_AddTool=function(){this.addTool(10)},e.prototype.onAtkEd=function(e,o,i){var n=this;if(void 0===i&&(i=null),d.default.Instance.isGM_On&&d.default.Instance.gameState!=p.RCPDD_GameState.Pause&&!this.isDie){if(!this.invAtkEd&&!this.isEscape&&this.random(0,1)>.4){this.isEscape=!0,setInterval(function(){n.isEscape=!1},3e3);var a=this.node.getPosition().sub(e.getPosition()).normalize(),r=cc.misc.degreesToRadians(this.random(-100,100)),s=cc.v2(a).rotate(r),c=this.node.getPosition().add(s.mul(200));this.refreshWandering(c)}t.prototype.onAtkEd.call(this,e,o,i),this.isDie&&(d.default.Instance.roleAllFew--,this.isBoss&&g.UIMgr.getInstance().openUI(p.RCPDD_UIID.RCPDD_UIGameOver,1,!0)),(i&&i.type==p.RCPDD_Type.Player&&this.isDie||!i&&this.isDie)&&(this.sendEvent(p.RCPDD_EventName.PlayerGetExp,this.downExp),d.default.Instance.killEnemy())}},e.prototype.chalBOSS=function(){this.type==p.RCPDD_Type.Enemy&&(this.aiState=l.Wandering,this.wanderInterval=20,this.wanderTimer=0,this.searchTimer=0,this.searchInterval=30,this.wanderTargetPosition=d.default.Instance.getRandomOuterPos(d.default.Instance.enemyMinX,d.default.Instance.enemyMaxX,d.default.Instance.enemyMinY,d.default.Instance.enemyMaxY))},e.prototype.setAnimState=function(t){switch(t){case p.RCPDD_GameState.Fight:this.spineAnimID<=4?this.spineAnim.setAnimation(0,p.RCPDD_AnimName.move,!0):this.spineAnim.setAnimation(0,p.RCPDD_AnimName.idle,!0);break;case p.RCPDD_GameState.Pause:this.spineAnim.setAnimation(0,p.RCPDD_AnimName.idle,!0)}},e.prototype.update=function(e){this.isDie||(t.prototype.update.call(this,e),d.default.Instance.gameState!=p.RCPDD_GameState.Pause&&this.updateAI(e))},e.prototype.updateAI=function(t){var e=this;if(d.default.Instance.isGM_AI)switch(this.type==p.RCPDD_Type.Player&&(this.playerFriendTime-=t,this.playerFriendTime<0&&(this.isDie=!0,d.default.Instance.removeItem(this.quadtreeItem),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.3,{scale:0}).call(function(){e.node.destroy()}).start())),this.aiState!=l.Chasing&&(this.searchTimer+=t),this.aiState){case l.Wandering:this.updateWandering(t);break;case l.Chasing:this.updateChasing(t)}},e.prototype.refreshWandering=function(t){void 0===t&&(t=null),this.aiState=l.Wandering,this.wanderTimer=0,this.wanderInterval=this.random(3,6),this.wanderTargetPosition=t||d.default.Instance.getAIWanderPos()},e.prototype.updateWandering=function(t){if(this.wanderTimer+=t,this.wanderTimer>=this.wanderInterval)this.refreshWandering();else{var e=this.wanderTargetPosition?this.wanderTargetPosition.sub(this.node.getPosition()).magSqr():1/0;(this.wanderTimer>=this.wanderInterval||e<100)&&(!this.isBoss&&d.default.Instance.isBossState?(this.isDie=!0,d.default.Instance.removeItem(this.quadtreeItem),this.node.destroy()):this.refreshWandering())}var o=this.wanderTargetPosition.sub(this.node.getPosition()).normalizeSelf(),i=o.mul(this.moveSpeed*t),n=new cc.Vec3(i.x,i.y,0),a=this.node.position.add(n).add(this.knockbackOffset);(a.x>this.mapWidth||a.x<-this.mapWidth)&&(a.x=this.node.position.x),(a.y>this.mapHeight||a.y<-this.mapHeight)&&(a.y=this.node.position.y),this.node.setPosition(a),o.x>.01?1!=this.roleParent.scaleX&&(this.roleParent.scaleX=1):o.x<-.01&&-1!=this.roleParent.scaleX&&(this.roleParent.scaleX=-1)},e.prototype.updateChasing=function(t){if(!this.attackTarget||this.attackTarget.isDie)return this.attackTarget=null,this.refreshWandering(),this.moveSpeed=this.random(140,220),void(this.graphics&&this.graphics.clear());if(this.searchMaxTimer+=t,this.searchMaxTimer>=this.searchMaxInterval)return this.searchMaxTimer=0,this.refreshWandering(),this.moveSpeed=this.random(140,220),void(this.graphics&&this.graphics.clear());this.drawDebug();var e=this.attackTarget.node.getPosition(),o=this.node.getPosition(),i=new cc.Vec3(o.x,o.y,void 0!==o.z?o.z:0),n=this.minDistance*this.minDistance,a=e.x-i.x,r=e.y-i.y,s=a*a+r*r;if(s>n){var c=Math.sqrt(s),l=c>0?new cc.Vec3(a/c,r/c,0):cc.Vec3.ZERO,p=l.mul(this.moveSpeed*t),u=i.add(p).add(this.knockbackOffset);(u.x>this.mapWidth||u.x<-this.mapWidth)&&(u.x=i.x),(u.y>this.mapHeight||u.y<-this.mapHeight)&&(u.y=i.y),this.node.setPosition(u),l.x>.01?1!=this.roleParent.scaleX&&(this.roleParent.scaleX=1):l.x<-.01&&-1!=this.roleParent.scaleX&&(this.roleParent.scaleX=-1)}},e.prototype.isSearchFor=function(){this.searchTimer>=this.searchInterval&&(this.searchTimer=0,this.searchInterval=this.random(3,5),this.searchForTargets())},e.prototype.searchForTargets=function(){var t=this.node.parent.convertToWorldSpaceAR(this.node.getPosition()),e=new cc.Rect(t.x-this.searchRadius,t.y-this.searchRadius,2*this.searchRadius,2*this.searchRadius);this.debugSearchFor();for(var o=null,i=0,n=f.RCPDD_QuadtreeManager.getInstance().retrieveInRect(e);i<n.length;i++){var a=n[i];if(a.node!==this.node&&(a.type===p.EObjectType.Player||a.type===p.EObjectType.Enemy)){var r=a.owner;if(r.isDie)continue;if(this.isBoss){if(r.type===p.RCPDD_Type.Player){o=r;break}}else if(this.type===p.RCPDD_Type.Player){if(a.type===p.EObjectType.Enemy&&(this.toolLevel>r.toolLevel||this.toolFew>r.toolFew)){if(this.isBoss)break;o=r;break}}else if(this.toolLevel>r.toolLevel||this.toolFew>r.toolFew){if(this.isBoss)break;o=r;break}}}this.attackTarget=o,this.attackTarget&&(this.aiState=l.Chasing,this.searchTimer=0,this.isBoss||(this.moveSpeed=this.random(160,220)))},e.prototype.random=function(t,e){return Math.random()*(e-t)+t},e.prototype.drawDebug=function(){if(d.default.Instance.isDebug){this.graphics||(this.graphics=this.node.getComponent(cc.Graphics),this.graphics||(this.graphics=this.node.addComponent(cc.Graphics))),this.graphics.clear();var t=cc.v2(0,0),e=this.attackTarget.node.convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.convertToNodeSpaceAR(e);this.graphics.moveTo(t.x,t.y),this.graphics.lineTo(o.x,o.y),this.graphics.strokeColor=cc.Color.ORANGE,this.graphics.lineWidth=4,this.graphics.stroke()}},e.prototype.debugSearchFor=function(){var t=this;d.default.Instance.isDebug&&(this.graphics||(this.graphics=this.node.getComponent(cc.Graphics),this.graphics||(this.graphics=this.node.addComponent(cc.Graphics))),this.graphics.clear(),this.graphics.strokeColor=cc.Color.BLUE,this.graphics.lineWidth=4,this.graphics.rect(-this.searchRadius,-this.searchRadius,2*this.searchRadius,2*this.searchRadius),this.graphics.stroke(),setTimeout(function(){t.graphics.clear()},2500))},c([_(cc.Boolean)],e.prototype,"isBoss",void 0),c([v],e)}(h.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_EvolutionDataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"c7da3jqkIlLhZqT0nZHr4Qi","RCPDD_EvolutionDataMgr");var i=t,n=e,a=o;cc._RF.push(n,"c7da3jqkIlLhZqT0nZHr4Qi","RCPDD_EvolutionDataMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("ResourceMgr"),p=i("RCPDD_GameManager"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return s(e,t),o=e,e.getInstance=function(){return this.instance||(this.instance=new o),this.instance},e.prototype.getData=function(){return this.data},e.prototype.loadCfg=function(t){var e=this;l.ResourceMgr.getInstance().loadRes("RCPDD_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},e.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},e.prototype.getExp=function(t){return this.getCfgByPrimaryKey(this.data.DropCfg,t,"ID")},e.prototype.getAtk=function(t){return t>8&&(t=8),t+=9e3,this.getCfgByPrimaryKey(this.data.WeaponCfg,t,"id")},e.prototype.getRoleInfo=function(){var t=3;return p.default.Instance.killRole>3&&(t=this.getFloorValue(p.default.Instance.killRole)),this.getCfgByPrimaryKey(this.data.HealthyCfg,t,"level")},e.prototype.getFloorValue=function(t){var e=[3,6,9,12,15,18,21,24,27,30,33,36,39,42].filter(function(e){return e<=t});if(0!==e.length)return Math.max.apply(Math,e)},e.prototype.getParameterCfg=function(t){return this.data&&this.data.GearParameterCfg&&this.data.GearParameterCfg[t]||null},e.prototype.getBuffCtr=function(){return this.data.buffCfg||null},e.prototype.getWeaponCfg=function(){return this.data.WeaponCfg||null},e.prototype.getSkill=function(t){return this.getCfgByPrimaryKey(this.data.Sheet1,t,"mateID")},e.prototype.getSkillCfgs=function(){return this.data.Sheet1||null},e.prototype.getSolderRole=function(t){return this.getCfgByPrimaryKey(this.data.characterCfg,t,"characterID")},o=c([d],e)}(cc.Component));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"eb417q7czlMT7A6/MXrytVB","RCPDD_GameData");var i=e,n=o;cc._RF.push(i,"eb417q7czlMT7A6/MXrytVB","RCPDD_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emRCPDD_GameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.DropCfg="DropCfg",t.GearParameterCfg="GearParameterCfg",t.WeaponCfg="WeaponCfg",t.Sheet1="Sheet1",t.HealthyCfg="HealthyCfg",t.characterCfg="characterCfg"}(n.emRCPDD_GameDataKeys||(n.emRCPDD_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],RCPDD_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"10cb8Tzy+FAb6rJPTaGugF3","RCPDD_GameEnumData");var i=e,n=o;cc._RF.push(i,"10cb8Tzy+FAb6rJPTaGugF3","RCPDD_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumGearParameterCfg=void 0,function(t){t[t.WeaponNum=1]="WeaponNum",t[t.BOSSHp=2]="BOSSHp",t[t.BOSSWeaponNum=3]="BOSSWeaponNum",t[t.BOSSWeaponlevel=4]="BOSSWeaponlevel",t[t.EnemyEffective=5]="EnemyEffective",t[t.PlayerHp=6]="PlayerHp",t[t.UpadteNum=7]="UpadteNum",t[t.DropPro=8]="DropPro",t[t.EnemySwordPro=9]="EnemySwordPro",t[t.EnemySmall=10]="EnemySmall",t[t.EnemySmallNum=11]="EnemySmallNum",t[t.EnemyHero=12]="EnemyHero",t[t.EnemyHeroTime=13]="EnemyHeroTime",t[t.EnemyMiniAtk=14]="EnemyMiniAtk",t[t.SwordNum=15]="SwordNum",t[t.SwordNumPro=16]="SwordNumPro",t[t.eachSwordNum=17]="eachSwordNum",t[t.eachSwordLevel=18]="eachSwordLevel",t[t.SwordPro=19]="SwordPro",t[t.EnemyMiniPro=20]="EnemyMiniPro",t[t.SwordDrop=21]="SwordDrop",t[t.SwordDropTime=22]="SwordDropTime",t[t.ReturnSwordNum=23]="ReturnSwordNum",t[t.SwordProTime=24]="SwordProTime",t[t.TopSwordNum=25]="TopSwordNum"}(n.enumGearParameterCfg||(n.enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],RCPDD_GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"03cbaEdNtlLyasV2bZGmvXf","RCPDD_GameManager");var i=t,n=e,a=o;cc._RF.push(n,"03cbaEdNtlLyasV2bZGmvXf","RCPDD_GameManager");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RCPDD_Config"),p=i("RCPDD_Tool"),u=i("RCPDD_QuadtreeManager"),d=i("RCPDD_PropTool"),h=i("RCPDD_MinMonster"),f=i("RCPDD_EnemyNode"),m=i("RCPDD_EvolutionDataMgr"),g=i("RCPDD_GameEnumData"),y=i("RCPDD_PlayerNode"),v=i("RCPDD_SolderRole"),_=i("BaseCtrl"),b=i("AudioMgr"),B=i("UIMgr"),I=cc._decorator,P=I.ccclass,C=(I.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameMapCamera=null,e.mapBgBase=null,e.doorNodeBase=null,e.roleNodeBase=null,e.playerBase=null,e.propNodeBase=null,e.flyToolNode=null,e.skillNodeBase=null,e.presentMapBG=null,e.config=[3,6,9,12,15,18,21,24,27,30,33,36,39,42],e.killRole=0,e.isGM_On=!0,e.isGM_AI=!0,e.isDebug=!1,e.gameState=null,e.mapWidth=3750,e.mapHeight=3999,e.roleMapWidth=1750,e.roleMapHeight=1850,e.enemyMinX=550,e.enemyMaxX=600,e.enemyMinY=760,e.enemyMaxY=810,e.propMinX=150,e.propMaxX=500,e.propMinY=200,e.propMaxY=650,e.playerCrt=null,e.playerInitToolFews=[],e.playerSpAnimId=0,e.roleMaxFew=0,e.roleAllFew=0,e.roleInterval=10,e.roleTimer=0,e.minionFew=[],e.minionFewWeight=[],e.minionInterval=10,e.minionTimer=0,e.propUpFew=3,e.proWinEnemy=0,e.propLevel=1,e.propFews=[2,6],e.propToolFew=[],e.propToolFewWeight=[],e.propInterval=8,e.propTimer=0,e.propLevelWeight=0,e.propLevelinterval=0,e.propLevelIS=!0,e.propLevelWeightCfg=[],e.propLevelSumWeight=0,e.minEnemyToolFew=0,e.maxEnemyToolFew=0,e.enemyToolLevels=[],e.topSwordNum=[],e.toolAngleRange=10,e.isBossState=!1,e.buffDatas=[],e.buffSelectionCount={},e.currentBuffQuality=1,e.maxBuffQuality=4,e.buffsPerRefresh=3,e.roleAsePathlength=0,e.mapBgID=1,e.mapEnemyFew=10,e.mapEnemyResidueFew=0,e.doorKillRole=0,e.showDoorTips=!1,e.insDoorFew=0,e.insSolderRoleFew=0,e.solderRoleNode=null,e.doorNode=null,e.solder_Arrow=null,e.door_Arrow=null,e.solder_Txt=null,e.door_Txt=null,e.allItems=[],e.previousCollisions=null,e.audiointerval=!1,e.debugGraphics=null,e.debugNode=null,e.showDebugSector=!0,e.sectorRadius=160,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this),this.gameMapCamera=cc.find("GameMapCamera",this.node),this.doorNodeBase=cc.find("doorBase",this.node),this.roleNodeBase=cc.find("roleBase",this.node),this.playerBase=cc.find("playerBase",this.node),this.propNodeBase=cc.find("propBase",this.node),this.flyToolNode=cc.find("flyToolNode",this.node),this.skillNodeBase=cc.find("skillBase",this.node),this.mapBgBase=cc.find("mapBgBase",this.node),this.presentMapBG=cc.find("mapBgBase/mapBG1",this.node),this.solder_Arrow=cc.find("GameMapCamera/solder_Arrow",this.node),this.door_Arrow=cc.find("GameMapCamera/door_Arrow",this.node),this.solder_Txt=cc.find("GameMapCamera/solder_text",this.node).getComponent(cc.RichText),this.door_Txt=cc.find("GameMapCamera/door_text",this.node).getComponent(cc.RichText),this.gameState=l.RCPDD_GameState.Pause,this.solder_Arrow.active=!1,this.door_Arrow.active=!1,this.solder_Txt.node.active=!1,this.door_Txt.node.active=!1,this.currentBuffQuality=1,this.roleAsePathlength=Object.keys(l.RoleAsePath).length,this.mapEnemyResidueFew=this.mapEnemyFew,this.setDebugSectorVisible(this.isDebug),this.initDebugGraphics()},e.prototype.start=function(){this.previousCollisions=new Set,u.RCPDD_QuadtreeManager.getInstance().init(this.mapWidth+300,this.mapHeight+300)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),o.Instance=null},e.prototype.initWin=function(){var t=this;this.roleMaxFew=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemyHero).value,this.roleInterval=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemyHeroTime).value,this.minionFew=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemySmallNum).value,this.minionFewWeight=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemyMiniPro).value,this.minionInterval=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemySmall).value,this.minEnemyToolFew=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemyEffective).value[0],this.maxEnemyToolFew=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemyEffective).value[1],this.enemyToolLevels=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.EnemySwordPro).value,this.playerInitToolFews=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.WeaponNum).value,this.propUpFew=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.UpadteNum).value,this.buffDatas=m.default.getInstance().getBuffCtr(),this.propToolFew=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.SwordNum).value,this.propToolFewWeight=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.SwordNumPro).value,this.propLevelWeight=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.SwordPro).value,this.propLevelWeightCfg=m.default.getInstance().getWeaponCfg(),this.propLevelinterval=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.SwordProTime).value,this.propInterval=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.SwordDropTime).value,this.propFews=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.SwordDrop).value,this.topSwordNum=m.default.getInstance().getParameterCfg(g.enumGearParameterCfg.TopSwordNum).value;for(var e=0,o=this.propLevelWeightCfg;e<o.length;e++){var i=o[e];this.propLevelSumWeight+=i.value}var n=this.playerInitToolFews[this.random(0,this.playerInitToolFews.length,!0)];this.loadPrefab(l.RCPDD_BundleName.Prefabs,"player/playerNode",function(e){var o=cc.instantiate(e);o.setParent(t.playerBase),o.setPosition(0,0),t.playerCrt=o.getComponent(y.default),t.playerSpAnimId=t.getSpAnimId(1,4),t.playerCrt.init(n,t.playerSpAnimId);for(var i=0;i<2;i++)t.createEnemy();t.gameState=l.RCPDD_GameState.Fight,t.createSolderRole(),t.createProp()})},e.prototype.getToolOnCill=function(){return this.topSwordNum[this.mapBgID-1]},e.prototype.killEnemy=function(){var t,e=this;this.killRole>43||(this.killRole++,this.proWinEnemy++,this.doorKillRole++,this.doorKillRole>=10&&this.mapBgID<4&&!this.showDoorTips&&(this.showDoorTips=!0,B.UIMgr.getInstance().openUI(l.RCPDD_UIID.RCPDD_UIToolTips,1,{isSkill:!1,skillID:0,txtTips:"\u901a\u5f80\u53e6\u4e00\u7247\u5927\u9646\u7684\u4f20\u9001\u95e8\u5df2\u5f00\u542f"}),this.insDoor()),this.mapEnemyResidueFew--,this.proWinEnemy>=this.propUpFew&&(this.proWinEnemy=0,this.propLevel++,this.propLevel>8&&(this.propLevel=8)),this.config.includes(this.killRole)&&this.sendEvent(l.RCPDD_EventName.RefreshData),t=4==this.mapBgID?43==this.killRole?"<b><outline color=black width=4>\u51fb\u8d25BOSS</outline></b>":"<b><outline color=black width=4>\u8fd8\u9700\u51fb\u6740<color=#70d8ff>"+this.mapEnemyResidueFew+"</color>\u4e2a</outline></color></b>":this.mapEnemyResidueFew>0?"<b><outline color=black width=4>\u8ddd<color=#70d8ff>\u4f20\u9001\u95e8</color>\u5f00\u542f\u8fd8\u9700\u51fb\u6740<color=#70d8ff>"+this.mapEnemyResidueFew+"</color>\u4e2a</outline></color></b>":"<b><outline color=black width=4>\u8bf7\u524d\u5f80\u4e0b\u4e00\u7247\u5927\u9646</outline></b>",this.sendEvent(l.RCPDD_EventName.KillEnemy,t),43==this.killRole&&(this.isBossState=!0,this.doorNodeBase.active=!1,this.sendEvent(l.RCPDD_EventName.ChalBOSS),b.AudioMgr.getInstance().playEffectFree(l.RCPDD_AudioId.boss),setTimeout(function(){e.loadPrefab(l.RCPDD_BundleName.Prefabs,"enemy/bossNode",function(t){var o=cc.instantiate(t);o.setParent(e.roleNodeBase),o.setPosition(e.getRandomOuterPos(e.enemyMinX,e.enemyMaxX,e.enemyMinY,e.enemyMaxY)),o.getComponent(f.default).init(0,0,e.getSpAnimId(1,9)),b.AudioMgr.getInstance().playEffectFree(l.RCPDD_AudioId.bossyuyin)})},2400)))},e.prototype.playSkills=function(t){var e=this,o="skill/skill_"+t;this.loadPrefab(l.RCPDD_BundleName.Prefabs,o,function(t){if(e.playerCrt){var o=cc.instantiate(t);o.setParent(e.skillNodeBase),o.setPosition(e.playerCrt.node.position.clone())}})},e.prototype.playSkillFriend=function(){var t=this;this.loadPrefab(l.RCPDD_BundleName.Prefabs,"eff/playerFriendEff",function(e){var o=cc.instantiate(e);o.setParent(t.roleNodeBase);var i=t.playerCrt.node.position.clone();i.y-=300,o.setPosition(i),o.setScale(0),cc.tween(o).to(.1,{scale:.7}).start(),t.loadPrefab(l.RCPDD_BundleName.Prefabs,"enemy/enemyNode",function(e){var n=cc.instantiate(e);n.setParent(t.roleNodeBase),n.setPosition(i),n.setScale(0);var a=t.round(1.5*t.playerCrt.toolFew),r=t.playerCrt.toolLevel+1;r>8&&(r=8),n.getComponent(f.default).init(a,r,t.getSpAnimId(1,9),l.RCPDD_Type.Player),cc.tween(n).to(.5,{scale:1}).call(function(){cc.tween(o).to(.25,{scale:0}).call(function(){o.destroy()}).start()}).start()})})},e.prototype.getSpAnimId=function(t,e){var o;void 0===t&&(t=1),void 0===e&&(e=this.roleAsePathlength);do{o=this.random(t,e+1,!0)}while(o==this.playerSpAnimId);return o},e.prototype.createSolderRole=function(){var t=this;this.insSolderRoleFew>=4||(this.insSolderRoleFew++,this.loadPrefab(l.RCPDD_BundleName.Prefabs,"prop/solderRole",function(e){t.solderRoleNode=cc.instantiate(e),t.solderRoleNode.setParent(t.roleNodeBase),t.solderRoleNode.setPosition(t.getRandomOuterPos(t.roleMapWidth-300,t.roleMapWidth-100,t.roleMapHeight-300,t.roleMapHeight-100)),t.solderRoleNode.getComponent(v.default).init(t.getSolderSpAnimIds()),t.solder_Arrow.active=!0,t.solder_Txt.node.active=!0}))},e.prototype.getSolderSpAnimId=function(){var t;do{t=this.random(1,this.roleAsePathlength+1,!0)}while(this.playerCrt.solderAsePaths.includes(t));return t},e.prototype.getSolderSpAnimIds=function(){for(var t,e=this.roleAsePathlength,o=new Set(this.playerCrt.solderAsePaths),i=[],n=1;n<=e;n++)o.has(n)||9==n||8==n||5==n||i.push(n);for(n=i.length-1;n>0;n--){var a=Math.floor(Math.random()*(n+1));t=[i[a],i[n]],i[n]=t[0],i[a]=t[1]}return[i[0],i[1]]},e.prototype.createEnemy=function(){var t=this;this.roleAllFew++,this.loadPrefab(l.RCPDD_BundleName.Prefabs,"enemy/enemyNode",function(e){var o=cc.instantiate(e);o.setParent(t.roleNodeBase),o.setPosition(t.getRandomOuterPos(t.enemyMinX,t.enemyMaxX,t.enemyMinY,t.enemyMaxY));var i=t.random(t.minEnemyToolFew,t.maxEnemyToolFew),n=1,a=t.random(1,9,!0);n=t.playerCrt.toolFew*(1+.25*(t.playerCrt.toolLevel-1))*(1+.075*t.playerCrt.toolFew/10),n=t.round(n*i);var r=t.round(n/(.5+.25*(a-1)+.0065*n));r<1&&(r=1),a<1&&(a=1),a>8&&(a=8),o.getComponent(f.default).init(r,a,t.getSpAnimId(1,9))})},e.prototype.getRandomIndexByProbs=function(){for(var t=Math.random(),e=0,o=0;o<this.enemyToolLevels.length;o++)if(t<(e+=this.enemyToolLevels[o]))return o-1;return this.enemyToolLevels.length-1},e.prototype.createProp=function(){var t=this;this.playerCrt&&this.loadPrefab(l.RCPDD_BundleName.Prefabs,"prop/propTool",function(e){for(var o=t.random(t.propFews[0],t.propFews[1]+1,!0),i=0;i<o;i++){var n=cc.instantiate(e);n.setParent(t.propNodeBase),n.setPosition(t.getRandomOuterPos(t.propMinX,t.propMaxX,t.propMinY,t.propMaxY));var a=t.propToolFew[t.getRandomIndexPropFew()],r=t.playerCrt.toolLevel;t.propLevelIS&&Math.random()<t.propLevelWeight&&(t.propLevelIS=!1,setTimeout(function(){t.propLevelIS=!0},1e3*t.propLevelinterval),r=t.getRandomIndexPropLevel(),a=0),n.getComponent(d.default).init(a,r)}t.sortPropTier()})},e.prototype.getRandomIndexPropFew=function(){for(var t=Math.random(),e=0,o=0;o<this.propToolFewWeight.length;o++)if(t<(e+=this.propToolFewWeight[o]))return o;return 0},e.prototype.getRandomIndexPropLevel=function(){for(var t=this.random(0,this.propLevelSumWeight+1,!0),e=0,o=0;o<this.propLevelWeightCfg.length;o++)if(t<(e+=this.propLevelWeightCfg[o].value))return this.propLevelWeightCfg[o].id-9e3;return 1},e.prototype.sortPropTier=function(){var t=this.propNodeBase.children;t.sort(function(t,e){return e.y-t.y}),t.forEach(function(t,e){t.setSiblingIndex(e)})},e.prototype.fallProp=function(t,e,o){var i=this;this.playerCrt&&this.loadPrefab(l.RCPDD_BundleName.Prefabs,"prop/propTool",function(n){o=i.playerCrt.toolLevel;var a=cc.instantiate(n);a.setParent(i.propNodeBase),a.setPosition(t),a.getComponent(d.default).init(e,o)})},e.prototype.createMinion=function(){var t=this;this.loadPrefab(l.RCPDD_BundleName.Prefabs,"minMonster/minMonsterNode",function(e){var o=t.getRandomOuterPos(t.enemyMinX,t.enemyMaxX,t.enemyMinY,t.enemyMaxY),i=t.gameMapCamera.position,n=cc.v3(o.x,o.y,0),a=i.sub(n).normalize();t.random(0,1)>.5?t.createMinionLineFormation(e,o,a):t.createMinionTwoRowFormation(e,o,a)})},e.prototype.createMinionLineFormation=function(t,e,o){for(var i=this.minionFew[this.getRandomIndexMinionFew()],n=cc.v2(e.x,e.y),a=this.round(i/2),r=this.random(0,1)>.5,s=0;s<i;s++)r?s==a?n=cc.v2(e.x,e.y):s<a?(n.x-=50,n.y-=50):(n.x+=50,n.y+=50):s==a?n=cc.v2(e.x,e.y):s<a?(n.x+=50,n.y-=50):(n.x-=50,n.y+=50),this.insMinion(t,n,o)},e.prototype.createMinionTwoRowFormation=function(t,e,o){var i=this.random(0,1)>.5,n=this.minionFew[this.getRandomIndexMinionFew()],a=Math.ceil(n/2),r=n-a;if(i){for(var s=cc.v2(e.x,e.y),c=0;c<a;c++)s.x+=50,s.y-=50,this.insMinion(t,s,o);for(s=cc.v2(e.x+80,e.y+50),c=0;c<r;c++)s.x+=50,s.y-=50,this.insMinion(t,s,o)}else{for(c=0;c<a;c++){var l=c-Math.floor(a/2);s=cc.v2(e.x+90*l,e.y),this.insMinion(t,s,o)}for(c=0;c<r;c++)l=c-Math.floor(r/2),s=cc.v2(e.x+90*l,e.y-80),this.insMinion(t,s,o)}},e.prototype.getRandomIndexMinionFew=function(){for(var t=Math.random(),e=0,o=0;o<this.minionFewWeight.length;o++)if(t<(e+=this.minionFewWeight[o]))return o;return 0},e.prototype.insMinion=function(t,e,o){var i=cc.instantiate(t);i.setParent(this.roleNodeBase),i.setPosition(e),i.getComponent(h.default).init(o)},e.prototype.showDieEff=function(t){var e=this;this.loadPrefab(l.RCPDD_BundleName.Prefabs,"eff/dieEff",function(o){var i=cc.instantiate(o);i.setParent(e.roleNodeBase),i.setPosition(t)})},e.prototype.showToolCollEff=function(t){var e=this;this.loadPrefab(l.RCPDD_BundleName.Prefabs,"eff/toolCollEff",function(o){var i=cc.instantiate(o);i.setParent(e.roleNodeBase);var n=i.parent.convertToNodeSpaceAR(t);i.setPosition(n)})},e.prototype.insDoor=function(){var t=this;this.insDoorFew>=4||(this.insDoorFew++,this.loadPrefab(l.RCPDD_BundleName.Prefabs,"prop/door",function(e){t.doorNode=cc.instantiate(e),t.doorNode.setParent(t.doorNodeBase),t.doorNode.setPosition(cc.v3(0,1340)),t.door_Arrow.active=!0,t.door_Txt.node.active=!0}))},e.prototype.enterDoor=function(){var t=this;if(this.gameState=l.RCPDD_GameState.Fight,this.playerCrt){cc.Tween.stopAllByTarget(this.playerCrt.node);var e=cc.v3(0,0,0);this.playerCrt.node.setPosition(e),this.sendEvent(l.RCPDD_EventName.CameraPos,e);for(var o=0,i=this.allItems;o<i.length;o++){var n=i[o];n.type!=l.EObjectType.Player&&n.node.destroy()}this.presentMapBG.destroy(),this.presentMapBG=null,this.mapEnemyResidueFew=this.mapEnemyFew,this.mapBgID++;var a="";4==this.mapBgID?(this.mapEnemyResidueFew=13,a="<b><outline color=black width=4>\u8fd8\u9700\u51fb\u6740<color=#70d8ff>"+this.mapEnemyResidueFew+"</color>\u4e2a</outline></color></b>"):a="<b><outline color=black width=4>\u8ddd<color=#70d8ff>\u4f20\u9001\u95e8</color>\u5f00\u542f\u8fd8\u9700\u51fb\u6740<color=#70d8ff>"+this.mapEnemyResidueFew+"</color>\u4e2a</outline></color></b>",this.sendEvent(l.RCPDD_EventName.KillEnemy,a),this.doorKillRole=0,this.showDoorTips=!1;var r="map/mapBG"+this.mapBgID;this.loadPrefab(l.RCPDD_BundleName.Prefabs,r,function(e){t.presentMapBG=cc.instantiate(e),t.presentMapBG.setParent(t.mapBgBase),t.presentMapBG.setPosition(0,0),t.sendEvent(l.RCPDD_EventName.CloseDoor)}),this.allItems=[],this.roleAllFew=0,this.addItem(this.playerCrt.quadtreeItem),this.createSolderRole();for(var s=0;s<2;s++)this.createProp(),this.createEnemy()}},e.prototype.addItem=function(t){this.allItems.includes(t)||this.allItems.push(t)},e.prototype.removeItem=function(t){var e=this.allItems.indexOf(t);-1!==e&&this.allItems.splice(e,1)},e.prototype.pointArrowToSolderRole=function(){if(this.solderRoleNode&&this.playerCrt){var t=this.solder_Arrow.parent.convertToWorldSpaceAR(this.solder_Arrow.getPosition()),e=this.solderRoleNode.convertToWorldSpaceAR(cc.Vec2.ZERO),i=e.sub(t).normalize();this.solder_Arrow.angle=180*-i.signAngle(cc.v2(0,1))/Math.PI;var n=o.Instance.round(t.sub(e).mag()/10);this.solder_Txt.string="<color=#00ff00>"+n+"\u7c73</color>"}},e.prototype.pointArrowToDoor=function(){if(this.doorNode&&this.playerCrt){var t=this.door_Arrow.parent.convertToWorldSpaceAR(this.door_Arrow.getPosition()),e=this.doorNode.convertToWorldSpaceAR(cc.Vec2.ZERO),i=e.sub(t).normalize();this.door_Arrow.angle=180*-i.signAngle(cc.v2(0,1))/Math.PI;var n=o.Instance.round(t.sub(e).mag()/10);this.door_Txt.string="<color=#eb64ff>"+n+"\u7c73</color>"}},e.prototype.update=function(t){this.gameState!=l.RCPDD_GameState.Pause&&(this.updateWithQuadtree(t),this.pointArrowToSolderRole(),this.pointArrowToDoor())},e.prototype.updateWithQuadtree=function(t){this.debugGraphics&&this.debugGraphics.clear(),this.isBossState||(this.roleAllFew<this.roleMaxFew&&(this.roleTimer+=t,this.roleTimer>=this.roleInterval&&(this.createEnemy(),this.roleTimer=0)),0===this.roleAllFew&&this.createEnemy(),this.minionTimer+=t,this.minionTimer>=this.minionInterval&&(this.createMinion(),this.minionTimer=0)),this.propTimer+=t,this.propTimer>=this.propInterval&&(this.createProp(),this.propTimer=0),u.RCPDD_QuadtreeManager.getInstance().clear();for(var e=0,o=this.allItems;e<o.length;e++){var i=o[e];i&&i.node&&i.node.isValid&&u.RCPDD_QuadtreeManager.getInstance().insert(i)}for(var n=new Set,a=0,r=this.allItems;a<r.length;a++){var s=r[a];if(s&&s.node&&s.node.isValid){for(var c=0,p=u.RCPDD_QuadtreeManager.getInstance().retrieve(s);c<p.length;c++){var d=p[c];s.uuid>d.uuid||s.getBoundingBox().intersects(d.getBoundingBox())&&this.resolveCollision(s,d,n)}s.type==l.EObjectType.Enemy&&s.owner.isSearchFor()}}this.previousCollisions=n},e.prototype.resolveCollision=function(t,e,o){var i=t.type,n=e.type,a=i&(l.EObjectType.Player|l.EObjectType.Enemy),r=n&(l.EObjectType.Player|l.EObjectType.Enemy),s=i===l.EObjectType.Prop,c=n===l.EObjectType.Prop,p=i===l.EObjectType.Minion,u=n===l.EObjectType.Minion,d=i===l.EObjectType.Door,h=n===l.EObjectType.Door,f=i===l.EObjectType.SolderRole,m=n===l.EObjectType.SolderRole;if(a&&r){var g=t.owner,y=e.owner;this.checkRoleVsRole(g,y,o)}else if(a&&c){var v=t.owner,_=e.owner;this.checkRoleVsItem(v,_)}else if(s&&r)_=t.owner,v=e.owner,this.checkRoleVsItem(v,_);else if(a&&u){v=t.owner;var b=e.owner;this.checkRoleVsMinion(v,b,o)}else if(p&&r)b=t.owner,v=e.owner,this.checkRoleVsMinion(v,b,o);else if(a&&h){v=t.owner;var B=e.owner;this.checkRoleVsDoor(v,B)}else d&&r?(B=t.owner,v=e.owner,this.checkRoleVsDoor(v,B)):a&&m?(v=t.owner,B=e.owner,this.checkRoleVsSolder(v,B)):f&&r&&(B=t.owner,v=e.owner,this.checkRoleVsSolder(v,B))},e.prototype.checkRoleVsSolder=function(t,e){t&&cc.Intersection.rectRect(t.boxCol.getBoundingBoxToWorld(),e.boxCol.getBoundingBoxToWorld())&&(e.upThisSolder(),B.UIMgr.getInstance().openUI(l.RCPDD_UIID.RCPDD_UISelectSolderRole,1,e.solderID,e.pathID,t.solderGainIDs),this.solderRoleNode=null,this.solder_Arrow.active=!1,this.solder_Txt.node.active=!1)},e.prototype.checkRoleVsDoor=function(t,e){cc.Intersection.rectRect(t.boxCol.getBoundingBoxToWorld(),e.node.getBoundingBoxToWorld())&&(B.UIMgr.getInstance().openUI(l.RCPDD_UIID.RCPDD_UIDoor,1),this.doorNode=null,this.door_Arrow.active=!1,this.door_Txt.node.active=!1,this.gameState=l.RCPDD_GameState.Pause,e.removeThis(),cc.Tween.stopAllByTarget(t.node),cc.tween(t.node).to(.6,{position:e.node.position}).call(function(){e.node.destroy()}).start())},e.prototype.checkRoleVsItem=function(t,e){cc.Intersection.rectRect(t.boxCol.getBoundingBoxToWorld(),e.node.getBoundingBoxToWorld())&&(t.pickupTool(e.toolFew,e.toolLevel,e.node),e.upThisProp())},e.prototype.checkRoleVsMinion=function(t,e,o){for(var i=t.node.convertToWorldSpaceAR(cc.Vec2.ZERO),n=e.node.convertToWorldSpaceAR(cc.Vec2.ZERO).sub(i),a=this.getToolsInAngleRange(t,n),r=e.boxCol.getBoundingBoxToWorld(),s=e.node.uuid,c=0,p=a;c<p.length;c++){var u=p[c],d=u.getBoundingBoxToWorld(),h=u.uuid,f=h<s?h+"_"+s:s+"_"+h;if(cc.Intersection.rectRect(d,r)&&(o.add(f),!this.previousCollisions.has(f)))return void e.onAtkEd(t.type,t.atkForce)}var m=t.node.uuid,g=m<s?m+"_"+s:s+"_"+m;cc.Intersection.rectRect(t.boxCol.getBoundingBoxToWorld(),r)&&(o.add(g),this.previousCollisions.has(g)||(t.type==l.RCPDD_Type.Player&&t.onAtkEd(e.node,e.atkForce),e.onAtkEd(t.type,t.atkForce)))},e.prototype.checkRoleVsRole=function(t,e,o){if(t.type!=l.RCPDD_Type.Player||e.type!=l.RCPDD_Type.Player){var i=t.node.convertToWorldSpaceAR(cc.Vec2.ZERO),n=e.node.convertToWorldSpaceAR(cc.Vec2.ZERO).sub(i),a=this.getToolsInAngleRange(t,n),r=this.getToolsInAngleRange(e,n.mul(-1)),s=t.boxCol.getBoundingBoxToWorld(),c=e.boxCol.getBoundingBoxToWorld();this.checkToolsVsTools(a,r,t,e,o),this.checkToolsVsBody(a,c,t,e,o),this.checkToolsVsBody(r,s,e,t,o)}},e.prototype.checkToolsVsBody=function(t,e,o,i,n){for(var a=0,r=t;a<r.length;a++){var s=r[a],c=s.getBoundingBoxToWorld(),l=s.uuid,p=i.node.uuid,u=l<p?l+"_"+p:p+"_"+l;if(cc.Intersection.rectRect(c,e)&&(n.add(u),!this.previousCollisions.has(u))){var d,h=Math.max(c.x,e.x),f=Math.max(c.y,e.y),m=Math.min(c.x+c.width,e.x+e.width),g=Math.min(c.y+c.height,e.y+e.height),y=null;m>h&&g>f&&(y=new cc.Rect(h,f,m-h,g-f)),d=y?y.center:c.center,this.showToolCollEff(d),i.onAtkEd(o.node,o.atkForce,o),o.onAtkEvemy(i.node)}}},e.prototype.checkToolsVsTools=function(t,e,o,i,n){var a=this;if(0!==t.length&&0!==e.length)for(var r=0,s=t;r<s.length;r++)for(var c=s[r],u=c.getComponent(p.default).boxCol.getBoundingBoxToWorld(),d=c.uuid,h=0,f=e;h<f.length;h++){var m=f[h],g=m.getComponent(p.default).boxCol.getBoundingBoxToWorld(),y=m.uuid,v=d<y?d+"_"+y:y+"_"+d;if(cc.Intersection.rectRect(u,g)&&(n.add(v),!this.previousCollisions.has(v))){var _,B=Math.max(u.x,g.x),I=Math.max(u.y,g.y),P=Math.min(u.x+u.width,g.x+g.width),C=Math.min(u.y+u.height,g.y+g.height),D=null;P>B&&C>I&&(D=new cc.Rect(B,I,P-B,C-I)),_=D?D.center:u.center,this.showToolCollEff(_);var T=c.getComponent(p.default),S=m.getComponent(p.default);T.roleBase.onCollisionTool(c,S.roleBase),S.roleBase.onCollisionTool(m,T.roleBase),this.audiointerval||(this.audiointerval=!0,setTimeout(function(){a.audiointerval=!1},90),b.AudioMgr.getInstance().playEffectFree(l.RCPDD_AudioId.coll))}}},e.prototype.getToolsInAngleRange=function(t,e){var o=[];if(0===t.toolFew)return o;if(this.isDebug&&this.drawDebugSector(t,e),t.toolFew<15)return t.toolParent.children;for(var i=t.toolParent.convertToNodeSpaceAR(e).sub(t.toolParent.convertToNodeSpaceAR(cc.Vec2.ZERO)),n=180*Math.atan2(i.y,i.x)/Math.PI,a=0;a<t.toolFew;a++){var r=t.toolParent.children[a],s=180*Math.atan2(r.y,r.x)/Math.PI,c=Math.abs(s-n);c>180&&(c=360-c),c<=this.toolAngleRange&&o.push(r)}return 0===o.length?t.toolParent.children:o},e.prototype.getAIWanderPos=function(){var t=this.gameMapCamera.getPosition(),e=t.x+1050*(Math.random()-.5),o=t.y+1633*(Math.random()-.5);return e=Math.max(-this.roleMapWidth,Math.min(this.roleMapWidth,e)),o=Math.max(-this.roleMapHeight,Math.min(this.roleMapHeight,o)),cc.v2(e,o)},e.prototype.getRandomOuterPos=function(t,e,o,i){var n=this.gameMapCamera.getPosition(),a=Math.random()*Math.PI*2,r=n.x+Math.cos(a)*this.random(t,e),s=n.y+Math.sin(a)*this.random(o,i);return(r>this.roleMapWidth||r<-this.roleMapWidth)&&(r=-r),(s>this.roleMapHeight||s<-this.roleMapHeight)&&(s=-s),r=Math.max(-this.roleMapWidth,Math.min(this.roleMapWidth,r)),s=Math.max(-this.roleMapHeight,Math.min(this.roleMapHeight,s)),cc.v2(r,s)},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.prototype.showBuffSelection=function(){var t=this.getBackBuffs();return 0===t.length&&this.currentBuffQuality<this.maxBuffQuality&&(this.currentBuffQuality++,t=this.getBackBuffs()),t},e.prototype.getBackBuffs=function(){var t=this.getBuffsByQuality(this.currentBuffQuality);return this.getRandomBuffs(t,this.buffsPerRefresh)},e.prototype.onBuffSelected=function(t){this.buffSelectionCount[t]=(this.buffSelectionCount[t]||0)+1,this.currentBuffQuality=1},e.prototype.getAvailableBuffs=function(){var t=this;return this.buffDatas.filter(function(e){return(t.buffSelectionCount[e.ID]||0)<e.buffNum})},e.prototype.getBuffsByQuality=function(t){return this.getAvailableBuffs().filter(function(e){return e.buffQuality===t})},e.prototype.getRandomBuffs=function(t,e){return t.length<e?t:t.sort(function(){return.5-Math.random()}).slice(0,e)},e.prototype.initDebugGraphics=function(){this.debugNode=new cc.Node("DebugGraphics"),this.debugNode.setParent(this.node),this.debugGraphics=this.debugNode.addComponent(cc.Graphics),this.debugGraphics.lineWidth=2,this.debugGraphics.strokeColor=cc.Color.RED,this.debugGraphics.fillColor=new cc.Color(255,0,0,100),this.debugNode.setSiblingIndex(999)},e.prototype.setDebugSectorVisible=function(t){this.showDebugSector=t,!t&&this.debugGraphics&&this.debugGraphics.clear()},e.prototype.setSectorRadius=function(t){this.sectorRadius=t},e.prototype.drawDebugSector=function(t,e){if(this.showDebugSector&&this.debugGraphics&&t.node){var o=180*Math.atan2(e.y,e.x)/Math.PI,i=t.node.convertToWorldSpaceAR(cc.Vec2.ZERO),n=this.debugNode.convertToNodeSpaceAR(i),a=(o-this.toolAngleRange)*Math.PI/180,r=(o+this.toolAngleRange)*Math.PI/180;this.debugGraphics.strokeColor=cc.Color.RED,this.debugGraphics.lineWidth=2,this.debugGraphics.moveTo(n.x,n.y),this.debugGraphics.arc(n.x,n.y,this.sectorRadius,a,r,!0),this.debugGraphics.lineTo(n.x,n.y),this.debugGraphics.stroke(),this.debugGraphics.fill(),this.debugGraphics.strokeColor=cc.Color.YELLOW,this.debugGraphics.lineWidth=3,this.debugGraphics.moveTo(n.x,n.y);var s=n.x+Math.cos(o*Math.PI/180)*this.sectorRadius,c=n.y+Math.sin(o*Math.PI/180)*this.sectorRadius;this.debugGraphics.lineTo(s,c),this.debugGraphics.stroke()}},e.Instance=null,o=c([P],e)}(_.default));a.default=C,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_GameMapCamera:[function(t,e,o){"use strict";cc._RF.push(e,"7acb9crgHVO75XXPM3vvK2t","RCPDD_GameMapCamera");var i=t,n=e,a=o;cc._RF.push(n,"7acb9crgHVO75XXPM3vvK2t","RCPDD_GameMapCamera");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RCPDD_Config"),u=i("RCPDD_GameManager"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameMapCamera=null,e.mapWidth=0,e.mapHeight=0,e.cameraHalfWidth=0,e.cameraHalfHeight=0,e.isShake=!1,e.duration=.12,e.strength=1,e.shakeTimes=6,e.interval=e.duration/e.shakeTimes,e.shakeOffset=cc.v3(0,0,0),e.isMove=!1,e.direction=cc.v3(),e}return s(e,t),e.prototype.onLoad=function(){this.gameMapCamera=this.node.getComponent(cc.Camera),this.interval=this.duration/this.shakeTimes,this.addEvent(p.RCPDD_EventName.CameraMove,this.cameraMove),this.addEvent(p.RCPDD_EventName.TouchStart,this.onTouchStart),this.addEvent(p.RCPDD_EventName.TouchEnd,this.onTouchEnd),this.addEvent(p.RCPDD_EventName.ShakeCamera,this.shakeCamera),this.addEvent(p.RCPDD_EventName.CameraPos,this.setCameraPos)},e.prototype.start=function(){this.mapWidth=u.default.Instance.mapWidth,this.mapHeight=u.default.Instance.mapHeight,this.updateCameraHalfSize()},e.prototype.update=function(t){if(this.isMove){var e=-this.mapWidth/2+this.cameraHalfWidth,o=this.mapWidth/2-this.cameraHalfWidth,i=-this.mapHeight/2+this.cameraHalfHeight,n=this.mapHeight/2-this.cameraHalfHeight,a=this.direction.clone();a.x=cc.misc.clampf(a.x,e,o),a.y=cc.misc.clampf(a.y,i,n);var r=this.node.position.lerp(a,30*t);this.node.setPosition(r.add(this.shakeOffset))}else this.node.setPosition(this.node.position.add(this.shakeOffset))},e.prototype.onTouchStart=function(){this.isMove=!0},e.prototype.onTouchEnd=function(){this.isMove=!1},e.prototype.cameraMove=function(t){this.direction=t},e.prototype.setCameraPos=function(t){this.node.setPosition(t),this.direction=t},e.prototype.shakeCamera=function(){var t=this;this.isShake||(this.isShake=!0,cc.tween(this).repeat(this.shakeTimes,cc.tween().call(function(){t.shakeOffset.x=2*(Math.random()-.5)*t.strength,t.shakeOffset.y=2*(Math.random()-.5)*t.strength}).delay(this.interval)).call(function(){t.shakeOffset.set(cc.v3(0,0,0)),t.isShake=!1}).start())},e.prototype.getSize=function(){var t=cc.view.getVisibleSize(),e=t.width/2*(1/this.gameMapCamera.zoomRatio),o=t.height/2*(1/this.gameMapCamera.zoomRatio);return{min:cc.v2(0-e,0-o),max:cc.v2(0+e,0+o)}},e.prototype.updateCameraHalfSize=function(){var t=cc.view.getVisibleSize();this.cameraHalfWidth=t.width/2/this.gameMapCamera.zoomRatio,this.cameraHalfHeight=t.height/2/this.gameMapCamera.zoomRatio},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_JoystickCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"3f155JxSZpAraAdUVy006fW","RCPDD_JoystickCtrl");var i=t,n=e,a=o;cc._RF.push(n,"3f155JxSZpAraAdUVy006fW","RCPDD_JoystickCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RCPDD_Config"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.joystickBg=null,e.joystickKnob=null,e.startPositon=null,e.maxDistance=0,e.handleDistance=0,e.joystickInitialPos=null,e.moveX=0,e.moveY=0,e.keyMovePos=cc.v3(),e}return s(e,t),e.prototype.onLoad=function(){this.joystickBg=cc.find("joystickBg",this.node),this.joystickKnob=cc.find("joystickBg/joystickKnob",this.node),this.joystickInitialPos=this.joystickBg.position.clone(),this.maxDistance=this.joystickBg.width/2,this.handleDistance=this.joystickKnob.width/2,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onKeyDown=function(t){switch(0===this.moveX&&0===this.moveY&&this.sendEvent(p.RCPDD_EventName.TouchStart),t.keyCode){case cc.macro.KEY.a:this.moveX=-1;break;case cc.macro.KEY.d:this.moveX=1;break;case cc.macro.KEY.w:this.moveY=1;break;case cc.macro.KEY.s:this.moveY=-1}var e=cc.v2(this.moveX,this.moveY);e.equals(cc.Vec2.ZERO)||e.normalizeSelf(),this.sendEvent(p.RCPDD_EventName.TouchMove,e)},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.d:this.moveX=0;break;case cc.macro.KEY.w:case cc.macro.KEY.s:this.moveY=0}var e=cc.v3(this.moveX,this.moveY);e.equals(cc.Vec3.ZERO)||e.normalizeSelf(),this.sendEvent(p.RCPDD_EventName.TouchMove,e),0===this.moveX&&0===this.moveY&&this.sendEvent(p.RCPDD_EventName.TouchEnd)},e.prototype.onTouchStart=function(t){cc.Tween.stopAllByTarget(this.joystickBg),this.startPositon=t.getLocation().add(this.node.getPosition()),this.joystickBg.setPosition(this.node.convertToNodeSpaceAR(t.getLocation())),this.sendEvent(p.RCPDD_EventName.TouchStart)},e.prototype.onTouchMove=function(t){var e=t.getLocation(),o=180*Math.atan2(e.y-this.startPositon.y,e.x-this.startPositon.x)/Math.PI,i=Math.sqrt(Math.pow(e.y-this.startPositon.y,2)+Math.pow(e.x-this.startPositon.x,2));this.setKnobPos(o,i)},e.prototype.onTouchEnd=function(){this.sendEvent(p.RCPDD_EventName.TouchEnd),this.joystickKnob.setPosition(0,0,0),cc.Tween.stopAllByTarget(this.joystickBg),cc.tween(this.joystickBg).to(.1,{position:this.joystickInitialPos}).start()},e.prototype.setKnobPos=function(t,e){void 0===e&&(e=0),e=e<=this.maxDistance-this.handleDistance?e:this.maxDistance-this.handleDistance,this.joystickKnob.x=e*Math.cos(t*Math.PI/180),this.joystickKnob.y=e*Math.sin(t*Math.PI/180);var o=cc.v3(Math.cos(t*Math.PI/180),Math.sin(t*Math.PI/180),0);o.equals(cc.Vec3.ZERO)||o.normalizeSelf(),this.sendEvent(p.RCPDD_EventName.TouchMove,o)},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_MinMonster:[function(t,e,o){"use strict";cc._RF.push(e,"83b82mhVQdAcJASw7E00Ukc","RCPDD_MinMonster");var i=t,n=e,a=o;cc._RF.push(n,"83b82mhVQdAcJASw7E00Ukc","RCPDD_MinMonster");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("RCPDD_Config"),d=i("RCPDD_GameEnumData"),h=i("RCPDD_EvolutionDataMgr"),f=i("RCPDD_GameManager"),m=i("RCPDD_QuadtreeItem"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.quadtreeItem=null,e.roleParent=null,e.spineAnim=null,e.boxCol=null,e.moveAngleRad=0,e.isDie=!1,e.moveSpeed=200,e.maxHp=200,e.nowHp=0,e.downExp=0,e.atkForce=5,e.dieTime=0,e}return s(e,t),e.prototype.onLoad=function(){this.roleParent=cc.find("role",this.node),this.spineAnim=cc.find("role/spineAnim",this.node).getComponent(sp.Skeleton),this.boxCol=cc.find("boxCol",this.node),this.quadtreeItem=this.getComponent(m.default),this.quadtreeItem.collisionMask=u.EObjectType.Player|u.EObjectType.Enemy,f.default.Instance.addItem(this.quadtreeItem),this.spineAnim.setAnimation(0,u.RCPDD_AnimName.move,!0),this.initData(),this.addEvent(u.RCPDD_EventName.RefreshData,this.refreshData)},e.prototype.update=function(t){if(!this.isDie&&f.default.Instance.gameState!=u.RCPDD_GameState.Pause){if(this.dieTime+=t,this.dieTime>15)return f.default.Instance.removeItem(this.quadtreeItem),void this.node.destroy();var e=this.moveSpeed*t,o=Math.cos(this.moveAngleRad)*e,i=Math.sin(this.moveAngleRad)*e,n=this.node.position.add(cc.v3(o,i,0));this.node.setPosition(n)}},e.prototype.init=function(t){this.moveAngleRad=Math.atan2(t.y,t.x),t.x>.01?1!=this.roleParent.scaleX&&(this.roleParent.scaleX=1):t.x<-.01&&-1!=this.roleParent.scaleX&&(this.roleParent.scaleX=-1)},e.prototype.initData=function(){this.maxHp=h.default.getInstance().getRoleInfo().TrashHp,this.nowHp=this.maxHp,this.downExp=h.default.getInstance().getRoleInfo().TrashEx,this.atkForce=h.default.getInstance().getParameterCfg(d.enumGearParameterCfg.EnemyMiniAtk).value},e.prototype.refreshData=function(){this.downExp=h.default.getInstance().getRoleInfo().TrashEx},e.prototype.onAtkEd=function(t,e){f.default.Instance.isGM_On&&f.default.Instance.gameState!=u.RCPDD_GameState.Pause&&(this.isDie||(this.nowHp-=e,this.nowHp<=0&&(this.isDie=!0,f.default.Instance.removeItem(this.quadtreeItem),f.default.Instance.showDieEff(this.node.position.clone()),t==u.RCPDD_Type.Player&&this.sendEvent(u.RCPDD_EventName.PlayerGetExp,this.downExp),p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.die),this.node.destroy())))},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_PlayerNode:[function(t,e,o){"use strict";cc._RF.push(e,"8d6a6GJAVRPe4SzxJgWe6Sz","RCPDD_PlayerNode");var i=t,n=e,a=o;cc._RF.push(n,"8d6a6GJAVRPe4SzxJgWe6Sz","RCPDD_PlayerNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("UIMgr"),u=i("RCPDD_Config"),d=i("RCPDD_GameEnumData"),h=i("RCPDD_EvolutionDataMgr"),f=i("RCPDD_GameManager"),m=i("RCPDD_QuadtreeItem"),g=i("RCPDD_RoleBase"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=u.RCPDD_Type.Player,e.isMove=!1,e.direction=cc.v3(0,0,0),e.addAtkForce=1,e.addToolSpeed=1,e.addMoveSpeed=1,e.addToolScale=1,e.addMaxHp=1,e.addHpRatio=0,e.addHpRatioTime=0,e.invincibleContinue=5,e.invincibleTime=5,e.invincibleStat=!1,e.extraSkillAtk=5,e.solderRoleBase=null,e.solderPos=[],e.solderAsePaths=[],e.solderGainIDs=[],e.mateCfgs=[],e.activateSkills=[],e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.solderRoleBase=cc.find("role/solderRole",this.node);for(var e=cc.find("role/solderRole/pos",this.node).children,o=0,i=e.length;o<i;o++){var n=e[i-1-o];this.solderPos[o]=n.getComponent(sp.Skeleton)}this.mateCfgs=h.default.getInstance().getSkillCfgs(),this.toolLevel=1,this.solderRoleBase.active=!1,this.quadtreeItem=this.getComponent(m.default),this.quadtreeItem.collisionMask=u.EObjectType.Player|u.EObjectType.Enemy|u.EObjectType.Prop|u.EObjectType.Minion|u.EObjectType.Door|u.EObjectType.SolderRole,f.default.Instance.addItem(this.quadtreeItem)},e.prototype.start=function(){t.prototype.start.call(this),this.initData(),this.addEvent(u.RCPDD_EventName.TouchStart,this.onTouchStart),this.addEvent(u.RCPDD_EventName.TouchMove,this.onTouchMove),this.addEvent(u.RCPDD_EventName.TouchEnd,this.onTouchEnd),this.addEvent(u.RCPDD_EventName.GM_AddTool,this.gm_AddTool),this.addEvent(u.RCPDD_EventName.GM_Up,this.upToolLevel),this.addEvent(u.RCPDD_EventName.ObtainBuff,this.obtainBuff),this.addEvent(u.RCPDD_EventName.PlaySkills,this.playSkills),this.addEvent(u.RCPDD_EventName.PickupSolderRole,this.pickupSolderRole)},e.prototype.update=function(e){if(!this.isDie&&(t.prototype.update.call(this,e),f.default.Instance.gameState!=u.RCPDD_GameState.Pause)){if(0!=this.addHpRatio&&(this.addHpRatioTime+=e,this.addHpRatioTime>1&&!(this.nowHp>this.maxHp))){this.addHpRatioTime=0;var o=f.default.Instance.round(this.maxHp*this.addHpRatio);this.nowHp+=o,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.refreshHpBar()}if(this.invincibleStat&&(this.invincibleTime-=e,this.invincibleTime<0&&(this.invincibleStat=!1,this.shield.active=!1,this.shieldExplode.node.active=!0,this.shieldExplode.setAnimation(0,"animation",!1),l.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.die))),this.isMove){this.direction.x>.01?1!=this.roleParent.scaleX&&(this.roleParent.scaleX=1):this.direction.x<-.01&&-1!=this.roleParent.scaleX&&(this.roleParent.scaleX=-1);var i=this.direction.mul(this.moveSpeed*e);((n=this.node.position.add(i).add(this.knockbackOffset)).x>this.mapWidth||n.x<-this.mapWidth)&&(n.x=this.node.position.x),(n.y>this.mapHeight||n.y<-this.mapHeight)&&(n.y=this.node.position.y),this.node.setPosition(n),this.sendEvent(u.RCPDD_EventName.CameraMove,n)}else if(0!==this.knockbackOffset.x||0!==this.knockbackOffset.y||0!==this.knockbackOffset.z){var n;((n=this.node.position.add(this.knockbackOffset)).x>this.mapWidth||n.x<-this.mapWidth)&&(n.x=this.node.position.x),(n.y>this.mapHeight||n.y<-this.mapHeight)&&(n.y=this.node.position.y),this.node.setPosition(n),this.sendEvent(u.RCPDD_EventName.CameraMove,n)}}},e.prototype.init=function(t,e){var o=this;this.addTool(t),this.loadResFromBundle(u.RCPDD_BundleName.SpAnim,u.RoleAsePath[e].path,sp.SkeletonData,function(t){o.spineAnim.skeletonData=t,o.spineAnim.setAnimation(0,u.RCPDD_AnimName.idle,!0)}),this.solderAsePaths.push(e),this.solderGainIDs.push(u.RoleAsePath[e].ID)},e.prototype.initData=function(){this.atkForce=h.default.getInstance().getAtk(this.toolLevel).Attack,this.maxHp=h.default.getInstance().getParameterCfg(d.enumGearParameterCfg.PlayerHp).value,this.nowHp=this.maxHp},e.prototype.pickupSolderRole=function(t,e){var o=this;if(!(this.solderAsePaths.length>=5)){if(this.solderAsePaths.push(e),this.getActivatedMateIDs(t),this.solderRoleBase.active)this.loadResFromBundle(u.RCPDD_BundleName.SpAnim,u.RoleAsePath[e].path,sp.SkeletonData,function(t){o.solderPos[o.solderAsePaths.length-1].skeletonData=t,o.solderPos[o.solderAsePaths.length-1].setAnimation(0,u.RCPDD_AnimName.idle,!0)});else{this.radius=120;var i=this.hpBG.position.clone();i.y+=45,this.hpBG.setPosition(i);var n=this.txt_ToolFew.node.position.clone();n.y+=45,this.txt_ToolFew.node.setPosition(n),this.boxCol.setContentSize(160,160),this.shield.setScale(1.25),this.shieldExplode.node.setScale(1.25),this.pickUpLv.node.setScale(1.45),this.refreshToolPos(!0),this.solderRoleBase.active=!0,this.spineAnim.node.active=!1;for(var a=function(t){var e=t;r.loadResFromBundle(u.RCPDD_BundleName.SpAnim,u.RoleAsePath[r.solderAsePaths[e]].path,sp.SkeletonData,function(t){o.solderPos[e].skeletonData=t,o.solderPos[e].setAnimation(0,u.RCPDD_AnimName.idle,!0)})},r=this,s=0;s<this.solderAsePaths.length;s++)a(s)}this.playPickUpLv(),l.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.prop)}},e.prototype.getActivatedMateIDs=function(t){var e=this;this.solderGainIDs.push(t);for(var o=0,i=this.mateCfgs;o<i.length;o++){var n=i[o];this.activateSkills.includes(n.mateID)||n.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).includes(t)})&&n.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).every(function(t){return e.solderGainIDs.includes(t)})})&&(this.activateSkills.push(n.mateID),this.sendEvent(u.RCPDD_EventName.ActivateSkills,n.mateID))}},e.prototype.playSkills=function(t){switch(t){case 3:this.playSkill3();break;case 4:this.playSkill4();break;case 5:this.playSkill5()}},e.prototype.playSkill3=function(){var t=f.default.Instance.round(.2*this.maxHp);this.nowHp+=t,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.refreshHpBar(),this.invincibleStat=!0,this.invincibleTime=this.invincibleContinue,this.shield.active=!0,l.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.shield)},e.prototype.playSkill4=function(){this.upToolLevel(this.toolLevel+1),this.atkForce+=5},e.prototype.playSkill5=function(){this.upToolLevel(this.getRandomLevel())},e.prototype.getRandomLevel=function(){var t;do{t=Math.floor(8*Math.random())+1}while(t===this.toolLevel);return t},e.prototype.obtainBuff=function(t,e){switch(t){case 9001:case 9010:case 9019:case 9027:this.addAtkForce+=e;var o=h.default.getInstance().getAtk(this.toolLevel).Attack;o*=this.addAtkForce,this.atkForce=o;break;case 9002:case 9011:case 9020:case 9028:this.addToolSpeed+=e;var i=this.basicToolSpeed;i*=this.addToolSpeed,this.toolSpeed=i;break;case 9003:case 9012:case 9021:case 9029:this.addToolScale+=e;var n=1;n*=this.addToolScale,this.toolScale=n,this.shieldBase.setScale(this.smoothValue(this.toolScale)),this.refreshToolPos();break;case 9005:var a=f.default.Instance.round(this.maxHp*e);this.nowHp+=a,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.refreshHpBar();break;case 9006:case 9014:case 9023:case 9031:this.addMoveSpeed+=e;var r=this.basicMoveSpeed;r*=this.addMoveSpeed,this.moveSpeed=r;break;case 9007:case 9015:case 9024:case 9032:this.addHpRatio+=e;break;case 9008:case 9016:case 9026:case 9034:var s=f.default.Instance.round(this.toolFew*e);s<1&&(s=1),this.addTool(s);break;case 9009:case 9017:case 9018:case 9035:this.addMaxHp+=e;var c=this.nowHp/this.maxHp,l=h.default.getInstance().getParameterCfg(d.enumGearParameterCfg.PlayerHp).value;l=f.default.Instance.round(l*this.addMaxHp),this.maxHp=l,this.nowHp=f.default.Instance.round(this.maxHp*c);break;case 9025:case 9033:this.upToolLevel()}},e.prototype.smoothValue=function(t){if(t<=1)return t;var e=22/285*t*t+-1339/2850*t+3969/2850;return t*Math.max(0,Math.min(1,e))},e.prototype.upToolLevel=function(e){void 0===e&&(e=0),t.prototype.upToolLevel.call(this,e),this.sendEvent(u.RCPDD_EventName.UpToolLevel,this.toolLevel)},e.prototype.onTouchStart=function(){this.isMove=!0,this.spineAnim.setAnimation(0,u.RCPDD_AnimName.move,!0)},e.prototype.onTouchMove=function(t){this.direction=t},e.prototype.onTouchEnd=function(){this.direction=cc.v3(0,0,0),this.isMove=!1,this.spineAnim.setAnimation(0,u.RCPDD_AnimName.idle,!0)},e.prototype.onCollisionTool=function(e,o){void 0===o&&(o=null),f.default.Instance.isGM_On&&o&&!o.isDie&&(this.invincibleStat||this.isDie||t.prototype.onCollisionTool.call(this,e,o))},e.prototype.onAtkEd=function(e,o,i){void 0===i&&(i=null),f.default.Instance.isGM_On&&f.default.Instance.gameState!=u.RCPDD_GameState.Pause&&i&&!i.isDie&&(this.invincibleStat||this.isDie||(t.prototype.onAtkEd.call(this,e,o,i),this.isDie&&(f.default.Instance.gameState=u.RCPDD_GameState.Pause,p.UIMgr.getInstance().openUI(u.RCPDD_UIID.RCPDD_UIGameOver,1,!1),f.default.Instance.playerCrt=null)))},e.prototype.gm_AddTool=function(){this.addTool(10)},c([v],e)}(g.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_PropTool:[function(t,e,o){"use strict";cc._RF.push(e,"261c5p63olAjads3UjeFY2J","RCPDD_PropTool");var i=t,n=e,a=o;cc._RF.push(n,"261c5p63olAjads3UjeFY2J","RCPDD_PropTool");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RCPDD_Config"),u=i("RCPDD_QuadtreeItem"),d=i("RCPDD_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toolIcon=null,e.txt_ToolFew=null,e.bubble=null,e.toolLevel=1,e.toolFew=0,e.quadtreeItem=null,e}return s(e,t),e.prototype.onLoad=function(){this.toolIcon=cc.find("toolIcon",this.node).getComponent(cc.Sprite),this.txt_ToolFew=cc.find("txt_ToolFew",this.node).getComponent(cc.RichText),this.bubble=cc.find("bubble",this.node).getComponent(cc.Sprite),this.quadtreeItem=this.getComponent(u.default),this.quadtreeItem.collisionMask=p.EObjectType.Player|p.EObjectType.Enemy,d.default.Instance.addItem(this.quadtreeItem)},e.prototype.start=function(){this.addEvent(p.RCPDD_EventName.UpToolLevel,this.refreshToolLevel);var t=this.node.position.clone(),e=t.clone();e.y+=25,this.node.setScale(0),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.1,{scale:1,position:e}).to(.2,{position:t}).start()},e.prototype.init=function(t,e){var o=this;switch(e>8&&(e=8),this.toolLevel=e,0===t&&(this.txt_ToolFew.node.active=!1,this.loadSpriteFrame(p.RCPDD_BundleName.Sprite,"qipao/qipao2",function(t){o.bubble.spriteFrame=t})),this.toolFew=t,t){case 1:this.txt_ToolFew.string="<b><outline color=black width=4>1</outline></b>";break;case 4:this.txt_ToolFew.string="<b><color=#70d8ff><outline color=black width=4>4</outline></color></b>";break;case 10:this.txt_ToolFew.string="<b><color=#eb64ff><outline color=black width=4>10</outline></color></b>";break;default:this.txt_ToolFew.string="<b><color=#ff9535><outline color=black width=4>"+this.toolFew+"</outline></color></b>"}this.setSprite()},e.prototype.upThisProp=function(){d.default.Instance.removeItem(this.quadtreeItem)},e.prototype.refreshToolLevel=function(t){0!=this.toolFew&&(t>8&&(t=8),this.toolLevel=t,this.setSprite())},e.prototype.setSprite=function(){var t=this,e="tool/"+this.toolLevel;this.loadSpriteFrame(p.RCPDD_BundleName.Sprite,e,function(e){t.toolIcon.spriteFrame=e})},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_QuadtreeItem:[function(t,e,o){"use strict";cc._RF.push(e,"de9d50z7RtHDYRRPujyzRsK","RCPDD_QuadtreeItem");var i=t,n=e,a=o;cc._RF.push(n,"de9d50z7RtHDYRRPujyzRsK","RCPDD_QuadtreeItem");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RCPDD_Config"),p=i("RCPDD_Door"),u=i("RCPDD_PropTool"),d=i("RCPDD_Skill"),h=i("RCPDD_SolderRole"),f=i("RCPDD_MinMonster"),m=i("RCPDD_RoleBase"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=l.EObjectType.None,e.collisionMask=l.EObjectType.None,e.owner=null,e}return s(e,t),e.prototype.onLoad=function(){switch(this.type){case l.EObjectType.Player:case l.EObjectType.Enemy:this.owner=this.getComponent(m.default);break;case l.EObjectType.Prop:this.owner=this.getComponent(u.default);break;case l.EObjectType.Minion:this.owner=this.getComponent(f.default);break;case l.EObjectType.Door:this.owner=this.getComponent(p.default);break;case l.EObjectType.Skill:this.owner=this.getComponent(d.default);break;case l.EObjectType.SolderRole:this.owner=this.getComponent(h.default)}},e.prototype.getBoundingBox=function(){return this.node.getBoundingBoxToWorld()},c([v({type:cc.Enum(l.EObjectType),tooltip:"\u8be5\u7269\u4f53\u7684\u7c7b\u578b\uff08\u73a9\u5bb6\u3001\u654c\u4eba\u3001\u9053\u5177...\uff09"})],e.prototype,"type",void 0),c([y],e)}(cc.Component);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_QuadtreeManager:[function(t,e,o){"use strict";cc._RF.push(e,"94108B50NZHcYPEA88amE0A","RCPDD_QuadtreeManager");var i=t,n=e,a=o;cc._RF.push(n,"94108B50NZHcYPEA88amE0A","RCPDD_QuadtreeManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.RCPDD_QuadtreeManager=void 0;var r=i("RCPDD_Quadtree"),s=function(){function t(){}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.init=function(t,e){var o=new cc.Rect(-t/2,-e/2,t,e);this.quadtree=new r.RCPDD_Quadtree(o,4,6)},t.prototype.clear=function(){this.quadtree&&this.quadtree.clear()},t.prototype.insert=function(t){this.quadtree&&t&&t.node&&this.quadtree.insert(t)},t.prototype.retrieve=function(t){if(!this.quadtree||!t)return[];for(var e=[],o=0,i=this.quadtree.retrieve(t.getBoundingBox());o<i.length;o++){var n=i[o];if(t!==n){var a=0!=(t.collisionMask&n.type),r=0!=(n.collisionMask&t.type);a&&r&&e.push(n)}}return e},t.prototype.retrieveInRect=function(t){return this.quadtree?this.quadtree.retrieve(t):[]},t}();a.RCPDD_QuadtreeManager=s,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_Quadtree:[function(t,e,o){"use strict";cc._RF.push(e,"37b36VZdjZBLpNeVOIRQMyp","RCPDD_Quadtree");var i=e,n=o;cc._RF.push(i,"37b36VZdjZBLpNeVOIRQMyp","RCPDD_Quadtree");var a=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(n,"__esModule",{value:!0}),n.RCPDD_Quadtree=void 0;var r=function(){function t(t,e,o,i){void 0===e&&(e=10),void 0===o&&(o=5),void 0===i&&(i=0),this.maxObjects=e,this.maxLevels=o,this.level=i,this.bounds=t,this.objects=[],this.nodes=[],this.divided=!1}return t.prototype.split=function(){var e=this.level+1,o=this.bounds.width/2,i=this.bounds.height/2,n=this.bounds.x,a=this.bounds.y;this.nodes[0]=new t(new cc.Rect(n+o,a,o,i),this.maxObjects,this.maxLevels,e),this.nodes[1]=new t(new cc.Rect(n,a,o,i),this.maxObjects,this.maxLevels,e),this.nodes[2]=new t(new cc.Rect(n,a+i,o,i),this.maxObjects,this.maxLevels,e),this.nodes[3]=new t(new cc.Rect(n+o,a+i,o,i),this.maxObjects,this.maxLevels,e),this.divided=!0},t.prototype.getIndex=function(t){var e=-1,o=this.bounds.x+this.bounds.width/2,i=this.bounds.y+this.bounds.height/2,n=t.y<i&&t.y+t.height<i,a=t.y>i;return t.x<o&&t.x+t.width<o?n?e=1:a&&(e=2):t.x>o&&(n?e=0:a&&(e=3)),e},t.prototype.insert=function(t){if(this.divided&&-1!==(o=this.getIndex(t.getBoundingBox())))this.nodes[o].insert(t);else if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels&&!this.divided){this.split();for(var e=0;e<this.objects.length;){var o,i=this.objects[e];-1!==(o=this.getIndex(i.getBoundingBox()))?this.nodes[o].insert(this.objects.splice(e,1)[0]):e++}}},t.prototype.retrieve=function(t){var e=a(this.objects);if(this.divided){var o=this.getIndex(t);if(-1!==o)e.push.apply(e,this.nodes[o].retrieve(t));else for(var i=0;i<this.nodes.length;i++)t.intersects(this.nodes[i].bounds)&&e.push.apply(e,this.nodes[i].retrieve(t))}return e.filter(function(e,o,i){return i.indexOf(e)===o&&t.intersects(e.getBoundingBox())})},t.prototype.clear=function(){this.objects=[];for(var t=0;t<this.nodes.length;t++)this.divided&&this.nodes[t].clear();this.nodes=[],this.divided=!1},t}();n.RCPDD_Quadtree=r,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_RoleBase:[function(t,e,o){"use strict";cc._RF.push(e,"b8dddCda/tNz41TGOH9SP6K","RCPDD_RoleBase");var i=t,n=e,a=o;cc._RF.push(n,"b8dddCda/tNz41TGOH9SP6K","RCPDD_RoleBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("RCPDD_Config"),d=i("RCPDD_GameEnumData"),h=i("RCPDD_EvolutionDataMgr"),f=i("RCPDD_GameManager"),m=i("RCPDD_Tool"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleParent=null,e.toolParent=null,e.spineAnim=null,e.txt_ToolFew=null,e.boxCol=null,e.hpBG=null,e.hpBar=null,e.pickUpLv=null,e.mapWidth=0,e.mapHeight=0,e.invAtkEd=!1,e.toolLevel=1,e.toolFew=0,e.basicMoveSpeed=200,e.basicToolSpeed=180,e.moveSpeed=0,e.toolSpeed=0,e.maxHp=0,e.nowHp=0,e.atkForce=0,e.toolScale=1,e.radius=72,e.eachToolFewAtk=0,e.eachToolLevelAtk=0,e.isCollisionTool=!1,e.frontTool=0,e.isDie=!1,e.knockbackOffset=cc.v3(0,0,0),e.knockbackDistanceTool=3.5,e.knockbackDistanceAtkEd=7,e.shieldBase=null,e.shield=null,e.shieldExplode=null,e.isShield=!1,e.shieldTime=0,e.shieldCooling=!1,e.iflower40=!0,e.quadtreeItem=null,e.recordflyFew=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.roleParent=cc.find("role",this.node),this.toolParent=cc.find("rotationTool",this.node),this.txt_ToolFew=cc.find("txt_ToolFew",this.node).getComponent(cc.Label),this.spineAnim=cc.find("role/spineAnim",this.node).getComponent(sp.Skeleton),this.boxCol=cc.find("boxCol",this.node),this.hpBG=cc.find("hpBG",this.node),this.hpBar=cc.find("hpBG/hpBar",this.node).getComponent(cc.ProgressBar),this.pickUpLv=cc.find("pd_pickUpLv",this.node).getComponent(sp.Skeleton),this.shieldBase=cc.find("shield",this.node),this.shield=cc.find("shield/pd_shields",this.node),this.shieldExplode=cc.find("shield/pd_explode",this.node).getComponent(sp.Skeleton),this.shield.active=!1,this.shieldExplode.node.active=!1,this.hpBG.active=!1,this.pickUpLv.node.active=!1,this.moveSpeed=this.basicMoveSpeed,this.toolSpeed=this.basicToolSpeed,this.mapWidth=f.default.Instance.roleMapWidth,this.mapHeight=f.default.Instance.roleMapHeight,this.shieldExplode.setCompleteListener(function(e){"animation"==e.animation.name&&(t.shieldExplode.node.active=!1)}),this.pickUpLv.setCompleteListener(function(e){"animation"==e.animation.name&&(t.pickUpLv.node.active=!1)})},e.prototype.start=function(){this.eachToolFewAtk=h.default.getInstance().getParameterCfg(d.enumGearParameterCfg.eachSwordNum).value,this.eachToolLevelAtk=h.default.getInstance().getParameterCfg(d.enumGearParameterCfg.eachSwordLevel).value},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.indexTimeout&&clearTimeout(this.indexTimeout)},e.prototype.update=function(t){this.isDie||(this.toolParent.angle-=t*this.toolSpeed,!this.isShield&&this.toolFew>39&&(this.shieldTime+=t,this.shieldTime>5&&(this.shieldTime=0,this.isShield=!0,this.shield.active=!0,p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.shield))))},e.prototype.upToolLevel=function(t){void 0===t&&(t=0),0==t?this.toolLevel++:this.toolLevel=t,this.toolLevel>8&&(this.toolLevel=8),this.toolLevel<1&&(this.toolLevel=1),this.type==u.RCPDD_Type.Player&&p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.upToolLv),this.atkForce=h.default.getInstance().getAtk(this.toolLevel).Attack;var e=this.toolParent.children;if(this.toolFew=e.length,0!==this.toolFew)for(var o=0;o<this.toolFew;o++)e[o].getComponent(m.default).setToolLevel(this.toolLevel)},e.prototype.pickupTool=function(t,e,o){var i=this;cc.Tween.stopAllByTarget(o),cc.tween(o).to(.3,{position:this.node.position}).start(),setTimeout(function(){i.type==u.RCPDD_Type.Player&&p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.prop),i.playPickUpLv(),i.addTool(t,e),o.destroy()},200)},e.prototype.playPickUpLv=function(){this.pickUpLv&&(this.pickUpLv.node.active=!0,this.pickUpLv.setAnimation(0,"animation",!1))},e.prototype.addTool=function(t,e){var o=this;void 0===e&&(e=this.toolLevel),this.loadPrefab(u.RCPDD_BundleName.Prefabs,"tool/tool",function(i){o.type==u.RCPDD_Type.Enemy&&(e=o.toolLevel);for(var n=0;n<t;n++){var a=cc.instantiate(i);a.setParent(o.toolParent),a.setPosition(0,0),a.getComponent(m.default).init(e,o)}o.type==u.RCPDD_Type.Player&&e!=o.toolLevel&&o.upToolLevel(e),o.toolFew=o.toolParent.children.length,o.toolFew>=40&&o.iflower40&&!o.shieldCooling&&(o.shieldCooling=!0,setTimeout(function(){o.shieldCooling=!1},1e4),o.shieldTime=0,o.isShield=!0,o.shield.active=!0,p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.shield)),o.toolFew>=40&&(o.iflower40=!1),o.refreshToolPos()})},e.prototype.removeTool=function(t){var e=t.parent.convertToWorldSpaceAR(t.position),o=t.parent.angle+t.angle;t.setParent(f.default.Instance.flyToolNode);var i=t.parent.convertToNodeSpaceAR(cc.v2(e.x,e.y));t.setPosition(i);var n=o-t.parent.angle;t.angle=n,t.getComponent(m.default).flyAway(),this.toolFew=this.toolParent.children.length,this.toolFew<40&&(this.iflower40=!0),this.txt_ToolFew.string=this.toolFew.toString()},e.prototype.onCollisionTool=function(t,e){var o=this;if(f.default.Instance.isGM_On&&e&&!e.isDie){if(this.shieldTime=0,this.isShield)return this.shield.active=!1,this.isShield=!1,this.shieldExplode.node.active=!0,this.shieldExplode.setAnimation(0,"animation",!1),void p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.die);if(this.type==u.RCPDD_Type.Player?this.sendEvent(u.RCPDD_EventName.ShakeCamera):this.isCollisionTool||(this.frontTool=this.toolFew),this.isCollisionTool=!0,this.indexTimeout&&clearTimeout(this.indexTimeout),this.indexTimeout=null,this.toolFew>e.toolFew||this.toolLevel>e.toolLevel){var i=(this.toolLevel-e.toolLevel)*this.eachToolLevelAtk;i<0&&(i=0);var n=this.getToolFewDiffer(this.toolFew-e.toolFew)*this.eachToolFewAtk,a=Math.floor(i+n)+1;this.recordflyFew++,a>f.default.Instance.getToolOnCill()&&(a=f.default.Instance.getToolOnCill()),this.recordflyFew>=a&&(this.recordflyFew=0,this.removeTool(t))}else this.removeTool(t);this.knockback(e.node,this.knockbackDistanceTool),this.indexTimeout=setTimeout(function(){o.indexTimeout=null,o.isCollisionTool=!1,o.refreshToolPos(!0)},800)}},e.prototype.getCubeExponent=function(t){return Math.pow(3,t)},e.prototype.getToolFewDiffer=function(t){return t<10?0:Math.floor(t/10)},e.prototype.onAtkEd=function(t,e,o){var i=this;if(void 0===o&&(o=null),!this.isDie&&!this.invAtkEd){if(this.invAtkEd=!0,setTimeout(function(){i.invAtkEd=!1},300),p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.shouji),this.nowHp-=e,this.hpBG.active||(this.hpBG.active=!0),this.refreshHpBar(),this.nowHp<=0){if(this.isDie=!0,f.default.Instance.removeItem(this.quadtreeItem),f.default.Instance.showDieEff(this.node.position.clone()),this.type!=u.RCPDD_Type.Player){var n=f.default.Instance.round(.2*this.frontTool);if(n>0){var a=this.node.position.clone();f.default.Instance.fallProp(a,n,this.toolLevel)}}p.AudioMgr.getInstance().playEffectFree(u.RCPDD_AudioId.die),this.node.destroy()}this.knockback(t,this.knockbackDistanceAtkEd)}},e.prototype.refreshHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.15,{progress:t}).start()},e.prototype.onAtkEvemy=function(t){t&&this.knockback(t,this.knockbackDistanceTool)},e.prototype.knockback=function(t,e){var o=this;if(!this.isDie&&t){var i=this.node.getPosition().sub(t.getPosition()).normalize().mul(e);this.knockbackOffset=cc.v3(i.x,i.y,0),cc.Tween.stopAllByTarget(this.knockbackOffset),cc.tween(this.knockbackOffset).to(.1,{x:0,y:0,z:0}).call(function(){o.knockbackOffset=cc.Vec3.ZERO}).start()}},e.prototype.refreshToolPos=function(t){void 0===t&&(t=!1);var e=this.toolParent.children;if(this.toolFew=e.length,this.txt_ToolFew.string=this.toolFew.toString(),0!==this.toolFew)for(var o=0;o<this.toolFew;o++){var i=e[o],n=360/this.toolFew*o,a=cc.misc.degreesToRadians(n),r=this.radius*Math.cos(a),s=this.radius*Math.sin(a),c=cc.v3(r,s,0),l=cc.v2(-1*this.toolScale,1*this.toolScale);i.setScale(l),t?(cc.Tween.stopAllByTarget(i),cc.tween(i).to(.15,{position:c,angle:n-90}).start()):(cc.Tween.stopAllByTarget(i),i.setPosition(c),i.angle=n-90)}},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"81904pcsgxJo5FbHjkp6G/6","RCPDD_Skill");var i=t,n=e,a=o;cc._RF.push(n,"81904pcsgxJo5FbHjkp6G/6","RCPDD_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RCPDD_Config"),u=i("RCPDD_EvolutionDataMgr"),d=i("RCPDD_QuadtreeItem"),h=i("RCPDD_QuadtreeManager"),f=i("RCPDD_GameManager"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boxCol=null,e.spineAnim=null,e.skillID=0,e.atkForce=0,e.quadtreeItem=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.boxCol=cc.find("boxCol",this.node),this.spineAnim=cc.find("spineAnim",this.node).getComponent(sp.Skeleton),this.spineAnim.setAnimation(0,"animation",!1),this.spineAnim.setCompleteListener(function(e){"animation"==e.animation.name&&(f.default.Instance.removeItem(t.quadtreeItem),t.node.destroy())}),6!=this.skillID?this.spineAnim.setEventListener(function(e,o){"attack"==o.data.name&&t.attack()}):(this.spineAnim.timeScale=1.5,setTimeout(function(){t.attack()},100),setTimeout(function(){t.attack()},1e3)),this.atkForce=u.default.getInstance().getSkill(this.skillID).mateSkillATK,this.quadtreeItem=this.getComponent(d.default),this.quadtreeItem.collisionMask=p.EObjectType.Minion|p.EObjectType.Enemy,f.default.Instance.addItem(this.quadtreeItem)},e.prototype.attack=function(){for(var t=0,e=h.RCPDD_QuadtreeManager.getInstance().retrieveInRect(this.boxCol.getBoundingBoxToWorld());t<e.length;t++){var o=e[t];o.type==p.EObjectType.Enemy?o.owner.onAtkEd(this.node,this.atkForce):o.type==p.EObjectType.Minion&&o.owner.onAtkEd(p.RCPDD_Type.Player,this.atkForce)}},c([y(Number)],e.prototype,"skillID",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_SolderRole:[function(t,e,o){"use strict";cc._RF.push(e,"d842d3k4v5CBZriba0AGywy","RCPDD_SolderRole");var i=t,n=e,a=o;cc._RF.push(n,"d842d3k4v5CBZriba0AGywy","RCPDD_SolderRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RCPDD_Config"),u=i("RCPDD_QuadtreeItem"),d=i("RCPDD_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.quadtreeItem=null,e.spineAnim1=null,e.spineAnim2=null,e.bg=null,e.boxCol=null,e.solderID=[],e.pathID=[],e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spineAnim1=cc.find("spineAnim1",this.node).getComponent(sp.Skeleton),this.spineAnim2=cc.find("spineAnim2",this.node).getComponent(sp.Skeleton),this.bg=cc.find("bg",this.node),this.boxCol=cc.find("boxCol",this.node),cc.tween(this.bg).to(.8,{scale:1}).to(.8,{scale:.6}).start(),this.id=setInterval(function(){cc.tween(t.bg).to(.8,{scale:1}).to(.8,{scale:.6}).start()},1600),this.quadtreeItem=this.getComponent(u.default),this.quadtreeItem.collisionMask=p.EObjectType.Player,d.default.Instance.addItem(this.quadtreeItem)},e.prototype.init=function(t){var e=this;this.loadResFromBundle(p.RCPDD_BundleName.SpAnim,p.RoleAsePath[t[0]].path,sp.SkeletonData,function(t){e.spineAnim1.skeletonData=t,e.spineAnim1.setAnimation(0,p.RCPDD_AnimName.idle,!0)}),this.loadResFromBundle(p.RCPDD_BundleName.SpAnim,p.RoleAsePath[t[1]].path,sp.SkeletonData,function(t){e.spineAnim2.skeletonData=t,e.spineAnim2.setAnimation(0,p.RCPDD_AnimName.idle,!0)}),this.pathID=t,this.solderID[0]=p.RoleAsePath[t[0]].ID,this.solderID[1]=p.RoleAsePath[t[1]].ID},e.prototype.upThisSolder=function(){d.default.Instance.removeItem(this.quadtreeItem),this.node.destroy()},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.id)},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_Tool:[function(t,e,o){"use strict";cc._RF.push(e,"577786HxVxHQIdbgg3hGE/d","RCPDD_Tool");var i=t,n=e,a=o;cc._RF.push(n,"577786HxVxHQIdbgg3hGE/d","RCPDD_Tool");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RCPDD_Config"),u=cc._decorator,d=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.boxCol=null,e.roleBase=null,e.level=1,e.moveSpeed=1e3,e.moving=!1,e.moveAngleRad=0,e.countdown=0,e}return s(e,t),e.prototype.onLoad=function(){this.icon=cc.find("icon",this.node).getComponent(cc.Sprite),this.boxCol=cc.find("boxCol",this.node)},e.prototype.start=function(){},e.prototype.update=function(t){if(this.moving)if(this.countdown+=t,this.countdown>1)this.node.destroy();else{var e=this.moveSpeed*t,o=Math.cos(this.moveAngleRad)*e,i=Math.sin(this.moveAngleRad)*e,n=this.node.position.add(cc.v3(o,i,0));this.node.setPosition(n),this.icon.node.angle+=2*t*this.moveSpeed}},e.prototype.init=function(t,e){this.level=t,this.roleBase=e,this.setToolLevel(this.level)},e.prototype.setToolLevel=function(t){var e=this;this.level=t;var o="tool/"+this.level;this.loadSpriteFrame(p.RCPDD_BundleName.Sprite,o,function(t){e.node&&e.node.active&&(e.icon.spriteFrame=t)})},e.prototype.flyAway=function(){var t=this.node.angle-180;this.moveAngleRad=cc.misc.degreesToRadians(t),this.moving=!0},c([d],e)}(l.default));a.default=h,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_UIDoor:[function(t,e,o){"use strict";cc._RF.push(e,"03c66hp9qpOF6wOTo9mW/+y","RCPDD_UIDoor");var i=t,n=e,a=o;cc._RF.push(n,"03c66hp9qpOF6wOTo9mW/+y","RCPDD_UIDoor");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RCPDD_Config"),u=i("RCPDD_GameManager"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mask=null,e}return s(e,t),e.prototype.onLoad=function(){this.mask=cc.find("mask",this.node),this.mask.opacity=0,cc.Tween.stopAllByTarget(this.node),cc.tween(this.mask).to(.6,{opacity:255}).call(function(){u.default.Instance.enterDoor()}).start()},e.prototype.start=function(){this.addEvent(p.RCPDD_EventName.CloseDoor,this.closeDoor)},e.prototype.closeDoor=function(){var t=this;cc.tween(this.mask).to(.6,{opacity:0}).call(function(){t.closeUI()}).start()},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"32dbc6+1rRF4IKCMxY3BebI","RCPDD_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"32dbc6+1rRF4IKCMxY3BebI","RCPDD_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RCPDD_APP"),u=i("RCPDD_Config"),d=i("RCPDD_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fail=null,e.win=null,e.txt_Ranking=null,e.txt_KillRole=null,e.btnClose=null,e.isWin=!1,e}return s(e,t),e.prototype.onLoad=function(){this.fail=cc.find("root/fail",this.node),this.win=cc.find("root/win",this.node),this.txt_Ranking=cc.find("root/txt_Ranking",this.node).getComponent(cc.RichText),this.txt_KillRole=cc.find("root/txt_KillRole",this.node).getComponent(cc.RichText),this.btnClose=cc.find("root/btnClose",this.node),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this)},e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){if(d.default.Instance.gameState=u.RCPDD_GameState.Pause,this.win.active=this.isWin,this.fail.active=!this.isWin,this.isWin)this.txt_Ranking.string="<b><outline color=black width=2>\u7b2c<color=#ff9535>1</color>\u540d</outline></b>",this.txt_KillRole.string="<b><outline color=black width=2>\u5df2\u51fb\u8d25\u4e86<color=#eb64ff>44</color>\u540d\u654c\u4eba</outline></b>";else{var t=43-d.default.Instance.killRole;this.txt_Ranking.string="<b><outline color=black width=2>\u7b2c<color=#7cf84b>"+d.default.Instance.random(t-7,t+5,!0)+"</color>\u540d</outline></b>",this.txt_KillRole.string="<b><outline color=black width=2>\u5df2\u51fb\u8d25\u4e86<color=#eb64ff>"+d.default.Instance.killRole+"</color>\u540d\u654c\u4eba</outline></b>"}},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"dd232dD71tJ+qYsJZyTDnVT","RCPDD_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"dd232dD71tJ+qYsJZyTDnVT","RCPDD_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("SdkMgr"),h=i("UIMgr"),f=i("RCPDD_Config"),m=i("RCPDD_EvolutionDataMgr"),g=i("RCPDD_GameManager"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gm_AddTool=null,e.GM_Base=null,e.gm_Up=null,e.GM_On=null,e.GM_AI=null,e.GM_Draw=null,e.GM_Enemy=null,e.GM_Prop=null,e.GM_Minion=null,e.GM_Kill=null,e.GM_Buff=null,e.GM_Skill1=null,e.GM_Skill2=null,e.GM_Skill6=null,e.GM_Skill3=null,e.GM_Skill4=null,e.GM_Skill5=null,e.GM_Skill7=null,e.GM_Solder=null,e.ui_Top=null,e.txt_Levl=null,e.btn_Pause=null,e.txt_killRole=null,e.expBar=null,e.playSkillTips=null,e.skill_1=null,e.skill_2=null,e.lockMask_1=null,e.lockMask_2=null,e.isSkillLock1=!1,e.isSkillLock2=!1,e.isSkillInterval1=0,e.isSkillInterval2=0,e.isSkillTime1=0,e.isSkillTime2=0,e.killRoleFew=43,e.playerLevel=1,e.upLevelExp=0,e.nowExp=0,e.addExp=1,e.activateSkills=[],e.isUpLevel=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.GM_Base=cc.find("ui_Top/GM_Base",this.node),this.gm_AddTool=cc.find("ui_Top/GM_Base/GM_AddTool",this.node),this.gm_Up=cc.find("ui_Top/GM_Base/GM_Up",this.node),this.GM_On=cc.find("ui_Top/GM_Base/GM_On",this.node),this.GM_AI=cc.find("ui_Top/GM_Base/GM_AI",this.node),this.GM_Draw=cc.find("ui_Top/GM_Base/GM_Draw",this.node),this.GM_Enemy=cc.find("ui_Top/GM_Base/GM_Enemy",this.node),this.GM_Prop=cc.find("ui_Top/GM_Base/GM_Prop",this.node),this.GM_Minion=cc.find("ui_Top/GM_Base/GM_Minion",this.node),this.GM_Kill=cc.find("ui_Top/GM_Base/GM_Kill",this.node),this.GM_Buff=cc.find("ui_Top/GM_Base/GM_Buff",this.node),this.GM_Skill1=cc.find("ui_Top/GM_Base/GM_Skill1",this.node),this.GM_Skill2=cc.find("ui_Top/GM_Base/GM_Skill2",this.node),this.GM_Skill6=cc.find("ui_Top/GM_Base/GM_Skill6",this.node),this.GM_Skill3=cc.find("ui_Top/GM_Base/GM_Skill3",this.node),this.GM_Skill4=cc.find("ui_Top/GM_Base/GM_Skill4",this.node),this.GM_Skill5=cc.find("ui_Top/GM_Base/GM_Skill5",this.node),this.GM_Skill7=cc.find("ui_Top/GM_Base/GM_Skill7",this.node),this.GM_Solder=cc.find("ui_Top/GM_Base/GM_Solder",this.node),this.ui_Top=cc.find("ui_Top",this.node),this.txt_Levl=cc.find("ui_Top/level/txt_Levl",this.node).getComponent(cc.Label),this.txt_killRole=cc.find("ui_Top/txt_killRole",this.node).getComponent(cc.RichText),this.expBar=cc.find("ui_Top/level/expBar",this.node).getComponent(cc.ProgressBar),this.skill_1=cc.find("ui_Top/skillBtn/skill_1",this.node),this.skill_2=cc.find("ui_Top/skillBtn/skill_2",this.node),this.lockMask_1=cc.find("ui_Top/skillBtn/skill_1/lockMask_1",this.node).getComponent(cc.Sprite),this.lockMask_2=cc.find("ui_Top/skillBtn/skill_2/lockMask_2",this.node).getComponent(cc.Sprite),this.playSkillTips=cc.find("ui_Top/playSkillTips",this.node),this.btn_Pause=cc.find("ui_Top/btn_Pause",this.node),this.GM_Base.active=!1,(d.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&this.txt_Levl.node.on(cc.Node.EventType.TOUCH_END,function(){t.GM_Base.active=!t.GM_Base.active}),this.skill_1.active=!1,this.skill_2.active=!1,this.lockMask_1.node.active=!1,this.lockMask_2.node.active=!1,this.playSkillTips.active=!1,m.default.getInstance().loadCfg(function(){t.refreshDataExp(),g.default.Instance.initWin()}),this.skill_1.on(cc.Node.EventType.TOUCH_END,function(){t.isSkillLock1||(t.lockMask_1.node.active=!0,t.lockMask_1.fillRange=1,t.isSkillLock1=!0,t.isSkillTime1=t.isSkillInterval1,t.playSkills1(t.activateSkills[0]))},this),this.skill_2.on(cc.Node.EventType.TOUCH_END,function(){t.isSkillLock2||(t.lockMask_2.node.active=!0,t.lockMask_2.fillRange=1,t.isSkillLock2=!0,t.isSkillTime2=t.isSkillInterval2,t.playSkills1(t.activateSkills[1]))},this),this.btn_Pause.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.gameState=f.RCPDD_GameState.Pause,h.UIMgr.getInstance().openUI(f.RCPDD_UIID.RCPDD_UISetting,1)},this),this.txt_killRole.string="<b><outline color=black width=4>\u8ddd<color=#70d8ff>\u4f20\u9001\u95e8</color>\u5f00\u542f\u8fd8\u9700\u51fb\u6740<color=#70d8ff>10</color>\u4e2a</outline></color></b>",this.gm_AddTool.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(f.RCPDD_EventName.GM_AddTool)},this),this.gm_Up.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(f.RCPDD_EventName.GM_Up)},this),this.GM_On.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.isGM_On=!g.default.Instance.isGM_On,t.GM_On.getComponent(cc.Label).string="\u78b0\u649e:"+g.default.Instance.isGM_On},this),this.GM_AI.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.isGM_AI=!g.default.Instance.isGM_AI,t.GM_AI.getComponent(cc.Label).string="AI:"+g.default.Instance.isGM_AI},this),this.GM_Draw.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.isDebug=!g.default.Instance.isDebug,t.GM_Draw.getComponent(cc.Label).string="\u7ed8\u5236:"+g.default.Instance.isDebug,g.default.Instance.setDebugSectorVisible(g.default.Instance.isDebug)},this),this.GM_Enemy.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.createEnemy()},this),this.GM_Prop.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.createProp()},this),this.GM_Minion.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.createMinion()},this),this.GM_Kill.on(cc.Node.EventType.TOUCH_END,function(){for(var t=0;t<1;t++)g.default.Instance.killEnemy()},this),this.GM_Buff.on(cc.Node.EventType.TOUCH_END,function(){h.UIMgr.getInstance().openUI(f.RCPDD_UIID.RCPDD_UISelectBuff,1,g.default.Instance.showBuffSelection()),g.default.Instance.gameState=f.RCPDD_GameState.Pause,t.sendEvent(f.RCPDD_EventName.SetGameState,f.RCPDD_GameState.Pause)},this),this.GM_Skill1.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.playSkills(1)},this),this.GM_Skill2.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.playSkills(2)},this),this.GM_Skill6.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.playSkills(6)},this),this.GM_Skill3.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(f.RCPDD_EventName.PlaySkills,3)},this),this.GM_Skill4.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(f.RCPDD_EventName.PlaySkills,4)},this),this.GM_Skill5.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(f.RCPDD_EventName.PlaySkills,5)},this),this.GM_Skill7.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.playSkillFriend()},this),this.GM_Solder.on(cc.Node.EventType.TOUCH_END,function(){g.default.Instance.createSolderRole()},this)},e.prototype.start=function(){this.addEvent(f.RCPDD_EventName.PlayerGetExp,this.playerGetExp),this.addEvent(f.RCPDD_EventName.KillEnemy,this.killRole),this.addEvent(f.RCPDD_EventName.ObtainBuff,this.obtainBuff),this.addEvent(f.RCPDD_EventName.ActivateSkills,this.onSkillAdded),this.GM_On.getComponent(cc.Label).string="\u78b0\u649e:"+g.default.Instance.isGM_On,this.GM_AI.getComponent(cc.Label).string="AI:"+g.default.Instance.isGM_AI,this.GM_Draw.getComponent(cc.Label).string="\u7ed8\u5236:"+g.default.Instance.isDebug},e.prototype.update=function(t){this.isSkillLock1&&(this.isSkillTime1-=t,this.lockMask_1.fillRange=this.isSkillTime1/this.isSkillInterval1,this.isSkillTime1<0&&(this.isSkillLock1=!1,this.lockMask_1.node.active=!1)),this.isSkillLock2&&(this.isSkillTime2-=t,this.lockMask_2.fillRange=this.isSkillTime2/this.isSkillInterval2,this.isSkillTime2<0&&(this.isSkillLock2=!1,this.lockMask_2.node.active=!1))},e.prototype.playSkills1=function(t){switch(t){case 1:case 2:case 6:g.default.Instance.playSkills(t);break;case 3:case 4:case 5:this.sendEvent(f.RCPDD_EventName.PlaySkills,t);break;case 7:g.default.Instance.playSkillFriend()}var e=this.playSkillTips.position.clone(),o=cc.instantiate(this.playSkillTips);o.active=!0,o.setParent(this.ui_Top),o.setPosition(e);var i="mateBanner/"+m.default.getInstance().getSkill(t).mateBannerRes;this.loadSpriteFrame(f.RCPDD_BundleName.Sprite,i,function(t){o.getComponent(cc.Sprite).spriteFrame=t}),e.x+=600,cc.tween(o).to(.4,{position:e}).start(),setTimeout(function(){e.x-=600,cc.tween(o).to(.4,{position:e}).call(function(){o.destroy()}).start()},2400)},e.prototype.onSkillAdded=function(t){var e=this;if(!(this.activateSkills.length>=2)){this.activateSkills.push(t);var o={isSkill:!0,skillID:t,txtTips:""};if(h.UIMgr.getInstance().openUI(f.RCPDD_UIID.RCPDD_UIToolTips,1,o),1==this.activateSkills.length){this.skill_1.active=!0,this.isSkillInterval1=m.default.getInstance().getSkill(t).mateCDtime,this.isSkillTime1=this.isSkillInterval1;var i="skillsIcon/"+m.default.getInstance().getSkill(t).mateIconRes;this.loadSpriteFrame(f.RCPDD_BundleName.Sprite,i,function(o){e.skill_1.getComponent(cc.Sprite).spriteFrame=o,e.skill_1.setScale(0),cc.tween(e.skill_1).to(.2,{scale:1}).start(),e.skill_1.getChildByName("skillName").getComponent(cc.Label).string=m.default.getInstance().getSkill(t).mateName})}else 2==this.activateSkills.length&&(this.isSkillInterval2=m.default.getInstance().getSkill(t).mateCDtime,this.isSkillTime2=this.isSkillInterval2,this.skill_2.active=!0,i="skillsIcon/"+m.default.getInstance().getSkill(t).mateIconRes,this.loadSpriteFrame(f.RCPDD_BundleName.Sprite,i,function(o){e.skill_2.getComponent(cc.Sprite).spriteFrame=o,e.skill_2.setScale(0),cc.tween(e.skill_2).to(.2,{scale:1}).start(),e.skill_2.getChildByName("skillName").getComponent(cc.Label).string=m.default.getInstance().getSkill(t).mateName}))}},e.prototype.playerGetExp=function(t){var e=this;if(t*=this.addExp,this.nowExp+=t,this.nowExp>=this.upLevelExp){var o=this.nowExp-this.upLevelExp;this.playerLevel++,this.nowExp=o,this.refreshDataExp();var i=this.nowExp/this.upLevelExp;this.isUpLevel=!0,g.default.Instance.gameState=f.RCPDD_GameState.Pause,h.UIMgr.getInstance().openUI(f.RCPDD_UIID.RCPDD_UISelectBuff,1,g.default.Instance.showBuffSelection()),this.sendEvent(f.RCPDD_EventName.SetGameState,f.RCPDD_GameState.Pause),cc.Tween.stopAllByTarget(this.expBar),cc.tween(this.expBar).to(.2,{progress:1}).call(function(){e.txt_Levl.string=e.playerLevel.toString()}).to(.05,{progress:0}).to(.1,{progress:i}).call(function(){e.isUpLevel=!1,e.playerGetExp(0)}).start()}else{if(this.isUpLevel)return;i=this.nowExp/this.upLevelExp,cc.Tween.stopAllByTarget(this.expBar),cc.tween(this.expBar).to(.3,{progress:i}).start()}},e.prototype.killRole=function(t){this.txt_killRole.string=t},e.prototype.obtainBuff=function(t,e){switch(t){case 9004:case 9013:case 9022:case 9030:this.addExp+=e,console.log("\u7ecf\u9a8c\u52a0\u6210\uff1a"+e+"\uff0c\u5f53\u524d\u603b\u52a0\u6210\uff1a"+this.addExp)}},e.prototype.refreshDataExp=function(){this.upLevelExp=m.default.getInstance().getExp(this.playerLevel).Reward},c([v],e)}(p.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_UISelectBuff:[function(t,e,o){"use strict";cc._RF.push(e,"69f09jcxPZGw41SHUBtYKUu","RCPDD_UISelectBuff");var i=t,n=e,a=o;cc._RF.push(n,"69f09jcxPZGw41SHUBtYKUu","RCPDD_UISelectBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RCPDD_Config"),u=i("RCPDD_GameManager"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.itemBuff=null,e.btn_Close=null,e.randomBuffs=[],e.isSelected=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.itemBase=cc.find("root/ItemBase",this.node),this.itemBuff=cc.find("root/ltemBuff",this.node),this.btn_Close=cc.find("root/btn_Close",this.node),this.itemBuff.active=!1,this.btn_Close.active=u.default.Instance.currentBuffQuality<4,this.btn_Close.on(cc.Node.EventType.TOUCH_END,function(){t.backUI()},this)},e.prototype.init=function(t){this.randomBuffs=t},e.prototype.start=function(){this.isSelected=!1,this.showBuffSelection()},e.prototype.showBuffSelection=function(){var t=this;if(this.randomBuffs)for(var e=function(e){var i=cc.instantiate(o.itemBuff);i.setParent(o.itemBase),i.active=!0,i.on(cc.Node.EventType.TOUCH_END,function(){t.onBuffSelected(e.ID,e.buffParametric)},o),i.getChildByName("buffName").getComponent(cc.Label).string=e.buffName,i.getChildByName("buffInfo").getComponent(cc.RichText).string=e.buffCopy1;var n="buffIcon/"+e.icon1,a="buffBG/buffLevel"+e.buffQuality;o.loadSpriteFrame(p.RCPDD_BundleName.Sprite,n,function(t){i.getChildByName("buffIcon").getComponent(cc.Sprite).spriteFrame=t}),o.loadSpriteFrame(p.RCPDD_BundleName.Sprite,a,function(t){i.getComponent(cc.Sprite).spriteFrame=t})},o=this,i=0,n=this.randomBuffs;i<n.length;i++)e(n[i])},e.prototype.onBuffSelected=function(t,e){this.isSelected||(this.isSelected=!0,u.default.Instance.onBuffSelected(t),this.sendEvent(p.RCPDD_EventName.ObtainBuff,t,e),u.default.Instance.gameState=p.RCPDD_GameState.Fight,this.sendEvent(p.RCPDD_EventName.SetGameState,p.RCPDD_GameState.Fight),this.closeUI())},e.prototype.backUI=function(){this.isSelected||(this.isSelected=!0,u.default.Instance.currentBuffQuality++,u.default.Instance.gameState=p.RCPDD_GameState.Fight,this.sendEvent(p.RCPDD_EventName.SetGameState,p.RCPDD_GameState.Fight),this.closeUI())},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_UISelectSolderRole:[function(t,e,o){"use strict";cc._RF.push(e,"436bb01pQdFS4hGNepxrxQ6","RCPDD_UISelectSolderRole");var i=t,n=e,a=o;cc._RF.push(n,"436bb01pQdFS4hGNepxrxQ6","RCPDD_UISelectSolderRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RCPDD_Config"),u=i("RCPDD_EvolutionDataMgr"),d=i("RCPDD_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.ltemRole=null,e.roleSolderInfo=null,e.solderBase=null,e.itemSolder=null,e.mateCfg=[],e.solderID=[],e.pathID=[],e.playerSolderGainIDs=[],e.mateStatus=[],e.isSelected=!1,e}return s(e,t),e.prototype.onLoad=function(){this.itemBase=cc.find("root/ItemBase",this.node),this.ltemRole=cc.find("root/ltemRole",this.node),this.roleSolderInfo=cc.find("root/roleSolderInfo",this.node),this.solderBase=cc.find("root/solderBase",this.node),this.itemSolder=cc.find("root/ItemSolder",this.node),this.ltemRole.active=!1,this.itemSolder.active=!1,this.roleSolderInfo.active=!1,d.default.Instance.gameState=p.RCPDD_GameState.Pause},e.prototype.init=function(t,e,o){this.solderID=t,this.pathID=e,this.playerSolderGainIDs=o},e.prototype.start=function(){var t=this;this.isSelected=!1,this.mateCfg=u.default.getInstance().getSkillCfgs();for(var e=function(e){var i=e,n=cc.instantiate(o.ltemRole);n.setParent(o.itemBase),n.active=!0,n.on(cc.Node.EventType.TOUCH_END,function(){t.selected(i)},o),n.getChildByName("roleName").getComponent(cc.Label).string=u.default.getInstance().getSolderRole(o.solderID[i]).characterName;var a=n.getChildByName("infoBase");if(u.default.getInstance().getSolderRole(o.solderID[i]).characterintr1){var r=cc.instantiate(o.roleSolderInfo);r.setParent(a),r.active=!0,r.getChildByName("txt").getComponent(cc.RichText).string=u.default.getInstance().getSolderRole(o.solderID[i]).characterintr1;var s="solderIcon/"+u.default.getInstance().getSolderRole(o.solderID[i]).icon1;o.loadSpriteFrame(p.RCPDD_BundleName.Sprite,s,function(t){r.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}if(u.default.getInstance().getSolderRole(o.solderID[i]).characterintr2){var c=cc.instantiate(o.roleSolderInfo);c.setParent(a),c.active=!0,c.getChildByName("txt").getComponent(cc.RichText).string=u.default.getInstance().getSolderRole(o.solderID[i]).characterintr2,s="solderIcon/"+u.default.getInstance().getSolderRole(o.solderID[i]).icon1,o.loadSpriteFrame(p.RCPDD_BundleName.Sprite,s,function(t){c.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})}o.loadResFromBundle(p.RCPDD_BundleName.SpAnim,p.RoleAsePath[o.pathID[i]].path,sp.SkeletonData,function(t){n.getChildByName("roleSpIcon").getComponent(sp.Skeleton).skeletonData=t,n.getChildByName("roleSpIcon").getComponent(sp.Skeleton).setAnimation(0,p.RCPDD_AnimName.idle,!0)})},o=this,i=0;i<2;i++)e(i);this.mateStatus=this.getMateDisplayStatuses();var n=function(t){var e=cc.instantiate(a.itemSolder);e.setParent(a.solderBase),e.active=!0,e.getChildByName("solderName").getComponent(cc.Label).string=a.mateStatus[t].mateName,e.getChildByName("solderFew").getComponent(cc.Label).string=a.mateStatus[t].hasCount+"/"+a.mateStatus[t].required;var o="solderIcon/"+a.mateStatus[t].mateID;a.loadSpriteFrame(p.RCPDD_BundleName.Sprite,o,function(t){e.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t})},a=this;for(i=0;i<this.mateStatus.length;i++)n(i)},e.prototype.getMateDisplayStatuses=function(){for(var t=new Set(this.playerSolderGainIDs),e=[],o=0,i=this.mateCfg;o<i.length;o++){for(var n=i[o],a=0,r=0,s=0,c=n.mateRole.split("|").map(function(t){return t.trim()});s<c.length;s++){var l=c[s].split(",").map(function(t){return parseInt(t,10)}),p=l.filter(function(e){return t.has(e)}).length;p>a&&(a=p,r=l.length)}a>0&&e.push({mateID:n.mateID,mateName:n.mateName,hasCount:a,required:r})}return e},e.prototype.selected=function(t){this.isSelected||(this.isSelected=!0,this.sendEvent(p.RCPDD_EventName.PickupSolderRole,this.solderID[t],this.pathID[t]),d.default.Instance.gameState=p.RCPDD_GameState.Fight,this.closeUI())},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"29d1bvNRM9CVL118U05B0Q4","RCPDD_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"29d1bvNRM9CVL118U05B0Q4","RCPDD_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RCPDD_APP"),u=i("RCPDD_Config"),d=i("RCPDD_GameManager"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.btnJX=null,e.btn_Back=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;d.default.Instance.gameState=u.RCPDD_GameState.Pause,this.btnClose=cc.find("root/btnClose",this.node),this.btnJX=cc.find("root/btnJX",this.node),this.btn_Back=cc.find("root/btn_Back",this.node),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this),this.btnJX.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),d.default.Instance.gameState=u.RCPDD_GameState.Fight},this),this.btn_Back.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),d.default.Instance.gameState=u.RCPDD_GameState.Fight},this)},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RCPDD_UIToolTips:[function(t,e,o){"use strict";cc._RF.push(e,"b14998zxdZF9LZC5gRdMQZj","RCPDD_UIToolTips");var i=t,n=e,a=o;cc._RF.push(n,"b14998zxdZF9LZC5gRdMQZj","RCPDD_UIToolTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RCPDD_Config"),u=i("RCPDD_EvolutionDataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e.skillBase=null,e.icon=null,e.skname=null,e.info=null,e.tips=null,e}return s(e,t),e.prototype.onLoad=function(){this.txt=cc.find("txt",this.node).getComponent(cc.Label),this.skillBase=cc.find("skill",this.node),this.icon=cc.find("skill/icon",this.node).getComponent(cc.Sprite),this.skname=cc.find("skill/name",this.node).getComponent(cc.Label),this.info=cc.find("skill/info",this.node).getComponent(cc.Label)},e.prototype.init=function(t){this.tips=t},e.prototype.start=function(){var t=this;if(this.txt.node.active=!this.tips.isSkill,this.skillBase.active=this.tips.isSkill,this.tips.isSkill){this.skname.string=u.default.getInstance().getSkill(this.tips.skillID).mateName,this.info.string=u.default.getInstance().getSkill(this.tips.skillID).mateintro;var e="skillsIcon/"+u.default.getInstance().getSkill(this.tips.skillID).mateIconRes;this.loadSpriteFrame(p.RCPDD_BundleName.Sprite,e,function(e){t.icon.spriteFrame=e})}else this.txt.string=this.tips.txtTips;this.node.setPosition(0,320),this.node.setScale(1,0),cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.3,{scaleY:1}).start(),setTimeout(function(){var e=t.node.position.clone();e.y+=200,cc.tween(t.node).to(.4,{position:e}).call(function(){t.closeUI()}).start()},2400)},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],RSDGameData:[function(t,e,o){"use strict";cc._RF.push(e,"f5f39FtAQFI34KFP+ngMde9","RSDGameData");var i=e,n=o;cc._RF.push(i,"f5f39FtAQFI34KFP+ngMde9","RSDGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emRSDGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffTypeCfg="buffTypeCfg",t.buffPoolCfg="buffPoolCfg",t.characterCfg="characterCfg",t.characterLevelCfg="characterLevelCfg",t.levelCfg="levelCfg"}(n.emRSDGameDataKeys||(n.emRSDGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],RSDGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"9a90cxfmA5O3bOvp4JlnUCP","RSDGameEnumData");var i=e,n=o;cc._RF.push(i,"9a90cxfmA5O3bOvp4JlnUCP","RSDGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.collectionTime=2]="collectionTime",t[t.basicATK=3]="basicATK",t[t.basicWeaponry=4]="basicWeaponry",t[t.basicHP=5]="basicHP",t[t.weaponryEndurance=6]="weaponryEndurance",t[t.travelSpeed=7]="travelSpeed",t[t.dragonMoveSpeed=8]="dragonMoveSpeed",t[t.dragonBasicATK=9]="dragonBasicATK",t[t.basicCrit=10]="basicCrit",t[t.critDamage=11]="critDamage",t[t.treeExperiences=12]="treeExperiences",t[t.treeDurability=13]="treeDurability",t[t.quake=14]="quake",t[t.dragonMoveAmni=15]="dragonMoveAmni",t[t.speedPlusTimes=16]="speedPlusTimes",t[t.randomDropNumber=17]="randomDropNumber",t[t.randomDropProb=18]="randomDropProb"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),cc._RF.pop(),cc._RF.pop()},{}],RSD_App:[function(t,e,o){"use strict";cc._RF.push(e,"9ccb9F333hJ0oyRG3slz+1K","RSD_App");var i=t,n=e,a=o;cc._RF.push(n,"9ccb9F333hJ0oyRG3slz+1K","RSD_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("UIMgr"),s=i("Config"),c=i("RSD_Configs"),l=i("RSD_DataMgr"),p=i("RSD_PlayerMgr"),u=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;if(void 0===o&&(o=!1),c.Global.isDirect=o,this.addTouchEvent(),this._exitCall=e,o)r.UIMgr.getInstance().addUICnf(c.RSD_UICF),l.default.getInstance().load(function(){p.default.getInstance().preload(function(){r.UIMgr.getInstance().openUIOfCallback(c.RSD_UIID.UIGame,s.UIID.UINONE,function(){t&&t(),i.removeTouchEvent()})})},!0);else{var n=function(){i._isInited=!0,p.default.getInstance().reset(),r.UIMgr.getInstance().openUIOfCallback(c.RSD_UIID.UIGame,s.UIID.UINONE,function(){t&&t(),i.removeTouchEvent()})};this._isInited?n():(r.UIMgr.getInstance().addUICnf(c.RSD_UICF),l.default.getInstance().load(function(){p.default.getInstance().preload(function(){n()})}))}},t.prototype.exit_App=function(t){r.UIMgr.getInstance().closeById(c.RSD_UIID.UIGame),r.UIMgr.getInstance().closeById(c.RSD_UIID.UIResult),r.UIMgr.getInstance().closeById(c.RSD_UIID.UISetting),c.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],RSD_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"4df46ysWbFBGbFZ1ysNOMgR","RSD_Configs");var i,n,a,r=e,s=o;cc._RF.push(r,"4df46ysWbFBGbFZ1ysNOMgR","RSD_Configs"),Object.defineProperty(s,"__esModule",{value:!0}),s.Global=s.RSD_UICF=s.emRSDBundles=s.RSD_UIID=void 0,function(t){t.UIGame="RSD_UIGame",t.UIResult="RSD_UIResult",t.UISetting="RSD_UISetting"}(n=s.RSD_UIID||(s.RSD_UIID={})),function(t){t.prefabs="rsd_prefabs",t.audios="rsd_audios",t.imgs="rsd_imgs",t.configs="rsd_configs",t.configsB="rsd_configsB"}(a=s.emRSDBundles||(s.emRSDBundles={})),s.RSD_UICF=((i={})[n.UIGame]={prefab:"ui/RSD_UIGame",name:"RSD_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:a.prefabs},i[n.UIResult]={prefab:"ui/RSD_UIResult",name:"RSD_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:a.prefabs},i[n.UISetting]={prefab:"ui/RSD_UISetting",name:"RSD_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:a.prefabs},i);var c=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t.isBug=!1,t}();s.Global=c,cc._RF.pop(),cc._RF.pop()},{}],RSD_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"4637dU6MmZLvq3/rRqj0G5F","RSD_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"4637dU6MmZLvq3/rRqj0G5F","RSD_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("RSD_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}e?i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"zhuyapeng/dragon_RSD/configsB",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emRSDBundles.configsB,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()}):i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"zhuyapeng/dragon_RSD/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emRSDBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByType=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getCharacterLevelCfgByLevel=function(t){var e=this.data.characterLevelCfg;for(var o in e)if(e[o].Level==t)return e[o]},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getDragonLenghtByLevel=function(t,e){void 0===e&&(e=0);var o=this.data.levelCfg;for(var i in o)o[i].point==t&&e++;return e},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],RSD_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"41bc0I36r9PYrLT5I1HmXaw","RSD_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"41bc0I36r9PYrLT5I1HmXaw","RSD_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("RSD_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],RSD_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"9ae9c8sGQlLq7XHJHr4omjC","RSD_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"9ae9c8sGQlLq7XHJHr4omjC","RSD_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.onLoad=function(){cc.game.setFrameRate(59),cc.director.getPhysicsManager().enabled=!1,cc.director.getCollisionManager().enabled=!0},e.prototype.start=function(){cc.director.getCollisionManager().enabledDebugDraw=!1},c([u],e)}(l.default));a.default=d,cc._RF.pop(),cc._RF.pop()},{}],RSD_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"45852ZXW1FBgLg3yex8Mjwa","RSD_UserData");var i=t,n=e,a=o;cc._RF.push(n,"45852ZXW1FBgLg3yex8Mjwa","RSD_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"rsd_data",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],RUN2_Body:[function(t,e,o){"use strict";cc._RF.push(e,"d668cXcEgdGO4La0Ndbwc8o","RUN2_Body");var i=t,n=e,a=o;cc._RF.push(n,"d668cXcEgdGO4La0Ndbwc8o","RUN2_Body");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("RUN_Configs"),d=i("RUNGameEnumData"),h=i("RUN_DataMgr"),f=i("RUN2_bodyCtrl"),m=i("RUN2_boxCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.playerParent=null,e.box=null,e.hpParent=null,e.path=new Array,e.gapY=200,e.gapX=200,e.runpState=!1,e.skillState=!1,e.nowIndex=0,e.moveWidth=300,e.colliderArr=[],e.width=35,e.bodyArr=[],e.lastMoveTime=0,e.num=0,e.isFirst=!0,e.isLast=!1,e.boxTemp=null,e.isNext=!1,e.limitDt=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.script=this,this.createPath(),this.lastNode=this.head,this.addEvent(u.emRUNEventName.pause,this.stop),this.addEvent(u.emRUNEventName.skillPause,this.skillPause),this.addEvent(u.emRUNEventName.skillResume,this.skillResume),this.addEvent(u.emRUNEventName.resume,this.resume),this.moveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed),this.shouldMove=this.width,this.moveWidth=this.shouldMove},e.prototype.skillPause=function(){this.skillState=!0},e.prototype.skillResume=function(){this.skillState=!1},e.prototype.stop=function(){for(var t in this.runpState=!0,this.head.getComponent(f.default).stop(),this.bodyArr)this.bodyArr[t].getComponent(f.default)&&this.bodyArr[t].getComponent(f.default).stop()},e.prototype.resume=function(){for(var t in this.runpState=!1,this.head.getComponent(f.default).resume(),this.bodyArr)this.bodyArr[t].getComponent(f.default)&&this.bodyArr[t].getComponent(f.default).resume()},e.prototype.getTurn=function(){return new cc.Vec2(200,this.gapY/2)},e.prototype.createPath=function(){for(var t=this.animation.getClips()[0].curveData.props.position,e=0;e<t.length;e++){var o=t[e],i=cc.v2();cc.Vec2.fromArray(i,o.value),this.path.push(i)}},e.prototype.changeSpeed=function(t,e){var o=Number(e);this.moveSpeed=o},e.prototype.start=function(){this.head.zIndex=1e3,this.head.setPosition(this.path[0].x-200,this.path[0].y),this.head.getComponent(f.default).startRun(this.path,-1,0,0),this.bodyArr.push(this.head)},e.prototype.getHeadY=function(){return this.head.y},e.prototype.getHeadNode=function(){return this.head},e.prototype.createNode=function(t){this.isLast||(u.Global.isDirect?(this.shouldMove||(this.shouldMove=this.width),this.createBody()):(this.moveWidth-=this.moveSpeed*t,this.lastMoveTime+=Number(t.toFixed(4)),this.moveWidth<=0&&(this.moveWidth+=this.shouldMove,this.createBody())))},e.prototype.createBody=function(){this.num>=9&&!u.Global.canAttack&&(u.Global.canAttack=!0),this.num%8==0&&(this.boxTemp&&this.boxTemp.getComponent(m.default).setCanBeAttack(),this.boxTemp=p.PoolMgr.getInstance().getNode(u.poolName.box),this.boxTemp||(this.boxTemp=cc.instantiate(this.boxNode)),this.nowIndex++,this.boxTemp.parent=this.hpParent,this.boxTemp.active=!0);var t=this.nowIndex%4;this.checkLength()&&(t=4,this.isLast=!0);var e=this.boxTemp.getComponent(m.default),o=h.default.getInstance().getLevelCfgByID(this.nowIndex),i=p.PoolMgr.getInstance().getNode(u.poolName.body);i||(i=cc.instantiate(this.player)),i.active=!0,i.parent=this.playerParent,this.bodyArr.push(i);var n=i.getComponent(f.default);n.setPreNode(this.lastNode,this.shouldMove);var a=this.lastNode.getComponent(f.default).getIndex();this.num%8==0&&(this.lastMoveTime=0),n.startRun(this.path,t,0,a),this.lastNode=i,e.addOtherNode(i),this.num%4==0&&this.num%8!=0&&(this.checkLength(1)?e.initNode(i,o.dragonHp,this.nowIndex,!0):e.initNode(i,o.dragonHp,this.nowIndex,!1),this.colliderArr.push(this.boxTemp)),i.zIndex=2e3-this.num++,this.isFirst&&(this.isFirst=!1)},e.prototype.checkLength=function(t){return void 0===t&&(t=0),this.nowIndex>=h.default.getInstance().getLevelCfg().length-t},e.prototype.checkCollider=function(t,e,o,i,n,a,r,s){for(var c in this.colliderArr)if(Number(c)!=a&&this.colliderArr[c].getComponent(m.default).checkCollider(t,o,i,n,r,s))return Number(c);return-1},e.prototype.checkSkillCollider=function(t,e){for(var o in this.colliderArr)this.colliderArr[o].getComponent(m.default).checkSkillCollider(t,e)},e.prototype.update=function(t){if(!this.runpState&&!this.skillState)for(var e in this.createNode(t),this.bodyArr)this.bodyArr[e].getComponent(f.default).onUpdate(t,this.moveSpeed)},c([v(cc.Animation)],e.prototype,"animation",void 0),c([v(cc.Node)],e.prototype,"head",void 0),c([v(cc.Node)],e.prototype,"playerParent",void 0),c([v(cc.Node)],e.prototype,"box",void 0),c([v(cc.Node)],e.prototype,"hpParent",void 0),c([v(cc.Node)],e.prototype,"boxNode",void 0),c([v(cc.Node)],e.prototype,"player",void 0),c([v(cc.Node)],e.prototype,"bgNode",void 0),c([v({tooltip:"\u4fe9\u6392\u9f99\u4e4b\u95f4\u7684\u95f4\u9694"})],e.prototype,"gapY",void 0),c([v({tooltip:"\u8f6c\u5f2f\u5904\u79bb\u5c4f\u5e55\u7684\u8ddd\u79bb"})],e.prototype,"gapX",void 0),o=c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],RUN2_bodyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"0ced7YHH0JEJYXkwLMhw89j","RUN2_bodyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"0ced7YHH0JEJYXkwLMhw89j","RUN2_bodyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("RUN_Configs"),d=i("RUNGameEnumData"),h=i("RUN_DataMgr"),f=i("RUN_UIGame"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStart=!1,e.index=0,e.rungonSpeed=100,e.end=!1,e.sp=[],e.gapDt=.2,e.isRungon=!1,e.isLast=!1,e.baseTime=.5,e.resumeTime=.5,e.damageState=!1,e.posNum=2,e}var o;return s(e,t),o=e,e.prototype.startRun=function(t,e,o,i){this.isRungon=!1,4==e&&(this.isLast=!0),-1!=e?(this.changeSp(e),this.doAnimation(),this.destroyNode=p.PoolMgr.getInstance().getNode(u.poolName.destroy)):this.isRungon=!0,this.path=t,this.index=i,this.targetPos=this.path[this.index],this.isStart=!0,this.maxIndex=this.path.length-4,this.posNum=2},e.prototype.initIndex=function(){},e.prototype.stop=function(){this.isStart=!1,this.isRungon?this.node.getComponent(sp.Skeleton).clearTrack(0):this.spNode.getComponent(cc.Animation).pause()},e.prototype.resume=function(){this.isStart=!0,this.isRungon?this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0):this.spNode.getComponent(cc.Animation).resume()},e.prototype.changeSp=function(t){this.spNode.getComponent(cc.Sprite).spriteFrame=this.sp[t]},e.prototype.playAnimation=function(t){var e=this;this.scheduleOnce(function(){e.spNode.getComponent(cc.Animation).play(),e.spNode.getComponent(cc.Animation).play().clip.speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmni)},t)},e.prototype.doAnimation=function(){this.spNode.getComponent(cc.Animation).play("body"),this.spNode.getComponent(cc.Animation).play().clip.speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmni)},e.prototype.doDamage=function(){this.spNode.color=cc.color().fromHEX("#a60000"),this.resumeTime=this.baseTime,this.damageState=!0},e.prototype.reSumeDamage=function(){this.spNode.color=cc.Color.WHITE},e.prototype.resumeNode=function(t){0!=this.damageState&&(this.resumeTime-=t,this.resumeTime<0&&this.damageState&&(this.reSumeDamage(),this.damageState=!1))},e.prototype.informPre=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0),this.preNode&&(u.Global.isBug&&(this.node.active=!1),u.Global.isBug||this.node.active?this.preNode.getComponent(o).setNodePosition(this.node.getPosition(),this.index):this.preNode.getComponent(o).setNodePosition(t,e))},e.prototype.setNodePosition=function(t,e){var o=this;u.Global.isBug||this.informPre(t,e),this.index=e,this.targetPos=this.path[this.index],this.node.setPosition(t),u.Global.isBug&&this.informPre(t,e),this.isRungon&&"die"!=this.node.getComponent(sp.Skeleton).animation&&(this.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1),this.node.getComponent(sp.Skeleton).setCompleteListener(function(){o.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}))},e.prototype.getIndex=function(){return this.index},e.prototype.playDerunry=function(){var t=this;f.default.script.onScreenShake();var e=p.PoolMgr.getInstance().getNode(u.poolName.destroy);e||(e=cc.instantiate(this.destroyNode)),e.parent=f.default.script.getDestroyLayer(),e.setPosition(this.node.getPosition()),e.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){e.destroy()},.1)})},e.prototype.setPreNode=function(t,e){var o=t.position;o.x-=e,this.isLast&&(this.spNode.anchorX=.8,this.spNode.anchorY=.3),this.node.position=o,this.preNode=t},e.prototype.onLoad=function(){this.rungonSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed)},e.prototype.start=function(){var t=this;cc.game.on("gameEnd",function(){t.isStart=!1})},e.prototype.update=function(t){this.isStart&&this.resumeNode(t)},e.prototype.onUpdate=function(t,e){if(this.node.active&&!this.end&&this.isStart){var o=this.targetPos,i=this.node.getPosition();if(null!=o&&null!=i){var n=e*t,a=o.sub(i).mag(),r=o.sub(i).normalize().mul(n);this.node.setPosition(i.add(r)),(this.isRungon||this.isLast)&&(r.x<0?this.node.scaleX=-1:r.x>0&&(this.node.scaleX=1)),a<=n&&(this.node.setPosition(o),this.index++,this.index>=this.path.length?this.end=!0:this.targetPos=this.path[this.index])}}},c([y(cc.SpriteFrame)],e.prototype,"sp",void 0),c([y(cc.Node)],e.prototype,"spNode",void 0),o=c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],RUN2_boxCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1fe29VgsYNKYLYiLFdJQkVo","RUN2_boxCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1fe29VgsYNKYLYiLFdJQkVo","RUN2_boxCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("Utils"),h=i("RUN_Configs"),f=i("RUN_DataMgr"),m=i("RUN2_bodyCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.boxSpArr=[],e.otherNodes=[],e.isDie=!1,e.lastAttackIndex=0,e.hp=2,e.isLast=!1,e.canBeAttack=!1,e.isCreate=!1,e}return s(e,t),e.prototype.start=function(){this.canBeAttack=!1},e.prototype.setCanBeAttack=function(){this.canBeAttack=!0},e.prototype.initNode=function(t,e,o,i){var n=this;void 0===i&&(i=!1),this.scheduleOnce(function(){n.boxSp.node.active=!0,n.label.node.active=!0},.1),this.isLast=i,this.targetNode=t,this.hp=e,this.boxIndex=o,this.label.string=e.toString(),this.initBox(),this.blood=u.PoolMgr.getInstance().getNode(h.poolName.blood)},e.prototype.initBox=function(){f.default.getInstance().getLevelCfgByID(this.boxIndex).buffType&&(this.boxSp.spriteFrame=this.boxSpArr[1])},e.prototype.addOtherNode=function(t){this.otherNodes.push(t)},e.prototype.checkCollider=function(t,e,o,i,n,a){if(this.checkIsDie(),this.canBeAttack)return!this.isDie&&!!this.isInRange(t)&&(this.handleDamage(e,t,i,n,a),!0)},e.prototype.checkIsDie=function(){if(!this.isDie){var t=!1;for(var e in this.otherNodes)if(0==this.otherNodes[e].active){t=!0;break}t&&(this.node.active=!1),this.isDie=t}},e.prototype.checkSkillCollider=function(t,e){this.canBeAttack&&(this.isDie||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0))},e.prototype.isInRange=function(t){var e=this.targetNode.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hp-=s,this.hp<=0)this.sendEvent(h.emRUNEventName.blood,t,e,o),this.doDie();else for(;r--;)this.doDamage(t,this.getPos(e),o,a);p.AudioMgr.getInstance().playEffect(h.RUN_AudioId.rungonHit,h.RUN_AudioId.rungonHit)},e.prototype.getPos=function(t){var e=d.Utils.randomRang(-30,30),o=d.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(h.emRUNEventName.blood,t,e,o,i),this.label.string=Math.max(this.hp,0).toString(),this.otherNodes.forEach(function(t){t.getComponent(m.default).doDamage()})},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.doDie=function(){var t=this;p.AudioMgr.getInstance().playEffectFree(h.RUN_AudioId.burn,6),this.isDie=!0,this.node.active=!1,h.Global.isBug?this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(),e.active=!1,o%2&&e.getComponent(m.default).playDerunry()},.05*o)}):this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(e.getPosition(),e.getComponent(m.default).getIndex()),e.active=!1},.05*(9-o)),t.scheduleOnce(function(){o%2&&e.getComponent(m.default).playDerunry()},.05*o)}),this.isLast&&(this.sendEvent(h.emRUNEventName.pause),this.openUI(h.RUN_UIID.UIResult,!0)),this.spawnBuffItem()},e.prototype.spawnBuffItem=function(){this.isCreate||(this.isCreate=!0,this.sendEvent(h.emRUNEventName.buff,this.boxIndex))},e.prototype.update=function(){this.targetNode&&!this.isDie&&this.node.setPosition(this.targetNode.position)},c([v(cc.Label)],e.prototype,"label",void 0),c([v(cc.Sprite)],e.prototype,"boxSp",void 0),c([v(cc.SpriteFrame)],e.prototype,"boxSpArr",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],RUNGameData:[function(t,e,o){"use strict";cc._RF.push(e,"f56534ZXndOrKcrAK+Cw7G9","RUNGameData");var i=e,n=o;cc._RF.push(i,"f56534ZXndOrKcrAK+Cw7G9","RUNGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emRUNGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.girlMoveCfg="girlMoveCfg",t.levelCfg="levelCfg",t.mateCfg="mateCfg",t.wordsCfg="wordsCfg"}(n.emRUNGameDataKeys||(n.emRUNGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],RUNGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"bb601f7FjdN1rN+O64dbaLH","RUNGameEnumData");var i=e,n=o;cc._RF.push(i,"bb601f7FjdN1rN+O64dbaLH","RUNGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.girlMoveSpeed=15]="girlMoveSpeed",t[t.wordsTime=16]="wordsTime",t[t.wordShow=17]="wordShow",t[t.dieWordDistance=18]="dieWordDistance",t[t.girlPosition=19]="girlPosition",t[t.dragonMoveAmniTime=20]="dragonMoveAmniTime"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],RUN_App:[function(t,e,o){"use strict";cc._RF.push(e,"37f20IAjhdAloyHdyDLdbBr","RUN_App");var i=t,n=e,a=o;cc._RF.push(n,"37f20IAjhdAloyHdyDLdbBr","RUN_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("RUN_Configs"),p=i("RUN_DataMgr"),u=i("RUN_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;if(void 0===o&&(o=!1),l.Global.isDirect=o,this.addTouchEvent(),this._exitCall=e,o)s.UIMgr.getInstance().addUICnf(l.RUN_UICF),r.AudioMgr.getInstance().addAdConf(l.RUN_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){s.UIMgr.getInstance().openUIOfCallback(l.RUN_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.RUN_AudioId.bgm,l.RUNConfig.BgMusic)})})},!0);else{var n=function(){i._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.RUN_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.RUN_AudioId.bgm,l.RUNConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.RUN_UICF),r.AudioMgr.getInstance().addAdConf(l.RUN_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){n()})}))}},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.RUN_UIID.UIGame),s.UIMgr.getInstance().closeById(l.RUN_UIID.UIResult),s.UIMgr.getInstance().closeById(l.RUN_UIID.UISetting),l.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],RUN_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"57867m3MpREkqpCOavR4mll","RUN_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"57867m3MpREkqpCOavR4mll","RUN_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Utils"),u=i("RUN_Configs"),d=function(t,e){this.flag=t,this.num=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useState=!1,e.bloodArr=[],e.limitTime=3,e.showNum=10,e}return s(e,t),e.prototype.isCirt=function(t,e){t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e+""):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e+""),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=p.Utils.randomRang(-30,30),o=p.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){l.PoolMgr.getInstance().freeNode(u.poolName.blood,t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.x=0,this.node.y=0,this.node.opacity=255},e.prototype.inUse=function(){return this.useState},e.prototype.pushBlood=function(t,e){var o=new d(t,e);this.bloodArr.push(o)},e.prototype.showBlood=function(){for(var t=this.bloodArr.splice(0,this.showNum),e=0;e<t.length;e++){var o=t[e];this.isCirt(o.flag,o.num)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){(this.nowTime<0||!this.nowTime)&&(this.nowTime=this.limitTime,this.showBlood()),this.nowTime--},e.prototype.onDestroy=function(){this.bloodArr=[]},c([m(cc.Node)],e.prototype,"isCritState",void 0),c([m(cc.Label)],e.prototype,"critLabel",void 0),c([m(cc.Label)],e.prototype,"commonLabel",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],RUN_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"3757cNQHV5HEaxX6uCXFSu5","RUN_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"3757cNQHV5HEaxX6uCXFSu5","RUN_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("RUN_Configs"),d=i("RUNGameEnumData"),h=i("RUN_DataMgr"),f=i("RUN_UIGame"),m=i("RUN_Hero"),g=i("RUN_HeroCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.nodeObj1=new b,e.nodeObj2=new b,e.lock=!0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(t){this.node.active=!1;var e=h.default.getInstance().getLevelCfgByID(t);if(e){if(e.buffType)if(1==e.buffType){var o=this.getResult(),i=this.getResult(),n=this.getPropertyResultArr(o,i,e);(0==o||1==o||2==o)&&this.initPropertyNode(o,n[0],this.node1,this.nodeObj1),(0==i||1==i||2==i)&&this.initPropertyNode(i,n[1],this.node2,this.nodeObj2)}else if(2==e.buffType){if(0==(o=this.getResult())){var a=this.getPropertyResult(e.buff1,o);this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)}else 1==o?(a=this.getPropertyResult(e.buff2?e.buff2:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)):2==o&&(a=this.getPropertyResult(e.buff3?e.buff3:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1));var r=this.getNewRole();this.initNewNode(r[0],this.node2,this.nodeObj2)}else r=this.getNewRole(2),this.initNewNode(r[0],this.node1,this.nodeObj1),this.initNewNode(r[1],this.node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=u.Global.heroID.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getResult=function(){return Math.floor(Math.random()*u.Global.heroID.length)},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t));if(u.Global.heroID[e].node.getComponent(m.default).getAttackSpeedState())for(var i=0;i<o.length;i++)if(o[i].includes("speed")){o.splice(i,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=h.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);for(var i in u.Global.heroID){var n=o.indexOf(u.Global.heroID[i].id);-1!=n&&o.splice(n,1)}for(var a=Object.keys(o),r=[];t--;)i=Math.floor(Math.random()*a.length),r.push(o[a[i]]),a.splice(i,1);return r},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=u.Global.heroID[t].id;this.loadSpriteFrame(u.emRUNBundles.imgs,"js_b/tx_"+a,function(r){n.initPropertyView(o,r,e,a),n.lock=!1,n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=h.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=u.Global.heroID[t].node,c.buffType==u.emRUNBuffType.speedPlus?i.type=1:c.buffType==u.emRUNBuffType.ATKmul||c.buffType==u.emRUNBuffType.ATKplus?i.type=2:c.buffType==u.emRUNBuffType.penetratePlus?i.type=3:c.buffType==u.emRUNBuffType.bulletPlus?i.type=4:c.buffType==u.emRUNBuffType.critPlus?i.type=5:c.buffType==u.emRUNBuffType.skillMul&&(i.type=6)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=h.default.getInstance().getCharacterByID(i).characterName,p=h.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon");this.loadSpriteFrame(u.emRUNBundles.imgs,"js_b/tx_"+t,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.lock=!1,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=h.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffectFree(u.RUN_AudioId.buff),g.default.script.checkCollider()?this.nodeObj1.isNew?g.default.script.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?g.default.script.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.destroy()},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;1==o?e.getComponent(m.default).addAttackSpeed(t.addType,t.addNum):2==o?e.getComponent(m.default).addAttackPower(t.addType,t.addNum):3==o?e.getComponent(m.default).addAttackPenerate(t.addType,t.addNum):4==o?e.getComponent(m.default).addBulletCount(t.addType,t.addNum):5==o?e.getComponent(m.default).addCritChance(t.addType,t.addNum):6==o&&e.getComponent(m.default).addSkill(t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){o.script=this,this.addEvent(u.emRUNEventName.pause,this.runp),this.addEvent(u.emRUNEventName.resume,this.resume)},e.prototype.runp=function(){this.lock=!0},e.prototype.resume=function(){this.lock=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.lock||(this.node.y-=h.default.getInstance().getParam(d.enumBasicParaCfg.buffMove)*t*100,f.default.script.checkReWardLayer(this.node.y)&&this.doReward())},c([_(cc.Node)],e.prototype,"node1",void 0),c([_(cc.Node)],e.prototype,"node2",void 0),c([_(cc.SpriteFrame)],e.prototype,"sp",void 0),o=c([v],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],RUN_Bullet2:[function(t,e,o){"use strict";cc._RF.push(e,"11fe4+TKrxAtJNghCZ9nu+P","RUN_Bullet2");var i=t,n=e,a=o;cc._RF.push(n,"11fe4+TKrxAtJNghCZ9nu+P","RUN_Bullet2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("RUN_Configs"),d=i("RUN2_Body"),h=function(t,e,o){this.damage=t,this.isCrit=e,this.pos=o};a.damageObj=h;var f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDerunry=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e}return s(e,t),e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,h){if(void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===h&&(h=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDerunry=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.createNeedCheckY(),this.timer>1)for(var f in h)r=cc.instantiate(r),this.initNodeView(a,r,s,h[f]);else this.initNodeView(a,r,s)},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=d.default.script.getHeadY()-this.node.y},e.prototype.update=function(t){if(this.active&&!this.isDerunry){var e=this.flySpeed*t*100;if(this.node.y+=e,this.range-=e,this.needCheckY-=e,this.range<=0&&this.removeNode(),this.needCheckY<=0){var o=this.hit(),i=d.default.script.checkCollider(this.node.getPosition(),this.penetrate,o.damage,this.bulletIndex,o.isCrit,this.lastAttackID,this.timer,1!=this.timer);if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(u.emRUNEventName.GAD_Show_Hit_Effect,n),this.lastAttackID=i,this.onDie()}}}},e.prototype.hit=function(){return this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new h(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition())},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDerunry=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)p.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start()},e.prototype.render=function(){},e.prototype.runp=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],RUN_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"8f24dXvx3NO8rMptUU2h1HD","RUN_BulletEffect");var i=e,n=o;cc._RF.push(i,"8f24dXvx3NO8rMptUU2h1HD","RUN_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.show()},e.prototype.hide=function(){this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.node.active=!1,t.resetSystem()})},e.prototype.show=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],RUN_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"39b36Cog7pH9bMz/eWQflPU","RUN_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"39b36Cog7pH9bMz/eWQflPU","RUN_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.emRUNHitState=l.poolName=l.emRUNBuffType=l.emRUNGameState=l.emRUNRoleState=l.emRUNRoleType=l.emRUNEventName=l.RUN_AudioCF=l.RUN_AudioId=l.RUN_UICF=l.RUNConfig=l.emRUNBundles=l.RUN_UIID=void 0,function(t){t.UIGame="RUN_UIGame",t.UIResult="RUN_UIResult",t.UISetting="RUN_UISetting"}(a=l.RUN_UIID||(l.RUN_UIID={})),function(t){t.prefabs="run_prefabs",t.audios="run_audios",t.imgs="run_imgs",t.configs="run_configs",t.configsB="run_configsB"}(r=l.emRUNBundles||(l.emRUNBundles={})),l.RUNConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.RUN_UICF=((i={})[a.UIGame]={prefab:"ui/RUN_UIGame",name:"RUN_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/RUN_UIResult",name:"RUN_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/RUN_UISetting",name:"RUN_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.doubleSword="doubleSword",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.rungonHit="dragonHit",t.rake="rake",t.typhoon="typhoon",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.girlDie="girlDie",t.word1="word1",t.word2="word2",t.word3="word3",t.word4="word4",t.word5="word5",t.word6="word6"}(s=l.RUN_AudioId||(l.RUN_AudioId={})),l.RUN_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.rungonHit]={path:"dragonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.girlDie]={path:"girlDie",bundle:r.audios},n[s.word1]={path:"word1",bundle:r.audios},n[s.word2]={path:"word2",bundle:r.audios},n[s.word3]={path:"word3",bundle:r.audios},n[s.word4]={path:"word4",bundle:r.audios},n[s.word5]={path:"word5",bundle:r.audios},n[s.word6]={path:"word6",bundle:r.audios},n),function(t){t.GAD_Player_Die="run_gad_player_die",t.GAD_Shoot_Bullet="run_gad_shoot_bullet",t.GAD_Show_Hit_Text="run_gad_show_hit_text",t.GAD_Show_Warn="run_gad_show_warn",t.GAD_Bubble_Buf="run_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="run_gad_hit_effect",t.GAD_Show_Buff_Tip="run_gad_show_buff_tip",t.GAD_Setting_Back="run_gad_setting_back",t.pause="run_pause",t.resume="run_resume",t.skillPause="run_skillPause",t.skillResume="run_skillResume",t.buff="run_buff",t.blood="run_blood",t.newTarm="run_newTarm"}(l.emRUNEventName||(l.emRUNEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emRUNRoleType||(l.emRUNRoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emRUNRoleState||(l.emRUNRoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emRUNGameState||(l.emRUNGameState={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emRUNBuffType||(l.emRUNBuffType={})),function(t){t.blood="run_blood",t.destroy="run_destroy",t.effect="run_effect",t.box="run_box",t.body="run_body",t.run_item="run_item",t.run_bullet="run_bullet"}(l.poolName||(l.poolName={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emRUNHitState||(l.emRUNHitState={}));var p=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t.isBug=!1,t}();l.Global=p,cc._RF.pop(),cc._RF.pop()},{}],RUN_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"e5b83wn1DhBZr0VeVnep4+1","RUN_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"e5b83wn1DhBZr0VeVnep4+1","RUN_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),i("HttpMgr");var s=i("ResourceMgr"),c=i("RUN_Configs"),l=cc._decorator,p=l.ccclass,u=(l.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1),this._isRemote,s.ResourceMgr.getInstance().loadRes(c.emRUNBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getWordCfg=function(){return this.data.wordsCfg},t.prototype.getGirlMoveByDistance=function(t){var e=this.data.girlMoveCfg;for(var o in e)if(e[o].distance==t)return e[o]},e=r([p],t)}());a.default=u,cc._RF.pop(),cc._RF.pop()},{}],RUN_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"54db7VrWixMiKtl7MTXFx9D","RUN_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"54db7VrWixMiKtl7MTXFx9D","RUN_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RUN_Configs"),u=i("RUN_Hero"),d=i("RUN_Target"),h=i("RUN_TarmCtrl"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t,e){this.id=t,this.node=e},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;o.script=this,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.heroRoot.x+=o})},e.prototype.heroMove=function(t){this.heroRoot.x+=t},e.prototype.test=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPower(2,5);else if("speed"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackSpeed(1,4);else if("penerate"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPenerate(1,1);else if("fire"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).changeFire()}else this.addHero(Number(e))},e.prototype.addHero=function(t){var e=this;if(p.Global.heroID.length>=3)console.error("\u4e0d\u5141\u8bb8\u52a0\u5165\u8d85\u8fc7\u4e09\u4e2a\u82f1\u96c4");else{p.Global.heroID||(p.Global.heroID=[]),this.node.getComponent(h.default).pushCard(t);var o=cc.instantiate(this.heorNode);o.active=!0,o.parent=this.node;var i=new y(t,o);p.Global.heroID.push(i),o.getComponent(u.default).initHero(t),this.scheduleOnce(function(){e.checkOverSide()},.01)}},e.prototype.clearHero=function(){p.Global.heroID=[]},e.prototype.getMaxDamage=function(t,e){var o=0;for(var i in p.Global.heroID)p.Global.heroID[i].id!=t&&p.Global.heroID[i].id!=e||(o=Math.max(p.Global.heroID[i].node.getComponent(u.default).getAttackPower(),o));return o},e.prototype.checkOverSide=function(){this.heroRoot.x+this.node.width/2>cc.winSize.width/2?this.heroRoot.x=cc.winSize.width/2-this.node.width/2:this.heroRoot.x-this.node.width/2<-cc.winSize.width/2&&(this.heroRoot.x=-cc.winSize.width/2+this.node.width/2)},e.prototype.checkCollider=function(){return this.node.x<0},e.prototype.start=function(){},e.prototype.createTarget=function(){new d.Target(100)},c([g(cc.Node)],e.prototype,"heroRoot",void 0),c([g(cc.Node)],e.prototype,"heorNode",void 0),o=c([m],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],RUN_Hero:[function(t,e,o){"use strict";cc._RF.push(e,"a813dipoTRNyIwtJX/ZNu/e","RUN_Hero");var i=t,n=e,a=o;cc._RF.push(n,"a813dipoTRNyIwtJX/ZNu/e","RUN_Hero");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("RUN_Configs"),h=i("RUNGameEnumData"),f=i("RUN_DataMgr"),m=i("RUN_UIGame"),g=i("RUN_Bullet2"),y=i("RUN_BulletEffect"),v=i("RUN_SkillCtrl"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.firing=!1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.bullets=[],e.skillTimer=0,e.skillMultiplier=0,e.attackGap=1,e.maxSpeed=12,e.noInFactSpeed=5,e.lastFireTime=0,e.fireCooldown=.5,e.audioID=0,e}return s(e,t),e.prototype.initHero=function(t){this.initParm(t),this.initView(t),this.heroIndex=t,this.addEvent(d.emRUNEventName.pause,this.doPause),this.addEvent(d.emRUNEventName.resume,this.doResume)},e.prototype.initParm=function(t){1==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.basicATK):2==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.secondCharATK):3==d.Global.heroID.length&&(this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.thirdCharATK)),this.attackSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.basicASPD),this.bulletCount=f.default.getInstance().getParam(h.enumBasicParaCfg.basicBullet),this.penetrate=f.default.getInstance().getParam(h.enumBasicParaCfg.basicPenetrate),this.flySpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.bulletFlySpeed),this.critChance=f.default.getInstance().getParam(h.enumBasicParaCfg.basicCrit),this.critMultiplier=f.default.getInstance().getParam(h.enumBasicParaCfg.critDamage);var e=f.default.getInstance().getCharacterByID(t);this.skillInterval=e.skillCDtime,this.skillMultiplier=e.skillATK,this.skillEffect=e.skillSound},e.prototype.initView=function(t){var e=this;this.loadPrefab(d.emRUNBundles.prefabs,"bullets/RUN_Bullet_"+t,function(o){e.poolName="bullet"+t,u.PoolMgr.getInstance().creatrePool(e.poolName,cc.instantiate(o)),e.bulletPrefab=o,e.startFiring()});var o=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emRUNBundles.imgs,"backs/"+o.cardColor,function(t){e.itemBg.spriteFrame=t}),this.loadSpriteFrame(d.emRUNBundles.imgs,"js/js_"+t,function(t){e.itemIcon.spriteFrame=t}),this.loadSpriteFrame(d.emRUNBundles.imgs,"skill/"+o.skillIcon,function(t){e.itemSkill.spriteFrame=t}),this.loadPrefab(d.emRUNBundles.prefabs,"skills/CardSkill"+t,function(o){e.heroSkill=cc.instantiate(o),11==t&&e.loadPrefab(d.emRUNBundles.prefabs,"skills/CardSkill"+t,function(){})}),this.itemName.string=o.characterName},e.prototype.startFiring=function(){this.firing=!0},e.prototype.runpFiring=function(){this.firing=!1},e.prototype.changeFire=function(){this.firing=!this.firing},e.prototype.useSkill=function(){var t=m.default.script.getSkillLayer(),e=this.bulletPos.getPosition(),o=this.bulletPos.convertToWorldSpaceAR(e);return e=t.convertToNodeSpaceAR(o),v.default.script.useSkill(this.heroIndex,this.attackPower*this.skillMultiplier,this.heroSkill,e)},e.prototype.addAttackPower=function(t,e){this.addBuffTween(),1==t?this.attackPower+=e:this.attackPower*=e},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.addAttackSpeed=function(t,e){this.addBuffTween(),this.getAttackSpeedState()||(this.attackSpeedMultiplier+=e/f.default.getInstance().getParam(h.enumBasicParaCfg.speedPlusTimes))},e.prototype.getAttackSpeedState=function(){return this.attackSpeedMultiplier>=this.maxSpeed},e.prototype.addAttackPenerate=function(t,e){this.addBuffTween(),1==t?this.penetrate+=e:this.penetrate*=e},e.prototype.addCritChance=function(t,e){this.addBuffTween(),1==t?this.critChance+=e:2==t?this.critChance*=e:3==t&&(this.critChance>=1?this.addBulletCount(1,1):this.critChance+=e)},e.prototype.addSkill=function(t,e){this.addBuffTween(),1==t?this.skillMultiplier+=e:this.skillMultiplier*=e},e.prototype.addBulletCount=function(t,e){this.addBuffTween(),1==t?this.bulletCount+=e:this.bulletCount*=e},e.prototype.addBuffTween=function(){var t=this;this.addBuffSp.opacity=255,this.addBuffSp.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.addBuffSp.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.addBuffSp.opacity=0},.1)})},e.prototype.getAttackSpeed=function(){return this.attackSpeed/this.attackSpeedMultiplier},e.prototype.updateSkillView=function(){this.skillPercent.fillRange=this.skillTimer/this.skillInterval},e.prototype.update=function(t){var e=this;this.firing&&d.Global.canAttack&&(this.nowAttackTime+=t,this.skillTimer+=t,this.updateSkillView(),this.skillTimer>=this.skillInterval&&this.useSkill()&&(this.skillSp.opacity=255,p.AudioMgr.getInstance().playEffect(this.skillEffect,this.skillEffect),this.skillSp.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.skillSp.getComponent(sp.Skeleton).setCompleteListener(function(){e.scheduleOnce(function(){e.skillSp.opacity=0},.1)}),this.skillTimer=0),this.attackGap-=t,this.nowAttackTime-this.lastAttackTime>this.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime,this.attackGap=1))},e.prototype.fireBullets=function(){p.AudioMgr.getInstance().playEffect(d.RUN_AudioId.bullet,"bullet"+this.heroIndex+this.audioID),this.audioID=(this.audioID+1)%5;var t=m.default.script.getBulletLayer(this.heroIndex),e=this.bulletPos.getPosition();this.attackSpeedMultiplier<this.noInFactSpeed||1==this.bulletCount?this.creatInfactBullet(t,e):this.creatNoInfactBullet(t,e)},e.prototype.creatInfactBullet=function(t,e){for(var o=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,i=0;i<this.bulletCount;i++){var n=new cc.Vec2(e.x-o,e.y);o+=30;var a=this.bulletPos.convertToWorldSpaceAR(n);n=t.convertToNodeSpaceAR(a);var r=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab);(u.PoolMgr.getInstance().getNode(d.poolName.run_bullet)||cc.instantiate(this.bullet)).getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,n,r,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier)}},e.prototype.creatNoInfactBullet=function(t,e){for(var o=[],i=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,n=0;n<this.bulletCount;n++){var a=new cc.Vec2(0-i,0);i+=30,o.push(a)}var r=u.PoolMgr.getInstance().getNode(d.poolName.run_bullet)||cc.instantiate(this.bullet),s=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab),c=this.bulletPos.convertToWorldSpaceAR(e),l=t.convertToNodeSpaceAR(c);r.getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,l,s,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier,this.bulletCount,o)},e.prototype.pushBullet=function(t){t.getComponent(y.default).hide(),this.bullets.push(t)},e.prototype.doPause=function(){this.runpFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).runp()},e.prototype.doResume=function(){this.startFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).resume()},c([B(cc.Prefab)],e.prototype,"bullet",void 0),c([B(cc.Node)],e.prototype,"bulletPos",void 0),c([B(cc.Node)],e.prototype,"skillSp",void 0),c([B(cc.Node)],e.prototype,"addBuffSp",void 0),c([B(cc.Label)],e.prototype,"itemName",void 0),c([B(cc.Sprite)],e.prototype,"itemBg",void 0),c([B(cc.Sprite)],e.prototype,"itemIcon",void 0),c([B(cc.Sprite)],e.prototype,"itemSkill",void 0),c([B(cc.Sprite)],e.prototype,"skillPercent",void 0),c([B(cc.Node)],e.prototype,"windSp",void 0),c([B(cc.Node)],e.prototype,"thunderSp",void 0),c([B(cc.Node)],e.prototype,"vagueSp",void 0),c([B(cc.Node)],e.prototype,"iceSp",void 0),c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],RUN_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"41fff1hWe9IVYOFVJ5keub9","RUN_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"41fff1hWe9IVYOFVJ5keub9","RUN_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("RUN_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],RUN_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"89ffeDZB4pCEYQ3G+BlFi6U","RUN_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"89ffeDZB4pCEYQ3G+BlFi6U","RUN_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RUN_Configs"),u=i("RUN_Skill"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){return!this.isSkill&&(this.isSkill=!0,this.showBanner(t),o.parent=this.node,o.getComponent(u.default).useSkill(i,e,t),!0)},e.prototype.showBanner=function(t){var e=this;this.loadSpriteFrame(p.emRUNBundles.imgs,"banner/banner"+t,function(t){e.banner.getComponent(cc.Sprite).spriteFrame=t,e.banner.active=!0}),cc.tween(this.banner).by(.5,{x:this.banner.width}).delay(.5).by(.5,{x:-this.banner.width}).call(function(){e.isSkill=!1,e.banner.active=!1}).start()},e.prototype.onLoad=function(){o.script=this,this.banner.x=-cc.winSize.width/2-this.banner.width/2},e.prototype.start=function(){},e.prototype.update=function(){},c([f(cc.Label)],e.prototype,"label",void 0),c([f(cc.Node)],e.prototype,"banner",void 0),c([f],e.prototype,"text",void 0),o=c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RUN_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"868a6JOqRNGyY4y7wkjhQlI","RUN_Skill");var i=t,n=e,a=o;cc._RF.push(n,"868a6JOqRNGyY4y7wkjhQlI","RUN_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RUN2_Body"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){"attack"==o.data.name&&(t.animationDuration=e.animation.duration)})},e.prototype.useSkill=function(t,e,o){var i=this;if(this.index=o,this.skillSpeed=this.speed,1==o){this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-300),this.spAni.setAnimation(0,"hit",!1);var n=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){i.doAttack()},n-.65),this.offHeight=300}else 6==o?(this.canMove=!1,this.node.setPosition(t.x,l.default.script.getHeadY()),this.spAni.setAnimation(0,"hit",!1),n=this.spAni.getCurrent(0).animation.duration,this.scheduleOnce(function(){i.doAttack()},n-.6)):8==o?(this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)):11==o?(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!1),this.sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)):(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0));this.damage=e,this.flyDis=l.default.script.getHeadY()-this.node.y},e.prototype.update=function(){var t=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed,this.flyDis-=this.skillSpeed,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){t.sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),t.sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.spAni.setAnimation(0,"hit",!1),this.doAttack()))},e.prototype.doAttack=function(){l.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([d({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([d({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([d({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],RUN_Target:[function(t,e,o){"use strict";cc._RF.push(e,"a8606JVkE9N5bs+0ve+X9R7","RUN_Target");var i=e,n=o;cc._RF.push(i,"a8606JVkE9N5bs+0ve+X9R7","RUN_Target"),Object.defineProperty(n,"__esModule",{value:!0}),n.Target=void 0;var a=function(){function t(t){this.health=t}return t.prototype.takeDamage=function(t){this.health-=t,console.log("Target takes "+t+" damage! Remaining health: "+this.health),this.health<=0&&this.destroy()},t.prototype.destroy=function(){console.log("Target destroyed!")},t}();n.Target=a,cc._RF.pop(),cc._RF.pop()},{}],RUN_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"61276kSKghLoohj8Vy0l2bV","RUN_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"61276kSKghLoohj8Vy0l2bV","RUN_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("RUN_Configs"),u=i("RUN_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tarmMap=new Map,e.isTureTarmMap=new Map,e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.sendEvent(p.emRUNEventName.newTarm,e[0],this.delayTime),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],RUN_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"45eb2HNYOhP9JVe46V0CY6a","RUN_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"45eb2HNYOhP9JVe46V0CY6a","RUN_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("RUN_Configs"),f=i("RUN_BloodCtrl"),m=i("RUN_BuffCtrl"),g=i("RUN_mateCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.buffLayer=null,e.bloodLayer=null,e.hitLayer=null,e.blood=null,e.pauseLayer=null,e.closeNode=null,e.skillLayer=null,e.banner=null,e.bannerSp=[],e.maxLength=50,e.hpIndex=0,e.hpArr=[],e.tipPools=[],e.maxShowCount=50,e.lastShowTime=0,e.throttleTime=.2,e}return s(e,t),e.prototype.onLoad=function(){p.PoolMgr.getInstance().creatrePool(h.poolName.effect,this.hitEffect,5),p.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2),this.createHpArr(this.maxLength),this.initSystemListen()},e.prototype.createHpArr=function(t){for(;t--;){var e=p.PoolMgr.getInstance().getNode(h.poolName.blood)||cc.instantiate(this.blood);this.hpArr.push(e)}},e.prototype.initSystemListen=function(){var t=this;h.Global.isDirect||cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){t.pauseLayer&&e.keyCode==cc.macro.KEY.space&&(t.pauseLayer.active?(t.pauseLayer.active=!1,t.sendEvent(h.emRUNEventName.resume)):(t.pauseLayer.active=!0,t.sendEvent(h.emRUNEventName.pause)))})},e.prototype.start=function(){var t=this;this.addEvent(h.emRUNEventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(h.emRUNEventName.GAD_Show_Warn,this.playWarn),this.addEvent(h.emRUNEventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(h.emRUNEventName.buff,this.showBuff),this.addEvent(h.emRUNEventName.blood,this.showLoseLabel),this.addEvent(h.emRUNEventName.newTarm,this.showNewTarm),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(h.emRUNEventName.pause),h.Global.isDirect?u.UIMgr.getInstance().openUI(h.RUN_UIID.UISetting,d.UIID.UINONE,function(e){e&&t.sendEvent(h.emRUNEventName.resume)}):t.pauseLayer.active=!0}),this.pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active&&(t.sendEvent(h.emRUNEventName.resume),t.pauseLayer.active=!1)}),this.closeNode.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active=!1,u.UIMgr.getInstance().openUI(h.RUN_UIID.UISetting,d.UIID.UINONE,function(e){e&&t.sendEvent(h.emRUNEventName.resume)})})},e.prototype.onShowHitText=function(t,e){var o,i=this;(o=this.tipPools.length>0?this.tipPools.pop():cc.instantiate(this.ndTipRoot.children[0])).parent=this.ndTipRoot,o.active=!0,o.getComponent(cc.Label).string=(t>0?"+":"")+t,o.color=t>0?cc.color().fromHEX("#0bff16"):cc.color().fromHEX("#ff4e49");var n=this.ndTipRoot.convertToNodeSpaceAR(cc.v2(e.x,e.y));o.setPosition(n.x,n.y),o.opacity=255,cc.tween(o).by(.3,{y:80}).to(.1,{opacity:0}).call(function(){o.removeFromParent(),i.tipPools.push(o)}).start()},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.ndWarn),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.ndWarn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.ndWarn),t.ndWarn.active=!1}).start()},e.prototype.showHitEffect=function(t){var e=this.node.convertToNodeSpaceAR(t),o=p.PoolMgr.getInstance().getNode(h.poolName.effect)||cc.instantiate(this.hitEffect);o.parent=this.hitLayer,o.setPosition(e),o.active=!0,o.opacity=255,o.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.active=!1,p.PoolMgr.getInstance().freeNode("pbt_hit_effect",o)})},e.prototype.showBuff=function(t){var e=this;this.loadPrefab(h.emRUNBundles.prefabs,"item/buff",function(o){var i=cc.instantiate(o);i.parent=e.buffLayer,i.getComponent(m.default).initNode(t)})},e.prototype.showLoseLabel=function(t,e,o,i){if(void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),!(this.bloodLayer.children.length>=this.maxShowCount)||i){var n=cc.director.getTotalTime();if(!(n-this.lastShowTime<this.throttleTime)||i){this.lastShowTime=n;var a=p.PoolMgr.getInstance().getNode(h.poolName.blood);a.parent||(a.parent=this.bloodLayer);var r=a.getComponent(f.default);r.resumeNode(),a.setPosition(e.x,e.y+40),r.isCirt(o,t)}}},e.prototype.showNewTarm=function(t,e){var o=this;this.loadPrefab(h.emRUNBundles.prefabs,"item/mateIcon",function(e){var i=cc.instantiate(e);i.parent=o.skillLayer,i.getComponent(g.default).initNode(t)}),this.showBanner(t,e)},e.prototype.showBanner=function(t,e){var o=this;this.banner.getComponent(cc.Sprite).spriteFrame=this.bannerSp[t],cc.tween(this.banner).by(e/2,{x:this.banner.width}).delay(e/2).call(function(){o.banner.x=-cc.winSize.width/2-o.banner.width/2}).start()},c([_(cc.Node)],e.prototype,"ndTipRoot",void 0),c([_(cc.Node)],e.prototype,"ndWarn",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"hitEffect",void 0),c([_(cc.Node)],e.prototype,"ndBuffImg",void 0),c([_(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([_(cc.Sprite)],e.prototype,"spBack",void 0),c([_(cc.Node)],e.prototype,"buffLayer",void 0),c([_(cc.Node)],e.prototype,"bloodLayer",void 0),c([_(cc.Node)],e.prototype,"hitLayer",void 0),c([_(cc.Node)],e.prototype,"blood",void 0),c([_(cc.Node)],e.prototype,"pauseLayer",void 0),c([_(cc.Node)],e.prototype,"closeNode",void 0),c([_(cc.Node)],e.prototype,"skillLayer",void 0),c([_(cc.Node)],e.prototype,"banner",void 0),c([_(cc.SpriteFrame)],e.prototype,"bannerSp",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],RUN_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"d6bf57fDsRJo7+3xOcPLd7/","RUN_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"d6bf57fDsRJo7+3xOcPLd7/","RUN_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RUN_Configs"),u=i("RUN_DataMgr"),d=i("PoolMgr"),h=i("AudioMgr"),f=i("RUNGameEnumData"),m=i("SdkMgr"),g=i("PlatformSetting"),y=i("BasePlatform"),v=i("RUN_HeroCtrl"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.sprBgSup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.heroRoot=null,e.ndFence=null,e.content=null,e.item=null,e.bulletLayer=null,e.rewardLayer=null,e.bloodLayer=null,e.destroyLayer=null,e.startNode=null,e.skillLayer=null,e.dieLayer=null,e.gmNode=null,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this.ndCardGroup.getComponent(v.default);t||console.error("error!!!!!!!!"),t.clearHero(),p.Global.canAttack=!1,p.Global.bulletID=0,t.addHero(this.getNewRole()),o.script=this,this.createNodePool(),this.doStart()},e.prototype.setGmNode=function(){(m.SdkMgr.getInstance().getCheckVersion(g.SwitchID.ShenHe_ABD)||g.PlatformSetting.currentPlatform==y.Platform.EDITOR||g.PlatformSetting.currentPlatform==y.Platform.WEB_LINK)&&(this.gmNode.active=!0)},e.prototype.doStart=function(){var t=this;h.AudioMgr.getInstance().playEffectFree(p.RUN_AudioId.mission),this.startNode.active=!0,this.startNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.startNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.startNode.active=!1},.1)})},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=u.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);return o[Math.floor(Math.random()*o.length)]},e.prototype.getWallPosY=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.y},e.prototype.getWallPos=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.getPosition()},e.prototype.start=function(){this.initEvents()},e.prototype.createNodePool=function(){this.loadPrefab(p.emRUNBundles.prefabs,"item/blood",function(t){var e=cc.instantiate(t);d.PoolMgr.getInstance().creatrePool(p.poolName.blood,e)}),this.loadPrefab(p.emRUNBundles.prefabs,"item/destroy",function(t){var e=cc.instantiate(t);d.PoolMgr.getInstance().creatrePool(p.poolName.destroy,e)}),this.loadPrefab(p.emRUNBundles.prefabs,"item/box",function(t){var e=cc.instantiate(t);d.PoolMgr.getInstance().creatrePool(p.poolName.box,e)}),this.loadPrefab(p.emRUNBundles.prefabs,"item/body",function(t){var e=cc.instantiate(t);d.PoolMgr.getInstance().creatrePool(p.poolName.body,e)}),this.loadPrefab(p.emRUNBundles.prefabs,"item/run_item",function(t){var e=cc.instantiate(t);d.PoolMgr.getInstance().creatrePool(p.poolName.run_item,e)}),this.loadPrefab(p.emRUNBundles.prefabs,"item/run_bullet",function(t){var e=cc.instantiate(t);d.PoolMgr.getInstance().creatrePool(p.poolName.run_bullet,e)})},e.prototype.initEvents=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.ndCardGroup.getComponent(v.default).heroMove(o)})},e.prototype.getBulletLayer=function(t){var e="layer"+t;return this.bulletLayer.getChildByName(e)},e.prototype.getAllBullet=function(){var t=[];for(var e in this.bulletLayer.children)for(var o in this.bulletLayer.children[e].children)t.push(this.bulletLayer.children[e].children[o])},e.prototype.getDestroyLayer=function(){return this.destroyLayer},e.prototype.getSkillLayer=function(){return this.skillLayer},e.prototype.checkReWardLayer=function(t){return this.rewardLayer.y>t},e.prototype.addHero=function(){},e.prototype.update=function(){},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.sprBgSup);var t=u.default.getInstance().getParam(f.enumBasicParaCfg.quake);cc.tween(this.sprBgSup).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-1*t,-1*t)}).by(.05,{position:cc.v3(2*t,1*t)}).by(.05,{position:cc.v3(-2*t,0*t)}).by(.05,{position:cc.v3(2*t,-1*t)}).by(.05,{position:cc.v3(-1*t,1*t)}).set({position:cc.v3(0,0)}).start()},c([B(cc.Node)],e.prototype,"ndCardGroup",void 0),c([B(cc.Node)],e.prototype,"sprBgSup",void 0),c([B(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([B(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([B(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([B(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([B(cc.Node)],e.prototype,"heroRoot",void 0),c([B(cc.Node)],e.prototype,"ndFence",void 0),c([B(cc.Node)],e.prototype,"content",void 0),c([B(cc.Node)],e.prototype,"item",void 0),c([B(cc.Node)],e.prototype,"bulletLayer",void 0),c([B(cc.Node)],e.prototype,"rewardLayer",void 0),c([B(cc.Node)],e.prototype,"bloodLayer",void 0),c([B(cc.Node)],e.prototype,"destroyLayer",void 0),c([B(cc.Node)],e.prototype,"startNode",void 0),c([B(cc.Node)],e.prototype,"skillLayer",void 0),c([B(cc.Node)],e.prototype,"dieLayer",void 0),c([B(cc.Node)],e.prototype,"gmNode",void 0),o=c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],RUN_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"fa9e9y4WUdLMb1maNb1e/uJ","RUN_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"fa9e9y4WUdLMb1maNb1e/uJ","RUN_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RUN_Configs"),u=i("RUN_App"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e.isDirect=null,e.unDirect=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t,this.isDirect.active=p.Global.isDirect,this.unDirect.active=!p.Global.isDirect},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([f(cc.Label)],e.prototype,"lblBar",void 0),c([f(cc.Sprite)],e.prototype,"spBar",void 0),c([f(cc.Node)],e.prototype,"ndWin",void 0),c([f(cc.Node)],e.prototype,"ndFail",void 0),c([f(cc.Node)],e.prototype,"ndTop",void 0),c([f(cc.Node)],e.prototype,"ndBar",void 0),c([f(cc.Node)],e.prototype,"btn",void 0),c([f(cc.Node)],e.prototype,"btnPlay",void 0),c([f(cc.Label)],e.prototype,"lblRwd",void 0),c([f(cc.Node)],e.prototype,"isDirect",void 0),c([f(cc.Node)],e.prototype,"unDirect",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],RUN_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"a047b6jKqlL5rIeMlJ0Pvhm","RUN_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"a047b6jKqlL5rIeMlJ0Pvhm","RUN_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("RUN_Configs"),m=i("RUN_App"),g=i("RUN_UIGame"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t,this.isDirect.active=f.Global.isDirect,this.unDirect.active=!f.Global.isDirect},e.prototype.onEnable=function(){this.musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&g.default.script.setGmNode()}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){m.default.instance.exit_App(0)}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([_(cc.Slider)],e.prototype,"musicSlider",void 0),c([_(cc.Slider)],e.prototype,"effectSlider",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([_(cc.Node)],e.prototype,"btnBackHome",void 0),c([_(cc.Node)],e.prototype,"isDirect",void 0),c([_(cc.Node)],e.prototype,"unDirect",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Node)],e.prototype,"gmNode",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],RUN_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"f40e3dkfUdKoZMEk6RhbYcw","RUN_UserData");var i=t,n=e,a=o;cc._RF.push(n,"f40e3dkfUdKoZMEk6RhbYcw","RUN_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"gad_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],RUN_girlCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"9a084UzVS1Fa5KcgwGcYbq/","RUN_girlCtrl");var i=t,n=e,a=o;cc._RF.push(n,"9a084UzVS1Fa5KcgwGcYbq/","RUN_girlCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseUI"),u=i("AudioMgr"),d=i("ResourceMgr"),h=i("RUN_Configs"),f=i("RUNGameEnumData"),m=i("RUN_DataMgr"),g=i("RUN2_Body"),y=i("RUN2_bodyCtrl"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.banner=null,e.label=null,e.path=new Array,e.moveSpeed=0,e.index=0,e.runState=!0,e.gapTime=0,e.nowGapTime=0,e.showTime=0,e.state="idle",e.dangerousDis=0,e}return s(e,t),e.prototype.createPath=function(){for(var t=this.animation.getClips()[0].curveData.props.position,e=0;e<t.length;e++){var o=t[e],i=cc.v2();cc.Vec2.fromArray(i,o.value),this.path.push(i)}},e.prototype.initParam=function(){this.index=m.default.getInstance().getParam(f.enumBasicParaCfg.girlPosition),this.targetPos=this.path[this.index],this.runState=!0,this.headNode=g.default.script.getHeadNode(),this.showTime=m.default.getInstance().getParam(f.enumBasicParaCfg.wordsTime),this.nowGapTime=this.showTime,this.gapTime=m.default.getInstance().getParam(f.enumBasicParaCfg.wordShow),this.dangerousDis=m.default.getInstance().getParam(f.enumBasicParaCfg.dieWordDistance)},e.prototype.initView=function(){this.node.setPosition(this.path[this.index])},e.prototype.stop=function(){this.runState=!1},e.prototype.resume=function(){this.runState=!0},e.prototype.handleIndex=function(){var t=this.headNode.getComponent(y.default).getIndex(),e=this.index-t>4?4:this.index-t;this.setState(e),this.changeSpeed(e)},e.prototype.changeSpeed=function(t){t<=0||(this.moveSpeed=m.default.getInstance().getGirlMoveByDistance(t).girlMove)},e.prototype.setState=function(t){t<=0?this.doLose():t<=this.dangerousDis?(this.state==l.idle&&this.showBanner(this.getStr().wordContent),this.state=l.dangerous):this.state=l.idle},e.prototype.doLose=function(){this.state!=l.die&&(this.state=l.die,this.sendEvent(h.emRUNEventName.pause),this.showBanner(this.getStr().wordContent))},e.prototype.doIdle=function(t){this.nowGapTime-=t,this.nowGapTime<=0&&(this.nowGapTime=this.gapTime,this.showBanner(this.getStr().wordContent))},e.prototype.showBanner=function(t){var e=this;this.banner.active=!0,this.label.string=t,this.unschedule(this.hideBanner),this.scheduleOnce(function(){e.state==l.die&&e.openUI(h.RUN_UIID.UIResult),e.hideBanner()},this.showTime)},e.prototype.hideBanner=function(){this.banner.active=!1},e.prototype.getStr=function(){var t,e,o=this,i=m.default.getInstance().getWordCfg();this.state==l.idle?(e=Math.floor(4*Math.random()),t=h.RUN_AudioId["word"+(e+1)]):this.state==l.dangerous?(t=h.RUN_AudioId.word5,e=4):this.state==l.die&&(t=h.RUN_AudioId.word6,e=5);var n=u.AudioMgr.getInstance().getAdConf(t);return d.ResourceMgr.getInstance().loadRes(n.bundle,n.path,cc.AudioClip,function(e){o.showTime=e.duration,u.AudioMgr.getInstance().playEffect(t)}),i[e]},e.prototype.onLoad=function(){this.createPath(),this.initParam(),this.initView(),this.addEvent(h.emRUNEventName.pause,this.stop),this.addEvent(h.emRUNEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){if(this.runState){var e=this.targetPos,o=this.node.getPosition();if(null!=e&&null!=o){this.state==l.idle&&this.doIdle(t),this.handleIndex();var i=this.moveSpeed*t,n=e.sub(o).mag(),a=e.sub(o).normalize().mul(i);this.node.setPosition(o.add(a)),a.x<0?(this.node.scaleX=-.5,this.label.node.scaleX=-.4):a.x>0&&(this.node.scaleX=.5,this.label.node.scaleX=.4),n<=i&&(this.node.setPosition(e),this.index++,this.index>=this.path.length?(this.sendEvent(h.emRUNEventName.pause),this.openUI(h.RUN_UIID.UIResult,!0)):this.targetPos=this.path[this.index])}}},c([b(cc.Animation)],e.prototype,"animation",void 0),c([b(cc.Node)],e.prototype,"banner",void 0),c([b(cc.Label)],e.prototype,"label",void 0),c([_],e)}(p.default);a.default=B,function(t){t.idle="idle",t.dangerous="dangerous",t.die="die"}(l||(l={})),cc._RF.pop(),cc._RF.pop()},{}],RUN_mateCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"ff0abNjJDlE7r0UlOZI4pNm","RUN_mateCtrl");var i=t,n=e,a=o;cc._RF.push(n,"ff0abNjJDlE7r0UlOZI4pNm","RUN_mateCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Config"),u=i("RUN_Configs"),d=i("RUN_DataMgr"),h=i("RUN_HeroCtrl"),f=i("RUN_mateSkillCtrl"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e.maxCDTime=0,e.cdTime=0,e.mateSkillAttack=1,e.mateID=1,e.isPause=!1,e}return s(e,t),e.prototype.initNode=function(t){this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=this,e=d.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=e.mateCDtime,this.mateSkillAttack=e.mateSkillATK,this.loadPrefab(u.emRUNBundles.prefabs,"skills/mateSkill"+this.mateID,function(e){t.skillNode=cc.instantiate(e)})},e.prototype.initView=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID);this.skillLabel.string=t.mateName,this.cdPercent.fillRange=0,this.skillIcon.spriteFrame=this.getSpriteByName(),this.cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){if(this.cdTime<=0){var t=d.default.getInstance().getMateCfgByID(this.mateID),e=Number(t.mateRole.split(",")[0]),o=Number(t.mateRole.split(",")[1]);f.default.script.useSkill(this.mateID,h.default.script.getMaxDamage(e,o)*t.mateSkillATK,this.skillNode,new cc.Vec2(0,0))&&this.initStartUseSkill()}else this.openUI(p.UIID.UITips,"\u6280\u80fd\u6b63\u5728cd")},e.prototype.initStartUseSkill=function(){this.cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.cdLabel.string=this.cdTime+"",this.cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.cdLabel.node.active=!1,this.spNode.node.active=!0,this.spNode.setAnimation(0,"animation",!1),this.spNode.setCompleteListener(function(){e.spNode.node.active=!1})):this.cdLabel.string=this.cdTime.toFixed(0)},e.prototype.getSpriteByName=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID).mateIconRes;for(var e in this.spArr)if(t==this.spArr[e].name)return this.spArr[e]},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.onLoad=function(){this.addEvent(u.emRUNEventName.pause,this.pause),this.addEvent(u.emRUNEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.cdTime>0&&!this.isPause&&this.refreshSkillView(t)},c([y(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([y(cc.Label)],e.prototype,"cdLabel",void 0),c([y(cc.Label)],e.prototype,"skillLabel",void 0),c([y(cc.Sprite)],e.prototype,"cdPercent",void 0),c([y(cc.Sprite)],e.prototype,"skillIcon",void 0),c([y(sp.Skeleton)],e.prototype,"spNode",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],RUN_mateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"34fb9SrZdpFhbqekKtz+/wT","RUN_mateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"34fb9SrZdpFhbqekKtz+/wT","RUN_mateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("RUN_mateSkill"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){var n=this;return!this.isSkill&&(this.isSkill=!0,this.scheduleOnce(function(){n.isSkill=!1},.5),o.parent=this.node,o.getComponent(p.default).useSkill(i,e,t),!0)},e.prototype.onLoad=function(){o.script=this},e.prototype.start=function(){},e.prototype.update=function(){},c([h(cc.Label)],e.prototype,"label",void 0),c([h(cc.Node)],e.prototype,"banner",void 0),c([h],e.prototype,"text",void 0),o=c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],RUN_mateSkill:[function(t,e,o){"use strict";cc._RF.push(e,"5e983WVJs5CyLEtmkNyZjSb","RUN_mateSkill");var i=t,n=e,a=o;cc._RF.push(n,"5e983WVJs5CyLEtmkNyZjSb","RUN_mateSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("RUN_Configs"),d=i("RUN_DataMgr"),h=i("RUN2_Body"),f=i("RUN_Hero"),m=i("RUN_HeroCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){if("attack"==o.data.name){var i=d.default.getInstance().getMateCfgByID(t.index);if(3==t.index)p.EventMgr.getInstance().emit(u.emRUNEventName.skillPause),t.scheduleOnce(function(){p.EventMgr.getInstance().emit(u.emRUNEventName.skillResume)},Number(i.matePara));else if(1==t.index)for(var n in u.Global.heroID)1!=u.Global.heroID[n].id&&7!=u.Global.heroID[n].id||u.Global.heroID[n].node.getComponent(f.default).addAttackSpeed(1,Number(i.matePara));else if(2==t.index){var a=m.default.script.getMaxDamage(4,8),r=Math.floor(a*Number(i.matePara));for(var n in u.Global.heroID)4!=u.Global.heroID[n].id&&8!=u.Global.heroID[n].id||u.Global.heroID[n].node.getComponent(f.default).addAttackPower(1,r)}else if(4==t.index)for(var n in u.Global.heroID)if(6==u.Global.heroID[n].id||8==u.Global.heroID[n].id){var s=Math.floor(2*Math.random()),c=Number(i.matePara.split(",")[s]);c<1?u.Global.heroID[n].node.getComponent(f.default).addCritChance(3,c):u.Global.heroID[n].node.getComponent(f.default).addBulletCount(1,c)}t.doAttack()}})},e.prototype.useSkill=function(t,e,o){var i=d.default.getInstance().getMateCfgByID(o);l.AudioMgr.getInstance().playEffect(i.mateSound),this.index=o,this.spAni.setAnimation(0,"animation",!1),this.node.setPosition(t.x,h.default.script.getHeadY()),this.damage=e},e.prototype.update=function(){},e.prototype.doAttack=function(){h.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([v({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([v({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([v({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([y],e)}(cc.Component);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],ResCacheMgr:[function(t,e,o){"use strict";cc._RF.push(e,"9b2e1znp0JK1pwthkWLQinF","ResCacheMgr");var i=t,n=e,a=o;cc._RF.push(n,"9b2e1znp0JK1pwthkWLQinF","ResCacheMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.ResCacheMgr=void 0;var c=i("BaseMgr"),l=i("TimeUtils"),p=i("UIUtils"),u=i("ResourceMgr"),d=function(t){function e(){var e=t.call(this)||this;return e.temporaryCache=[],e.permanentCache=[],e.isStartDecRef=!1,e.assetsLifeTime=5,e.permanentCacheKeyMap=new Map,e.depsdeps=[],e}return s(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.init=function(){this.startDecRef()},e.prototype.startDecRef=function(){this.isStartDecRef||(this.isStartDecRef=!0,p.UIUtils.schedule(this.autoRelease,this,1))},e.prototype.autoRelease=function(){for(var t=l.TimeUtils.GetTimeBySecond(),e=0;e<this.temporaryCache.length;e++){var o=this.temporaryCache[e];if(o&&t-o.releaseTime>=o.cacheTime){if(o.defCount<=0)continue;for(var i=o.defCount,n=0;n<i;n++)if(o.asset.decRef(),o.asset.refCount<=0){this.temporaryCache.splice(e,1),e--,o.defCount=0;break}o.asset.refCount>0&&(o.releaseTime=l.TimeUtils.GetTimeBySecond()+86400)}else o&&0==o.asset.refCount&&(this.temporaryCache.splice(e,1),e--,o.defCount=0)}},e.prototype.refreshTime=function(t){for(var e=l.TimeUtils.GetTimeBySecond(),o=0;o<t.length;o++)for(var i=0;i<this.temporaryCache.length;i++){var n=t[o],a=this.temporaryCache[i];if(n.cachekey==a.cachekey&&n.type==a.type){this.temporaryCache[i].releaseTime=e,this.temporaryCache[i].defCount+=n.defCount,this.temporaryCache[i].canRelease=!1;break}}},e.prototype.addAssets=function(t,e){if(t&&t.asset){var o=e?this.temporaryCache:this.permanentCache,i=this.isExistKey(t.cachekey,t.type,o);-1==i?o.push(t):o[i]=t}},e.prototype.addAssetKeyToMap=function(t,e,o,i){var n=this.permanentCacheKeyMap.get(t),a=new u.ResCacheKey(e,o,i);if(n&&n.length>0)n.push(a);else{var r=[];r.push(a),this.permanentCacheKeyMap.set(t,r)}},e.prototype.releaseAssetsFromMap=function(t){var e=this.permanentCacheKeyMap.get(t);if(e&&e.length>0)for(var o=0;o<e.length;o++)for(var i=0;i<this.permanentCache.length;i++){var n=this.permanentCache[i];if(n&&n.cachekey==e[o].cachekey&&n.type==e[o].type){n.asset.decRef(),n.asset.refCount<=0&&(this.permanentCache.splice(i,1),i--);break}}},e.prototype.getAssets=function(){return null},e.prototype.isExistKey=function(t,e,o){for(var i=0;i<o.length;i++){var n=o[i];if(n&&n.cachekey==t&&n.type==e)return i}return-1},e.prototype.visitAsset=function(t,e){if(t._uuid)e.push(t._uuid);else if(t instanceof cc.SpriteFrame){var o,i=t;i._original?(o=i._original._texture)&&e.push(o._uuid):(o=i.getTexture())&&e.push(o._uuid)}},e.prototype.visitComponent=function(t,e){for(var o=Object.getOwnPropertyNames(t),i=0;i<o.length;i++){var n=o[i];if("node"!==n&&"__eventTargets"!==n){var a=t[n];if(a instanceof cc.NodePool)this.visitNodePool(a,e);else if("object"==typeof a&&a)if(Array.isArray(a))for(var r=0;r<a.length;r++)(c=a[r])instanceof cc.Asset&&this.visitAsset(c,e);else if(a.constructor&&a.constructor!==Object)a instanceof cc.Asset&&this.visitAsset(a,e);else{var s=Object.getOwnPropertyNames(a);for(r=0;r<s.length;r++){var c;(c=a[s[r]])instanceof cc.Asset&&this.visitAsset(c,e)}}}}},e.prototype.visitNode=function(t,e){for(var o=0;o<t._components.length;o++)this.visitComponent(t._components[o],e);for(o=0;o<t._children.length;o++)this.visitNode(t._children[o],e)},e.prototype.visitNodePool=function(t,e){for(var o=t._pool,i=0;i<o.length;i++){var n=o[i];this.visitNode(n,e)}},e.instance=null,e}(c.default);a.ResCacheMgr=d,cc._RF.pop(),cc._RF.pop()},{}],ResourceMgr:[function(t,e,o){"use strict";cc._RF.push(e,"739ffLu5WtLUq8HGmuiTmxM","ResourceMgr");var i=t,n=e,a=o;cc._RF.push(n,"739ffLu5WtLUq8HGmuiTmxM","ResourceMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.ResourceMgr=a.BundleCache=a.ResCacheKey=a.ResCache=void 0;var r=i("BasePlatform"),s=i("ArgsParseUtils"),c=i("TimeUtils"),l=i("LogMgr"),p=i("PlatformManager"),u=i("PoolMgr"),d=i("ResCacheMgr"),h=function(){function t(t,e,o,i,n,a){this.releaseTime=o,this.cacheTime=i,this.asset=a,this.type=cc.js.getClassName(n),this.cachekey=t+"/"+e,this.defCount=0,this.lifeTime=3,this.createTime=c.TimeUtils.GetTimeBySecond(),this.canRelease=!0}return t.prototype.setLifeTime=function(t){this.lifeTime=t},t}();a.ResCache=h,a.ResCacheKey=function(t,e,o){this.defCount=0,this.type=cc.js.getClassName(o),this.cachekey=t+"/"+e,this.defCount=1},a.BundleCache=function(t,e,o){this.bundleName=t,this.dateTime=e,this.cacheTime=o};var f=function(){function t(){this.scount=0}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.getBundle=function(t){return cc.assetManager.getBundle(t)},t.prototype.loadBundle=function(t,e){var o=this,i=cc.assetManager.getBundle(t);null==i?cc.assetManager.loadBundle(t,function(i,n){if(i)return setTimeout(function(){o.scount++,o.scount>10?o.scount=0:o.loadBundle(t,function(t){e(t)})},1e3),void l.LogMgr.getInstance().error(t+"bundle load error :"+i);o.scount=0,l.LogMgr.getInstance().debug("\u52a0\u8f7dbundle:"+t),e(n)}):e(i)},t.prototype.preloadFromBundle=function(t,e,o){t.preload(e,cc.Asset,function(t,e){o&&o(t,e)})},t.prototype.preload=function(t,e){var o=cc.assetManager.getBundle(t);o?e&&o.preload(e):cc.assetManager.loadBundle(t,function(t,o){t||e&&o.preload(e)})},t.prototype.getNode=function(e,o,i,n,a){void 0===a&&(a=1);var r=u.PoolMgr.getInstance().getNode(e);r&&r.isValid?n&&n(r):t.instance.loadRes(o,i,cc.Prefab,function(t){var o=cc.instantiate(t.data);u.PoolMgr.getInstance().checkHasPool(e)||u.PoolMgr.getInstance().creatrePool(e,cc.instantiate(o),a),n&&n(o)})},t.prototype.relLoadBundle=function(t,e){for(var o=function(o){var n=t[o];i.loadBundle(n,function(t){if(e){var i=e.get(o);t.load(i)}})},i=this,n=0;n<t.length;n++)o(n)},t.prototype.loadFromRes=function(t,e,o){this.loadRes("resources",t,e,o)},t.prototype.loadDirFrom=function(t,e){this.loadDir("resources",t,e)},t.prototype.loadSpriteframe=function(){var e=this,o=s.ArgsParseUtils._makeloadSpriteFrameResrgs.apply(this,arguments),i=o.bundle,n=o.path,a=o.callback,r=o.saveKey,p=c.TimeUtils.GetTimeBySecond()+86400,u=cc.assetManager.getBundle(i),f=new h(i,n,p,o.cacheTme,cc.SpriteFrame);null==u?t.getInstance().loadBundle(i,function(t){t.load(n,cc.SpriteFrame,function(t,s){if(t)return setTimeout(function(){e.scount++,e.scount>10?e.scount=0:e.loadSpriteframe(i,n,a,o.autoRelese,o.cacheTme,r)},1e3),void l.LogMgr.getInstance().error("loadres error path:"+n+"  error:",t.message);e.scount=0,s.addRef(),f.asset=s,d.ResCacheMgr.getInstance().addAssets(f,o.autoRelese),r&&d.ResCacheMgr.getInstance().addAssetKeyToMap(r,i,n,cc.SpriteFrame),a&&a(s)})}):u.load(n,cc.SpriteFrame,function(t,s){if(t)return setTimeout(function(){e.scount++,e.scount>10?e.scount=0:e.loadSpriteframe(i,n,a,o.autoRelese,o.cacheTme,r)},1e3),void l.LogMgr.getInstance().error("loadres error path:"+n+"  error:"+t);e.scount=0,s.addRef(),f.asset=s,d.ResCacheMgr.getInstance().addAssets(f,o.autoRelese),r&&d.ResCacheMgr.getInstance().addAssetKeyToMap(r,i,n,cc.SpriteFrame),a&&a(s)})},t.prototype.loadRemoteSpriteFrame=function(t,e,o,i){void 0===o&&(o=!1),void 0===i&&(i=10);var n=c.TimeUtils.GetTimeBySecond()+86400,a=new h("",t,n,i,cc.Texture2D);t.startsWith("http")&&(p.PlatformManager.currentPlatform==r.Platform.BYTEDANCE?cc.assetManager.loadRemote(t,{ext:".head"},function(t,i){if(!t){i.addRef(),a.asset=i,d.ResCacheMgr.getInstance().addAssets(a,o);var n=new cc.SpriteFrame(i);e(n)}}):cc.assetManager.loadRemote(t,function(t,i){if(!t){i.addRef(),a.asset=i,d.ResCacheMgr.getInstance().addAssets(a,o);var n=new cc.SpriteFrame(i);e(n)}}))},t.prototype.loadRes=function(){var e=this,o=s.ArgsParseUtils._makeLoadResArgs.apply(this,arguments),i=o.bundle,n=o.path,a=o.type,r=o.callback,p=o.saveKey;if("cc.Asset"!=cc.js.getClassName(a)){var u=c.TimeUtils.GetTimeBySecond()+86400,f=cc.assetManager.getBundle(i),m=new h(i,n,u,o.cacheTme,a);null==f?t.getInstance().loadBundle(i,function(t){t.load(n,a,function(t,s){if(t)return setTimeout(function(){e.scount++,e.scount>10?e.scount=0:e.loadRes(i,n,a,r,o.autoRelese,o.cacheTme,p)},1e3),void l.LogMgr.getInstance().error("loadres error path:"+n+"  error:",t.message);e.scount=0,s.addRef(),m.asset=s,d.ResCacheMgr.getInstance().addAssets(m,o.autoRelese),p&&d.ResCacheMgr.getInstance().addAssetKeyToMap(p,i,n,a),r&&r(s)})}):f.load(n,a,function(t,s){if(t)return setTimeout(function(){e.scount++,e.scount>10?e.scount=0:e.loadRes(i,n,a,r,o.autoRelese,o.cacheTme,p)},1e3),void l.LogMgr.getInstance().error("loadres error path:"+n+"  error:"+t);e.scount=0,s.addRef(),m.asset=s,d.ResCacheMgr.getInstance().addAssets(m,o.autoRelese),p&&d.ResCacheMgr.getInstance().addAssetKeyToMap(p,i,n,a),r&&r(s)})}else console.error("\u8bf7\u4f20\u5165\u5177\u4f53\u8d44\u6e90\u7c7b\u578b\uff0c\u4e0d\u80fd\u662f\u57fa\u7c7basset,\u8def\u5f84:",i+"/"+n)},t.prototype.loadDir=function(t,e,o){var i=this,n=cc.assetManager.getBundle(t);null==n?cc.assetManager.loadBundle(t,function(n,a){a.loadDir(e,cc.Asset,function(n,a){if(n)return setTimeout(function(){i.scount++,i.scount>10?i.scount=0:i.loadDir(t,e,o)},1e3),void l.LogMgr.getInstance().error("loadres error path:"+e+"  error:"+n);i.scount=0,o&&o(a)})}):n.loadDir(e,cc.Asset,function(n,a){if(n)return setTimeout(function(){i.scount++,i.scount>10?i.scount=0:i.loadDir(t,e,o)},1e3),void l.LogMgr.getInstance().error("loadres error path:"+e+"  error:"+n);i.scount=0,o&&o(a)})},t.prototype.releaseByBundle=function(t,e){t.release(e)},t.prototype.releaseByBname=function(t,e){var o=cc.assetManager.getBundle(t);o&&o.release(e)},t.prototype.releaseBundle=function(t){var e=cc.assetManager.getBundle(t);e&&cc.assetManager.removeBundle(e)},t.instance=null,t}();a.ResourceMgr=f,cc._RF.pop(),cc._RF.pop()},{}],RoleCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c589aYfqPFAm7hjVyiMLluZ","RoleCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c589aYfqPFAm7hjVyiMLluZ","RoleCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RSD_DataMgr"),p=i("CameraCtrl"),u=i("DragonCtrl"),d=i("GameSpawnCtrl"),h=i("MapCtrl"),f=i("WeaponCtrl"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.body=null,e.count=null,e.enetyCount=0,e.state="idle",e.speed=4,e.angle=1e3,e.baseR=250,e.dragonAction=!0,e.level=0,e.levelBar=0,e.exNum=0,e.rewardNum=0,e.blocked=!1,e}var o;return s(e,t),o=e,e.getInstance=function(){return this.instance},e.prototype.onLoad=function(){o.instance=this,o.instance.body=this.body,this.node.setPosition(cc.Vec2.ZERO),this.initParm()},e.prototype.initParm=function(){this.levelBar=l.default.getInstance().getCharacterLevelCfgByLevel(this.level+1).requiredExp,this.rewardNum=l.default.getInstance().getCharacterLevelCfgByLevel(this.level+1).rewardNum},e.prototype.moveHero=function(t){1e3==t?(this.body.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),this.state="idle"):("idle"==this.state&&this.body.getComponent(sp.Skeleton).setAnimation(0,"move",!0),this.state="move"),this.angle=t},e.prototype.goBack=function(t){this.body.scaleX=t>=0?1:-1},e.prototype.checkDragon=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),e=[],o=u.default.instance.getColliderItemArr(t,200);return e.push.apply(e,o),e},e.prototype.checkAttack=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),e=[],o=d.default.instance.getTreesNearPlayer(t,200);return e.push.apply(e,o),this.enetyCount=e.length,e},e.prototype.checkPresent=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO);d.default.instance.getSwordNearPlayer(t,100)},e.prototype.distanceSquared=function(t,e,o,i){return Math.sqrt(Math.pow(i-e,2)+Math.pow(o-t,2))},e.prototype.move=function(t,e){this.blocked||h.default.instance.checkNode(t,e)},e.prototype.blockMove=function(){this.node.stopAllActions()},e.prototype.checkTreeCollision=function(){var t=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO);this.blocked=!1;var e=[],o=d.default.instance.getTreesNearPlayer(t,100);e.push.apply(e,o);for(var i=0,n=e;i<n.length;i++){var a=n[i].tree.convertToWorldSpaceAR(cc.Vec3.ZERO),r=t.sub(a),s=r.mag();if(s<100){this.blocked=!0;var c=r.normalize().mul(100-s);this.node.x+=c.x,this.node.y+=c.y}}},e.prototype.levelUP=function(){this.exNum++,this.exNum>=this.levelBar&&(this.level++,f.default.instance.resetWeaponAddNum(this.level,this.rewardNum),this.exNum=0,this.initParm())},e.prototype.update=function(){if(this.checkAttack(),this.checkDragon(),"idle"!=this.state){var t=Math.cos(this.angle*Math.PI/180)*this.speed,e=Math.sin(this.angle*Math.PI/180)*this.speed;this.body.parent.x+=t,this.body.parent.y+=e,this.move(t,e),d.default.instance.updatePlayerTile(new cc.Vec3(this.node.position.x,this.node.position.y,0)),p.default.instance.moveCamera(new cc.Vec2(this.node.position.x,this.node.position.y)),this.checkPresent(),this.checkTreeCollision()}},c([y(cc.Node)],e.prototype,"body",void 0),c([y(cc.Label)],e.prototype,"count",void 0),o=c([g],e)}(cc.Component);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],SFHttpHelp:[function(t,e,o){"use strict";cc._RF.push(e,"e5509NTxI9Bc4+tQGq7GZhF","SFHttpHelp");var i=e,n=o;cc._RF.push(i,"e5509NTxI9Bc4+tQGq7GZhF","SFHttpHelp");var a,r=function(t,e,o,i){return new(o||(o=Promise))(function(n,a){function r(t){try{c(i.next(t))}catch(t){a(t)}}function s(t){try{c(i.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(r,s)}c((i=i.apply(t,e||[])).next())})},s=function(t,e){var o,i,n,a,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(a){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(n=(n=r.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){r.label=a[1];break}if(6===a[0]&&r.label<n[1]){r.label=n[1],n=a;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(a);break}n[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{o=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.emResponseType=void 0,function(t){t.Text="text",t.ArrayBuffer="arraybuffer",t.Blob="blob",t.Document="document",t.Json="json"}(a=n.emResponseType||(n.emResponseType={}));var c=function(){function t(){}return Object.defineProperty(t,"inst",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.convertQuerys=function(t,e){if(e)if(-1==t.indexOf("?")&&(t+="?"),"object"==typeof e){var o=[];for(var i in e)o.push(i+"="+encodeURIComponent(e[i]));t+=o.join("&")}else"string"==typeof e&&(t+=e);return t},t.prototype.toFormdata=function(t){if("object"==typeof t){var e=[];for(var o in t)e.push(o+"="+encodeURIComponent(t[o]));return e.join("&")}return"string"==typeof t?t:""},t.prototype.createXhr=function(t,e,o,i){var n=new XMLHttpRequest;if(i?(n.timeout=i.timeout||1e4,n.withCredentials=i.withCredentials||!1,n.responseType=i.responseType||a.Text):n.timeout=5e3,n.open(e,t,!0),o)for(var r in o)n.setRequestHeader(r,o[r]);else n.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=utf-8");return cc.sys.isNative&&n.setRequestHeader("Accept-Encoding","gzip,deflate"),n},t.prototype.sendHttp=function(t,e){return new Promise(function(o,i){t.onabort=function(){i&&i("abort error")},t.onerror=function(){i&&i("error error")},t.ontimeout=function(){i&&i("time out")},t.onreadystatechange=function(){if(4===t.readyState){var e=t.status;0===e||e>=200&&e<400?t.responseType==a.Text?o(t.responseText):o(t.response):i&&i(t.response)}},t.send(e||null)})},t.prototype.get=function(t,e,o,i,n){t=this.convertQuerys(t,e);var a=this.createXhr(t,"GET",i,n);return this.sendHttp(a,o)},t.prototype.post=function(t,e,o,i,n){t=this.convertQuerys(t,e);var a=this.createXhr(t,"POST",i,n);return this.sendHttp(a,o)},t.prototype.postJsonData=function(t,e,o,i,n){return void 0===o&&(o=null),(n=n||{}).responseType||(n.responseType=a.Json),this.post(t,o,this.toFormdata(e),i,n)},t.prototype.postJsonDataResult=function(t,e,o,i,n){return void 0===o&&(o=null),r(this,void 0,void 0,function(){var a,r;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.postJsonData(t,e,o,i,n)];case 1:return(a=s.sent())&&0===a.code?[2,JSON.parse(a.data)]:[3,3];case 2:return r=s.sent(),console.log(r),[3,3];case 3:return[2,null]}})})},t._instance=null,t}();n.default=c,cc._RF.pop(),cc._RF.pop()},{}],SODGameData:[function(t,e,o){"use strict";cc._RF.push(e,"0dc2bkyMqxCub0q/JlSUMJY","SODGameData");var i=e,n=o;cc._RF.push(i,"0dc2bkyMqxCub0q/JlSUMJY","SODGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emSODGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffPositionCfg="buffPositionCfg",t.buffTypeCfg="buffTypeCfg",t.enemyCfg="enemyCfg",t.levelCfg="levelCfg",t.prefabCfg="prefabCfg",t.soilderCfg="soilderCfg"}(n.emSODGameDataKeys||(n.emSODGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],SODGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"321aaDBwTxArZTr9QZxFiJL","SODGameEnumData");var i=e,n=o;cc._RF.push(i,"321aaDBwTxArZTr9QZxFiJL","SODGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBasicParaCfg=void 0,function(t){t[t.barrierOne=1]="barrierOne",t[t.barrierTwo=2]="barrierTwo",t[t.barrierThree=3]="barrierThree",t[t.soldierMadeTime=4]="soldierMadeTime",t[t.gravityPara=5]="gravityPara",t[t.frictionPara=6]="frictionPara",t[t.elasticityPara=7]="elasticityPara",t[t.baseHp=8]="baseHp",t[t.enemyBaseHp=9]="enemyBaseHp",t[t.angularPara=10]="angularPara",t[t.repeatBuffTime=11]="repeatBuffTime",t[t.pipeCreateTime=12]="pipeCreateTime",t[t.bulletSpeed=13]="bulletSpeed",t[t.bossAtkTarget=14]="bossAtkTarget"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),cc._RF.pop(),cc._RF.pop()},{}],SOD_APP:[function(t,e,o){"use strict";cc._RF.push(e,"a2dd72j7qZPlr3HnCCOOg4W","SOD_APP");var i=t,n=e,a=o;cc._RF.push(n,"a2dd72j7qZPlr3HnCCOOg4W","SOD_APP"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("EventMgr"),c=i("UIMgr"),l=i("Config"),p=i("SOD_Configs"),u=i("SOD_DataMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),cc.director.getPhysicsManager().enabled=!0,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(t){t.keyCode==cc.macro.KEY.space&&s.EventMgr.getInstance().emit(p.SOD_EventName.sod_space)}),this.addTouchEvent(),this._exitCall=e;var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(p.SOD_UIID.UIGame,l.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(p.SOD_AudioId.bgm,"BraveTowerBG")})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(p.SOD_UICF),r.AudioMgr.getInstance().addAdConf(p.SOD_AudioCF),u.default.getInstance().load(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.director.getPhysicsManager().enabled=!1,cc.systemEvent.clear(),c.UIMgr.getInstance().closeById(p.SOD_UIID.UIGame),c.UIMgr.getInstance().closeById(p.SOD_UIID.UIResult),c.UIMgr.getInstance().closeById(p.SOD_UIID.UISetting),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],SOD_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"ace2e9yMpZNJrqHhHQNcZ8A","SOD_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"ace2e9yMpZNJrqHhHQNcZ8A","SOD_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.SOD_TextCfg=l.SOD_ItemState=l.SOD_FactoryType=l.SOD_ItemType=l.SOD_GameState=l.buffType=l.SOD_PoolName=l.SOD_EventName=l.SOD_AudioCF=l.SOD_AudioId=l.SOD_UICF=l.emSODBundles=l.SOD_UIID=void 0,function(t){t.UIGame="SOD_UIGame",t.UIResult="SOD_UIResult",t.UISetting="SOD_UISetting"}(a=l.SOD_UIID||(l.SOD_UIID={})),function(t){t.prefabs="sod_prefabs",t.configs="sod_configs",t.imgs="sod_imgs",t.audios="sod_audios"}(r=l.emSODBundles||(l.emSODBundles={})),l.SOD_UICF=((i={})[a.UIGame]={prefab:"ui/SOD_UIGame",name:"SOD_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/SOD_UIResult",name:"SOD_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/SOD_UISetting",name:"SOD_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.beastattack="beastattack",t.claw="claw",t.hit="hit",t.manattack="manattack",t.spit="spit",t.sword="sword",t.throw="throw",t.treasure="treasure",t.levelup="levelup"}(s=l.SOD_AudioId||(l.SOD_AudioId={})),l.SOD_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.beastattack]={path:"beastattack",bundle:r.audios},n[s.claw]={path:"claw",bundle:r.audios},n[s.hit]={path:"hit",bundle:r.audios},n[s.manattack]={path:"manattack",bundle:r.audios},n[s.spit]={path:"spit",bundle:r.audios},n[s.sword]={path:"sword",bundle:r.audios},n[s.throw]={path:"throw",bundle:r.audios},n[s.treasure]={path:"treasure",bundle:r.audios},n[s.levelup]={path:"levelup",bundle:r.audios},n),function(t){t.sod_space="sod_space",t.sod_pause="sod_pause",t.sod_resume="sod_resume",t.sod_changeWave="sod_changeWave",t.sod_changeEnemyNum="sod_changeEnemyNum",t.sod_ballEffect="sod_ballEffect",t.sod_showBanner="sod_showBanner"}(l.SOD_EventName||(l.SOD_EventName={})),(l.SOD_PoolName||(l.SOD_PoolName={})).itemCircle="itemCircle",function(t){t[t.upGrade=1]="upGrade",t[t.addNum=2]="addNum",t[t.addAttack=3]="addAttack"}(l.buffType||(l.buffType={})),function(t){t[t.none=0]="none",t[t.game=1]="game",t[t.pause=2]="pause",t[t.end=3]="end"}(l.SOD_GameState||(l.SOD_GameState={})),function(t){t[t.none=0]="none",t[t.enemy=1]="enemy",t[t.player=2]="player"}(l.SOD_ItemType||(l.SOD_ItemType={})),function(t){t[t.enemy=1]="enemy",t[t.player=2]="player"}(l.SOD_FactoryType||(l.SOD_FactoryType={})),function(t){t[t.none=0]="none",t[t.move=1]="move",t[t.moveNoAttack=2]="moveNoAttack",t[t.attack=3]="attack",t[t.attacking=4]="attacking",t[t.die=5]="die"}(l.SOD_ItemState||(l.SOD_ItemState={})),function(t){t.nowLevel="\u7b2c{0}/{0}\u6ce2",t.enemyNum="\u654c\u4eba\u6570\u91cf\uff1a{0}"}(l.SOD_TextCfg||(l.SOD_TextCfg={})),cc._RF.pop(),cc._RF.pop()},{}],SOD_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"82005p4FUxEsJfZXo23Gbz7","SOD_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"82005p4FUxEsJfZXo23Gbz7","SOD_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("SOD_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){var e,o;if(!window||!window.location)return null;var i=null===(o=null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.search)||void 0===o?void 0:o.replace("?","");if(!i||""===i)return null;for(var n=i.split("&"),a=0;a<n.length;a++){var r=n[a].split("=");if(decodeURIComponent(r[0])===t)return decodeURIComponent(r[1])}return null},t.prototype.load=function(t){var e=this,o=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var i=this.getUrlParam("isRemote");i&&"1"==i&&(o=!0)}o?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/b_soilder/configs",fileName:"GameJsonCfg.json"},function(o,i){if(o&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(e.data=JSON.parse(n.data),console.log(e.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emSODBundles.configs,"GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffPositionCfgByIndex=function(t){var e=this.data.buffPositionCfg;for(var o in e)if(e[o].doorPosition==t)return e[o]},t.prototype.getBuffTypeCfgByType=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getSoilderCfgByID=function(t){var e=this.data.soilderCfg;for(var o in e)if(e[o].soilderID==t)return e[o]},t.prototype.getSoilderCfg=function(){return this.data.soilderCfg},t.prototype.getLevelCfgByLevelAndRound=function(t,e){var o=this.data.levelCfg;for(var i in o)if(o[i].level==t&&o[i].round==e)return o[i]},t.prototype.getMAXLevel=function(){var t=this.data.levelCfg.length-1;return this.data.levelCfg[t].level},t.prototype.getMAXRoundByLevel=function(t){var e=this.data.levelCfg,o=0;for(var i in e)e[i].level==t&&(o=e[i].round);return o},t.prototype.getPrefabCfg=function(){return this.data.prefabCfg},t.prototype.getPrefabCfgByID=function(t){var e=this.data.prefabCfg;for(var o in e)if(e[o].prefabID==t)return e[o]},t.prototype.getEnemyCfgByID=function(t){var e=this.data.enemyCfg;for(var o in e)if(e[o].enemyID==t)return e[o]},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],SOD_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"42abfYAYL5Aa7NXAPmrjho5","SOD_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"42abfYAYL5Aa7NXAPmrjho5","SOD_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("NodeLib"),d=i("stringLib"),h=i("SOD_Configs"),f=i("sod_gameCtrl"),m=i("SOD_DataMgr"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sod_gameCtrl=null,e.pro_uiView=null,e.pro_waveProgress=null,e.pro_levelLabel=null,e.pro_enemyLabel=null,e.pro_btn_pause=null,e.pro_pauseLayer=null,e.pro_lockLabel=null,e.pro_pauseLayerBtn=null,e.pro_itemCirCle=null,e.pro_effctParent=null,e.pro_bannerLayer=null,e.pro_gmLayer=null,e.itemPoolName="effctItem",e}var o;return s(e,t),o=e,e.prototype.initProperty=function(){this.buttomItemLayer=u.default.findChildByName(this.node,"buttomItemLayer"),this.ourPartLayer=u.default.findChildByName(this.node,"OurPartLayer"),this.otherPartLayer=u.default.findChildByName(this.node,"OtherPartLayer"),this.itemDestroyPos=u.default.findChildByName(this.node,"itemDestroyPos").position,this.sod_gameCtrl=u.default.findChildByName(this.node,"root").getComponent(f.default),this.pro_uiView=u.default.findChildByName(this.node,"pro_uiView"),this.pro_btn_pause=u.default.findChildByName(this.pro_uiView,"pro_btn_pause"),this.pro_pauseLayer=u.default.findChildByName(this.pro_uiView,"pro_pauseLayer"),this.pro_pauseLayerBtn=u.default.findChildByName(this.pro_uiView,"pro_pauseLayerBtn"),this.pro_lockLabel=u.default.findChildByName(this.pro_uiView,"pro_lockLabel"),this.pro_itemCirCle=u.default.findChildByName(this.pro_uiView,"pro_itemCirCle"),this.pro_bannerLayer=u.default.findChildByName(this.pro_uiView,"pro_bannerLayer"),this.pro_gmLayer=u.default.findChildByName(this.node,"pro_gmLayer"),this.pro_effctParent=this.pro_itemCirCle.parent,this.initWave()},e.prototype.initPool=function(){p.PoolMgr.getInstance().creatrePool(this.itemPoolName,this.pro_itemCirCle)},e.prototype.initBtnListener=function(){var t=this;this.pro_btn_pause.on(cc.Node.EventType.TOUCH_END,function(){t.doPauseDown()}),this.pro_pauseLayerBtn.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.SOD_UIID.UISetting)}),this.pro_pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pro_btn_pause.active=!0,t.pro_pauseLayer.active=!1,t.resumeGame()})},e.prototype.initListener=function(){this.addEvent(h.SOD_EventName.sod_pause,this.pauseGame),this.addEvent(h.SOD_EventName.sod_resume,this.resumeGame),this.addEvent(h.SOD_EventName.sod_space,this.doPauseDown),this.addEvent(h.SOD_EventName.sod_changeWave,this.changeWave),this.addEvent(h.SOD_EventName.sod_changeEnemyNum,this.changeEnemyNum),this.addEvent(h.SOD_EventName.sod_showBanner,this.showBanner)},e.prototype.showBanner=function(t){var e=this.getBannerNode(t);e.active=!0;var o=e.width;e.parent=this.pro_bannerLayer,e.setPosition(-o/2,0),cc.tween(e).by(.3,{x:o}).delay(.5).by(.3,{x:-o}).call(function(){e.removeFromParent()}).start()},e.prototype.showGmLayer=function(){this.pro_gmLayer.active=!0},e.prototype.getBannerNode=function(t){return cc.instantiate(u.default.findChildByName(this.pro_bannerLayer,t))},e.prototype.showBallEffect=function(){},e.prototype.doPauseDown=function(){this.pauseGame(),this.pro_btn_pause.active=!1,this.pro_pauseLayer.active=!0},e.prototype.pauseGame=function(){cc.director.getPhysicsManager().enabled=!1,this.sod_gameCtrl.pauseGame()},e.prototype.resumeGame=function(){cc.director.getPhysicsManager().enabled=!0,this.sod_gameCtrl.resumeGame()},e.prototype.initWave=function(){this.pro_waveProgress=u.default.getChildSprite(this.pro_uiView,"pro_waveProgress"),this.pro_levelLabel=u.default.getChildLabel(this.pro_uiView,"pro_levelLabel"),this.pro_enemyLabel=u.default.getChildLabel(this.pro_uiView,"pro_enemyLabel");var t=m.default.getInstance().getMAXLevel();this.pro_levelLabel.string=d.default.getStringText(h.SOD_TextCfg.nowLevel,1,t),this.pro_enemyLabel.string=d.default.getStringText(h.SOD_TextCfg.enemyNum,0),this.pro_waveProgress.fillRange=0},e.prototype.changeWave=function(t,e){var o=m.default.getInstance().getMAXLevel(),i=m.default.getInstance().getMAXRoundByLevel(t);this.pro_levelLabel.string=d.default.getStringText(h.SOD_TextCfg.nowLevel,t,o),this.pro_waveProgress.fillRange=e/i},e.prototype.changeEnemyNum=function(t){this.pro_enemyLabel.string=d.default.getStringText(h.SOD_TextCfg.enemyNum,t)},e.prototype.getButtomItemLayer=function(){return this.buttomItemLayer},e.prototype.getOurPartLayer=function(){return this.ourPartLayer},e.prototype.getOtherPartLayer=function(){return this.otherPartLayer},e.prototype.getItemDestroyPos=function(){return this.itemDestroyPos},e.prototype.onLoad=function(){o.instance=this,this.initProperty()},e.prototype.start=function(){this.initListener(),this.initBtnListener(),this.initPool()},o=c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],SOD_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"6554amj1nlIlL7VHuKTZenR","SOD_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"6554amj1nlIlL7VHuKTZenR","SOD_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("NodeLib"),u=i("SOD_APP"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ndWin=null,e.pro_ndFail=null,e.pro_btn=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.initproperty=function(){this.pro_ndWin=p.default.findChildByName(this.node,"pro_ndWin"),this.pro_ndFail=p.default.findChildByName(this.node,"pro_ndFail"),this.pro_btn=p.default.findChildByName(this.node,"pro_btn")},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initView(),this.pro_btn.on(cc.Node.EventType.TOUCH_END,function(){u.default.instance.exit_App(0)})},e.prototype.initView=function(){this.pro_ndFail.active=!this.isWin,this.pro_ndWin.active=this.isWin},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],SOD_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"94cbbqFATFBPbe+E0iy1Wsd","SOD_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"94cbbqFATFBPbe+E0iy1Wsd","SOD_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("NodeLib"),m=i("SOD_APP"),g=i("SOD_UIGame"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_musicSlider=null,e.pro_effectSlider=null,e.pro_btnClose=null,e.pro_btnBackHome=null,e.pro_btnPlay=null,e.pro_gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t},e.prototype.initproperty=function(){this.pro_musicSlider=f.default.findChildByName(this.node,"pro_musicSlider").getComponent(cc.Slider),this.pro_effectSlider=f.default.findChildByName(this.node,"pro_effectSlider").getComponent(cc.Slider),this.pro_btnClose=f.default.findChildByName(this.node,"pro_btnClose"),this.pro_btnBackHome=f.default.findChildByName(this.node,"pro_btnBackHome"),this.pro_btnPlay=f.default.findChildByName(this.node,"pro_btnPlay"),this.pro_gmNode=f.default.findChildByName(this.node,"pro_gmNode"),this.pro_musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.pro_effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.pro_musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.pro_effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.pro_musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.pro_effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.pro_musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.pro_gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&g.default.instance.showGmLayer()}),this.pro_effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.pro_btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.pro_btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){m.default.instance.exit_App(0)}),this.pro_btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([v],e)}(p.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],STOGameData:[function(t,e,o){"use strict";cc._RF.push(e,"df572lOQvVMsIDVMek4+STy","STOGameData");var i=e,n=o;cc._RF.push(i,"df572lOQvVMsIDVMek4+STy","STOGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emSTOGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.levelCfg="levelCfg",t.mateCfg="mateCfg",t.stoneCfg="stoneCfg"}(n.emSTOGameDataKeys||(n.emSTOGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],STOGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"b36d8kFhUtFII/fH+rCraH8","STOGameEnumData");var i=e,n=o;cc._RF.push(i,"b36d8kFhUtFII/fH+rCraH8","STOGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.wallHp=15]="wallHp",t[t.stoneAngularV=16]="stoneAngularV",t[t.stoneFriction=17]="stoneFriction",t[t.stoneRestitution=18]="stoneRestitution",t[t.stoneWeight=19]="stoneWeight",t[t.groundQuakeTime=20]="groundQuakeTime",t[t.groundQuake=21]="groundQuake",t[t.groundOnOrNot=22]="groundOnOrNot",t[t.hitForces=23]="hitForces"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],STO_App:[function(t,e,o){"use strict";cc._RF.push(e,"19d10MdyjhDYJYZLFZtvvp7","STO_App");var i=t,n=e,a=o;cc._RF.push(n,"19d10MdyjhDYJYZLFZtvvp7","STO_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("STO_Configs"),p=i("STO_DataMgr"),u=i("STO_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),cc.director.getPhysicsManager().enabled=!0,l.Global.isDirect=o,this.addTouchEvent(),this._exitCall=e;var n=function(){i._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.STO_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.STO_AudioId.bgm,l.STOConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.STO_UICF),r.AudioMgr.getInstance().addAdConf(l.STO_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){n()})}))},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.STO_UIID.UIGame),s.UIMgr.getInstance().closeById(l.STO_UIID.UIResult),s.UIMgr.getInstance().closeById(l.STO_UIID.UISetting),cc.director.getPhysicsManager().enabled=!1,l.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],STO_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"8db9dxmmPBL+KJBTowshiKM","STO_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"8db9dxmmPBL+KJBTowshiKM","STO_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Utils"),u=i("STO_Configs"),d=function(t,e){this.flag=t,this.num=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useState=!1,e.bloodArr=[],e.limitTime=3,e.showNum=10,e}return s(e,t),e.prototype.isCirt=function(t,e){t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e+""):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e+""),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=p.Utils.randomRang(-30,30),o=p.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){l.PoolMgr.getInstance().freeNode(u.poolName.blood,t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.x=0,this.node.y=0,this.node.opacity=255},e.prototype.inUse=function(){return this.useState},e.prototype.pushBlood=function(t,e){var o=new d(t,e);this.bloodArr.push(o)},e.prototype.showBlood=function(){for(var t=this.bloodArr.splice(0,this.showNum),e=0;e<t.length;e++){var o=t[e];this.isCirt(o.flag,o.num)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){(this.nowTime<0||!this.nowTime)&&(this.nowTime=this.limitTime,this.showBlood()),this.nowTime--},e.prototype.onDestroy=function(){this.bloodArr=[]},c([m(cc.Node)],e.prototype,"isCritState",void 0),c([m(cc.Label)],e.prototype,"critLabel",void 0),c([m(cc.Label)],e.prototype,"commonLabel",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],STO_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"d9725BvvVZBEqrPFCrRQbFY","STO_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"d9725BvvVZBEqrPFCrRQbFY","STO_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("STO_Configs"),d=i("STOGameEnumData"),h=i("STO_DataMgr"),f=i("STO_UIGame"),m=i("STO_Hero"),g=i("STO_HeroCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.nodeObj1=new b,e.nodeObj2=new b,e.lock=!0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(t){this.node.active=!1;var e=h.default.getInstance().getLevelCfgByID(t);if(e){if(e.buffType)if(1==e.buffType){var o=this.getResult(),i=this.getResult(),n=this.getPropertyResultArr(o,i,e);(0==o||1==o||2==o)&&this.initPropertyNode(o,n[0],this.node1,this.nodeObj1),(0==i||1==i||2==i)&&this.initPropertyNode(i,n[1],this.node2,this.nodeObj2)}else if(2==e.buffType){if(0==(o=this.getResult())){var a=this.getPropertyResult(e.buff1,o);this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)}else 1==o?(a=this.getPropertyResult(e.buff2?e.buff2:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)):2==o&&(a=this.getPropertyResult(e.buff3?e.buff3:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1));var r=this.getNewRole();this.initNewNode(r[0],this.node2,this.nodeObj2)}else r=this.getNewRole(2),this.initNewNode(r[0],this.node1,this.nodeObj1),this.initNewNode(r[1],this.node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=u.Global.heroID.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getResult=function(){return Math.floor(Math.random()*u.Global.heroID.length)},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t));if(u.Global.heroID[e].node.getComponent(m.default).getAttackSpeedState())for(var i=0;i<o.length;i++)if(o[i].includes("speed")){o.splice(i,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=h.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);for(var i in u.Global.heroID){var n=o.indexOf(u.Global.heroID[i].id);-1!=n&&o.splice(n,1)}for(var a=Object.keys(o),r=[];t--;)i=Math.floor(Math.random()*a.length),r.push(o[a[i]]),a.splice(i,1);return r},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=u.Global.heroID[t].id;this.loadSpriteFrame(u.emSTOBundles.imgs,"js_b/tx_"+a,function(r){n.initPropertyView(o,r,e,a),n.lock=!1,n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=h.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=u.Global.heroID[t].node,c.buffType==u.emSTOBuffType.speedPlus?i.type=1:c.buffType==u.emSTOBuffType.ATKmul||c.buffType==u.emSTOBuffType.ATKplus?i.type=2:c.buffType==u.emSTOBuffType.penetratePlus?i.type=3:c.buffType==u.emSTOBuffType.bulletPlus?i.type=4:c.buffType==u.emSTOBuffType.critPlus?i.type=5:c.buffType==u.emSTOBuffType.skillMul&&(i.type=6)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=h.default.getInstance().getCharacterByID(i).characterName,p=h.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon");this.loadSpriteFrame(u.emSTOBundles.imgs,"js_b/tx_"+t,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.lock=!1,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=h.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffectFree(u.STO_AudioId.buff),g.default.script.checkCollider()?this.nodeObj1.isNew?g.default.script.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?g.default.script.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.destroy()},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;1==o?e.getComponent(m.default).addAttackSpeed(t.addType,t.addNum):2==o?e.getComponent(m.default).addAttackPower(t.addType,t.addNum):3==o?e.getComponent(m.default).addAttackPenerate(t.addType,t.addNum):4==o?e.getComponent(m.default).addBulletCount(t.addType,t.addNum):5==o?e.getComponent(m.default).addCritChance(t.addType,t.addNum):6==o&&e.getComponent(m.default).addSkill(t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){o.script=this,this.addEvent(u.emSTOEventName.pause,this.stop),this.addEvent(u.emSTOEventName.resume,this.resume)},e.prototype.stop=function(){this.lock=!0},e.prototype.resume=function(){this.lock=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.lock||(this.node.y-=h.default.getInstance().getParam(d.enumBasicParaCfg.buffMove)*t*100,f.default.script.checkReWardLayer(this.node.y)&&this.doReward())},c([_(cc.Node)],e.prototype,"node1",void 0),c([_(cc.Node)],e.prototype,"node2",void 0),c([_(cc.SpriteFrame)],e.prototype,"sp",void 0),o=c([v],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],STO_Bullet2:[function(t,e,o){"use strict";cc._RF.push(e,"4d728BfX71LEqM2NMKS36sD","STO_Bullet2");var i=t,n=e,a=o;cc._RF.push(n,"4d728BfX71LEqM2NMKS36sD","STO_Bullet2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("STO_Configs"),d=i("STO_enemyCtrl"),h=function(t,e,o){this.damage=t,this.isCrit=e,this.pos=o};a.damageObj=h;var f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDestory=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e}return s(e,t),e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,h){void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===h&&(h=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDestory=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.initNodeView(a,r,s),this.createNeedCheckY()},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){},e.prototype.update=function(t){if(this.active&&!this.isDestory){var e=this.flySpeed*t*100;this.node.y+=e,this.range-=e,this.needCheckY-=e,this.range<=0&&this.removeNode();var o=this.hit(),i=d.default.script.checkCollider(this.node.getPosition(),o.damage,o.isCrit,this.lastAttackID);if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(u.emSTOEventName.GAD_Show_Hit_Effect,n),this.lastAttackID=i,this.onDie()}}},e.prototype.hit=function(){return this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new h(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition())},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDestory=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)p.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start()},e.prototype.render=function(){},e.prototype.stop=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},c([m],e)}(l.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],STO_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"1399dh43XZJbrvRnyry4/NZ","STO_BulletEffect");var i=e,n=o;cc._RF.push(i,"1399dh43XZJbrvRnyry4/NZ","STO_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.show()},e.prototype.hide=function(){this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.node.active=!1,t.resetSystem()})},e.prototype.show=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],STO_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"c3327pylXlOKKrNgxAiWb8j","STO_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"c3327pylXlOKKrNgxAiWb8j","STO_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.emSTOHitState=l.poolName=l.emSTOBuffType=l.emSTOGameState=l.emSTORoleState=l.emSTORoleType=l.emSTOEventName=l.STO_AudioCF=l.STO_AudioId=l.STO_UICF=l.STOConfig=l.emSTOBundles=l.STO_UIID=void 0,function(t){t.UIGame="STO_UIGame",t.UIResult="STO_UIResult",t.UISetting="STO_UISetting"}(a=l.STO_UIID||(l.STO_UIID={})),function(t){t.prefabs="sto_prefabs",t.audios="sto_audios",t.imgs="sto_imgs",t.configs="sto_configs",t.configsB="sto_configsB"}(r=l.emSTOBundles||(l.emSTOBundles={})),l.STOConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.STO_UICF=((i={})[a.UIGame]={prefab:"ui/STO_UIGame",name:"STO_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/STO_UIResult",name:"STO_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/STO_UISetting",name:"STO_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.doubleSword="doubleSword",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.stogonHit="stogonHit",t.rake="rake",t.typhoon="typhoon",t.lotus="lotus",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.carBack="carBack",t.carDie="carDie",t.carHit="carHit",t.enemyAttack="enemyAttack",t.enemyDie="enemyDie",t.enemyHit="enemyHit",t.girlDie="girlDie",t.stoneboom="stoneboom"}(s=l.STO_AudioId||(l.STO_AudioId={})),l.STO_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.stogonHit]={path:"stogonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.carBack]={path:"carBack",bundle:r.audios},n[s.carDie]={path:"carDie",bundle:r.audios},n[s.carHit]={path:"carHit",bundle:r.audios},n[s.enemyAttack]={path:"enemyAttack",bundle:r.audios},n[s.enemyDie]={path:"enemyDie",bundle:r.audios},n[s.enemyHit]={path:"enemyHit",bundle:r.audios},n[s.girlDie]={path:"girlDie",bundle:r.audios},n[s.stoneboom]={path:"stoneboom",bundle:r.audios},n),function(t){t.GAD_Player_Die="sto_gad_player_die",t.GAD_Shoot_Bullet="sto_gad_shoot_bullet",t.GAD_Show_Hit_Text="sto_gad_show_hit_text",t.GAD_Show_Warn="sto_gad_show_warn",t.GAD_Bubble_Buf="sto_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="sto_gad_hit_effect",t.GAD_Show_Buff_Tip="sto_gad_show_buff_tip",t.GAD_Setting_Back="sto_gad_setting_back",t.pause="sto_pause",t.resume="sto_resume",t.skillPause="sto_skillPause",t.skillResume="sto_skillResume",t.buff="sto_buff",t.blood="sto_blood",t.newTarm="sto_newTarm",t.wallBlood="sto_wallBlood"}(l.emSTOEventName||(l.emSTOEventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emSTORoleType||(l.emSTORoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emSTORoleState||(l.emSTORoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emSTOGameState||(l.emSTOGameState={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emSTOBuffType||(l.emSTOBuffType={})),function(t){t.blood="sto_blood",t.effect="sto_effect",t.box="sto_box",t.body="sto_body",t.sto_item="sto_item",t.sto_bullet="sto_bullet",t.sto_destroy="sto_destroy"}(l.poolName||(l.poolName={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emSTOHitState||(l.emSTOHitState={}));var p=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t.isDown=!1,t}();l.Global=p,cc._RF.pop(),cc._RF.pop()},{}],STO_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"428e3Mc+MFAqprcbqmP0/7N","STO_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"428e3Mc+MFAqprcbqmP0/7N","STO_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("STO_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}e?i?c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"qiujiayu/BraveTower/configsB",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emSTOBundles.configsB,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()}):i?c.HttpMgr.getInstance().httpGet("http://192.168.2.8:8989/game/read",{dir:"qiujiayu/stone/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emSTOBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getStoneCfgByID=function(t){var e=this.data.stoneCfg;for(var o in e)if(e[o].stoneID==t)return e[o]},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],STO_Enemy:[function(t,e,o){"use strict";cc._RF.push(e,"1bd40YFOJBLfaQNdJbEYcZt","STO_Enemy");var i=t,n=e,a=o;cc._RF.push(n,"1bd40YFOJBLfaQNdJbEYcZt","STO_Enemy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseUI"),u=i("AudioMgr"),d=i("PoolMgr"),h=i("Utils"),f=i("STO_Configs"),m=i("STOGameEnumData"),g=i("STO_DataMgr"),y=i("STO_UIGame"),v=i("STO_enemyCtrl"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblHP=null,e.spNode=null,e.radius=32,e.hp=0,e.attack=0,e.isShake=!1,e.stoneY=0,e}return s(e,t),e.prototype.initNode=function(t,e){this.monsterID=e,this.lv=t.stoneID,this.round=t.round,this.initParam(t.stoneHp,t.stoneID),this.initView()},e.prototype.initParam=function(t,e){this.hp=t,this.isShake=!1,this.attack=g.default.getInstance().getStoneCfgByID(e).stoneATK,this.aimPosY=y.default.script.getWallPosY(),this.stoneY=v.default.script.getStoneIndex(1).y,this.stoneRect=this.getWorldColldierRect(v.default.script.getStoneIndex(1)),this.node.getComponent(cc.RigidBody).angularVelocity=g.default.getInstance().getParam(m.enumBasicParaCfg.stoneAngularV),this.node.getComponent(cc.RigidBody).gravityScale=g.default.getInstance().getParam(m.enumBasicParaCfg.stoneWeight,1),this.node.getComponent(cc.PhysicsCircleCollider).friction=g.default.getInstance().getParam(m.enumBasicParaCfg.stoneFriction),this.node.getComponent(cc.PhysicsCircleCollider).restitution=g.default.getInstance().getParam(m.enumBasicParaCfg.stoneRestitution)},e.prototype.initView=function(){this.lblHP.string=this.hp+"",this.state=l.move,this.hp>=1e4&&(this.lblHP.fontSize=48)},e.prototype.checkCollider=function(t,e,o,i){return this.state!=l.die&&i!=this.monsterID&&!!this.isInRange(t)&&(this.handleDamage(e,t,o),this.doImpulse(),this.hp>0?u.AudioMgr.getInstance().playEffect(f.STO_AudioId.enemyHit):u.AudioMgr.getInstance().playEffect(f.STO_AudioId.stoneboom),!0)},e.prototype.checkSkillCollider=function(t,e){if(this.state!=l.die){var o=this.getWorldColldierRect(this.node);t.intersects(o)&&this.handleDamage(e,this.node.getPosition(),!1)}},e.prototype.getWorldColldierRect=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var i=t.getAnchorPoint(),n=t.position,a=(t.width+e)*t.scaleX,r=(t.height+o)*t.scaleY;return cc.rect(n.x-i.x*a,n.y-i.y*r,a,r)},e.prototype.handleDamage=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=!1);var i=t;this.hp-=i,performance.now(),this.doDamage(t,this.getPos(e),o),this.hp<=0&&this.doDie()},e.prototype.doImpulse=function(){},e.prototype.getPos=function(t){var e=h.Utils.randomRang(-30,30),o=h.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(f.emSTOEventName.blood,t,e,o,i),this.lblHP.string=Math.max(this.hp,0).toString()},e.prototype.isInRange=function(t){var e=this.node.position,o=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return o*o/(this.radius*this.radius)+i*i/(this.radius*this.radius)<=1.5},e.prototype.doAttack=function(){var t=this;this.state==l.move&&(this.sendEvent(f.emSTOEventName.GAD_Show_Warn),this.state=l.attack,this.lblHP.node.active=!1,this.sendEvent(f.emSTOEventName.wallBlood,this.attack),y.default.script.onScreenShake(),this.scheduleOnce(function(){t.node.removeFromParent(),t.node.destroy(),f.Global.isDown||v.default.script.checkWin()},.2),this.state=l.die)},e.prototype.doDie=function(){this.lblHP.node.active=!1,this.sendEvent(f.emSTOEventName.buff,this.round);var t=d.PoolMgr.getInstance().getNode(f.poolName.sto_destroy);t&&cc.isValid(t)&&this.doDieDown(t),this.state=l.die},e.prototype.doDieDown=function(t){var e=this;this.node.active=!1,t.parent=y.default.script.getDestroyLayer(),t.setPosition(this.node.getPosition());var o=t.getComponent(sp.Skeleton);o.setSkin("lv"+this.lv),o.setAnimation(0,"animation",!1),o.setCompleteListener(function(){d.PoolMgr.getInstance().freeNode(f.poolName.sto_destroy,t),e.node.removeFromParent(),e.node.destroy(),f.Global.isDown||v.default.script.checkWin()})},e.prototype.checkShake=function(){this.getWorldColldierRect(this.node).intersects(this.stoneRect)&&(this.isShake=!0,v.default.script.doShakeByRect())},e.prototype.start=function(){},e.prototype.onUpdate=function(){this.node.y<this.aimPosY&&this.doAttack(),this.node.y>=this.stoneY-50&&!this.isShake&&this.checkShake()},c([B(cc.Label)],e.prototype,"lblHP",void 0),c([B(sp.Skeleton)],e.prototype,"spNode",void 0),c([B()],e.prototype,"radius",void 0),c([b],e)}(p.default);a.default=I,function(t){t.move="move",t.attack="attack",t.die="die",t.idle="idle"}(l||(l={})),cc._RF.pop(),cc._RF.pop()},{}],STO_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"edec3W01+tGQ47JPqP32qMw","STO_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"edec3W01+tGQ47JPqP32qMw","STO_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("STO_Configs"),u=i("STO_Hero"),d=i("STO_TarmCtrl"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t,e){this.id=t,this.node=e},y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;o.script=this,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.heroRoot.x+=o})},e.prototype.heroMove=function(t){this.heroRoot.x+=t},e.prototype.test=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPower(1,1e3);else if("speed"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackSpeed(1,4);else if("penerate"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addAttackPenerate(1,1);else if("bulletCount"==e)for(var o in p.Global.heroID)p.Global.heroID[o].node.getComponent(u.default).addBulletCount(1,1)}else this.addHero(Number(e))},e.prototype.addHero=function(t){var e=this;if(p.Global.heroID.length>=3)console.error("\u4e0d\u5141\u8bb8\u52a0\u5165\u8d85\u8fc7\u4e09\u4e2a\u82f1\u96c4");else{p.Global.heroID||(p.Global.heroID=[]),this.node.getComponent(d.default).pushCard(t);var o=cc.instantiate(this.heorNode);o.active=!0,o.parent=this.node;var i=new g(t,o);p.Global.heroID.push(i),o.getComponent(u.default).initHero(t),this.scheduleOnce(function(){e.checkOverSide()},.01)}},e.prototype.clearHero=function(){p.Global.heroID=[]},e.prototype.getMaxDamage=function(t,e){var o=0;for(var i in p.Global.heroID)p.Global.heroID[i].id!=t&&p.Global.heroID[i].id!=e||(o=Math.max(p.Global.heroID[i].node.getComponent(u.default).getAttackPower(),o));return o},e.prototype.checkOverSide=function(){this.heroRoot.x+this.node.width/2>cc.winSize.width/2?this.heroRoot.x=cc.winSize.width/2-this.node.width/2:this.heroRoot.x-this.node.width/2<-cc.winSize.width/2&&(this.heroRoot.x=-cc.winSize.width/2+this.node.width/2)},e.prototype.checkCollider=function(){return this.node.x<0},e.prototype.start=function(){},c([m(cc.Node)],e.prototype,"heroRoot",void 0),c([m(cc.Node)],e.prototype,"heorNode",void 0),o=c([f],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],STO_Hero:[function(t,e,o){"use strict";cc._RF.push(e,"c8cccCt67dKYZsr22SDhqcV","STO_Hero");var i=t,n=e,a=o;cc._RF.push(n,"c8cccCt67dKYZsr22SDhqcV","STO_Hero");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("STO_Configs"),h=i("STOGameEnumData"),f=i("STO_DataMgr"),m=i("STO_UIGame"),g=i("STO_Bullet2"),y=i("STO_BulletEffect"),v=i("STO_SkillCtrl"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.firing=!1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.bullets=[],e.skillTimer=0,e.skillMultiplier=0,e.attackGap=1,e.maxSpeed=12,e.noInFactSpeed=5,e.lastFireTime=0,e.fireCooldown=.5,e}return s(e,t),e.prototype.initHero=function(t){this.initParm(t),this.initView(t),this.heroIndex=t,this.addEvent(d.emSTOEventName.pause,this.doPause),this.addEvent(d.emSTOEventName.resume,this.doResume)},e.prototype.initParm=function(t){1==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.basicATK):2==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.secondCharATK):3==d.Global.heroID.length&&(this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.thirdCharATK)),this.attackSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.basicASPD),this.bulletCount=f.default.getInstance().getParam(h.enumBasicParaCfg.basicBullet),this.penetrate=f.default.getInstance().getParam(h.enumBasicParaCfg.basicPenetrate),this.flySpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.bulletFlySpeed),this.critChance=f.default.getInstance().getParam(h.enumBasicParaCfg.basicCrit),this.critMultiplier=f.default.getInstance().getParam(h.enumBasicParaCfg.critDamage);var e=f.default.getInstance().getCharacterByID(t);this.skillInterval=e.skillCDtime,this.skillMultiplier=e.skillATK,this.skillEffect=e.skillSound},e.prototype.initView=function(t){var e=this;this.loadPrefab(d.emSTOBundles.prefabs,"bullets/STO_Bullet_"+t,function(o){e.poolName="bullet"+t,u.PoolMgr.getInstance().creatrePool(e.poolName,cc.instantiate(o)),e.bulletPrefab=o,e.startFiring()});var o=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emSTOBundles.imgs,"backs/"+o.cardColor,function(t){e.itemBg.spriteFrame=t}),this.loadSpriteFrame(d.emSTOBundles.imgs,"js/js_"+t,function(t){e.itemIcon.spriteFrame=t}),this.loadSpriteFrame(d.emSTOBundles.imgs,"skill/"+o.skillIcon,function(t){e.itemSkill.spriteFrame=t}),this.loadPrefab(d.emSTOBundles.prefabs,"skills/CardSkill"+t,function(t){e.heroSkill=cc.instantiate(t)}),this.itemName.string=o.characterName},e.prototype.startFiring=function(){this.firing=!0},e.prototype.stopFiring=function(){this.firing=!1},e.prototype.useSkill=function(){var t=m.default.script.getSkillLayer(),e=this.bulletPos.getPosition(),o=this.bulletPos.convertToWorldSpaceAR(e);return e=t.convertToNodeSpaceAR(o),v.default.script.useSkill(this.heroIndex,this.attackPower*this.skillMultiplier,this.heroSkill,e)},e.prototype.addAttackPower=function(t,e){this.addBuffTween(),1==t?this.attackPower+=e:this.attackPower*=e},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.addAttackSpeed=function(t,e){this.addBuffTween(),this.attackSpeedMultiplier+=e/f.default.getInstance().getParam(h.enumBasicParaCfg.speedPlusTimes)},e.prototype.getAttackSpeedState=function(){return this.attackSpeedMultiplier>=this.maxSpeed},e.prototype.addAttackPenerate=function(t,e){this.addBuffTween(),1==t?this.penetrate+=e:this.penetrate*=e},e.prototype.addskillInterval=function(t,e){this.addBuffTween(),1==t?this.penetrate-=e:this.penetrate/=e},e.prototype.addCritChance=function(t,e){this.addBuffTween(),1==t?this.critChance+=e:this.critChance*=e},e.prototype.addSkill=function(t,e){this.addBuffTween(),1==t?this.skillMultiplier+=e:this.skillMultiplier*=e},e.prototype.addBulletCount=function(t,e){this.addBuffTween(),1==t?this.bulletCount+=e:this.bulletCount*=e},e.prototype.addBuffTween=function(){var t=this;this.addBuffSp.opacity=255,this.addBuffSp.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.addBuffSp.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.addBuffSp.opacity=0},.1)})},e.prototype.getAttackSpeed=function(){return this.attackSpeed/this.attackSpeedMultiplier},e.prototype.updateSkillView=function(){this.skillPercent.fillRange=this.skillTimer/this.skillInterval},e.prototype.update=function(t){var e=this;this.firing&&(this.nowAttackTime+=t,this.skillTimer+=t,this.updateSkillView(),this.skillTimer>=this.skillInterval&&this.useSkill()&&(this.skillSp.opacity=255,p.AudioMgr.getInstance().playEffect(this.skillEffect,this.skillEffect),this.skillSp.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.skillSp.getComponent(sp.Skeleton).setCompleteListener(function(){e.scheduleOnce(function(){e.skillSp.opacity=0},.1)}),this.skillTimer=0),this.attackGap-=t,this.nowAttackTime-this.lastAttackTime>this.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime,this.attackGap=1))},e.prototype.fireBullets=function(){var t=performance.now()/1e3;t-this.lastFireTime>=this.fireCooldown&&(p.AudioMgr.getInstance().playEffectFree(d.STO_AudioId.bullet),this.lastFireTime=t);var e=m.default.script.getBulletLayer(this.heroIndex),o=this.bulletPos.getPosition();this.creatInfactBullet(e,o)},e.prototype.creatInfactBullet=function(t,e){var o=30,i=20;this.bulletCount>5&&(i=(o=120/(this.bulletCount-1))/2);for(var n=this.bulletCount%2?-Math.floor(this.bulletCount/2)*o:-Math.floor(this.bulletCount/2)*o+i,a=0;a<this.bulletCount;a++){var r=new cc.Vec2(e.x-n,e.y);n+=o;var s=this.bulletPos.convertToWorldSpaceAR(r);r=t.convertToNodeSpaceAR(s);var c=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab);(u.PoolMgr.getInstance().getNode(d.poolName.sto_bullet)||cc.instantiate(this.bullet)).getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,r,c,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier)}},e.prototype.creatNoInfactBullet=function(t,e){for(var o=[],i=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,n=0;n<this.bulletCount;n++){var a=new cc.Vec2(0-i,0);i+=30,o.push(a)}var r=u.PoolMgr.getInstance().getNode(d.poolName.sto_bullet)||cc.instantiate(this.bullet),s=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab),c=this.bulletPos.convertToWorldSpaceAR(e),l=t.convertToNodeSpaceAR(c);r.getComponent(g.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,l,s,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier,this.bulletCount,o)},e.prototype.pushBullet=function(t){t.getComponent(y.default).hide(),this.bullets.push(t)},e.prototype.doPause=function(){this.stopFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).stop()},e.prototype.doResume=function(){this.startFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).resume()},c([B(cc.Prefab)],e.prototype,"bullet",void 0),c([B(cc.Node)],e.prototype,"bulletPos",void 0),c([B(cc.Node)],e.prototype,"skillSp",void 0),c([B(cc.Node)],e.prototype,"addBuffSp",void 0),c([B(cc.Label)],e.prototype,"itemName",void 0),c([B(cc.Sprite)],e.prototype,"itemBg",void 0),c([B(cc.Sprite)],e.prototype,"itemIcon",void 0),c([B(cc.Sprite)],e.prototype,"itemSkill",void 0),c([B(cc.Sprite)],e.prototype,"skillPercent",void 0),c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],STO_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"d598db3YhNFR7eczBnGv84v","STO_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"d598db3YhNFR7eczBnGv84v","STO_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("STO_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],STO_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"ee28bBXiWBFRqWTUIDRn6HZ","STO_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"ee28bBXiWBFRqWTUIDRn6HZ","STO_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("STO_Configs"),u=i("STO_Skill"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){return!this.isSkill&&(this.isSkill=!0,this.showBanner(t),o.parent=this.node,o.getComponent(u.default).useSkill(i,e,t),!0)},e.prototype.showBanner=function(t){var e=this;this.loadSpriteFrame(p.emSTOBundles.imgs,"banner/banner"+t,function(t){e.banner.getComponent(cc.Sprite).spriteFrame=t,e.banner.active=!0}),cc.tween(this.banner).by(.5,{x:this.banner.width}).delay(.5).by(.5,{x:-this.banner.width}).call(function(){e.isSkill=!1,e.banner.active=!1}).start()},e.prototype.onLoad=function(){o.script=this,this.banner.x=-cc.winSize.width/2-this.banner.width/2},e.prototype.start=function(){},e.prototype.update=function(){},c([f(cc.Label)],e.prototype,"label",void 0),c([f(cc.Node)],e.prototype,"banner",void 0),c([f],e.prototype,"text",void 0),o=c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],STO_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"1a36fBG5i9A8o1M4NY6NkPQ","STO_Skill");var i=t,n=e,a=o;cc._RF.push(n,"1a36fBG5i9A8o1M4NY6NkPQ","STO_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("STO_enemyCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e.range=1500,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){"attack"==o.data.name&&(t.animationDuration=e.animation.duration)})},e.prototype.useSkill=function(t,e,o){var i=this;if(this.index=o,this.skillSpeed=this.speed,this.range=1500,1==o){this.canMove=!1,this.node.setPosition(0,l.default.script.getEnemyPosY(t)-300),this.spAni.setAnimation(0,"hit",!1);var n=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){i.doAttack()},n-.65),this.offHeight=300}else 6==o?(this.canMove=!1,this.node.setPosition(t.x,l.default.script.getEnemyPosY(t)),this.spAni.setAnimation(0,"hit",!1),n=this.spAni.getCurrent(0).animation.duration,this.scheduleOnce(function(){i.doAttack()},n-.6)):8==o?(this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)):11==o?(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!1),this.sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)):(this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0));this.damage=e,this.flyDis=l.default.script.getEnemyPosY(t)-this.node.y},e.prototype.update=function(t){var e=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed*t*85,this.flyDis-=this.skillSpeed*t*85,this.range-=this.skillSpeed*t*85,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){e.sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),e.sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.spAni.setAnimation(0,"hit",!1),this.doAttack()))},e.prototype.doAttack=function(){l.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.position,n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([d({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([d({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([d({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],STO_Target:[function(t,e,o){"use strict";cc._RF.push(e,"8a5c6H8DX5MZ4iIIoNcFoAz","STO_Target");var i=e,n=o;cc._RF.push(i,"8a5c6H8DX5MZ4iIIoNcFoAz","STO_Target"),Object.defineProperty(n,"__esModule",{value:!0}),n.Target=void 0;var a=function(){function t(t){this.health=t}return t.prototype.takeDamage=function(t){this.health-=t,console.log("Target takes "+t+" damage! Remaining health: "+this.health),this.health<=0&&this.destroy()},t.prototype.destroy=function(){console.log("Target destroyed!")},t}();n.Target=a,cc._RF.pop(),cc._RF.pop()},{}],STO_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"00197EsjBhEgJi4R6c/9jIS","STO_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"00197EsjBhEgJi4R6c/9jIS","STO_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("STO_Configs"),u=i("STO_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tarmMap=new Map,e.isTureTarmMap=new Map,e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.sendEvent(p.emSTOEventName.newTarm,e[0],this.delayTime),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],STO_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"cc78asOJSFN5LpnqO3KxGu/","STO_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"cc78asOJSFN5LpnqO3KxGu/","STO_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("UIMgr"),h=i("Config"),f=i("STO_Configs"),m=i("STO_BloodCtrl"),g=i("STO_BuffCtrl"),y=i("STO_mateCtrl"),v=i("STOGameEnumData"),_=i("STO_DataMgr"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.buffLayer=null,e.bloodLayer=null,e.hitLayer=null,e.blood=null,e.pauseLayer=null,e.closeNode=null,e.skillLayer=null,e.banner=null,e.bannerSp=[],e.maxLength=50,e.hpIndex=0,e.hpArr=[],e.hpProgress=null,e.tipPools=[],e.maxEffect=20,e.maxShowCount=50,e.lastShowTime=0,e.throttleTime=.2,e}return s(e,t),e.prototype.onLoad=function(){u.PoolMgr.getInstance().creatrePool(f.poolName.effect,this.hitEffect,5),u.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2),this.createHpArr(this.maxLength),this.maxHp=_.default.getInstance().getParam(v.enumBasicParaCfg.wallHp),this.nowHp=this.maxHp,this.hpProgress.fillRange=this.nowHp/this.maxHp,this.initSystemListen(),this.ndWarn.opacity=0},e.prototype.createHpArr=function(t){for(;t--;){var e=u.PoolMgr.getInstance().getNode(f.poolName.blood)||cc.instantiate(this.blood);this.hpArr.push(e)}},e.prototype.initSystemListen=function(){var t=this;f.Global.isDirect||cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){t.pauseLayer&&e.keyCode==cc.macro.KEY.space&&(t.pauseLayer.active?(t.pauseLayer.active=!1,t.sendEvent(f.emSTOEventName.resume)):(t.pauseLayer.active=!0,t.sendEvent(f.emSTOEventName.pause)))})},e.prototype.start=function(){var t=this;this.addEvent(f.emSTOEventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(f.emSTOEventName.GAD_Show_Warn,this.playWarn),this.addEvent(f.emSTOEventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(f.emSTOEventName.buff,this.showBuff),this.addEvent(f.emSTOEventName.blood,this.showLoseLabel),this.addEvent(f.emSTOEventName.newTarm,this.showNewTarm),this.addEvent(f.emSTOEventName.wallBlood,this.loseWallBlood),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(f.emSTOEventName.pause),f.Global.isDirect?d.UIMgr.getInstance().openUI(f.STO_UIID.UISetting,h.UIID.UINONE,function(e){e&&t.sendEvent(f.emSTOEventName.resume)}):t.pauseLayer.active=!0}),this.pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active&&(t.sendEvent(f.emSTOEventName.resume),t.pauseLayer.active=!1)}),this.closeNode.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active=!1,d.UIMgr.getInstance().openUI(f.STO_UIID.UISetting,h.UIID.UINONE,function(e){e&&t.sendEvent(f.emSTOEventName.resume)})})},e.prototype.onShowHitText=function(t,e){var o,i=this;(o=this.tipPools.length>0?this.tipPools.pop():cc.instantiate(this.ndTipRoot.children[0])).parent=this.ndTipRoot,o.active=!0,o.getComponent(cc.Label).string=(t>0?"+":"")+t,o.color=t>0?cc.color().fromHEX("#0bff16"):cc.color().fromHEX("#ff4e49");var n=this.ndTipRoot.convertToNodeSpaceAR(cc.v2(e.x,e.y));o.setPosition(n.x,n.y),o.opacity=255,cc.tween(o).by(.3,{y:80}).to(.1,{opacity:0}).call(function(){o.removeFromParent(),i.tipPools.push(o)}).start()},e.prototype.playWarn=function(){var t=this;this.ndWarn.active||(cc.Tween.stopAllByTarget(this.ndWarn),p.AudioMgr.getInstance().playEffect(f.STO_AudioId.enemyAttack),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.2,{opacity:255}).to(.2,{opacity:0}).call(function(){t.ndWarn.active=!1}).start())},e.prototype.showHitEffect=function(t){if(!(this.hitLayer.children.length>=this.maxEffect)){var e=this.node.convertToNodeSpaceAR(t),o=u.PoolMgr.getInstance().getNode(f.poolName.effect)||cc.instantiate(this.hitEffect);o.parent=this.hitLayer,o.setPosition(e),o.active=!0,o.opacity=255,o.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),o.getComponent(sp.Skeleton).setCompleteListener(function(){o.active=!1,u.PoolMgr.getInstance().freeNode("pbt_hit_effect",o)})}},e.prototype.showBuff=function(t){var e=this;this.loadPrefab(f.emSTOBundles.prefabs,"item/buff",function(o){var i=cc.instantiate(o);i.parent=e.buffLayer,i.getComponent(g.default).initNode(t)})},e.prototype.loseWallBlood=function(t){if(this.nowHp-=t,this.hpProgress.fillRange=this.nowHp/this.maxHp,this.nowHp<=0){if(f.Global.isDown)return;this.sendEvent(f.emSTOEventName.pause),d.UIMgr.getInstance().openUI(f.STO_UIID.UIResult,-1),f.Global.isDown=!0}},e.prototype.showLoseLabel=function(t,e,o,i){if(void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),!(this.bloodLayer.children.length>=this.maxShowCount)||i){var n=cc.director.getTotalTime();if(!(n-this.lastShowTime<this.throttleTime)||i){this.lastShowTime=n;var a=u.PoolMgr.getInstance().getNode(f.poolName.blood);a.parent||(a.parent=this.bloodLayer);var r=a.getComponent(m.default);r.resumeNode(),a.setPosition(e.x,e.y+40),r.isCirt(o,t)}}},e.prototype.showNewTarm=function(t,e){var o=this;this.loadPrefab(f.emSTOBundles.prefabs,"item/mateIcon",function(e){var i=cc.instantiate(e);i.parent=o.skillLayer,i.getComponent(y.default).initNode(t)}),this.showBanner(t,e)},e.prototype.showBanner=function(t,e){var o=this;this.banner.getComponent(cc.Sprite).spriteFrame=this.bannerSp[t],cc.tween(this.banner).by(e/2,{x:this.banner.width}).delay(e/2).call(function(){o.banner.x=-cc.winSize.width/2-o.banner.width/2}).start()},c([I(cc.Node)],e.prototype,"ndTipRoot",void 0),c([I(cc.Node)],e.prototype,"ndWarn",void 0),c([I(cc.Node)],e.prototype,"btnPause",void 0),c([I(cc.Node)],e.prototype,"hitEffect",void 0),c([I(cc.Node)],e.prototype,"ndBuffImg",void 0),c([I(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([I(cc.Sprite)],e.prototype,"spBack",void 0),c([I(cc.Node)],e.prototype,"buffLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"hitLayer",void 0),c([I(cc.Node)],e.prototype,"blood",void 0),c([I(cc.Node)],e.prototype,"pauseLayer",void 0),c([I(cc.Node)],e.prototype,"closeNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"banner",void 0),c([I(cc.SpriteFrame)],e.prototype,"bannerSp",void 0),c([I(cc.Sprite)],e.prototype,"hpProgress",void 0),c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],STO_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"a34202u/HdEF7N+NNm2gEYX","STO_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"a34202u/HdEF7N+NNm2gEYX","STO_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("AudioMgr"),d=i("STO_HeroCtrl"),h=i("STO_Configs"),f=i("STO_DataMgr"),m=i("STOGameEnumData"),g=i("STO_enemyCtrl"),y=i("SdkMgr"),v=i("PlatformSetting"),_=i("BasePlatform"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.sprBgSup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.heroRoot=null,e.ndFence=null,e.content=null,e.item=null,e.bulletLayer=null,e.rewardLayer=null,e.bloodLayer=null,e.destroyLayer=null,e.startNode=null,e.skillLayer=null,e.dieLayer=null,e.enemyCtrl=null,e.beautyNode=null,e.gmNode=null,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){h.Global.canAttack=!1,h.Global.bulletID=0,h.Global.isDown=!1,o.script=this,this.createNodePool(),this.doStart()},e.prototype.doStart=function(){var t=this;u.AudioMgr.getInstance().playEffectFree(h.STO_AudioId.mission),this.startNode.active=!0,this.startNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1);var e=this.ndCardGroup.getComponent(d.default);e.clearHero(),e.addHero(this.getNewRole()),this.enemyCtrl.startCreate(),this.startNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.startNode.active=!1},.1)})},e.prototype.setGmNode=function(){(y.SdkMgr.getInstance().getCheckVersion(v.SwitchID.ShenHe_ABD)||v.PlatformSetting.currentPlatform==_.Platform.EDITOR||v.PlatformSetting.currentPlatform==_.Platform.WEB_LINK)&&(this.gmNode.active=!0)},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=f.default.getInstance().getCharacter(),o=[];for(var i in e)o.push(e[i].characterID);return o[Math.floor(Math.random()*o.length)]},e.prototype.getWallPosY=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.y},e.prototype.getWallPos=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.getPosition()},e.prototype.getBeatyY=function(){return this.beautyNode.getComponent(cc.Widget).updateAlignment(),this.beautyNode.y},e.prototype.start=function(){this.initEvents()},e.prototype.createNodePool=function(){this.loadPrefab(h.emSTOBundles.prefabs,"item/blood",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.blood,e)}),this.loadPrefab(h.emSTOBundles.prefabs,"item/sto_item",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.sto_item,e)}),this.loadPrefab(h.emSTOBundles.prefabs,"item/sto_bullet",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.sto_bullet,e)}),this.loadPrefab(h.emSTOBundles.prefabs,"item/sto_destroy",function(t){var e=cc.instantiate(t);p.PoolMgr.getInstance().creatrePool(h.poolName.sto_destroy,e)})},e.prototype.initEvents=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.ndCardGroup.getComponent(d.default).heroMove(o)})},e.prototype.getBulletLayer=function(t){var e="layer"+t;return this.bulletLayer.getChildByName(e)},e.prototype.getAllBullet=function(){var t=[];for(var e in this.bulletLayer.children)for(var o in this.bulletLayer.children[e].children)t.push(this.bulletLayer.children[e].children[o])},e.prototype.getDestroyLayer=function(){return this.destroyLayer},e.prototype.getSkillLayer=function(){return this.skillLayer},e.prototype.checkReWardLayer=function(t){return this.rewardLayer.y>t},e.prototype.addHero=function(){},e.prototype.update=function(){},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.sprBgSup);var t=f.default.getInstance().getParam(m.enumBasicParaCfg.quake);this.ndFence.getComponent(cc.Widget).updateAlignment();var e=this.ndFence.position;this.shakeNode(this.sprBgSup,.05,t,cc.v3(0,0)),this.shakeNode(this.ndFence,.05,t,e)},e.prototype.shakeNode=function(t,e,o,i){cc.tween(t).set({position:i}).by(e,{position:cc.v3(-1*o,-1*o)}).by(e,{position:cc.v3(2*o,1*o)}).by(e,{position:cc.v3(-2*o,0*o)}).by(e,{position:cc.v3(2*o,-1*o)}).by(e,{position:cc.v3(-1*o,1*o)}).set({position:i}).start()},c([I(cc.Node)],e.prototype,"ndCardGroup",void 0),c([I(cc.Node)],e.prototype,"sprBgSup",void 0),c([I(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([I(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([I(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([I(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([I(cc.Node)],e.prototype,"heroRoot",void 0),c([I(cc.Node)],e.prototype,"ndFence",void 0),c([I(cc.Node)],e.prototype,"content",void 0),c([I(cc.Node)],e.prototype,"item",void 0),c([I(cc.Node)],e.prototype,"bulletLayer",void 0),c([I(cc.Node)],e.prototype,"rewardLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"destroyLayer",void 0),c([I(cc.Node)],e.prototype,"startNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"dieLayer",void 0),c([I(g.default)],e.prototype,"enemyCtrl",void 0),c([I(cc.Node)],e.prototype,"beautyNode",void 0),c([I(cc.Node)],e.prototype,"gmNode",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],STO_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"42431uKKvFHBZ6nNtfZBn7v","STO_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"42431uKKvFHBZ6nNtfZBn7v","STO_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("STO_App"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e.isDirect=null,e.unDirect=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([h(cc.Label)],e.prototype,"lblBar",void 0),c([h(cc.Sprite)],e.prototype,"spBar",void 0),c([h(cc.Node)],e.prototype,"ndWin",void 0),c([h(cc.Node)],e.prototype,"ndFail",void 0),c([h(cc.Node)],e.prototype,"ndTop",void 0),c([h(cc.Node)],e.prototype,"ndBar",void 0),c([h(cc.Node)],e.prototype,"btn",void 0),c([h(cc.Node)],e.prototype,"btnPlay",void 0),c([h(cc.Label)],e.prototype,"lblRwd",void 0),c([h(cc.Node)],e.prototype,"isDirect",void 0),c([h(cc.Node)],e.prototype,"unDirect",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],STO_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"219867tp9VLeKLkVEp9M+RY","STO_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"219867tp9VLeKLkVEp9M+RY","STO_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("STO_Configs"),d=i("STO_UIGame"),h=i("SdkMgr"),f=i("PlatformSetting"),m=i("BasePlatform"),g=i("STO_App"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e.gmButton=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t,this.isDirect.active=u.Global.isDirect,this.unDirect.active=!u.Global.isDirect},e.prototype.onEnable=function(){this.musicSlider.progress=p.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=p.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),p.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(f.SwitchID.ShenHe_ABD)||f.PlatformSetting.currentPlatform==m.Platform.EDITOR||f.PlatformSetting.currentPlatform==m.Platform.WEB_LINK)&&d.default.script.setGmNode()}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),p.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){g.default.instance.exit_App(0)}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([_(cc.Slider)],e.prototype,"musicSlider",void 0),c([_(cc.Slider)],e.prototype,"effectSlider",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([_(cc.Node)],e.prototype,"btnBackHome",void 0),c([_(cc.Node)],e.prototype,"isDirect",void 0),c([_(cc.Node)],e.prototype,"unDirect",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Node)],e.prototype,"gmNode",void 0),c([_(cc.Node)],e.prototype,"gmButton",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],STO_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"233b37HZb9FE7B/XWA03YkV","STO_UserData");var i=t,n=e,a=o;cc._RF.push(n,"233b37HZb9FE7B/XWA03YkV","STO_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"sto_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],STO_enemyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"fdaba7IEhROyZNzSL0IcL8u","STO_enemyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"fdaba7IEhROyZNzSL0IcL8u","STO_enemyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("STO_Configs"),u=i("STOGameEnumData"),d=i("STO_DataMgr"),h=i("STO_Enemy"),f=function(t,e){this.node=t,this.idx=e},m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemyArr=[],e.lastRound=null,e.createTime=0,e.nowLevel=1,e.isPause=!0,e.monsterID=99999,e.skillPause=!1,e.PosArr=[],e.stoneArr=[],e.canCheck=!1,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.script=this,this.canCheck=!1,this.addEvent(p.emSTOEventName.pause,this.pause),this.addEvent(p.emSTOEventName.resume,this.resume),this.addEvent(p.emSTOEventName.skillPause,this.doSkillPause),this.addEvent(p.emSTOEventName.skillResume,this.doSkillResume),this.initPosArr(),this.restWave=d.default.getInstance().getLevelCfg().length,this.lastRound.string=this.restWave+"",d.default.getInstance().getParam(u.enumBasicParaCfg.groundOnOrNot)&&(this.sharkTime=d.default.getInstance().getParam(u.enumBasicParaCfg.groundQuakeTime),this.nowSharkTime=this.sharkTime)},e.prototype.getStoneIndex=function(t){return t+=2,this.stoneLayer.children[t]},e.prototype.initPosArr=function(){for(var t=cc.winSize.height/2+50,e=-2;e<=2;e++)this.PosArr.push(new cc.Vec2(0+50*e,t))},e.prototype.startCreate=function(){this.isPause=!1},e.prototype.pause=function(){this.isPause=!0,cc.director.getPhysicsManager().enabled=!1},e.prototype.resume=function(){this.isPause=!1,cc.director.getPhysicsManager().enabled=!0},e.prototype.doSkillPause=function(){this.skillPause=!0,cc.director.getPhysicsManager().enabled=!1},e.prototype.doSkillResume=function(){this.skillPause=!1,cc.director.getPhysicsManager().enabled=!0},e.prototype.createEnemy=function(t){if(this.createTime-=t,this.createTime<=0&&!this.canCheck){var e=d.default.getInstance().getLevelCfgByID(this.nowLevel);this.createTime=e.roundTime,this.nowLevel++,this.restWave--,this.lastRound.string=this.restWave+"";var o=cc.instantiate(this.enemyArr[e.stoneID]),i=this.PosArr[Math.floor(Math.random()*this.PosArr.length)];o.parent=this.node,o.setPosition(i);var n=new f(o,this.monsterID);if(this.stoneArr.push(n),o.getComponent(h.default).initNode(e,this.monsterID--),this.nowLevel>d.default.getInstance().getLevelCfg().length)return void(this.canCheck=!0)}},e.prototype.getEnemyPosY=function(t){var e=2e3;for(var o in this.stoneArr){var i=this.stoneArr[o].node;this.checkInRange(i,t)&&i.y<e&&(e=i.y)}return e},e.prototype.checkInRange=function(t,e){var o=Math.abs(t.x-e.x)<=300;return cc.isValid(t)&&o},e.prototype.checkCollider=function(t,e,o,i){for(var n in this.stoneArr){var a=this.stoneArr[n].node;if(cc.isValid(a)&&a.getComponent(h.default).checkCollider(t,e,o,i))return this.stoneArr[n].idx}return-1},e.prototype.checkSkillCollider=function(t,e){for(var o in this.stoneArr){var i=this.stoneArr[o].node;cc.isValid(i)&&i.getComponent(h.default).checkSkillCollider(t,e)}},e.prototype.contrlStone=function(t){for(var e=0;e<this.stoneArr.length;e++){var o=this.stoneArr[e].node;cc.isValid(o)?o.getComponent(h.default).onUpdate(t):(this.stoneArr.splice(e,1),e--)}},e.prototype.checkWin=function(){this.canCheck&&0==this.node.children.length&&(this.openUI(p.STO_UIID.UIResult,!0),p.Global.isDown=!0)},e.prototype.doShakeByDt=function(t){if(void 0===t&&(t=0),this.nowSharkTime-=t,this.nowSharkTime<=0){this.nowSharkTime=this.sharkTime;var e=d.default.getInstance().getParam(u.enumBasicParaCfg.groundQuake);for(var o in this.stoneLayer.children)this.shakeNode(this.stoneLayer.children[o],.05,e,this.stoneLayer.children[o].position)}},e.prototype.doShakeByRect=function(){var t=d.default.getInstance().getParam(u.enumBasicParaCfg.groundQuake);for(var e in this.stoneLayer.children)this.shakeNode(this.stoneLayer.children[e],.05,t,this.stoneLayer.children[e].position)},e.prototype.shakeNode=function(t,e,o,i){cc.tween(t).by(e,{position:cc.v3(-1*o,-1*o)}).by(e,{position:cc.v3(2*o,1*o)}).by(e,{position:cc.v3(-2*o,0*o)}).by(e,{position:cc.v3(2*o,-1*o)}).by(e,{position:cc.v3(-1*o,1*o)}).set({position:i}).start()},e.prototype.start=function(){},e.prototype.update=function(t){this.isPause||this.skillPause||(this.createEnemy(t),this.contrlStone(t))},e.prototype.onDestroy=function(){this.stoneArr=[]},c([y(cc.Prefab)],e.prototype,"enemyArr",void 0),c([y(cc.Label)],e.prototype,"lastRound",void 0),c([y(cc.Node)],e.prototype,"stoneLayer",void 0),o=c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],STO_mateCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"793abcmioFMFYF+fkDZmdMb","STO_mateCtrl");var i=t,n=e,a=o;cc._RF.push(n,"793abcmioFMFYF+fkDZmdMb","STO_mateCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Config"),u=i("STO_Configs"),d=i("STO_DataMgr"),h=i("STO_HeroCtrl"),f=i("STO_mateSkillCtrl"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e.maxCDTime=0,e.cdTime=0,e.mateSkillAttack=1,e.mateID=1,e.isPause=!1,e}return s(e,t),e.prototype.initNode=function(t){this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=this,e=d.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=e.mateCDtime,this.mateSkillAttack=e.mateSkillATK,this.loadPrefab(u.emSTOBundles.prefabs,"skills/mateSkill"+this.mateID,function(e){t.skillNode=cc.instantiate(e)})},e.prototype.initView=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID);this.skillLabel.string=t.mateName,this.cdPercent.fillRange=0,this.skillIcon.spriteFrame=this.getSpriteByName(),this.cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){if(this.cdTime<=0){var t=d.default.getInstance().getMateCfgByID(this.mateID),e=Number(t.mateRole.split(",")[0]),o=Number(t.mateRole.split(",")[1]);f.default.script.useSkill(this.mateID,h.default.script.getMaxDamage(e,o)*t.mateSkillATK,this.skillNode,new cc.Vec2(0,0))&&this.initStartUseSkill()}else this.openUI(p.UIID.UITips,"\u6280\u80fd\u6b63\u5728cd")},e.prototype.initStartUseSkill=function(){this.cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.cdLabel.string=this.cdTime+"",this.cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.cdLabel.node.active=!1,this.spNode.node.active=!0,this.spNode.setAnimation(0,"animation",!1),this.spNode.setCompleteListener(function(){e.spNode.node.active=!1})):this.cdLabel.string=this.cdTime.toFixed(0)},e.prototype.getSpriteByName=function(){var t=d.default.getInstance().getMateCfgByID(this.mateID).mateIconRes;for(var e in this.spArr)if(t==this.spArr[e].name)return this.spArr[e]},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.onLoad=function(){this.addEvent(u.emSTOEventName.pause,this.pause),this.addEvent(u.emSTOEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.cdTime>0&&!this.isPause&&this.refreshSkillView(t)},c([y(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([y(cc.Label)],e.prototype,"cdLabel",void 0),c([y(cc.Label)],e.prototype,"skillLabel",void 0),c([y(cc.Sprite)],e.prototype,"cdPercent",void 0),c([y(cc.Sprite)],e.prototype,"skillIcon",void 0),c([y(sp.Skeleton)],e.prototype,"spNode",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],STO_mateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"bf04dUQ9EhDxoqGH8QDUPMu","STO_mateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"bf04dUQ9EhDxoqGH8QDUPMu","STO_mateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("STO_mateSkill"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){var n=this;return!this.isSkill&&(this.isSkill=!0,this.scheduleOnce(function(){n.isSkill=!1},.5),o.parent=this.node,o.getComponent(p.default).useSkill(i,e,t),!0)},e.prototype.onLoad=function(){o.script=this},e.prototype.start=function(){},e.prototype.update=function(){},c([h(cc.Label)],e.prototype,"label",void 0),c([h(cc.Node)],e.prototype,"banner",void 0),c([h],e.prototype,"text",void 0),o=c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],STO_mateSkill:[function(t,e,o){"use strict";cc._RF.push(e,"88d204zyzhHe71MKemV1dgh","STO_mateSkill");var i=t,n=e,a=o;cc._RF.push(n,"88d204zyzhHe71MKemV1dgh","STO_mateSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("STO_Configs"),d=i("STO_DataMgr"),h=i("STO_enemyCtrl"),f=i("STO_Hero"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){if("attack"==o.data.name){var i=d.default.getInstance().getMateCfgByID(t.index);if(3==t.index)p.EventMgr.getInstance().emit(u.emSTOEventName.skillPause),t.scheduleOnce(function(){p.EventMgr.getInstance().emit(u.emSTOEventName.skillResume)},Number(i.matePara));else if(1==t.index)for(var n in u.Global.heroID)1!=u.Global.heroID[n].id&&7!=u.Global.heroID[n].id||u.Global.heroID[n].node.getComponent(f.default).addAttackSpeed(1,Number(i.matePara));t.doAttack()}})},e.prototype.useSkill=function(t,e,o){var i=d.default.getInstance().getMateCfgByID(o);l.AudioMgr.getInstance().playEffect(i.mateSound),this.index=o,this.spAni.setAnimation(0,"animation",!1),this.node.setPosition(t.x,h.default.script.getEnemyPosY(this.node.getPosition())),this.damage=e},e.prototype.update=function(){},e.prototype.doAttack=function(){h.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([y({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([y({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([y({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([y({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([y({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([g],e)}(cc.Component);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],ScrollCard:[function(t,e,o){"use strict";cc._RF.push(e,"b1877HaMcVEF6GCqRPtlynm","ScrollCard");var i=e,n=o;cc._RF.push(i,"b1877HaMcVEF6GCqRPtlynm","ScrollCard");var a,r,s=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.Direction=void 0,function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(r=n.Direction||(n.Direction={})),cc.Enum(r);var l=cc._decorator,p=l.ccclass,u=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Direction=r.Horizontal,e.itemOffset=0,e.speed=500,e.rub=1,e.scaleMin=.5,e.scaleMax=1,e.item=[],e.itemSize=5,e.itemNode=null,e._startTime=0,e._moveSpeed=0,e.uiTransform=null,e.itemList=[],e.canTouch=!0,e.invert=0,e.speedTime=0,e}return s(e,t),e.prototype.start=function(){var t=this;this.uiTransform=this.node,this.node.on(cc.Node.EventType.TOUCH_START,function(){t.canTouch&&(t._moveSpeed=0,t._startTime=(new Date).getTime())}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(t.canTouch){var o=e.getDelta();t.itemMoveBy(o)}}),this.node.on(cc.Node.EventType.TOUCH_END,function(e){t.canTouch&&t.touchEnd(e)}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){t.canTouch&&t.touchEnd(e)})},e.prototype.init=function(){for(var t=0;t<this.itemSize;t++){var e=cc.instantiate(this.itemNode);e.active=!0,e.parent=this.node,this.item.push(e)}this._initItemPos(),this.updateScale()},e.prototype.autoScroll=function(t,e){var o=this;this.canTouch=!1,this.speedTime=t,this.offset=e,this.schedule(function(){o.invert+=.01,o.invert>=o.speedTime&&(o.invert=0,o.scrollOffset(o.offset))},0)},e.prototype.changleScrollSpeed=function(t,e){this.speedTime=t,this.offset=e},e.prototype.stopAutoScroll=function(){this.unscheduleAllCallbacks()},e.prototype.scrollOffset=function(t){this.itemMoveBy(t)},e.prototype.touchEnd=function(t){var e,o=t.getLocation(),i=t.getStartLocation();e=0==this.Direction?i.x-o.x:i.y-o.y;var n=(new Date).getTime()-this._startTime;this._moveSpeed=e/n},e.prototype._initItemPos=function(){this.uiTransform.anchorY=.5,this.uiTransform.anchorX=.5,this._maxSize=new cc.Size(0,0);for(var t=0;t<this.item.length;t++)this._maxSize.width+=this.item[t].width,this._maxSize.height+=this.item[t].height,this._maxSize.width+=this.itemOffset,this._maxSize.height+=this.itemOffset;var e;for(e=0==this.Direction?new cc.Vec2(-this._maxSize.width*this.uiTransform.anchorX,-this._maxSize.height*this.uiTransform.anchorY):new cc.Vec2(this._maxSize.width*this.uiTransform.anchorX,this._maxSize.height*this.uiTransform.anchorY),this._screenRect=new cc.Rect(e.x,e.y,this._maxSize.width,this._maxSize.height),this.itemList=[],t=0;t<this.item.length;t++){var o=this.item[t].getAnchorPoint(),i=this.item[t].getContentSize();0==this.Direction?(e=e.add(new cc.Vec2(i.width*o.x,i.height*o.y)),this.item[t].position=new cc.Vec3(e.x,0,0),e=(e=e.add(new cc.Vec2(i.width*o.x,i.height*o.y))).add(new cc.Vec2(this.itemOffset,this.itemOffset))):(e=e.subtract(new cc.Vec2(i.width*o.x,i.height*o.y)),this.item[t].position=new cc.Vec3(0,e.y,0),e=(e=e.subtract(new cc.Vec2(i.width*o.x,i.height*o.y))).subtract(new cc.Vec2(this.itemOffset,this.itemOffset))),this.itemList[t]=this.item[t]}},e.prototype.updateScale=function(){if(!(this.scaleMax<this.scaleMin||0==this.scaleMax))for(var t=0;t<this.item.length;t++){var e;if(0==this.Direction){var o=this.item[t].position.x+this._maxSize.width/2;e=this.item[t].position.x<0?o/this._maxSize.width:1-o/this._maxSize.width}else{var i=this.item[t].position.y+this._maxSize.height/2;e=this.item[t].position.y<0?i/this._maxSize.height:1-i/this._maxSize.height}e*=2;var n=this.scaleMax-this.scaleMin;n*=e,n+=this.scaleMin,n=Math.abs(n),this.item[t].scale=n}},e.prototype.itemMoveBy=function(t){for(var e=0;e<this.item.length;e++){var o=this.item[e].position;if(0==this.Direction){var i=new cc.Vec3(o.x+t.x,o.y,0);this.item[e].position=i}else i=new cc.Vec3(o.x,o.y+t.y,0),this.item[e].position=i}this.updatePos()},e.prototype.updatePos=function(){var t=this.itemList[0],e=this.itemList[this.itemList.length-1],o=!1;if(0==this.Direction?t.position.x<-this._maxSize.width/2&&(o=!0):t.position.y>this._maxSize.width/2&&(o=!0),o){var i=this.itemList.shift();this.itemList.push(i);var n=i.position;if(0==this.Direction){var a=e.position.x+e.width+this.itemOffset;i.position=new cc.Vec3(a,n.y,0)}else{var r=e.position.y-e.height-this.itemOffset;i.position=new cc.Vec3(n.x,r,0)}}var s=!1;0==this.Direction?e.position.x>this._maxSize.width/2&&(s=!0):e.position.y<-this._maxSize.height/2&&(s=!0),s&&(i=this.itemList.pop(),this.itemList.unshift(i),n=i.position,0==this.Direction?(a=t.position.x-t.width-this.itemOffset,i.position=new cc.Vec3(a,n.y,0)):(r=t.position.y+t.height+this.itemOffset,i.position=new cc.Vec3(n.x,r,0))),this.updateScale()},e.prototype.update=function(t){if(0!=this._moveSpeed){for(var e=0;e<this.item.length;e++){var o=this.item[e].position;if(0==this.Direction){var i=this._moveSpeed*t*this.speed;this.item[e].position=new cc.Vec3(o.x-i,o.y,0)}else{var n=this._moveSpeed*t*this.speed;this.item[e].position=new cc.Vec3(o.x,o.y-n,0)}}this._moveSpeed>0?(this._moveSpeed-=t*this.rub,this._moveSpeed<0&&(this._moveSpeed=0)):(this._moveSpeed+=t*this.rub,this._moveSpeed>0&&(this._moveSpeed=0));var a=-this._moveSpeed*t*this.speed;this.itemMoveBy(new cc.Vec2(a,a)),this.updatePos()}},c([u({type:r,tooltip:"\u6ed1\u52a8\u65b9\u5411"})],e.prototype,"Direction",void 0),c([u({type:cc.Integer,tooltip:"node \u95f4\u9694"})],e.prototype,"itemOffset",void 0),c([u({type:cc.Integer,tooltip:"\u79fb\u52a8\u901f\u5ea6"})],e.prototype,"speed",void 0),c([u({type:cc.Float,tooltip:"\u51cf\u901f\u9891\u7387"})],e.prototype,"rub",void 0),c([u({type:cc.Float,tooltip:"\u7f29\u653e\u6700\u5c0f\u503c"})],e.prototype,"scaleMin",void 0),c([u({type:cc.Float,tooltip:"\u7f29\u653e\u6700\u5927\u503c"})],e.prototype,"scaleMax",void 0),c([u({type:[cc.Node],tooltip:"\u6eda\u52a8item"})],e.prototype,"item",void 0),c([u({type:cc.Integer})],e.prototype,"itemSize",void 0),c([u({type:cc.Node})],e.prototype,"itemNode",void 0),c([p],e)}(cc.Component);n.default=d,cc._RF.pop(),cc._RF.pop()},{}],SdkMgr:[function(t,e,o){"use strict";cc._RF.push(e,"52ff1345pJFtoi3ptmswq3e","SdkMgr");var i=t,n=e,a=o;cc._RF.push(n,"52ff1345pJFtoi3ptmswq3e","SdkMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.SdkMgr=a.AdType=void 0;var r=i("Config"),s=i("AudioMgr"),c=i("LogMgr"),l=i("PlatformManager"),p=i("UIMgr"),u=i("PlayerMgr"),d=i("EventMgr"),h=i("Appcfg"),f=i("AppManager");!function(t){t[t.ReissueSign=0]="ReissueSign",t[t.FreeLotty=1]="FreeLotty",t[t.Collection=2]="Collection",t[t.AdFreeTime=3]="AdFreeTime"}(a.AdType||(a.AdType={}));var m=function(){function t(){}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.playVideo=function(t,e,o){s.AudioMgr.getInstance().pauseAllMusic(),d.EventMgr.getInstance().emit(h.BaseEventName.blocktouch,!1),l.PlatformManager.getInstance().showVideoAd("",t,function(){d.EventMgr.getInstance().emit(h.BaseEventName.blocktouch,!0),s.AudioMgr.getInstance().resumeAllMusic(),e&&e()},function(t){s.AudioMgr.getInstance().resumeAllMusic(),d.EventMgr.getInstance().emit(h.BaseEventName.blocktouch,!0),c.LogMgr.getInstance().debug("\u64ad\u653e\u5e7f\u544a\u5931\u8d25"),t&&t.length&&p.UIMgr.getInstance().openUI(r.UIID.UITips,-1,t),o&&o()})},t.prototype.playMultitonVideo=function(t,e,o,i,n,a){s.AudioMgr.getInstance().pauseAllMusic(),d.EventMgr.getInstance().emit(h.BaseEventName.blocktouch,!1),l.PlatformManager.getInstance().playMultitonVideo(t,e,o,function(t){d.EventMgr.getInstance().emit(h.BaseEventName.blocktouch,!0),s.AudioMgr.getInstance().resumeAllMusic(),i&&i(t)},function(t){s.AudioMgr.getInstance().resumeAllMusic(),d.EventMgr.getInstance().emit(h.BaseEventName.blocktouch,!0),c.LogMgr.getInstance().debug("\u64ad\u653e\u5e7f\u544a\u5931\u8d25"),t&&t.length&&p.UIMgr.getInstance().openUI(r.UIID.UITips,-1,t),n&&n()},a)},t.prototype.showInsert=function(t){s.AudioMgr.getInstance().pauseAllMusic(),l.PlatformManager.getInstance().showInsertAd(t,function(){s.AudioMgr.getInstance().resumeAllMusic()})},t.prototype.showBanner=function(t){l.PlatformManager.getInstance().showBanner(t)},t.prototype.hideBanner=function(){l.PlatformManager.getInstance().hideBanner()},t.prototype.getUserInfo=function(t){l.PlatformManager.getInstance().getUserInfo(t)},t.prototype.requestCheckVersion=function(t){f.IAppManager.requestCheckVersion(t)},t.prototype.getCheckVersion=function(t){return f.IAppManager.getCheckVersion(t)},t.prototype.hasVerify=function(){return l.PlatformManager.getInstance().hasVerify()},t.prototype.recordScreen=function(){l.PlatformManager.getInstance().recordVideo()},t.prototype.pauseRecord=function(){l.PlatformManager.getInstance().pauseRecord()},t.prototype.restartRecord=function(){l.PlatformManager.getInstance().resumeRecord()},t.prototype.resumeRecord=function(){l.PlatformManager.getInstance().resumeRecord()},t.prototype.shareImg=function(t,e){l.PlatformManager.getInstance().shareImg(t,e)},t.prototype.share=function(t,e){l.PlatformManager.getInstance().shareVideo(t,e)},t.prototype.getShare=function(){return l.PlatformManager.getInstance().canShare()},t.prototype.stopRecord=function(t,e){l.PlatformManager.getInstance().stopRecorderManager(t,e)},t.prototype.openNotify=function(){l.PlatformManager.getInstance().openNotify()},t.prototype.toAppStore=function(){u.PlayerMgr.getInstance().getTrackData().getToAppStore()||l.PlatformManager.getInstance().toAppStore(function(t){1==t&&u.PlayerMgr.getInstance().getTrackData().setToAppStore()})},t.prototype.getSystem=function(){return l.PlatformManager.getInstance().getSystem()},t.prototype.getIsIos=function(){return l.PlatformManager.getInstance().getSystem()==r.SystemPlatform.IOS},t.prototype.getIsAndroid=function(){return l.PlatformManager.getInstance().getSystem()==r.SystemPlatform.ANDROID},t.prototype.shark=function(t){void 0===t&&(t=0),l.PlatformManager.getInstance().shark(t)},t.prototype.checkShortcut=function(t,e){l.PlatformManager.getInstance().checkShortcut(t,e)},t.prototype.addShortcut=function(t,e){l.PlatformManager.getInstance().addShortcut(t,e)},t.prototype.checkCanOpenSideBar=function(t){l.PlatformManager.getInstance().checkCanOpenSideBar(t)},t.prototype.openSideBar=function(t){l.PlatformManager.getInstance().openSideBar(t)},t.prototype.isFromBroadside=function(t){return l.PlatformManager.getInstance().isFromBroadside(t)},t}();a.SdkMgr=m,cc._RF.pop(),cc._RF.pop()},{}],SegBaseData:[function(t,e,o){"use strict";cc._RF.push(e,"ca7a4ASNJRJqqWZ1hCQogTc","SegBaseData");var i=t,n=e,a=o;cc._RF.push(n,"ca7a4ASNJRJqqWZ1hCQogTc","SegBaseData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.SegBaseData=a.SegData=void 0;var c=i("CacheUtils"),l=i("ServerDataMgr"),p=i("BaseData"),u=i("EventMgr"),d=i("Utils");a.SegData=function(){this.maxNum=0};var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.len=30,e.saveMap=new Map,e.timeMap=new Map,e.changleIndex=new Set,e}return s(e,t),e.prototype.getData=function(){var t=this;return null==this.data?(u.EventMgr.getInstance().on("CLEARDATA",this,function(e){t.pause=e}),cc.game.on(cc.game.EVENT_HIDE,function(){t.saveMap.forEach(function(e,o){var i=o,n=null;0==o?(n=JSON.parse(JSON.stringify(t.data)))[t.ListName]=t.data[t.ListName].slice(i*t.len,(i+1)*t.len):(n={list:t.data[t.ListName].slice(i*t.len,(i+1)*t.len)})[t.savetimeKey]=t.timeMap.get(t.gameKey+i),t.UpdateData2(n,e)})},this),setInterval(function(){t.saveMap.forEach(function(e,o){var i=o,n=null;0==o?(n=JSON.parse(JSON.stringify(t.data)))[t.ListName]=t.data[t.ListName].slice(i*t.len,(i+1)*t.len):(n={list:t.data[t.ListName].slice(i*t.len,(i+1)*t.len)})[t.savetimeKey]=t.timeMap.get(t.gameKey+i),t.UpdateData2(n,e)})},1e3),function e(o){var i,n=l.ServerdataMgr.getDataByKey(t.gameKey+o);if(0==o)n?(t.data=t.loaddata(n,t.gameKey+o,!0),e(o+1)):t.loadlocaldata();else if(n){var a=t.loaddata(n,t.gameKey+o,!1);Array.isArray(a)||(t.timeMap.set(t.gameKey+o,a[t.savetimeKey]),a=a.list),(i=t.data[t.ListName]).push.apply(i,a),e(o+1)}else t.initData(!1)}(0),this.data):this.data},e.prototype.loadlocaldata=function(){for(var t,e=!1,o=0;;o++){var i=this.ecrypt?c.CacheUtils.getDataDecrypt(this.gameKey+o,this.pwd):c.CacheUtils.getData(this.gameKey+o);if(0==o){if(!i)break;this.data=d.Utils.restoreObjectKeys(JSON.parse(i),this.aliseMap),e=!0}else{if(!i)break;var n=d.Utils.restoreObjectKeys(JSON.parse(i),this.aliseMap);Array.isArray(n)||(this.timeMap.set(this.gameKey+o,n[this.savetimeKey]),n=n.list),(t=this.data[this.ListName]).push.apply(t,n)}}e?this.initData(!1):(this.data=this.createData(),this.initData(!0))},e.prototype.saveData=function(e){var o=this;if(!this.pause)if(e||0==e)if(this.data[this.ListName]){var i=Math.floor(this.data[this.ListName].length/this.len),n=this.data.maxNum,a=Math.max(n,i);if(n!=a&&(this.data.maxNum=a,this.changleIndex.add(0)),-1==e)for(var r=0;r<=n;r++)this.changleIndex.add(r);else this.changleIndex.add(e);this.changleIndex.forEach(function(t){var e=t,i=null,n=o.timeMap.get(o.gameKey+e);0==e?((i=JSON.parse(JSON.stringify(o.data)))[o.ListName]=o.data[o.ListName].slice(e*o.len,(e+1)*o.len),o.data[o.savetimeKey]=n||Number(((new Date).getTime()/1e3).toFixed(0))):(i={list:o.data[o.ListName].slice(e*o.len,(e+1)*o.len)})[o.savetimeKey]=n||Number(((new Date).getTime()/1e3).toFixed(0)),o.ecrypt?c.CacheUtils.saveDataEncrypt(o.gameKey+e,JSON.stringify(d.Utils.renameObjectKeys(i,o.aliseMap)),o.pwd):c.CacheUtils.saveData(o.gameKey+e,JSON.stringify(d.Utils.renameObjectKeys(i,o.aliseMap))),l.ServerdataMgr.getNeedSaveServer()&&o.UpdateData2(i,e)}),this.changleIndex.clear()}else t.prototype.saveData.call(this,-1);else console.error("!!!!!!!!!!!!key\u7684\u540e\u7f00\u4e0d\u80fd\u4e3a\u7a7a!!!!!!")},e.prototype.UpdateData2=function(t,e){void 0===e&&(e=0);var o=t[this.savetimeKey],i=Number(((new Date).getTime()/1e3).toFixed(0));if(o&&i-o<this.invertTime)this.saveMap.set(e,e);else{this.saveMap.delete(e),this.timeMap.set(this.gameKey+e,i);var n=JSON.stringify(d.Utils.renameObjectKeys(t,this.aliseMap));l.ServerdataMgr.saveData(this.gameKey+e,n,function(){})}},e.prototype.clearData=function(){for(var t=0;t<this.data.maxNum;t++)localStorage.removeItem(this.gameKey+t)},e}(p.BaseData);a.SegBaseData=h,cc._RF.pop(),cc._RF.pop()},{}],ServerDataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"9588dnmtitKLJXSTMu1BQy/","ServerDataMgr");var i=t,n=e,a=o;cc._RF.push(n,"9588dnmtitKLJXSTMu1BQy/","ServerDataMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.ServerdataMgr=void 0;var r=i("BasePlatform"),s=i("PlatformConfig"),c=i("PlatformSetting"),l=i("EventMgr"),p=i("PlatformManager"),u=i("CacheUtils"),d=i("ByteDanceServerMgr"),h=i("WeachatServerMgr"),f=function(){function t(){this.url="https://yuema.sfplay.net:8050",this.serversavedFlagKey="serversaveflag",this.isSendServerFlag=!1,this.isGetServer=!1,this.isInited=!1,this.isPause=!1}return t.prototype.init=function(t){var e=this;if(this.isInited)t&&t();else{this.isInited=!0;var o=s.ServerDataCfg[c.PlatformSetting.currentApp];o&&(this.appId=o.serverdataid,this.wechatOpened=o.wechatOpened,this.douyinOpened=o.douyinOpened),p.PlatformManager.currentPlatform==r.Platform.WECHAT?this.curServer=new h.WeachatServerMgr(this.url,this.appId,this.wechatOpened):p.PlatformManager.currentPlatform==r.Platform.BYTEDANCE&&(this.curServer=new d.ByteDanceServerMgr(this.url,this.appId,this.douyinOpened)),this.curServer?this.curServer.init(function(){e.loadData(t,!0)}):t&&t()}},t.prototype.getNeedSaveServer=function(){return!!this.curServer&&this.curServer.getNeedSaveServer()},t.prototype.getOpenId=function(t){this.curServer?this.curServer.getOpenId(function(e){t(e)}):(p.PlatformManager.currentPlatform==r.Platform.WECHAT?this.curServer=new h.WeachatServerMgr(this.url,this.appId,this.wechatOpened):p.PlatformManager.currentPlatform==r.Platform.BYTEDANCE&&(this.curServer=new d.ByteDanceServerMgr(this.url,this.appId,this.douyinOpened)),this.curServer&&this.curServer.getOpenId(function(e){t(e)},!0))},t.prototype.loadData=function(t,e){if(void 0===e&&(e=!1),this.curServer){var o=localStorage.getItem(this.serversavedFlagKey);if(e)return void this.curServer.loadData(t);!this.isGetServer&&(o&&"1"==o||this.isSendServerFlag)?t&&t():(this.isGetServer=!0,this.curServer.loadData(t))}else t&&t()},t.prototype.saveData=function(t,e,o){this.curServer&&!this.isPause?this.curServer.saveData(t,e,o):o&&o()},t.prototype.clearAllData=function(t){var e=this;this.clearCb=t;var o=function(){e.isPause=!0,l.EventMgr.getInstance().emit("CLEARDATA",!0),u.CacheUtils.clearAll(),e.curServer?e.curServer.clearAllData(function(t){t||(e.isPause=!1,l.EventMgr.getInstance().emit("CLEARDATA",!1)),e.clearCb&&e.clearCb(t)}):p.PlatformManager.currentPlatform==r.Platform.WECHAT?wx.restartMiniProgram({success:function(){}}):p.PlatformManager.currentPlatform==r.Platform.BYTEDANCE?tt.restartMiniProgramSync():cc.game.end()};p.PlatformManager.currentPlatform==r.Platform.WECHAT?wx.showModal({title:"\u8b66\u544a",content:"\u6e05\u9664\u6570\u636e\u540e\u5c06\u53d8\u6210\u65b0\u7528\u6237\u5e76\u4e14\u4f1a\u91cd\u542f\u6e38\u620f\uff0c\u786e\u5b9a\u6e05\u9664\u5417\uff1f",success:function(t){t.confirm?o():t.cancel}}):p.PlatformManager.currentPlatform==r.Platform.BYTEDANCE?tt.showModal({title:"\u8b66\u544a",content:"\u6e05\u9664\u6570\u636e\u540e\u5c06\u53d8\u6210\u65b0\u7528\u6237\u5e76\u4e14\u4f1a\u91cd\u542f\u6e38\u620f\uff0c\u786e\u5b9a\u6e05\u9664\u5417\uff1f",success:function(t){t.confirm?o():t.cancel}}):o()},t.prototype.clearDataByKey=function(t,e){this.curServer?this.curServer.clearDataByKey(t,e):e&&e()},t.prototype.getDataByKey=function(t){return this.curServer?this.curServer.getDataByKey(t):null},t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t}();a.ServerdataMgr=f.getInstance(),cc._RF.pop(),cc._RF.pop()},{}],SfSendQueue:[function(t,e,o){"use strict";cc._RF.push(e,"eaab51sPP1E57BwfCHeM576","SfSendQueue");var i=e,n=o;cc._RF.push(i,"eaab51sPP1E57BwfCHeM576","SfSendQueue"),Object.defineProperty(n,"__esModule",{value:!0}),n.SfTrackHttp=n.SfTrackUtils=n.SfTrackHttpTask=n.SendConfig=n.SendQueue=n.SfTrackSendQueue=void 0;var a=function(){function t(){this.isRunning=!1,this.items=[],this.isRunning=!1}return t.prototype.enqueue=function(t,e,o,i,n){var a=this;void 0===i&&(i=!0);var c=this,l=new r(t,e,o.maxRetries,function(t){c.isRunning=!1,s.isFunction(o.callback)&&o.callback(t),c._runNext()},n);!0===i?(this.items.push(l),setTimeout(function(){a._runNext()},500)):l.run()},t.prototype._dequeue=function(){return this.items.shift()},t.prototype._runNext=function(){if(this.items.length>0&&!this.isRunning)if(this.isRunning=!0,"HttpTask"!==this.items[0].taClassName)this._dequeue().run();else{for(var t=this.items.splice(0,this.items.length),e=t[0],o=e.data,i=e.callback,n=1;n<t.length;n++){var a=t[n],s=a.data;-1!=e.serverUrl.indexOf("saveData")&&e.serverUrl===a.serverUrl&&o.key&&s.key&&o.key==s.key?e.createtime<a.createtime&&(o=s,e=a):this.items.push(a)}new r(o,e.serverUrl,e.tryCount,i).run()}},t}();n.SfTrackSendQueue=a,n.SendQueue=new a,n.SendConfig=function(){this.maxRetries=5};var r=function(){function t(t,e,o,i,n){this.tryCount=0,this.createtime=0,this.taClassName="HttpTask",this.data=t,this.serverUrl=e,this.callback=i,this.tryCount=o||1,this.createtime=(new Date).getTime(),n&&(this.taClassName=n)}return t.prototype.run=function(){var t=this;c.httpPost(this.serverUrl,this.data,function(e){e?t.onSuccess(e):t.onFailed()})},t.prototype.onSuccess=function(t){this.callback&&this.callback(t)},t.prototype.onFailed=function(){var t=this;--this.tryCount>0?setTimeout(function(){t.run()},1e3):this.callback({code:-3,msg:"\u8bf7\u6c42\u5931\u8d25"})},t}();n.SfTrackHttpTask=r;var s=function(){function t(){}return t.is=function(t,e){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.isNumber=function(t){return this.is(t,"Number")},t.isFunction=function(t){return this.is(t,"Function")},t.createUUID=function(){return this.getRandomStr(10)+Date.now()+this.getRandomStr(7)+this.UUID_SUFFIX},t.getRandomStr=function(t){for(var e="",o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],i=0;i<t;i++)e+=o[Math.round(Math.random()*(o.length-1))];return e},t.UUID_SUFFIX="ud",t}();n.SfTrackUtils=s;var c=function(){function t(){}return t.httpGet=function(t,e,o){var i=this.xhrM?this.xhrM:this.xhrM=new XMLHttpRequest;if(e){var n="";Object.keys(e).forEach(function(t){n+=t+"="+encodeURIComponent(e[t])+"&"}),""!==n&&(t=t+"?"+(n=n.substr(0,n.lastIndexOf("&"))))}i.open("GET",t,!0),i.setRequestHeader("Access-Control-Allow-Origin","*"),i.setRequestHeader("Access-Control-Allow-Methods","GET, POST"),i.setRequestHeader("Access-Control-Allow-Headers","x-requested-with,content-type"),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Connection","keep-alive"),i.setRequestHeader("Accept-Encoding","gzip, deflate, br, compress, zstd"),i.onreadystatechange=function(){if(4===i.readyState)if(i.status>=200&&i.status<300){var t=i.responseText;try{o&&t?o(JSON.parse(t)):o&&o({code:-1})}catch(t){o&&o({code:-1,msg:"\u89e3\u6790\u9519\u8bef"})}}else o({code:-1})},i.ontimeout=function(){o&&o({code:-1})},i.onerror=function(){o&&o({code:-1})},i.send()},t.httpPost=function(t,e,o){var i;void 0===e&&(e=null),i=JSON.stringify(e);var n=t,a=this.xhrM?this.xhrM:this.xhrM=new XMLHttpRequest;a.timeout=7e3,a.open("POST",n,!0),a.setRequestHeader("Access-Control-Allow-Origin","*"),a.setRequestHeader("Access-Control-Allow-Methods","GET, POST"),a.setRequestHeader("Access-Control-Allow-Headers","x-requested-with,content-type"),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Token",this.TOKEN),a.setRequestHeader("Connection","keep-alive"),a.setRequestHeader("Accept-Encoding","gzip"),a.onreadystatechange=function(){if(4===a.readyState)if(a.status>=200&&a.status<400){var t=a.responseText;try{o&&t?o(JSON.parse(t)):o&&o({code:0})}catch(t){o&&o({code:0,msg:"\u89e3\u6790\u9519\u8bef"})}}else o&&o&&o({code:-1,msg:"\u8bf7\u6c42\u5931\u8d25"})},a.ontimeout=function(){o&&o({code:-1,msg:"\u8bf7\u6c42\u8d85\u65f6"})},a.onerror=function(){o&&o({code:-1,msg:"\u8bf7\u6c42\u9519\u8bef"})},i?a.send(i):a.send()},t}();n.SfTrackHttp=c,cc._RF.pop(),cc._RF.pop()},{}],SocketMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a4a20Nv3s9OWYMdBgiUUvyc","SocketMgr");var i=t,n=e,a=o;cc._RF.push(n,"a4a20Nv3s9OWYMdBgiUUvyc","SocketMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r,s=i("NetInterface"),c=i("NetManager"),l=i("NetNode"),p=i("WebSock");!function(t){t[t.stoped=-1]="stoped",t[t.started=0]="started"}(r||(r={}));var u=function(){function t(){}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.startSocket=function(t,e,o,i){var n=this;if(void 0===i&&(i=!1),!this.netNode){this.wsUrl=t,this.roomId=e,this.appId=o;var a=new l.NetNode;this.netNode=a;var u=new p.WebSock;a.init(u,new s.DefStringProtocol,null),a.setResponeHandler(0,function(t,e){var o=e;n.onMsg(o)}),a.setOnServerStatus(function(t){t==r.stoped||r.started});var d=this.wsUrl+"?roomId="+this.roomId+"&appId="+this.appId+"&test="+(i?"1":"0");c.NetManager.getInstance().setNetNode(a),c.NetManager.getInstance().connect({url:d,autoReconnect:-1})}},t.prototype.onMsg=function(t){this.onmsgFun&&this.onmsgFun(t)},t.prototype.setOnMsg=function(t){this.onmsgFun=t},t.prototype.sendMsg=function(t,e){void 0===e&&(e=!0);var o={data:e?JSON.stringify(t):t},i=JSON.stringify(o);c.NetManager.getInstance().send(i)},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],SpineUtils:[function(t,e,o){"use strict";cc._RF.push(e,"13366sIhypKi7rqHbO0qedQ","SpineUtils");var i=t,n=e,a=o;cc._RF.push(n,"13366sIhypKi7rqHbO0qedQ","SpineUtils"),Object.defineProperty(a,"__esModule",{value:!0}),a.SpineUtils=a.SpineInfo=void 0;var r=i("ResourceMgr"),s=function(){};a.SpineInfo=s;var c=function(){function t(){}return t.changePartImgBundle=function(t,e,o,i){var n=this;null==i&&(i=new s),r.ResourceMgr.getInstance().loadRes(i.imgbundle,i.imgPath,cc.Texture2D,function(a){a.handleLoadedTexture(!0);var r=n.getAtt(t,e,o),s=n.CreateRegion(a,i);r.region=s,r&&(r.setRegion(s),r.updateOffset())})},t.changePartImgTexture=function(t,e,o,i,n){if(null==n&&(n=new s),i.handleLoadedTexture(!0),cc.sys.isNative){var a=new middleware.Texture2D;a.setPixelsHigh(i.height),a.setPixelsWide(i.width),a.setNativeTexture(i.getImpl());var r=n.diffWidth?i.width+n.diffWidth:i.width,c=n.diffHeight?i.height+n.diffHeight:i.height,l=n.offsetX?n.offsetX:0,p=n.offsetY?n.offsetY:0;t.updateRegion(e,a,c,r,l,p)}else{var u=this.getAtt(t,e,o),d=this.CreateRegion(i,n);u.region=d,u&&(u.setRegion(d),this.updateSize(u),u.updateOffset())}},t.setPlayFrame=function(t,e,o){var i=t.getCurrent(0);i.animationStart=e,i.animationEnd=o},t.getAtt=function(t,e,o){t.findSlot(e);var i=t.skeletonData.getRuntimeData(),n=i.findSlotIndex(e);return i.findSkin("default").getAttachment(n,o)},t.CreateRegion=function(t,e){var o=new sp.SkeletonTexture;o.setRealTexture(t);var i=new sp.spine.TextureAtlasPage;i.name=t.name,i.uWrap=sp.spine.TextureWrap.ClampToEdge,i.vWrap=sp.spine.TextureWrap.ClampToEdge,i.texture=o,i.texture.setWraps(i.uWrap,i.vWrap),i.width=t.width,i.height=t.height;var n=new sp.spine.TextureAtlasRegion;return n.page=i,n.width=t.width,n.height=t.height,n.originalWidth=e.diffWidth?t.width+e.diffWidth:t.width,n.originalHeight=e.diffHeight?t.height+e.diffHeight:t.height,n.offsetX=e.offsetX?e.offsetX:0,n.offsetY=e.offsetY?e.offsetY:0,n.rotate=!1,n.u=0,n.v=0,n.u2=1,n.v2=1,n.texture=o,n},t.updateSize=function(){},t}();a.SpineUtils=c,cc._RF.pop(),cc._RF.pop()},{}],SubGameData:[function(t,e,o){"use strict";cc._RF.push(e,"5cf32UuHLNN95XnR0io63Q1","SubGameData");var i=t,n=e,a=o;cc._RF.push(n,"5cf32UuHLNN95XnR0io63Q1","SubGameData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.subgameData=void 0;var c=i("BaseData"),l=i("Config"),p=function(){this.subgameTime=new Map},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={subgameTime:"1"},e.gameKey=l.GameConfig.AppCacheName+"subgame_udata",e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(){this.data.subgameTime||(this.data.subgameTime=new Map),this.saveData()},e.prototype.getSubgameTimeByIndex=function(t){return this.data.subgameTime?this.data.subgameTime[t]:-1},e.prototype.setSubgameTimeByIndex=function(t){var e=Date.now();this.data.subgameTime[t]=e,this.saveData()},e}(c.BaseData);a.subgameData=u,cc._RF.pop(),cc._RF.pop()},{}],SubscribeManager:[function(t,e,o){"use strict";cc._RF.push(e,"212e13yBAhEd73ibY12LciR","SubscribeManager");var i=t,n=e,a=o;cc._RF.push(n,"212e13yBAhEd73ibY12LciR","SubscribeManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.SubscribeManager=void 0;var r=i("BasePlatform"),s=i("PlatformManager"),c=function(){function t(){this.isInit=!1,this.openIdSaveKey="igame_openId",this.platformId=-1,this.type=-1,this.dyUrl="https://app.sfplay.net:5555",this.wxUrl="https://yuema.sfplay.net:8121"}return t.prototype.openSubscribeWithTime=function(t,e,o){if(!this.checkCanSend())return console.error("sf_subscribe: \u4e0d\u662f\u5bf9\u5e94\u7684\u5e73\u53f0"),void(o&&o(null));this.iLog("\u5f00\u59cb\u8ba2\u9605"),1==this.type?this.dysendServer(e,t,o):2==this.type&&this.wxsendServer(e,t,o)},t.prototype.openSubscribe=function(t,e){if(!this.checkCanSend())return console.error("sf_subscribe: \u4e0d\u662f\u5bf9\u5e94\u7684\u5e73\u53f0"),void(e&&e(null));this.iLog("\u5f00\u59cb\u8ba2\u9605"),1==this.type?this.dysendServer(t,null,e):2==this.type&&this.wxsendServer(t,null,e)},t.prototype.openSubscribeWechatVersion=function(t){if(!this.checkCanSend())return console.error("sf_subscribe: \u4e0d\u662f\u5bf9\u5e94\u7684\u5e73\u53f0"),void(t&&t(null));if(2!=this.type)return console.error("\u53ea\u6709\u5fae\u4fe1\u624d\u9700\u8981\u8c03\u7528"),void(t&&t(null));var e=wx.getSystemInfoSync().SDKVersion;this.compareVersion(e,"2.32.1")>=0&&wx.requestSubscribeSystemMessage({msgTypeList:["SYS_MSG_TYPE_WHATS_NEW"],success:function(e){t&&t(e)},fail:function(){t&&t(null)}})},t.prototype.addInfo=function(t,e,o){var i=this;if(!this.checkCanSend())return console.error("sf_subscribe: \u4e0d\u662f\u5bf9\u5e94\u7684\u5e73\u53f0"),void(o&&o(null));var n=localStorage.getItem("subscribe_"+t);n&&n==e+""?o&&o("success"):this.getOpenId(function(){var n={appId:i.appId,openId:i.openId,info:JSON.stringify({k:t,v:e})};1==i.type?i.ttRequest(i.dyUrl+"/addInfo",n,function(i){if(!i.data)return console.error(i.errMsg),void(o&&o(null));var n=JSON.parse(i.data);0==n.code?(localStorage.setItem("subscribe_"+t,e+""),o&&o(n.data)):(console.error(JSON.parse(n)),o&&o(null))}):2==i.type&&i.wxRequest(i.wxUrl+"/addInfo",n,function(i){if(!i.data)return console.error(i.errMsg),void(o&&o(null));var n=JSON.parse(i.data);0==n.code?(wx.setStorageSync("subscribe_"+t,e+""),o&&o(n.data)):(console.error(JSON.parse(n)),o&&o(null))})})},t.prototype.openWXSubscribeSystem=function(t,e){return this.checkCanSend()?2!=this.type?(console.error("\u53ea\u6709\u5fae\u4fe1\u624d\u6709\u7cfb\u7edf\u8ba2\u9605"),void(e&&e(null))):(this.iLog("\u5f00\u59cb\u8ba2\u9605"),void this.wxsendServer(t,null,e,!0)):(console.error("sf_subscribe: \u4e0d\u662f\u5bf9\u5e94\u7684\u5e73\u53f0"),void(e&&e(null)))},t.prototype.wxsendServer=function(t,e,o,i){var n=this;if(i)wx.requestSubscribeSystemMessage({msgTypeList:t,success:function(e){for(var i=[],n=0;n<t.length;n++)e[t[n]]&&"accept"==e[t[n]]&&i.push(t[n]);i.length<=0?o&&o(null):o&&o(i)},fail:function(t){console.error(t),o&&o(null)}});else{var a=function(t){var i={appId:n.appId,openId:n.openId,tmplIds:t,time:null},a=n.wxUrl+"/addUserSubject";e&&(i.time=e,a=n.wxUrl+"/addTimeSubject"),n.wxRequest(a,i,function(e){if(!e.data)return console.error(e.errMsg),void(o&&o(null));var i=JSON.parse(e.data);200==i.code?o&&o(t):(console.error(JSON.stringify(i)),o&&o(null))})};wx.requestSubscribeMessage({tmplIds:t,success:function(e){for(var i=[],r=0;r<t.length;r++)e[t[r]]&&"accept"==e[t[r]]&&i.push(t[r]);i.length<=0?o&&o(null):n.getOpenId(function(){a(i)})},fail:function(t){console.error(t),o&&o(null)}})}},t.prototype.dysendServer=function(t,e,o){var i=this;tt.requestSubscribeMessage({tmplIds:t,success:function(n){for(var a=[],r=0;r<t.length;r++)n[t[r]]&&"accept"==n[t[r]]&&a.push(t[r]);a.length<=0?o&&o(null):i.getOpenId(function(){var t={appId:i.appId,openId:i.openId,tmplIds:a,time:null},n=i.dyUrl+"/addUserSubject";e&&(t.time=e,n=i.dyUrl+"/addTimeSubject"),i.ttRequest(n,t,function(t){if(!t.data)return console.error(t.errMsg),void(o&&o(null));var e=JSON.parse(t.data);200==e.code?o&&o(a):(console.error(JSON.stringify(e)),o&&o(null))})})},fail:function(t){console.error(t),o&&o(null)}})},t.prototype.checkCanSend=function(){s.PlatformManager.currentPlatform==r.Platform.WECHAT?this.type=2:s.PlatformManager.currentPlatform==r.Platform.BYTEDANCE&&(this.type=1);var t=!1;if(1==this.type){if(this.isInit||this.initDy(),-1==this.platformId)return!1;t=!0}else 2==this.type&&(this.isInit||this.initWx(),t=!0);return t},t.prototype.compareVersion=function(t,e){t=t.split("."),e=e.split(".");for(var o=Math.max(t.length,e.length);t.length<o;)t.push("0");for(;e.length<o;)e.push("0");for(var i=0;i<o;i++){var n=parseInt(t[i]),a=parseInt(e[i]);if(n>a)return 1;if(n<a)return-1}return 0},t.prototype.initDy=function(){if(this.isInit=!0,this.systemInfo=tt.getSystemInfoSync(),this.launchOptions=tt.getLaunchOptionsSync(),window.openId)this.uid=window.openId;else{var t=localStorage.getItem(this.openIdSaveKey);t&&(this.openId=t)}if(this.launchOptions){var e=this.launchOptions.extra;e&&(this.appId=e.appId)}null!=this.systemInfo&&("Douyin"!=this.systemInfo.appName&&"douyin_lite"!=this.systemInfo.appName||("douyin_lite"==this.systemInfo.appName?this.platformId=2:this.platformId=1))},t.prototype.initWx=function(){if(this.isInit=!0,window.openId)this.openId=window.openId;else{var t=wx.getStorageSync(this.openIdSaveKey);t&&(this.openId=t)}var e=wx.getAccountInfoSync().miniProgram;e&&(this.appId=e.appId)},t.prototype.getOpenId=function(t){var e=this,o=this;this.openId?t&&t(this.openId):2!=this.type?tt.login({force:!1,success:function(i){if(i.code){var n={code:i.code,appId:e.appId};e.ttRequest(e.dyUrl+"/getOpenId",n,function(i){if(!i.data)return console.error(i.errMsg),void(t&&t(null));var n=JSON.parse(i.data);0==n.code?(o.openId=n.data.openid,localStorage.setItem(e.openIdSaveKey,e.openId),t&&t(o.openId)):(console.error(i.data),t&&t(null))})}else t&&t(null)},fail:function(e){console.error(e.errMsg),t&&t(!1)}}):wx.login({success:function(o){if(o&&o.code){var i={appId:e.appId,code:o.code,platform:1};e.wxRequest(e.wxUrl+"/getOpenId",i,function(o){o?0==o.code?(e.openId=o.data,wx.setStorageSync(e.openIdSaveKey,e.openId),t&&t(e.openId)):(e.iLog("\u83b7\u53d6openId\u5931\u8d25:"+JSON.stringify(o)),t&&t(null)):setTimeout(function(){e.getOpenId(t)},1e3)})}else e.iLog("\u767b\u5f55\u5931\u8d25:"+o.errMsg)},fail:function(o){e.iLog("\u767b\u5f55\u5931\u8d25:"+JSON.stringify(o)),t&&t(null)}})},t.prototype.ttRequest=function(t,e,o){tt.request({url:t,data:e,header:{"content-type":"application/json"},dataType:"JSON",responseType:"text",success:function(t){o(t)},fail:function(t){o(t)}})},t.prototype.wxRequest=function(t,e,o){wx.request({url:t,data:e,header:{"content-type":"application/json"},dataType:"JSON",responseType:"text",success:function(t){o(t)},fail:function(t){o(t)}})},t.prototype.iLog=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log("SF_subscribe:",t)},Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t}();a.SubscribeManager=c,cc._RF.pop(),cc._RF.pop()},{}],SwordPresent:[function(t,e,o){"use strict";cc._RF.push(e,"4a547tU94dC57D7dSzS8xoC","SwordPresent");var i=e,n=o;cc._RF.push(i,"4a547tU94dC57D7dSzS8xoC","SwordPresent");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),s([l],e)}(cc.Component));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],TLB_APP:[function(t,e,o){"use strict";cc._RF.push(e,"c1f70B+D/NIk7seNA62RFJO","TLB_APP");var i=t,n=e,a=o;cc._RF.push(n,"c1f70B+D/NIk7seNA62RFJO","TLB_APP");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("AudioMgr"),c=i("UIMgr"),l=i("TLB_PoolMgr"),p=i("TLB_Config"),u=i("TLB_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isInited=!1,this._exitCall=null}var e;return e=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),this._exitCall=e,s.AudioMgr.getInstance().pauseAllMusic();var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(p.TLB_UIID.TLB_UIGame,p.TLB_UIID.TLB_UIGame,function(){t&&t()})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(p.TLB_UICF),s.AudioMgr.getInstance().addAdConf(p.TLB_Audio),u.default.getInstance().loadCfg(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.systemEvent.clear(),c.UIMgr.getInstance().closeById(p.TLB_UIID.TLB_UIGame),c.UIMgr.getInstance().closeById(p.TLB_UIID.TLB_UIPause),c.UIMgr.getInstance().closeById(p.TLB_UIID.TLB_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,l.default.getInstance().clear()},t._instance=null,e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TLB_BoxInfoTipsBox:[function(t,e,o){"use strict";cc._RF.push(e,"25599rb4N1EApZXXYl9+LjZ","TLB_BoxInfoTipsBox");var i=t,n=e,a=o;cc._RF.push(n,"25599rb4N1EApZXXYl9+LjZ","TLB_BoxInfoTipsBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TLB_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtTips=null,e.levelBox=null,e.weaponIcon=null,e}return s(e,t),e.prototype.init=function(t,e,o){var i=this;this.txtTips.string=t,cc.Tween.stopAllByTarget(this.node),this.node.opacity=0,this.node.active=!0,cc.tween(this.node).to(.2,{opacity:255}).start();var n="levelBox/gezi_0"+o;this.loadSpriteFrame(p.TLB_BundleName.Sprite,n,function(t){i.levelBox.spriteFrame=t});var a="boxIcon/"+p.TLB_BoxIconPath[e].iconPath;this.loadSpriteFrame(p.TLB_BundleName.Sprite,a,function(t){i.weaponIcon.spriteFrame=t})},e.prototype.die=function(){var t=this;this.node.active&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.active=!1}).start())},c([h(cc.RichText)],e.prototype,"txtTips",void 0),c([h(cc.Sprite)],e.prototype,"levelBox",void 0),c([h(cc.Sprite)],e.prototype,"weaponIcon",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TLB_BoxPlace:[function(t,e,o){"use strict";cc._RF.push(e,"744deSxjCtO+pNIUbG5DxWR","TLB_BoxPlace");var i=t,n=e,a=o;cc._RF.push(n,"744deSxjCtO+pNIUbG5DxWR","TLB_BoxPlace");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("TLB_Config"),h=i("TLB_DataMgr"),f=i("TLB_GameMgr"),m=i("TLB_BoxInfoTipsBox"),g=i("TLB_RoleMateTips"),y=i("TLB_PoolMgr"),v=i("TLB_BoxRoleAtk"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelBox=null,e.levelIcon=null,e.weaponIcon=null,e.tipsUpLevel=null,e.cdMaskBar=null,e.skillCountTimeBar=null,e.mateIcon=null,e.tipsUpLevelInitPos=null,e.skillID=0,e.typeID=0,e.level=0,e.mapKey=-1,e.boxCfg=null,e.isSkillCD=!1,e.skillCool=!1,e.barSpeed=0,e.coolTime=0,e.coolTimeBar=0,e.atkForce=1,e.criticalChance=0,e.criticalForce=0,e.bulletEffect=0,e.bulletPro=1,e.randomAtkNum=[],e.mateAtk=0,e.mateCriChance=0,e.mateCriForce=0,e.isResidentBox=!1,e.isTapTouchStart=!1,e.deviationOnStart=null,e.upEnterCourse=!1,e.animIndexID=null,e.gmAddAtk=0,e}return s(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.tipsUpLevelInitPos=this.tipsUpLevel.position.clone(),this.addEvent(d.TLB_EventName.UpdateSceneAllBox,this.updateAllBoxAccord),this.addEvent(d.TLB_EventName.PlayGame,this.closeBoxUpTips),this.addEvent(d.TLB_EventName.ActivateSkills,this.onRoleSkillAdded),this.addEvent(d.TLB_EventName.UpdateRolePro,this.updateRolePro),this.addEvent(d.TLB_EventName.GmAddRoleAtk,this.gmAddRoleAtk)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.animIndexID)},e.prototype.init=function(t,e){this.typeID=t,this.level=e,1010==t&&(this.isResidentBox=!0,this.tipsUpLevel.active=!1,this.levelIcon.node.active=!1),this.updateBoxPro(!0)},e.prototype.onRoleSkillAdded=function(){},e.prototype.triggerStart=function(){var t=this;if(f.default.Instance.isfight&&!f.default.Instance.isPause&&!this.skillCool){var e=function(){};switch(this.typeID){case 1:case 3:case 4:case 5:case 6:case 7:case 8:case 10:case 17:e=function(){if(f.default.Instance.enemyAllLsit.length>0){var e=t.node.convertToWorldSpaceAR(cc.v2(0,0));y.default.getInstance().getObj("role/boxRoleAtk",function(o){o.setParent(f.default.Instance.boxRoleBase);var i=o.parent.convertToNodeSpaceAR(e);o.setPosition(i);var n={typeID:t.typeID,level:t.level,atkForce:t.atkForce,criticalChance:t.criticalChance,criticalForce:t.criticalForce,bulletEffect:t.bulletEffect,bulletPro:t.bulletPro,dir:null,isSplitBullxet:!1,randomAtkNum:t.randomAtkNum};o.getComponent(v.default).init(n),f.default.Instance.tierBoxLList(f.default.Instance.boxRoleBase)})}};break;case 1001:e=function(){p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.huixue),f.default.Instance.addHP(t.boxCfg.BuffEffect),f.default.Instance.playAddHpEff()};break;case 1002:e=function(){f.default.Instance.roleMove.upSpeed(t.boxCfg.BuffEffect,t.boxCfg.Time)};break;case 1003:e=function(){f.default.Instance.roleMove.soonSpeed(t.boxCfg.BuffEffect,t.boxCfg.Time)};break;case 1004:e=function(){p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.hudun),f.default.Instance.addShield(t.boxCfg.BuffEffect)};break;case 1005:e=function(){f.default.Instance.upAtkHarm(t.boxCfg.BuffEffect,t.boxCfg.Time)};break;case 1006:e=function(){f.default.Instance.playKnockback(),t.sendEvent(d.TLB_EventName.rolePlaySkill,1006,t.boxCfg.Time)};break;case 1007:e=function(){t.sendEvent(d.TLB_EventName.rolePlaySkill,1007,t.boxCfg.Time)};break;case 1008:e=function(){f.default.Instance.reverseRoleMove()};break;case 1009:e=function(){f.default.Instance.roleMove.nextAgain()};break;case 1010:e=function(){p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.dakaibaoxiang),f.default.Instance.setPause(!0),u.UIMgr.getInstance().openUI(d.TLB_UIID.TLB_UISelectBuff,1,f.default.Instance.showBuffSelection())}}if(this.isSkillCD){var o=this.cdMaskBar.progress+this.barSpeed;o>=1?(o=0,this.cdMaskBar.progress=0,e(),this.skillCool=!0,this.skillCountTimeBar.node.active=!0,this.skillCountTimeBar.progress=1,this.coolTime=this.boxCfg.cool,this.coolTimeBar=this.boxCfg.cool):(cc.Tween.stopAllByTarget(this.cdMaskBar),cc.tween(this.cdMaskBar).to(.16,{progress:o}).start())}else e()}},e.prototype.update=function(t){f.default.Instance.isPause||this.skillCool&&(this.coolTimeBar-=t,this.skillCountTimeBar.progress=this.coolTimeBar/this.coolTime,this.coolTimeBar<0&&(this.skillCool=!1,this.skillCountTimeBar.node.active=!1))},e.prototype.onTouchStart=function(t){if(!this.isResidentBox&&!this.upEnterCourse&&f.default.Instance.isPrepare&&null==f.default.Instance.pitchBox){f.default.Instance.pitchBox=this.node,this.isTapTouchStart=!0,this.playTipsInfo(!0),cc.Tween.stopAllByTarget(this.node),this.node.angle=0,this.node.setScale(1);var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.deviationOnStart=this.node.getPosition().subtract(e),this.updateTouchPos(t.getLocation()),f.default.Instance.moveBoxPlace(d.TLB_MoveBoxtate.TouchStart,this)}},e.prototype.onTouchMove=function(t){this.isTapTouchStart&&(this.updateTouchPos(t.getLocation()),f.default.Instance.moveBoxPlace(d.TLB_MoveBoxtate.TouchMove,this))},e.prototype.onTouchEnd=function(t){this.isTapTouchStart&&(this.isTapTouchStart=!1,f.default.Instance.pitchBox=null,this.playTipsInfo(!1),this.updateTouchPos(t.getLocation()),f.default.Instance.moveBoxPlace(d.TLB_MoveBoxtate.TouchEnd,this))},e.prototype.updateTouchPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t).add(this.deviationOnStart);this.node.setPosition(e)},e.prototype.playTipsInfo=function(t){var e=this;if(t){var o="",i="#5bfe1b";switch(this.level){case 1:i="#5bfe1b";break;case 2:i="#1bc1fe";break;case 3:i="#e11bfe";break;case 4:i="#ffdb14";break;case 5:i="#ff2371"}switch(this.typeID){case 1:o="<b><outline color=black width=4>\u609f\u7a7a\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u51fb\u9000</color>\u654c\u4eba\uff0c</outline></b>";break;case 3:o="<b><outline color=black width=4>\u5ae6\u5a25\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u51bb\u7ed3</color>\u654c\u4eba<color="+i+">"+this.bulletPro+"\u79d2</color></outline></b>";break;case 4:o="<b><outline color=black width=4>\u5218\u5907\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u7a7f\u900f"+(this.bulletPro-1)+"\u540d</color>\u654c\u4eba</outline></b>";break;case 5:o="<b><outline color=black width=4>\u8bf8\u845b\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u53d1\u5c04<color="+i+">"+this.bulletPro+"\u9897</color>\u5b50\u5f39</outline></b>";break;case 6:o="<b><outline color=black width=4>\u4e54\u5e2e\u4e3b\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c<color="+i+">\u7206\u70b8</color>\u5c0f\u8303\u56f4\u4f24\u5bb3</outline></b>";break;case 7:o="<b><outline color=black width=4>\u7d2b\u971e\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u5b50\u5f39<color="+i+">\u5206\u88c2"+this.bulletPro+"\u6b21</color></outline></b>";break;case 8:o="<b><outline color=black width=4>\u5173\u7fbd\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u53d1\u5c04<color="+i+">"+this.bulletPro+"\u9897\u6247\u5f62</color>\u5b50\u5f39</outline></b>";break;case 10:o="<b><outline color=black width=4>\u900d\u9065\u50e7\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u968f\u673a\u653b\u51fb<color="+i+">"+this.randomAtkNum[0]+"~"+this.randomAtkNum[1]+"</color>\u6b21</outline></b>";break;case 17:o="<b><outline color=black width=4>\u5b59\u5c1a\u9999\uff1a\u4f24\u5bb3<color="+i+">"+this.atkForce+"</color>\uff0c\u5b50\u5f39<color="+i+">\u5f39\u5c04"+(this.bulletPro-1)+"\u6b21</color></outline></b>";break;case 1001:o="<b><outline color=black width=4>\u6062\u590d<color="+i+">"+this.round(this.boxCfg.BuffEffect)+"\u8840\u91cf</color></outline></b>";break;case 1002:o="<b><outline color=black width=4>\u63d0\u9ad8\u516b\u6212<color="+i+">\u79fb\u52a8\u901f\u5ea6</color>\uff0c\u6301\u7eed<color="+i+">"+this.boxCfg.Time+"\u79d2</color></outline></b>";break;case 1003:o="<b><outline color=black width=4>\u516b\u6212\u77ed\u6682<color="+i+">\u7206\u53d1</color>\u901f\u5ea6</outline></b>";break;case 1004:o="<b><outline color=black width=4>\u589e\u52a0<color="+i+">"+this.round(this.boxCfg.BuffEffect)+"\u62a4\u76fe</color></outline></b>";break;case 1005:o="<b><outline color=black width=4>\u6240\u6709\u89d2\u8272\u63d0\u5347<color="+i+">"+this.round(this.boxCfg.BuffEffect)+"\u4f24\u5bb3</color>\uff0c\u6301\u7eed<color="+i+">"+this.boxCfg.Time+"\u79d2</color></outline></b>";break;case 1006:o="<b><outline color=black width=4><color="+i+">\u51fb\u9000</color>\u6240\u6709\u602a\u7269</outline></b>";break;case 1007:o="<b><outline color=black width=4><color="+i+">\u51b0\u51bb</color>\u6240\u6709\u602a\u7269\uff0c\u6301\u7eed<color="+i+">"+this.boxCfg.Time+"\u79d2</color></outline></b>";break;case 1008:o="<b><outline color=black width=4>\u516b\u6212<color="+i+">\u53cd\u5411</color>\u79fb\u52a8</outline></b>";break;case 1009:o="<b><outline color=black width=4>\u4e0b\u4e00\u683c<color="+i+">\u89e6\u53d1\u4e24\u6b21</color></outline></b>"}null==f.default.Instance.tipsBoxInfo?y.default.getInstance().getObj("effAnim/boxInfoTipsBox",function(t){t.setParent(f.default.Instance.boxInfoTips),f.default.Instance.tipsBoxInfo=t.getComponent(m.default),f.default.Instance.tipsBoxInfo.init(o,e.typeID,e.level)}):f.default.Instance.tipsBoxInfo.init(o,this.typeID,this.level),0!=this.skillID&&(null==f.default.Instance.roleMateTips?y.default.getInstance().getObj("effAnim/roleMateTips",function(t){t.setParent(f.default.Instance.boxInfoTips),f.default.Instance.roleMateTips=t.getComponent(g.default),f.default.Instance.roleMateTips.init(e.skillID)}):f.default.Instance.roleMateTips.init(this.skillID))}else null!=f.default.Instance.tipsBoxInfo&&f.default.Instance.tipsBoxInfo.die(),null!=f.default.Instance.roleMateTips&&f.default.Instance.roleMateTips.die()},e.prototype.upBoxEnter=function(t,e){var o=this;this.upEnterCourse=!0,this.mapKey=t,cc.Tween.stopAllByTarget(this.node),this.node.angle=0;var i=e.convertToWorldSpaceAR(cc.v3(0,0)),n=this.node.parent.convertToNodeSpaceAR(i);cc.tween(this.node).to(.07,{position:n}).call(function(){cc.Tween.stopAllByTarget(o.node),o.node.scale=.1,cc.tween(o.node).to(.12,{scale:1}).call(function(){o.upEnterCourse=!1}).start()}).start()},e.prototype.downBoxEnter=function(){this.mapKey=-1},e.prototype.updateAllBoxAccord=function(t){if(!this.isResidentBox){for(var e=!1,o=0;o<t.length;o++)if(t[o]!=this){var i=t[o];if(i.typeID==this.typeID&&i.level==this.level&&this.level<5){e=!0;break}}e?this.openBoxUpTips():this.closeBoxUpTips()}},e.prototype.openBoxUpTips=function(){var t=this;this.tipsUpLevel.active=!0,this.tipsUpLevel.setPosition(this.tipsUpLevelInitPos),clearInterval(this.animIndexID),this.animIndexID=null;var e=this.tipsUpLevelInitPos.clone();e.y+=7,cc.Tween.stopAllByTarget(this.tipsUpLevel),cc.tween(this.tipsUpLevel).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:this.tipsUpLevelInitPos}).start(),this.animIndexID=setInterval(function(){cc.tween(t.tipsUpLevel).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).to(.15,{position:e}).to(.15,{position:t.tipsUpLevelInitPos}).start()},1200)},e.prototype.closeBoxUpTips=function(){this.tipsUpLevel.active&&(this.tipsUpLevel.active=!1,clearInterval(this.animIndexID),this.animIndexID=null)},e.prototype.upBoxLevel=function(){this.level>=5||(this.level++,this.updateBoxPro(),f.default.Instance.playBoxUpLevelEff(this.node),p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.shengji))},e.prototype.updateBoxPro=function(t){var e=this;void 0===t&&(t=!1);var o="levelBox/gezi_0"+(this.isResidentBox?6:this.level);this.loadSpriteFrame(d.TLB_BundleName.Sprite,o,function(t){e.levelBox.spriteFrame=t});var i="levelBox/tb_0"+this.level;if(this.loadSpriteFrame(d.TLB_BundleName.Sprite,i,function(t){e.levelIcon.spriteFrame=t}),t){var n="boxIcon/"+d.TLB_BoxIconPath[this.typeID].iconPath;this.loadSpriteFrame(d.TLB_BundleName.Sprite,n,function(t){e.weaponIcon.spriteFrame=t})}if(this.boxCfg=h.default.getInstance().getBoxProInfo(this.typeID,this.level),this.skillID=this.boxCfg.mate,this.barSpeed=this.round2(this.boxCfg.AtkSpeed),this.isSkillCD=this.barSpeed<1,this.isSkillCD){var a="levelBox/chongneng0"+(this.isResidentBox?4:this.level);this.loadSpriteFrame(d.TLB_BundleName.Sprite,a,function(t){e.cdMaskBar.node.active=!0,e.cdMaskBar.node.getComponent(cc.Sprite).spriteFrame=t,e.cdMaskBar.node.color=cc.Color.WHITE})}else this.cdMaskBar.node.active=!1;this.updateRolePro()},e.prototype.updateRolePro=function(){var t=f.default.Instance.roleBoxBuffAtk[this.typeID],e=0;null!=t&&(e=this.round(this.boxCfg.Atk*t)),this.atkForce=this.round(this.boxCfg.Atk+this.mateAtk+e+this.gmAddAtk),this.criticalChance=this.round2(this.boxCfg.CriticPro+this.mateCriChance),this.criticalForce=this.round2(this.boxCfg.CriticProDamage+this.mateCriForce),this.bulletEffect=this.boxCfg.BulletEffect[0],this.bulletPro=this.round2(this.boxCfg.BulletEffect[1]),7==this.bulletEffect&&(this.randomAtkNum[0]=this.boxCfg.BulletEffect[1],this.randomAtkNum[1]=this.boxCfg.BulletEffect[2])},e.prototype.gmAddRoleAtk=function(){this.gmAddAtk+=10,this.updateRolePro()},e.prototype.round2=function(t){return Math.round(100*t)/100},e.prototype.round=function(t){return Math.round(t)},c([B(cc.Sprite)],e.prototype,"levelBox",void 0),c([B(cc.Sprite)],e.prototype,"levelIcon",void 0),c([B(cc.Sprite)],e.prototype,"weaponIcon",void 0),c([B(cc.Node)],e.prototype,"tipsUpLevel",void 0),c([B(cc.ProgressBar)],e.prototype,"cdMaskBar",void 0),c([B(cc.ProgressBar)],e.prototype,"skillCountTimeBar",void 0),c([B(cc.Node)],e.prototype,"mateIcon",void 0),c([b],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],TLB_BoxRoleAtk:[function(t,e,o){"use strict";cc._RF.push(e,"80134TCjHhOs7hMQgdW32+v","TLB_BoxRoleAtk");var i=t,n=e,a=o;cc._RF.push(n,"80134TCjHhOs7hMQgdW32+v","TLB_BoxRoleAtk");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("TLB_Config"),d=i("TLB_GameMgr"),h=i("TLB_PoolMgr"),f=i("TLB_RoleBullet"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkPos=null,e.isDie=!1,e.typeID=0,e.level=0,e.atkType=0,e.bulletStepX=15,e.bulletEffect=0,e.bulletPro=1,e.atkNum=3,e.atkForce=1,e.criticalChance=0,e.criticalForce=0,e}return s(e,t),e.prototype.onLoad=function(){this.addEvent(u.TLB_EventName.SetPause,this.setPause),this.addEvent(u.TLB_EventName.blastMapLayer,this.die)},e.prototype.start=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==u.TLB_AnimName.attack&&(7==t.bulletEffect?t.atkNum<=0?t.die():t.playAtkAnim():t.die())}),this.spAnim.setEventListener(function(e,o){o.data.name==u.TLB_AnimName.attack&&t.attack()})},e.prototype.init=function(t){var e=this;this.typeID=t.typeID,this.level=t.level,this.atkForce=t.atkForce,this.criticalChance=t.criticalChance,this.criticalForce=t.criticalForce,this.bulletEffect=t.bulletEffect,this.bulletPro=t.bulletPro,7==this.bulletEffect&&(this.atkNum=d.default.Instance.random(t.randomAtkNum[0],t.randomAtkNum[1]+1,!0)),this.isDie=!1;var o=""+u.TLB_RoleAsePath[this.typeID].path;this.loadResFromBundle(u.TLB_BundleName.SpAnim,o,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,u.TLB_AnimName.idle,!0),setTimeout(function(){null!=e.node&&e.node.active&&e.playAtkAnim()},200)}),d.default.Instance.playOutRoleEff(this.node,!0),this.node.setPosition(this.node.x,this.node.y-20),this.setDir()},e.prototype.setDir=function(){var t=d.default.Instance.getEnemyNear(this.node,1);if(t.length>0){var e=t[0].convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.parent.convertToNodeSpaceAR(e);this.node.x>o.x?this.node.scaleX=-1:this.node.x<o.x&&(this.node.scaleX=1)}},e.prototype.playAtkAnim=function(){this.setDir(),1==this.bulletEffect?p.AudioMgr.getInstance().playEffectFree(u.TLB_AudioId.chuancizidan):p.AudioMgr.getInstance().playEffectFree(u.TLB_AudioId.attack2),this.spAnim.setAnimation(0,u.TLB_AnimName.attack,!1),7==this.bulletEffect&&this.atkNum--},e.prototype.attack=function(){switch(this.setDir(),this.bulletEffect){case 6:var t=d.default.Instance.getEnemyNear(this.node,1);t.length>0&&this.shootBullets(t[0],this.bulletPro);break;case 8:this.sendBullets(this.bulletPro);break;default:this.sendBullets(1)}},e.prototype.sendBullets=function(t){var e=this,o=d.default.Instance.getEnemyNear(this.node,t);if(o.length>0)for(var i=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=d.default.Instance.round(this.atkForce+=d.default.Instance.boxRoleUpAtk),a=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),r=function(t){if(null==o[t])return{value:void 0};var r=t,s=o[r].convertToWorldSpaceAR(cc.v2(0,0)).sub(i).normalize(),c=180*Math.atan2(s.y,s.x)/Math.PI-90;setTimeout(function(){h.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(d.default.Instance.roleBulletBase);var o=t.parent.convertToNodeSpaceAR(a);t.setPosition(o),t.angle=c;var i={typeID:e.typeID,level:e.level,atkForce:n,criticalChance:e.criticalChance,criticalForce:e.criticalForce,bulletEffect:e.bulletEffect,bulletPro:e.bulletPro,dir:s,isSplitBullxet:!1,randomAtkNum:[]};t.getComponent(f.default).init(i)})},70*r)},s=0;s<t;s++){var c=r(s);if("object"==typeof c)return c.value}},e.prototype.shootBullets=function(t,e,o){var i=this;void 0===e&&(e=3),void 0===o&&(o=20);for(var n=d.default.Instance.round(this.atkForce+d.default.Instance.boxRoleUpAtk),a=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),r=t.convertToWorldSpaceAR(cc.v2(0,0)).sub(a).normalize(),s=180*Math.atan2(r.y,r.x)/Math.PI-90,c=Math.floor(e/2),l=function(t){var e=s+(t-c)*o,a=(e+90)*Math.PI/180,r=cc.v2(Math.cos(a),Math.sin(a)).normalize();h.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(d.default.Instance.roleBulletBase);var o=i.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),a=t.parent.convertToNodeSpaceAR(o);t.setPosition(a),t.angle=e;var s={typeID:i.typeID,level:i.level,atkForce:n,criticalChance:i.criticalChance,criticalForce:i.criticalForce,bulletEffect:i.bulletEffect,bulletPro:i.bulletPro,dir:r,isSplitBullxet:!1,randomAtkNum:[]};t.getComponent(f.default).init(s)})},p=0;p<e;p++)l(p)},e.prototype.die=function(){this.isDie||(this.isDie=!0,d.default.Instance.playOutRoleEff(this.node,!1),h.default.getInstance().pushObj(this.node))},e.prototype.setPause=function(t){this.isDie||(this.spAnim.paused=t)},c([y(sp.Skeleton)],e.prototype,"spAnim",void 0),c([y(cc.Node)],e.prototype,"atkPos",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],TLB_Btn_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"2b687usJOZN8oyxabeGPEEX","TLB_Btn_Skills");var i=t,n=e,a=o;cc._RF.push(n,"2b687usJOZN8oyxabeGPEEX","TLB_Btn_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("TLB_Config"),d=i("TLB_DataMgr"),h=i("TLB_GameMgr"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelBox=null,e.skillName=null,e.lockMack=null,e.skillIcon=null,e.isDie=!1,e.skillID=0,e.level=0,e.isSkillLock=!1,e.skillInterval=0,e.skillTime=0,e.isHidePause=!1,e}return s(e,t),e.prototype.onLoad=function(){this.addEvent(u.TLB_EventName.RoleMoveTakeOff,this.hideBtnPause),this.playBtnAnim()},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),clearInterval(this.btnAnimId)},e.prototype.hideBtnPause=function(t){this.isHidePause=t;var e=t?0:255;cc.tween(this.node).to(.2,{opacity:e}).start()},e.prototype.init=function(t,e){var o=this;this.skillID=t,this.lockMack.node.active=!1,this.skillName.node.active=!1,this.skillInterval=d.default.getInstance().getSkillsCfg(t).mateCDtime,this.skillTime=this.skillInterval,this.updateLevel(e),this.node.on(cc.Node.EventType.TOUCH_END,this.playSkill,this);var i="skillsBtnIcon/"+d.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(u.TLB_BundleName.Sprite,i,function(t){o.skillIcon.spriteFrame=t})},e.prototype.update=function(t){h.default.Instance.isPause||h.default.Instance.isPrepare||this.isDie||this.isSkillLock&&(this.skillTime-=t,this.lockMack.progress=this.skillTime/this.skillInterval,this.skillTime<0&&(this.isSkillLock=!1,this.lockMack.node.active=!1,this.playBtnAnim()))},e.prototype.updateLevel=function(t){var e=this;if(this.level!=t){this.level=t;var o="skillsBtnIcon/guang_0"+this.level;this.loadSpriteFrame(u.TLB_BundleName.Sprite,o,function(t){e.levelBox.getComponent(cc.Sprite).spriteFrame=t})}},e.prototype.playSkill=function(){if(!h.default.Instance.isPrepare&&!this.isSkillLock&&!this.isHidePause){switch(clearInterval(this.btnAnimId),this.btnAnimId=null,cc.Tween.stopAllByTarget(this.node),this.lockMack.node.active=!0,this.lockMack.progress=1,this.isSkillLock=!0,this.skillTime=this.skillInterval,this.skillID){case 8:case 9:case 10:case 11:h.default.Instance.playSkillsAtk(this.skillID);break;case 7:h.default.Instance.roleFieldSkill(this.skillID)}p.AudioMgr.getInstance().playEffectFree(d.default.getInstance().getSkillsCfg(this.skillID).mateSound)}},e.prototype.playBtnAnim=function(){var t=this;clearInterval(this.btnAnimId),this.btnAnimId=null,cc.tween(this.levelBox).to(.65,{scale:1.07}).to(.65,{scale:1}).start(),this.btnAnimId=setInterval(function(){cc.tween(t.levelBox).to(.65,{scale:1.07}).to(.65,{scale:1}).start()},1300)},c([g(cc.Node)],e.prototype,"levelBox",void 0),c([g(cc.Label)],e.prototype,"skillName",void 0),c([g(cc.ProgressBar)],e.prototype,"lockMack",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],TLB_Config:[function(t,e,o){"use strict";cc._RF.push(e,"940d8KoCxdDu6LlDSivG/j4","TLB_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"940d8KoCxdDu6LlDSivG/j4","TLB_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.TLB_RoleAsePath=l.TLB_BoxIconPath=l.TLB_MoveBoxtate=l.TLB_AnimName=l.TLB_EventName=l.TLB_Audio=l.TLB_AudioId=l.TLB_UICF=l.TLB_UIID=l.TLB_BundleName=void 0,function(t){t.Prefabs="TLB_Prefabs",t.Sprite="TLB_Sprite",t.Audio="TLB_Audio",t.SpAnim="TLB_SpAnim"}(a=l.TLB_BundleName||(l.TLB_BundleName={})),function(t){t.TLB_UIGame="TLB_UIGame",t.TLB_UIGM="TLB_UIGM",t.TLB_UIPause="TLB_UIPause",t.TLB_UIGameOver="TLB_UIGameOver",t.TLB_UISelectBuff="TLB_UISelectBuff",t.TLB_UIBuffPro="TLB_UIBuffPro"}(r=l.TLB_UIID||(l.TLB_UIID={})),l.TLB_UICF=((i={})[r.TLB_UIGame]={prefab:"ui/TLB_UIGame",name:"TLB_UIGame",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.TLB_UIGM]={prefab:"ui/TLB_UIGM",name:"TLB_UIGM",showTop:!0,showMult:!1,zIndex:1002,bundleName:a.Prefabs},i[r.TLB_UIPause]={prefab:"ui/TLB_UIPause",name:"TLB_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.TLB_UIGameOver]={prefab:"ui/TLB_UIGameOver",name:"TLB_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.TLB_UISelectBuff]={prefab:"ui/TLB_UISelectBuff",name:"TLB_UISelectBuff",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.TLB_UIBuffPro]={prefab:"ui/TLB_UIBuffPro",name:"TLB_UIBuffPro",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i),function(t){t.baozha="baozha",t.shibai="shibai",t.chuancizidan="chuancizidan",t.chufaliangci="chufaliangci",t.dakaibaoxiang="dakaibaoxiang",t.dilie="dilie",t.direnchuxian="direnchuxian",t.fangrugezi="fangrugezi",t.hudun="hudun",t.hudunshouji="hudunshouji",t.huixue="huixue",t.paobu="paobu",t.shengji="shengji",t.siwang="siwang",t.suidi="suidi",t.attack2="attack2",t.summon="summon",t.cwsq="cwsq",t.jdqx="jdqx",t.sgml="sgml",t.zysq="zysq"}(s=l.TLB_AudioId||(l.TLB_AudioId={})),l.TLB_Audio=((n={})[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.baozha]={path:s.baozha,bundle:a.Audio},n[s.chuancizidan]={path:s.chuancizidan,bundle:a.Audio},n[s.chufaliangci]={path:s.chufaliangci,bundle:a.Audio},n[s.dakaibaoxiang]={path:s.dakaibaoxiang,bundle:a.Audio},n[s.dilie]={path:s.dilie,bundle:a.Audio},n[s.direnchuxian]={path:s.direnchuxian,bundle:a.Audio},n[s.fangrugezi]={path:s.fangrugezi,bundle:a.Audio},n[s.hudun]={path:s.hudun,bundle:a.Audio},n[s.hudunshouji]={path:s.hudunshouji,bundle:a.Audio},n[s.huixue]={path:s.huixue,bundle:a.Audio},n[s.paobu]={path:s.paobu,bundle:a.Audio},n[s.shengji]={path:s.shengji,bundle:a.Audio},n[s.siwang]={path:s.siwang,bundle:a.Audio},n[s.suidi]={path:s.suidi,bundle:a.Audio},n[s.attack2]={path:s.attack2,bundle:a.Audio},n[s.summon]={path:s.summon,bundle:a.Audio},n[s.cwsq]={path:s.cwsq,bundle:a.Audio},n[s.jdqx]={path:s.jdqx,bundle:a.Audio},n[s.sgml]={path:s.sgml,bundle:a.Audio},n[s.zysq]={path:s.zysq,bundle:a.Audio},n),function(t){t.SetPause="TLB_SetPause",t.UpdateSceneAllBox="TLB_UpdateSceneAllBox",t.PlayGame="TLB_PlayGame",t.rolePlaySkill="TLB_RolePlaySkill",t.blastMapLayer="TLB_BlastMapLayer",t.ActivateSkills="TLB_ActivateSkills",t.PlaySkillsAtk="TLB_PlaySkillsAtk",t.UpTipsBox="TLB_UpTipsBox",t.UpdateRolePro="TLB_updateRolePro",t.RoleMoveTakeOff="TLB_RoleMoveTakeOff",t.GmAddRoleAtk="TLB_GmAddRoleAtk"}(l.TLB_EventName||(l.TLB_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="move",t.animation="animation"}(l.TLB_AnimName||(l.TLB_AnimName={})),function(t){t[t.TouchStart=0]="TouchStart",t[t.TouchMove=1]="TouchMove",t[t.TouchEnd=2]="TouchEnd"}(l.TLB_MoveBoxtate||(l.TLB_MoveBoxtate={})),l.TLB_BoxIconPath={1:{iconPath:"tou_1"},3:{iconPath:"tou_3"},4:{iconPath:"tou_4"},5:{iconPath:"tou_5"},6:{iconPath:"tou_6"},7:{iconPath:"tou_7"},8:{iconPath:"tou_8"},10:{iconPath:"tou_10"},11:{iconPath:"tou_11"},17:{iconPath:"tou_17"},1001:{iconPath:"dj_01"},1002:{iconPath:"dj_02"},1003:{iconPath:"dj_03"},1004:{iconPath:"dj_04"},1005:{iconPath:"dj_05"},1006:{iconPath:"dj_07"},1007:{iconPath:"dj_06"},1008:{iconPath:"dj_08"},1009:{iconPath:"dj_09"},1010:{iconPath:"box01"}},l.TLB_RoleAsePath={1:{path:"soilder_3/soilder_3",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_3"},3:{path:"djdh_3/djdh_3",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_1"},4:{path:"djdh_4/djdh_4",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_1"},5:{path:"djdh_5/djdh_5",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_3"},6:{path:"djdh_6/djdh_6",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_2"},7:{path:"soilder_4/soilder_4",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_3"},8:{path:"djdh_8/djdh_8",bulletPath:"cctf_bullte_bz/cctf_bullte_bz",bulletSkill:"bullte_1"},10:{path:"djdh_10/djdh_10",bulletPath:"cctf_bullte_jt/cctf_bullte_jt",bulletSkill:"bullte_2"},17:{path:"djdh_17/djdh_17",bulletPath:"cctf_bullte_ct/cctf_bullte_ct",bulletSkill:"bullte_2"}},cc._RF.pop(),cc._RF.pop()},{}],TLB_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"0ff46jau/ZBgpoOf/yYLXib","TLB_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"0ff46jau/ZBgpoOf/yYLXib","TLB_DataMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.loadCfg=function(t){var e=this;r.ResourceMgr.getInstance().loadRes("TLB_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getCfgByPrimaryKey2=function(t,e,o,i,n){if(t)for(var a=0;a<t.length;a++)if(t[a][i]==e&&t[a][n]==o)return t[a];return null},t.prototype.getBoxProInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.CharacterNum,t,e,"CharacterID","level")},t.prototype.getParameterCfg=function(t){return this.data.GearParameterCfg[t].value},t.prototype.getEnemyInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.enemyCfg,t,e,"level","CharacterID")},t.prototype.getSkillsCfg=function(t){return this.getCfgByPrimaryKey(this.data.mateCfg,t,"mateID")},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],TLB_EffDie:[function(t,e,o){"use strict";cc._RF.push(e,"c85feJsGJ5AJL+/yfq9+qTm","TLB_EffDie");var i=t,n=e,a=o;cc._RF.push(n,"c85feJsGJ5AJL+/yfq9+qTm","TLB_EffDie");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("TLB_Config"),p=i("TLB_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name,l.TLB_AnimName.animation,p.default.getInstance().pushObj(t.node)})},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TLB_EnemyRole:[function(t,e,o){"use strict";cc._RF.push(e,"6bb228UNvpHS4D6RR19Q/ZZ","TLB_EnemyRole");var i=t,n=e,a=o;cc._RF.push(n,"6bb228UNvpHS4D6RR19Q/ZZ","TLB_EnemyRole");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("AudioMgr"),d=i("TLB_Config"),h=i("TLB_DataMgr"),f=i("TLB_GameEnumData"),m=i("TLB_GameMgr"),g=i("TLB_PoolMgr"),y=cc._decorator,v=y.ccclass,_=y.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.die=2]="die"}(l||(l={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.boxCol=null,e.hpBG=null,e.hpBar=null,e.frozenPos=null,e.enemyType=0,e.isDie=!1,e.enemyState=l.die,e.moveSpeed=60,e.nowMovePos=cc.v2(),e.skillFrozen=!1,e.frozenCountTime=0,e.knockbackOffset=cc.Vec3.ZERO,e.atkForce=1,e.maxHp=10,e.nowHp=0,e.isAtkCooling=!0,e.atkInterval=2.5,e.atkTime=0,e.atkAnimTimeSpeed=1,e.clipDuration=0,e.initPos=null,e.loongPos=null,e.moveDistance=0,e.direction=null,e.move=null,e._frames=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.addEvent(d.TLB_EventName.SetPause,this.setSpAnim),this.addEvent(d.TLB_EventName.rolePlaySkill,this.rolePlaySkill),this.addEvent(d.TLB_EventName.PlaySkillsAtk,this.playSkillsAtk),this.spAnim.setCompleteListener(function(e){e.animation.name==d.TLB_AnimName.attack&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.spAnim.setAnimation(0,d.TLB_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==d.TLB_AnimName.attack&&t.attack()}),this.setSpAnimPlaySpeed();var e=h.default.getInstance().getParameterCfg(f.TLB_enumGearParameterCfg.EnemyMoveSpeed);this.moveSpeed=e[this.enemyType-1]},e.prototype.init=function(t){this.enemyState=l.move,this.atkTime=0,this.nowMovePos=m.default.Instance.mapMidPos.getPosition(),this.hpBG.active=!1,this.hpBar.progress=1,this.isDie=!1,this.frozenPos.active=!1;var e=h.default.getInstance().getEnemyInfo(t,this.enemyType);null!=e?(this.maxHp=m.default.Instance.round(e.HP),this.nowHp=this.maxHp,this.atkForce=m.default.Instance.round(e.Atk)):console.error("\u654c\u4ebaID\uff1a"+this.enemyType+"\uff0c\u6ce2\u6b21\uff1a"+t+"\uff0c\u83b7\u53d6\u8840\u91cf\u5931\u8d25\uff0c\u914d\u7f6e\u8868\u662f\u7a7a\u7684"),this.initPos=this.node.getPosition(),m.default.Instance.playOutEnemyEff(this.node),this.node.x>this.nowMovePos.x?this.spAnim.node.setScale(-1,1):this.spAnim.node.setScale(1,1),this.spAnim.paused=!1,this.spAnim.setAnimation(0,d.TLB_AnimName.move,!0)},e.prototype.update=function(t){if(!m.default.Instance.isPause&&!this.isDie){if(this.knockbackOffset!=cc.Vec3.ZERO){var e=this.node.position.add(this.knockbackOffset);this.initPos.x>0?e.x>this.initPos.x&&(e.x=this.initPos.x):e.x<this.initPos.x&&(e.x=this.initPos.x),this.initPos.y>135?e.y>this.initPos.y&&(e.y=this.initPos.y):e.y<this.initPos.y&&(e.y=this.initPos.y),this.node.setPosition(e)}if(this.skillFrozen)return this.frozenCountTime-=t,void(this.frozenCountTime<0&&(this.frozenCountTime=0,this.skillFrozen=!1,this.setSpAnim(!1),this.frozenPos.active=!1));if(this._frames++>8){this._frames=0;for(var o=this.boxCol.getBoundingBoxToWorld(),i=!1,n=0,a=m.default.Instance.enemyAtkRange.children;n<a.length;n++){var r=a[n].getBoundingBoxToWorld();if(cc.Intersection.rectRect(o,r)){i=!0;break}}i?this.enemyState!=l.attack&&(this.enemyState=l.attack,this.spAnim.setAnimation(0,d.TLB_AnimName.idle,!0)):this.enemyState!=l.move&&(this.enemyState=l.move,this.spAnim.setAnimation(0,d.TLB_AnimName.move,!0))}this.enemyState==l.move?(this.loongPos=this.node.getPosition(),this.moveDistance=this.moveSpeed*t,this.direction=this.nowMovePos.sub(this.loongPos).normalize(),this.move=this.direction.mul(this.moveDistance),this.node.setPosition(this.loongPos.add(this.move))):this.enemyState==l.attack&&(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.spAnim.setAnimation(0,d.TLB_AnimName.attack,!1)))}},e.prototype.attack=function(){m.default.Instance.isPause||this.isDie||m.default.Instance.deductHP(this.atkForce)},e.prototype.playSkillsAtk=function(t,e){m.default.Instance.isPause||this.isDie||this.attackEd(e,!1)},e.prototype.rolePlaySkill=function(t,e){if(!m.default.Instance.isPause&&!this.isDie)switch(t){case 1006:this.knockback(m.default.Instance.mapMidPos,15);break;case 1007:this.frozenEd(e)}},e.prototype.attackEd=function(t,e){m.default.Instance.isPause||this.isDie||(this.nowHp-=t,m.default.Instance.playHarmEff(t,e,this.node),this.nowHp<1?(this.isDie=!0,this.die()):(this.hpBG.active||(this.hpBG.active=!0),this.updeteHpBar(),cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.2,{color:cc.Color.WHITE}).start()))},e.prototype.knockback=function(t,e){var o=this;if(!this.isDie&&!this.isDie&&t){var i=m.default.Instance.getWorldPosV2(this.node),n=m.default.Instance.getWorldPosV2(t),a=i.sub(n).normalize().mul(e);this.knockbackOffset=cc.v3(a.x,a.y,0),cc.Tween.stopAllByTarget(this.knockbackOffset),cc.tween(this.knockbackOffset).to(.15,{x:0,y:0,z:0}).call(function(){o.knockbackOffset=cc.Vec3.ZERO}).start()}},e.prototype.frozenEd=function(t){var e=this;this.isDie||(this.setSpAnim(!0),t>this.frozenCountTime&&(this.frozenCountTime=t),this.skillFrozen=!0,this.frozenPos.active=!0,0==this.frozenPos.childrenCount&&this.loadPrefab(d.TLB_BundleName.Prefabs,"effAnim/frozen",function(t){var o=cc.instantiate(t);o.setParent(e.frozenPos),o.setPosition(cc.v2())}))},e.prototype.setSpAnimPlaySpeed=function(){var t=this.spAnim.findAnimation(d.TLB_AnimName.attack);this.clipDuration=t.duration,this.atkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.atkInterval*1.05)},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.die=function(){this.isDie=!0,this.skillFrozen=!1,this.frozenCountTime=0,this.initPos=null,u.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.siwang),m.default.Instance.playDieEff(this.node),cc.Tween.stopAllByTarget(this.spAnim.node),cc.Tween.stopAllByTarget(this.knockbackOffset),cc.Tween.stopAllByTarget(this.hpBar),this.spAnim.node.color=cc.Color.WHITE,this.knockbackOffset=cc.Vec3.ZERO,this.frozenPos.removeAllChildren(),this.frozenPos.active=!1,this.enemyState=l.die,m.default.Instance.removeEnemyList(this.node),g.default.getInstance().pushObj(this.node)},e.prototype.setSpAnim=function(t){this.isDie||this.skillFrozen||(this.spAnim.paused=t)},c([_(sp.Skeleton)],e.prototype,"spAnim",void 0),c([_(cc.Node)],e.prototype,"boxCol",void 0),c([_(cc.Node)],e.prototype,"hpBG",void 0),c([_(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([_(cc.Node)],e.prototype,"frozenPos",void 0),c([_(cc.Integer)],e.prototype,"enemyType",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],TLB_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"533f1A26FtC7LxI7zriFSIT","TLB_GameData");var i=e,n=o;cc._RF.push(i,"533f1A26FtC7LxI7zriFSIT","TLB_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emTLB_GameDataKeys=void 0,function(t){t.buffCfg="buffCfg",t.mateCfg="mateCfg",t.GearParameterCfg="GearParameterCfg",t.BoxCfg="BoxCfg",t.enemyCfg="enemyCfg",t.enemyID="enemyID",t.waveCfg="waveCfg",t.CharacterCfg="CharacterCfg",t.CharacterNum="CharacterNum"}(n.emTLB_GameDataKeys||(n.emTLB_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],TLB_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"db6a9mc2q5OIKMfvtcFIQGu","TLB_GameEnumData");var i=e,n=o;cc._RF.push(i,"db6a9mc2q5OIKMfvtcFIQGu","TLB_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.TLB_enumGearParameterCfg=void 0,function(t){t[t.StarHeathy=1]="StarHeathy",t[t.StarMoveSpeed=2]="StarMoveSpeed",t[t.StarShield=3]="StarShield",t[t.FirstBreak=4]="FirstBreak",t[t.SecondBreak=5]="SecondBreak",t[t.ThirdBreak=6]="ThirdBreak",t[t.EnemyMoveSpeed=8]="EnemyMoveSpeed"}(n.TLB_enumGearParameterCfg||(n.TLB_enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],TLB_GameMgr:[function(t,e,o){"use strict";cc._RF.push(e,"3446cMergNGMbOREHz7kzvD","TLB_GameMgr");var i=t,n=e,a=o;cc._RF.push(n,"3446cMergNGMbOREHz7kzvD","TLB_GameMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("TLB_Config"),h=i("TLB_DataMgr"),f=i("TLB_GameEnumData"),m=i("TLB_HarmEff"),g=i("TLB_MapLayre"),y=i("TLB_Skills"),v=i("TLB_PoolMgr"),_=i("TLB_BoxPlace"),b=i("TLB_EnemyRole"),B=i("TLB_RoleFieldSkill"),I=i("TLB_RoleMove"),P=cc._decorator,C=P.ccclass,D=P.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameUI=null,e.gameTopRoot=null,e.boxSpare=null,e.mapBoxFrame=null,e.shopBoxRoot=null,e.upBoxEnterBase=null,e.roleMove=null,e.towerLayer=null,e.birthEnemyPos=null,e.enemyBase=null,e.mapMidPos=null,e.hp_Root=null,e.hpBar=null,e.txtHp=null,e.txtShield=null,e.moveArrows=null,e.boxRoleBase=null,e.roleBulletBase=null,e.enemyAtkRange=null,e.levelBar=null,e.txtLevel=null,e.skillsBase=null,e.boxInfoTips=null,e.btn_PlayGo=null,e.breakIcon=[],e.isPause=!1,e.isfight=!1,e.isPrepare=!0,e.mapBoxInfos={},e.mapBoxlength=0,e.boxSpareAll=[],e.sceneAllBox=[],e.waveCfg=[],e.nowWaveEnemyInfo=[],e.nowLayerEnemyInfo=[],e.nowMaxWave=0,e.nowLayerWave=0,e.nowminWave=0,e.outWaveTime=0,e.waveInterval=0,e.isCanWave=!1,e.enemyTypeNum={},e.outEnemyInterval=.2,e.outEnemyTime=0,e.isWaveGameOver=!1,e.isMinWaveOver=!1,e.waveEnemyAllSum=0,e.nowLayerNum=0,e.nowAtkMapLaye=0,e.waveEnemySum=0,e.mapLayreLsit=[],e.mapIndex=0,e.enemyAllLsit=[],e.pitchBox=null,e.maxHp=100,e.nowHp=0,e.shield=0,e.boxRoleUpAtk=0,e.isUpRoleAtk=!1,e.upRoleAtkCountTime=0,e.upRoleAtkTime=0,e.firstBreak=0,e.secondBreak=0,e.thirdBreak=0,e.roleMateTips=null,e.tipsBoxInfo=null,e.isThePlay=!1,e.isTapPlayGame=!1,e._StepEnemy=0,e.tempNumLayer=[],e.radius=445,e.mapLaterPosScale={0:{pos:cc.v3(0,200),scale:1.15},1:{pos:cc.v3(0,67),scale:1},2:{pos:cc.v3(0,-190),scale:.85},3:{pos:cc.v3(0,-407),scale:.7},4:{pos:cc.v3(0,-547),scale:.62},5:{pos:cc.v3(0,-652),scale:.55}},e.nextWaveEnemyInf=[],e.nextTempNumLayer=[],e.nextLayerNum=0,e.lastBreak=0,e.color_Green=cc.color().fromHEX("#08f61b"),e.color_Red=cc.color().fromHEX("#f85454"),e.lastNowHp=100,e.initRandomBoxs=!1,e.lastmMinDisPath=null,e.solderGainIDs=[],e.activateSkills=[],e.mateCfgs=[],e.activateSkillAtks=[],e.buffDatas=[],e.buffSelectionCount={},e.buffsPerRefresh=3,e.roleBoxBuffAtk={},e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this)},e.prototype.start=function(){var t=this,e=this.mapBoxFrame.getChildByName("upBox").children,o=this.mapBoxFrame.getChildByName("leftBox").children,i=this.mapBoxFrame.getChildByName("downBox").children,n=this.mapBoxFrame.getChildByName("rightBox").children;this.initMapBoxInfos(e,!1),this.initMapBoxInfos(o,!0),this.initMapBoxInfos(i,!0),this.initMapBoxInfos(n,!1),this.roleMove.init(this.mapBoxInfos,this.mapBoxlength),this.btn_PlayGo.on(cc.Node.EventType.TOUCH_END,this.playGame,this),this.initData(),this.updateBoxSpare(),this.updateEnemyMaxWave(),this.loadPrefab(d.TLB_BundleName.Prefabs,"boxPlace/boxPlace",function(e){var o=t.mapBoxInfos[0].path,i=o.convertToWorldSpaceAR(cc.v2(0,0)),n=cc.instantiate(e);n.setParent(t.upBoxEnterBase);var a=n.parent.convertToNodeSpaceAR(i);n.setPosition(a);var r=n.getComponent(_.default);r.init(1010,1),r.upBoxEnter(0,o),t.mapBoxInfos[0].boxSp=r})},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),o.Instance=null},e.prototype.initData=function(){this.characterCfg=JSON.parse(JSON.stringify(h.default.getInstance().data.CharacterCfg)),this.waveCfg=h.default.getInstance().data.waveCfg,this.maxHp=h.default.getInstance().getParameterCfg(f.TLB_enumGearParameterCfg.StarHeathy),this.firstBreak=h.default.getInstance().getParameterCfg(f.TLB_enumGearParameterCfg.FirstBreak),this.secondBreak=h.default.getInstance().getParameterCfg(f.TLB_enumGearParameterCfg.SecondBreak),this.thirdBreak=h.default.getInstance().getParameterCfg(f.TLB_enumGearParameterCfg.ThirdBreak),this.mateCfgs=h.default.getInstance().data.mateCfg,this.buffDatas=h.default.getInstance().data.buffCfg,this.nowHp=this.maxHp,this.updateHpBar()},e.prototype.initMapBoxInfos=function(t,e){if(e)for(var o=0;o<t.length;o++)t[o].color=cc.Color.BLACK,t[o].opacity=51,this.mapBoxInfos[this.mapBoxlength]={path:t[o],boxSp:null,pitch:!1},this.mapBoxlength++;else for(o=t.length-1;o>=0;o--)t[o].color=cc.Color.BLACK,t[o].opacity=51,this.mapBoxInfos[this.mapBoxlength]={path:t[o],boxSp:null,pitch:!1},this.mapBoxlength++},e.prototype.setPause=function(t){this.isPause=t,this.sendEvent(d.TLB_EventName.SetPause,this.isPause)},e.prototype.isUpBoxFight=function(){for(var t in this.mapBoxInfos)if(null!=this.mapBoxInfos[t].boxSp&&!this.mapBoxInfos[t].boxSp.isResidentBox)return!0;return!1},e.prototype.playGame=function(){this.isUpBoxFight()?null==this.pitchBox?(this.txtLevel.string="\u7b2c"+this.nowMaxWave+"/20\u6ce2",this.isThePlay?(this.isTapPlayGame=!0,this.blastMapLayer()):(this.updateEnemyLayerWave(),this.isfight=!0),this.isPrepare=!1,this.isThePlay=!0,this.playMoveAnim(!0),this.sendEvent(d.TLB_EventName.PlayGame)):this.upTipsBox("\u8bf7\u677e\u5f00\u683c\u5b50\u540e\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c"):this.upTipsBox("\u8bf7\u5148\u653e\u7f6e\u683c\u5b50")},e.prototype.playMoveAnim=function(t){var e=this,o=cc.v3();o=t?cc.v3(0,this.shopBoxRoot.y-1100):cc.v3(0,this.shopBoxRoot.y+1100),cc.tween(this.shopBoxRoot).to(.2,{position:o}).call(function(){t||(e.isPrepare=!0)}).start()},e.prototype.waveOver=function(){p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.dakaibaoxiang),this.levelBar.progress=0,this.isfight=!1,this.playMoveAnim(!1),this.upAddBoxWeight(),this.updateBoxSpare()},e.prototype.update=function(t){if(!this.isPause&&this.isfight)if(this._StepEnemy++>20&&(this._StepEnemy=0,this.tierBoxLList(this.enemyBase)),this.isUpRoleAtk&&(this.upRoleAtkTime+=t,this.upRoleAtkTime>this.upRoleAtkCountTime&&(this.isUpRoleAtk=!1,this.upRoleAtkTime=0,this.boxRoleUpAtk=0,this.roleMove.upAtkAnim.active=!1)),!this.isMinWaveOver&&this.isCanWave)this.outWaveTime+=t,this.outWaveTime>this.waveInterval&&(this.outWaveTime=0,this.nowminWave++,this.updateEnemyMinWave());else if(this.outEnemyTime+=t,this.outEnemyTime>this.outEnemyInterval){this.outEnemyTime=0;var e=Object.keys(this.enemyTypeNum);if(0===e.length)return void(this.isCanWave=!0);this.isCanWave=!1;var o=Number(e[Math.floor(Math.random()*e.length)]);this.enemyTypeNum[o],this.outEnemy(o),this.enemyTypeNum[o]-=1,0==this.enemyTypeNum[o]&&delete this.enemyTypeNum[o],0===Object.keys(this.enemyTypeNum).length?this.isCanWave=!0:this.isCanWave=!1}},e.prototype.updateEnemyMaxWave=function(){this.nowMaxWave++,this.nowWaveEnemyInfo=[];for(var t=0;t<this.waveCfg.length;t++)this.waveCfg[t].id==this.nowMaxWave&&this.nowWaveEnemyInfo.push(this.waveCfg[t]);for(this.nowLayerWave=0,this.tempNumLayer=[],t=0;t<this.nowWaveEnemyInfo.length;t++)this.tempNumLayer.includes(this.nowWaveEnemyInfo[t].levels)||this.tempNumLayer.push(this.nowWaveEnemyInfo[t].levels);this.nowAtkMapLaye=0,this.nowLayerNum=this.tempNumLayer.length,this.outMapLayer()},e.prototype.updateEnemyLayerWave=function(){this.nowLayerWave++,this.nowLayerEnemyInfo=[],this.waveEnemyAllSum=0;for(var t=0;t<this.nowWaveEnemyInfo.length;t++)this.nowWaveEnemyInfo[t].levels==this.nowLayerWave&&(this.nowLayerEnemyInfo.push(this.nowWaveEnemyInfo[t]),this.waveEnemyAllSum+=this.nowWaveEnemyInfo[t].MonsterSum,20==this.nowWaveEnemyInfo[t].id&&t==this.nowWaveEnemyInfo.length-1&&(this.isWaveGameOver=!0));this.levelBar.progress=0,this.waveEnemySum=0,this.nowminWave=0,this.lastBreak=0,this.isMinWaveOver=!1,this.updateEnemyMinWave()},e.prototype.updateEnemyMinWave=function(){if(!(this.nowminWave>=this.nowLayerEnemyInfo.length)){p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.direnchuxian),this.enemyTypeNum=[],this.waveInterval=this.nowLayerEnemyInfo[this.nowminWave].FirstInterval;for(var t=this.nowLayerEnemyInfo[this.nowminWave].MonsterSum,e=0;e<this.nowLayerEnemyInfo[this.nowminWave].Monster.length;e++){var o=this.nowLayerEnemyInfo[this.nowminWave].Monster[e][0];this.enemyTypeNum[o]=1}for(e=0;e<t-this.nowLayerEnemyInfo[this.nowminWave].Monster.length;e++)this.addOutEnemyQueue(this.nowLayerEnemyInfo[this.nowminWave].Monster);this.nowminWave==this.nowLayerEnemyInfo.length-1&&(this.isMinWaveOver=!0),this.isCanWave=!1}},e.prototype.addOutEnemyQueue=function(t){var e=this.random(0,t.length,!0),o=t[e][0];this.enemyTypeNum[o]==t[e][1]?this.addOutEnemyQueue(t):this.enemyTypeNum[o]+=1},e.prototype.outEnemy=function(t){var e=this,o="enemy/enemy_"+t;v.default.getInstance().getObj(o,function(o){o.setParent(e.enemyBase),o.setPosition(e.enemyRandomPosInCircle(t)),o.getComponent(b.default).init(e.nowMaxWave),e.enemyAllLsit.push(o)})},e.prototype.enemyRandomPosInCircle=function(t){var e=this.birthEnemyPos.convertToWorldSpaceAR(cc.v2(0,0)),o=360*Math.random()*Math.PI/180,i=e.x+Math.cos(o)*this.radius,n=e.y+Math.sin(o)*this.radius,a=cc.v2(i,n),r=this.enemyBase.convertToNodeSpaceAR(a);if(r.y>260){var s=r.y-260;r.y=260+.65*s}return 4==t&&r.y<-140&&(s=r.y+140,r.y=.5*s-140),r},e.prototype.getEnemyNear=function(t,e){for(var o=t.convertToWorldSpaceAR(cc.v2(0,0)),i=[],n=0,a=this.enemyAllLsit;n<a.length;n++){var r=a[n];if(r.active){var s=r.convertToWorldSpaceAR(cc.v2(0,0)),c=s.x-o.x,l=s.y-o.y,p=c*c+l*l;i.push({enemy:r,sqrDist:p})}}return i.sort(function(t,e){return t.sqrDist-e.sqrDist}),i.length<e?this.enemyAllLsit:i.slice(0,e).map(function(t){return t.enemy})},e.prototype.getCollisionBullet=function(t){for(var e=t.boxCol.getBoundingBoxToWorld(),o=0,i=this.enemyAllLsit;o<i.length;o++){var n=i[o],a=n.getComponent(b.default).boxCol.getBoundingBoxToWorld();if(cc.Intersection.rectRect(e,a))return n}return null},e.prototype.getBlastCollisionBullet=function(t){for(var e=[],o=t.getBoundingBoxToWorld(),i=0,n=this.enemyAllLsit;i<n.length;i++){var a=n[i],r=a.getComponent(b.default).boxCol.getBoundingBoxToWorld();cc.Intersection.rectRect(o,r)&&e.push(a)}return e},e.prototype.removeEnemyList=function(t){var e=this.enemyAllLsit.indexOf(t);this.enemyAllLsit.splice(e,1),this.waveEnemySum++,this.updateLevelBar(),this.waveEnemySum>=this.waveEnemyAllSum&&(this.isWaveGameOver?(this.setPause(!0),u.UIMgr.getInstance().openUI(d.TLB_UIID.TLB_UIGameOver,1,!0)):this.blastMapLayer())},e.prototype.getPosScaleCfg=function(t){var e=this.mapLaterPosScale[t];return null==e&&(e={pos:cc.v3(0,-720),scale:.4}),e},e.prototype.outMapLayer=function(){var t=this;if(20!=this.nowMaxWave){var e=this.findNextMapLayer()+1;this.loadPrefab(d.TLB_BundleName.Prefabs,"mapLayre/mapLayre",function(o){if(1==t.nowMaxWave){t.mapIndex++,t.mapIndex>=4&&(t.mapIndex=1);for(var i=t.nowLayerNum+1,n=function(e){var n=cc.instantiate(o);n.setParent(t.towerLayer),n.setSiblingIndex(0);var a=t.getPosScaleCfg(e+1);n.setPosition(a.pos),n.setScale(a.scale);var r=e==i-1?4:t.mapIndex;n.getComponent(g.default).skinID=r;var s="mapLayre/dt_0"+r;t.loadSpriteFrame(d.TLB_BundleName.Sprite,s,function(t){n.getChildByName("mapIcon").getComponent(cc.Sprite).spriteFrame=t}),e==i-1&&(n.getChildByName("box_Anim").active=!0),t.mapLayreLsit.push(n)},a=0;a<i;a++)n(a)}t.mapIndex++,t.mapIndex>=4&&(t.mapIndex=1);var r=function(i){var n=cc.instantiate(o);n.setParent(t.towerLayer),n.setSiblingIndex(0);var a=t.getPosScaleCfg(t.mapLayreLsit.length+1);n.setPosition(a.pos),n.setScale(a.scale);var r=i==e-1?4:t.mapIndex;n.getComponent(g.default).skinID=r;var s="mapLayre/dt_0"+r;t.loadSpriteFrame(d.TLB_BundleName.Sprite,s,function(t){n.getChildByName("mapIcon").getComponent(cc.Sprite).spriteFrame=t}),i==e-1&&(n.getChildByName("box_Anim").active=!0),t.mapLayreLsit.push(n)};for(a=0;a<e;a++)r(a)})}},e.prototype.findNextMapLayer=function(){this.nextWaveEnemyInf=[];for(var t=0;t<this.waveCfg.length;t++)this.waveCfg[t].id==this.nowMaxWave+1&&this.nextWaveEnemyInf.push(this.waveCfg[t]);for(this.nextTempNumLayer=[],t=0;t<this.nextWaveEnemyInf.length;t++)this.nextTempNumLayer.includes(this.nextWaveEnemyInf[t].levels)||this.nextTempNumLayer.push(this.nextWaveEnemyInf[t].levels);return this.nextLayerNum=this.nextTempNumLayer.length,this.nextLayerNum},e.prototype.blastMapLayer=function(){var t=this;this.isfight=!1,this.sendEvent(d.TLB_EventName.blastMapLayer),this.sendEvent(d.TLB_EventName.RoleMoveTakeOff,!0),this.isTapPlayGame||this.nowAtkMapLaye++,this.isTapPlayGame=!1,this.roleMove.isPassAnim=!0,this.roleMove.skillAgainCount=!1,this.roleMove.skillId2=!1,this.roleMove.skillId3=!1,this.roleMove.skillAgain=!1,this.roleMove.moveSpeed=this.roleMove.basicsMoveSpeed,this.roleMove.spAnim.setAnimation(0,"run",!0),this.roleMove.upAtkAnim.active&&(this.roleMove.upAtkAnim.active=!1);var e=cc.v3(16,177);this.roleMove.node.x>e.x?this.roleMove.node.scaleX=-this.roleMove.roleScale:this.roleMove.node.x<e.x&&(this.roleMove.node.scaleX=this.roleMove.roleScale),cc.Tween.stopAllByTarget(this.roleMove.node),cc.tween(this.roleMove.node).to(.5,{position:e}).call(function(){t.roleMove.spAnim.timeScale=.6,t.roleMove.spAnim.setAnimation(0,"jump3",!1)}).start(),cc.Tween.stopAllByTarget(this.mapBoxFrame),cc.tween(this.mapBoxFrame).to(.2,{opacity:0}).start(),cc.Tween.stopAllByTarget(this.gameUI),cc.tween(this.gameUI).to(.5,{scale:.7}).start(),cc.Tween.stopAllByTarget(this.towerLayer),cc.tween(this.towerLayer).to(.5,{scale:.7}).start()},e.prototype.roleTakeOff=function(){var t=this,e=cc.Camera.main.node;cc.Tween.stopAllByTarget(e),cc.tween(e).to(.5,{position:cc.v3(0,250)}).to(.6,{position:cc.v3(0,0)}).start();var o=this.node.parent.getChildByName("ui_Top");cc.Tween.stopAllByTarget(o),cc.tween(o).to(.5,{position:cc.v3(0,250)}).to(.6,{position:cc.v3(0,0)}).start();var i=[cc.v3(16,377),cc.v3(16,50),cc.v3(16,177)];cc.Tween.stopAllByTarget(this.roleMove.node),cc.tween(this.roleMove.node).to(.5,{position:i[0]}).call(function(){t.roleMove.spAnim.setAnimation(0,"jump4",!1);for(var e=0;e<t.mapLayreLsit.length;e++){var o=t.mapLayreLsit[e],i=t.getPosScaleCfg(e);cc.tween(o).to(1,{position:i.pos,scale:i.scale}).start()}t.roleMove.downAnim.active=!0,setTimeout(function(){t.roleMove.spAnim.node.opacity=0},110),setTimeout(function(){t.roleMove.downAnim.active=!1,t.roleMove.spAnim.node.opacity=255},400)}).to(.4,{position:i[1]}).call(function(){t.roleMove.fallAnim.node.active=!0,t.roleMove.fallAnim.setAnimation(0,d.TLB_AnimName.animation,!1),t.shakeMapLayer()}).to(.6,{position:i[2]}).call(function(){t.roleMove.spAnim.timeScale=1,t.roleMove.spAnim.setAnimation(0,"run",!0),t.roleMove.isPassAnim=!1,t.sendEvent(d.TLB_EventName.RoleMoveTakeOff,!1),cc.Tween.stopAllByTarget(t.mapBoxFrame),cc.tween(t.mapBoxFrame).to(.2,{opacity:255}).start(),cc.Tween.stopAllByTarget(t.gameUI),cc.tween(t.gameUI).to(.5,{scale:1}).start(),cc.Tween.stopAllByTarget(t.towerLayer),cc.tween(t.towerLayer).to(.5,{scale:1}).call(function(){if(t.nowAtkMapLaye>=t.nowLayerNum){var e=t.mapLayreLsit[0].getChildByName("box_Anim").getComponent(sp.Skeleton);e.setCompleteListener(function(e){"open"==e.animation.name&&(t.waveOver(),t.updateEnemyMaxWave())}),e.setAnimation(0,"open",!1)}else t.updateEnemyLayerWave(),t.isfight=!0}).start()}).start()},e.prototype.breakOpenMapLayer=function(){var t=this;setTimeout(function(){p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.suidi);var e=t.mapLayreLsit.shift(),o="skin_"+e.getComponent(g.default).skinID;e.getChildByName("mapIcon").active=!1,e.getChildByName("break").active=!1,e.getChildByName("box_Anim").active=!1;var i=e.getChildByName("blastAnim").getComponent(sp.Skeleton);i.node.active=!0,i.setCompleteListener(function(t){t.animation.name==d.TLB_AnimName.animation&&e.destroy()}),i.setSkin(o),i.setAnimation(0,d.TLB_AnimName.animation,!1)},100)},e.prototype.shakeMapLayer=function(){for(var t=1,e=0;e<this.mapLayreLsit.length;e++){var o=this.mapLayreLsit[e].getChildByName("mapIcon"),i=10*(t-=.3);e%2==1&&(i=-i);var n=o.position.clone(),a=[cc.v3(n.x+i,n.y),cc.v3(n.x-i,n.y),cc.v3(n.x+i,n.y-i),cc.v3(n.x-i,n.y+i),cc.v3(n.x+i,n.y+i),cc.v3(n.x-i,n.y-i),cc.v3(n.x+i,n.y-i),cc.v3(n.x-i,n.y+i),n];cc.tween(o).to(.05,{position:a[0]}).to(.05,{position:a[1]}).to(.05,{position:a[2]}).to(.05,{position:a[3]}).to(.05,{position:a[4]}).to(.05,{position:a[5]}).to(.05,{position:a[6]}).to(.05,{position:a[7]}).to(.05,{position:a[8]}).start()}},e.prototype.updateLevelBar=function(){var t=this.waveEnemySum/this.waveEnemyAllSum;cc.Tween.stopAllByTarget(this.levelBar),cc.tween(this.levelBar).to(.1,{progress:t}).start();var e=-1;if(t>=this.firstBreak&&t<this.secondBreak?1!=this.lastBreak&&(this.lastBreak=1,e=0):t>=this.secondBreak&&t<this.thirdBreak?2!=this.lastBreak&&(this.lastBreak=2,e=1):t>=this.thirdBreak&&3!=this.lastBreak&&(this.lastBreak=3,e=2),-1!=e){var o=this.mapLayreLsit[0];if(null!=o){var i=o.getChildByName("break");i.active=!0,i.getComponent(cc.Sprite).spriteFrame=this.breakIcon[e],i.opacity=0,cc.tween(i).to(.2,{opacity:255}).start(),this.playMapSplit(i),this.shakeLayer(o),p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.dilie)}}},e.prototype.shakeLayer=function(t){var e=t.position.clone(),o=[cc.v3(e.x+3.5,e.y+3.5),cc.v3(e.x-3.5,e.y-3.5),cc.v3(e.x+3.5,e.y-3.5),cc.v3(e.x-3.5,e.y+3.5),cc.v3(e.x+3.5,e.y+3.5),cc.v3(e.x-3.5,e.y-3.5),cc.v3(e.x+3.5,e.y-3.5),cc.v3(e.x-3.5,e.y+3.5),e];cc.Tween.stopAllByTarget(t),cc.tween(t).to(.05,{position:o[0]}).to(.05,{position:o[1]}).to(.05,{position:o[2]}).to(.05,{position:o[3]}).to(.05,{position:o[4]}).to(.05,{position:o[5]}).to(.05,{position:o[6]}).to(.05,{position:o[7]}).to(.05,{position:o[8]}).start()},e.prototype.roleMovePathIndex=function(t){if(!this.mapBoxInfos[t].pitch){var e=this.mapBoxInfos[t].path;if(cc.Tween.stopAllByTarget(e),cc.tween(e).to(.06,{scale:1.18}).to(.1,{}).to(.5,{scale:1}).start(),null!=this.mapBoxInfos[t].boxSp&&this.mapBoxInfos[t].boxSp.node.active&&!this.mapBoxInfos[t].boxSp.upEnterCourse){var o=this.mapBoxInfos[t].boxSp;cc.Tween.stopAllByTarget(o.node),cc.tween(o.node).to(.06,{scale:1.18}).to(.1,{}).to(.5,{scale:1}).start(),o.triggerStart()}}},e.prototype.reverseRoleMove=function(){this.roleMove.reverseMove();for(var t=0,e=this.moveArrows.children;t<e.length;t++){var o=e[t];1==o.scaleY?o.scaleY=-1:o.scaleY=1}},e.prototype.upAtkHarm=function(t,e){this.upRoleAtkCountTime=e,this.upRoleAtkTime=0,this.boxRoleUpAtk=t,this.isUpRoleAtk=!0,this.roleMove.upAtkAnim.active=!0},e.prototype.addHP=function(t,e){void 0===e&&(e=!1),t=this.round(t),e&&(this.maxHp=this.round(this.maxHp+t)),this.nowHp=this.round(this.nowHp+t),this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.updateHpBar()},e.prototype.addShield=function(t){var e=this;t=this.round(t),this.txtShield.node.parent.active||(this.txtShield.node.parent.active=!0),this.shield+=t,this.shield>100&&(this.shield=100),this.txtShield.string=""+this.shield,this.txtShield.node.color=this.color_Green,cc.Tween.stopAllByTarget(this.txtShield.node.parent),cc.tween(this.txtShield.node.parent).to(.075,{scale:1.2}).to(.075,{scale:1}).call(function(){e.txtShield.node.color=cc.Color.WHITE}).start(),this.playAddShieldEff()},e.prototype.deductHP=function(t){var e=this;if(!this.isPause){t=this.round(t);var o=-1;this.shield>0?(this.shield-=t,this.txtShield.string=""+this.shield,this.shield<=0?(o=Math.abs(this.shield),this.txtShield.node.parent.active=!1,this.shield=0):(this.txtShield.node.color=this.color_Red,cc.Tween.stopAllByTarget(this.txtShield.node.parent),cc.tween(this.txtShield.node.parent).to(.075,{scale:1.2}).to(.075,{scale:1}).call(function(){e.txtShield.node.color=cc.Color.WHITE}).start()),p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.hudunshouji)):o=t,-1!=o&&(this.nowHp-=o,this.updateHpBar(),this.nowHp<=0&&(this.setPause(!0),u.UIMgr.getInstance().openUI(d.TLB_UIID.TLB_UIGameOver,1,!1),p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.shibai)))}},e.prototype.updateHpBar=function(){var t=this;this.txtHp.string=""+this.nowHp,this.lastNowHp!=this.nowHp&&(this.txtHp.node.color=this.nowHp>this.lastNowHp?this.color_Green:this.color_Red,cc.Tween.stopAllByTarget(this.txtHp.node),cc.tween(this.txtHp.node).to(.075,{scale:.6}).to(.075,{scale:.5}).call(function(){t.txtHp.node.color=cc.Color.WHITE}).start()),this.lastNowHp=this.nowHp;var e=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.15,{progress:e}).start()},e.prototype.playSkillsAtk=function(t){var e,o,i=this,n=0,a=7;for(var r in this.mapBoxInfos)if(null!=this.mapBoxInfos[r].boxSp){var s=this.mapBoxInfos[r].boxSp;s.skillID==t&&s.level<a&&(n=s.typeID,a=s.level)}var c=h.default.getInstance().getBoxProInfo(n,a);e=c.Atk,o=h.default.getInstance().getSkillsCfg(t).mateSkillATK;var l="skills/skill_"+t;this.loadPrefab(d.TLB_BundleName.Prefabs,l,function(n){var a=cc.instantiate(n);a.setParent(i.skillsBase),a.setPosition(cc.v3());var r=i.round(o*e);a.getComponent(y.default).init(r,t)})},e.prototype.roleFieldSkill=function(t){var e,o=this,i=0,n=7,a=1e3;for(var r in this.mapBoxInfos)if(null!=this.mapBoxInfos[r].boxSp){var s=this.mapBoxInfos[r].boxSp;s.skillID==t&&s.atkForce<a&&(i=s.typeID,n=s.level,a=s.atkForce)}var c=h.default.getInstance().getBoxProInfo(i,n);a=c.Atk,e=h.default.getInstance().getSkillsCfg(t).mateSkillATK,this.loadPrefab(d.TLB_BundleName.Prefabs,"role/roleFieldSkill",function(t){var i=cc.instantiate(t);i.setParent(o.boxRoleBase),i.setPosition(cc.v3(500,290));var n=o.round(e*a);i.getComponent(B.default).init(n)})},e.prototype.updateBoxSpare=function(){for(var t=this,e=0,o=this.boxSpareAll;e<o.length;e++){var i=o[e],n=this.sceneAllBox.indexOf(i.getComponent(_.default));this.sceneAllBox.splice(n,1)}this.boxSpare.removeAllChildren(),this.boxSpareAll=[];for(var a=0,r=this.randomBoxs(3),s=function(e){c.loadPrefab(d.TLB_BundleName.Prefabs,"boxPlace/boxPlace",function(o){var i=cc.instantiate(o);i.setParent(t.boxSpare);var n=i.getComponent(_.default);n.init(e.CharacterID,e.grade),t.boxSpareAll.push(i),t.sceneAllBox.push(n),3==++a&&(t.calculateLayout(-1,!0),t.sendEvent(d.TLB_EventName.UpdateSceneAllBox,t.sceneAllBox))})},c=this,l=0,p=r;l<p.length;l++)s(p[l])},e.prototype.randomBoxs=function(t){for(var e=this.characterCfg.filter(function(t){return t.weight>0}),o=[],i=[],n=0,a=0,r=e;a<r.length;a++)n+=r[a].weight,i.push(n);var s=n;this.initRandomBoxs||(o.push(e[this.random(0,9,!0)]),this.initRandomBoxs=!0,t--);for(var c=0;c<t;c++)for(var l=Math.random()*s,p=0;p<i.length;p++)if(l<i[p]){o.push(e[p]);break}return o},e.prototype.upAddBoxWeight=function(){for(var t=0,e=this.characterCfg;t<e.length;t++){var o=e[t];o.weight+=o.weightUp}},e.prototype.moveBoxPlace=function(t,e){if(t==d.TLB_MoveBoxtate.TouchStart){if(this.setParentPos(e.node,this.gameTopRoot),this.boxSpareAll.includes(e.node)){var o=this.boxSpareAll.indexOf(e.node);this.boxSpareAll.splice(o,1),this.calculateLayout()}-1!=e.mapKey&&(this.mapBoxInfos[e.mapKey].boxSp=null)}var i=-1,n=null,a=this.getWorldPosV2(e.node),r=Number.MAX_SAFE_INTEGER;for(var s in this.mapBoxInfos){var c=Number(s),l=this.mapBoxInfos[c].path,p=cc.Vec2.distance(a,this.getWorldPosV2(l));p<r&&(r=p,p<65&&(i=c,n=this.mapBoxInfos[c]))}0==i&&(i=-1,n=null,null!=this.lastmMinDisPath&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1),this.lastmMinDisPath=null)),null!=this.lastmMinDisPath&&r>=65&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1),this.lastmMinDisPath=null),null!=n&&n!=this.lastmMinDisPath&&(null!=this.lastmMinDisPath&&this.playMoveBoxAnim(this.lastmMinDisPath,!1),this.playMoveBoxAnim(n,!0),this.lastmMinDisPath=n),t==d.TLB_MoveBoxtate.TouchEnd&&(null!=this.lastmMinDisPath&&(this.playMoveBoxAnim(this.lastmMinDisPath,!1),this.lastmMinDisPath=null),this.endBoxPlace(e,i))},e.prototype.playMoveBoxAnim=function(t,e){var o=e?1.18:1,i=e?255:51,n=e?cc.Color.GREEN:cc.Color.BLACK,a=e?.06:.15,r=t.path;if(e&&(t.pitch=e),cc.Tween.stopAllByTarget(r),cc.tween(r).to(a,{scale:o,opacity:i,color:n}).call(function(){e||(t.pitch=e)}).start(),null!=t.boxSp){var s=t.boxSp.node;cc.Tween.stopAllByTarget(s),cc.tween(s).to(a,{scale:o}).start()}},e.prototype.endBoxPlace=function(t,e){var o=this;if(-1!=e){this.setParentPos(t.node,this.upBoxEnterBase);var i=this.mapBoxInfos[e].path;if(null!=this.mapBoxInfos[e].boxSp){var n=this.mapBoxInfos[e].boxSp;if(n.typeID==t.typeID&&n.level==t.level&&n.level<5){var a=n.node.convertToWorldSpaceAR(cc.v3(0,0)),r=t.node.parent.convertToNodeSpaceAR(a);return cc.Tween.stopAllByTarget(t.node),void cc.tween(t.node).to(.07,{position:r}).call(function(){n.upBoxLevel();var e=o.sceneAllBox.indexOf(t);o.sceneAllBox.splice(e,1),o.sendEvent(d.TLB_EventName.UpdateSceneAllBox,o.sceneAllBox),t.node.destroy(),o.updateSolderID()}).start()}}if(-1!=t.mapKey&&null!=this.mapBoxInfos[e].boxSp){var s=this.mapBoxInfos[t.mapKey].path;this.mapBoxInfos[e].boxSp.upBoxEnter(t.mapKey,s),this.mapBoxInfos[t.mapKey].boxSp=this.mapBoxInfos[e].boxSp}else null!=this.mapBoxInfos[e].boxSp&&this.insertRoleBoxSpare(this.mapBoxInfos[e].boxSp);p.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.fangrugezi),this.tierBoxLList(this.upBoxEnterBase),t.upBoxEnter(e,i),this.mapBoxInfos[e].boxSp=t}else{for(var c=this.getWorldPosV2(t.node),l=function(e){var i=u.getWorldPosV2(e);if(cc.Vec2.distance(c,i)<60){var n=e.getComponent(_.default);if(n.typeID==t.typeID&&n.level==t.level&&n.level<5){var a=n.node.convertToWorldSpaceAR(cc.v3(0,0)),r=t.node.parent.convertToNodeSpaceAR(a);return cc.Tween.stopAllByTarget(t.node),cc.tween(t.node).to(.07,{position:r}).call(function(){n.upBoxLevel();var e=o.sceneAllBox.indexOf(t);o.sceneAllBox.splice(e,1),o.sendEvent(d.TLB_EventName.UpdateSceneAllBox,o.sceneAllBox),t.node.destroy(),o.updateSolderID()}).start(),{value:void 0}}}},u=this,h=0,f=this.boxSpareAll;h<f.length;h++){var m=l(f[h]);if("object"==typeof m)return m.value}this.insertRoleBoxSpare(t)}this.updateSolderID()},e.prototype.insertRoleBoxSpare=function(t){t.downBoxEnter(),this.setParentPos(t.node,this.boxSpare);var e=this.findPosIndex(t.node);e<this.boxSpare.childrenCount&&this.boxSpare.insertChild(t.node,e),e>this.boxSpareAll.length?this.boxSpareAll.push(t.node):this.boxSpareAll.splice(e,0,t.node),this.calculateLayout(e)},e.prototype.findPosIndex=function(t){if(0==this.boxSpareAll.length)return 0;for(var e=0,o=Number.MAX_SAFE_INTEGER,i=this.getWorldPosV2(t),n=0;n<this.boxSpareAll.length;n++){var a=cc.Vec2.distance(i,this.getWorldPosV2(this.boxSpareAll[n]));a<o&&(o=a,e=n)}return this.getWorldPosV2(this.boxSpareAll[e]).x>i.x?e:e+1},e.prototype.calculateLayout=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=this.boxSpareAll;if(!(o.length<1)){var i=this.boxSpare.width-20,n=o.reduce(function(t,e){return t+e.width},0),a=[];if(n<=i)for(var r=-i/2+(p=(i-n)/(o.length+1)),s=0,c=o;s<c.length;s++){var l=c[s];a.push(cc.v3(r+l.width/2,0)),r+=l.width+p}else for(var p=(i-n)/(o.length-1),u=(r=-i/2,0),d=o;u<d.length;u++)l=d[u],a.push(cc.v3(r+l.width/2,0)),r+=l.width+p;for(var h=0;h<o.length;h++){var f=h,m=o[f];cc.Tween.stopAllByTarget(m),t==f||e?cc.tween(m).to(.2,{position:a[f],angle:this.random(0,1)>.5?7:-7,scale:1.3},{easing:"quadOut"}).start():cc.tween(m).to(.2,{position:a[f],scale:1.3},{easing:"quadOut"}).start()}}},e.prototype.updateSolderID=function(){for(var t in this.solderGainIDs=[],this.activateSkillAtks=[],this.mapBoxInfos)if(null!=this.mapBoxInfos[t].boxSp){var e=this.mapBoxInfos[t].boxSp;this.solderGainIDs.includes(e.typeID)||this.solderGainIDs.push(e.typeID),(null==this.activateSkillAtks[e.skillID]||e.level<this.activateSkillAtks[e.skillID])&&(this.activateSkillAtks[e.skillID]=e.level)}this.getActivatedMateIDs()},e.prototype.getActivatedMateIDs=function(){var t=this;this.activateSkills=[];for(var e=function(e){for(var i=0,n=o.mateCfgs;i<n.length;i++){var a=n[i];o.activateSkills.includes(a.mateID)||a.mateRole.split("|").some(function(t){return t.split(",").map(function(t){return+t}).includes(e)})&&a.mateRole.split("|").some(function(e){return e.split(",").map(function(t){return+t}).every(function(e){return t.solderGainIDs.includes(e)})})&&o.activateSkills.push(a.mateID)}},o=this,i=0,n=this.solderGainIDs;i<n.length;i++)e(n[i]);this.sendEvent(d.TLB_EventName.ActivateSkills,this.activateSkills,this.activateSkillAtks)},e.prototype.upTipsBox=function(t){this.sendEvent(d.TLB_EventName.UpTipsBox,t)},e.prototype.tierBoxLList=function(t){var e=t.children;e.length<2||(e.sort(function(t,e){return e.y-t.y}),e.forEach(function(t,e){t.setSiblingIndex(e)}))},e.prototype.playBoxUpLevelEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/boxUpLevelEff",function(t){t.setParent(e.gameTopRoot);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playMapSplit=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/mapSplit",function(t){t.setParent(e.towerLayer);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playKnockback=function(){var t=this,e=this.mapMidPos.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/knockback",function(o){o.setParent(t.towerLayer);var i=o.parent.convertToNodeSpaceAR(e);i.y-=30,o.setPosition(i)})},e.prototype.playAddHpEff=function(){var t=this;v.default.getInstance().getObj("effAnim/upAddHpEff",function(e){e.setParent(t.mapBoxFrame),e.setPosition(cc.v2(0,-20))})},e.prototype.playAddShieldEff=function(){var t=this;v.default.getInstance().getObj("effAnim/upAddShieldEff",function(e){e.setParent(t.txtShield.node.parent),e.setPosition(cc.v2())})},e.prototype.playOutEnemyEff=function(t){v.default.getInstance().getObj("effAnim/outEnemyEff",function(e){null!=t&&(e.setParent(t),e.setPosition(cc.v2()))})},e.prototype.playDieEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/dieEff",function(t){t.setParent(e.enemyBase);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playHarmEff=function(t,e,o){var i=this,n=o.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/harmEff",function(o){o.setParent(i.roleBulletBase);var a=o.parent.convertToNodeSpaceAR(n);a.y+=50,o.setPosition(a),o.getComponent(m.default).init(i.round(t),e)})},e.prototype.playOutRoleEff=function(t,e){var o=this,i=e?"outRoleEff":"dieRoleEff",n=t.convertToWorldSpaceAR(cc.v2(0,0));v.default.getInstance().getObj("effAnim/"+i,function(t){t.setParent(o.gameTopRoot);var e=t.parent.convertToNodeSpaceAR(n);t.setPosition(e)})},e.prototype.getWorldPosV2=function(t){return t.parent.convertToWorldSpaceAR(t.getPosition())},e.prototype.getWorldPosV3=function(t){return t.parent.convertToWorldSpaceAR(t.position)},e.prototype.setParentPos=function(t,e){var o=this.getWorldPosV3(t);t.setParent(e);var i=e.convertToNodeSpaceAR(o);t.setPosition(i)},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.prototype.round2=function(t){return Math.round(100*t)/100},e.prototype.showBuffSelection=function(){var t=this.getAvailableBuffs();return this.getRandomBuffs(t,this.buffsPerRefresh)},e.prototype.onBuffSelected=function(t){this.buffSelectionCount[t]=(this.buffSelectionCount[t]||0)+1},e.prototype.getAvailableBuffs=function(){var t=this;return this.buffDatas.filter(function(e){return(t.buffSelectionCount[e.ID]||0)<e.buffNum})},e.prototype.getRandomBuffs=function(t,e){return t.length<e?t:t.sort(function(){return.5-Math.random()}).slice(0,e)},e.prototype.selectBuff=function(t,e){e=this.round2(e),null==this.roleBoxBuffAtk[t]?this.roleBoxBuffAtk[t]=e:this.roleBoxBuffAtk[t]+=e,this.sendEvent(d.TLB_EventName.UpdateRolePro)},e.Instance=null,c([D(cc.Node)],e.prototype,"gameUI",void 0),c([D(cc.Node)],e.prototype,"gameTopRoot",void 0),c([D(cc.Node)],e.prototype,"boxSpare",void 0),c([D(cc.Node)],e.prototype,"mapBoxFrame",void 0),c([D(cc.Node)],e.prototype,"shopBoxRoot",void 0),c([D(cc.Node)],e.prototype,"upBoxEnterBase",void 0),c([D(I.default)],e.prototype,"roleMove",void 0),c([D(cc.Node)],e.prototype,"towerLayer",void 0),c([D(cc.Node)],e.prototype,"birthEnemyPos",void 0),c([D(cc.Node)],e.prototype,"enemyBase",void 0),c([D(cc.Node)],e.prototype,"mapMidPos",void 0),c([D(cc.Node)],e.prototype,"hp_Root",void 0),c([D(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([D(cc.Label)],e.prototype,"txtHp",void 0),c([D(cc.Label)],e.prototype,"txtShield",void 0),c([D(cc.Node)],e.prototype,"moveArrows",void 0),c([D(cc.Node)],e.prototype,"boxRoleBase",void 0),c([D(cc.Node)],e.prototype,"roleBulletBase",void 0),c([D(cc.Node)],e.prototype,"enemyAtkRange",void 0),c([D(cc.ProgressBar)],e.prototype,"levelBar",void 0),c([D(cc.Label)],e.prototype,"txtLevel",void 0),c([D(cc.Node)],e.prototype,"skillsBase",void 0),c([D(cc.Node)],e.prototype,"boxInfoTips",void 0),c([D(cc.Node)],e.prototype,"btn_PlayGo",void 0),c([D(cc.SpriteFrame)],e.prototype,"breakIcon",void 0),o=c([C],e)}(l.default);a.default=T,cc._RF.pop(),cc._RF.pop()},{}],TLB_HarmEff:[function(t,e,o){"use strict";cc._RF.push(e,"3b74e4F1H9PcaD+t2nW9xc5","TLB_HarmEff");var i=t,n=e,a=o;cc._RF.push(n,"3b74e4F1H9PcaD+t2nW9xc5","TLB_HarmEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TLB_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconCritical=null,e.txtHarm=null,e}return s(e,t),e.prototype.init=function(t,e){var o=this;this.iconCritical.active=e,this.node.opacity=255,this.txtHarm.string=""+t;var i=this.node.position.clone();i.y+=40,cc.tween(this.node).to(.3,{position:i}).call(function(){i.y+=40}).to(.3,{position:i,opacity:0}).call(function(){o.die()}).start()},e.prototype.die=function(){p.default.getInstance().pushObj(this.node)},c([h(cc.Node)],e.prototype,"iconCritical",void 0),c([h(cc.Label)],e.prototype,"txtHarm",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TLB_MapLayre:[function(t,e,o){"use strict";cc._RF.push(e,"9384dl55+lEk6Evk+kXlqAC","TLB_MapLayre");var i=e,n=o;cc._RF.push(i,"9384dl55+lEk6Evk+kXlqAC","TLB_MapLayre");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skinID=0,e}return r(e,t),s([l],e)}(cc.Component));n.default=p,cc._RF.pop(),cc._RF.pop()},{}],TLB_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"952f2rh9FNJjrX0Mm2qT2Zi","TLB_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"952f2rh9FNJjrX0Mm2qT2Zi","TLB_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=i("TLB_Config"),l=cc._decorator.ccclass,p=function(){function t(){this.poolMap={},this.poolRoot=null;var t=new cc.Node("TLB_PoolRoot"),e=cc.find("uiRoot");t.setParent(e),e.insertChild(t,0),this.poolRoot=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e){var o=t.replace(/\//g,"_");this.poolMap[o]&&this.poolMap[o].poolList.length>0?e(this.poolMap[o].getObj()):s.ResourceMgr.getInstance().loadRes(c.TLB_BundleName.Prefabs,t,cc.Prefab,function(t){var i=cc.instantiate(t);i.name=o,e(i)})},t.prototype.pushObj=function(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new u(t,this.poolRoot);this.poolMap[e]=o}},t.prototype.clear=function(){this.poolMap={},this.poolRoot.removeAllChildren()},e=r([l],t)}();a.default=p;var u=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],TLB_RoleBullet:[function(t,e,o){"use strict";cc._RF.push(e,"dbf0c+dkINPXasIuaZEVLJe","TLB_RoleBullet");var i=t,n=e,a=o;cc._RF.push(n,"dbf0c+dkINPXasIuaZEVLJe","TLB_RoleBullet");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("TLB_Config"),d=i("TLB_GameMgr"),h=i("TLB_PoolMgr"),f=i("TLB_EnemyRole"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.boxCol=null,e.blastCol=null,e.fieldBullet=null,e.typeID=0,e.isDie=!1,e.moveDir=cc.v2(),e.moveSpeed=600,e.dieTime=0,e.atkForce=0,e.criticalForce=0,e.criticalChance=0,e.bulletEffect=0,e.bulletPro=1,e.atkList=[],e.lastEnemy=null,e.isSplitBullxet=!1,e}var o;return s(e,t),o=e,e.prototype.init=function(t){var e=this;if(this.isDie=!1,this.typeID=t.typeID,this.atkForce=t.atkForce,this.criticalChance=t.criticalChance,this.criticalForce=t.criticalForce,this.bulletEffect=t.bulletEffect,this.bulletPro=t.bulletPro,this.moveDir=t.dir,this.isSplitBullxet=t.isSplitBullxet,this.atkList=[],this.lastEnemy=null,-1==this.typeID)this.fieldBullet.active=!0,this.spAnim.node.active=!1;else{this.fieldBullet.active=!1,this.spAnim.node.active=!0;var o=""+u.TLB_RoleAsePath[this.typeID].bulletPath;this.loadResFromBundle(u.TLB_BundleName.SpAnim,o,sp.SkeletonData,function(t){e.spAnim.skeletonData=t,e.spAnim.setAnimation(0,u.TLB_RoleAsePath[e.typeID].bulletSkill,!0)})}},e.prototype.update=function(t){d.default.Instance.isPause||this.isDie||(this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t,this.checkCollisionEnemy(),this.dieTime+=t,5!=this.bulletEffect?this.dieTime>2&&this.die():this.dieTime>8&&this.die())},e.prototype.checkCollisionEnemy=function(){var t=this,e=d.default.Instance.getCollisionBullet(this);if(e){var i=e.getComponent(f.default);if(i.isDie)return;if(3==this.bulletEffect){p.AudioMgr.getInstance().playEffectFree(u.TLB_AudioId.baozha);var n=this.blastCol.convertToWorldSpaceAR(cc.v2(0,0));h.default.getInstance().getObj("effAnim/bulletBlast",function(t){t.setParent(d.default.Instance.roleBulletBase);var e=t.parent.convertToNodeSpaceAR(n);t.setPosition(e)});for(var a=0,r=d.default.Instance.getBlastCollisionBullet(this.blastCol);a<r.length;a++){var s=(v=r[a]).getComponent(f.default);s.isDie||s.attackEd(d.default.Instance.round(this.atkForce),!1)}this.die()}else{if(5!=this.bulletEffect){if(this.atkList.includes(e))return}else if(null!=this.lastEnemy&&this.lastEnemy==e)return;this.atkList.push(e);var c=this.atkForce,l=Math.random()<this.criticalChance;switch(l&&(c=this.atkForce*this.criticalForce),c=d.default.Instance.round(c),i.attackEd(c,l),this.bulletEffect){case 1:this.atkList.length>=this.bulletPro&&this.die();break;case 2:i.knockback(this.node,10),this.die();break;case 4:i.frozenEd(this.bulletPro),this.die();break;case 5:if(this.lastEnemy=e,this.atkList.length>=this.bulletPro)this.die();else{for(var m=null,g=0,y=I=d.default.Instance.getEnemyNear(this.node,2);g<y.length;g++){var v=y[g];if(this.lastEnemy!=v){m=v;break}}if(null!=m){var _=this.node.convertToWorldSpaceAR(cc.v2(0,0)),b=m.convertToWorldSpaceAR(cc.v2(0,0)).sub(_).normalize(),B=180*Math.atan2(b.y,b.x)/Math.PI-90;this.node.angle=B,this.moveDir=b}}break;case 9:var I;if(!this.isSplitBullxet&&(this.lastEnemy=e,(I=d.default.Instance.getEnemyNear(this.node,this.bulletPro+1)).length>0)){_=this.node.convertToWorldSpaceAR(cc.v2(0,0));for(var P=this.node.convertToWorldSpaceAR(cc.v2(0,0)),C=function(e){if(I[e]==D.lastEnemy)return"continue";var i=I[e].convertToWorldSpaceAR(cc.v2(0,0)).sub(_).normalize(),n=180*Math.atan2(i.y,i.x)/Math.PI-90;h.default.getInstance().getObj("bullet/roleBullet",function(e){e.setParent(d.default.Instance.roleBulletBase);var a=e.parent.convertToNodeSpaceAR(P);e.setPosition(a),e.angle=n;var r=e.getComponent(o),s={typeID:t.typeID,level:1,atkForce:t.atkForce,criticalChance:t.criticalChance,criticalForce:t.criticalForce,bulletEffect:t.bulletEffect,bulletPro:t.bulletPro,dir:i,isSplitBullxet:!0,randomAtkNum:[]};r.init(s),r.atkList=t.atkList})},D=this,T=0;T<I.length;T++)C(T)}this.die();break;default:this.die()}}}},e.prototype.die=function(){this.isDie=!0,this.moveDir=cc.v2(),this.dieTime=0,h.default.getInstance().pushObj(this.node)},c([y(sp.Skeleton)],e.prototype,"spAnim",void 0),c([y(cc.Node)],e.prototype,"boxCol",void 0),c([y(cc.Node)],e.prototype,"blastCol",void 0),c([y(cc.Node)],e.prototype,"fieldBullet",void 0),o=c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],TLB_RoleFieldSkill:[function(t,e,o){"use strict";cc._RF.push(e,"51bf8NHR5VG3q1ZD/+xl/Ww","TLB_RoleFieldSkill");var i=t,n=e,a=o;cc._RF.push(n,"51bf8NHR5VG3q1ZD/+xl/Ww","TLB_RoleFieldSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TLB_Config"),u=i("TLB_GameMgr"),d=i("TLB_PoolMgr"),h=i("TLB_RoleBullet"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkPos=null,e.isDie=!0,e.atkInterval=.22,e.atkTime=0,e.atkForce=10,e}return s(e,t),e.prototype.onLoad=function(){this.addEvent(p.TLB_EventName.blastMapLayer,this.die)},e.prototype.init=function(t){var e=this;this.isDie=!0,this.node.scaleX=-1,cc.tween(this.node).to(.5,{position:cc.v3(269,290)}).call(function(){e.isDie=!1}).start(),this.atkForce=t},e.prototype.update=function(t){u.default.Instance.isPause||this.isDie||(this.atkTime+=t,this.atkTime>this.atkInterval&&(this.atkTime=0,this.attack()))},e.prototype.attack=function(){var t=u.default.Instance.getEnemyNear(this.node,1);if(t.length>0){var e=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),o=u.default.Instance.round(this.atkForce+=u.default.Instance.boxRoleUpAtk),i=this.atkPos.convertToWorldSpaceAR(cc.v2(0,0)),n=t[0].convertToWorldSpaceAR(cc.v2(0,0)).sub(e).normalize(),a=180*Math.atan2(n.y,n.x)/Math.PI-90;d.default.getInstance().getObj("bullet/roleBullet",function(t){t.setParent(u.default.Instance.roleBulletBase);var e=t.parent.convertToNodeSpaceAR(i);t.setPosition(e),t.angle=a;var r={typeID:-1,level:1,atkForce:o,criticalChance:0,criticalForce:1,bulletEffect:-1,bulletPro:0,dir:n,isSplitBullxet:!1,randomAtkNum:[]};t.getComponent(h.default).init(r)})}},e.prototype.die=function(){var t=this;this.isDie||(this.isDie=!0,this.node.scaleX=1,cc.tween(this.node).to(.5,{position:cc.v3(500,290)}).call(function(){t.node.destroy()}).start())},c([g(sp.Skeleton)],e.prototype,"spAnim",void 0),c([g(cc.Node)],e.prototype,"atkPos",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],TLB_RoleMateTips:[function(t,e,o){"use strict";cc._RF.push(e,"d31894lZqRA/7KD54cRjniq","TLB_RoleMateTips");var i=t,n=e,a=o;cc._RF.push(n,"d31894lZqRA/7KD54cRjniq","TLB_RoleMateTips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TLB_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtTips=null,e.weaponIcon1=null,e.weaponIcon2=null,e.mateCfg={7:{role:[6,10],name:"\u5929\u9f99\u516b\u90e8"},8:{role:[3],name:"\u5c18\u5916\u53cc\u6e05"},9:{role:[1,7],name:"\u5251\u80c6\u7434\u5fc3"},10:{role:[4,5],name:"\u4e09\u987e\u8305\u5e90"},11:{role:[8,17],name:"\u667a\u52c7\u53cc\u5168"}},e}return s(e,t),e.prototype.init=function(t){var e=this,o=this.mateCfg[t];if(null!=o){cc.Tween.stopAllByTarget(this.node),this.node.opacity=0,this.node.active=!0,cc.tween(this.node).to(.2,{opacity:255}).start();var i="boxIcon/"+p.TLB_BoxIconPath[o.role[0]].iconPath;if(this.loadSpriteFrame(p.TLB_BundleName.Sprite,i,function(t){e.weaponIcon1.spriteFrame=t}),8!=t){this.weaponIcon2.node.parent.active=!0;var n="boxIcon/"+p.TLB_BoxIconPath[o.role[1]].iconPath;this.loadSpriteFrame(p.TLB_BundleName.Sprite,n,function(t){e.weaponIcon2.spriteFrame=t})}else this.weaponIcon2.node.parent.active=!1;var a="";switch(t){case 7:a="<b><outline color=black width=4>\u4e54\u5e2e\u4e3b&\u900d\u9065\u50e7\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 8:a="<b><outline color=black width=4>\u5ae6\u5a25\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 9:a="<b><outline color=black width=4>\u609f\u7a7a&\u7d2b\u971e\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 10:a="<b><outline color=black width=4>\u5218\u5907&\u8bf8\u845b\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>";break;case 11:a="<b><outline color=black width=4>\u5173\u7fbd&\u5b59\u5c1a\u9999\uff1a\u7f81\u7eca-<color=5bfe1b>"+o.name+"</color></outline></b>"}this.txtTips.string=a}else console.error(t+" ID\uff0c\u914d\u7f6e\u4e3a\u7a7a\uff0c\u5173\u95ed\u7f81\u7eca\u63d0\u793a"),cc.Tween.stopAllByTarget(this.node),this.node.active=!1},e.prototype.die=function(){var t=this;this.node.active&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.active=!1}).start())},c([h(cc.RichText)],e.prototype,"txtTips",void 0),c([h(cc.Sprite)],e.prototype,"weaponIcon1",void 0),c([h(cc.Sprite)],e.prototype,"weaponIcon2",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TLB_RoleMove:[function(t,e,o){"use strict";cc._RF.push(e,"aa311ED2NhAAqJaEX1fLYY5","TLB_RoleMove");var i=t,n=e,a=o;cc._RF.push(n,"aa311ED2NhAAqJaEX1fLYY5","TLB_RoleMove");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l,p=i("BaseCtrl"),u=i("AudioMgr"),d=i("TLB_Config"),h=i("TLB_GameMgr"),f=cc._decorator,m=f.ccclass,g=f.property;!function(t){t.jump="jump",t.move="run",t.fast="fast"}(l||(l={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.upAtkAnim=null,e.fallAnim=null,e.downAnim=null,e.mapBoxInfos={},e.mapBoxlength=0,e.nowMovePos=cc.v2(),e.nowMoveIndex=0,e.roleScale=.7,e.basicsMoveSpeed=160,e.moveSpeed=0,e.skill2MoveSpeed=0,e.skillId2=!1,e.skillId2Time=0,e.skillId2CountTime=0,e.skillId3=!1,e.skillId3Time=0,e.skillId3CountTime=0,e.isReverseMove=!1,e.skillAgain=!1,e.skillAgainCount=!1,e.triggerAgain=!1,e.isPassAnim=!1,e.audioTime=0,e.lastAgainIndex=-1,e.loongPos=null,e.moveDistance=0,e.direction=null,e.move=null,e.distance=0,e}return s(e,t),e.prototype.start=function(){var t=this;this.fallAnim.setCompleteListener(function(e){e.animation.name==d.TLB_AnimName.animation&&(t.fallAnim.node.active=!1)}),this.spAnim.setCompleteListener(function(e){e.animation.name==l.jump&&(t.skillAgainCount=!1,t.spAnim.setAnimation(0,l.fast,!0),t.skillId2||t.skillId3?t.spAnim.setAnimation(0,l.fast,!0):t.spAnim.setAnimation(0,l.move,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==l.jump&&("jump3"==t.spAnim.animation?h.default.Instance.roleTakeOff():"jump4"==t.spAnim.animation?h.default.Instance.breakOpenMapLayer():t.spAnim.animation==l.jump&&h.default.Instance.roleMovePathIndex(t.nowMoveIndex))}),this.moveSpeed=this.basicsMoveSpeed,this.addEvent(d.TLB_EventName.SetPause,this.setPause)},e.prototype.init=function(t,e){this.mapBoxInfos=t,this.mapBoxlength=e,u.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.paobu),this.getMovePos(),this.node.active=!0},e.prototype.update=function(t){if(!h.default.Instance.isPause&&!this.skillAgainCount&&!this.isPassAnim){if(this.node.x>this.nowMovePos.x&&this.node.scaleX!=-this.roleScale?this.node.scaleX=-this.roleScale:this.node.x<this.nowMovePos.x&&this.node.scaleX!=this.roleScale&&(this.node.scaleX=this.roleScale),this.loongPos=this.node.getPosition(),this.moveDistance=this.moveSpeed*t,this.direction=this.nowMovePos.sub(this.loongPos).normalize(),this.move=this.direction.mul(this.moveDistance),this.node.setPosition(this.loongPos.add(this.move)),this.distance=this.nowMovePos.sub(this.loongPos).mag(),this.distance<=this.moveDistance){if(this.skillAgain&&this.lastAgainIndex!=this.nowMoveIndex)return h.default.Instance.mapBoxInfos[this.nowMoveIndex].boxSp&&(h.default.Instance.roleMovePathIndex(this.nowMoveIndex),this.lastAgainIndex=this.nowMoveIndex,this.skillAgainCount=!0,this.triggerAgain=!0,this.spAnim.setAnimation(0,l.jump,!1),u.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.chufaliangci)),void(this.skillAgain=!1);u.AudioMgr.getInstance().playEffectFree(d.TLB_AudioId.paobu),this.node.setPosition(this.nowMovePos),this.triggerAgain||h.default.Instance.roleMovePathIndex(this.nowMoveIndex),this.triggerAgain=!1,this.lastAgainIndex=-1,this.isReverseMove?(this.nowMoveIndex--,this.nowMoveIndex<0&&(this.nowMoveIndex=this.mapBoxlength-1)):(this.nowMoveIndex++,this.nowMoveIndex>=this.mapBoxlength&&(this.nowMoveIndex=0)),this.getMovePos(),123==this.node.x&&this.node.scaleX!=-this.roleScale?this.node.scaleX=-this.roleScale:-123==this.node.x&&this.node.scaleX!=this.roleScale&&(this.node.scaleX=this.roleScale)}this.skillId2&&(this.skillId2Time+=t,this.skillId2Time>this.skillId2CountTime&&(this.skillId2=!1,this.skillId2Time=0,this.skillId3||(this.moveSpeed=this.basicsMoveSpeed,this.spAnim.setAnimation(0,l.move,!0)))),this.skillId3&&(this.skillId3Time+=t,this.skillId3Time>this.skillId3CountTime&&(this.skillId3=!1,this.skillId3Time=0,this.skillId2?this.moveSpeed=this.skill2MoveSpeed:(this.moveSpeed=this.basicsMoveSpeed,this.spAnim.setAnimation(0,l.move,!0)))),this.skillId2||this.skillId3||this.moveSpeed==this.basicsMoveSpeed||(this.moveSpeed=this.basicsMoveSpeed,this.spAnim.setAnimation(0,l.move,!0))}},e.prototype.upSpeed=function(t,e){this.skill2MoveSpeed=t,this.skillId3||(this.moveSpeed=t,this.spAnim.animation!=l.jump&&this.spAnim.setAnimation(0,l.fast,!0)),this.skillId2CountTime=e,this.skillId2=!0,this.skillId2Time=0},e.prototype.soonSpeed=function(t,e){this.moveSpeed=t,this.skillId3CountTime=e,this.skillId3=!0,this.skillId3Time=0,this.spAnim.animation!=l.jump&&this.spAnim.setAnimation(0,l.fast,!0)},e.prototype.reverseMove=function(){var t=null,e=0;this.isReverseMove?((e=this.nowMoveIndex+1)>=this.mapBoxlength&&(e=0),t=this.mapBoxInfos[e].path):((e=this.nowMoveIndex-1)<0&&(e=this.mapBoxlength-1),t=this.mapBoxInfos[e].path);var o=t.convertToWorldSpaceAR(cc.v2(0,0)),i=this.node.parent.convertToNodeSpaceAR(o);this.node.x>i.x?this.node.scaleX=-this.roleScale:this.node.x<i.x&&(this.node.scaleX=this.roleScale),this.isReverseMove=!this.isReverseMove},e.prototype.nextAgain=function(){this.skillAgain=!0},e.prototype.enter=function(){this.spAnim.setAnimation(0,l.fast,!0)},e.prototype.getMovePos=function(){var t=this.mapBoxInfos[this.nowMoveIndex].path.convertToWorldSpaceAR(cc.v2(0,0)),e=this.node.parent.convertToNodeSpaceAR(t);this.nowMovePos=e},e.prototype.setPause=function(t){this.spAnim.paused=t},c([g(sp.Skeleton)],e.prototype,"spAnim",void 0),c([g(cc.Node)],e.prototype,"upAtkAnim",void 0),c([g(sp.Skeleton)],e.prototype,"fallAnim",void 0),c([g(cc.Node)],e.prototype,"downAnim",void 0),c([m],e)}(p.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],TLB_Skills:[function(t,e,o){"use strict";cc._RF.push(e,"184daBAvO9BF6/+jT1vZR5A","TLB_Skills");var i=t,n=e,a=o;cc._RF.push(n,"184daBAvO9BF6/+jT1vZR5A","TLB_Skills");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TLB_Config"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e.atkForce=0,e.skillID=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.addEvent(p.TLB_EventName.blastMapLayer,this.die),this.spAnim.setCompleteListener(function(e){e.animation.name==p.TLB_AnimName.animation&&t.die()}),this.spAnim.setEventListener(function(e,o){switch(o.data.name){case p.TLB_AnimName.attack:case"hit":t.sendEvent(p.TLB_EventName.PlaySkillsAtk,t.skillID,t.atkForce)}}),this.addEvent(p.TLB_EventName.SetPause,this.setGameState)},e.prototype.init=function(t,e){var o=this;this.atkForce=t,this.skillID=e,this.spAnim.setAnimation(0,p.TLB_AnimName.animation,!1),6==this.skillID&&setTimeout(function(){o.sendEvent(p.TLB_EventName.PlaySkillsAtk,o.skillID,o.atkForce)},300)},e.prototype.setGameState=function(t){this.spAnim.paused=t},e.prototype.die=function(){this.node.destroy()},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TLB_UIBuffPro:[function(t,e,o){"use strict";cc._RF.push(e,"02cf1SQdGFL0LkW+hWqitNl","TLB_UIBuffPro");var i=t,n=e,a=o;cc._RF.push(n,"02cf1SQdGFL0LkW+hWqitNl","TLB_UIBuffPro");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("TLB_Config"),u=i("TLB_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.itemBuffInfo=null,e.itemBase=null,e.noTips=null,e}return s(e,t),e.prototype.start=function(){var t=this,e=Object.entries(JSON.parse(JSON.stringify(u.default.Instance.roleBoxBuffAtk)));e.sort(function(t,e){return e[1]-t[1]});for(var o=!0,i=function(t,e){var i=Number(t);o=!1;var a="";switch(i){case 1:a="\u609f\u7a7a";break;case 3:a="\u5ae6\u5a25";break;case 4:a="\u5218\u5907";break;case 5:a="\u8bf8\u845b";break;case 6:a="\u4e54\u5e2e\u4e3b";break;case 7:a="\u7d2b\u971e";break;case 8:a="\u5173\u7fbd";break;case 10:a="\u900d\u9065\u50e7";break;case 17:a="\u5b59\u5c1a\u9999"}var r=Math.floor(100*e),s="#5bfe1b";if(r<=10?s="#5bfe1b":r>10&&r<=20?s="#1bc1fe":r>20&&r<=30?s="#e11bfe":r>30&&r<=40?s="#ffdb14":r>40&&(s="#ff2371"),null!=p.TLB_BoxIconPath[i]){var c=cc.instantiate(n.itemBuffInfo);c.active=!0,c.setParent(n.itemBase),c.getChildByName("proInfo").getComponent(cc.RichText).string="<b><outline color=black width=4>"+a+"\uff0c\u653b\u51fb\u529b\u52a0<color="+s+">+"+r+"%</color></outline></b>";var l="roleIcon/"+p.TLB_BoxIconPath[i].iconPath;n.loadSpriteFrame(p.TLB_BundleName.Sprite,l,function(t){c.getChildByName("roleIcon").getComponent(cc.Sprite).spriteFrame=t})}else console.error("\u83b7\u53d6\uff1a"+i+" \u56fe\u6807\u8def\u5f84\u5931\u8d25")},n=this,a=0,r=e;a<r.length;a++){var s=r[a];i(s[0],s[1])}this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),u.default.Instance.setPause(!1)},this),this.noTips.active=o},c([f(cc.Node)],e.prototype,"btnClose",void 0),c([f(cc.Node)],e.prototype,"itemBuffInfo",void 0),c([f(cc.Node)],e.prototype,"itemBase",void 0),c([f(cc.Node)],e.prototype,"noTips",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],TLB_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"34c37XAq15LzYzGbfpPbzOM","TLB_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"34c37XAq15LzYzGbfpPbzOM","TLB_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("TLB_Config"),u=i("TLB_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.timeSpeed1=null,e.txtTimeSpeed=null,e.isTimeSpeed=!0,e.updateBoxSpare=null,e.gmAddRoleAtk=null,e}return s(e,t),e.prototype.start=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.updateBoxSpare.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.updateBoxSpare()},this),this.gmAddRoleAtk.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(p.TLB_EventName.GmAddRoleAtk)},this)},c([f(cc.Node)],e.prototype,"btnClose",void 0),c([f(cc.Node)],e.prototype,"timeSpeed1",void 0),c([f(cc.Label)],e.prototype,"txtTimeSpeed",void 0),c([f(cc.Node)],e.prototype,"updateBoxSpare",void 0),c([f(cc.Node)],e.prototype,"gmAddRoleAtk",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],TLB_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"82381PW5b5OG5bho4VVabPd","TLB_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"82381PW5b5OG5bho4VVabPd","TLB_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("TLB_APP"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.win=null,e.fail=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this),this.win.active=this.isWin,this.fail.active=!this.isWin},c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"win",void 0),c([h(cc.Node)],e.prototype,"fail",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TLB_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"c628bSDSY1CgoB6mN/mhpH3","TLB_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"c628bSDSY1CgoB6mN/mhpH3","TLB_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("SdkMgr"),h=i("TLB_Config"),f=i("TLB_DataMgr"),m=i("TLB_GameMgr"),g=i("TLB_Btn_Skills"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lockTips=null,e.btnPause=null,e.btnBuffPro=null,e.skillBtnsBase=null,e.btn_Skills=null,e.skillTips=null,e.upTips=null,e.activateSkills=[],e.isHidePause=!1,e}return s(e,t),e.prototype.start=function(){var t=this;(d.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR)&&this.lockTips.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.TLB_UIID.TLB_UIGM)},this),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.isHidePause||(m.default.Instance.setPause(!0),t.openUI(h.TLB_UIID.TLB_UIPause))},this),this.btnBuffPro.on(cc.Node.EventType.TOUCH_END,function(){t.isHidePause||(m.default.Instance.setPause(!0),t.openUI(h.TLB_UIID.TLB_UIBuffPro))},this),this.addEvent(h.TLB_EventName.ActivateSkills,this.onRoleSkillAdded),this.addEvent(h.TLB_EventName.UpTipsBox,this.upTipsBox),this.addEvent(h.TLB_EventName.RoleMoveTakeOff,this.hideBtnPause)},e.prototype.onRoleSkillAdded=function(t,e){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(null==this.activateSkills[n]){var a=cc.instantiate(this.btn_Skills);a.setParent(this.skillBtnsBase),a.active=!0,this.activateSkills[n]=a.getComponent(g.default),this.activateSkills[n].init(n,e[n]),this.playAddSkillTips(n)}else this.activateSkills[n].isDie=!1,this.activateSkills[n].node.active=!0,this.activateSkills[n].updateLevel(e[n])}for(var r=[],s=0,c=Object.entries(this.activateSkills);s<c.length;s++){var l=c[s],p=l[0],u=(l[1],Number(p));t.includes(u)||r.push(u)}for(var d=0,h=r;d<h.length;d++)n=h[d],this.activateSkills[n].isDie=!0,this.activateSkills[n].node.active=!1},e.prototype.playAddSkillTips=function(t){var e=cc.instantiate(this.skillTips);e.setParent(this.skillTips.parent),e.active=!0,e.getChildByName("tipsName").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).mateName,e.getChildByName("info").getComponent(cc.Label).string=f.default.getInstance().getSkillsCfg(t).introduce;var o="skillsBtnIcon/"+f.default.getInstance().getSkillsCfg(t).mateIconRes;this.loadSpriteFrame(h.TLB_BundleName.Sprite,o,function(t){e.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}),e.setPosition(0,400),e.setScale(0);var i=e.position.clone();i.y+=300,cc.tween(e).to(.2,{scale:1}).to(2,{}).to(.4,{position:i}).call(function(){e.destroy()}).start()},e.prototype.upTipsBox=function(t){var e=32*t.length+30,o=cc.instantiate(this.upTips);o.setParent(this.upTips.parent),o.active=!0,o.width=e,o.getChildByName("txtTips").getComponent(cc.Label).string=t,o.scale=0;var i=o.position.clone();i.y+=300,cc.tween(o).to(.2,{scale:1}).to(1.2,{scale:1}).to(.5,{position:i,opacity:.3}).call(function(){o.destroy()}).start()},e.prototype.hideBtnPause=function(t){this.isHidePause=t;var e=t?0:255;cc.Tween.stopAllByTarget(this.btnPause),cc.tween(this.btnPause).to(.2,{opacity:e}).start()},c([_(cc.Node)],e.prototype,"lockTips",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"btnBuffPro",void 0),c([_(cc.Node)],e.prototype,"skillBtnsBase",void 0),c([_(cc.Node)],e.prototype,"btn_Skills",void 0),c([_(cc.Node)],e.prototype,"skillTips",void 0),c([_(cc.Node)],e.prototype,"upTips",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],TLB_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"ceb5cfYDIhOY7k+xXOhAy9h","TLB_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"ceb5cfYDIhOY7k+xXOhAy9h","TLB_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("TLB_APP"),u=i("TLB_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){u.default.Instance.setPause(!1),t.closeUI()},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0),t.closeUI()},this)},c([f(cc.Node)],e.prototype,"btnResume",void 0),c([f(cc.Node)],e.prototype,"btnClose",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],TLB_UISelectBuff:[function(t,e,o){"use strict";cc._RF.push(e,"590b1tcioVK6LtyHBL08WRH","TLB_UISelectBuff");var i=t,n=e,a=o;cc._RF.push(n,"590b1tcioVK6LtyHBL08WRH","TLB_UISelectBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("TLB_Config"),d=i("TLB_GameMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBase=null,e.itemBuff=null,e.randomBuffs=[],e.isSelected=!1,e}return s(e,t),e.prototype.init=function(t){this.randomBuffs=t},e.prototype.start=function(){this.isSelected=!1,this.showBuffSelection()},e.prototype.showBuffSelection=function(){for(var t=this,e=function(e){var i=cc.instantiate(o.itemBuff);i.setParent(o.itemBase),i.active=!0,i.on(cc.Node.EventType.TOUCH_END,function(){t.onBuffSelected(e.ID,e.buffParametric)},o),i.getChildByName("buffName").getComponent(cc.Label).string=e.buffName,i.getChildByName("buffInfo").getComponent(cc.RichText).string=e.buffCopy1;var n=i.getChildByName("buffIcon"),a="";9001!=e.ID&&9002!=e.ID&&9003!=e.ID?(a="roleIcon/"+u.TLB_BoxIconPath[e.ID].iconPath,n.setScale(.87)):a="boxIcon/dj_01",o.loadSpriteFrame(u.TLB_BundleName.Sprite,a,function(t){n.getComponent(cc.Sprite).spriteFrame=t});var r="buffBG/buffLevel"+e.buffQuality;o.loadSpriteFrame(u.TLB_BundleName.Sprite,r,function(t){i.getComponent(cc.Sprite).spriteFrame=t})},o=this,i=0,n=this.randomBuffs;i<n.length;i++)e(n[i])},e.prototype.onBuffSelected=function(t,e){this.isSelected||(this.isSelected=!0,d.default.Instance.setPause(!1),9001!=t&&9002!=t&&9003!=t?d.default.Instance.selectBuff(t,e):(p.AudioMgr.getInstance().playEffectFree(u.TLB_AudioId.huixue),d.default.Instance.addHP(e),d.default.Instance.playAddHpEff()),d.default.Instance.onBuffSelected(t),this.closeUI())},c([m(cc.Node)],e.prototype,"itemBase",void 0),c([m(cc.Node)],e.prototype,"itemBuff",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],TPVP_APP:[function(t,e,o){"use strict";cc._RF.push(e,"a2cb3+p6wpI4qW4luRZDsRa","TPVP_APP");var i=t,n=e,a=o;cc._RF.push(n,"a2cb3+p6wpI4qW4luRZDsRa","TPVP_APP");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("AudioMgr"),c=i("UIMgr"),l=i("TPVP_PoolMgr"),p=i("TPVP_Simulator"),u=i("TPVP_Config"),d=i("TPVP_DataMgr"),h=cc._decorator,f=h.ccclass,m=(h.property,function(){function t(){this._isInited=!1,this._exitCall=null}var e;return e=t,Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;void 0===o&&(o=!1),cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!0,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,this._exitCall=e,s.AudioMgr.getInstance().pauseAllMusic();var n=function(){i._isInited=!0,c.UIMgr.getInstance().openUIOfCallback(u.TPVP_UIID.TPVP_UIGame,u.TPVP_UIID.TPVP_UIGame,function(){t&&t()})};this._isInited?n():(c.UIMgr.getInstance().addUICnf(u.TPVP_UICF),s.AudioMgr.getInstance().addAdConf(u.TPVP_Audio),d.default.getInstance().loadCfg(function(){n()}))},t.prototype.exit_App=function(t){void 0===t&&(t=0),cc.find("uiRoot").getComponent(cc.Canvas).fitHeight=!1,cc.find("uiRoot").getComponent(cc.Canvas).fitWidth=!0,cc.systemEvent.clear(),c.UIMgr.getInstance().closeById(u.TPVP_UIID.TPVP_UIGame),c.UIMgr.getInstance().closeById(u.TPVP_UIID.TPVP_UIPause),c.UIMgr.getInstance().closeById(u.TPVP_UIID.TPVP_UIGameOver),this._exitCall&&this._exitCall(),this._exitCall=null,p.TPVP_Simulator.instance.clear(),l.default.getInstance().clear()},t._instance=null,e=r([f],t)}());a.default=m,cc._RF.pop(),cc._RF.pop()},{}],TPVP_Agent:[function(t,e,o){"use strict";cc._RF.push(e,"99d7fX9+uZBBrp6k8HimNAB","TPVP_Agent");var i=t,n=e,a=o;cc._RF.push(n,"99d7fX9+uZBBrp6k8HimNAB","TPVP_Agent"),Object.defineProperty(a,"__esModule",{value:!0}),a.TPVP_Agent=void 0;var r=i("TPVP_Common"),s=function(){function t(){this.agentNeighbors_=[],this.obstaclNeighbors_=[],this.orcaLines_=[],this.position_=new r.TPVP_Vector2(0,0),this.prefVelocity_=new r.TPVP_Vector2(0,0),this.velocity_=new r.TPVP_Vector2(0,0),this.id=0,this.maxNeighbors_=0,this.maxSpeed_=0,this._neighborDist=0,this.radius_=0,this.timeHorizon=0,this.timeHorizonObst=0,this.newVelocity_=new r.TPVP_Vector2(0,0),this.mass=1}return Object.defineProperty(t.prototype,"neighborDist",{get:function(){return this._neighborDist},set:function(t){this._neighborDist=t},enumerable:!1,configurable:!0}),t.prototype.computeNeighbors=function(t){this.obstaclNeighbors_.length=0;var e=Math.pow(this.timeHorizonObst*this.maxSpeed_+this.radius_,2);t.kdTree.computeObstacleNeighbors(this,e),this.agentNeighbors_.length=0,this.maxNeighbors_>0&&(e=Math.pow(this.neighborDist,2),e=t.kdTree.computeAgentNeighbors(this,e))},t.prototype.computeNewVelocity=function(t){this.orcaLines_.length=0;for(var e=this.orcaLines_,o=1/this.timeHorizonObst,i=0;i<this.obstaclNeighbors_.length;++i){for(var n=this.obstaclNeighbors_[i].value,a=n.next,s=n.point.minus(this.position_),c=a.point.minus(this.position_),l=!1,p=0;p<e.length;++p)if(r.TPVP_RVOMath.det(s.scale(o).minus(e[p].point),e[p].direction)-o*this.radius_>=-r.TPVP_RVOMath.RVO_EPSILON&&r.TPVP_RVOMath.det(c.scale(o).minus(e[p].point),e[p].direction)-o*this.radius_>=-r.TPVP_RVOMath.RVO_EPSILON){l=!0;break}if(!l){var u=r.TPVP_RVOMath.absSq(s),d=r.TPVP_RVOMath.absSq(c),h=r.TPVP_RVOMath.sqr(this.radius_),f=a.point.minus(n.point),m=s.scale(-1).multiply(f)/r.TPVP_RVOMath.absSq(f),g=r.TPVP_RVOMath.absSq(s.scale(-1).minus(f.scale(m))),y=new r.TPVP_Line;if(m<0&&u<=h)n.convex&&(y.point=new r.TPVP_Vector2(0,0),y.direction=r.TPVP_RVOMath.normalize(new r.TPVP_Vector2(-s.y,s.x)),e.push(y));else if(m>1&&d<=h)a.convex&&r.TPVP_RVOMath.det(c,a.direction)>=0&&(y.point=new r.TPVP_Vector2(0,0),y.direction=r.TPVP_RVOMath.normalize(new r.TPVP_Vector2(-c.y,c.x)),e.push(y));else if(m>=0&&m<=1&&g<=h)y.point=new r.TPVP_Vector2(0,0),y.direction=n.direction.scale(-1),e.push(y);else{var v=void 0,_=void 0;if(m<0&&g<=h){if(!n.convex)continue;a=n;var b=Math.sqrt(u-h);v=new r.TPVP_Vector2(s.x*b-s.y*this.radius_,s.x*this.radius_+s.y*b).scale(1/u),_=new r.TPVP_Vector2(s.x*b+s.y*this.radius_,-s.x*this.radius_+s.y*b).scale(1/u)}else if(m>1&&g<=h){if(!a.convex)continue;n=a;var B=Math.sqrt(d-h);v=new r.TPVP_Vector2(c.x*B-c.y*this.radius_,c.x*this.radius_+c.y*B).scale(1/d),_=new r.TPVP_Vector2(c.x*B+c.y*this.radius_,-c.x*this.radius_+c.y*B).scale(1/d)}else n.convex?(b=Math.sqrt(u-h),v=new r.TPVP_Vector2(s.x*b-s.y*this.radius_,s.x*this.radius_+s.y*b).scale(1/u)):v=n.direction.scale(-1),a.convex?(B=Math.sqrt(d-h),_=new r.TPVP_Vector2(c.x*B+c.y*this.radius_,-c.x*this.radius_+c.y*B).scale(1/d)):_=n.direction;var I=n.previous,P=!1,C=!1;n.convex&&r.TPVP_RVOMath.det(v,I.direction.scale(-1))>=0&&(v=I.direction.scale(-1),P=!0),a.convex&&r.TPVP_RVOMath.det(_,a.direction)<=0&&(_=a.direction,C=!0);var D=n.point.minus(this.position_).scale(o),T=a.point.minus(this.position_).scale(o),S=T.minus(D),A=n==a?.5:this.velocity_.minus(D).multiply(S)/r.TPVP_RVOMath.absSq(S),k=this.velocity_.minus(D).multiply(v),w=this.velocity_.minus(T).multiply(_);if(A<0&&k<0||n==a&&k<0&&w<0){var N=r.TPVP_RVOMath.normalize(this.velocity_.minus(D));y.direction=new r.TPVP_Vector2(N.y,-N.x),y.point=D.plus(N.scale(this.radius_*o)),e.push(y)}else if(A>1&&w<0)N=r.TPVP_RVOMath.normalize(this.velocity_.minus(T)),y.direction=new r.TPVP_Vector2(N.y,-N.x),y.point=T.plus(N.scale(this.radius_*o)),e.push(y);else{var R=A<0||A>1||n==a?1/0:r.TPVP_RVOMath.absSq(this.velocity_.minus(S.scale(A).plus(D))),M=k<0?1/0:r.TPVP_RVOMath.absSq(this.velocity_.minus(v.scale(k).plus(D))),O=w<0?1/0:r.TPVP_RVOMath.absSq(this.velocity_.minus(_.scale(w).plus(T)));if(R<=M&&R<=O){y.direction=n.direction.scale(-1);var E=new r.TPVP_Vector2(-y.direction.y,y.direction.x);y.point=E.scale(this.radius_*o).plus(D),e.push(y)}else if(M<=O){if(P)continue;y.direction=v,E=new r.TPVP_Vector2(-y.direction.y,y.direction.x),y.point=E.scale(this.radius_*o).plus(D),e.push(y)}else C||(y.direction=_.scale(-1),E=new r.TPVP_Vector2(-y.direction.y,y.direction.x),y.point=E.scale(this.radius_*o).plus(T),e.push(y))}}}}var L=e.length,x=1/this.timeHorizon;for(i=0;i<this.agentNeighbors_.length;++i){var F=this.agentNeighbors_[i].value,G=F.position_.minus(this.position_),U=F.mass/(this.mass+F.mass),j=this.mass/(this.mass+F.mass),H=U>=.5?this.velocity_.minus(this.velocity_.scale(U)).scale(2):this.prefVelocity_.plus(this.velocity_.minus(this.prefVelocity_).scale(2*U)),W=j>=.5?F.velocity_.scale(2).scale(1-j):F.prefVelocity_.plus(F.velocity_.minus(F.prefVelocity_).scale(2*j)),V=H.minus(W),K=r.TPVP_RVOMath.absSq(G),Y=this.radius_+F.radius_,z=r.TPVP_RVOMath.sqr(Y),X=void(y=new r.TPVP_Line);if(K>z){var q=V.minus(G.scale(x)),J=r.TPVP_RVOMath.absSq(q),Z=q.multiply(G);if(Z<0&&r.TPVP_RVOMath.sqr(Z)>z*J){var Q=Math.sqrt(J);N=q.scale(1/Q),y.direction=new r.TPVP_Vector2(N.y,-N.x),X=N.scale(Y*x-Q)}else{var $=Math.sqrt(K-z);r.TPVP_RVOMath.det(G,q)>0?(E=new r.TPVP_Vector2(G.x*$-G.y*Y,G.x*Y+G.y*$),y.direction=E.scale(1/K)):(E=new r.TPVP_Vector2(G.x*$+G.y*Y,-G.x*Y+G.y*$),y.direction=E.scale(-1/K));var tt=V.multiply(y.direction);X=y.direction.scale(tt).minus(V)}}else{var et=1/t;q=V.minus(G.scale(et)),Q=r.TPVP_RVOMath.abs(q),N=q.scale(1/Q),y.direction=new r.TPVP_Vector2(N.y,-N.x),X=N.scale(Y*et-Q)}y.point=H.plus(X.scale(U)),e.push(y)}var ot=this.linearProgram2(e,this.maxSpeed_,this.prefVelocity_,!1,this.newVelocity_);ot<e.length&&this.linearProgram3(e,L,ot,this.maxSpeed_,this.newVelocity_)},t.prototype.insertAgentNeighbor=function(t,e){if(this!=t){var o=r.TPVP_RVOMath.absSq(this.position_.minus(t.position_));if(o<e){this.agentNeighbors_.length<this.maxNeighbors_&&this.agentNeighbors_.push(new r.TPVP_KeyValuePair(o,t));for(var i=this.agentNeighbors_.length-1;0!=i&&o<this.agentNeighbors_[i-1].key;)this.agentNeighbors_[i]=this.agentNeighbors_[i-1],--i;this.agentNeighbors_[i]=new r.TPVP_KeyValuePair(o,t),this.agentNeighbors_.length==this.maxNeighbors_&&(e=this.agentNeighbors_[this.agentNeighbors_.length-1].key)}}return e},t.prototype.insertObstacleNeighbor=function(t,e){var o=t.next,i=r.TPVP_RVOMath.distSqPointLineSegment(t.point,o.point,this.position_);if(i<e){this.obstaclNeighbors_.push(new r.TPVP_KeyValuePair(i,t));for(var n=this.obstaclNeighbors_.length-1;0!=n&&i<this.obstaclNeighbors_[n-1].key;)this.obstaclNeighbors_[n]=this.obstaclNeighbors_[n-1],--n;this.obstaclNeighbors_[n]=new r.TPVP_KeyValuePair(i,t)}},t.prototype.update=function(t){this.velocity_.copy(this.newVelocity_),this.position_.copy(this.position_.plus(this.velocity_.scale(t)))},t.prototype.linearProgram1=function(t,e,o,i,n,a){var s=t[e].point.multiply(t[e].direction),c=r.TPVP_RVOMath.sqr(s)+r.TPVP_RVOMath.sqr(o)-r.TPVP_RVOMath.absSq(t[e].point);if(c<0)return!1;for(var l=Math.sqrt(c),p=-s-l,u=-s+l,d=0;d<e;++d){var h=r.TPVP_RVOMath.det(t[e].direction,t[d].direction),f=r.TPVP_RVOMath.det(t[d].direction,t[e].point.minus(t[d].point));if(Math.abs(h)<=r.TPVP_RVOMath.RVO_EPSILON){if(f<0)return!1}else{var m=f/h;if(h>=0?u=Math.min(u,m):p=Math.max(p,m),p>u)return!1}}return n?i.multiply(t[e].direction)>0?a.copy(t[e].point.plus(t[e].direction.scale(u))):a.copy(t[e].point.plus(t[e].direction.scale(p))):(m=t[e].direction.multiply(i.minus(t[e].point)))<p?a.copy(t[e].point.plus(t[e].direction.scale(p))):m>u?a.copy(t[e].point.plus(t[e].direction.scale(u))):a.copy(t[e].point.plus(t[e].direction.scale(m))),!0},t.prototype.linearProgram2=function(t,e,o,i,n){i?n.copy(o.scale(e)):r.TPVP_RVOMath.absSq(o)>r.TPVP_RVOMath.sqr(e)?n.copy(r.TPVP_RVOMath.normalize(o).scale(e)):n.copy(o);for(var a=0;a<t.length;++a)if(r.TPVP_RVOMath.det(t[a].direction,t[a].point.minus(n))>0){var s=n.clone();if(!this.linearProgram1(t,a,e,o,i,n))return n.copy(s),a}return t.length},t.prototype.linearProgram3=function(t,e,o,i,n){for(var a=0,s=o;s<t.length;++s)if(r.TPVP_RVOMath.det(t[s].direction,t[s].point.minus(n))>a){for(var c=[],l=0;l<e;++l)c.push(t[l]);for(var p=e;p<s;++p){var u=new r.TPVP_Line,d=r.TPVP_RVOMath.det(t[s].direction,t[p].direction);if(Math.abs(d)<=r.TPVP_RVOMath.RVO_EPSILON){if(t[s].direction.multiply(t[p].direction)>0)continue;u.point=t[s].point.plus(t[p].point).scale(.5)}else u.point=t[s].point.plus(t[s].direction.scale(r.TPVP_RVOMath.det(t[p].direction,t[s].point.minus(t[p].point))/d));u.direction=r.TPVP_RVOMath.normalize(t[p].direction.minus(t[s].direction)),c.push(u)}var h=n.clone();this.linearProgram2(c,i,new r.TPVP_Vector2(-t[s].direction.y,t[s].direction.x),!0,n)<c.length&&n.copy(h),a=r.TPVP_RVOMath.det(t[s].direction,t[s].point.minus(n))}},t}();a.TPVP_Agent=s,cc._RF.pop(),cc._RF.pop()},{}],TPVP_Common:[function(t,e,o){"use strict";cc._RF.push(e,"b21ab/9QsZNQ7vgDt0vtZ9T","TPVP_Common");var i=e,n=o;cc._RF.push(i,"b21ab/9QsZNQ7vgDt0vtZ9T","TPVP_Common"),Object.defineProperty(n,"__esModule",{value:!0}),n.TPVP_RVOMath=n.TPVP_KeyValuePair=n.TPVP_Line=n.TPVP_Obstacle=n.TPVP_Vector2=void 0;var a=function(){function t(t,e){this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.plus=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.minus=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.multiply=function(t){return this.x*t.x+this.y*t.y},t.prototype.scale=function(e){return new t(this.x*e,this.y*e)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.substract=function(t,e){return t.x-=e.x,t.y-=e.y,t},t.prototype.lengthSqr=function(){return Math.pow(this.x,2)+Math.pow(this.y,2)},t}();n.TPVP_Vector2=a,n.TPVP_Obstacle=function(){},n.TPVP_Line=function(){},n.TPVP_KeyValuePair=function(t,e){this.key=t,this.value=e};var r=function(){function t(){}return t.absSq=function(t){return t.multiply(t)},t.normalize=function(e){return e.scale(1/t.abs(e))},t.distSqPointLineSegment=function(e,o,i){var n=i.minus(e),a=o.minus(e),r=n.multiply(a)/t.absSq(a);return r<0?t.absSq(n):r>1?t.absSq(i.minus(o)):t.absSq(i.minus(e.plus(a.scale(r))))},t.sqr=function(t){return t*t},t.det=function(t,e){return t.x*e.y-t.y*e.x},t.abs=function(e){return Math.sqrt(t.absSq(e))},t.leftOf=function(e,o,i){return t.det(e.minus(i),o.minus(e))},t.RVO_EPSILON=1e-5,t}();n.TPVP_RVOMath=r,cc._RF.pop(),cc._RF.pop()},{}],TPVP_Config:[function(t,e,o){"use strict";cc._RF.push(e,"f1c847QiCRJvJ8bVyLhpujA","TPVP_Config");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"f1c847QiCRJvJ8bVyLhpujA","TPVP_Config"),Object.defineProperty(l,"__esModule",{value:!0}),l.TPVP_RoleAsePath=l.TPVP_CampType=l.TPVP_GameState=l.TPVP_MoveRoleState=l.TPVP_AnimName=l.TPVP_EventName=l.TPVP_Audio=l.TPVP_AudioId=l.TPVP_UICF=l.TPVP_UIID=l.TPVP_BundleName=void 0,function(t){t.Prefabs="TPVP_Prefabs",t.Sprite="TPVP_Sprite",t.Audio="TPVP_Audio",t.SpAnim="TPVP_SpAnim"}(a=l.TPVP_BundleName||(l.TPVP_BundleName={})),function(t){t.TPVP_UIGame="TPVP_UIGame",t.TPVP_UIGM="TPVP_UIGM",t.TPVP_UIPause="TPVP_UIPause",t.TPVP_UIGameOver="TPVP_UIGameOver",t.TPVP_UIRoleProTsipBox="TPVP_UIRoleProTsipBox"}(r=l.TPVP_UIID||(l.TPVP_UIID={})),l.TPVP_UICF=((i={})[r.TPVP_UIGame]={prefab:"ui/TPVP_UIGame",name:"TPVP_UIGame",showTop:!0,showMult:!1,zIndex:1001,bundleName:a.Prefabs},i[r.TPVP_UIGM]={prefab:"ui/TPVP_UIGM",name:"TPVP_UIGM",showTop:!0,showMult:!1,zIndex:1002,bundleName:a.Prefabs},i[r.TPVP_UIPause]={prefab:"ui/TPVP_UIPause",name:"TPVP_UIPause",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.TPVP_UIGameOver]={prefab:"ui/TPVP_UIGameOver",name:"TPVP_UIGameOver",showTop:!0,showMult:!1,zIndex:1100,bundleName:a.Prefabs},i[r.TPVP_UIRoleProTsipBox]={prefab:"ui/TPVP_UIRoleProTsipBox",name:"TPVP_UIRoleProTsipBox",showTop:!0,showMult:!1,zIndex:1050,bundleName:a.Prefabs},i),function(t){t.dragonHit="dragonHit",t.gongji="gongji",t.shibai="shibai",t.draw="draw",t.drawResult="drawResult",t.siwang="siwang",t.fangrugezi="fangrugezi",t.shengji="shengji"}(s=l.TPVP_AudioId||(l.TPVP_AudioId={})),l.TPVP_Audio=((n={})[s.dragonHit]={path:s.dragonHit,bundle:a.Audio},n[s.gongji]={path:s.gongji,bundle:a.Audio},n[s.shibai]={path:s.shibai,bundle:a.Audio},n[s.draw]={path:s.draw,bundle:a.Audio},n[s.drawResult]={path:s.drawResult,bundle:a.Audio},n[s.siwang]={path:s.siwang,bundle:a.Audio},n[s.fangrugezi]={path:s.fangrugezi,bundle:a.Audio},n[s.shengji]={path:s.shengji,bundle:a.Audio},n),function(t){t.SetGameState="TPVP_SetGameState",t.UpdateAllBoxAccord="TPVP_UpdateAllBoxAccord",t.PlayGame="TPVP_PlayGame",t.UnLockTbeBox="TPVP_UnLockTbeBox",t.UpTipsBox="TPVP_UpTipsBox",t.WaveOver="TPVP_WaveOver",t.MoveBoxTips="TPVP_moveBoxTips",t.PlayWpnProTips="TPVP_PlayWpnProTips"}(l.TPVP_EventName||(l.TPVP_EventName={})),function(t){t.attack="attack",t.idle="idle",t.move="run",t.animation="animation"}(l.TPVP_AnimName||(l.TPVP_AnimName={})),function(t){t[t.TouchStart=0]="TouchStart",t[t.TouchMove=1]="TouchMove",t[t.TouchEnd=2]="TouchEnd"}(l.TPVP_MoveRoleState||(l.TPVP_MoveRoleState={})),function(t){t[t.playing=0]="playing",t[t.pause=1]="pause"}(l.TPVP_GameState||(l.TPVP_GameState={})),function(t){t[t.Friend=0]="Friend",t[t.Enemy=1]="Enemy"}(l.TPVP_CampType||(l.TPVP_CampType={})),l.TPVP_RoleAsePath={101:{layerType:1,iconPath:"wq_"},201:{layerType:1,iconPath:"cm_"},301:{layerType:1,iconPath:"hd_"},401:{layerType:2,iconPath:"xj_"},501:{layerType:3,iconPath:"buff_7"},601:{layerType:3,iconPath:"buff_6"},701:{layerType:3,iconPath:"buff_10"},801:{layerType:3,iconPath:"buff_8"},901:{layerType:3,iconPath:"role"},1001:{layerType:3,iconPath:"buff_9"},2001:{layerType:3,iconPath:"buff_4"},3001:{layerType:2,iconPath:"tk_"},4001:{layerType:2,iconPath:"xz_"}},cc._RF.pop(),cc._RF.pop()},{}],TPVP_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"dd4c3o1poVKFoIRaTXqeBNQ","TPVP_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"dd4c3o1poVKFoIRaTXqeBNQ","TPVP_DataMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.loadCfg=function(t){var e=this;r.ResourceMgr.getInstance().loadRes("TPVP_Config","GameJsonCfg",cc.JsonAsset,function(o){e.data=o.json,o.decRef(),t&&t()})},t.prototype.getCfgByPrimaryKey=function(t,e,o){if(t)for(var i=0;i<t.length;i++)if(t[i][o]==e)return t[i];return null},t.prototype.getCfgByPrimaryKey2=function(t,e,o,i,n){if(t)for(var a=0;a<t.length;a++)if(t[a][i]==e&&t[a][n]==o)return t[a];return null},t.prototype.getWeaponProInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.CharacterNum,t,e,"level","CharacterID")},t.prototype.getParameterCfg=function(t){return this.data.GearParameterCfg[t].value},t.prototype.getEnemyInfo=function(t,e){return this.getCfgByPrimaryKey2(this.data.enemyCfg,t,e,"level","CharacterID")},t.prototype.getWpnCfg=function(t,e){return this.getCfgByPrimaryKey2(this.data.CharacterCfg,t,e,"CharacterID","grade")},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],TPVP_EffDie:[function(t,e,o){"use strict";cc._RF.push(e,"7e68a/FS+hIoYFUW2Pi7vwp","TPVP_EffDie");var i=t,n=e,a=o;cc._RF.push(n,"7e68a/FS+hIoYFUW2Pi7vwp","TPVP_EffDie");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("TPVP_Config"),p=i("TPVP_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAnim=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAnim.setCompleteListener(function(e){e.animation.name==l.TPVP_AnimName.animation&&p.default.getInstance().PushObj(t.node)})},c([h(sp.Skeleton)],e.prototype,"spAnim",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TPVP_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"7763debT4ZPj6uHkFxbHkHv","TPVP_GameData");var i=e,n=o;cc._RF.push(i,"7763debT4ZPj6uHkFxbHkHv","TPVP_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emTPVP_GameDataKeys=void 0,function(t){t.GearParameterCfg="GearParameterCfg",t.enemyCfg="enemyCfg",t.enemyID="enemyID",t.waveCfg="waveCfg",t.CharacterCfg="CharacterCfg",t.CharacterNum="CharacterNum"}(n.emTPVP_GameDataKeys||(n.emTPVP_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],TPVP_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"a8468VsTD5MWovWGS9MZ+VB","TPVP_GameEnumData");var i=e,n=o;cc._RF.push(i,"a8468VsTD5MWovWGS9MZ+VB","TPVP_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.TPVP_enumGearParameterCfg=void 0,function(t){t[t.StoreNum=1]="StoreNum",t[t.DamageBonus=2]="DamageBonus",t[t.ReduceInjuries=3]="ReduceInjuries",t[t.PunctureInjury=4]="PunctureInjury",t[t.ExpansionCost=5]="ExpansionCost",t[t.refreshCost=6]="refreshCost",t[t.StratGold=7]="StratGold",t[t.knivesAtkSpeed=8]="knivesAtkSpeed",t[t.LancerArkSpeed=9]="LancerArkSpeed",t[t.ShieldAtkSpeed=10]="ShieldAtkSpeed",t[t.KnivesSpeed=11]="KnivesSpeed",t[t.LancerSpeed=12]="LancerSpeed",t[t.ShieldSpeed=13]="ShieldSpeed",t[t.BaseHealthy=14]="BaseHealthy"}(n.TPVP_enumGearParameterCfg||(n.TPVP_enumGearParameterCfg={})),cc._RF.pop(),cc._RF.pop()},{}],TPVP_GameMgr:[function(t,e,o){"use strict";cc._RF.push(e,"2e636f9Q3FPAZYPQ9xznILy","TPVP_GameMgr");var i=t,n=e,a=o;cc._RF.push(n,"2e636f9Q3FPAZYPQ9xznILy","TPVP_GameMgr");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("UIMgr"),d=i("TPVP_Config"),h=i("TPVP_DataMgr"),f=i("TPVP_GameEnumData"),m=i("TPVP_HarmEff"),g=i("TPVP_PoolMgr"),y=i("TPVP_RoleBase"),v=i("TPVP_RoleEnemy"),_=i("TPVP_RoleFriend"),b=i("TPVP_TbeBoxBack"),B=i("TPVP_WeaponBase"),I=i("TPVP_WeaponBox"),P=i("TPVP_WeaponTbe"),C=i("TPVP_Common"),D=i("TPVP_Simulator"),T=cc._decorator,S=T.ccclass,A=T.property,k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameUI=null,e.btnGameUI=null,e.btnGameUIBG=null,e.tbeTopRoot=null,e.btnGoTurn=null,e.tbeTopLayer=null,e.tbeMidLayer=null,e.tbeBotLayer=null,e.tbeMidAnim=null,e.tbeTopAnim=null,e.weaponBoxSpare=null,e.tbeMoveRoot=null,e.lockBoxMask=null,e.roleBase=null,e.birthEnemyPos=null,e.goldRoot=null,e.txtGoldNum=null,e.mapMidPos=null,e.prepareRolePos=null,e.txtWaveLevel=null,e.btnLockBox=null,e.btnUpdateWpnBox=null,e.txtLockBox=null,e.txtUpdateWpnBox=null,e.rolePro=null,e.txtRoleHp=null,e.txtRoleAtkSpeed=null,e.txtRoleAtk=null,e.txtRoleSuck=null,e.txtRoleCritical=null,e.txtRoleBackHP=null,e.txtRoleBuffTips=null,e.tbeTopTbeBoxInfo={1:{angle:90,boxSp:null,weaponTbe:null},2:{angle:30,boxSp:null,weaponTbe:null},3:{angle:330,boxSp:null,weaponTbe:null},4:{angle:270,boxSp:null,weaponTbe:null},5:{angle:210,boxSp:null,weaponTbe:null},6:{angle:150,boxSp:null,weaponTbe:null}},e.tbeMidTbeBoxInfo={1:{angle:-270,boxSp:null,weaponTbe:null},2:{angle:-330,boxSp:null,weaponTbe:null},3:{angle:-30,boxSp:null,weaponTbe:null},4:{angle:-90,boxSp:null,weaponTbe:null},5:{angle:-150,boxSp:null,weaponTbe:null},6:{angle:-210,boxSp:null,weaponTbe:null}},e.tbeBotTbeBoxInfo={1:{angle:90,boxSp:null,weaponTbe:null},2:{angle:45,boxSp:null,weaponTbe:null},3:{angle:0,boxSp:null,weaponTbe:null},4:{angle:315,boxSp:null,weaponTbe:null},5:{angle:270,boxSp:null,weaponTbe:null},6:{angle:225,boxSp:null,weaponTbe:null},7:{angle:180,boxSp:null,weaponTbe:null},8:{angle:135,boxSp:null,weaponTbe:null}},e.gameState=d.TPVP_GameState.playing,e.isfight=!1,e.isPrepare=!0,e.weaponBoxSpareAll=[],e.weaponBoxGameAll=[],e.pitchBox=null,e.storeNum=3,e.boutSelectiveWpns=[],e.roleAllList=[],e.nowMaxWave=0,e.nowminWave=0,e.outWaveTime=0,e.waveInterval=0,e.isCanWave=!1,e.enemyTypeNum={},e.outEnemyInterval=.2,e.outEnemyTime=0,e.isWaveOver=!1,e.isWaveGameOver=!1,e.waveOverSumUI=0,e.waveOverNum=0,e.waveGoldNum=0,e.enemySpeeds=[],e.goldNum=0,e.unLockBoxGold=[],e.unLockBoxNum=0,e.wpnBoxSpareGold=10,e.initTbeBoxNum=0,e._frames=0,e.enemyNum=0,e.changeDirection=!1,e.startEasing="quadOut",e.endEasing="quadOut",e.elasticAngle=12,e.isBuffID=0,e.buffLevel=0,e.isUnLockTbeBoxState=!1,e.isInitRandoWpn=!0,e.createMoveBox=null,e.color_Green=cc.color().fromHEX("#08f61b"),e.color_Red=cc.color().fromHEX("#f85454"),e.lastGoldNum=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.Instance||(o.Instance=this)},e.prototype.start=function(){this.btnGoTurn.on(cc.Node.EventType.TOUCH_END,this.btnTurnTurntable,this),this.btnLockBox.on(cc.Node.EventType.TOUCH_END,this.unLockTbeBox,this),this.btnUpdateWpnBox.on(cc.Node.EventType.TOUCH_END,this.btnUpdateWeaponBoxSpare,this),this.initData(),this.updateWeaponBoxSpare(),this.initTbeBox(1,6),this.initTbeBox(2,6),this.initTbeBox(3,8),this.setGameState(d.TPVP_GameState.playing),D.TPVP_Simulator.instance.setAgentDefaults(40,5,1,.1,5,80,new C.TPVP_Vector2(0,0))},e.prototype.onDestroy=function(){t.prototype.destroy.call(this),o.Instance=null},e.prototype.initData=function(){this.waveCfg=h.default.getInstance().data.waveCfg,this.characterCfg=JSON.parse(JSON.stringify(h.default.getInstance().data.CharacterCfg)),this.storeNum=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.StoreNum),this.unLockBoxGold=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.ExpansionCost),this.wpnBoxSpareGold=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.refreshCost),this.goldNum=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.StratGold),this.enemySpeeds[0]=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.KnivesSpeed),this.enemySpeeds[1]=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.LancerSpeed),this.enemySpeeds[2]=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.ShieldSpeed),this.txtLockBox.string=""+this.unLockBoxGold[this.unLockBoxNum],this.txtUpdateWpnBox.string=""+this.wpnBoxSpareGold,this.txtGoldNum.string=""+this.goldNum},e.prototype.initTbeBox=function(t,e){var o,i=this,n=null,a=0;switch(t){case 1:n=this.tbeTopLayer,a=60,o=this.tbeTopTbeBoxInfo;break;case 2:n=this.tbeMidLayer,a=105,o=this.tbeMidTbeBoxInfo;break;case 3:n=this.tbeBotLayer,a=142,o=this.tbeBotTbeBoxInfo}var r="tbeBox/tbeBox"+t;this.loadPrefab(d.TPVP_BundleName.Prefabs,r,function(r){for(var s=0;s<e;s++){var c=cc.instantiate(r);c.setParent(n),c.active=!0;var l=c.getComponent(b.default);l.box.active=!1,1==t?l.setLock(s<e-3):l.setLock(s<e-2),o[s+1].boxSp=l}var p=n.children,u=p.length;for(s=0;s<u;s++){var h=p[s],f=360/u*s,m=cc.misc.degreesToRadians(f),g=a*Math.cos(m),y=a*Math.sin(m),v=cc.v3(g,y,0);h.setPosition(v),h.angle=f-90}if(3==t){i.tbeBotTbeBoxInfo[8].boxSp.setWpnState(!0);var _=i.tbeBotTbeBoxInfo[8].boxSp.node;i.loadPrefab(d.TPVP_BundleName.Prefabs,"weaponBox/tbeWeaponBox3",function(t){_.active=!0;var e=cc.instantiate(t);e.setParent(_),e.setPosition(cc.v2()),e.angle=0;var o=e.getComponent(P.default);o.init(-10,-1,-1,!0),i.tbeBotTbeBoxInfo[8].weaponTbe=o})}})},e.prototype.setGameState=function(t){this.gameState=t,this.sendEvent(d.TPVP_EventName.SetGameState,this.gameState)},e.prototype.btnTurnTurntable=function(){if(this.isUnLockTbeBoxState)this.upTipsBox("\u8bf7\u89e3\u9501\u5b8c\u683c\u5b50\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c");else if(null==this.pitchBox){var t=this.isUpTbeWpnNum(this.tbeTopTbeBoxInfo);t||(t=this.isUpTbeWpnNum(this.tbeMidTbeBoxInfo)),t||(t=this.isUpTbeWpnNum(this.tbeBotTbeBoxInfo)),t?this.isPrepare&&(p.AudioMgr.getInstance().playEffectFree(d.TPVP_AudioId.draw),this.isPrepare=!1,this.boutSelectiveWpns=[],this.turnTurntable(),this.playBtnGameUIAnim(!0),this.sendEvent(d.TPVP_EventName.PlayGame)):this.upTipsBox("\u8bf7\u5148\u653e\u7f6e\u6b66\u5668")}else this.upTipsBox("\u8bf7\u5148\u677e\u5f00\u683c\u5b50\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c")},e.prototype.playGame=function(){this.playGameUIAnim(!0),this.outCampFriend(),this.updateEnemyMaxWave(),this.isfight=!0},e.prototype.waveOver=function(){this.isPrepare=!0,this.isfight=!1;for(var t=0,e=this.characterCfg;t<e.length;t++){var o=e[t];o.weight+=o.weightUp}this.txtWaveLevel.string="\u7b2c"+(this.nowMaxWave+1)+"/20\u6ce2",this.sendEvent(d.TPVP_EventName.WaveOver),this.setGoldNum(this.waveGoldNum),this.playGameUIAnim(!1),this.playBtnGameUIAnim(!1),this.updateWeaponBoxSpare()},e.prototype.playGameUIAnim=function(t){var e=cc.v3(0,t?-180:0);cc.tween(this.gameUI).to(.2,{position:e}).start()},e.prototype.playBtnGameUIAnim=function(t){var e=cc.v3(0,t?-550:0),o=cc.v3(0,t?-550:0),i=cc.v3(0,t?-1174:-574);cc.tween(this.btnGameUI).to(.2,{position:e}).start(),cc.tween(this.btnGameUIBG).to(.2,{position:o}).start(),cc.tween(this.weaponBoxSpare).to(.2,{position:i}).start()},e.prototype.update=function(t){if(this.gameState!=d.TPVP_GameState.pause&&(this._frames++>6&&this.tierRoleLList(),this.isfight)){D.TPVP_Simulator.instance.run(t);for(var e=0,o=this.roleAllList;e<o.length;e++)o[e].getComponent(y.default).moveByRvo();if(!this.isWaveOver&&this.isCanWave)this.outWaveTime+=t,this.outWaveTime>this.waveInterval&&(this.nowminWave++,this.updateEnemyMinWave());else if(this.outEnemyTime+=t,this.outEnemyTime>this.outEnemyInterval){this.outEnemyTime=0;var i=Object.keys(this.enemyTypeNum);if(0===i.length)return void(this.isCanWave=!0);this.isCanWave=!1;var n=Number(i[Math.floor(Math.random()*i.length)]);this.enemyTypeNum[n],this.outEnemy(n),this.enemyTypeNum[n]-=1,0==this.enemyTypeNum[n]&&delete this.enemyTypeNum[n],0===Object.keys(this.enemyTypeNum).length?this.isCanWave=!0:this.isCanWave=!1}}},e.prototype.updateEnemyMaxWave=function(){this.enemyNum=0,this.nowMaxWave++,this.nowMaxMonsterInfo=[],this.waveOverNum=0,this.waveGoldNum=0;for(var t=0;t<this.waveCfg.length;t++)this.waveCfg[t].id==this.nowMaxWave&&(this.nowMaxMonsterInfo.push(this.waveCfg[t]),this.waveOverNum+=this.waveCfg[t].MonsterSum,this.waveGoldNum+=this.round(this.waveCfg[t].Gold),t==this.waveCfg.length-1&&(this.isWaveGameOver=!0));this.waveOverSumUI=this.waveOverNum,this.nowminWave=0,this.updateEnemyMinWave(),this.isWaveOver=!1},e.prototype.updateEnemyMinWave=function(){this.enemyTypeNum=[],this.outWaveTime=0,this.waveInterval=this.nowMaxMonsterInfo[this.nowminWave].FirstInterval;for(var t=this.nowMaxMonsterInfo[this.nowminWave].MonsterSum,e=0;e<this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++){var o=this.nowMaxMonsterInfo[this.nowminWave].Monster[e][0];this.enemyTypeNum[o]=1}for(e=0;e<t-this.nowMaxMonsterInfo[this.nowminWave].Monster.length;e++)this.addOutEnemyQueue(this.nowMaxMonsterInfo[this.nowminWave].Monster);this.nowminWave==this.nowMaxMonsterInfo.length-1&&(this.isWaveOver=!0),this.isCanWave=!1},e.prototype.addOutEnemyQueue=function(t){var e=this.random(0,t.length,!0),o=t[e][0];this.enemyTypeNum[o]==t[e][1]?this.addOutEnemyQueue(t):this.enemyTypeNum[o]+=1},e.prototype.outEnemy=function(t){var e=this;this.loadPrefab(d.TPVP_BundleName.Prefabs,"role/Enemy",function(o){var i=cc.instantiate(o);i.setParent(e.roleBase);var n=e.birthEnemyPos.position.clone();n.y+=e.random(-70,70);var a=e.enemySpeeds[t-1],r=e.getROVAgent(n,a);i.setPosition(n),i.getComponent(v.default).init(r,e.nowMaxWave,t,a),e.addRoleList(i)})},e.prototype.outCampFriend=function(){for(var t in this.boutSelectiveWpns){for(var e=this.boutSelectiveWpns[t],o=[],i=0,n=e.buffs;i<n.length;i++){var a=n[i],r={buffID:a.weaponTypeID,level:a.level};o.push(r)}for(var s=0;s<e.roleNum;s++)this.outFriend(o)}},e.prototype.outFriend=function(t){var e=this;this.loadPrefab(d.TPVP_BundleName.Prefabs,"role/Friend",function(o){var i=cc.instantiate(o);i.setParent(e.roleBase);var n=e.birthEnemyPos.position.clone();n.y+=e.random(-70,70);var a=e.getROVAgent(n,60);i.setPosition(n),i.getComponent(_.default).init(a,t,60),e.addRoleList(i),e.sortRoleFriendPos(!1)})},e.prototype.getROVAgent=function(t,e){var o=D.TPVP_Simulator.instance.addAgent(cc.v2(t.x,t.y),30,e,null,1);return D.TPVP_Simulator.instance.getAgentByAid(o).neighborDist=120,o},e.prototype.sortRoleFriendPos=function(t){for(var e=[],o=0,i=this.roleAllList;o<i.length;o++){var n=i[o];n.getComponent(y.default).campType==d.TPVP_CampType.Friend&&e.push(n)}for(var a=0,r=0,s=function(o){var i=c.prepareRolePos.position.clone();i.y-=o%3*70,i.x-=70*a;var n=e[o].getComponent(_.default);t?(cc.Tween.stopAllByTarget(e[o]),cc.tween(e[o]).to(.2,{position:i}).call(function(){n.setROVPosition()}).start()):(e[o].setPosition(i),n.setROVPosition()),++r>=3&&(r=0,a++)},c=this,l=0;l<e.length;l++)s(l);this.tierRoleLList()},e.prototype.addRoleList=function(t){this.roleAllList.push(t),this.tierRoleLList()},e.prototype.removeRoleLList=function(t){var e=this.roleAllList.indexOf(t);if(this.roleAllList.splice(e,1),t.getComponent(y.default).campType==d.TPVP_CampType.Enemy){for(var o=!0,i=0,n=this.roleAllList;i<n.length;i++)if(n[i].getComponent(y.default).campType==d.TPVP_CampType.Enemy){o=!1;break}this.waveOverNum--,this.waveOverNum<=0&&o&&(this.isWaveGameOver?(this.setGameState(d.TPVP_GameState.pause),u.UIMgr.getInstance().openUI(d.TPVP_UIID.TPVP_UIGameOver,1,!0)):(this.waveOver(),this.sortRoleFriendPos(!0)))}else{o=!0;for(var a=0,r=this.roleAllList;a<r.length;a++)if(r[a].getComponent(y.default).campType==d.TPVP_CampType.Friend){o=!1;break}o&&(p.AudioMgr.getInstance().playEffectFree(d.TPVP_AudioId.shibai),this.setGameState(d.TPVP_GameState.pause),u.UIMgr.getInstance().openUI(d.TPVP_UIID.TPVP_UIGameOver,1,!1))}},e.prototype.tierRoleLList=function(){var t=this.roleBase.children;t.sort(function(t,e){return e.y-t.y}),t.forEach(function(t,e){t.setSiblingIndex(e)})},e.prototype.findRoleNear=function(t){for(var e=t.node.convertToWorldSpaceAR(cc.v2(0,0)),o=null,i=Number.POSITIVE_INFINITY,n=0,a=this.roleAllList;n<a.length;n++){var r=a[n];if(r.active){var s=r.getComponent(y.default);if(s.campType!=t.campType&&!(r.position.x<-300||r.position.x>300)){var c=r.convertToWorldSpaceAR(cc.v2(0,0)),l=c.x-e.x,p=c.y-e.y,u=l*l+p*p;u<i&&(i=u,o=s)}}}return o},e.prototype.isUpTbeWpnNum=function(t){for(var e in t)if(null!=t[e].weaponTbe&&!t[e].weaponTbe.isTryAgain)return!0;return!1},e.prototype.turnTurntable=function(){var t=this;cc.tween(this.tbeMidAnim).to(1.75,{opacity:255}).to(1.75,{opacity:0}).start(),cc.tween(this.tbeTopAnim).to(1,{opacity:255}).to(1,{opacity:0}).start();var e=this.random(1,7,!0),o=this.tbeTopTbeBoxInfo[e].angle,i=o+=1440;i=i+(360-this.tbeTopLayer.angle%360)+this.tbeTopLayer.angle,cc.tween(this.tbeTopLayer).to(2,{angle:i+this.elasticAngle},{easing:this.startEasing}).to(.2,{angle:i},{easing:this.endEasing}).start();var n=this.random(1,7,!0),a=this.tbeMidTbeBoxInfo[n].angle,r=a+=-1800;r=r+-(360-Math.abs(this.tbeMidLayer.angle)%360)+this.tbeMidLayer.angle,cc.tween(this.tbeMidLayer).to(3.5,{angle:r-this.elasticAngle},{easing:this.startEasing}).to(.2,{angle:r},{easing:this.endEasing}).start();var s=this.random(1,9,!0),c=this.tbeBotTbeBoxInfo[s].angle,l=c+=2160;l=l+(360-this.tbeBotLayer.angle%360)+this.tbeBotLayer.angle,cc.tween(this.tbeBotLayer).to(5,{angle:l+this.elasticAngle},{easing:this.startEasing}).to(.2,{angle:l},{easing:this.endEasing}).call(function(){var o=!1;if(null!=t.tbeTopTbeBoxInfo[e].weaponTbe&&(o=!0,t.tbeTopTbeBoxInfo[e].weaponTbe.playWpnAnim()),null!=t.tbeMidTbeBoxInfo[n].weaponTbe&&(o=!0,t.tbeMidTbeBoxInfo[n].weaponTbe.playWpnAnim()),null!=t.tbeBotTbeBoxInfo[s].weaponTbe&&(o=!0,t.tbeBotTbeBoxInfo[s].weaponTbe.playWpnAnim()),null!=t.tbeBotTbeBoxInfo[s].weaponTbe&&!t.tbeBotTbeBoxInfo[s].weaponTbe.isTryAgain){var i=t.tbeBotTbeBoxInfo[s].weaponTbe;if(2001==i.weaponTypeID){var a=t.round(h.default.getInstance().getWeaponProInfo(i.level,i.weaponTypeID).Gold);t.setGoldNum(a)}}null!=t.tbeBotTbeBoxInfo[s].weaponTbe&&t.tbeBotTbeBoxInfo[s].weaponTbe.isTryAgain?setTimeout(function(){t.turnTurntable()},900):o?setTimeout(function(){t.playGame()},900):t.playGame(),p.AudioMgr.getInstance().playEffectFree(d.TPVP_AudioId.drawResult)}).start();var u={roleNum:1,buffs:[]};if(null!=this.tbeTopTbeBoxInfo[e].weaponTbe&&u.buffs.push(this.tbeTopTbeBoxInfo[e].weaponTbe),null!=this.tbeMidTbeBoxInfo[n].weaponTbe&&u.buffs.push(this.tbeMidTbeBoxInfo[n].weaponTbe),null!=this.tbeBotTbeBoxInfo[s].weaponTbe){var f=this.tbeBotTbeBoxInfo[s].weaponTbe;f.isTryAgain||901==f.weaponTypeID||2001==f.weaponTypeID?901==f.weaponTypeID&&(u.roleNum+=this.round(h.default.getInstance().getWeaponProInfo(f.level,f.weaponTypeID).Number)):u.buffs.push(f),this.isBuffID=f.weaponTypeID,this.buffLevel=f.level}this.boutSelectiveWpns.push(u)},e.prototype.showRolePro=function(t,e,o,i,n,a){var r=this;if(this.rolePro.active=!0,this.rolePro.opacity=0,cc.Tween.stopAllByTarget(this.rolePro),cc.tween(this.rolePro).to(.2,{opacity:255}).to(3,{}).to(.2,{opacity:0}).call(function(){r.rolePro.active=!1}).start(),this.txtRoleHp.string="\u8840\u91cf\uff1a"+this.round(t),this.txtRoleAtkSpeed.string="\u653b\u901f\uff1a"+this.round(100*e)/100+"s",this.txtRoleAtk.string="\u653b\u51fb\uff1a"+this.round(100*o)/100,this.txtRoleSuck.string="\u5438\u8840\uff1a"+this.round(100*i)+"%",this.txtRoleCritical.string="\u66b4\u51fb\uff1a"+this.round(100*n)+"%",this.txtRoleBackHP.string="\u56de\u590d\uff1a"+this.round(100*a)+"%",0!=this.isBuffID){var s="";switch(this.isBuffID){case 501:s="\u6700\u5927\u8840\u91cf+"+this.round(100*h.default.getInstance().getWeaponProInfo(this.buffLevel,this.isBuffID).HP)+"%";break;case 601:s="\u8840\u91cf\u56de\u590d+"+this.round(100*h.default.getInstance().getWeaponProInfo(this.buffLevel,this.isBuffID).HPBack)+"%";break;case 701:s="\u653b\u51fb\u529b+"+this.round(h.default.getInstance().getWeaponProInfo(this.buffLevel,this.isBuffID).Atk);break;case 801:s="\u653b\u51fb\u901f\u5ea6+"+this.round(100*h.default.getInstance().getWeaponProInfo(this.buffLevel,this.isBuffID).AtkSpeed)+"%";break;case 901:s="\u89d2\u8272\u6570\u91cf+"+this.round(h.default.getInstance().getWeaponProInfo(this.buffLevel,this.isBuffID).Number);break;case 1001:s="\u66b4\u51fb\u7387+"+this.round(100*h.default.getInstance().getWeaponProInfo(this.buffLevel,this.isBuffID).CriticPro)+"%";break;case 2001:s="\u83b7\u5f97"+this.round(h.default.getInstance().getWeaponProInfo(this.buffLevel,this.isBuffID).Gold)+"\u91d1\u5e01"}this.txtRoleBuffTips.node.parent.active=!0,this.txtRoleBuffTips.string=s}else this.txtRoleBuffTips.node.parent.active=!1},e.prototype.upTipsBuff=function(t,e){var o="";switch(t){case 501:o="\u6700\u5927\u8840\u91cf+"+this.round(100*h.default.getInstance().getWeaponProInfo(e,t).HP)+"%";break;case 601:o="\u8840\u91cf\u56de\u590d+"+this.round(100*h.default.getInstance().getWeaponProInfo(e,t).HPBack)+"%";break;case 701:o="\u653b\u51fb\u529b+"+this.round(h.default.getInstance().getWeaponProInfo(e,t).Atk);break;case 801:o="\u653b\u51fb\u901f\u5ea6+"+this.round(100*h.default.getInstance().getWeaponProInfo(e,t).AtkSpeed)+"%";break;case 901:o="\u89d2\u8272\u6570\u91cf+"+this.round(h.default.getInstance().getWeaponProInfo(e,t).Number);break;case 1001:o="\u66b4\u51fb\u7387+"+this.round(100*h.default.getInstance().getWeaponProInfo(e,t).CriticPro)+"%";break;case 2001:o="\u83b7\u5f97"+this.round(h.default.getInstance().getWeaponProInfo(e,t).Gold)+"\u91d1\u5e01"}this.upTipsBox(o)},e.prototype.lockBoxTbeNum=function(t){var e=0;for(var o in t)t[o].boxSp.isLock&&e++;return e},e.prototype.setBoxTbLlockState=function(t,e){var o=!1;for(var i in t)t[i].boxSp.isLock&&(e?t[i].boxSp.setLockState(!1):(o?t[i].boxSp.setLockState(!1):t[i].boxSp.setLockState(!0),o=!0))},e.prototype.getLockBoxGoldNum=function(){return this.unLockBoxGold[this.unLockBoxNum]},e.prototype.isGoldYesLockBox=function(){return this.goldNum-this.unLockBoxGold[this.unLockBoxNum]>=0},e.prototype.onUnLockTbeBox=function(){this.setGoldNum(-this.unLockBoxGold[this.unLockBoxNum]),this.unLockBoxNum++},e.prototype.thatBoxLockTbe=function(){var t=this.lockBoxTbeNum(this.tbeTopTbeBoxInfo),e=this.lockBoxTbeNum(this.tbeMidTbeBoxInfo),o=this.lockBoxTbeNum(this.tbeBotTbeBoxInfo)-2;this.setBoxTbLlockState(this.tbeTopTbeBoxInfo,!1),this.setBoxTbLlockState(this.tbeMidTbeBoxInfo,t>=e),0==e?this.setBoxTbLlockState(this.tbeBotTbeBoxInfo,!1):this.setBoxTbLlockState(this.tbeBotTbeBoxInfo,e>=o)},e.prototype.unLockTbeBox=function(){null==this.pitchBox?this.goldNum-this.unLockBoxGold[this.unLockBoxNum]>=0?this.isPrepare&&(this.setGoldNum(-this.unLockBoxGold[this.unLockBoxNum]),this.isUnLockTbeBoxState=!0,this.lockBoxMask.active=!0,this.sendEvent(d.TPVP_EventName.UnLockTbeBox,!0),this.tbeMoveRoot.setSiblingIndex(this.tbeMoveRoot.parent.childrenCount-1)):this.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"):this.upTipsBox("\u8bf7\u5148\u677e\u5f00\u683c\u5b50\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c")},e.prototype.closeUnLockTbeBox=function(){this.thatBoxLockTbe(),this.unLockBoxNum++,this.txtLockBox.string=""+this.unLockBoxGold[this.unLockBoxNum],this.tbeMoveRoot.setSiblingIndex(3),this.lockBoxMask.active=!1,this.isUnLockTbeBoxState=!1;var t=!0;for(var e in this.tbeTopTbeBoxInfo){var o=Number(e);if(this.tbeTopTbeBoxInfo[o].boxSp.isLock){t=!1;break}}if(t)for(var e in this.tbeMidTbeBoxInfo)if(o=Number(e),this.tbeMidTbeBoxInfo[o].boxSp.isLock){t=!1;break}if(t)for(var e in this.tbeBotTbeBoxInfo)if(o=Number(e),this.tbeBotTbeBoxInfo[o].boxSp.isLock){t=!1;break}t&&(this.btnLockBox.active=!1)},e.prototype.btnUpdateWeaponBoxSpare=function(){null==this.pitchBox?this.goldNum-this.wpnBoxSpareGold>=0?this.isPrepare&&(this.setGoldNum(-this.wpnBoxSpareGold),this.updateWeaponBoxSpare()):this.upTipsBox("\u91d1\u5e01\u4e0d\u8db3"):this.upTipsBox("\u8bf7\u5148\u677e\u5f00\u683c\u5b50\uff0c\u518d\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c")},e.prototype.updateWeaponBoxSpare=function(){for(var t=this,e=0,o=this.weaponBoxSpareAll;e<o.length;e++)o[e].getComponent(B.default).die();this.weaponBoxSpare.removeAllChildren(),this.weaponBoxSpareAll=[];for(var i=0,n=this.isInitRandoWpn?this.initRandomWeaponBox():this.randomWeaponBox(this.storeNum),a=function(e){var o="weaponBox/weaponBox"+d.TPVP_RoleAsePath[e.CharacterID].layerType;r.loadPrefab(d.TPVP_BundleName.Prefabs,o,function(o){var n=cc.instantiate(o);n.setParent(t.weaponBoxSpare),n.getComponent(I.default).init(e.CharacterID,e.grade),t.weaponBoxSpareAll.push(n),t.addWeaponBox(n),++i==t.storeNum&&t.calculateLayout(-1,!0)})},r=this,s=0,c=n;s<c.length;s++)a(c[s]);this.isInitRandoWpn=!1},e.prototype.randomWeaponBox=function(t){for(var e=this.characterCfg.filter(function(t){return t.weight>0}),o=[],i=[],n=0,a=0,r=e;a<r.length;a++)n+=r[a].weight,i.push(n);for(var s=n,c=0;c<t;c++)for(var l=Math.random()*s,p=0;p<i.length;p++)if(l<i[p]){o.push(e[p]);break}return o},e.prototype.initRandomWeaponBox=function(){var t=[],e=[101,201,301],o=[401,3001,4001],i=[501,601,701,801,1001,2001],n=e[this.random(0,e.length,!0)],a=this.random(0,1)>.82?2:1;t.push(h.default.getInstance().getWpnCfg(n,a));var r=o[this.random(0,o.length,!0)],s=this.random(0,1)>.82?2:1;t.push(h.default.getInstance().getWpnCfg(r,s));var c=i[this.random(0,i.length,!0)],l=this.random(0,1)>.82?2:1;return t.push(h.default.getInstance().getWpnCfg(c,l)),t},e.prototype.createWeaponBox=function(t,e){var o=this,i="weaponBox/weaponBox"+e.layerType,n=e.moveBoxPos.convertToWorldSpaceAR(cc.v2());this.loadPrefab(d.TPVP_BundleName.Prefabs,i,function(i){switch(e.layerType){case 1:o.tbeTopTbeBoxInfo[e.tbeBoxKey].boxSp.setWpnState(!1),o.tbeTopTbeBoxInfo[e.tbeBoxKey].weaponTbe=null;break;case 2:o.tbeMidTbeBoxInfo[e.tbeBoxKey].boxSp.setWpnState(!1),o.tbeMidTbeBoxInfo[e.tbeBoxKey].weaponTbe=null;break;case 3:o.tbeBotTbeBoxInfo[e.tbeBoxKey].boxSp.setWpnState(!1),o.tbeBotTbeBoxInfo[e.tbeBoxKey].weaponTbe=null}var a=cc.instantiate(i);a.setParent(o.tbeTopRoot);var r=a.parent.convertToNodeSpaceAR(n);a.setPosition(r),o.createMoveBox=a.getComponent(I.default),o.createMoveBox.init(e.weaponTypeID,e.level),o.createMoveBox.onTouchStart(t),o.addWeaponBox(a)})},e.prototype.addWeaponBox=function(t){var e=t.getComponent(B.default);this.weaponBoxGameAll.push(e),this.sendEvent(d.TPVP_EventName.UpdateAllBoxAccord,this.weaponBoxGameAll)},e.prototype.removeWeaponBox=function(t){var e=t.getComponent(B.default);if(this.weaponBoxGameAll.includes(e)){var o=this.weaponBoxGameAll.indexOf(e);this.weaponBoxGameAll.splice(o,1),this.sendEvent(d.TPVP_EventName.UpdateAllBoxAccord,this.weaponBoxGameAll)}},e.prototype.recoverTbeBox=function(t){for(var e in t)null==t[e].weaponTbe?(t[e].boxSp.box.color=cc.Color.WHITE,t[e].boxSp.setBox(!1)):t[e].weaponTbe.tbeBox.node.active=!0},e.prototype.moveWeaponBox=function(t,e){if(t!=d.TPVP_MoveRoleState.TouchStart){this.recoverTbeBox(this.tbeTopTbeBoxInfo),this.recoverTbeBox(this.tbeMidTbeBoxInfo),this.recoverTbeBox(this.tbeBotTbeBoxInfo);var o=this.getWorldPosV2(e.node),i=cc.Vec2.distance(o,this.getWorldPosV2(this.tbeTopLayer)),n=0;i<=130?n=1:i>125&&i<=215?n=2:i>215&&i<=310&&(n=3);var a=null,r=0,s=!1;if(0!=n){switch(n){case 1:a=this.findMinDist(o,this.tbeTopTbeBoxInfo);break;case 2:a=this.findMinDist(o,this.tbeMidTbeBoxInfo);break;case 3:a=this.findMinDist(o,this.tbeBotTbeBoxInfo)}if(a.tbeBoxs[a.key].boxSp.setBox(!0),n!=e.layerType?r=1:a.tbeBoxs[a.key].boxSp.isLock&&(r=2),(s=n==e.layerType&&!a.tbeBoxs[a.key].boxSp.isLock)&&null!=a.tbeBoxs[a.key].weaponTbe&&a.tbeBoxs[a.key].weaponTbe.isTryAgain&&(s=!1),null!=a.tbeBoxs[a.key].weaponTbe&&(a.tbeBoxs[a.key].weaponTbe.tbeBox.node.active=!1),s)if(null!=a.tbeBoxs[a.key].weaponTbe){var c=a.tbeBoxs[a.key].weaponTbe;c.weaponTypeID==e.weaponTypeID&&c.level==e.level&&c.level<5?a.tbeBoxs[a.key].boxSp.box.color=cc.Color.GREEN:a.tbeBoxs[a.key].boxSp.box.color=cc.Color.RED}else a.tbeBoxs[a.key].boxSp.box.color=cc.Color.GREEN;else a.tbeBoxs[a.key].boxSp.box.color=cc.Color.GRAY}if(t==d.TPVP_MoveRoleState.TouchEnd){if(this.sendEvent(d.TPVP_EventName.MoveBoxTips,-1),1==r)switch(e.layerType){case 1:this.upTipsBox("\u6b66\u5668\u53ea\u80fd\u653e\u7f6e\u5728\u4e0a\u5c42\u8f6c\u76d8");break;case 2:this.upTipsBox("\u88c5\u5907\u53ea\u80fd\u653e\u7f6e\u5728\u4e2d\u95f4\u5c42\u8f6c\u76d8");break;case 3:this.upTipsBox("buff\u53ea\u80fd\u653e\u7f6e\u5728\u5e95\u5c42\u8f6c\u76d8")}else 2==r&&this.upTipsBox("\u683c\u5b50\u672a\u89e3\u9501");null!=a?(null==a.tbeBoxs[a.key].weaponTbe?(a.tbeBoxs[a.key].boxSp.box.color=cc.Color.WHITE,a.tbeBoxs[a.key].boxSp.setBox(!1)):a.tbeBoxs[a.key].weaponTbe.tbeBox.node.active=!0,this.endWeaponBox(e,s,a.tbeBoxs,a.key)):this.endWeaponBox(e,s)}}else{if(this.setParentPos(e.node,this.tbeTopRoot),this.weaponBoxSpareAll.includes(e.node)){var l=this.weaponBoxSpareAll.indexOf(e.node);this.weaponBoxSpareAll.splice(l,1),this.calculateLayout()}this.sendEvent(d.TPVP_EventName.MoveBoxTips,e.layerType)}},e.prototype.findMinDist=function(t,e){var o={key:0,tbeBoxs:e},i=Number.MAX_SAFE_INTEGER;for(var n in e){var a=Number(n);e[a].boxSp.box.color=cc.Color.WHITE;var r=cc.Vec2.distance(t,this.getWorldPosV2(e[a].boxSp.node));r<i&&(i=r,o.key=a)}return o},e.prototype.endWeaponBox=function(t,e,o,i){var n=this;if(void 0===o&&(o=null),void 0===i&&(i=0),e){var a=function(){p.AudioMgr.getInstance().playEffectFree(d.TPVP_AudioId.fangrugezi);var e="weaponBox/tbeWeaponBox"+t.layerType;o[i].boxSp.setWpnState(!0);var a=o[i].boxSp.node;n.loadPrefab(d.TPVP_BundleName.Prefabs,e,function(e){a.active=!0;var r=cc.instantiate(e);r.setParent(a),r.setPosition(cc.v2()),r.angle=0;var s=r.getComponent(P.default);s.init(i,t.weaponTypeID,t.level),o[i].weaponTbe=s,t.die(),n.addWeaponBox(r)})};if(null==o[i].weaponTbe)a();else{var r=o[i].weaponTbe;if((y=r.weaponTypeID==t.weaponTypeID&&r.level==t.level&&r.level<5)&&(901==r.weaponTypeID&&(y=r.level<4),y||this.upTipsBox("\u8be5buff\u5df2\u8fbe\u6700\u5927\u7b49\u7ea7")),y)r.upLevel(),t.die();else{var s="weaponBox/weaponBox"+r.layerType,c=r.moveBoxPos.convertToWorldSpaceAR(cc.v2()),l=this.getWorldPosV2(t.node),u=this.getWorldPosV2(r.moveBoxPos).x<l.x;this.loadPrefab(d.TPVP_BundleName.Prefabs,s,function(t){var e=cc.instantiate(t);e.setParent(n.tbeTopRoot);var o=e.parent.convertToNodeSpaceAR(c);e.setPosition(o);var i=e.getComponent(I.default);i.init(r.weaponTypeID,r.level);var a=e.width/r.layerType;u&&(a=-a);var s=cc.v3(e.x+a,e.y);switch(cc.tween(e).to(.15,{position:s}).call(function(){n.insertRoleBoxSpare(i)}).start(),r.layerType){case 1:n.tbeTopTbeBoxInfo[r.tbeBoxKey].weaponTbe.die(),n.tbeTopTbeBoxInfo[r.tbeBoxKey].weaponTbe=null;break;case 2:n.tbeMidTbeBoxInfo[r.tbeBoxKey].weaponTbe.die(),n.tbeMidTbeBoxInfo[r.tbeBoxKey].weaponTbe=null;break;case 3:n.tbeBotTbeBoxInfo[r.tbeBoxKey].weaponTbe.die(),n.tbeBotTbeBoxInfo[r.tbeBoxKey].weaponTbe=null}n.addWeaponBox(e)}),a()}}}else{for(var h=this.getWorldPosV2(t.node),f=0,m=this.weaponBoxSpareAll;f<m.length;f++){var g=m[f];if(cc.Vec2.distance(h,this.getWorldPosV2(g))<50){var y,v=g.getComponent(I.default);if((y=v.weaponTypeID==t.weaponTypeID&&v.level==t.level&&v.level<5)&&(901==v.weaponTypeID&&(y=v.level<4),y||this.upTipsBox("\u8be5buff\u5df2\u8fbe\u6700\u5927\u7b49\u7ea7")),y)return v.upLevel(),void t.die()}}this.insertRoleBoxSpare(t)}},e.prototype.insertRoleBoxSpare=function(t){this.setParentPos(t.node,this.weaponBoxSpare);var e=this.findPosIndex(t.node);e<this.weaponBoxSpare.childrenCount&&this.weaponBoxSpare.insertChild(t.node,e),e>this.weaponBoxSpareAll.length?this.weaponBoxSpareAll.push(t.node):this.weaponBoxSpareAll.splice(e,0,t.node),this.calculateLayout(e)},e.prototype.findPosIndex=function(t){if(0==this.weaponBoxSpareAll.length)return 0;for(var e=0,o=Number.MAX_SAFE_INTEGER,i=this.getWorldPosV2(t),n=0;n<this.weaponBoxSpareAll.length;n++){var a=cc.Vec2.distance(i,this.getWorldPosV2(this.weaponBoxSpareAll[n]));a<o&&(o=a,e=n)}return this.getWorldPosV2(this.weaponBoxSpareAll[e]).x>i.x?e:e+1},e.prototype.calculateLayout=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=this.weaponBoxSpareAll;if(!(o.length<1)){var i=this.weaponBoxSpare.width-20,n=o.reduce(function(t,e){return t+e.width},0),a=[];if(n<=i)for(var r=-i/2+(p=(i-n)/(o.length+1)),s=0,c=o;s<c.length;s++){var l=c[s];a.push(cc.v3(r+l.width/2,0)),r+=l.width+p}else for(var p=(i-n)/(o.length-1),u=(r=-i/2,0),d=o;u<d.length;u++)l=d[u],a.push(cc.v3(r+l.width/2,0)),r+=l.width+p;for(var h=0;h<o.length;h++){var f=h,m=o[f];cc.Tween.stopAllByTarget(m),t==f||e?cc.tween(m).to(.2,{position:a[f],angle:this.random(0,1)>.5?10:-10},{easing:"quadOut"}).start():cc.tween(m).to(.2,{position:a[f]},{easing:"quadOut"}).start()}}},e.prototype.setGoldNum=function(t){var e=this;this.goldNum+=t,this.txtGoldNum.node.color=this.goldNum>this.lastGoldNum?this.color_Green:this.color_Red,this.txtGoldNum.string=""+this.goldNum,cc.Tween.stopAllByTarget(this.goldRoot),cc.tween(this.goldRoot).to(.1,{scale:1.3}).to(.1,{scale:1}).call(function(){e.txtGoldNum.node.color=cc.Color.WHITE}).start(),this.lastGoldNum=this.goldNum},e.prototype.playUnLockBoxEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));g.default.getInstance().getObj("effAnim/unLockBoxEff",function(t){t.setParent(e.tbeTopRoot);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playWpnBoxUpLevelEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));g.default.getInstance().getObj("effAnim/wpnBoxUpLevelEff",function(t){t.setParent(e.tbeTopRoot);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playRoleDieEff=function(t){var e=this,o=t.convertToWorldSpaceAR(cc.v2(0,0));g.default.getInstance().getObj("effAnim/roleDieEff",function(t){t.setParent(e.tbeTopRoot);var i=t.parent.convertToNodeSpaceAR(o);t.setPosition(i)})},e.prototype.playHarmEff=function(t,e,o,i){var n=this,a=t.convertToWorldSpaceAR(cc.v2(0,0));g.default.getInstance().getObj("effAnim/harmEff",function(t){t.setParent(n.tbeTopRoot);var r=t.parent.convertToNodeSpaceAR(a);r.y+=220,t.setPosition(r),t.getComponent(m.default).init(e,o,i)})},e.prototype.upTipsBox=function(t){this.sendEvent(d.TPVP_EventName.UpTipsBox,t)},e.prototype.getWorldPosV2=function(t){return t.parent.convertToWorldSpaceAR(t.getPosition())},e.prototype.getWorldPosV3=function(t){return t.parent.convertToWorldSpaceAR(t.position)},e.prototype.setParentPos=function(t,e){var o=this.getWorldPosV3(t);t.setParent(e);var i=e.convertToNodeSpaceAR(o);t.setPosition(i)},e.prototype.random=function(t,e,o){void 0===o&&(o=!1);var i=Math.random()*(e-t)+t;return o?Math.floor(i):i},e.prototype.round=function(t){return Math.round(t)},e.Instance=null,c([A(cc.Node)],e.prototype,"gameUI",void 0),c([A(cc.Node)],e.prototype,"btnGameUI",void 0),c([A(cc.Node)],e.prototype,"btnGameUIBG",void 0),c([A(cc.Node)],e.prototype,"tbeTopRoot",void 0),c([A(cc.Node)],e.prototype,"btnGoTurn",void 0),c([A(cc.Node)],e.prototype,"tbeTopLayer",void 0),c([A(cc.Node)],e.prototype,"tbeMidLayer",void 0),c([A(cc.Node)],e.prototype,"tbeBotLayer",void 0),c([A(cc.Node)],e.prototype,"tbeMidAnim",void 0),c([A(cc.Node)],e.prototype,"tbeTopAnim",void 0),c([A(cc.Node)],e.prototype,"weaponBoxSpare",void 0),c([A(cc.Node)],e.prototype,"tbeMoveRoot",void 0),c([A(cc.Node)],e.prototype,"lockBoxMask",void 0),c([A(cc.Node)],e.prototype,"roleBase",void 0),c([A(cc.Node)],e.prototype,"birthEnemyPos",void 0),c([A(cc.Node)],e.prototype,"goldRoot",void 0),c([A(cc.Label)],e.prototype,"txtGoldNum",void 0),c([A(cc.Node)],e.prototype,"mapMidPos",void 0),c([A(cc.Node)],e.prototype,"prepareRolePos",void 0),c([A(cc.Label)],e.prototype,"txtWaveLevel",void 0),c([A(cc.Node)],e.prototype,"btnLockBox",void 0),c([A(cc.Node)],e.prototype,"btnUpdateWpnBox",void 0),c([A(cc.Label)],e.prototype,"txtLockBox",void 0),c([A(cc.Label)],e.prototype,"txtUpdateWpnBox",void 0),c([A(cc.Node)],e.prototype,"rolePro",void 0),c([A(cc.Label)],e.prototype,"txtRoleHp",void 0),c([A(cc.Label)],e.prototype,"txtRoleAtkSpeed",void 0),c([A(cc.Label)],e.prototype,"txtRoleAtk",void 0),c([A(cc.Label)],e.prototype,"txtRoleSuck",void 0),c([A(cc.Label)],e.prototype,"txtRoleCritical",void 0),c([A(cc.Label)],e.prototype,"txtRoleBackHP",void 0),c([A(cc.Label)],e.prototype,"txtRoleBuffTips",void 0),o=c([S],e)}(l.default);a.default=k,cc._RF.pop(),cc._RF.pop()},{}],TPVP_HarmEff:[function(t,e,o){"use strict";cc._RF.push(e,"8cd31MO6RBKeqoqfqNawqyW","TPVP_HarmEff");var i=t,n=e,a=o;cc._RF.push(n,"8cd31MO6RBKeqoqfqNawqyW","TPVP_HarmEff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TPVP_PoolMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconCritical=null,e.txtHarm=null,e}return s(e,t),e.prototype.init=function(t,e,o){var i=this;this.iconCritical.active=e,this.node.opacity=255,o?(this.txtHarm.node.color=cc.Color.GREEN,this.txtHarm.string="+"+t):(this.txtHarm.node.color=cc.Color.RED,this.txtHarm.string="-"+t);var n=this.node.position.clone();n.y+=40,cc.tween(this.node).to(.2,{position:n}).call(function(){n.y+=40}).to(.2,{position:n,opacity:0}).call(function(){i.die()}).start()},e.prototype.die=function(){p.default.getInstance().PushObj(this.node)},c([h(cc.Node)],e.prototype,"iconCritical",void 0),c([h(cc.Label)],e.prototype,"txtHarm",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TPVP_PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"aed853FmrxOoIVNiyW0BohY","TPVP_PoolMgr");var i=t,n=e,a=o;cc._RF.push(n,"aed853FmrxOoIVNiyW0BohY","TPVP_PoolMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("ResourceMgr"),c=i("TPVP_Config"),l=cc._decorator.ccclass,p=function(){function t(){this.poolMap={},this.poolRoot=null;var t=new cc.Node("poolRoot"),e=cc.find("uiRoot");t.setParent(e),e.insertChild(t,0),this.poolRoot=t}var e;return e=t,t.getInstance=function(){return this.instance||(this.instance=new e),this.instance},t.prototype.getObj=function(t,e){var o=t.replace(/\//g,"_");this.poolMap[o]&&this.poolMap[o].poolList.length>0?e(this.poolMap[o].getObj()):s.ResourceMgr.getInstance().loadRes(c.TPVP_BundleName.Prefabs,t,cc.Prefab,function(t){var i=cc.instantiate(t);i.name=o,e(i)})},t.prototype.PushObj=function(t){var e=t.name;if(this.poolMap[e])this.poolMap[e].pushObj(t);else{var o=new u(t,this.poolRoot);this.poolMap[e]=o}},t.prototype.clear=function(){this.poolMap={},this.poolRoot.removeAllChildren()},e=r([l],t)}();a.default=p;var u=function(){function t(t,e){this.fatherObj=null,this.poolList=[],this.fatherObj=new cc.Node(t.name),this.fatherObj.setParent(e),this.pushObj(t)}return t.prototype.pushObj=function(t){t.active=!1,t.setParent(this.fatherObj),this.poolList.push(t)},t.prototype.getObj=function(){var t=this.poolList.shift();return t.active=!0,t},t}();cc._RF.pop(),cc._RF.pop()},{}],TPVP_RoleBaseV2:[function(t,e,o){"use strict";cc._RF.push(e,"033792agEZJyruiqhHkv8gF","TPVP_RoleBaseV2");var i,n=t,a=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.TPVP_RoleState=void 0;var c,l=n("BaseCtrl"),p=n("AudioMgr"),u=n("TPVP_Config"),d=n("TPVP_DataMgr"),h=n("TPVP_GameEnumData"),f=n("TPVP_GameMgr"),m=n("TPVP_Common"),g=n("TPVP_Simulator"),y=cc._decorator,v=y.ccclass,_=y.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.idie=2]="idie"}(c=a.TPVP_RoleState||(a.TPVP_RoleState={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rvoAgentId=-1,e.campType=u.TPVP_CampType.Friend,e.spAnim=null,e.boxCol=null,e.hpBar=null,e.attackAnimName="",e.typeID=0,e.moveSpeed=0,e.isDie=!1,e.roleState=c.idie,e.atkInterval=1.2,e.atkTime=0,e.atkForce=0,e.isAtkCooling=!0,e.clipDuration=null,e.atkAnimTimeSpeed=1,e.atkTarget=null,e.moveTarget=cc.Vec2.ZERO,e.atkTargetisCol=!1,e.maxHp=0,e.nowHp=0,e.damageBonus=0,e.punctureInjury=0,e.reduceInjuries=0,e._frames=0,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.isAtkCooling=!0,this.spAnim.setCompleteListener(function(e){e.animation.name==t.attackAnimName&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.isAtkCooling=!0,t.roleState=c.idie,t.spAnim.setAnimation(0,u.TPVP_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==u.TPVP_AnimName.attack&&t.attack()}),this.damageBonus=d.default.getInstance().getParameterCfg(h.TPVP_enumGearParameterCfg.DamageBonus),this.punctureInjury=d.default.getInstance().getParameterCfg(h.TPVP_enumGearParameterCfg.PunctureInjury),this.reduceInjuries=d.default.getInstance().getParameterCfg(h.TPVP_enumGearParameterCfg.ReduceInjuries),this.addEvent(u.TPVP_EventName.SetGameState,this.setGameState),this.spAnim.setAnimation(0,u.TPVP_AnimName.idle,!0)},e.prototype.update=function(t){if(f.default.Instance.gameState!=u.TPVP_GameState.pause&&f.default.Instance.isfight&&!this.isDie){if(this.roleState!=c.attack){var e=f.default.Instance.findRoleNear(this);if(null!=e){this.atkTarget=e,this.moveTarget=e.node.getPosition();var o=this.boxCol.getBoundingBoxToWorld(),i=e.boxCol.getBoundingBoxToWorld();cc.Intersection.rectRect(o,i)?this.roleState==c.move&&(this.atkTime=.65*this.atkInterval,this.roleState=c.idie,this.moveTarget=this.node.getPosition(),this.spAnim.timeScale=1,this.spAnim.setAnimation(0,u.TPVP_AnimName.idle,!0),g.TPVP_Simulator.instance.setMaxSpeed(this.rvoAgentId,0)):this.roleState==c.idie&&(this.roleState=c.move,this.spAnim.timeScale=1,this.spAnim.setAnimation(0,u.TPVP_AnimName.move,!0),g.TPVP_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed))}else this.atkTarget=null,this.moveTarget=f.default.Instance.mapMidPos.getPosition(),this.roleState==c.idie&&(this.roleState=c.move,this.spAnim.timeScale=1,this.spAnim.setAnimation(0,u.TPVP_AnimName.move,!0),g.TPVP_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed))}this._frames++>8&&(this._frames=0,this.setRovMove()),this.roleState!=c.move&&(this.atkTime+=t,this.atkTime>this.atkInterval&&null!=this.atkTarget&&null!=this.atkTarget.node&&this.atkTarget.node.active&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.roleState=c.attack,this.spAnim.setAnimation(0,this.attackAnimName,!1),p.AudioMgr.getInstance().playEffectFree(u.TPVP_AudioId.gongji)))}},e.prototype.setRovMove=function(){if(!(this.rvoAgentId<0)){var t=g.TPVP_Simulator.instance.getAgentByAid(this.rvoAgentId),e=g.TPVP_Simulator.instance.getAgentPosition(this.rvoAgentId),o=this.moveTarget;if(t&&e){var i=o.subtract(cc.v2(e.x,e.y));i.lengthSqr()>1&&(i=i.normalize().multiplyScalar(t.maxSpeed_));var n=t.velocity_,a=new cc.Vec2(.8*n.x+.2*i.x,.8*n.y+.2*i.y);a.lengthSqr()<m.TPVP_RVOMath.RVO_EPSILON?g.TPVP_Simulator.instance.setAgentPrefVelocity(this.rvoAgentId,cc.Vec2.ZERO):g.TPVP_Simulator.instance.setAgentPrefVelocity(this.rvoAgentId,a),i.x>0?this.node.setScale(1,1):i.x<0&&this.node.setScale(-1,1)}}},e.prototype.moveByRvo=function(){var t=g.TPVP_Simulator.instance.getAgentPosition(this.rvoAgentId);t.y<50&&(t.y=50),t.y>370&&(t.y=370),this.node.setPosition(t.x,t.y)},e.prototype.attack=function(){},e.prototype.attackEd=function(t,e){p.AudioMgr.getInstance().playEffectFree(u.TPVP_AudioId.dragonHit),f.default.Instance.playHarmEff(this.node,t,e,!1),cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.15,{color:cc.Color.WHITE}).start(),this.updeteHpBar()},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.setGameState=function(t){switch(t){case u.TPVP_GameState.pause:this.spAnim.paused=!0;break;case u.TPVP_GameState.playing:this.spAnim.paused=!1}},e.prototype.setSpAnimPlaySpeed=function(){var t=this.spAnim.findAnimation(this.attackAnimName);this.clipDuration=t.duration,this.atkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.atkInterval*1.05)},e.prototype.die=function(){p.AudioMgr.getInstance().playEffectFree(u.TPVP_AudioId.siwang),f.default.Instance.playRoleDieEff(this.node),f.default.Instance.removeRoleLList(this.node),g.TPVP_Simulator.instance.removeAgent(this.rvoAgentId),this.node.destroy()},e.prototype.round=function(t){return Math.round(t)},s([_({type:cc.Enum(u.TPVP_CampType)})],e.prototype,"campType",void 0),s([_(sp.Skeleton)],e.prototype,"spAnim",void 0),s([_(cc.Node)],e.prototype,"boxCol",void 0),s([_(cc.ProgressBar)],e.prototype,"hpBar",void 0),s([v],e)}(l.default);a.default=b,cc._RF.pop()},{}],TPVP_RoleBase:[function(t,e,o){"use strict";cc._RF.push(e,"1ecdbkxfsRFf5ui3CN/oY/t","TPVP_RoleBase");var i=t,n=e,a=o;cc._RF.push(n,"1ecdbkxfsRFf5ui3CN/oY/t","TPVP_RoleBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.TPVP_RoleState=void 0;var l,p=i("BaseCtrl"),u=i("AudioMgr"),d=i("TPVP_Config"),h=i("TPVP_DataMgr"),f=i("TPVP_GameEnumData"),m=i("TPVP_GameMgr"),g=i("TPVP_Common"),y=i("TPVP_Simulator"),v=cc._decorator,_=v.ccclass,b=v.property;!function(t){t[t.move=0]="move",t[t.attack=1]="attack",t[t.idie=2]="idie"}(l=a.TPVP_RoleState||(a.TPVP_RoleState={}));var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rvoAgentId=-1,e.campType=d.TPVP_CampType.Friend,e.spAnim=null,e.boxCol=null,e.hpBar=null,e.attackAnimName="",e.typeID=0,e.moveSpeed=0,e.isDie=!1,e.roleState=l.idie,e.atkInterval=1.2,e.atkTime=0,e.atkForce=0,e.isAtkCooling=!0,e.clipDuration=null,e.atkAnimTimeSpeed=1,e.atkTarget=null,e.moveTarget=cc.Vec2.ZERO,e.atkTargetisCol=!1,e.maxHp=0,e.nowHp=0,e.damageBonus=0,e.punctureInjury=0,e.reduceInjuries=0,e._frames=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.isAtkCooling=!0,this.spAnim.setCompleteListener(function(e){e.animation.name==t.attackAnimName&&(1!=t.spAnim.timeScale&&(t.spAnim.timeScale=1),t.isAtkCooling=!0,t.roleState=l.idie,t.spAnim.setAnimation(0,d.TPVP_AnimName.idle,!0))}),this.spAnim.setEventListener(function(e,o){o.data.name==d.TPVP_AnimName.attack&&t.attack()}),this.damageBonus=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.DamageBonus),this.punctureInjury=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.PunctureInjury),this.reduceInjuries=h.default.getInstance().getParameterCfg(f.TPVP_enumGearParameterCfg.ReduceInjuries),this.addEvent(d.TPVP_EventName.SetGameState,this.setGameState),this.spAnim.setAnimation(0,d.TPVP_AnimName.idle,!0)},e.prototype.update=function(t){if(m.default.Instance.gameState!=d.TPVP_GameState.pause&&m.default.Instance.isfight&&!this.isDie){if(this.roleState!=l.attack){var e=m.default.Instance.findRoleNear(this);if(null!=e){this.atkTarget=e,this.moveTarget=e.node.getPosition();var o=this.boxCol.getBoundingBoxToWorld(),i=e.boxCol.getBoundingBoxToWorld();cc.Intersection.rectRect(o,i)?this.roleState==l.move&&(this.atkTime=.65*this.atkInterval,this.roleState=l.idie,this.moveTarget=this.node.getPosition(),this.spAnim.timeScale=1,this.spAnim.setAnimation(0,d.TPVP_AnimName.idle,!0),y.TPVP_Simulator.instance.setMaxSpeed(this.rvoAgentId,0)):this.roleState==l.idie&&(this.roleState=l.move,this.spAnim.timeScale=1,this.spAnim.setAnimation(0,d.TPVP_AnimName.move,!0),y.TPVP_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed))}else this.atkTarget=null,this.moveTarget=m.default.Instance.mapMidPos.getPosition(),this.roleState==l.idie&&(this.roleState=l.move,this.spAnim.timeScale=1,this.spAnim.setAnimation(0,d.TPVP_AnimName.move,!0),y.TPVP_Simulator.instance.setMaxSpeed(this.rvoAgentId,this.moveSpeed))}this._frames++>8&&(this._frames=0,this.setRovMove()),this.roleState!=l.move&&(this.atkTime+=t,this.atkTime>this.atkInterval&&null!=this.atkTarget&&null!=this.atkTarget.node&&this.atkTarget.node.active&&(this.atkTime=0,this.spAnim.timeScale=this.atkAnimTimeSpeed,this.roleState=l.attack,this.spAnim.setAnimation(0,this.attackAnimName,!1),u.AudioMgr.getInstance().playEffectFree(d.TPVP_AudioId.gongji)))}},e.prototype.setRovMove=function(){if(!(this.rvoAgentId<0)){var t=y.TPVP_Simulator.instance.getAgentByAid(this.rvoAgentId),e=y.TPVP_Simulator.instance.getAgentPosition(this.rvoAgentId),o=this.moveTarget;if(t&&e){var i=o.subtract(cc.v2(e.x,e.y));i.lengthSqr()>1&&(i=i.normalize().multiplyScalar(t.maxSpeed_));var n=t.velocity_,a=new cc.Vec2(.8*n.x+.2*i.x,.8*n.y+.2*i.y);a.lengthSqr()<g.TPVP_RVOMath.RVO_EPSILON?y.TPVP_Simulator.instance.setAgentPrefVelocity(this.rvoAgentId,cc.Vec2.ZERO):y.TPVP_Simulator.instance.setAgentPrefVelocity(this.rvoAgentId,a),i.x>0?this.node.setScale(1,1):i.x<0&&this.node.setScale(-1,1)}}},e.prototype.moveByRvo=function(){var t=y.TPVP_Simulator.instance.getAgentPosition(this.rvoAgentId);t.y<50&&(t.y=50),t.y>370&&(t.y=370),this.node.setPosition(t.x,t.y)},e.prototype.attack=function(){},e.prototype.attackEd=function(t,e){u.AudioMgr.getInstance().playEffectFree(d.TPVP_AudioId.dragonHit),m.default.Instance.playHarmEff(this.node,t,e,!1),cc.Tween.stopAllByTarget(this.spAnim.node),cc.tween(this.spAnim.node).to(.15,{color:cc.Color.RED}).to(.15,{color:cc.Color.WHITE}).start(),this.updeteHpBar()},e.prototype.updeteHpBar=function(){var t=this.nowHp/this.maxHp;cc.Tween.stopAllByTarget(this.hpBar),cc.tween(this.hpBar).to(.1,{progress:t}).start()},e.prototype.setGameState=function(t){switch(t){case d.TPVP_GameState.pause:this.spAnim.paused=!0;break;case d.TPVP_GameState.playing:this.spAnim.paused=!1}},e.prototype.setSpAnimPlaySpeed=function(){var t=this.spAnim.findAnimation(this.attackAnimName);this.clipDuration=t.duration,this.atkInterval<this.clipDuration&&(this.atkAnimTimeSpeed=this.clipDuration/this.atkInterval*1.05)},e.prototype.die=function(){u.AudioMgr.getInstance().playEffectFree(d.TPVP_AudioId.siwang),m.default.Instance.playRoleDieEff(this.node),m.default.Instance.removeRoleLList(this.node),y.TPVP_Simulator.instance.removeAgent(this.rvoAgentId),this.node.destroy()},e.prototype.round=function(t){return Math.round(t)},c([b({type:cc.Enum(d.TPVP_CampType)})],e.prototype,"campType",void 0),c([b(sp.Skeleton)],e.prototype,"spAnim",void 0),c([b(cc.Node)],e.prototype,"boxCol",void 0),c([b(cc.ProgressBar)],e.prototype,"hpBar",void 0),c([_],e)}(p.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],TPVP_RoleEnemy:[function(t,e,o){"use strict";cc._RF.push(e,"a036cooandHDpjnbkVDZyaA","TPVP_RoleEnemy");var i=t,n=e,a=o;cc._RF.push(n,"a036cooandHDpjnbkVDZyaA","TPVP_RoleEnemy");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("TPVP_Config"),p=i("TPVP_DataMgr"),u=i("TPVP_GameEnumData"),d=i("TPVP_GameMgr"),h=i("TPVP_RoleBaseV2"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.init=function(t,e,o,i){var n=this;this.rvoAgentId=t,this.typeID=o,this.moveSpeed=i,this.maxHp=this.round(p.default.getInstance().getEnemyInfo(e,this.typeID).HP),this.atkForce=this.round(p.default.getInstance().getEnemyInfo(e,this.typeID).Atk),this.nowHp=this.maxHp,this.attackAnimName="attack";var a="";switch(this.typeID){case 1:a="zp_dao",this.atkInterval=p.default.getInstance().getParameterCfg(u.TPVP_enumGearParameterCfg.knivesAtkSpeed);break;case 2:a="zp_qb",this.atkInterval=p.default.getInstance().getParameterCfg(u.TPVP_enumGearParameterCfg.LancerArkSpeed);break;case 3:a="zp_dun",this.atkInterval=p.default.getInstance().getParameterCfg(u.TPVP_enumGearParameterCfg.ShieldAtkSpeed)}var r="roleAnim/"+a+"/"+a;this.loadResFromBundle(l.TPVP_BundleName.SpAnim,r,sp.SkeletonData,function(t){n.spAnim.skeletonData=t,n.spAnim.setAnimation(0,l.TPVP_AnimName.move,!0),n.setSpAnimPlaySpeed()})},e.prototype.attack=function(){if(!this.isDie&&null!=this.atkTarget&&null!=this.atkTarget.node&&this.atkTarget.node.active){if(this.atkTarget.isDie)return;var t=this.atkForce;1==this.typeID&&2==this.atkTarget.typeID?t=Math.floor(t*this.damageBonus):2==this.typeID&&3==this.atkTarget.typeID&&(t=Math.floor(t*this.punctureInjury)),3==this.atkTarget.typeID&&(t=Math.floor(t*this.reduceInjuries)),this.atkTarget.attackEd(t,!1)}},e.prototype.attackEd=function(e,o){d.default.Instance.gameState!=l.TPVP_GameState.pause&&(this.isDie||(this.nowHp-=e,t.prototype.attackEd.call(this,e,o),this.nowHp<1&&(this.isDie=!0,this.die())))},c([m],e)}(h.default));a.default=g,cc._RF.pop(),cc._RF.pop()},{}],TPVP_RoleFriend:[function(t,e,o){"use strict";cc._RF.push(e,"203d0ZdigBGpq6pbM7HFn1C","TPVP_RoleFriend");var i=t,n=e,a=o;cc._RF.push(n,"203d0ZdigBGpq6pbM7HFn1C","TPVP_RoleFriend");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("TPVP_Config"),p=i("TPVP_DataMgr"),u=i("TPVP_GameEnumData"),d=i("TPVP_GameMgr"),h=i("TPVP_SFCMSpine"),f=i("TPVP_Simulator"),m=i("TPVP_RoleBaseV2"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.outRoleAnim=null,e.criticalChance=0,e.criticalDouble=0,e.backHP=0,e.suckHP=0,e.addAtkInterval=0,e}return s(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.spAnim.setAttachment("wuqi",null),this.spAnim.setAttachment("dun1",null),this.addEvent(l.TPVP_EventName.WaveOver,this.WaveOver),this.outRoleAnim.setCompleteListener(function(t){t.animation.name==l.TPVP_AnimName.animation&&(e.outRoleAnim.node.active=!1,e.outRoleAnim.destroy())})},e.prototype.init=function(t,e,o){var i=this;this.moveSpeed=o,this.rvoAgentId=t,this.atkForce=0,this.maxHp=p.default.getInstance().getParameterCfg(u.TPVP_enumGearParameterCfg.BaseHealthy);for(var n=!1,a=0,r=0,s=e;r<s.length;r++)101!=(v=s[r]).buffID&&201!=v.buffID&&301!=v.buffID||(n=!0),401!=v.buffID&&3001!=v.buffID&&4001!=v.buffID||(a=v.buffID);if(!n){var c=p.default.getInstance().getWeaponProInfo(0,101);this.maxHp+=this.round(c.HP),this.atkForce+=this.round(c.Atk),this.atkInterval=c.AtkSpeed,this.criticalChance+=c.CriticPro,this.criticalDouble+=c.CriticProDamage}0==a&&(c=p.default.getInstance().getWeaponProInfo(0,401),this.maxHp+=this.round(c.HP),this.atkForce+=this.round(c.Atk),this.backHP+=c.HPBack);for(var d=0,f=0,m=0,g=0,y=e;g<y.length;g++){var v=y[g];switch(c=p.default.getInstance().getWeaponProInfo(v.level,v.buffID),v.buffID){case 101:case 201:case 301:f=v.buffID,m=v.level,this.atkInterval=c.AtkSpeed,this.maxHp+=this.round(c.HP);break;case 401:case 3001:case 4001:d=v.level+1,this.maxHp+=this.round(c.HP);break;case 501:var _=c.HP+1;this.maxHp=this.round(this.maxHp*_);break;case 801:this.addAtkInterval+=c.AtkSpeed,this.atkInterval=this.atkInterval/(1+this.addAtkInterval)}this.atkForce+=this.round(c.Atk),this.suckHP+=c.Heal,this.criticalChance+=c.CriticPro,this.criticalDouble+=c.CriticProDamage,this.backHP+=c.HPBack}this.nowHp=this.maxHp,function(){if(0!=f)if(301==f){var t="dun"+m;i.spAnim.setAttachment("wuqi",null),i.spAnim.setAttachment("dun1",t),i.attackAnimName="attack2",i.typeID=3}else 201==f?(m+=5,i.typeID=2):i.typeID=1,t="wuqi"+m,i.spAnim.setAttachment("wuqi",t),i.spAnim.setAttachment("dun1",null),i.attackAnimName="attack";else i.spAnim.setAttachment("wuqi",null),i.spAnim.setAttachment("dun1",null),i.attackAnimName="attack2",i.typeID=1;i.setSpAnimPlaySpeed()}();var b=401==a?d:0,B="weaponSkin/shen"+b;this.loadTexture2D(l.TPVP_BundleName.Sprite,B,function(t){h.default.changeClouth(i.spAnim,"yifu0",t)});var I="weaponSkin/zuoshou"+b;this.loadTexture2D(l.TPVP_BundleName.Sprite,I,function(t){h.default.changeClouth(i.spAnim,"zuoshou0",t)});var P="weaponSkin/youshou"+b;this.loadTexture2D(l.TPVP_BundleName.Sprite,P,function(t){h.default.changeClouth(i.spAnim,"youshou0",t,401!=a)});var C=4001==a?d:0,D="weaponSkin/weiqun"+C;this.loadTexture2D(l.TPVP_BundleName.Sprite,D,function(t){h.default.changeClouth(i.spAnim,"qunjia0",t)});var T="weaponSkin/zuoxie"+C;this.loadTexture2D(l.TPVP_BundleName.Sprite,T,function(t){h.default.changeClouth(i.spAnim,"zuoxie0",t)});var S="weaponSkin/youxie"+C;if(this.loadTexture2D(l.TPVP_BundleName.Sprite,S,function(t){h.default.changeClouth(i.spAnim,"youxie0",t)}),3001==a){var A="weaponSkin/toukui"+d;this.loadTexture2D(l.TPVP_BundleName.Sprite,A,function(t){h.default.changeClouth(i.spAnim,"toukui0",t)})}else this.spAnim.setAttachment("toukui0",null)},e.prototype.attack=function(){if(!this.isDie&&null!=this.atkTarget&&null!=this.atkTarget.node&&this.atkTarget.node.active){if(this.atkTarget.isDie)return;var t=this.atkForce,e=Math.random()<this.criticalChance;if(e&&(t=this.atkForce*this.criticalDouble),t=Math.floor(t),1==this.typeID&&2==this.atkTarget.typeID?t=Math.floor(t*this.damageBonus):2==this.typeID&&3==this.atkTarget.typeID&&(t=Math.floor(t*this.punctureInjury)),3==this.atkTarget.typeID&&(t=Math.floor(t*this.reduceInjuries)),0!=this.suckHP){var o=this.round(t*this.suckHP);this.nowHp+=o,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.updeteHpBar(),d.default.Instance.playHarmEff(this.node,o,!1,!0)}this.atkTarget.attackEd(t,e)}},e.prototype.attackEd=function(e,o){d.default.Instance.gameState!=l.TPVP_GameState.pause&&(this.isDie||(this.nowHp-=e,t.prototype.attackEd.call(this,e,o),this.nowHp<1&&(this.isDie=!0,this.die())))},e.prototype.WaveOver=function(){this.node.setScale(1,1),this.spAnim.timeScale=1,this.spAnim.setAnimation(0,l.TPVP_AnimName.idle,!0),this.roleState=m.TPVP_RoleState.idie;var t=this.round((this.maxHp-this.nowHp)*this.backHP);this.nowHp+=t,this.nowHp>this.maxHp&&(this.nowHp=this.maxHp),this.updeteHpBar(),d.default.Instance.playHarmEff(this.node,t,!1,!0)},e.prototype.setROVPosition=function(){f.TPVP_Simulator.instance.setAgentPosition(this.rvoAgentId,this.node.getPosition())},c([v(sp.Skeleton)],e.prototype,"outRoleAnim",void 0),c([y],e)}(m.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],TPVP_RoleProTsipBox:[function(t,e,o){"use strict";cc._RF.push(e,"7d327EMaBBNy5lZVVKv+FEv","TPVP_RoleProTsipBox");var i=t,n=e,a=o;cc._RF.push(n,"7d327EMaBBNy5lZVVKv+FEv","TPVP_RoleProTsipBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TPVP_DataMgr"),u=i("TPVP_GameMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.txtRoleHp=null,e.txtRoleAtkSpeed=null,e.txtRoleAtk=null,e.txtRoleSuck=null,e.txtRoleCritical=null,e.txtRoleBackHP=null,e.id=0,e.level=0,e}return s(e,t),e.prototype.init=function(t,e){var o,i,n,a,r,s,c,l=this;u.default.Instance.isfight?this.node.setPosition(cc.v2(0,-20)):this.node.setPosition(cc.v2(0,270)),this.id=t,this.level=e,101!=this.id&&201!=this.id&&301!=this.id||(c=!0);var d=p.default.getInstance().getWeaponProInfo(this.level,this.id);o=d.HP,i=d.AtkSpeed,n=d.Atk,a=d.Heal,r=d.CriticPro,s=d.HPBack,this.txtRoleHp.string="\u8840\u91cf\uff1a"+this.round(o),this.txtRoleAtkSpeed.string="\u653b\u901f\uff1a"+this.round(100*i)/100+"s",this.txtRoleAtk.string="\u653b\u51fb\uff1a"+this.round(100*n)/100,this.txtRoleSuck.string="\u5438\u8840\uff1a"+this.round(100*a)+"%",this.txtRoleCritical.string="\u66b4\u51fb\uff1a"+this.round(100*r)+"%",this.txtRoleBackHP.string="\u56de\u590d\uff1a"+this.round(100*s)+"%",this.title.string=c?"\u6b66\u5668\u5c5e\u6027":"\u88c5\u5907\u5c5e\u6027",this.node.opacity=0,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(.2,{opacity:255}).to(3,{}).to(.2,{opacity:0}).call(function(){l.node.destroy()}).start()},e.prototype.round=function(t){return Math.round(t)},c([f(cc.Label)],e.prototype,"title",void 0),c([f(cc.Label)],e.prototype,"txtRoleHp",void 0),c([f(cc.Label)],e.prototype,"txtRoleAtkSpeed",void 0),c([f(cc.Label)],e.prototype,"txtRoleAtk",void 0),c([f(cc.Label)],e.prototype,"txtRoleSuck",void 0),c([f(cc.Label)],e.prototype,"txtRoleCritical",void 0),c([f(cc.Label)],e.prototype,"txtRoleBackHP",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],TPVP_SFCMSpine:[function(t,e,o){"use strict";cc._RF.push(e,"67264OMSAxB0404B4mfQdMr","TPVP_SFCMSpine");var i=t,n=e,a=o;cc._RF.push(n,"67264OMSAxB0404B4mfQdMr","TPVP_SFCMSpine"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("ResourceMgr"),s=function(){function t(){}return t.changePartialWithExternalTexture=function(t,e,o,i){void 0===i&&(i=!1);var n=t.findSlot(e);if(n){var a=n.getAttachment();if(a){var r=o.width,s=o.height,c=new sp.SkeletonTexture({width:r,height:s});c.setRealTexture(o);var l,p=new sp.spine.TextureAtlasRegion;if(p.width=r,p.height=s,p.originalWidth=r,p.originalHeight=s,p.u=0,p.v=0,p.u2=1,p.v2=1,p.texture=c,p.renderObject=p,i&&(p.offsetX=-9),a instanceof sp.spine.MeshAttachment){var u=a.copy();u.region=p,u.updateUVs(),l=u}else if(a instanceof sp.spine.RegionAttachment){var d=a.copy();d.setRegion(p),d.updateOffset(),l=d}l&&n.setAttachment(l),t.invalidAnimationCache()}else cc.error("slot: "+e+" \u6ca1\u6709\u6709\u6548\u7684 attachment")}else cc.error("\u672a\u627e\u5230 \u63d2\u69fd: "+e)},t.chageClouthWithBundle=function(t,e,o,i){var n=this;r.ResourceMgr.getInstance().loadRes(o,i,cc.Texture2D,function(o){t&&cc.isValid(t)&&n.changeClouth(t,e,o)})},t.changeClouth=function(t,e,o,i){if(void 0===i&&(i=!1),cc.sys.isNative){var n=new middleware.Texture2D;n.setPixelsHigh(o.height),n.setPixelsWide(o.width),n.setNativeTexture(o.getImpl()),t.updateRegion(e,n),t.invalidAnimationCache()}else this.changePartialWithExternalTexture(t,e,o,i)},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],TPVP_Simulator:[function(t,e,o){"use strict";cc._RF.push(e,"c9717VhLl5EHrHeGzym7lQ/","TPVP_Simulator");var i=t,n=e,a=o;cc._RF.push(n,"c9717VhLl5EHrHeGzym7lQ/","TPVP_Simulator"),Object.defineProperty(a,"__esModule",{value:!0}),a.TPVP_Simulator=void 0;var r=i("TPVP_Agent"),s=i("TPVP_Common"),c=i("TPVP_kdtree"),l=function(){function t(){this.agentId=0,this.agentIdLst=[],this.aid2agent=Object.create(null),this.obstacles=[],this.kdTree=new c.TPVP_KdTree,this.time=0}return Object.defineProperty(t,"instance",{get:function(){return t._inst||(t._inst=new t),t._inst},enumerable:!1,configurable:!0}),t.prototype.getAgent=function(t){return this.aid2agent[this.agentIdLst[t]]},t.prototype.getAgentByAid=function(t){return this.aid2agent[t]},t.prototype.getGlobalTime=function(){return this.time},t.prototype.getNumAgents=function(){return this.agentIdLst.length},t.prototype.getAgentAidByIdx=function(t){return this.agentIdLst[t]},t.prototype.setAgentPrefVelocity=function(t,e){this.aid2agent[t].prefVelocity_.copy(e)},t.prototype.getAgentPosition=function(t){return this.aid2agent[t]?this.aid2agent[t].position_:null},t.prototype.setAgentPosition=function(t,e){this.aid2agent[t]&&this.aid2agent[t].position_.copy(e)},t.prototype.getAgentPrefVelocity=function(t){return this.aid2agent[t].prefVelocity_},t.prototype.getAgentVelocity=function(t){return this.aid2agent[t].velocity_},t.prototype.getAgentRadius=function(t){return this.aid2agent[t].radius_},t.prototype.getAgentOrcaLines=function(t){return this.aid2agent[t].orcaLines_},t.prototype.addAgent=function(t,e,o,i,n){if(void 0===e&&(e=null),void 0===o&&(o=null),void 0===i&&(i=null),void 0===n&&(n=null),!this.defaultAgent)throw new Error("no default agent");var a=new r.TPVP_Agent;return a.position_.copy(t),a.maxNeighbors_=this.defaultAgent.maxNeighbors_,a.maxSpeed_=o||this.defaultAgent.maxSpeed_,a.neighborDist=this.defaultAgent.neighborDist,a.radius_=e||this.defaultAgent.radius_,a.timeHorizon=this.defaultAgent.timeHorizon,a.timeHorizonObst=this.defaultAgent.timeHorizonObst,a.velocity_.copy(i||this.defaultAgent.velocity_),a.id=this.agentId++,n&&n>=0&&(a.mass=n),this.aid2agent[a.id]=a,this.agentIdLst.push(a.id),a.id},t.prototype.removeAgent=function(t){if(this.hasAgent(t)){var e=this.agentIdLst.indexOf(t);e>=0&&(this.agentIdLst[e]=this.agentIdLst[this.agentIdLst.length-1],this.agentIdLst.length--),delete this.aid2agent[t]}},t.prototype.hasAgent=function(t){return!!this.aid2agent[t]},t.prototype.setAgentMass=function(t,e){this.aid2agent[t].mass=e},t.prototype.getAgentMass=function(t){return this.aid2agent[t].mass},t.prototype.setAgentRadius=function(t,e){this.aid2agent[t].radius_=e},t.prototype.setMaxSpeed=function(t,e){this.aid2agent[t]&&(this.aid2agent[t].maxSpeed_=e)},t.prototype.setAgentDefaults=function(t,e,o,i,n,a,s){this.defaultAgent||(this.defaultAgent=new r.TPVP_Agent),this.defaultAgent.maxNeighbors_=e,this.defaultAgent.maxSpeed_=a,this.defaultAgent.neighborDist=t,this.defaultAgent.radius_=n,this.defaultAgent.timeHorizon=o,this.defaultAgent.timeHorizonObst=i,this.defaultAgent.velocity_=s},t.prototype.run=function(t){this.kdTree.buildAgentTree(this.getNumAgents());for(var e=this.agentIdLst.length,o=0;o<e;o++)this.aid2agent[this.agentIdLst[o]].computeNeighbors(this),this.aid2agent[this.agentIdLst[o]].computeNewVelocity(t);for(o=0;o<e;o++)this.aid2agent[this.agentIdLst[o]].update(t);this.time+=t},t.prototype.addObstacle=function(t){if(t.length<2)return-1;for(var e=this.obstacles.length,o=0;o<t.length;++o){var i=new s.TPVP_Obstacle;i.point=t[o],0!=o&&(i.previous=this.obstacles[this.obstacles.length-1],i.previous.next=i),o==t.length-1&&(i.next=this.obstacles[e],i.next.previous=i),i.direction=s.TPVP_RVOMath.normalize(t[o==t.length-1?0:o+1].minus(t[o])),2==t.length?i.convex=!0:i.convex=s.TPVP_RVOMath.leftOf(t[0==o?t.length-1:o-1],t[o],t[o==t.length-1?0:o+1])>=0,i.id=this.obstacles.length,this.obstacles.push(i)}return e},t.prototype.processObstacles=function(){this.kdTree.buildObstacleTree()},t.prototype.queryVisibility=function(t,e,o){return this.kdTree.queryVisibility(t,e,o)},t.prototype.getObstacles=function(){return this.obstacles},t.prototype.clear=function(){this.agentIdLst.length=0,this.agentId=0,this.aid2agent=Object.create(null),this.defaultAgent=null,this.kdTree=new c.TPVP_KdTree,this.obstacles.length=0},t}();a.TPVP_Simulator=l,cc._RF.pop(),cc._RF.pop()},{}],TPVP_TbeBoxBack:[function(t,e,o){"use strict";cc._RF.push(e,"891d85Gw8JBw6yUpRHDy2ri","TPVP_TbeBoxBack");var i=t,n=e,a=o;cc._RF.push(n,"891d85Gw8JBw6yUpRHDy2ri","TPVP_TbeBoxBack");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("TPVP_Config"),d=i("TPVP_GameMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layerType=0,e.box=null,e.lockRoot=null,e.weaponIcon=null,e.boxMask=null,e.wpnState=!1,e.isLock=!1,e.lock=null,e.txtLockNum=null,e.isBeinLock=!1,e.isLockState=!1,e.isPlayMaskAnim=!1,e.maskAnimTime=0,e}return s(e,t),e.prototype.onLoad=function(){this.addEvent(u.TPVP_EventName.UnLockTbeBox,this.unLockTbeBoxEvent),this.addEvent(u.TPVP_EventName.MoveBoxTips,this.moveBoxTips),this.node.on(cc.Node.EventType.TOUCH_END,this.unLockTbeBox,this)},e.prototype.setLock=function(t){this.isLock=t,this.lockRoot.active=t,this.box.active=t,this.weaponIcon.active=!t},e.prototype.setLockState=function(t){this.isBeinLock=t,this.txtLockNum.node.active=t,this.txtLockNum.string=""+d.default.Instance.getLockBoxGoldNum()},e.prototype.setWpnState=function(t){this.wpnState=t,this.weaponIcon.active=!t},e.prototype.unLockTbeBoxEvent=function(t){var e=this;this.isLockState=t,t?this.isLock&&(clearInterval(this.animId),cc.tween(this.lockRoot).to(.5,{scale:.35}).to(.5,{scale:.28}).start(),this.animId=setInterval(function(){cc.tween(e.lockRoot).to(.5,{scale:.35}).to(.5,{scale:.28}).start()},1e3)):(cc.Tween.stopAllByTarget(this.lockRoot),this.lockRoot.scale=.3,clearInterval(this.animId),this.animId=null)},e.prototype.unLockTbeBox=function(){this.isLockState&&this.isLock&&(d.default.Instance.playUnLockBoxEff(this.lock),this.sendEvent(u.TPVP_EventName.UnLockTbeBox,!1),this.setLock(!1),d.default.Instance.closeUnLockTbeBox(),p.AudioMgr.getInstance().playEffectFree(u.TPVP_AudioId.shengji))},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),cc.Tween.stopAllByTarget(this.lockRoot),clearInterval(this.animId),clearInterval(this.moveBoxTipsID)},e.prototype.setBox=function(t){this.isLock||(this.box.active=t),t&&(this.box.active=t)},e.prototype.moveBoxTips=function(t){var e=this;-1==t?(this.isPlayMaskAnim=!1,this.maskAnimTime=0,this.weaponIcon.opacity=140,cc.Tween.stopAllByTarget(this.weaponIcon),cc.Tween.stopAllByTarget(this.boxMask),this.boxMask.active=!1,clearInterval(this.moveBoxTipsID)):t==this.layerType&&(this.isLock||this.wpnState||(this.maskAnimTime=0,this.isPlayMaskAnim=!0,this.boxMask.active=!0,this.boxMask.opacity=100,cc.Tween.stopAllByTarget(this.boxMask),cc.tween(this.boxMask).to(.35,{opacity:255}).to(.35,{opacity:100}).start(),cc.Tween.stopAllByTarget(this.weaponIcon),clearInterval(this.moveBoxTipsID),cc.tween(this.weaponIcon).to(.35,{opacity:255}).to(.35,{opacity:100}).start(),this.moveBoxTipsID=setInterval(function(){cc.tween(e.weaponIcon).to(.35,{opacity:255}).to(.35,{opacity:100}).start(),cc.tween(e.boxMask).to(.35,{opacity:255}).to(.35,{opacity:100}).start()},700)))},c([m(cc.Integer)],e.prototype,"layerType",void 0),c([m(cc.Node)],e.prototype,"box",void 0),c([m(cc.Node)],e.prototype,"lockRoot",void 0),c([m(cc.Node)],e.prototype,"weaponIcon",void 0),c([m(cc.Node)],e.prototype,"boxMask",void 0),c([m(cc.Node)],e.prototype,"lock",void 0),c([m(cc.Label)],e.prototype,"txtLockNum",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],TPVP_UIGM:[function(t,e,o){"use strict";cc._RF.push(e,"6309f/rzLBAGIzLmHui5UXd","TPVP_UIGM");var i=t,n=e,a=o;cc._RF.push(n,"6309f/rzLBAGIzLmHui5UXd","TPVP_UIGM");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("TPVP_GameMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeGM=null,e.updateSpare=null,e.timeSpeed1=null,e.txtTimeSpeed=null,e.isTimeSpeed=!0,e}return s(e,t),e.prototype.start=function(){var t=this;this.closeGM.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.updateSpare.on(cc.Node.EventType.TOUCH_END,function(){p.default.Instance.setGoldNum(1e3)},this),this.timeSpeed1.on(cc.Node.EventType.TOUCH_END,function(){t.isTimeSpeed=!t.isTimeSpeed;var e=t.isTimeSpeed?1:2.5;t.txtTimeSpeed.string="\u500d\u901f\uff1a"+e},this)},c([h(cc.Node)],e.prototype,"closeGM",void 0),c([h(cc.Node)],e.prototype,"updateSpare",void 0),c([h(cc.Node)],e.prototype,"timeSpeed1",void 0),c([h(cc.Label)],e.prototype,"txtTimeSpeed",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TPVP_UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"d5af0uJE/xHL5nQLcFYcUUj","TPVP_UIGameOver");var i=t,n=e,a=o;cc._RF.push(n,"d5af0uJE/xHL5nQLcFYcUUj","TPVP_UIGameOver");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("TPVP_APP"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.win=null,e.fail=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t},e.prototype.start=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)},this),this.win.active=this.isWin,this.fail.active=!this.isWin},c([h(cc.Node)],e.prototype,"btnClose",void 0),c([h(cc.Node)],e.prototype,"win",void 0),c([h(cc.Node)],e.prototype,"fail",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TPVP_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"e6875vFqwBKsZlxr2xeWuIZ","TPVP_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"e6875vFqwBKsZlxr2xeWuIZ","TPVP_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("SdkMgr"),h=i("TPVP_Config"),f=i("TPVP_GameMgr"),m=i("TPVP_RoleProTsipBox"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lockTips=null,e.btnPause=null,e.upTips=null,e.ui_Top=null,e}return s(e,t),e.prototype.start=function(){var t=this;(d.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR)&&this.lockTips.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.TPVP_UIID.TPVP_UIGM)},this),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(h.TPVP_UIID.TPVP_UIPause),f.default.Instance.setGameState(h.TPVP_GameState.pause)},this),this.addEvent(h.TPVP_EventName.UpTipsBox,this.upTipsBox),this.addEvent(h.TPVP_EventName.PlayWpnProTips,this.playWpnProTips),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.space:this.openUI(h.TPVP_UIID.TPVP_UIPause),f.default.Instance.setGameState(h.TPVP_GameState.pause)}},e.prototype.upTipsBox=function(t){var e=32*t.length+10,o=cc.instantiate(this.upTips);o.setParent(this.upTips.parent),o.active=!0,o.width=e,o.getChildByName("txtTips").getComponent(cc.Label).string=t,o.scale=0;var i=o.position.clone();i.y+=300,cc.tween(o).to(.2,{scale:1}).to(1.2,{scale:1}).to(.5,{position:i,opacity:.3}).call(function(){o.destroy()}).start()},e.prototype.playWpnProTips=function(t,e){var o=this;this.loadPrefab(h.TPVP_BundleName.Prefabs,"effAnim/roleProTsipBox",function(i){var n=cc.instantiate(i);n.setParent(o.ui_Top),n.getComponent(m.default).init(t,e)})},c([v(cc.Node)],e.prototype,"lockTips",void 0),c([v(cc.Node)],e.prototype,"btnPause",void 0),c([v(cc.Node)],e.prototype,"upTips",void 0),c([v(cc.Node)],e.prototype,"ui_Top",void 0),c([y],e)}(p.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],TPVP_UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"5902fK6B7ZAv6PQeFi02RZu","TPVP_UIPause");var i=t,n=e,a=o;cc._RF.push(n,"5902fK6B7ZAv6PQeFi02RZu","TPVP_UIPause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("TPVP_APP"),u=i("TPVP_Config"),d=i("TPVP_GameMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnResume=null,e.btnClose=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.btnResume.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI(),d.default.Instance.setGameState(u.TPVP_GameState.playing)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0),t.closeUI()},this)},c([m(cc.Node)],e.prototype,"btnResume",void 0),c([m(cc.Node)],e.prototype,"btnClose",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],TPVP_WeaponBase:[function(t,e,o){"use strict";cc._RF.push(e,"33669rr5PhAarz6UQ1LaTDV","TPVP_WeaponBase");var i=t,n=e,a=o;cc._RF.push(n,"33669rr5PhAarz6UQ1LaTDV","TPVP_WeaponBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("TPVP_Config"),u=i("TPVP_DataMgr"),d=i("TPVP_GameMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layerType=0,e.weaponIcon=null,e.txtPro=null,e.upLevelAnimPos=null,e.weaponTypeID=0,e.level=1,e.isTapShowPro=!1,e.showProTime=0,e.isAccord=!1,e.animIndexID=null,e}return s(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.addEvent(p.TPVP_EventName.UpdateAllBoxAccord,this.updateAllBoxAccord),this.addEvent(p.TPVP_EventName.PlayGame,this.closeBoxUpTips)},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),clearInterval(this.animIndexID)},e.prototype.update=function(t){this.isTapShowPro&&(this.showProTime+=t)},e.prototype.onTouchStart=function(){this.isTapShowPro=!0,this.showProTime=0},e.prototype.onTouchMove=function(){},e.prototype.onTouchEnd=function(){this.isTapShowPro=!1,this.showProTime<.15&&this.showPro(),this.showProTime=0},e.prototype.showPro=function(){3!=this.layerType&&this.sendEvent(p.TPVP_EventName.PlayWpnProTips,this.weaponTypeID,this.level)},e.prototype.updateAllBoxAccord=function(t){for(var e=!1,o=0;o<t.length;o++)if(t[o]!=this){var i=t[o],n=i.layerType==this.layerType&&i.weaponTypeID==this.weaponTypeID&&i.level==this.level&&this.level<5;if(n&&901==this.weaponTypeID&&(n=this.level<4),n){e=!0;break}}e?this.openBoxUpTips():this.closeBoxUpTips()},e.prototype.openBoxUpTips=function(){this.isAccord=!0,clearInterval(this.animIndexID),this.animIndexID=null;var t=null!=this.txtPro?this.txtPro.node:this.weaponIcon.node;cc.Tween.stopAllByTarget(t),cc.tween(t).to(.07,{angle:5}).to(.14,{angle:-5}).to(.2,{angle:0}).to(.07,{angle:5}).to(.14,{angle:-5}).to(.2,{angle:0}).to(.1,{angle:5}).to(.2,{angle:-5}).to(.3,{angle:0}).start(),this.animIndexID=setInterval(function(){cc.tween(t).to(.07,{angle:5}).to(.14,{angle:-5}).to(.2,{angle:0}).to(.07,{angle:5}).to(.14,{angle:-5}).to(.2,{angle:0}).to(.1,{angle:5}).to(.2,{angle:-5}).to(.3,{angle:0}).start()},1420)},e.prototype.closeBoxUpTips=function(){if(this.isAccord&&this.weaponIcon.node){var t=null!=this.txtPro?this.txtPro.node:this.weaponIcon.node;cc.Tween.stopAllByTarget(t),cc.tween(t).to(.02,{angle:0}).start(),clearInterval(this.animIndexID),this.animIndexID=null}this.isAccord=!1},e.prototype.updateBoxLevel=function(){var t=this,e=p.TPVP_RoleAsePath[this.weaponTypeID].iconPath;switch(this.weaponTypeID){case 101:case 201:case 301:case 401:case 3001:case 4001:e+=this.level}if(3==this.layerType){var o="";switch(this.weaponTypeID){case 501:o="\u8840\u91cf+"+this.round(100*u.default.getInstance().getWeaponProInfo(this.level,this.weaponTypeID).HP)+"%";break;case 601:o="\u56de\u590d+"+this.round(100*u.default.getInstance().getWeaponProInfo(this.level,this.weaponTypeID).HPBack)+"%";break;case 701:o="\u653b\u51fb+"+this.round(u.default.getInstance().getWeaponProInfo(this.level,this.weaponTypeID).Atk);break;case 801:o="\u653b\u901f+"+this.round(100*u.default.getInstance().getWeaponProInfo(this.level,this.weaponTypeID).AtkSpeed)+"%";break;case 901:o="\u6570\u91cf+"+this.round(u.default.getInstance().getWeaponProInfo(this.level,this.weaponTypeID).Number);break;case 1001:o="\u66b4\u51fb+"+this.round(100*u.default.getInstance().getWeaponProInfo(this.level,this.weaponTypeID).CriticPro)+"%";break;case 2001:o="\u91d1\u5e01+"+this.round(u.default.getInstance().getWeaponProInfo(this.level,this.weaponTypeID).Gold)}this.txtPro.string=""+o}else{var i="weaponIcon/"+e;this.loadSpriteFrame(p.TPVP_BundleName.Sprite,i,function(e){t.weaponIcon.spriteFrame=e})}},e.prototype.die=function(){d.default.Instance.removeWeaponBox(this.node),clearInterval(this.animIndexID),this.animIndexID=null,this.node.destroy()},e.prototype.round=function(t){return Math.round(t)},c([m(cc.Integer)],e.prototype,"layerType",void 0),c([m(cc.Sprite)],e.prototype,"weaponIcon",void 0),c([m(cc.Label)],e.prototype,"txtPro",void 0),c([m(cc.Node)],e.prototype,"upLevelAnimPos",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],TPVP_WeaponBox:[function(t,e,o){"use strict";cc._RF.push(e,"f2bf16r0JlGgpvgZ9APngVa","TPVP_WeaponBox");var i=t,n=e,a=o;cc._RF.push(n,"f2bf16r0JlGgpvgZ9APngVa","TPVP_WeaponBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("TPVP_Config"),u=i("TPVP_GameMgr"),d=i("TPVP_WeaponBase"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.deviationOnStart=cc.v2(),e}return s(e,t),e.prototype.init=function(t,e){this.weaponTypeID=t,this.level=e,this.updateBoxLevel()},e.prototype.onTouchStart=function(e){if(!u.default.Instance.isUnLockTbeBoxState&&(t.prototype.onTouchStart.call(this,e),null==u.default.Instance.pitchBox&&u.default.Instance.isPrepare)){u.default.Instance.pitchBox=this.node,cc.Tween.stopAllByTarget(this.weaponIcon.node),cc.Tween.stopAllByTarget(this.node),clearInterval(this.animIndexID),this.animIndexID=null,this.weaponIcon.node.angle=0,this.node.angle=0;var o=this.node.parent.convertToNodeSpaceAR(e.getLocation());this.deviationOnStart=this.node.getPosition().subtract(o),this.updateTouchPos(e.getLocation()),u.default.Instance.moveWeaponBox(p.TPVP_MoveRoleState.TouchStart,this)}},e.prototype.onTouchMove=function(t){u.default.Instance.isPrepare&&null!=u.default.Instance.pitchBox&&u.default.Instance.pitchBox==this.node&&(this.updateTouchPos(t.getLocation()),u.default.Instance.moveWeaponBox(p.TPVP_MoveRoleState.TouchMove,this))},e.prototype.onTouchEnd=function(e){u.default.Instance.isUnLockTbeBoxState||(t.prototype.onTouchEnd.call(this,e),null!=u.default.Instance.pitchBox&&u.default.Instance.pitchBox==this.node&&u.default.Instance.isPrepare&&(u.default.Instance.pitchBox=null,this.isAccord&&this.openBoxUpTips(),this.updateTouchPos(e.getLocation()),u.default.Instance.moveWeaponBox(p.TPVP_MoveRoleState.TouchEnd,this)))},e.prototype.updateTouchPos=function(t){var e=this.node.parent.convertToNodeSpaceAR(t).add(this.deviationOnStart);this.node.setPosition(e)},e.prototype.upLevel=function(){this.level>=5||(l.AudioMgr.getInstance().playEffectFree(p.TPVP_AudioId.shengji),this.level++,u.default.Instance.playWpnBoxUpLevelEff(this.upLevelAnimPos),this.updateBoxLevel())},e.prototype.updateBoxLevel=function(){var e=this;t.prototype.updateBoxLevel.call(this);var o="weaponBox/zp_"+this.level+"_"+this.layerType;this.loadSpriteFrame(p.TPVP_BundleName.Sprite,o,function(t){e.node.getComponent(cc.Sprite).spriteFrame=t})},c([f],e)}(d.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],TPVP_WeaponTbe:[function(t,e,o){"use strict";cc._RF.push(e,"693094WyFRELrw0BeucpLJr","TPVP_WeaponTbe");var i=t,n=e,a=o;cc._RF.push(n,"693094WyFRELrw0BeucpLJr","TPVP_WeaponTbe");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("TPVP_Config"),u=i("TPVP_GameMgr"),d=i("TPVP_WeaponBase"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tbeBox=null,e.moveBoxPos=null,e.spAnim2=null,e.isTryAgain=!1,e.tbeBoxKey=0,e.isMoveBox=!1,e.touchID=-1,e}return s(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.init=function(t,e,o,i){var n=this;void 0===i&&(i=!1),i?(this.node.getChildByName("tryAgain").active=!0,this.isTryAgain=!0,this.spAnim2.node.active=!1,this.spAnim2.destroy()):(this.tbeBoxKey=t,this.weaponTypeID=e,this.level=o,this.updateBoxLevel(),this.spAnim2.node.active=!0,this.spAnim2.timeScale=1.2,this.spAnim2.setCompleteListener(function(t){t.animation.name==p.TPVP_AnimName.animation&&(n.spAnim2.node.active=!1,n.spAnim2.destroy())}))},e.prototype.onTouchStart=function(e){u.default.Instance.isUnLockTbeBoxState||(t.prototype.onTouchStart.call(this,e),this.isTryAgain||null==u.default.Instance.pitchBox&&(null!=u.default.Instance.createMoveBox||this.isMoveBox||u.default.Instance.isPrepare&&(this.isMoveBox=!0,this.touchID=e.getID(),u.default.Instance.removeWeaponBox(this.node),u.default.Instance.createWeaponBox(e,this),this.tbeBox.node.active=!1,this.weaponIcon.node.active=!1,null!=this.txtPro&&(this.txtPro.node.active=!1),u.default.Instance.setParentPos(this.node,u.default.Instance.tbeTopRoot))))},e.prototype.onTouchMove=function(t){this.isTryAgain||u.default.Instance.isPrepare&&null!=u.default.Instance.createMoveBox&&this.isMoveBox&&this.touchID==t.getID()&&u.default.Instance.createMoveBox.onTouchMove(t)},e.prototype.onTouchEnd=function(e){u.default.Instance.isUnLockTbeBoxState||(t.prototype.onTouchEnd.call(this,e),this.isTryAgain||null!=u.default.Instance.createMoveBox&&this.isMoveBox&&this.touchID==e.getID()&&u.default.Instance.isPrepare&&(u.default.Instance.createMoveBox.onTouchEnd(e),u.default.Instance.createMoveBox=null,this.die()))},e.prototype.upLevel=function(){this.level>=5||(l.AudioMgr.getInstance().playEffectFree(p.TPVP_AudioId.shengji),this.level++,u.default.Instance.playWpnBoxUpLevelEff(this.upLevelAnimPos),this.updateBoxLevel())},e.prototype.updateBoxLevel=function(){var e=this;t.prototype.updateBoxLevel.call(this);var o="tbeBox/zp_"+this.level+"_"+this.layerType;this.loadSpriteFrame(p.TPVP_BundleName.Sprite,o,function(t){e.tbeBox.spriteFrame=t})},e.prototype.playWpnAnim=function(){var t;this.isTryAgain?(t=this.node.getChildByName("tryAgain"),cc.Tween.stopAllByTarget(t),cc.tween(t).to(.15,{scale:1.05}).to(.15,{scale:.85}).to(.15,{scale:1.05}).to(.15,{scale:.85}).to(.15,{scale:1.05}).to(.15,{scale:.85}).start()):null!=this.txtPro?(cc.Tween.stopAllByTarget(this.txtPro.node),cc.tween(this.txtPro.node).to(.15,{scale:.7}).to(.15,{scale:.5}).to(.15,{scale:.7}).to(.15,{scale:.5}).to(.15,{scale:.7}).to(.15,{scale:.5}).start()):(cc.Tween.stopAllByTarget(this.weaponIcon.node),cc.tween(this.weaponIcon.node).to(.15,{scale:1.2}).to(.15,{scale:1}).to(.15,{scale:1.2}).to(.15,{scale:1}).to(.15,{scale:1.2}).to(.15,{scale:1}).start())},c([m(cc.Sprite)],e.prototype,"tbeBox",void 0),c([m(cc.Node)],e.prototype,"moveBoxPos",void 0),c([m(sp.Skeleton)],e.prototype,"spAnim2",void 0),c([f],e)}(d.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],TPVP_kdtree:[function(t,e,o){"use strict";cc._RF.push(e,"a7ee442uqxHILoPf3eaf9Mo","TPVP_kdtree");var i=t,n=e,a=o;cc._RF.push(n,"a7ee442uqxHILoPf3eaf9Mo","TPVP_kdtree"),Object.defineProperty(a,"__esModule",{value:!0}),a.TPVP_KdTree=void 0;var r=i("TPVP_Common"),s=i("TPVP_Simulator"),c=function(){function t(t,e){this.a=t,this.b=e}return t.prototype.lessThan=function(t){return this.a<t.a||!(t.a<this.a)&&this.b<t.b},t.prototype.lessEqualThan=function(t){return this.a==t.a&&this.b==t.b||this.lessThan(t)},t.prototype.bigThan=function(t){return!this.lessEqualThan(t)},t.prototype.bigEqualThan=function(t){return!this.lessThan(t)},t}(),l=function(){},p=function(){},u=function(){function t(){this.MAX_LEAF_SIZE=10,this.agents=null,this.agentTree=[],this.obstacleTree=null}return t.prototype.buildAgentTree=function(t){if(!this.agents||this.agents.length!=t){this.agents=new Array(t);for(var e=0;e<this.agents.length;e++)this.agents[e]=s.TPVP_Simulator.instance.getAgent(e);for(this.agentTree=new Array(2*this.agents.length),e=0;e<this.agentTree.length;e++)this.agentTree[e]=new l}0!=this.agents.length&&this.buildAgentTreeRecursive(0,this.agents.length,0)},t.prototype.buildObstacleTree=function(){this.obstacleTree=new p;for(var t=new Array(s.TPVP_Simulator.instance.obstacles.length),e=0;e<t.length;e++)t[e]=s.TPVP_Simulator.instance.obstacles[e];this.obstacleTree=this.buildObstacleTreeRecursive(t)},t.prototype.computeAgentNeighbors=function(t,e){return this.queryAgentTreeRecursive(t,e,0)},t.prototype.computeObstacleNeighbors=function(t,e){this.queryObstacleTreeRecursive(t,e,this.obstacleTree)},t.prototype.queryVisibility=function(t,e,o){return this.queryVisibilityRecursive(t,e,o,this.obstacleTree)},t.prototype.buildAgentTreeRecursive=function(t,e,o){this.agentTree[o].begin=t,this.agentTree[o].end=e,this.agentTree[o].minX=this.agentTree[o].maxX=this.agents[t].position_.x,this.agentTree[o].minY=this.agentTree[o].maxY=this.agents[t].position_.y;for(var i=t+1;i<e;++i)this.agentTree[o].maxX=Math.max(this.agentTree[o].maxX,this.agents[i].position_.x),this.agentTree[o].minX=Math.min(this.agentTree[o].minX,this.agents[i].position_.x),this.agentTree[o].maxY=Math.max(this.agentTree[o].maxY,this.agents[i].position_.y),this.agentTree[o].minY=Math.min(this.agentTree[o].minY,this.agents[i].position_.y);if(e-t>this.MAX_LEAF_SIZE){for(var n=this.agentTree[o].maxX-this.agentTree[o].minX>this.agentTree[o].maxY-this.agentTree[o].minY,a=.5*(n?this.agentTree[o].maxX+this.agentTree[o].minX:this.agentTree[o].maxY+this.agentTree[o].minY),r=t,s=e;r<s;){for(;r<s&&(n?this.agents[r].position_.x:this.agents[r].position_.y)<a;)++r;for(;s>r&&(n?this.agents[s-1].position_.x:this.agents[s-1].position_.y)>=a;)--s;if(r<s){var c=this.agents[r];this.agents[r]=this.agents[s-1],this.agents[s-1]=c,++r,--s}}var l=r-t;0==l&&(++l,++r,++s),this.agentTree[o].left=o+1,this.agentTree[o].right=o+2*l,this.buildAgentTreeRecursive(t,r,this.agentTree[o].left),this.buildAgentTreeRecursive(r,e,this.agentTree[o].right)}},t.prototype.buildObstacleTreeRecursive=function(t){if(0==t.length)return null;for(var e=new p,o=0,i=t.length,n=i,a=0;a<t.length;++a){for(var l=0,u=0,d=(C=t[a]).next,h=0;h<t.length;h++)if(a!=h){var f=(S=t[h]).next,m=r.TPVP_RVOMath.leftOf(C.point,d.point,S.point),g=r.TPVP_RVOMath.leftOf(C.point,d.point,f.point);m>=-r.TPVP_RVOMath.RVO_EPSILON&&g>=-r.TPVP_RVOMath.RVO_EPSILON?++l:(m<=r.TPVP_RVOMath.RVO_EPSILON&&g<=r.TPVP_RVOMath.RVO_EPSILON||++l,++u);var y=new c(Math.max(l,u),Math.min(l,u)),v=new c(Math.max(i,n),Math.min(i,n));if(y.bigEqualThan(v))break}var _=new c(Math.max(l,u),Math.min(l,u)),b=new c(Math.max(i,n),Math.min(i,n));_.lessThan(b)&&(i=l,n=u,o=a)}for(var B=[],I=0;I<i;++I)B.push(null);var P=[];for(I=0;I<n;++I)P.push(null);var C,D=0,T=0;for(d=(C=t[a=o]).next,h=0;h<t.length;++h){var S;if(a!=h)if(f=(S=t[h]).next,m=r.TPVP_RVOMath.leftOf(C.point,d.point,S.point),g=r.TPVP_RVOMath.leftOf(C.point,d.point,f.point),m>=-r.TPVP_RVOMath.RVO_EPSILON&&g>=-r.TPVP_RVOMath.RVO_EPSILON)B[D++]=t[h];else if(m<=r.TPVP_RVOMath.RVO_EPSILON&&g<=r.TPVP_RVOMath.RVO_EPSILON)P[T++]=t[h];else{var A=r.TPVP_RVOMath.det(d.point.minus(C.point),S.point.minus(C.point))/r.TPVP_RVOMath.det(d.point.minus(C.point),S.point.minus(f.point)),k=S.point.plus(f.point.minus(S.point).scale(A)),w=new r.TPVP_Obstacle;w.point=k,w.previous=S,w.next=f,w.convex=!0,w.direction=S.direction,w.id=s.TPVP_Simulator.instance.obstacles.length,s.TPVP_Simulator.instance.obstacles.push(w),S.next=w,f.previous=w,m>0?(B[D++]=S,P[T++]=w):(P[T++]=S,B[D++]=w)}}return e.obstacle=C,e.left=this.buildObstacleTreeRecursive(B),e.right=this.buildObstacleTreeRecursive(P),e},t.prototype.queryAgentTreeRecursive=function(t,e,o){if(this.agentTree[o].end-this.agentTree[o].begin<=this.MAX_LEAF_SIZE)for(var i=this.agentTree[o].begin;i<this.agentTree[o].end;++i)e=t.insertAgentNeighbor(this.agents[i],e);else{var n=r.TPVP_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].left].minX-t.position_.x))+r.TPVP_RVOMath.sqr(Math.max(0,t.position_.x-this.agentTree[this.agentTree[o].left].maxX))+r.TPVP_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].left].minY-t.position_.y))+r.TPVP_RVOMath.sqr(Math.max(0,t.position_.y-this.agentTree[this.agentTree[o].left].maxY)),a=r.TPVP_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].right].minX-t.position_.x))+r.TPVP_RVOMath.sqr(Math.max(0,t.position_.x-this.agentTree[this.agentTree[o].right].maxX))+r.TPVP_RVOMath.sqr(Math.max(0,this.agentTree[this.agentTree[o].right].minY-t.position_.y))+r.TPVP_RVOMath.sqr(Math.max(0,t.position_.y-this.agentTree[this.agentTree[o].right].maxY));n<a?n<e&&a<(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].left))&&(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].right)):a<e&&n<(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].right))&&(e=this.queryAgentTreeRecursive(t,e,this.agentTree[o].left))}return e},t.prototype.queryObstacleTreeRecursive=function(t,e,o){if(null==o)return e;var i=o.obstacle,n=i.next,a=r.TPVP_RVOMath.leftOf(i.point,n.point,t.position_);return e=this.queryObstacleTreeRecursive(t,e,a>=0?o.left:o.right),r.TPVP_RVOMath.sqr(a)/r.TPVP_RVOMath.absSq(n.point.minus(i.point))<e&&(a<0&&t.insertObstacleNeighbor(o.obstacle,e),this.queryObstacleTreeRecursive(t,e,a>=0?o.right:o.left)),e},t.prototype.queryVisibilityRecursive=function(t,e,o,i){if(null==i)return!0;var n=i.obstacle,a=n.next,s=r.TPVP_RVOMath.leftOf(n.point,a.point,t),c=r.TPVP_RVOMath.leftOf(n.point,a.point,e),l=1/r.TPVP_RVOMath.absSq(a.point.minus(n.point));if(s>=0&&c>=0)return this.queryVisibilityRecursive(t,e,o,i.left)&&(r.TPVP_RVOMath.sqr(s)*l>=r.TPVP_RVOMath.sqr(o)&&r.TPVP_RVOMath.sqr(c)*l>=r.TPVP_RVOMath.sqr(o)||this.queryVisibilityRecursive(t,e,o,i.right));if(s<=0&&c<=0)return this.queryVisibilityRecursive(t,e,o,i.right)&&(r.TPVP_RVOMath.sqr(s)*l>=r.TPVP_RVOMath.sqr(o)&&r.TPVP_RVOMath.sqr(c)*l>=r.TPVP_RVOMath.sqr(o)||this.queryVisibilityRecursive(t,e,o,i.left));if(s>=0&&c<=0)return this.queryVisibilityRecursive(t,e,o,i.left)&&this.queryVisibilityRecursive(t,e,o,i.right);var p=r.TPVP_RVOMath.leftOf(t,e,n.point),u=r.TPVP_RVOMath.leftOf(t,e,a.point),d=1/r.TPVP_RVOMath.absSq(e.minus(t));return p*u>=0&&r.TPVP_RVOMath.sqr(p)*d>r.TPVP_RVOMath.sqr(o)&&r.TPVP_RVOMath.sqr(u)*d>r.TPVP_RVOMath.sqr(o)&&this.queryVisibilityRecursive(t,e,o,i.left)&&this.queryVisibilityRecursive(t,e,o,i.right)},t}();a.TPVP_KdTree=u,cc._RF.pop(),cc._RF.pop()},{}],TextConfig:[function(t,e,o){"use strict";cc._RF.push(e,"4eb3c5aX3BIkZX+n08lxsqT","TextConfig");var i=e,n=o;cc._RF.push(i,"4eb3c5aX3BIkZX+n08lxsqT","TextConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.TextConfig=void 0,function(t){t.Guide0="\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d",t.Guide1="\u52a0\u8f7d\u7528\u6237\u6570\u636e",t.Guide2="\u52a0\u8f7d\u8d44\u6e90",t.Guide3="\u8fdb\u5165\u4e2d...",t.SelectItem="\u8bf7\u9009\u62e9\u9053\u5177",t.No="\u7b2c{0}\u540d",t.Const="sfjsf",t.Guide01="\u5929\u547d\u4eba\uff0c\u4f60\u7ec8\u4e8e\u6765\u4e86\uff0c\u968f\u6211\u4e00\u8d77\u8e0f\u4e0a\u65c5\u9014\u5427\uff01",t.Guide02="\u8d2d\u4e70\u6218\u573a\u5185\u7684\u5361\u724c\u53ef\u4ee5\u6210\u4e3a\u4f60\u62b5\u5fa1\u602a\u7269\u7684\u52a9\u529b",t.Guide03="\u5f53\u7f81\u7eca\u91cc\u7684\u82f1\u96c4\u90fd\u767b\u573a\u540e\uff0c\u4f1a\u83b7\u5f97\u5f3a\u5927\u589e\u76ca",t.Guide04="\u5982\u679c\u8981\u4e0a\u573a\u591a\u4e2a\u82f1\u96c4\uff0c\u5219\u9700\u8981\u6269\u5efa\u82f1\u96c4\u680f\u4f4d",t.Guide05="\u5237\u65b0\u540e\uff0c\u53ef\u8d2d\u4e70\u5176\u4ed6\u82f1\u96c4\u6216\u540c\u4e2a\u82f1\u96c4\u8fdb\u884c\u5347\u7ea7",t.Guide06="\u767b\u573a\u5bf9\u5e94\u7f81\u7eca\u7684\u82f1\u96c4\uff0c\u53ef\u4ee5\u62e5\u6709\u5f3a\u529b\u7f81\u7eca\u6548\u679c",t.Guide09="\u73b0\u5728\u5c31\u968f\u672c\u4ed9\u5b50\u4e00\u8d77\u62b5\u5fa1\u602a\u7269\u5427",t.Guide07="\u66f4\u591a\u82f1\u96c4\uff0c\u7b49\u4f60\u89e3\u9501",t.Guide08="\u62bd\u5361\u53ef\u83b7\u5f97\u66f4\u591a\u82f1\u96c4\uff0c\u89e3\u9501\u7684\u540c\u65f6\u4e5f\u53ef\u5347\u7ea7",t.Tips01="\u5df2\u83b7\u5f97\u5956\u52b1~",t.Tips02="\u4eca\u65e5\u6b21\u6570\u5df2\u7528\u5b8c",t.Tips03="{0}\u4e0d\u8db3",t.Tips04="\u4eca\u65e5\u5269\u4f59\u6b21\u6570\uff1a{0}\u6b21",t.Tips05="\u91d1\u5e01\u4e0d\u8db3",t.Tips06="\u6682\u672a\u89e3\u9501",t.Tips07="\u5347\u7ea7\u6210\u529f",t.Tips08="\u5347\u7ea7\u6210\u529f\uff0c\u6280\u80fd\u589e\u5f3a",t.Tips10="\u4f4d\u7f6e\u4e0d\u8db3\uff0c\u8bf7\u5148\u6269\u5efa",t.Tips11="\u4e0a\u9635\u82f1\u96c4\u5df2\u8fbe\u5230\u4e0a\u9650",t.Tips12="\u94f6\u5e01\u4e0d\u8db3",t.Tips13="\u5361\u724c\u5df2\u6ee1\u7ea7",t.Tips15="\u6311\u6218\u6b21\u6570\u4e0d\u8db3",t.Tips16="\u901a\u5173\u7b2c{0}\u7ae0\u89e3\u9501",t.Tips17="\u5148\u89e3\u9501\u524d\u9762",t.Tips18="\u626b\u8361\u6b21\u6570\u5df2\u7528\u5b8c",t.Tips19="\u7b2c{0}\u7ae0\u89e3\u9501",t.Text01="\u7b2c{0}\u5929",t.Text02="\u6700\u9ad8\u8bb0\u5f55\uff1a\u7b2c{0}\u6ce2",t.Text03="\u5df2\u6fc0\u6d3b",t.Text04="\u672a\u6fc0\u6d3b",t.Text05="\u5df2\u9886\u53d6",t.Text06="\u6682\u672a\u8fbe\u5230",t.Text10="\u672a\u89e3\u9501",t.Text11="\u788e\u7247\u4e0d\u8db3",t.Text12="\u4e3b\u52a8\u6280\u80fd",t.Text13="\u6218\u6597\u5185\u8fbe\u5230\u4e09\u661f\u89e3\u9501",t.Text14="\u6218\u6597\u5185\u8fbe\u5230\u4e94\u661f\u89e3\u9501",t.Text15="Lv.{0}\u89e3\u9501",t.Text16="\u4e3b\u52a8\u6280\u80fd",t.Text17="\u4e09\u661f\u88ab\u52a8",t.Text18="\u4e94\u661f\u88ab\u52a8",t.Text19="\u901a\u5173\u7b2c{0}\u5173\u89e3\u9501",t.Text20="{0}\u4e0d\u8db3",t.Text21="\u514d\u8d39\u83b7\u53d6{0}",t.Text25="\u4eca\u65e5\u5269\u4f59\u6311\u6218\u6b21\u6570\uff1a{0}/{1}",t.Text30="\u5df2\u9886\u53d6",t.Text31="\u6682\u672a\u8fbe\u5230",t.Text32="\u626b\u8361{0}/{1}",t.Task1="\u7d2f\u8ba1\u767b\u5f55<color=#2056ea>{0}</c>\u5929",t.Task2="\u7d2f\u8ba1\u5b8c\u6210<color=#2056ea>{0}</c>\u4e2a\u65e5\u5e38\u4efb\u52a1",t.Task3="\u7d2f\u8ba1\u6311\u6218<color=#2056ea>{0}</c>\u4e3b\u7ebf\u526f\u672c",t.Task4="\u901a\u5173\u7b2c<color=#2056ea>{0}</c>\u7ae0",t.Task5="\u62e5\u6709<color=#2056ea>{0}</c>\u540d\u82f1\u96c4",t.Task6="\u7d2f\u8ba1\u5347\u7ea7<color=#2056ea>{0}</c>\u6b21\u82f1\u96c4",t.Task7="\u7d2f\u8ba1\u6311\u6218<color=#2056ea>{0}</c>\u6b21\u65e5\u5e38\u526f\u672c",t.Task8="\u7d2f\u8ba1\u62db\u52df<color=#2056ea>{0}</c>\u6b21",t.Task9="\u7d2f\u8ba1\u83b7\u5f97<color=#2056ea>{0}</c>\u91d1\u5e01",t.Task10="\u7d2f\u8ba1\u51fb\u6740<color=#2056ea>{0}</c>\u540d\u654c\u4eba",t.Task11="\u7d2f\u8ba1\u8d2d\u4e70<color=#2056ea>{0}</c>\u6b21\u82f1\u96c4",t.Task12="\u7d2f\u8ba1\u83b7\u5f97<color=#2056ea>{0}</c>\u94f6\u5e01",t.Task13="\u7d2f\u8ba1\u5237\u65b0<color=#2056ea>{0}</c>\u6b21",t.Task14="\u7d2f\u8ba1\u89c2\u770b<color=#2056ea>{0}</c>\u6b21\u89c6\u9891",t.Game01="\u7b2c{0}/{1}\u6ce2",t.Game02="\u7b2c{0}\u6ce2",t.Game03="\u6fc0\u6d3b"}(n.TextConfig||(n.TextConfig={})),cc._RF.pop(),cc._RF.pop()},{}],TileCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"a96f0aU2ptIEYq2yqIEVEAk","TileCtrl");var i=t,n=e,a=o;cc._RF.push(n,"a96f0aU2ptIEYq2yqIEVEAk","TileCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("MapCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.treePrefab=null,e.treeNodes=[],e.treePool=new cc.NodePool,e.tileX=0,e.tileY=0,e.gridSize=100,e.PanTNum=20,e.TinTNum=20,e.isVisible=!1,e.isTileInitialized=!1,e.maskRects=[],e.generateTreesCallback=null,e}var o;return s(e,t),o=e,e.prototype.isInMask=function(t,e){return this.maskRects.some(function(o){return t>=o.x&&t<=o.x+o.width&&e>=o.y&&e<=o.y+o.height})},e.prototype.onLoad=function(){o.instance=this,this.node.getChildByName("bg").zIndex=-999},e.prototype.resetTileAsync=function(t,e){var o=this;if(this.unschedule(this.generateTreesCallback),this.tileX===t&&this.tileY===e&&this.isTileInitialized)this.isVisible=!0;else{this.tileX=t,this.tileY=e,this.isTileInitialized=!1,this.isVisible=!0,this.treeNodes.forEach(function(t){return o.treePool.put(t)}),this.treeNodes=[];var i=function(t){var e=1e4*Math.abs(Math.sin(t+1));return function(){return(e=1e4*Math.sin(e+1))-Math.floor(e)}}(2025*t^806*e);this.initGrid();var n=Math.floor(i()*this.PanTNum)+this.TinTNum,a=0;this.generateTreesCallback=function(){if(a>=n)return o.unschedule(o.generateTreesCallback),void(o.isTileInitialized=!0);for(var t=0;a<n&&t<10;){var e=o.getRandomGridPosition(i);e?(o.createTreeAt(e.x,e.y),a++,t++):a++}},this.schedule(this.generateTreesCallback,0)}},e.prototype.initGrid=function(){this.gridCols=Math.floor(this.node.width/this.gridSize),this.gridRows=Math.floor(this.node.height/this.gridSize),this.gridMap=[];for(var t=0;t<this.gridCols;t++){this.gridMap[t]=[];for(var e=0;e<this.gridRows;e++)this.gridMap[t][e]=!1}},e.prototype.getRandomGridPosition=function(t){for(var e=[],o=0;o<this.gridCols;o++)for(var i=0;i<this.gridRows;i++)if(!this.gridMap[o][i]){var n=o*this.gridSize-this.node.width/2+this.gridSize/2,a=i*this.gridSize-this.node.height/2+this.gridSize/2;if(this.isInMask(n,a))continue;e.push({col:o,row:i})}if(0===e.length)return null;var r=e[Math.floor(t()*e.length)];this.gridMap[r.col][r.row]=!0;var s=.2*(t()-.5)*this.gridSize,c=.2*(t()-.5)*this.gridSize;return{x:r.col*this.gridSize-this.node.width/2+this.gridSize/2+s,y:r.row*this.gridSize-this.node.height/2+this.gridSize/2+c}},e.prototype.createTreeAt=function(t,e){var o=this.treePool.size()>0?this.treePool.get():cc.instantiate(this.treePrefab),i=l.default.instance.treesRoot;o.setParent(i);var n=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),a=i.convertToNodeSpaceAR(n);o.setPosition(a.x+t,a.y+e),o.zIndex=Math.floor(1e4-o.y),this.treeNodes.push(o)},e.prototype.getTreesNearPlayer=function(t,e){void 0===e&&(e=500);for(var o=[],i=0,n=this.treeNodes;i<n.length;i++){var a=n[i],r=a.convertToWorldSpaceAR(cc.Vec3.ZERO);t.sub(r).magSqr()<=e*e&&o.push(a)}return o},e.prototype.onDestroy=function(){this.treePool.clear()},c([d(cc.Prefab)],e.prototype,"treePrefab",void 0),o=c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],TileManager:[function(t,e,o){"use strict";cc._RF.push(e,"95853PqFz5KWpzXRnShN4+y","TileManager");var i=e,n=o;cc._RF.push(i,"95853PqFz5KWpzXRnShN4+y","TileManager");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapPrefab=null,e.mapRoot=null,e.treePrefab=null,e.baseWidth=0,e.baseHeight=0,e.maxTileCount=13,e.tilePool=[],e.activeTiles=new Map,e.directions=[{x:0,y:0},{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}],e}return r(e,t),e.prototype.onLoad=function(){this.baseWidth=Math.floor(cc.winSize.width),this.baseHeight=Math.floor(cc.winSize.height),this.initTilePool()},e.prototype.initTilePool=function(){for(var t=0;t<this.maxTileCount;t++){var e=cc.instantiate(this.mapPrefab);e.width=this.baseWidth,e.height=this.baseHeight,e.getComponent("TileCtrl").treePrefab=this.treePrefab,e.name="Tile_"+t,e.active=!1,this.tilePool.push(e)}console.log(" TilePool \u521d\u59cb\u5316\u5b8c\u6210, \u603b\u6570: "+this.tilePool.length)},e.prototype.getAvailableTile=function(){if(this.tilePool.length>0)return this.tilePool.pop();var t=this.activeTiles.keys().next().value;if(void 0!==t){var e=this.activeTiles.get(t);return this.activeTiles.delete(t),console.warn("\u56de\u6536\u6700\u65e7Tile: "+t),e}return console.error(" \u6ca1\u6709\u53ef\u7528\u7684 Tile\uff0c\u521b\u5efa\u65b0\u7684\uff08\u8017\u6027\u80fd\uff09"),cc.instantiate(this.mapPrefab)},e.prototype.activateTile=function(t,e){var o=t+"_"+e;if(!this.activeTiles.has(o)){var i=this.getAvailableTile();i.setParent(this.mapRoot),i.active=!0,i.setPosition(t*this.baseWidth,e*this.baseHeight),i.name="Tile_"+t+"_"+e,i.getComponent("TileCtrl").resetTileAsync(t,e),this.activeTiles.set(o,i),console.log("\u6fc0\u6d3bTile: "+o)}},e.prototype.updateTiles=function(t,e){for(var o=new Set,i=0,n=this.directions;i<n.length;i++){var a=n[i],r=t+a.x,s=e+a.y,c=r+"_"+s;o.add(c),this.activateTile(r,s)}this.recycleTiles(o)},e.prototype.recycleTiles=function(t){var e=this,o=[];this.activeTiles.forEach(function(i,n){t.has(n)||(e.scheduleOnce(function(){i.active=!1,i.setParent(null),e.tilePool.push(i),console.log("\u5ef6\u8fdf\u56de\u6536Tile: "+n)},.1),o.push(n))}),o.forEach(function(t){e.activeTiles.delete(t)}),console.log("\u5f53\u524d\u6d3b\u8dc3Tiles: "+this.activeTiles.size+", Pool\u5269\u4f59: "+this.tilePool.length)},e.prototype.getNearTiles=function(){var t=[];return this.activeTiles.forEach(function(e){t.push(e)}),t},e.prototype.clearAllTiles=function(){var t=this;this.activeTiles.forEach(function(e){e.active=!1,e.setParent(null),t.tilePool.push(e)}),this.activeTiles.clear(),console.log("\u6e05\u9664\u5168\u90e8Tile")},s([p(cc.Prefab)],e.prototype,"mapPrefab",void 0),s([p(cc.Node)],e.prototype,"mapRoot",void 0),s([p(cc.Prefab)],e.prototype,"treePrefab",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],TimeUtils:[function(t,e,o){"use strict";cc._RF.push(e,"cae10zFespM0axe3QtxMfqW","TimeUtils");var i=e,n=o;cc._RF.push(i,"cae10zFespM0axe3QtxMfqW","TimeUtils"),Object.defineProperty(n,"__esModule",{value:!0}),n.TimeUtils=void 0;var a=function(){function t(){}return t.GetTimeBySecond=function(){var t=new Date;return Math.floor(t.getTime()/1e3)},t.GetTimeByHours=function(){var t=new Date,e=t.getHours(),o=Math.floor(e/10).toString()+e%10,i=t.getMinutes();return o+":"+(Math.floor(i/10).toString()+i%10)},t.SecondToHours=function(t){var e=t%60;e=Math.floor(e/10).toString()+e%10;var o=Math.floor(t/60)%60;o=Math.floor(o/10).toString()+o%10;var i=Math.floor(t/60/60);return(i=Math.floor(i/10).toString()+i%10)+":"+o+":"+e},t.FormatDate2=function(t){var e=new Date(t),o=10>e.getMonth()+1?"0"+(e.getMonth()+1):e.getMonth()+1,i=10>e.getDate()?"0"+e.getDate():e.getDate();return e.getFullYear()+"-"+o+"-"+i},t.FormatDate1=function(t,e){void 0===e&&(e="/");var o=new Date(t);return o.getFullYear()+e+(o.getUTCMonth()+1)+e+o.getUTCDate()},t.BeforeTime=function(t){if(null==t)return"";var e=new Date,o=Math.floor(e.getTime()/1e3)-t;return o<=0&&(o=1),Math.floor(o/60/60/24)>0?Math.floor(o/60/60/24)+"\u5929\u524d":Math.floor(o/60/60)>0?Math.floor(o/60/60)+"\u5c0f\u65f6\u524d":Math.floor(o/60)>0?Math.floor(o/60)+"\u5206\u949f\u524d":Math.floor(o)+"\u79d2\u524d"},t.compareIsToday=function(t){var e=new Date(1e3*t),o=e.getFullYear(),i=e.getUTCMonth(),n=e.getUTCDay(),a=new Date(1e3*this.GetTimeBySecond()),r=a.getFullYear(),s=a.getUTCMonth(),c=a.getUTCDay();return o==r&&i==s&&n==c},t.overDay=function(t){var e=new Date(t),o=new Date(this.dayStart());return Math.floor((o.getTime()-e.getTime())/864e5)},t.getMothTotalDay=function(t){var e=30;return 2==t?e=28:1!=t&&3!=t&&5!=t&&7!=t&&8!=t&&10!=t&&12!=t||(e=31),e},t.dayStart=function(){return new Date((new Date).setHours(0,0,0,0)).getTime()},t.dayEnd=function(){return new Date((new Date).setHours(23,59,59,0)).getTime()},t.getDiffHours=function(t){return(new Date).getHours()-new Date(1e3*t).getHours()},t.getSplaceTime=function(t,e){var o=new Date;return o.getHours()>=t?o.setHours(t+24):o.setHours(t),o.setMinutes(e),o.setSeconds(0),Number((o.getTime()/1e3).toFixed(0))},t.isLastDayOfMonth=function(t){var e=!1,o=new Date(t),i=o.getFullYear(),n=o.getMonth()+1,a=o.getDate(),r=i,s=n++;n>12&&(s-=12,r++);var c=new Date(r,s,1);return a==new Date(c.getTime()-864e5).getDate()&&(e=!0),e},t}();n.TimeUtils=a,cc._RF.pop(),cc._RF.pop()},{}],TranstaLabel:[function(t,e,o){"use strict";cc._RF.push(e,"67db1C8o05AUKGTeZFpIrDv","TranstaLabel");var i=t,n=e,a=o;cc._RF.push(n,"67db1C8o05AUKGTeZFpIrDv","TranstaLabel");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("LanguageMgr"),p=cc._decorator,u=p.ccclass,d=(p.property,p.menu),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.onLoad=function(){var t=this.node.getComponent(cc.Label);if(t)t.string=l.LanguageMgr.getInstance().T(t.string);else{var e=this.node.getComponent(cc.RichText);e&&(e.string=l.LanguageMgr.getInstance().T(e.string))}},e.prototype.refresh=function(){var t=this.node.getComponent(cc.Label);if(t)t.string=l.LanguageMgr.getInstance().T(t.string);else{var e=this.node.getComponent(cc.RichText);e&&(e.string=l.LanguageMgr.getInstance().T(e.string))}},c([u,d("\u591a\u8bed\u8a00/TranstLabel")],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],TranstanImg:[function(t,e,o){"use strict";cc._RF.push(e,"5bc64LzzcZE9b4RqZBUBYjc","TranstanImg");var i=t,n=e,a=o;cc._RF.push(n,"5bc64LzzcZE9b4RqZBUBYjc","TranstanImg");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Appcfg"),p=i("LanguageMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=u.menu,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.en=null,e.jp=null,e.fz=null,e}return s(e,t),e.prototype.start=function(){this.en&&(this.en.active=!1),this.jp&&(this.jp.active=!1),this.fz&&(this.fz.active=!1);var t=this.node.getComponent(cc.Sprite);p.LanguageMgr.getInstance().getCurrentLanguage()==l.LanguageType.en?(this.en.active=!0,t&&(t.spriteFrame=null)):p.LanguageMgr.getInstance().getCurrentLanguage()==l.LanguageType.jp?(this.jp.active=!0,t&&(t.spriteFrame=null)):p.LanguageMgr.getInstance().getCurrentLanguage()==l.LanguageType.zh_tw&&this.fz&&t&&(this.fz.active=!0,t.spriteFrame=null)},c([h({type:cc.Node,tooltip:"\u82f1\u6587"})],e.prototype,"en",void 0),c([h({type:cc.Node,tooltip:"\u65e5\u8bed"})],e.prototype,"jp",void 0),c([h({type:cc.Node,tooltip:"\u7e41\u4f53"})],e.prototype,"fz",void 0),c([d,f("\u591a\u8bed\u8a00/TranstanImg")],e)}(cc.Component);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],TreeCtrlWithQ:[function(t,e,o){"use strict";cc._RF.push(e,"5ef182LR4tOQ7X+w/Icb5NR","TreeCtrlWithQ");var i=t,n=e,a=o;cc._RF.push(n,"5ef182LR4tOQ7X+w/Icb5NR","TreeCtrlWithQ");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("QuadTree"),p=i("RoleCtrl"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.treePrefab=null,e.mapNode=null,e.chunkSize=1e3,e.treeCountPerChunk=100,e._existCache=new Map,e._pool=new cc.NodePool,e.chunkMap=new Map,e.uniqueId=0,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this;for(var t=0;t<200;t++){var e=cc.instantiate(this.treePrefab);this._pool.put(e)}},e.prototype.start=function(){if(this.quadTree=new l.Quadtree(this.mapNode.getBoundingBox(),4),p.default.instance){var t=p.default.instance.body.getPosition(),e=Math.floor(t.x/this.chunkSize),o=Math.floor(t.y/this.chunkSize);this.loadNearbyChunks(e,o),this.refreshView(),this.schedule(this.updateChunks,.2)}else console.error("\u89d2\u8272\u6ca1\u52a0\u8f7d\u597d\uff01")},e.prototype.updateChunks=function(){if(p.default.instance){var t=p.default.instance.body.getPosition(),e=Math.floor(t.x/this.chunkSize),o=Math.floor(t.y/this.chunkSize);this.loadNearbyChunks(e,o),this.clearFarChunks(e,o),this.refreshView()}},e.prototype.loadNearbyChunks=function(t,e){for(var o=t-1;o<=t+1;o++)for(var i=e-1;i<=e+1;i++){var n=o+"_"+i;this.chunkMap.has(n)||this.generateChunk(o,i)}},e.prototype.generateChunk=function(t,e){for(var o=t+"_"+e,i=[],n=0;n<this.treeCountPerChunk;n++){var a=t*this.chunkSize+Math.random()*this.chunkSize,r=e*this.chunkSize+Math.random()*this.chunkSize,s={id:this.getUniqueId(),x:a,y:r,width:50,height:50};this.quadTree.insert(s),i.push(s)}var c={chunkX:t,chunkY:e,trees:i};this.chunkMap.set(o,c)},e.prototype.clearFarChunks=function(t,e){var o=this,i=[];this.chunkMap.forEach(function(n,a){var r=Math.abs(n.chunkX-t),s=Math.abs(n.chunkY-e);(r>1||s>1)&&(n.trees.forEach(function(t){o.quadTree.remove(t);var e=o._existCache.get(t.id);e&&(o.putItem(e),o._existCache.delete(t.id))}),i.push(a))}),i.forEach(function(t){return o.chunkMap.delete(t)})},e.prototype.refreshView=function(){var t=this,e=p.default.instance.body.convertToWorldSpaceAR(cc.Vec2.ZERO),o=cc.winSize.width,i=cc.winSize.height,n=new cc.Rect(e.x-o/2,e.y-i/2,o,i),a=this.quadTree.retrieve(n),r=new Set(a.map(function(t){return t.id}));this._existCache.forEach(function(e,o){r.has(o)||(t.putItem(e),t._existCache.delete(o))}),a.forEach(function(e){var o=e;if(!t._existCache.has(o.id)){var i=t.getItem();i.setPosition(o.x,o.y),t.mapNode.addChild(i),i.zIndex=o.id,t._existCache.set(o.id,i)}})},e.prototype.getItem=function(){return this._pool.size()>0?this._pool.get():cc.instantiate(this.treePrefab)},e.prototype.putItem=function(t){t&&(t.removeFromParent(),this._pool.put(t))},e.prototype.getUniqueId=function(){return this.uniqueId++},c([h(cc.Prefab)],e.prototype,"treePrefab",void 0),c([h(cc.Node)],e.prototype,"mapNode",void 0),c([h],e.prototype,"chunkSize",void 0),c([h],e.prototype,"treeCountPerChunk",void 0),o=c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],TreeCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"fb5aaJO9qtDWa6x0fS356dt","TreeCtrl");var i=t,n=e,a=o;cc._RF.push(n,"fb5aaJO9qtDWa6x0fS356dt","TreeCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("QuadTree"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.treePrefab=null,e.maskNode=null,e.space=null,e.xSpacing=200,e.ySpacing=200,e.rows=20,e.cols=20,e._existCache=null,e._pool=null,e.placedTrees=[],e.treesZ=1,e._lastObjs=[],e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){o.instance=this,this._pool=new cc.NodePool,this._existCache={}},e.prototype.start=function(){var t=this.maskNode.getBoundingBox();this.quadTree=new l.Quadtree(t,4),this.placeTrees()},e.prototype.placeTrees=function(){for(var t=this.node.getBoundingBox(),e=this.maskNode.getBoundingBox(),o=t.xMin,i=t.yMax,n=0;n<this.rows;n++)for(var a=0;a<this.cols;a++){var r=o+a*this.xSpacing,s=i-n*this.ySpacing;if(!e.contains(cc.v2(r,s))){var c=cc.instantiate(this.treePrefab);c.setPosition(r,s),this.node.addChild(c),c.name="tree_"+n+"_"+a,this.insert(c,a)}}},e.prototype.insert=function(t,e){var o={id:e,x:t.position.x,y:t.position.y,width:1,height:1,node:t};this.quadTree.insert(o)},e.prototype.refreshView=function(){var t=this,e=[],o=this.space.position;e=this.quadTree.retrieve({x:o.x,y:o.y,width:this.space.width,height:this.space.height});var i=new cc.Rect(o.x,o.y,this.space.width,this.space.height);console.log(i),this._lastObjs.filter(function(t){return-1===e.indexOf(t)}).forEach(function(e){var o=t._existCache[e.id];o&&t.putItem(o)});for(var n=e.filter(function(e){return-1===t._lastObjs.indexOf(e)}),a=0,r=n.length;a<r;a++){var s=n[a];if(s){var c=this.getItem();c.parent=this.node,c.setPosition(s.x,s.y),c.width=s.width,c.height=s.height,this._existCache[null==s?void 0:s.id]=c}}this._lastObjs=e},e.prototype.getItem=function(){return 0===this._pool.size()?cc.instantiate(this.treePrefab):this._pool.get()},e.prototype.putItem=function(t){t&&(t.removeFromParent(),this._pool.put(t))},e.prototype.getMonsterLayer=function(){return this.node.children},e.prototype.moveTreePan=function(t){this.space.setPosition(t)},c([d(cc.Prefab)],e.prototype,"treePrefab",void 0),c([d(cc.Node)],e.prototype,"maskNode",void 0),c([d(cc.Node)],e.prototype,"space",void 0),c([d],e.prototype,"xSpacing",void 0),c([d],e.prototype,"ySpacing",void 0),c([d],e.prototype,"rows",void 0),c([d],e.prototype,"cols",void 0),o=c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],Tree:[function(t,e,o){"use strict";cc._RF.push(e,"e3bb1GxW6BA9ZinCrkZ0dWP","Tree");var i=t,n=e,a=o;cc._RF.push(n,"e3bb1GxW6BA9ZinCrkZ0dWP","Tree");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("RSDGameEnumData"),u=i("RSD_DataMgr"),d=i("GameSpawnCtrl"),h=i("RoleCtrl"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.expNode=null,e.hitCnt=0,e.cutDownNum=5,e.expBallNum=10,e.level=1,e.treeExpCfg=[],e.treeDurCfg=[],e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){this.treeExpCfg=u.default.getInstance().getParam(p.enumBasicParaCfg.treeExperiences).split(","),this.treeDurCfg=u.default.getInstance().getParam(p.enumBasicParaCfg.treeDurability).split(","),this.initParamByLevel()},e.prototype.start=function(){o.instance=this},e.prototype.initParamByLevel=function(){this.expBallNum=Number(this.treeExpCfg[this.level-1]),this.cutDownNum=Number(this.treeDurCfg[this.level-1])},e.prototype.resetLevel=function(t){this.level=t},e.prototype.hit=function(t){var e=this;this.hitCnt++,this.hitCnt>=this.cutDownNum&&(this.cutEnd(t),this.hitCnt=0),cc.tween(this.node).to(.15,{scale:1.2,color:cc.color(255,105,105,255)}).call(function(){cc.tween(e.node).to(.15,{scale:1,color:cc.color(255,255,105,255)}).call(function(){}).start()}).start()},e.prototype.cutEnd=function(t){d.default.instance.treeDown(t),this.flyIcon({pNode:this.node.parent,tempNode:this.expNode,flyCount:this.expBallNum,swPos:this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),ewPos:h.default.instance.node.convertToWorldSpaceAR(cc.Vec2.ZERO)})},e.prototype.flyIcon=function(t){if(t){var e=t.pNode,o=t.scale||1,i=e.convertToNodeSpaceAR(t.swPos),n=e.convertToNodeSpaceAR(t.ewPos),a=t.flyCount||10;if(1==a){var r;if(t.tempNode?r=cc.instantiate(t.tempNode):t.poolKey&&(r=l.PoolMgr.getInstance().getNode(t.poolKey)),!r)return;r.active=!0,r.scale=0,r.setPosition(i),r.parent=e,cc.v2(.5*(n.x+i.x),n.y*(2+Math.random())),cc.tween(r).to(.05,{scale:o}).to(.5,{x:n.x,y:n.y}).call(function(){t.poolKey?l.PoolMgr.getInstance().freeNode(t.poolKey,r):(r.active=!1,r.destroy()),t.callBack&&t.callBack(!0)}).start()}else for(var s=function(r){var s;if(t.tempNode?s=cc.instantiate(t.tempNode):t.poolKey&&(s=l.PoolMgr.getInstance().getNode(t.poolKey)),!s)return{value:void 0};s.active=!0,s.scale=o,s.setPosition(i),s.parent=e;var c=360*Math.random()*Math.PI/180,p=100*Math.cos(c),u=100*Math.sin(c);cc.tween(s).to(.1,{x:s.x+p,y:s.y+u},{easing:"sineOut"}).delay(.05*r).to(.5,{x:n.x,y:n.y}).call(function(){t.poolKey?l.PoolMgr.getInstance().freeNode(t.poolKey,s):(s.active=!1,s.destroy(),h.default.instance.levelUP()),t.callBack&&t.callBack(r==a-1)}).start()},c=0;c<a;c++){var p=s(c);if("object"==typeof p)return p.value}}},c([g(cc.Node)],e.prototype,"expNode",void 0),o=c([m],e)}(cc.Component);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],TweenMgr:[function(t,e,o){"use strict";cc._RF.push(e,"e0af6vJW8VNUp73n+Lz+E7o","TweenMgr");var i=e,n=o;cc._RF.push(i,"e0af6vJW8VNUp73n+Lz+E7o","TweenMgr"),Object.defineProperty(n,"__esModule",{value:!0}),n.TweenMgr=void 0;var a=function(){function t(){this.twenMap=new Map}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.getTween=function(t){this.twenMap.has(t.uuid)&&this.stopTween(t);var e=cc.tween(t);return this.twenMap.set(t.uuid,e),e},t.prototype.stopTween=function(t){this.twenMap.has(t.uuid)&&(this.twenMap.get(t.uuid).stop(),this.twenMap.delete(t.uuid))},t.prototype.playHeartAni=function(t){var e=this.getTween(t);this.heartani(e)},t.prototype.heartani=function(t){t.to(.3,{scale:1.04}).to(.2,{scale:.98}).delay(.4).to(.1,{scale:1.05}).to(.2,{scale:.95}).union().repeatForever().start()},t.prototype.popOpenAin=function(t,e){t.to(.1,{scale:.9}).to(.05,{scale:1.1}).to(.1,{scale:1}).call(function(){e&&e()}).start()},t.prototype.popCloseAin=function(t,e){t.stop(),t.to(.1,{scale:0}).call(function(){e&&e()}).start()},t.prototype.stampAni=function(t){t.scale=t.scale+1,cc.tween(t).to(.2,{scale:1}).start()},t.prototype.anglesAni=function(t,e){void 0===e&&(e=1);var o=this.getTween(t);o.by(.5,{angle:20}).by(.5,{angle:-20}).delay(.5).by(.2,{angle:10}).by(.2,{angle:-10}).delay(.1).union(),-1==e?o.repeatForever():o.repeat(e),o.start()},t.prototype.jumpAniForever=function(t,e){void 0===e&&(e=.2);var o=this.getTween(t);o.by(.2,{position:new cc.Vec3(0,-10,0)}).by(.2,{position:new cc.Vec3(0,10,0)}).delay(e).union().repeatForever(),o.start()},t.prototype.sharkAni=function(t,e){void 0===e&&(e=1);var o=this.getTween(t);o.by(.01,{position:new cc.Vec3(2,2,0)}).by(.01,{position:new cc.Vec3(-2,-2,0)}).union(),-1==e?o.repeatForever():o.repeat(e),o.start()},t}();n.TweenMgr=a,cc._RF.pop(),cc._RF.pop()},{}],UIAchieveBox:[function(t,e,o){"use strict";cc._RF.push(e,"a1044SSkXhOiKYa2spabTSm","UIAchieveBox");var i=t,n=e,a=o;cc._RF.push(n,"a1044SSkXhOiKYa2spabTSm","UIAchieveBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("List"),u=i("TextConfig"),d=i("BraveTowerEnum"),h=i("ItemGood"),f=i("DataMgr"),m=i("PlayerMgr"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listTask=null,e.btnClose=null,e.cfgList=[],e.getList=[],e}return s(e,t),e.prototype.start=function(){this.initBtnListener(),this.listTask.tmpNode.active=!1,this.initData()},e.prototype.initBtnListener=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this)},e.prototype.initData=function(){this.cfgList=f.DataMgr.getInstance().getAchieveTreasureChestList(),this.getList=m.PlayerMgr.getInstance().getTaskData().getAchieveGetList(),this.achievePoint=m.PlayerMgr.getInstance().getTaskData().getAchievePoint(),this.listTask.numItems=this.cfgList.length;for(var t=0,e=0;e<this.cfgList.length&&!(this.cfgList[e].NeedAchieveNum>this.achievePoint)&&(t=e,this.getList[e]);e++);this.listTask.scrollTo(t)},e.prototype.initListItem=function(t,e){var o=this;t.active=!0;var i=this.cfgList[e];t.getChildByName("labNum").getComponent(cc.Label).string=d.BraveTowerGameUtils.numberFomat(i.NeedAchieveNum);var n=t.getChildByName("ItemGood").getComponent(h.default);n.initView(i.Reward[0],i.Reward[1],!1);var a=t.getChildByName("ndGet"),r=t.getChildByName("btnGet");r.off(cc.Node.EventType.TOUCH_END),1==this.getList[e]?(a.active=!0,a.getComponent(cc.Label).string=this.T(u.TextConfig.Text05),r.active=!1):this.achievePoint>=i.NeedAchieveNum?(a.active=!1,r.active=!0,r.on(cc.Node.EventType.TOUCH_END,function(){var a=m.PlayerMgr.getInstance().onRewardToStr([{id:i.Reward[0],num:i.Reward[1]}]),r=t.convertToWorldSpaceAR(n.node.position);m.PlayerMgr.getInstance().addRewards(a,1,r),m.PlayerMgr.getInstance().getTaskData().addAchieveGet(e),o.getList=m.PlayerMgr.getInstance().getTaskData().getAchieveGetList(),o.listTask.updateItem(e),o.sendEvent(d.BraveTowerEventName.UpdateFuncRedPoint)},this)):(a.active=!0,a.getComponent(cc.Label).string=this.T(u.TextConfig.Text06),r.active=!1)},c([v({type:p.default,tooltip:"\u4efb\u52a1"})],e.prototype,"listTask",void 0),c([v({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],UIAddCoin:[function(t,e,o){"use strict";cc._RF.push(e,"401df3aRJ1Oco5YHcv15wlR","UIAddCoin");var i=t,n=e,a=o;cc._RF.push(n,"401df3aRJ1Oco5YHcv15wlR","UIAddCoin");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("SdkMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnBreak=null,e.btnGet=null,e}return s(e,t),e.prototype.init=function(t){this.call=t},e.prototype.start=function(){this.initBtnListener()},e.prototype.initData=function(){},e.prototype.initBtnListener=function(){var t=this;this.btnBreak.on(cc.Node.EventType.TOUCH_END,function(){t.call&&t.call(!1),t.closeUI()},this),this.btnGet.on(cc.Node.EventType.TOUCH_END,function(){p.SdkMgr.getInstance().playVideo(p.AdType.AdFreeTime,function(){t.call&&t.call(!0),t.closeUI()})},this)},c([h({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnBreak",void 0),c([h({type:cc.Node,tooltip:"\u89c6\u9891"})],e.prototype,"btnGet",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],UIAddGold:[function(t,e,o){"use strict";cc._RF.push(e,"25bb8ou7hRP2bsautFuzndW","UIAddGold");var i=t,n=e,a=o;cc._RF.push(n,"25bb8ou7hRP2bsautFuzndW","UIAddGold");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("SdkMgr"),u=i("Utils"),d=i("TextConfig"),h=i("ItemGood"),f=i("DataMgr"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndItemGood=null,e.labTitle1=null,e.labTitle2=null,e.btnBreak=null,e.btnGet=null,e}return s(e,t),e.prototype.init=function(t,e,o){this.type=t,this.num=e,this.call=o,this.initView()},e.prototype.start=function(){this.initBtnListener()},e.prototype.initData=function(){},e.prototype.initBtnListener=function(){var t=this;this.btnBreak.on(cc.Node.EventType.TOUCH_END,function(){t.call&&t.call(!1),t.closeUI()},this),this.btnGet.on(cc.Node.EventType.TOUCH_END,function(){p.SdkMgr.getInstance().playVideo(p.AdType.AdFreeTime,function(){t.call&&t.call(!0),t.closeUI()})},this)},e.prototype.initView=function(){this.ndItemGood.initView(this.type,this.num);var t=f.DataMgr.getInstance().getGoodsCfgById(this.type);this.labTitle1.string=u.Utils.StringFormat(this.T(d.TextConfig.Text20),this.T(t.name)),this.labTitle2.string=u.Utils.StringFormat(this.T(d.TextConfig.Text21),this.T(t.name))},c([y({type:h.default,tooltip:""})],e.prototype,"ndItemGood",void 0),c([y({type:cc.Label,tooltip:""})],e.prototype,"labTitle1",void 0),c([y({type:cc.Label,tooltip:""})],e.prototype,"labTitle2",void 0),c([y({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnBreak",void 0),c([y({type:cc.Node,tooltip:"\u89c6\u9891"})],e.prototype,"btnGet",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],UICardInfo:[function(t,e,o){"use strict";cc._RF.push(e,"f3197nA2I1NLa06wx4B2KDB","UICardInfo");var i=t,n=e,a=o;cc._RF.push(n,"f3197nA2I1NLa06wx4B2KDB","UICardInfo");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("BaseUI"),u=i("List"),d=i("AudioMgr"),h=i("UIMgr"),f=i("Utils"),m=i("Config"),g=i("TextConfig"),y=i("BraveTowerEnum"),v=i("GameTrackDataEvent"),_=i("GameEnumData"),b=i("DataMgr"),B=i("PlayerMgr"),I=cc._decorator,P=I.ccclass,C=I.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.togCon=null,e.ndInfo=null,e.ndLevel=null,e.ndSkill=null,e.listSkill=null,e.ndAwak=null,e.listAwak=null,e.btnUpgrade=null,e.btnLock=null,e.btnClose=null,e.tag="Toggle1",e.skillList=[],e.awakList=[],e}return s(e,t),e.prototype.init=function(t){this.cardInfo=t},e.prototype.start=function(){this.initBtnListener(),this.initData(),this.initInfo(),this.initLevelView(),this.listSkill.tmpNode.active=!1,this.listAwak.tmpNode.active=!1},e.prototype.initData=function(){var t=this;this.tiesInfoList=[];for(var e=b.DataMgr.getInstance().getTiesCfgList(),o=0;o<e.length;o++){var i=e[o];if(i.effectList.find(function(e){return e.cardId==t.cardInfo.cfg.id})){for(var n={cfg:i,cardList:[],hasCardList:[]},a=0;a<i.effectList.length;a++){var r=i.effectList[a];n.cardList.push(r.cardId),B.PlayerMgr.getInstance().getUserData().getCardById(r.cardId)&&n.hasCardList.push(r.cardId)}this.tiesInfoList.push(n)}}this.tiesInfoList.sort(function(t,e){return t.hasCardList.length<t.cardList.length&&e.hasCardList.length>=e.cardList.length?1:t.hasCardList.length>=t.cardList.length&&e.hasCardList.length<e.cardList.length?-1:t.cfg.id-e.cfg.id});for(var s=this.ndLevel.getChildByName("ndTies").getChildByName("ndLay"),c=Math.max(s.childrenCount,this.tiesInfoList.length),l=function(e){var o=s.children[e],i=p.tiesInfoList[e];o||(o=cc.instantiate(s.children[0])).setParent(s),o.attr({cfgIndex:e}),o.on(cc.Node.EventType.TOUCH_END,function(){var e=o.cfgIndex;h.UIMgr.getInstance().openUI(m.UIID.UITiesInfo,m.UIID.UINONE,t.tiesInfoList[e])},p),i?(o.active=!0,p.loadSpriteFrame(y.BraveTowerBundelName.IconTies,i.cfg.icon,function(t){o.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),o.getChildByName("labName").getComponent(cc.Label).string=p.T(i.cfg.name),o.getChildByName("labPro").getComponent(cc.Label).string=i.hasCardList.length+"/"+i.cardList.length):o.active=!1},p=this,u=0;u<c;u++)l(u);var d=this.ndLevel.getChildByName("ndNext").getChildByName("ndFram");this.loadSpriteFrame(y.BraveTowerBundelName.IconCardHead,this.cardInfo.cfg.head,function(t){d.getChildByName("sprHead").getComponent(cc.Sprite).spriteFrame=t});var f=_.BraveTowerEnumGoodsCfg.BlueCard;switch(this.cardInfo.cfg.quality){case 1:f=_.BraveTowerEnumGoodsCfg.BlueCard;break;case 2:f=_.BraveTowerEnumGoodsCfg.PurpleCard;break;case 3:f=_.BraveTowerEnumGoodsCfg.GoldCard}var g=b.DataMgr.getInstance().getGoodsCfgById(f);this.loadSpriteFrame(y.BraveTowerBundelName.Icon,g.icon,function(t){d.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t})},e.prototype.initInfo=function(){var t=this.ndInfo.getChildByName("ndCardCard");t.getChildByName("labName").getComponent(cc.Label).string=this.T(this.cardInfo.cfg.name),this.loadSpriteFrame(y.BraveTowerBundelName.Icon,f.Utils.StringFormat(y.BraveTowerImgName.CardQuality,this.cardInfo.cfg.quality),function(e){t.getComponent(cc.Sprite).spriteFrame=e}),this.loadSpriteFrame(y.BraveTowerBundelName.IconCard,this.cardInfo.cfg.icon,function(e){t.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=e});for(var e=t.getChildByName("layTies"),o=Math.max(e.childrenCount,this.cardInfo.ties.length),i=function(t){var o=e.children[t],i=n.cardInfo.ties[t];if(o)if(i){o.active=!0;var a=b.DataMgr.getInstance().getTiesCfg(i);n.loadSpriteFrame(y.BraveTowerBundelName.IconTies,a.icon,function(t){o.getComponent(cc.Sprite).spriteFrame=t})}else o.active=!1;else(o=cc.instantiate(e.children[0])).setParent(e),o.x=0,o.active=!0,a=b.DataMgr.getInstance().getTiesCfg(i),n.loadSpriteFrame(y.BraveTowerBundelName.IconTies,a.icon,function(t){o.getComponent(cc.Sprite).spriteFrame=t})},n=this,a=0;a<o;a++)i(a);var r=t.getChildByName("ndNormal"),s=t.getChildByName("ndLock");if(this.cardInfo.info){r.active=!0,s.active=!1,r.getChildByName("labLevel").getComponent(cc.Label).string="Lv."+this.cardInfo.info.level;var c=b.DataMgr.getInstance().getCardQualityCfg(this.cardInfo.cfg.quality),l=c.levelInfo[this.cardInfo.info.level-1].fragment;this.cardInfo.info.level>=c.levelInfo.length?(r.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=1,r.getChildByName("labPro").getComponent(cc.Label).string="Max"):(r.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=this.cardInfo.info.curNum/l,r.getChildByName("labPro").getComponent(cc.Label).string=this.cardInfo.info.curNum+"/"+l);var p=r.getChildByName("ndArr");cc.Tween.stopAllByTarget(p),this.cardInfo.info.curNum>=l?(p.active=!0,cc.tween(p).to(.5,{y:-75}).to(.5,{y:-65}).union().repeatForever().start()):p.active=!1}else r.active=!1,s.active=!0,this.cardInfo.cfg.lockStage?s.getChildByName("labPro").getComponent(cc.Label).string=f.Utils.StringFormat(this.T(g.TextConfig.Text19),this.cardInfo.cfg.lockStage):s.getChildByName("labPro").getComponent(cc.Label).string=this.T(g.TextConfig.Text10);this.ndInfo.getChildByName("ndAtt").getChildByName("labNum").getComponent(cc.Label).string=""+B.PlayerMgr.getInstance().getCardAttack(this.cardInfo.cfg.id),this.ndInfo.getChildByName("ndAttSpeed").getChildByName("labNum").getComponent(cc.Label).string=""+this.cardInfo.cfg.attSpeed,this.ndInfo.getChildByName("ndCD").getChildByName("labNum").getComponent(cc.Label).string=""+this.cardInfo.cfg.chillDown},e.prototype.initBtnListener=function(){for(var t=this,e=0;e<this.togCon.toggleItems.length;e++)this.togCon.toggleItems[e].node.on("toggle",this.showView,this);this.btnUpgrade.on(cc.Node.EventType.TOUCH_END,function(){if(t.cardInfo.info){var e=b.DataMgr.getInstance().getCardQualityCfg(t.cardInfo.cfg.quality),o=e.levelInfo[t.cardInfo.info.level-1].fragment;if(B.PlayerMgr.getInstance().getUserData().getFreeNum(t.cardInfo.cfg.quality-1)+t.cardInfo.info.curNum<o)t.openUI(m.UIID.UITips,t.T(g.TextConfig.Text11));else if(B.PlayerMgr.getInstance().getUserData().subGoldNum(e.levelInfo[t.cardInfo.info.level-1].gold)){d.AudioMgr.getInstance().playEffect(m.AudioId.Cards);var i=B.PlayerMgr.getInstance().getUserData().updateCard(t.cardInfo.cfg.id);B.PlayerMgr.getInstance().getTaskData().addCardLevel();for(var n=!1,a=0;a<t.cardInfo.cfg.CardSkillCfg.length;a++)for(var r=t.cardInfo.cfg.CardSkillCfg[a],s=0;s<r.UnlockLevel.length;s++)if(i==r.UnlockLevel[s]){n=!0;break}n?t.openUI(m.UIID.UITips,t.T(g.TextConfig.Tips08)):t.openUI(m.UIID.UITips,t.T(g.TextConfig.Tips07)),t.initInfo(),t.initLevelView(),t.sendEvent(y.BraveTowerEventName.UpdateRedPoint,8)}else{var c=b.DataMgr.getInstance().getParamCfg(_.BraveTowerEnumParamsCfg.Params11).split("|");t.openUI(m.UIID.UIAddGold,_.BraveTowerEnumGoodsCfg.Coin,parseInt(c[0]),function(e){e&&(B.PlayerMgr.getInstance().getTrackData().youmengTrack(v.TrackId.Gold_bubbles),B.PlayerMgr.getInstance().getTrackData().youmengTrack(v.TrackId.Gold_bubbles_X,function(){var t=B.PlayerMgr.getInstance().getUserData().getMaxStage();return t<=5?t:Math.floor((t-1)/5)+5}()),B.PlayerMgr.getInstance().getUserData().addGoldNum(parseInt(c[0])),B.PlayerMgr.getInstance().getTaskData().addGetGold(parseInt(c[0])),t.sendEvent(y.BraveTowerEventName.UpdateRedPoint,8))})}}else t.openUI(m.UIID.UITips,t.T(g.TextConfig.Text10))},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.btnLock.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(y.BraveTowerEventName.SwitchTab,1),t.closeUI()},this)},e.prototype.showView=function(t){if(t.isChecked&&this.tag!=t.node.name){switch(d.AudioMgr.getInstance().playAudioButtonClicked(),t.node.name){case"Toggle1":this.initLevelView();break;case"Toggle2":this.initSkillView();break;case"Toggle3":this.initAwakView()}this.tag=t.node.name}},e.prototype.initLevelView=function(){this.ndInfo.active=!0,this.ndLevel.active=!0,this.ndSkill.active=!1,this.ndAwak.active=!1,this.btnUpgrade.active=!1;var t,e,o,i,n=b.DataMgr.getInstance().getCardQualityCfg(this.cardInfo.cfg.quality),a=this.ndLevel.getChildByName("ndNext"),r=this.ndLevel.getChildByName("ndMax");if(this.cardInfo.info)if(this.btnUpgrade.active=!0,this.btnLock.active=!1,this.cardInfo.info.level>=n.levelInfo.length)a.active=!1,r.active=!0,(t=a.getChildByName("ndAtt")).getChildByName("ndAtt2").getChildByName("labNum").getComponent(cc.Label).string=""+B.PlayerMgr.getInstance().getCardAttack(this.cardInfo.cfg.id);else{a.active=!0,r.active=!1,(t=a.getChildByName("ndAtt")).getChildByName("ndAtt1").getChildByName("labNum").getComponent(cc.Label).string=""+B.PlayerMgr.getInstance().getCardAttack(this.cardInfo.cfg.id),t.getChildByName("ndAtt2").getChildByName("labNum").getComponent(cc.Label).string=""+B.PlayerMgr.getInstance().getCardAttackNext(this.cardInfo.cfg.id),(o=(e=a.getChildByName("ndFram")).getChildByName("labNum1").getComponent(cc.Label)).string=this.cardInfo.info.curNum+"/"+n.levelInfo[this.cardInfo.info.level-1].fragment;var s=B.PlayerMgr.getInstance().getUserData().getFreeNum(this.cardInfo.cfg.quality-1);(i=e.getChildByName("labNum2").getComponent(cc.Label)).string=s+"/"+n.levelInfo[this.cardInfo.info.level-1].fragment,s+this.cardInfo.info.curNum>=n.levelInfo[this.cardInfo.info.level-1].fragment?(o.node.color=(new cc.Color).fromHEX("#11f055"),i.node.color=(new cc.Color).fromHEX("#11f055")):(o.node.color=(new cc.Color).fromHEX("#f2480d"),i.node.color=(new cc.Color).fromHEX("#f2480d")),this.btnUpgrade.active=!0,this.btnUpgrade.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=""+y.BraveTowerGameUtils.numberFomat(n.levelInfo[this.cardInfo.info.level-1].gold)}else a.active=!0,r.active=!1,(t=a.getChildByName("ndAtt")).getChildByName("ndAtt1").getChildByName("labNum").getComponent(cc.Label).string="0",t.getChildByName("ndAtt2").getChildByName("labNum").getComponent(cc.Label).string=""+B.PlayerMgr.getInstance().getCardAttack(this.cardInfo.cfg.id),(o=(e=a.getChildByName("ndFram")).getChildByName("labNum1").getComponent(cc.Label)).string="0/"+n.levelInfo[0].fragment,s=B.PlayerMgr.getInstance().getUserData().getFreeNum(this.cardInfo.cfg.quality-1),(i=e.getChildByName("labNum2").getComponent(cc.Label)).string=s+"/"+n.levelInfo[0].fragment,o.node.color=(new cc.Color).fromHEX("#f2480d"),i.node.color=(new cc.Color).fromHEX("#f2480d"),this.btnUpgrade.active=!1,this.btnLock.active=!0},e.prototype.initSkillView=function(){this.ndInfo.active=!0,this.ndLevel.active=!1,this.ndSkill.active=!0,this.ndAwak.active=!1,this.skillList=this.cardInfo.cfg.CardSkillCfg.map(function(){return 0});var t=1;this.cardInfo.info&&(t=this.cardInfo.info.level);for(var e=0;e<this.cardInfo.cfg.CardSkillCfg.length;e++)for(var o=this.cardInfo.cfg.CardSkillCfg[e],i=0;i<o.UnlockLevel.length&&!(o.UnlockLevel[i]>t);i++)this.skillList[e]=i;this.listSkill.numItems=this.cardInfo.cfg.CardSkillCfg.length},e.prototype.initSkillListItem=function(t,e){t.active=!0;var o=this.cardInfo.cfg.CardSkillCfg[e];this.loadSpriteFrame(y.BraveTowerBundelName.IconSkill,o.icon,function(e){t.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=e}),t.getChildByName("labName").getComponent(cc.Label).string=this.T(o.name);for(var i=[],n=o.vaule[this.skillList[e]],a=0;a<n.length;a++)o.vaulePercentage[a]?i.push("<color=#2056ea>"+n[a]+"</c>"):i.push("<color=#2056ea>"+Math.round(1e4*n[a])/100+"%</c>");t.getChildByName("labInfo").getComponent(cc.RichText).string="<b>"+f.Utils.StringFormat.apply(f.Utils,l([this.T(o.info)],i))+"</b>";var r=t.getChildByName("labDesc").getComponent(cc.Label);switch(o.FightUnlockStar){case 1:r.string=this.T(g.TextConfig.Text12),r.node.color=(new cc.Color).fromHEX("#4aff19"),r.node.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX("#005a02");break;case 3:r.string=this.T(g.TextConfig.Text13),r.node.color=(new cc.Color).fromHEX("#59eeff"),r.node.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX("#005a94");break;case 5:r.string=this.T(g.TextConfig.Text14),r.node.color=(new cc.Color).fromHEX("#f95cff"),r.node.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX("#820099");break;default:r.string="Error"+o.FightUnlockStar}},e.prototype.initAwakView=function(){this.ndInfo.active=!1,this.ndLevel.active=!1,this.ndSkill.active=!1,this.ndAwak.active=!0,this.awakList=[];for(var t=0;t<this.cardInfo.cfg.CardSkillCfg.length;t++)for(var e=this.cardInfo.cfg.CardSkillCfg[t],o=0;o<e.UnlockLevel.length;o++){var i=e.UnlockLevel[o];1!=i&&this.awakList.push({level:i,cfg:e,index:o})}this.awakList.sort(function(t,e){return t.level-e.level}),this.listAwak.numItems=this.awakList.length},e.prototype.initAwakListItem=function(t,e){t.active=!0;var o=this.awakList[e];t.getChildByName("labName").getComponent(cc.Label).string=f.Utils.StringFormat(this.T(g.TextConfig.Text15),o.level);for(var i=[],n=o.cfg.vaule[o.index],a=0;a<n.length;a++)o.cfg.vaulePercentage[a]?i.push("<color=#2056ea>"+n[a]+"</c>"):i.push("<color=#2056ea>"+(100*n[a]).toFixed(0)+"%</c>");var r="";switch(o.cfg.FightUnlockStar){case 1:r=this.T(g.TextConfig.Text16);break;case 3:r=this.T(g.TextConfig.Text17);break;case 5:r=this.T(g.TextConfig.Text18)}t.getChildByName("labInfo").getComponent(cc.RichText).string="<b>["+r+"]"+f.Utils.StringFormat.apply(f.Utils,l([this.T(o.cfg.info)],i))+"</b>";var s=1;this.cardInfo.info&&(s=this.cardInfo.info.level);var c=t.getChildByName("ndLock");s>=o.level?c.active=!1:c.active=!0},c([C(cc.ToggleContainer)],e.prototype,"togCon",void 0),c([C({type:cc.Node,tooltip:"\u82f1\u96c4\u4fe1\u606f"})],e.prototype,"ndInfo",void 0),c([C({type:cc.Node,tooltip:"\u7b49\u7ea7\u4fe1\u606f"})],e.prototype,"ndLevel",void 0),c([C({type:cc.Node,tooltip:"\u6280\u80fd\u4fe1\u606f"})],e.prototype,"ndSkill",void 0),c([C({type:u.default,tooltip:"\u6280\u80fd"})],e.prototype,"listSkill",void 0),c([C({type:cc.Node,tooltip:"\u6280\u80fd\u4fe1\u606f"})],e.prototype,"ndAwak",void 0),c([C({type:u.default,tooltip:"\u6280\u80fd"})],e.prototype,"listAwak",void 0),c([C({type:cc.Node,tooltip:"\u5347\u7ea7"})],e.prototype,"btnUpgrade",void 0),c([C({type:cc.Node,tooltip:"\u83b7\u53d6"})],e.prototype,"btnLock",void 0),c([C({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([P],e)}(p.default);a.default=D,cc._RF.pop(),cc._RF.pop()},{}],UICardLock:[function(t,e,o){"use strict";cc._RF.push(e,"022fcsa7mFLqbQpiTLSWK+D","UICardLock");var i=t,n=e,a=o;cc._RF.push(n,"022fcsa7mFLqbQpiTLSWK+D","UICardLock");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Utils"),u=i("Config"),d=i("BraveTowerEnum"),h=i("DataMgr"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndParent=null,e.ndItem=null,e.btnClose=null,e.cardList=[],e.endNode=null,e.index=0,e.canAni=!1,e.time=0,e.nodeList=[],e.colNum=4,e.colNumX=180,e}return s(e,t),e.prototype.init=function(e,o){t.prototype.init.call(this),this.cardList=e,this.endNode=o},e.prototype.start=function(){var t=this;this.ndItem.active=!1,this.btnClose.active=!1,this.canAni=!0,this.fromId==u.UIID.UIGame&&this.sendEvent(d.BraveTowerEventName.GameSuspend,!0),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.canAni||(t.fromId==u.UIID.UIGame&&t.sendEvent(d.BraveTowerEventName.GameSuspend,!1),t.closeUI())},this)},e.prototype.update=function(t){if(this.canAni&&(this.time-=t,this.time<=0)){if(this.index==this.cardList.length)return this.canAni=!1,void(this.btnClose.active=!0);var e=this.cardList[this.index++];this.time=this.aniNormal(e),this.index==this.cardList.length&&(this.time=1)}},e.prototype.aniNormal=function(t){var e=cc.instantiate(this.ndItem);return e.active=!0,e.setParent(this.ndParent),e.setPosition(this.getItemPos()),this.initItem(t,e),this.nodeList.push(e),cc.tween(e).set({opacity:0}).to(.3,{opacity:255}).start(),.15},e.prototype.getItemPos=function(){return cc.v3(-this.colNumX/2*(this.cardList.length-1)+this.colNumX*(this.index-1),0)},e.prototype.initItem=function(t,e){var o=e.getChildByName("spAni").getComponent(sp.Skeleton),i=e.getChildByName("ndMain");o.node.active=!0,o.setAnimation(0,"ani"+p.Utils.randomRang(1,4),!1),o.setEventListener(function(){i.active=!0,cc.tween(i).set({scale:.3}).to(.3,{scale:1.2}).to(.15,{scale:1}).start()}),i.active=!1;var n=i.getChildByName("ndLight"),a=h.DataMgr.getInstance().getCardCfg(t);n.children[0].active=3==a.quality,n.children[1].active=2==a.quality,d.BraveTowerGameUtils.aniAngle(n),i.getChildByName("labName").getComponent(cc.Label).string=this.T(a.name),this.loadSpriteFrame(d.BraveTowerBundelName.Icon,p.Utils.StringFormat(d.BraveTowerImgName.CardQuality,a.quality),function(t){i.getComponent(cc.Sprite).spriteFrame=t}),this.loadSpriteFrame(d.BraveTowerBundelName.IconCard,a.icon,function(t){i.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),i.getChildByName("labNew").active=!0},e.prototype.closeAni=function(e){if(this.endNode){for(var o=this.endNode.convertToWorldSpaceAR(cc.v2(0,0)),i=this.ndParent.convertToNodeSpaceAR(o),n=0;n<this.nodeList.length;n++){var a=this.nodeList[n],r=a.getPosition(),s=cc.v2(r.x,r.y+400),c=cc.v2(r.x>0?r.x+200:0==r.x?0:r.x-200,r.y);cc.tween(a).parallel(cc.tween(a).to(.5,{scale:.5}),cc.tween(a).bezierTo(.5,s,c,i)).start()}this.ndParent.getChildByName("mss_bt").active=!1,this.btnClose.active=!1;var l=this.node.getChildByName("bg");l&&(l.opacity=this.bgOpacity,cc.tween(l).to(.5,{opacity:0}).start()),this.scheduleOnce(function(){e&&e()},.55)}else t.prototype.closeAni.call(this,e)},c([g({type:cc.Node,tooltip:""})],e.prototype,"ndParent",void 0),c([g({type:cc.Node,tooltip:""})],e.prototype,"ndItem",void 0),c([g({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],UICtrl:[function(t,e,o){"use strict";cc._RF.push(e,"30ebd4gFyxDfZEc8G0lxI/b","UICtrl");var i=t,n=e,a=o;cc._RF.push(n,"30ebd4gFyxDfZEc8G0lxI/b","UICtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RoleCtrl"),p=i("WeaponCtrl"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ex=null,e.exMax=null,e.exBar=null,e.level=null,e.weaponNum=null,e}return s(e,t),e.prototype.start=function(){},e.prototype.update=function(){this.ex.string=l.default.instance.exNum+"",this.exMax.string="/ "+l.default.instance.levelBar,this.exBar.progress=l.default.instance.exNum/l.default.instance.levelBar,this.level.string=l.default.instance.level+"",this.weaponNum.string=p.default.instance.weaponNum+""},c([h(cc.Label)],e.prototype,"ex",void 0),c([h(cc.Label)],e.prototype,"exMax",void 0),c([h(cc.ProgressBar)],e.prototype,"exBar",void 0),c([h(cc.Label)],e.prototype,"level",void 0),c([h(cc.Label)],e.prototype,"weaponNum",void 0),c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],UIExchangeCode:[function(t,e,o){"use strict";cc._RF.push(e,"766e91i0k1L8453CNtva+Ju","UIExchangeCode");var i=t,n=e,a=o;cc._RF.push(n,"766e91i0k1L8453CNtva+Ju","UIExchangeCode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Config"),u=i("DataMgr"),d=i("PlayerMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.editName=null,e.btnVideo=null,e.btnClose=null,e}return s(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.editName.string=e||""},e.prototype.start=function(){this.initEventListener(),this.initBtnListener(),this.initView(),this.initBtnView()},e.prototype.initEventListener=function(){},e.prototype.initBtnListener=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,this.closeUI,this),this.btnVideo.on(cc.Node.EventType.TOUCH_END,this.openVideo,this)},e.prototype.initView=function(){},e.prototype.initBtnView=function(){},e.prototype.openVideo=function(){var t=this.editName.string;if(t&&0!=t.length){var e=u.DataMgr.getInstance().getCode(t);if(e){var o=Date.now(),i=-1;e.begin_time&&(i=new Date(e.begin_time).getTime());var n=-1;if(console.log("cfg.end_time",e.end_time),e.end_time&&(n=new Date(e.end_time).getTime()),-1!=i&&o<i)this.openUI(p.UIID.UITips,"\u793c\u5305\u7801\u6682\u4e0d\u53ef\u7528");else if(-1!=n&&o>n)this.openUI(p.UIID.UITips,"\u793c\u5305\u7801\u5df2\u8fc7\u671f");else{var a="gift_"+t.toLocaleLowerCase();if(d.PlayerMgr.getInstance().getTrackData().getTimeByKey(a)>=e.exchange_time)this.openUI(p.UIID.UITips,"\u793c\u5305\u7801\u5df2\u8fbe\u5230\u6700\u5927\u9886\u53d6\u6b21\u6570");else{d.PlayerMgr.getInstance().getTrackData().addTimeByKey(a),this.openUI(p.UIID.UITips,e.gift_name);for(var r=e.rewards,s=[],c=0;c<r.length;c++){var l=r[c];s.push({id:l[0],num:l[1]})}var h=d.PlayerMgr.getInstance().onRewardToStr(s);d.PlayerMgr.getInstance().addRewardPop(h),this.closeUI()}}}else this.openUI(p.UIID.UITips,"\u793c\u5305\u7801\u4e0d\u5b58\u5728")}else this.openUI(p.UIID.UITips,"\u793c\u5305\u7801\u4e0d\u80fd\u4e3a\u7a7a")},c([m(cc.EditBox)],e.prototype,"editName",void 0),c([m(cc.Node)],e.prototype,"btnVideo",void 0),c([m(cc.Node)],e.prototype,"btnClose",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],UIGameCardSell:[function(t,e,o){"use strict";cc._RF.push(e,"364b39cXVNN3aqByqtIuG9I","UIGameCardSell");var i=t,n=e,a=o;cc._RF.push(n,"364b39cXVNN3aqByqtIuG9I","UIGameCardSell");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("BaseUI"),u=i("List"),d=i("Utils"),h=i("TextConfig"),f=i("BraveTowerEnum"),m=i("GameCtrl"),g=i("DataMgr"),y=i("PlayerMgr"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndInfo=null,e.ndSkill=null,e.listSkill=null,e.btnSell=null,e.btnClose=null,e.index=0,e.skillList=[],e}return s(e,t),e.prototype.init=function(t,e){this.index=t,this.cardInfo=e},e.prototype.start=function(){this.initBtnListener(),this.initData(),this.initInfo(),this.listSkill.tmpNode.active=!1,this.initSkillView()},e.prototype.initData=function(){var t=this;this.tiesInfoList=[];for(var e=g.DataMgr.getInstance().getTiesCfgList(),o=0;o<e.length;o++){var i=e[o];if(i.effectList.find(function(e){return e.cardId==t.cardInfo.cfg.id})){for(var n={cfg:i,cardList:[],hasCardList:[]},a=0;a<i.effectList.length;a++){var r=i.effectList[a];n.cardList.push(r.cardId),y.PlayerMgr.getInstance().getUserData().getCardById(r.cardId)&&n.hasCardList.push(r.cardId)}this.tiesInfoList.push(n)}}this.tiesInfoList.sort(function(t,e){return t.hasCardList.length<t.cardList.length&&e.hasCardList.length>=e.cardList.length?1:t.hasCardList.length>=t.cardList.length&&e.hasCardList.length<e.cardList.length?-1:t.cfg.id-e.cfg.id})},e.prototype.initInfo=function(){var t=this.ndInfo.getChildByName("ndCardCard");t.getChildByName("labName").getComponent(cc.Label).string=this.T(this.cardInfo.cfg.name),t.getChildByName("labStar").getComponent(cc.Label).string=""+this.cardInfo.getStarNum(),this.loadSpriteFrame(f.BraveTowerBundelName.Icon,d.Utils.StringFormat(f.BraveTowerImgName.CardQuality,this.cardInfo.cfg.quality),function(e){t.getComponent(cc.Sprite).spriteFrame=e}),this.loadSpriteFrame(f.BraveTowerBundelName.IconCard,this.cardInfo.cfg.icon,function(e){t.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=e});for(var e=t.getChildByName("layTies"),o=y.PlayerMgr.getInstance().getCardTies(this.cardInfo.cfg.id),i=Math.max(e.childrenCount,o.length),n=function(t){var i=e.children[t],n=o[t];if(i)if(n){i.active=!0;var r=g.DataMgr.getInstance().getTiesCfg(n);a.loadSpriteFrame(f.BraveTowerBundelName.IconTies,r.icon,function(t){i.getComponent(cc.Sprite).spriteFrame=t})}else i.active=!1;else(i=cc.instantiate(e.children[0])).setParent(e),i.x=0,i.active=!0,r=g.DataMgr.getInstance().getTiesCfg(n),a.loadSpriteFrame(f.BraveTowerBundelName.IconTies,r.icon,function(t){i.getComponent(cc.Sprite).spriteFrame=t})},a=this,r=0;r<i;r++)n(r);this.ndInfo.getChildByName("ndAtt").getChildByName("labNum").getComponent(cc.Label).string=""+Math.ceil(this.cardInfo.getDamage()),this.ndInfo.getChildByName("ndAttSpeed").getChildByName("labNum").getComponent(cc.Label).string=""+Math.ceil(100*this.cardInfo.getAtkSpeed())/100,this.ndInfo.getChildByName("ndCD").getChildByName("labNum").getComponent(cc.Label).string=""+this.cardInfo.cfg.chillDown,this.btnSell.getChildByName("Layout").getChildByName("labNum").getComponent(cc.Label).string=f.BraveTowerGameUtils.numberFomat(this.cardInfo.getSellPrice())},e.prototype.initBtnListener=function(){var t=this;this.btnSell.on(cc.Node.EventType.TOUCH_END,function(){var e=t.cardInfo.getSellPrice();m.default.instance.addGoldNum(e),m.default.instance.ctrUI.onSell(t.index),m.default.instance.resumeGame(),t.closeUI()},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){m.default.instance.resumeGame(),t.closeUI()},this)},e.prototype.initSkillView=function(){this.skillList=this.cardInfo.cfg.CardSkillCfg.map(function(){return 0});for(var t=y.PlayerMgr.getInstance().getUserData().getCardById(this.cardInfo.cfg.id).level,e=0;e<this.cardInfo.cfg.CardSkillCfg.length;e++)for(var o=this.cardInfo.cfg.CardSkillCfg[e],i=0;i<o.UnlockLevel.length&&!(o.UnlockLevel[i]>t);i++)this.skillList[e]=i;this.listSkill.numItems=this.cardInfo.cfg.CardSkillCfg.length},e.prototype.initSkillListItem=function(t,e){t.active=!0;var o=this.cardInfo.cfg.CardSkillCfg[e];this.loadSpriteFrame(f.BraveTowerBundelName.IconSkill,o.icon,function(e){t.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=e}),t.getChildByName("labName").getComponent(cc.Label).string=this.T(o.name);for(var i=[],n=o.vaule[this.skillList[e]],a=0;a<n.length;a++)o.vaulePercentage[a]?i.push("<color=#2056ea>"+n[a]+"</c>"):i.push("<color=#2056ea>"+Math.round(1e4*n[a])/100+"%</c>");t.getChildByName("labInfo").getComponent(cc.RichText).string="<b>"+d.Utils.StringFormat.apply(d.Utils,l([this.T(o.info)],i))+"</b>";var r=t.getChildByName("labDesc").getComponent(cc.Label);switch(o.FightUnlockStar){case 1:r.string=this.T(h.TextConfig.Text12),r.node.color=(new cc.Color).fromHEX("#4aff19"),r.node.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX("#005a02");break;case 3:this.cardInfo.getStarNum()>=f.BraveTowerParameter.SkillUnlockStar1?r.string=this.T(h.TextConfig.Text03):r.string=this.T(h.TextConfig.Text13),r.node.color=(new cc.Color).fromHEX("#59eeff"),r.node.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX("#005a94");break;case 5:this.cardInfo.getStarNum()>=f.BraveTowerParameter.SkillUnlockStar2?r.string=this.T(h.TextConfig.Text03):r.string=this.T(h.TextConfig.Text14),r.node.color=(new cc.Color).fromHEX("#f95cff"),r.node.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX("#820099");break;default:r.string="Error"+o.FightUnlockStar}},c([b({type:cc.Node,tooltip:"\u82f1\u96c4\u4fe1\u606f"})],e.prototype,"ndInfo",void 0),c([b({type:cc.Node,tooltip:"\u6280\u80fd\u4fe1\u606f"})],e.prototype,"ndSkill",void 0),c([b({type:u.default,tooltip:"\u6280\u80fd"})],e.prototype,"listSkill",void 0),c([b({type:cc.Node,tooltip:"\u51fa\u552e"})],e.prototype,"btnSell",void 0),c([b({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([_],e)}(p.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],UIGamePause:[function(t,e,o){"use strict";cc._RF.push(e,"e742ehTralI9YVwIAwcscew","UIGamePause");var i=t,n=e,a=o;cc._RF.push(n,"e742ehTralI9YVwIAwcscew","UIGamePause");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("BraveTowerEnum"),d=i("PlayerMgr"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.ndAuto=null,e.btnClose=null,e.btnBreak=null,e.btnHome=null,e._musicBg2=null,e._effectBg2=null,e}return s(e,t),e.prototype.onEnable=function(){this.musicSlider.progress=p.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=p.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent();var o=d.PlayerMgr.getInstance().getSetData().getAuto();this.ndAuto.getChildByName("ndOpen").active=o,this.ndAuto.getChildByName("ndClose").active=!o},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),p.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),p.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.ndAuto.on(cc.Node.EventType.TOUCH_END,function(){var e=d.PlayerMgr.getInstance().getSetData().getAuto();t.ndAuto.getChildByName("ndOpen").active=!e,t.ndAuto.getChildByName("ndClose").active=e,d.PlayerMgr.getInstance().getSetData().setAuto(!e)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(u.BraveTowerEventName.GameSuspend,!1),t.closeUI()},this),this.btnBreak.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(u.BraveTowerEventName.GameSuspend,!1),t.closeUI()},this),this.btnHome.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(u.BraveTowerEventName.GameOver,!1),t.closeUI()},this)},c([m(cc.Slider)],e.prototype,"musicSlider",void 0),c([m(cc.Slider)],e.prototype,"effectSlider",void 0),c([m(cc.Node)],e.prototype,"ndAuto",void 0),c([m(cc.Node)],e.prototype,"btnClose",void 0),c([m(cc.Node)],e.prototype,"btnBreak",void 0),c([m(cc.Node)],e.prototype,"btnHome",void 0),c([f],e)}(l.default);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],UIGameResult:[function(t,e,o){"use strict";cc._RF.push(e,"af6abw8vGFINrmlaulXyD7v","UIGameResult");var i=t,n=e,a=o;cc._RF.push(n,"af6abw8vGFINrmlaulXyD7v","UIGameResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("ResourceMgr"),d=i("SdkMgr"),h=i("UIMgr"),f=i("Config"),m=i("BraveTowerEnum"),g=i("GameCtrl"),y=i("ItemGood"),v=i("UtilLayout"),_=i("GameTrackDataEvent"),b=i("PlayerMgr"),B=cc._decorator,I=B.ccclass,P=B.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aniTitle=null,e.ndTop=null,e.ctrReward=null,e.ndFail=null,e.ndBtn=null,e.btnGet=null,e.btnVideo=null,e.btnBack=null,e.btnRestart=null,e.isWin=!1,e.funRestartGame=null,e.rewardList=[],e.isEnd=!1,e}return s(e,t),e.prototype.init=function(e,o){t.prototype.init.call(this),this.isWin=e,this.funRestartGame=o,this.initData()},e.prototype.initData=function(){var t,e=this;if(g.default.instance.gameData.gameMode==m.BraveTowerGameMode.Boss){var o=(r=g.default.instance.gameData.levelCfg).wareList[g.default.instance.gameData.roundNum-1];o||(o=r.wareList[r.wareList.length-1]);for(var i=o.reward,n=0;n<i.length;n++){var a=i[n];this.rewardList.push({id:a[0],num:a[1]})}}else{var r;if(this.isWin&&(r=null===(t=g.default.instance.gameData)||void 0===t?void 0:t.levelCfg))for(n=0;n<r.reward.length;n++)a=r.reward[n],this.rewardList.push({id:a[0],num:a[1]})}this.ctrReward.init(this.rewardList.length);var s=function(t){var o=c.rewardList[t];u.ResourceMgr.getInstance().getNode(m.BraveTowerPoolName.ItemGood,m.BraveTowerBundelName.Icon,m.BraveTowerPrefabName.ItemGood,function(i){i.setParent(e.ctrReward.node),e.scheduleOnce(function(){cc.tween(i).set({scale:.3}).to(.3,{scale:1.2}).to(.15,{scale:1}).start()},.2*t);var n=e.ctrReward.getPos(t);i.setPosition(n),i.getComponent(y.default).initView(o.id,o.num)})},c=this;for(n=0;n<this.rewardList.length;n++)s(n)},e.prototype.onOpen=function(){var t=this;this.ndTop.active=!1,this.ctrReward.node.active=!1,this.ndFail.active=!1,this.ndBtn.active=!1,this.btnGet.active=this.isWin,this.btnVideo.active=this.isWin,this.btnBack.active=!this.isWin,this.btnRestart.active=!this.isWin&&g.default.instance.gameData.gameMode==m.BraveTowerGameMode.Normal,this.aniTitle.setAnimation(0,this.isWin?"animation1":"animation2",!1),this.aniTitle.setCompleteListener(function(){var e;e=0,t.ndTop.active=!0,cc.tween(t.ndTop).set({scale:0}).to(.5,{scale:1},{easing:"quartOut"}).start(),e+=.5,t.ctrReward.node.active=!0,cc.tween(t.ctrReward.node).set({scale:0}).delay(e).to(.5,{scale:1},{easing:"quartOut"}).start(),t.isWin||(e+=.5,t.ndFail.active=!0,cc.tween(t.ndFail).set({scale:0}).delay(e).to(.5,{scale:1},{easing:"quartOut"}).start()),e+=.5,t.ndBtn.active=!0,cc.tween(t.ndBtn).set({scale:0}).delay(e).to(.5,{scale:1},{easing:"quartOut"}).call(function(){t.isEnd=!0}).start()}),this.isWin?p.AudioMgr.getInstance().playEffect(f.AudioId.victory):p.AudioMgr.getInstance().playEffect(f.AudioId.fail)},e.prototype.start=function(){this.initBtnListener(),p.AudioMgr.getInstance().stopMusic(m.BraveTowerParameter.BGMusic)},e.prototype.initBtnListener=function(){var t=this;this.btnGet.on(cc.Node.EventType.TOUCH_END,function(){var e=t.ctrReward.node.convertToWorldSpaceAR(cc.v2(0,0)),o=b.PlayerMgr.getInstance().onRewardToStr(t.rewardList);b.PlayerMgr.getInstance().addRewards(o,1,e),h.UIMgr.getInstance().closeById(t.fromId),t.closeUI()},this),this.btnVideo.on(cc.Node.EventType.TOUCH_END,function(){d.SdkMgr.getInstance().playVideo(d.AdType.AdFreeTime,function(){var e;b.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Victory_doubled),b.PlayerMgr.getInstance().getTrackData().youmengTrack(_.TrackId.Victory_doubled_X,(e=b.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?e:Math.floor((e-1)/5)+5);var o=t.ctrReward.node.convertToWorldSpaceAR(cc.v2(0,0)),i=b.PlayerMgr.getInstance().onRewardToStr(t.rewardList);b.PlayerMgr.getInstance().addRewards(i,3,o),h.UIMgr.getInstance().closeById(t.fromId),t.closeUI()})},this),this.btnBack.on(cc.Node.EventType.TOUCH_END,function(){if(t.rewardList.length>0){var e=t.ctrReward.node.convertToWorldSpaceAR(cc.v2(0,0)),o=b.PlayerMgr.getInstance().onRewardToStr(t.rewardList);b.PlayerMgr.getInstance().addRewards(o,1,e)}h.UIMgr.getInstance().closeById(t.fromId),t.closeUI()},this),this.btnRestart.on(cc.Node.EventType.TOUCH_END,function(){t.funRestartGame(),t.closeUI()},this)},c([P({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"aniTitle",void 0),c([P({type:cc.Node,tooltip:"\u6807\u9898"})],e.prototype,"ndTop",void 0),c([P({type:v.UtilLayout,tooltip:"\u5956\u52b1\u8282\u70b9"})],e.prototype,"ctrReward",void 0),c([P({type:cc.Node,tooltip:"\u5931\u8d25\u8282\u70b9"})],e.prototype,"ndFail",void 0),c([P({type:cc.Node,tooltip:"\u6309\u94ae\u8282\u70b9"})],e.prototype,"ndBtn",void 0),c([P({type:cc.Node,tooltip:"\u83b7\u53d6\u6309\u94ae"})],e.prototype,"btnGet",void 0),c([P({type:cc.Node,tooltip:"\u89c6\u9891\u6309\u94ae"})],e.prototype,"btnVideo",void 0),c([P({type:cc.Node,tooltip:"\u8fd4\u56de\u6309\u94ae"})],e.prototype,"btnBack",void 0),c([P({type:cc.Node,tooltip:"\u91cd\u5f00\u6309\u94ae"})],e.prototype,"btnRestart",void 0),c([I],e)}(l.default);a.default=C,cc._RF.pop(),cc._RF.pop()},{}],UIGameTiesInfo:[function(t,e,o){"use strict";cc._RF.push(e,"392f7qyVrhKxLGOns2BErsi","UIGameTiesInfo");var i=t,n=e,a=o;cc._RF.push(n,"392f7qyVrhKxLGOns2BErsi","UIGameTiesInfo");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("BaseUI"),u=i("Utils"),d=i("TextConfig"),h=i("BraveTowerEnum"),f=i("GameCtrl"),m=i("DataMgr"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprIcon=null,e.labName=null,e.labLock=null,e.labDesc=null,e.ndParent=null,e.ndItem=null,e.btnClose=null,e}return s(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.tiesInfo=e},e.prototype.start=function(){this.initData(),this.initBtnListener(),this.initView()},e.prototype.initData=function(){},e.prototype.initView=function(){var t=this,e=m.DataMgr.getInstance().getTiesCfg(this.tiesInfo.id);this.loadSpriteFrame(h.BraveTowerBundelName.IconTies,e.icon,function(e){t.sprIcon.spriteFrame=e}),this.labName.string=this.T(e.name),this.labLock.string=this.T(this.tiesInfo.cardList.length>=this.tiesInfo.allCardList.length?d.TextConfig.Text03:d.TextConfig.Text04);for(var o=[],i=0;i<e.vaule.length;i++)e.vaulePercentage[i]?o.push("<color="+e.color+">"+e.vaule[i]+"</c>"):o.push("<color="+e.color+">"+Math.round(1e4*e.vaule[i])/100+"%</c>");this.labDesc.string="<b><outline color=#000000 width=4>"+u.Utils.StringFormat.apply(u.Utils,l([this.T(e.info)],o))+"</outline></b>",this.ndItem.active=!1;var n=function(t){var o=e.effectList[t],i=cc.instantiate(a.ndItem);i.setParent(a.ndParent),i.x=0,i.active=!0;var n=m.DataMgr.getInstance().getCardCfg(o.cardId);a.loadSpriteFrame(h.BraveTowerBundelName.IconCardHead,n.head,function(t){i.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),i.getChildByName("labName").getComponent(cc.Label).string=a.T(n.name),i.getChildByName("ndLock").active=!f.default.instance.ctrUI.getCard(o.cardId);for(var r=[],s=0;s<o.vaule.length;s++)o.vaulePercentage[s]?r.push("<color=#2056ea>"+o.vaule[s]+"</c>"):r.push("<color=#2056ea>"+(100*o.vaule[s]).toFixed(0)+"%</c>");i.getChildByName("labInfo").getComponent(cc.RichText).string="<b>[<color=#2056ea>"+o.name+"</c>]:"+u.Utils.StringFormat.apply(u.Utils,l([a.T(o.info)],r))+"</b>"},a=this;for(i=0;i<e.effectList.length;i++)n(i)},e.prototype.initBtnListener=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){f.default.instance.resumeGame(),t.closeUI()},this)},c([v({type:cc.Sprite,tooltip:"\u56fe\u6807"})],e.prototype,"sprIcon",void 0),c([v({type:cc.Label,tooltip:"\u540d\u79f0"})],e.prototype,"labName",void 0),c([v({type:cc.Label,tooltip:"\u6fc0\u6d3b"})],e.prototype,"labLock",void 0),c([v({type:cc.RichText,tooltip:"\u63cf\u8ff0"})],e.prototype,"labDesc",void 0),c([v({type:cc.Node,tooltip:"\u4efb\u52a1"})],e.prototype,"ndParent",void 0),c([v({type:cc.Node,tooltip:"\u4efb\u52a1"})],e.prototype,"ndItem",void 0),c([v({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([y],e)}(p.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"39e24/JlmtFd6ZbRBsge7Uy","UIGame");var i=t,n=e,a=o;cc._RF.push(n,"39e24/JlmtFd6ZbRBsge7Uy","UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("BaseButton"),u=i("Appcfg"),d=i("AudioMgr"),h=i("UIMgr"),f=i("Main"),m=i("Config"),g=i("TextConfig"),y=i("GameTrackDataEvent"),v=i("GameEnumData"),_=i("DataMgr"),b=i("PlayerMgr"),B=i("UIGuide"),I=i("BraveTowerEnum"),P=i("GameCtrl"),C=cc._decorator,D=C.ccclass,T=C.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprBg=null,e.sprBgSup=null,e.ndRed=null,e.btnPause=null,e.ndTie=null,e.ndRank=null,e.ndBuff=null,e.ctrGame=null,e.openTag=0,e.rankModel=1,e.rankList=[],e}return s(e,t),e.prototype.init=function(e,o,i){t.prototype.init.call(this),this.gameModel=e,this.levelID=o,i&&this.doDirect()},e.prototype.doDirect=function(){f.default.instance.removeBlockTouch()},e.prototype.start=function(){var t=this;this.initView(),this.ctrGame.initData(this.gameModel,this.levelID),this.scheduleOnce(function(){t.ctrGame.startGame(),t.startGuide()},1),this.addEventListen(),this.initBtnListener(),h.UIMgr.getInstance().preLoadUI(m.UIID.UIGamePause,function(){}),this.ndRed.active=!1,this.schedule(function(){b.PlayerMgr.getInstance().getGuideData().getGuideEnd(2)?t.sendEvent(u.BaseEventName.RefreshReport,!1):t.sendEvent(u.BaseEventName.RefreshReport,!0,t.ctrGame.ctrUI.ndTime.convertToWorldSpaceAR(cc.v2(0,-100)))},.1)},e.prototype.addEventListen=function(){var t=this;this.addEvent(I.BraveTowerEventName.UpdateGameUI,function(e){switch(e){case 1:t.onUpdateTiesView();break;case 2:t.onUpdateRankView();break;case 3:t.onUpdateBuffView()}}),this.addEvent(I.BraveTowerEventName.GameRestart,this.onGameRestart),this.addEvent(u.BaseEventName.CloseUI,this.onCloseUI),this.addEvent(I.BraveTowerEventName.ScreenShake,this.onScreenShake)},e.prototype.initBtnListener=function(){var t=this;this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.ctrGame.gameData.gameStage==I.BraveTowerGameStage.GameIng&&(t.sendEvent(I.BraveTowerEventName.GameSuspend,!0),t.openUI(m.UIID.UIGamePause))},this),this.ndTie.on(cc.Node.EventType.TOUCH_END,function(){t.showTag(1)},this),this.ndRank.on(cc.Node.EventType.TOUCH_END,function(){t.showTag(2)},this);var e=this.ndRank.getChildByName("ndLay"),o=e.getChildByName("btnAll"),i=e.getChildByName("btnSecond");o.on(cc.Node.EventType.TOUCH_END,function(){t.rankModel=1,o.getComponent(p.BaseButton).interactable=!0,i.getComponent(p.BaseButton).interactable=!1,t.onUpdateRankView()},this),i.on(cc.Node.EventType.TOUCH_END,function(){t.rankModel=2,o.getComponent(p.BaseButton).interactable=!1,i.getComponent(p.BaseButton).interactable=!0,t.onUpdateRankView()},this),this.ndBuff.on(cc.Node.EventType.TOUCH_END,function(){t.showTag(3)},this)},e.prototype.initView=function(){var t=this,e=_.DataMgr.getInstance().getLevelCfgById(this.levelID);this.loadSpriteFrame(I.BraveTowerBundelName.Map,e.bg,function(e){t.sprBg.spriteFrame=e}),this.loadSpriteFrame(I.BraveTowerBundelName.Map,e.bgSup,function(e){t.sprBgSup.spriteFrame=e,t.sprBgSup.node.color=cc.Color.WHITE}),this.ndTie.getChildByName("ndItem").active=!1,this.ndRank.getChildByName("ndItem").active=!1,this.ndBuff.getChildByName("ndItem").active=!1,this.showTag(b.PlayerMgr.getInstance().getSetData().getShowTab());var o=this.ndRank.getChildByName("ndLay"),i=o.getChildByName("btnAll"),n=o.getChildByName("btnSecond");i.getComponent(p.BaseButton).interactable=1==this.rankModel,n.getComponent(p.BaseButton).interactable=2==this.rankModel},e.prototype.onGameRestart=function(){this.onUpdateTiesView(),this.onUpdateBuffView();for(var t=0;t<this.rankList.length;t++)this.rankList[t].node.destroy();this.rankList=[],this.onUpdateRankView()},e.prototype.showTag=function(t){switch(this.openTag==t?this.openTag=0:this.openTag=t,b.PlayerMgr.getInstance().getSetData().setShowTab(this.openTag),this.ndTie.getChildByName("ndIcon").children[0].active=1!=this.openTag,this.ndTie.getChildByName("ndIcon").children[1].active=1==this.openTag,this.ndTie.getChildByName("ndLay").active=1==this.openTag,this.ndRank.getChildByName("ndIcon").children[0].active=2!=this.openTag,this.ndRank.getChildByName("ndIcon").children[1].active=2==this.openTag,this.ndRank.getChildByName("ndLay").active=2==this.openTag,this.ndBuff.getChildByName("ndIcon").children[0].active=3!=this.openTag,this.ndBuff.getChildByName("ndIcon").children[1].active=3==this.openTag,this.ndBuff.getChildByName("ndLay").active=3==this.openTag,this.openTag){case 2:this.onUpdateRankView()}},e.prototype.onUpdateTiesView=function(){for(var t=this,e=this.ndTie.getChildByName("ndLay"),o=this.ndTie.getChildByName("ndItem"),i=this.ctrGame.gameTrammel.tiesInfo,n=Math.max(i.length,e.childrenCount),a=function(n){var a=e.children[n];if(a||((a=cc.instantiate(o)).setParent(e),a.x=0),a.off(cc.Node.EventType.TOUCH_END),i[n]){a.active=!0;var s=_.DataMgr.getInstance().getTiesCfg(i[n].id);r.loadSpriteFrame(I.BraveTowerBundelName.IconTies,s.icon,function(t){a.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),a.getChildByName("labName").getComponent(cc.Label).string=r.T(s.name),a.getChildByName("labPro").getComponent(cc.Label).string=i[n].cardList.length+"/"+i[n].allCardList.length,i[n].cardList.length>=i[n].allCardList.length?(a.getChildByName("labName").color=(new cc.Color).fromHEX("#ffdb56"),a.getChildByName("labPro").color=(new cc.Color).fromHEX("#ffdb56")):(a.getChildByName("labName").color=cc.Color.WHITE,a.getChildByName("labPro").color=cc.Color.WHITE),a.on(cc.Node.EventType.TOUCH_END,function(e){d.AudioMgr.getInstance().playAudioButtonClicked(),e.stopPropagation(),t.ctrGame.pauseGame(),t.openUI(m.UIID.UIGameTiesInfo,i[n])})}else a.active=!1},r=this,s=0;s<n;s++)a(s)},e.prototype.onUpdateRankView=function(){var t=this;if(2==this.openTag){for(var e=this.ndRank.getChildByName("ndLay"),o=this.ndRank.getChildByName("ndItem"),i=0,n=0,a=JSON.parse(JSON.stringify(this.ctrGame.rankInfo)),r=0;r<a.length;r++)i+=(l=a[r]).num,2==this.rankModel&&(l.num=Math.ceil(l.num/l.time)),n=Math.max(n,l.num);a.sort(function(t,e){return e.num-t.num}),e.getChildByName("labNum").getComponent(cc.Label).string=I.BraveTowerGameUtils.numberFomat(Math.round(i));var s=e.getComponent(cc.ScrollView).content,c=function(e){for(var i=0;i<t.rankList.length;i++)if(t.rankList[i].cardId==e)return t.rankList[i].node;var n=cc.instantiate(o),a=_.DataMgr.getInstance().getCardCfg(e);return t.loadSpriteFrame(I.BraveTowerBundelName.IconCardHead,a.head,function(t){n.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),n.setParent(s),n.x=0,t.rankList.push({cardId:e,node:n}),n};for(r=0;r<a.length;r++){var l,p=c((l=a[r]).cardId);p.active=!0,p.zIndex=r,p.getChildByName("labName").getComponent(cc.Label).string=I.BraveTowerGameUtils.numberFomat(Math.ceil(l.num)),2==this.rankModel?p.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=0==n?0:l.num/n:p.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=0==i?0:l.num/i}}},e.prototype.onUpdateBuffView=function(){for(var t=this.ndBuff.getChildByName("ndLay").getComponent(cc.ScrollView).content,e=this.ndBuff.getChildByName("ndItem"),o=this.ctrGame.gameBuff.buffList,i=Math.max(o.length,t.childrenCount),n=function(i){var n=t.children[i];if(n||((n=cc.instantiate(e)).setParent(t),n.x=0),o[i]){n.active=!0;var r=_.DataMgr.getInstance().getBuffCfg(o[i].id);n.getChildByName("ndBg").children.forEach(function(t,e){t.active=e==r.quality-1}),a.loadSpriteFrame(I.BraveTowerBundelName.IconBuff,r.icon,function(t){n.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),n.getChildByName("labName").getComponent(cc.Label).string=a.T(r.name)}else n.active=!1},a=this,r=0;r<i;r++)n(r)},e.prototype.onCloseUI=function(t){var e=this;t==m.UIID.UIGuide&&this.scheduleOnce(function(){e.startGuide()},.5)},e.prototype.startGuide=function(){var t=this,e=b.PlayerMgr.getInstance().getGuideData().getCurrentId(),o=new B.GuildCfg;switch(e){case 2:o.distNode=this.ctrGame.ctrUI.ndCardBuy[1],o.tipstring=this.T(g.TextConfig.Guide02),o.deviationTipsAll=cc.v2(0,0),o.addSize=new cc.Size(0,0),o.lightType=1,this.ctrGame.pauseGame(),b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.guide3);break;case 3:o.distNode=this.ndTie,o.tipstring=this.T(g.TextConfig.Guide03),o.deviationTipsAll=cc.v2(0,0),o.addSize=new cc.Size(0,0),o.lightType=1,b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.guide4);break;case 4:o.distNode=this.ctrGame.ctrUI.btnAdd,o.tipstring=this.T(g.TextConfig.Guide04),o.deviationTipsAll=cc.v2(0,0),o.addSize=new cc.Size(0,0),o.lightType=1,b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.guide5);break;case 5:o.distNode=this.ctrGame.ctrUI.btnRefresh,o.tipstring=this.T(g.TextConfig.Guide05),o.deviationTipsAll=cc.v2(0,0),o.addSize=new cc.Size(0,0),o.lightType=1,b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.guide6);break;case 6:o.distNode=this.ctrGame.ctrUI.ndCardBuy[1],o.tipstring=this.T(g.TextConfig.Guide06),o.deviationTipsAll=cc.v2(0,0),o.addSize=new cc.Size(0,0),o.lightType=1,this.ctrGame.pauseGame(),b.PlayerMgr.getInstance().getTrackData().youmengTrack(y.TrackId.guide7);break;case 7:o.tipstring=this.T(g.TextConfig.Guide09),o.deviationTipsAll=cc.v2(0,0),o.addSize=new cc.Size(0,0),o.showHand=!1,o.isWeek=!0,o.callBack=function(){t.openUI(m.UIID.UICardLock,[v.BraveTowerEnumCardCfg.Card07])};break;default:o=null,this.sendEvent(u.BaseEventName.blocktouch,!0)}o&&this.openUICallBack(m.UIID.UIGuide,function(){b.PlayerMgr.getInstance().getGuideData().addCurrentId()},o)},e.prototype.onScreenShake=function(){var t=this;cc.Tween.stopAllByTarget(this.sprBgSup.node),d.AudioMgr.getInstance().playEffect(m.AudioId.impact,"base");var e=.1/this.ctrGame.getSpeed();cc.tween(this.sprBgSup.node).set({position:cc.v3(0,-575)}).call(function(){t.ndRed.active=!0}).by(e,{position:cc.v3(-10,-10)}).by(e,{position:cc.v3(20,10)}).call(function(){t.ndRed.active=!1}).by(e,{position:cc.v3(-20,0)}).by(e,{position:cc.v3(20,-10)}).by(e,{position:cc.v3(-10,10)}).start()},c([T(cc.Sprite)],e.prototype,"sprBg",void 0),c([T(cc.Sprite)],e.prototype,"sprBgSup",void 0),c([T(cc.Node)],e.prototype,"ndRed",void 0),c([T({type:cc.Node,tooltip:"\u6682\u505c\u6309\u94ae"})],e.prototype,"btnPause",void 0),c([T({type:cc.Node,tooltip:"\u7f81\u7eca\u5c55\u793a"})],e.prototype,"ndTie",void 0),c([T({type:cc.Node,tooltip:"\u6392\u884c\u5c55\u793a"})],e.prototype,"ndRank",void 0),c([T({type:cc.Node,tooltip:"buff\u5c55\u793a"})],e.prototype,"ndBuff",void 0),c([T(P.default)],e.prototype,"ctrGame",void 0),c([D],e)}(l.default);a.default=S,cc._RF.pop(),cc._RF.pop()},{}],UIGuide:[function(t,e,o){"use strict";cc._RF.push(e,"13b341f1+lNtrnOaHjOg+no","UIGuide");var i=t,n=e,a=o;cc._RF.push(n,"13b341f1+lNtrnOaHjOg+no","UIGuide");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.GuildCfg=a.DirPos=void 0;var l,p=i("BaseUI"),u=i("Appcfg"),d=i("EventMgr"),h=i("Config"),f=cc._decorator,m=f.ccclass,g=f.property;!function(t){t[t.TopRight=0]="TopRight",t[t.TopLeft=1]="TopLeft",t[t.BottomLeft=2]="BottomLeft",t[t.BottomRight=3]="BottomRight"}(l=a.DirPos||(a.DirPos={})),a.GuildCfg=function(){this.clickType=0,this.distNode=null,this.tipstring=null,this.deviationTips=new cc.Vec2(0,0),this.deviationTipsAll=null,this.dir=l.TopRight,this.isWeek=!1,this.lightType=0,this.showHand=!0,this.delay=.1,this.startNode=null,this.deviationStart=new cc.Vec2(0,0),this.deviationEnd=new cc.Vec2(0,0),this.endNode=null,this.moveTime=1,this.hideMask=!1,this.addSize=new cc.Size(40,40),this.callBack=null,this.finishMoveEnd=!1,d.EventMgr.getInstance().emit(u.BaseEventName.blocktouch,!1)};var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mask=null,e.hand=null,e.hand1=null,e.hand2=null,e.tipBg=null,e.tipText=null,e.distNode=null,e.dirPos=l.TopRight,e}return s(e,t),e.prototype.init=function(t){this.cfg=t},e.prototype.clickTouch=function(t){var e,o=this;if(this.hand.active=!1,this.tipBg.active=!1,this.cfg=t,t.dir&&(this.dirPos=t.dir),t.distNode){this.distNode=t.distNode;var i=this.distNode.convertToWorldSpaceAR(cc.Vec2.ZERO),n=this.mask.node.parent.convertToNodeSpaceAR(i);this.mask.node.setPosition(n),this.mask.node.setContentSize(900,900),e=t.distNode.getContentSize()}else e=new cc.Size(0,0),this.mask.node.setPosition(cc.Vec2.ZERO),this.mask.node.setContentSize(0,0);this.mask.node.active=!0,this.scheduleOnce(function(){0==t.lightType?o.mask.type=cc.Mask.Type.ELLIPSE:o.mask.type=cc.Mask.Type.RECT},.01),t.isWeek&&t.hideMask?(this.mask.node.active=!1,this.scheduleOnce(function(){d.EventMgr.getInstance().emit(u.BaseEventName.blocktouch,!0)},.1),this.showHand(),this.showTip(t.tipstring)):cc.tween(this.mask.node).to(.7,{width:e.width+this.cfg.addSize.width,height:e.height+this.cfg.addSize.height}).call(function(){o.showHand(),o.showTip(t.tipstring)}).delay(.1).call(function(){d.EventMgr.getInstance().emit(u.BaseEventName.blocktouch,!0)}).start()},e.prototype.moveTouch=function(t){var e=this;if(t.startNode&&t.endNode){this.schedule(function(){e.cfg.finishMoveEnd&&(e.unscheduleAllCallbacks(),e.closeUI())}),t.hideMask?this.mask.node.active=!1:this.mask.node.active=!0;var o=t.startNode.convertToWorldSpaceAR(t.deviationStart),i=t.endNode.convertToWorldSpaceAR(t.deviationEnd),n=this.hand.parent.convertToNodeSpaceAR(o),a=this.hand.parent.convertToNodeSpaceAR(i);if(this.hand.setPosition(n),this.hand.active=!0,this.moveTween=cc.tween(this.hand).set({position:cc.v3(n)}).to(t.moveTime,{position:new cc.Vec3(a.x,a.y)}).delay(.5).union().repeatForever(),this.moveTween.start(),t.hideMask)this.showHand(),this.showTip(t.tipstring);else{var r,s,c,l;0==t.lightType?this.mask.type=cc.Mask.Type.ELLIPSE:this.mask.type=cc.Mask.Type.RECT,r=Math.min(n.x-t.startNode.width/2,a.x-t.endNode.width/2),s=Math.max(n.x+t.startNode.width/2,a.x+t.endNode.width/2),c=Math.min(n.y-t.startNode.height/2,a.y-t.endNode.height/2),l=Math.max(n.y+t.startNode.height/2,a.y+t.endNode.height/2);var p=cc.v2((r+s)/2,(c+l)/2);this.mask.node.setPosition(p);var h=new cc.Size(Math.abs(s-r),Math.abs(l-c));cc.tween(this.mask.node).to(.7,{width:h.width+this.cfg.addSize.width,height:h.height+this.cfg.addSize.height}).call(function(){e.showHand(),e.showTip(t.tipstring)}).delay(.1).call(function(){d.EventMgr.getInstance().emit(u.BaseEventName.blocktouch,!0)}).start()}}else this.closeUI()},e.prototype.start=function(){var t=this;this.tipBg.getChildByName("zx").active=this.fromId==h.UIID.UIGame,this.tipBg.getChildByName("ds").active=this.fromId==h.UIID.UIHome,(!this.cfg.delay||this.cfg.delay<.1)&&(this.cfg.delay=.1),this.scheduleOnce(function(){0==t.cfg.clickType?t.clickTouch(t.cfg):t.moveTouch(t.cfg)},this.cfg.delay),this.node.on(cc.Node.EventType.TOUCH_START,function(e){if(t.cfg.isWeek||!t.mask.node.active)return t.cfg.callBack?t.cfg.callBack():t.node._touchListener.setSwallowTouches(!1),void t.closeUI();(t.distNode||t.cfg.startNode)&&(0!=t.cfg.clickType?t.cfg.startNode.getBoundingBoxToWorld():t.distNode.getBoundingBoxToWorld()).contains(e.getLocation())&&(t.cfg.callBack?t.cfg.callBack():t.node._touchListener.setSwallowTouches(!1),0==t.cfg.clickType&&t.closeUI())},this),this.mask.node.getChildByName("bg").on(cc.Node.EventType.TOUCH_START,function(e){if(t.cfg.isWeek||!t.mask.node.active)return t.cfg.callBack?t.cfg.callBack():t.node._touchListener.setSwallowTouches(!1),void t.closeUI();t.distNode&&t.distNode.getBoundingBoxToWorld().contains(e.getLocation())&&(t.cfg.callBack?t.cfg.callBack():t.node._touchListener.setSwallowTouches(!1),t.closeUI())},this)},e.prototype.showHand=function(){this.cfg.showHand&&(this.hand.setPosition(this.mask.node.position),this.hand.active=!0)},e.prototype.showTip=function(t){if(t&&t.length>0){if(this.tipBg.active=!0,this.cfg.deviationTipsAll)this.tipBg.setPosition(this.cfg.deviationTipsAll);else{var e=this.mask.node.getPosition();e.addSelf(this.cfg.deviationTips),this.tipBg.setPosition(e)}this.tipText.string=t}else this.tipBg.active=!1},c([g(cc.Mask)],e.prototype,"mask",void 0),c([g(cc.Node)],e.prototype,"hand",void 0),c([g(cc.Node)],e.prototype,"hand1",void 0),c([g(cc.Node)],e.prototype,"hand2",void 0),c([g(cc.Node)],e.prototype,"tipBg",void 0),c([g(cc.Label)],e.prototype,"tipText",void 0),c([m],e)}(p.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],UIHome:[function(t,e,o){"use strict";cc._RF.push(e,"c7579ljm/FFjKMoISpmDA53","UIHome");var i=t,n=e,a=o;cc._RF.push(n,"c7579ljm/FFjKMoISpmDA53","UIHome");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DRA_Configs"),p=i("Main"),u=i("BaseUI"),d=i("Appcfg"),h=i("AudioMgr"),f=i("FeedCardMgr"),m=i("UIMgr"),g=i("Utils"),y=i("Config"),v=i("TextConfig"),_=i("BraveTowerEnum"),b=i("GameTrackDataEvent"),B=i("DataMgr"),I=i("PlayerMgr"),P=i("UIGuide"),C=i("HomeBattleCtrl"),D=i("HomeBossCtrl"),T=i("HomeCardCtrl"),S=i("HomeShopCtrl"),A=cc._decorator,k=A.ccclass,w=A.property,N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.togCon=null,e.ctrShop=null,e.ctrBattle=null,e.ctrCard=null,e.ctrBoss=null,e.lockStage5=2,e.tag="Toggle3",e.tagNode=null,e}return s(e,t),e.prototype.start=function(){this.initEventListener(),this.initBtnListener(),this.initView(),l.Global.isDirect?I.PlayerMgr.getInstance().getGuideData().addCurrentId():I.PlayerMgr.getInstance().getGuideData().getGuideEnd(1)?I.PlayerMgr.getInstance().getGuideData().getGuideEnd(2)||I.PlayerMgr.getInstance().getGuideData().setCurrentId(8):I.PlayerMgr.getInstance().getGuideData().setCurrentId(1)},e.prototype.initEventListener=function(){var t=this;this.addEvent(d.BaseEventName.CloseUI,this.onCloseUI),this.addEvent(_.BraveTowerEventName.UpdateRedPoint,this.showRed),this.addEvent(_.BraveTowerEventName.SwitchTab,function(e){t.togCon.toggleItems[e].isChecked=!0,t.showView(t.togCon.toggleItems[e])}),this.addEvent(y.EventName.RefreshDiamond,function(){t.showRed(2)})},e.prototype.onEnable=function(){var t=this;h.AudioMgr.getInstance().playMusic(y.AudioId.main,_.BraveTowerParameter.BGMusic),this.showRed(31),p.default.instance.uiTop.node.active=!0,this.initViewTogg(),this.sendEvent(d.BaseEventName.blocktouch,!0),this.scheduleOnce(function(){t.showPop()},.5)},e.prototype.onDisable=function(){p.default.instance.uiTop.node.active=!1},e.prototype.initView=function(){this.togCon.node.active=!0,this.tag1=this.togCon.node.getChildByName(this.tag).getComponent(cc.Toggle),this.tag1.node.getChildByName("Background").active=!1,this.tag1.isChecked=!0,this.tagNode=this.ctrBattle.node,this.ctrShop.node.active=!1,this.ctrBattle.node.active=!1,this.ctrCard.node.active=!1,this.ctrBoss.node.active=!1,this.tagNode.active=!0},e.prototype.initViewTogg=function(){this.togCon.node.getChildByName("Toggle1").getChildByName("ndLock").active=!0,this.togCon.node.getChildByName("Toggle2").getChildByName("ndLock").active=!1,this.togCon.node.getChildByName("Toggle3").getChildByName("ndLock").active=!1,this.togCon.node.getChildByName("Toggle4").getChildByName("ndLock").active=!1,this.togCon.node.getChildByName("Toggle5").getChildByName("ndLock").active=I.PlayerMgr.getInstance().getUserData().getMaxStage()<=this.lockStage5},e.prototype.initBtnListener=function(){for(var t=0;t<this.togCon.toggleItems.length;t++)this.togCon.toggleItems[t].node.on("toggle",this.showView,this)},e.prototype.showView=function(t){if(t.isChecked&&this.tag!=t.node.name){h.AudioMgr.getInstance().playAudioButtonClicked(),this.tagNode.active=!1;var e=!1;switch(t.node.name){case"Toggle1":this.openUI(y.UIID.UITips,v.TextConfig.Tips06);break;case"Toggle2":e=!0,this.tagNode=this.ctrShop.node;break;case"Toggle3":e=!0,this.tagNode=this.ctrBattle.node;break;case"Toggle4":e=!0,this.tagNode=this.ctrCard.node;break;case"Toggle5":I.PlayerMgr.getInstance().getUserData().getMaxStage()<=this.lockStage5?this.openUI(y.UIID.UITips,g.Utils.StringFormat(this.T(v.TextConfig.Tips16),this.lockStage5)):(e=!0,this.tagNode=this.ctrBoss.node)}e?(t.node.getChildByName("Background").active=!1,this.tag1.node.getChildByName("Background").active=!0,this.tag=t.node.name,this.tag1=t):this.tag1.isChecked=!0,this.tagNode.active=!0}},e.prototype.onCloseUI=function(t){var e=this;t==y.UIID.UIGuide&&this.scheduleOnce(function(){e.startGuide()},.5),t!=y.UIID.UIGame&&t!=y.UIID.UICardLock&&t!=y.UIID.UIReward||this.showPop()},e.prototype.startGuide=function(){if(!I.PlayerMgr.getInstance().getGuideData().getGuideEnd(2)){var t=I.PlayerMgr.getInstance().getGuideData().getCurrentId(),e=new P.GuildCfg;switch(t){case 1:e.distNode=this.ctrBattle.btnBattle,e.tipstring=this.T(v.TextConfig.Guide01),e.deviationTipsAll=cc.v2(0,0),e.addSize=new cc.Size(0,0),e.lightType=1,I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.guide2);break;case 8:if(m.UIMgr.getInstance().getUIById(y.UIID.UIGame))return e=null,void this.sendEvent(d.BaseEventName.blocktouch,!0);e.distNode=this.togCon.toggleItems[1].node,e.tipstring=this.T(v.TextConfig.Guide07),e.deviationTipsAll=cc.v2(0,0),e.addSize=new cc.Size(0,0),e.lightType=1,I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.guide8);break;case 9:e.distNode=this.ctrShop.btnSingle,e.tipstring=this.T(v.TextConfig.Guide08),e.deviationTipsAll=cc.v2(0,0),e.addSize=new cc.Size(0,0),e.lightType=1,I.PlayerMgr.getInstance().getTrackData().youmengTrack(b.TrackId.guide9);break;default:e=null,this.sendEvent(d.BaseEventName.blocktouch,!0)}e&&this.openUICallBack(y.UIID.UIGuide,function(){I.PlayerMgr.getInstance().getGuideData().addCurrentId()},e)}},e.prototype.showRed=function(t){if(1&t){var e=!1;this.togCon.node.getChildByName("Toggle1").getChildByName("Background").getChildByName("ndRed").active=e,this.togCon.node.getChildByName("Toggle1").getChildByName("checkmark").getChildByName("ndRed").active=e}2&t&&(e=this.ctrShop.showRed(),this.togCon.node.getChildByName("Toggle2").getChildByName("Background").getChildByName("ndRed").active=e,this.togCon.node.getChildByName("Toggle2").getChildByName("checkmark").getChildByName("ndRed").active=e),4&t&&(e=this.ctrBattle.showRed(),this.togCon.node.getChildByName("Toggle3").getChildByName("Background").getChildByName("ndRed").active=e,this.togCon.node.getChildByName("Toggle3").getChildByName("checkmark").getChildByName("ndRed").active=e),8&t&&(e=this.ctrCard.showRed(),this.togCon.node.getChildByName("Toggle4").getChildByName("Background").getChildByName("ndRed").active=e,this.togCon.node.getChildByName("Toggle4").getChildByName("checkmark").getChildByName("ndRed").active=e),16&t&&(e=!1,this.togCon.node.getChildByName("Toggle5").getChildByName("Background").getChildByName("ndRed").active=e,this.togCon.node.getChildByName("Toggle5").getChildByName("checkmark").getChildByName("ndRed").active=e)},e.prototype.lockCard=function(){for(var t=I.PlayerMgr.getInstance().getUserData().getMaxStage(),e=B.DataMgr.getInstance().getCardCfgList(),o=[],i=0;i<e.length;i++){var n=e[i];n.lockStage&&n.lockStage<t&&(I.PlayerMgr.getInstance().getUserData().getCardById(n.id)||(I.PlayerMgr.getInstance().getUserData().addCardNum(n.id,1),o.push(n.id)))}return o.length>0&&(this.showRed(8),this.openUI(y.UIID.UICardLock,o,this.togCon.toggleItems[3].node),!0)},e.prototype.showPop=function(){var t=!0;if(f.FeedCardMgr.instance.getIsBytebroadside()){var e=B.DataMgr.getInstance().getCodeJoin(1);if(e){var o="gift_"+e.gift_num.toLocaleLowerCase();I.PlayerMgr.getInstance().getTrackData().getTimeByKey(o)<e.exchange_time&&(this.openUI(y.UIID.UIExchangeCode,e.gift_num),t=!1)}}t&&this.lockCard()&&(t=!1),l.Global.isDirect&&(t=!1),t&&this.startGuide()},c([w(cc.ToggleContainer)],e.prototype,"togCon",void 0),c([w(S.default)],e.prototype,"ctrShop",void 0),c([w(C.default)],e.prototype,"ctrBattle",void 0),c([w(T.default)],e.prototype,"ctrCard",void 0),c([w(D.default)],e.prototype,"ctrBoss",void 0),c([k],e)}(u.default);a.default=N,cc._RF.pop(),cc._RF.pop()},{}],UIMgr:[function(t,e,o){"use strict";cc._RF.push(e,"ce4b5DsRi9JnJiilB/Cdu7a","UIMgr");var i=t,n=e,a=o;cc._RF.push(n,"ce4b5DsRi9JnJiilB/Cdu7a","UIMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.UIMgr=void 0;var r=i("Config"),s=i("BaseUI"),c=i("Appcfg"),l=i("EventMgr"),p=i("LogMgr"),u=i("ResourceMgr"),d=function(t,e,o,i,n,a,r,s,c){this.uid=t,this.callback=i,this.parent=o,this.fromId=e,this.param1=n,this.param2=a,this.param3=r,this.param4=s,this.param5=c},h=function(){function t(){this.uistatck=new Map,this.uichace=new Map,this.orderMap=new Map,this.popStatck=[],this.logStatck=[],this.watingOpen=[],this.onlyShowOne=[],this.activityOne=[],this.layerNodeMap=new Map,this.otherUIConf=[],this.uiRoot=null,this.UIConf={},this.isopening=!1,this.touchTime=-1,this.leftNum=0,this.rightNum=0,this.isLeft=!1}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.preLoadUI=function(t,e){var o=this,i=this.getUICnf(t);i?u.ResourceMgr.getInstance().loadRes(i.bundleName,i.prefab,cc.Prefab,function(n){var a=cc.instantiate(n);a.name=i.name;var r=a.getComponent(s.default);o.uichace.set(t,r),e&&e()}):p.LogMgr.getInstance().error("ui\u6ca1\u6709\u914d\u7f6e\uff1a",t)},t.prototype.addLayerShowOne=function(t){this.onlyShowOne.push(t)},t.prototype.addLayerActivityOne=function(t){this.activityOne.push(t)},t.prototype.addUICnf=function(t){this.otherUIConf.push(t)},t.prototype.setConf=function(t){this.UIConf=t},t.prototype.Init=function(t){this.uiRoot=t,this.UIConf=r.UICF,this.touchTime=-1,this.addTipsNode()},t.prototype.addBlockTouch=function(){},t.prototype.addTipsNode=function(){var t=this;this.tipsNode&&this.tipsNode.destroy(),this.tipsNode=new cc.Node,this.tipsNode.height=cc.view.getVisibleSize().height,this.tipsNode.width=cc.view.getVisibleSize().width;var e=new cc.Node,o=e.addComponent(cc.Label);o.string="\u8457\u4f5c\u6743\u4eba\uff1a\u5b9e\u4e30\uff08\u6df1\u5733\uff09\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8",o.fontSize=20,e.parent=this.tipsNode,e.y=-(cc.view.getVisibleSize().height/2-20),e.active=!1,this.tipsNode.parent=this.uiRoot,this.tipsNode.zIndex=99999,this.tipsNode.on(cc.Node.EventType.TOUCH_START,function(o){var i=o.getStartLocation(),n=!1;if(i.x<100)n=!0;else{if(!(i.x>cc.view.getVisibleSize().width-100))return;n=!1}t.isLeft!=n&&(t.isLeft=n,(new Date).getTime()-t.touchTime<1e3?t.isLeft?t.leftNum++:t.rightNum++:t.isLeft?t.leftNum=0:t.rightNum=0,t.leftNum+t.rightNum>=30&&(e.active=!0,setTimeout(function(){e.active=!1},2e3)),t.touchTime=(new Date).getTime())}),this.tipsNode._touchListener.setSwallowTouches(!1)},t.prototype.openUIOfParent=function(t,e,o,i,n,a,r,s){this.open(t,e,o,i,n,a,r,s)},t.prototype.openUIOfCallback=function(t,e,o,i,n,a,r,s){this.open(t,e,this.uiRoot,o,i,n,a,r,s)},t.prototype.openUIOfParentAndCallback=function(t,e,o,i,n,a,r,s,c){this.open(t,e,o,i,n,a,r,s,c)},t.prototype.openUI=function(t,e,o,i,n,a,r){this.open(t,e,this.uiRoot,null,o,i,n,a,r)},t.prototype.open=function(t,e,o,i,n,a,r,h,f){var m=this;if(this.isopening){var g=new d(t,e,o,i,n,a,r,h,f);this.watingOpen.push(g)}else{this.isopening=!0;var y=this.getUICnf(t);if(null==y)return p.LogMgr.getInstance().debug(t+"\u4e0d\u5b58\u5728"),void(this.isopening=!1);var v=new d(t,e,o,i,n,a,r,h,f);if(this.popCanShow(t,y,v)){if(this.uistatck.get(t)&&!y.showMult)return p.LogMgr.getInstance().debug(t+"\u5df2\u7ecf\u5b58\u5728"),this.uistatck.get(t).node.getComponent(s.default).refreshUI(t,e,i,n,a,r,h,f),void(this.isopening=!1);l.EventMgr.getInstance().emit(c.BaseEventName.blocktouch,!1);var _=this.uichace.get(t);if(_){this.uistatck.set(t,_),_.init&&_.init(n,a,r,h,f),this.uichace.delete(t);var b=o.getChildByName(y.name);null==b&&((b=_.node).active=!1,b.name=y.name,o.addChild(b)),b.x=0,b.y=0,b.active=!1,_.layer=y.zIndex;var B=y.zIndex;this.orderMap.has(_.layer)&&(B=this.orderMap.get(_.layer)+1),this.orderMap.set(_.layer,B),b.zIndex=B,_.setUid(t),_.fromId=e,this.updateMainUI(t,y);var I=this.layerNodeMap.get(y.zIndex);if(I)I.push(b);else{var P=[];P.push(b),this.layerNodeMap.set(y.zIndex,P)}_.openAni(function(){l.EventMgr.getInstance().emit(c.BaseEventName.blocktouch,!0)}),i&&i(b),l.EventMgr.getInstance().emit(c.BaseEventName.OpenUI,t,b),this.isopening=!1,this.openWaiting(),b.active=!0}else u.ResourceMgr.getInstance().loadRes(y.bundleName,y.prefab,cc.Prefab,function(p){var u=cc.instantiate(p);u.active=!1,u.name=y.name,o.addChild(u);var d=u.getComponent(s.default);m.uistatck.set(t,d),d.init&&d.init(n,a,r,h,f),d.setUid(t),d.fromId=e,d.layer=y.zIndex;var g=y.zIndex;m.orderMap.has(d.layer)&&(g=m.orderMap.get(d.layer)+1),m.orderMap.set(d.layer,g),u.zIndex=g,u.x=0,u.y=0,m.updateMainUI(t,y);var v=m.layerNodeMap.get(y.zIndex);if(v)v.push(u);else{var _=[];_.push(u),m.layerNodeMap.set(y.zIndex,_)}d.openAni(function(){l.EventMgr.getInstance().emit(c.BaseEventName.blocktouch,!0)}),i&&i(u),l.EventMgr.getInstance().emit(c.BaseEventName.OpenUI,t,u),m.isopening=!1,m.openWaiting(),u.active=!0})}else this.isopening=!1}},t.prototype.getChildByName=function(t){return this.uiRoot.getChildByName(t)},t.prototype.openWaiting=function(){if(this.watingOpen.length>0){var t=this.watingOpen.pop();this.openUIOfParentAndCallback(t.uid,t.fromId,t.parent,t.callback,t.param1,t.param2,t.param3,t.param4,t.param5)}},t.prototype.closeUI=function(t,e,o,i,n){var a=this;if(null!=t&&t.isValid){var r=t.getComponent(s.default);r.closeAni(function(){var s=r.getUid(),p=a.getUICnf(s);if(r.onClose(),r.cache?(t.removeFromParent(),a.uichace.set(s,r)):t.destroy(),a.uistatck.delete(s),null!=p){var u=a.layerNodeMap.get(p.zIndex);if(u)for(var d=0;d<u.length;d++)if(u[d].name==t.name){u=u.splice(d,1);break}var h=r.layer;if(a.orderMap.has(r.layer)&&(h=a.orderMap.get(r.layer)-1)<r.layer&&(h=r.layer),a.orderMap.set(r.layer,h),l.EventMgr.getInstance().emit(c.BaseEventName.CloseUI,s,e,o,i,n),p.zIndex==c.OrderLayer.pop){if(a.popStatck.length>0){var f=a.popStatck.pop();a.openUIOfCallback(f.uid,f.fromId,f.callback,f.param1,f.param2,f.param3,f.param4,f.param5)}}else if(p.zIndex==c.OrderLayer.main){var m=a.layerNodeMap.get(p.zIndex);m&&m.length>0&&(m[m.length-1].active=!0)}else p.zIndex==c.OrderLayer.Log&&a.logStatck.length>0&&(f=a.logStatck.pop(),a.openUIOfCallback(f.uid,f.fromId,f.callback,f.param1,f.param2,f.param3,f.param4,f.param5));a.checkHomeShow()}})}else p.LogMgr.getInstance().debug("\u5173\u95ed\u5931\u8d25")},t.prototype.checkHomeShow=function(){},t.prototype.checkOtherEmpty=function(){var t=this.layerNodeMap.get(c.OrderLayer.pop),e=this.layerNodeMap.get(c.OrderLayer.pop2);return!(t&&t.length>0||e&&e.length>0)},t.prototype.updateMainUI=function(){},t.prototype.popCanShow=function(t,e,o){var i=this.layerNodeMap.get(e.zIndex);if(e.zIndex==c.OrderLayer.pop){if(i&&i.length>0){for(var n=0;n<this.popStatck.length;n++)if(this.popStatck[n].uid==t)return!1;return this.popStatck.push(o),!1}}else if(e.zIndex==c.OrderLayer.Log&&i&&i.length>0)return this.logStatck.push(o),!1;return!0},t.prototype.closeById=function(t,e,o,i,n,a){var r=this.uistatck.get(t);r?r.node?this.closeUI(r.node,e,o,i,n,a):p.LogMgr.getInstance().debug("\u5173\u95ed\u5931\u8d252"):p.LogMgr.getInstance().debug("\u5173\u95ed\u5931\u8d251")},t.prototype.getUIById=function(t){var e=this.uistatck.get(t);if(e)return e;var o=this.uiRoot.getChildByName(this.getUICnf(t).name);return o?o.getComponent(s.default):null},t.prototype.getUIShowNum=function(t){var e=0;return this.uistatck.forEach(function(o,i){i==t&&e++}),e},t.prototype.getUIByIdWithNode=function(t,e){var o=this.uistatck.get(t);if(o)return o;if(null==e)return null;var i=e.getChildByName(this.getUICnf(t).name);return i?i.getComponent(s.default):null},t.prototype.getUICnf=function(t){var e=this.UIConf[t];if(e)return e;for(var o=0;o<this.otherUIConf.length;o++){var i=this.otherUIConf[o][t];if(i)return i}return null},t.instance=null,t}();a.UIMgr=h,cc._RF.pop(),cc._RF.pop()},{}],UIOnlineReward:[function(t,e,o){"use strict";cc._RF.push(e,"8cb275xWGFKgJgAYl1GUo4o","UIOnlineReward");var i=t,n=e,a=o;cc._RF.push(n,"8cb275xWGFKgJgAYl1GUo4o","UIOnlineReward");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("List"),u=i("ResourceMgr"),d=i("TextConfig"),h=i("BraveTowerEnum"),f=i("ItemGood"),m=i("DataMgr"),g=i("PlayerMgr"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctrList=null,e.btnClose=null,e}return s(e,t),e.prototype.start=function(){this.cfgList=m.DataMgr.getInstance().getRewardList(),this.initEventListener(),this.initBtnListener(),this.initView()},e.prototype.initEventListener=function(){this.addEvent(h.BraveTowerEventName.TimeUpdate,this.initView)},e.prototype.initBtnListener=function(){this.btnClose.on(cc.Node.EventType.TOUCH_END,this.closeUI,this)},e.prototype.initView=function(){this.onLineTime=Math.floor(g.PlayerMgr.getInstance().getDailyData().getOnlineTime()/60),this.ctrList.numItems=this.cfgList.length},e.prototype.initListItem=function(t,e){var o=this;t.active=!0;var i,n=this.cfgList[e],a=t.getChildByName("ndItem");a.itemData?(i=a.itemData).initView(n.reward[0],n.reward[1]):u.ResourceMgr.getInstance().getNode(h.BraveTowerPoolName.ItemGood,h.BraveTowerBundelName.Icon,h.BraveTowerPrefabName.ItemGood,function(t){t.setParent(a),t.setPosition(cc.Vec2.ZERO),t.setScale(1),i=t.getComponent(f.default),a.itemData=i,i.initView(n.reward[0],n.reward[1])}),t.getChildByName("labTime").getComponent(cc.Label).string=""+n.condition;var r=t.getChildByName("ndPro");r.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=this.onLineTime/n.condition,r.getChildByName("labPro").getComponent(cc.Label).string=this.onLineTime+"/"+n.condition;var s=g.PlayerMgr.getInstance().getDailyData().getOnlineTimeReward(e),c=t.getChildByName("btnGet");c.active=!1,c.off(cc.Node.EventType.TOUCH_END),s?(t.getChildByName("ndMask").active=!0,t.getChildByName("labTips").getComponent(cc.Label).string=this.T(d.TextConfig.Text30)):(t.getChildByName("ndMask").active=!1,t.getChildByName("labTips").getComponent(cc.Label).string=this.T(d.TextConfig.Text31),this.onLineTime>=n.condition&&(c.active=!0,c.on(cc.Node.EventType.TOUCH_END,function(){g.PlayerMgr.getInstance().getDailyData().setOnlineTimeReward(e);var i=[];i.push({id:n.reward[0],num:n.reward[1]});var r=g.PlayerMgr.getInstance().onRewardToStr(i),s=t.convertToWorldSpaceAR(a.position);g.PlayerMgr.getInstance().addRewards(r,1,s),o.sendEvent(h.BraveTowerEventName.UpdateRedPoint,4),o.sendEvent(h.BraveTowerEventName.TimeUpdate)},this)))},c([_(p.default)],e.prototype,"ctrList",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],UIReportTop:[function(t,e,o){"use strict";cc._RF.push(e,"c025czTyv9GtbsQ+dzqq7lC","UIReportTop");var i=t,n=e,a=o;cc._RF.push(n,"c025czTyv9GtbsQ+dzqq7lC","UIReportTop");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("Appcfg"),d=i("PlatformSetting"),h=i("PlatformManager"),f=i("SdkMgr"),m=i("Config"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn_Report=null,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.addEvent(u.BaseEventName.RefreshReport,function(e,o){if(t.btn_Report.active=e&&!f.SdkMgr.getInstance().getCheckVersion(d.SwitchID.ShenHe)&&d.PlatformSetting.currentPlatform!=l.Platform.WEB_LINK,e){var i=t.btn_Report.parent.convertToNodeSpaceAR(o);t.btn_Report.setPosition(i)}d.PlatformSetting.currentPlatform==l.Platform.EDITOR&&(t.btn_Report.active=!1)})},e.prototype.start=function(){var t=this;(f.SdkMgr.getInstance().getCheckVersion(d.SwitchID.ShenHe)||h.PlatformManager.currentPlatform==l.Platform.WEB_LINK||d.PlatformSetting.currentPlatform==l.Platform.EDITOR)&&(this.btn_Report.active=!1),h.PlatformManager.currentPlatform==l.Platform.EDITOR&&(this.btn_Report.active=!1),this.btn_Report.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(m.UIID.UIReport)})},c([v(cc.Node)],e.prototype,"btn_Report",void 0),c([y],e)}(p.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],UIReport:[function(t,e,o){"use strict";cc._RF.push(e,"5aee2+4pjVNa6KzAAOV3NPS","UIReport");var i=t,n=e,a=o;cc._RF.push(n,"5aee2+4pjVNa6KzAAOV3NPS","UIReport");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("GameTrackDataEvent"),u=i("PlayerMgr"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.root=null,e.btnClose=null,e.btnPublicity=null,e.btnDataloss=null,e.btnGameStuck=null,e.btnunableAD=null,e.btnRender=null,e.tips=null,e.Rendernum=0,e.select=0,e}return s(e,t),e.prototype.start=function(){this.initEvent()},e.prototype.initEvent=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.btnPublicity.parent.on(cc.Node.EventType.TOUCH_END,function(){t.btnPublicity.children[0].active=!t.btnPublicity.children[0].active,t.Radio(1),t.canRender()},this),this.btnDataloss.parent.on(cc.Node.EventType.TOUCH_END,function(){t.btnDataloss.children[0].active=!t.btnDataloss.children[0].active,t.Radio(2),t.canRender()},this),this.btnGameStuck.parent.on(cc.Node.EventType.TOUCH_END,function(){t.btnGameStuck.children[0].active=!t.btnGameStuck.children[0].active,t.Radio(3),t.canRender()},this),this.btnunableAD.parent.on(cc.Node.EventType.TOUCH_END,function(){t.btnunableAD.children[0].active=!t.btnunableAD.children[0].active,t.Radio(4),t.canRender()},this),this.btnRender.on(cc.Node.EventType.TOUCH_END,function(){t.Render()},this)},e.prototype.canRender=function(){this.btnPublicity.parent.children[0].active||this.btnDataloss.parent.children[0].active||this.btnGameStuck.parent.children[0].active||this.btnunableAD.parent.children[0].active?this.btnRender.active=!0:this.btnRender.active=!1},e.prototype.Radio=function(t){this.select=t,this.btnPublicity.children[0].active=!1,this.btnDataloss.children[0].active=!1,this.btnGameStuck.children[0].active=!1,this.btnunableAD.children[0].active=!1,1==t?this.btnPublicity.children[0].active=!0:2==t?this.btnDataloss.children[0].active=!0:3==t?this.btnGameStuck.children[0].active=!0:4==t&&(this.btnunableAD.children[0].active=!0)},e.prototype.Render=function(){u.PlayerMgr.getInstance().getTrackData().youmengTrack(p.TrackId.notice_X_Y,this.select,this.editBox.string),this.tips.active=!0,cc.tween(this.tips).to(1,{y:143.079}).start(),this.scheduleOnce(this.closeUI,1)},c([f(cc.Node)],e.prototype,"root",void 0),c([f(cc.Node)],e.prototype,"btnClose",void 0),c([f(cc.Node)],e.prototype,"btnPublicity",void 0),c([f(cc.Node)],e.prototype,"btnDataloss",void 0),c([f(cc.Node)],e.prototype,"btnGameStuck",void 0),c([f(cc.Node)],e.prototype,"btnunableAD",void 0),c([f(cc.Node)],e.prototype,"btnRender",void 0),c([f(cc.Node)],e.prototype,"tips",void 0),c([f(cc.EditBox)],e.prototype,"editBox",void 0),c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],UIRewardCard:[function(t,e,o){"use strict";cc._RF.push(e,"d3f5arJbWxJLbvGkYP5O2yF","UIRewardCard");var i=t,n=e,a=o;cc._RF.push(n,"d3f5arJbWxJLbvGkYP5O2yF","UIRewardCard");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Utils"),u=i("BraveTowerEnum"),d=i("UtilLayout"),h=i("DataMgr"),f=i("PlayerMgr"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTip=null,e.ctrLay=null,e.rewardData=null,e.rewardList=[],e}return s(e,t),e.prototype.init=function(t){this.rewardData=t},e.prototype.start=function(){var t=this;this.ndTip.active=!1,this.initData(),this.ctrLay.tmpNode.active=!1,this.ctrLay.init(this.rewardList.length),this.scheduleOnce(function(){t.ndTip.active=!0,t.initBtnListener()},.2*this.rewardList.length+1)},e.prototype.initData=function(){for(var t=0;t<this.rewardData.length;t++){var e=this.rewardData[t];this.rewardList.push({id:e.id,num:1,isNew:e.isNew})}},e.prototype.initBtnListener=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this)},e.prototype.initListItem=function(t,e){var o=t.getChildByName("spAni").getComponent(sp.Skeleton),i=t.getChildByName("ndMain");o.node.active=!1,this.scheduleOnce(function(){o.node.active=!0,o.setAnimation(0,"ani"+p.Utils.randomRang(1,4),!1),o.setEventListener(function(){i.active=!0,cc.tween(i).set({scale:.3}).to(.3,{scale:1.2}).to(.15,{scale:1}).start()})},.2*e),i.active=!1;var n=i.getChildByName("ndLight"),a=h.DataMgr.getInstance().getCardCfg(this.rewardList[e].id);if(n.children[0].active=3==a.quality,n.children[1].active=2==a.quality,u.BraveTowerGameUtils.aniAngle(n),i.getChildByName("labName").getComponent(cc.Label).string=this.T(a.name),this.loadSpriteFrame(u.BraveTowerBundelName.Icon,p.Utils.StringFormat(u.BraveTowerImgName.CardQuality,a.quality),function(t){i.getComponent(cc.Sprite).spriteFrame=t}),this.loadSpriteFrame(u.BraveTowerBundelName.IconCard,a.icon,function(t){i.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),i.getChildByName("labNew").active=this.rewardList[e].isNew,this.rewardList[e].isNew)i.getChildByName("ndPro").active=!1,i.getChildByName("sprPro").active=!1,i.getChildByName("labPro").active=!1;else{i.getChildByName("ndPro").active=!0,i.getChildByName("sprPro").active=!0,i.getChildByName("labPro").active=!0;var r=f.PlayerMgr.getInstance().getUserData().getCardById(this.rewardList[e].id),s=h.DataMgr.getInstance().getCardQualityCfg(a.quality).levelInfo[r.level-1].fragment;i.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=r.curNum/s,i.getChildByName("labPro").getComponent(cc.Label).string=r.curNum+"/"+s}},c([y(cc.Node)],e.prototype,"ndTip",void 0),c([y(d.UtilLayout)],e.prototype,"ctrLay",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],UIReward:[function(t,e,o){"use strict";cc._RF.push(e,"abfbe95pbhBILqrUcCzhxT6","UIReward");var i=t,n=e,a=o;cc._RF.push(n,"abfbe95pbhBILqrUcCzhxT6","UIReward");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("ResourceMgr"),u=i("BraveTowerEnum"),d=i("ItemGood"),h=i("UtilLayout"),f=i("PlayerMgr"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTop=null,e.ndTip=null,e.ctrLay=null,e.rewardData=null,e.rewardList=[],e}return s(e,t),e.prototype.init=function(t){this.rewardData=t},e.prototype.start=function(){var t=this;this.ndTip.active=!1,this.initData(),this.scheduleOnce(function(){t.ndTip.active=!0,t.initBtnListener()},.2*this.rewardList.length+1),this.initView()},e.prototype.initData=function(){this.rewardList=f.PlayerMgr.getInstance().onStrToReward(this.rewardData),this.ctrLay.init(this.rewardList.length)},e.prototype.initBtnListener=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this)},e.prototype.initView=function(){for(var t=this,e=function(e){var i=o.rewardList[e];p.ResourceMgr.getInstance().getNode(u.BraveTowerPoolName.ItemGood,u.BraveTowerBundelName.Icon,u.BraveTowerPrefabName.ItemGood,function(o){o.setParent(t.ctrLay.node),t.scheduleOnce(function(){cc.tween(o).set({scale:.3}).to(.3,{scale:1.2}).to(.15,{scale:1}).start()},.2*e);var n=t.ctrLay.getPos(e);o.setPosition(n),o.getComponent(d.default).initView(i.id,i.num,!0)})},o=this,i=0;i<this.rewardList.length;i++)e(i)},c([y(cc.Node)],e.prototype,"ndTop",void 0),c([y(cc.Node)],e.prototype,"ndTip",void 0),c([y(h.UtilLayout)],e.prototype,"ctrLay",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],UISelectBuff:[function(t,e,o){"use strict";cc._RF.push(e,"e0bbcSqBP5Lm7VcGlr/UiDA","UISelectBuff");var i=t,n=e,a=o;cc._RF.push(n,"e0bbcSqBP5Lm7VcGlr/UiDA","UISelectBuff");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("BaseUI"),u=i("AudioMgr"),d=i("SdkMgr"),h=i("Utils"),f=i("BraveTowerEnum"),m=i("GameCtrl"),g=i("GameTrackDataEvent"),y=i("DataMgr"),v=i("PlayerMgr"),_=cc._decorator,b=_.ccclass,B=_.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndItem=null,e.ndLay=null,e.btnRefresh=null,e.btnGetAll=null,e.ndCard=null,e.ndItemList=[],e.hasMax=!1,e.selInfo=[],e.isAni=!1,e}return s(e,t),e.prototype.start=function(){var t=this;this.initData(),this.btnRefresh.active=!0,f.BraveTowerSwitch.BuffAll()?(this.btnGetAll.active=!0,this.btnRefresh.x=-this.btnGetAll.x):(this.btnGetAll.active=!1,this.btnRefresh.x=0),this.onRefreshBuff(),this.ndItem.active=!1;for(var e=function(e){var i=cc.instantiate(o.ndItem);i.parent=o.ndLay,i.active=!0,i.setPosition(0,0),o.ndItemList[e]=i,o.showItem(e),cc.tween(i).set({scale:0}).delay(.2+.1*e).set({scaleX:1.1,scaleY:.5}).to(.12,{scaleX:.9,scaleY:1.2}).to(.09,{scaleX:1.05,scaleY:.95}).to(.06,{scale:1}).start(),i.on(cc.Node.EventType.TOUCH_END,function(){u.AudioMgr.getInstance().playAudioButtonClicked(),t.clickItem(e)},o)},o=this,i=0;i<3;i++)e(i);this.btnRefresh.on(cc.Node.EventType.TOUCH_END,function(){d.SdkMgr.getInstance().playVideo(d.AdType.AdFreeTime,function(){var e;v.PlayerMgr.getInstance().getTrackData().youmengTrack(g.TrackId.Gain_replace),v.PlayerMgr.getInstance().getTrackData().youmengTrack(g.TrackId.Gain_replace_X,(e=v.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?e:Math.floor((e-1)/5)+5),t.hasMax=!0,t.isAni=!0,t.onRefreshBuff();for(var o=function(e){cc.tween(t.ndItemList[e]).to(.2,{scaleX:0}).call(function(){t.showItem(e)}).to(.2,{scaleX:1}).call(function(){t.isAni=!1}).start()},i=0;i<3;i++)o(i)})},this),this.btnGetAll.on(cc.Node.EventType.TOUCH_END,function(){d.SdkMgr.getInstance().playVideo(d.AdType.AdFreeTime,function(){var e;v.PlayerMgr.getInstance().getTrackData().youmengTrack(g.TrackId.Gain_all),v.PlayerMgr.getInstance().getTrackData().youmengTrack(g.TrackId.Gain_all_X,(e=v.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?e:Math.floor((e-1)/5)+5),t.isAni=!0;for(var o=0;o<t.ndItemList.length;o++){var i=t.ndItemList[o];0==o?cc.tween(i).to(.1,{scale:1.2}).delay(.1).call(function(){for(var e=[],o=0;o<t.selInfo.length;o++)e.push(t.selInfo[o].id);m.default.instance.gameBuff.addBuff(e),t.closeUI()}).start():cc.tween(i).to(.1,{scale:1.2}).delay(.1).start()}})},this);var n=m.default.instance.ctrUI.getAllCardList(),a=Math.max(n.length,this.ndCard.childrenCount),r=function(t){var e=s.ndCard.children[t],o=n[t];if(o){e||((e=cc.instantiate(s.ndCard.children[0])).parent=s.ndCard,e.y=s.ndCard.children[0].y),e.active=!0;var i=y.DataMgr.getInstance().getCardCfg(o.cardId);s.loadSpriteFrame(f.BraveTowerBundelName.IconCardHead,i.head,function(t){e.getComponent(cc.Sprite).spriteFrame=t})}else e.active=!1},s=this;for(i=0;i<a;i++)r(i)},e.prototype.initData=function(){var t=y.DataMgr.getInstance().getBuffCfgList();this.buffList=[];for(var e=0;e<t.length;e++){var o=t[e];m.default.instance.gameBuff.hasBuff(o.id)||this.buffList.push({id:o.id,cfg:o,weight:o.probability})}console.log("\u53ef\u51fa\u73b0buff\u5217\u8868",this.buffList)},e.prototype.onRefreshBuff=function(){this.selInfo=[];var t=l(this.buffList);if(1==f.BraveTowerSwitch.BuffRefreshType()){if(this.hasMax){for(var e=[],o=0;o<t.length;o++)3==(r=t[o]).cfg.quality&&e.push(r);if(d=h.Utils.weight_rand(e))for(this.selInfo.push(d.cfg),o=0;o<t.length;o++)if((r=t[o]).id==d.id){t.splice(o,1);break}}console.log("buff\u9009\u62e9\u5217\u8868",t);do{if(!(d=h.Utils.weight_rand(t)))break;for(this.selInfo.push(d.cfg),o=0;o<t.length;o++)if((r=t[o]).id==d.id){t.splice(o,1);break}}while(t.length>0&&this.selInfo.length<3)}else{var i=[];this.buffList.forEach(function(t){i[t.cfg.quality]=1});var n=y.DataMgr.getInstance().getBuffFarray(),a=[];for(o=0;o<n.length;o++){for(var r=n[o],s=!1,c=0;c<r.quality.length;c++)if(!i[r.quality[c]]){s=!0;break}s||(this.hasMax?2==r.type&&a.push({id:r.id,weight:r.probability,quality:r.quality}):1==r.type&&a.push({id:r.id,weight:r.probability,quality:r.quality}))}if(0==a.length){console.log("\u65e0\u53ef\u80fd\u7ec4\u5408buff",i);do{if(!(d=h.Utils.weight_rand(t)))break;for(this.selInfo.push(d.cfg),o=0;o<t.length;o++)if((r=t[o]).id==d.id){t.splice(o,1);break}}while(t.length>0&&this.selInfo.length<3)}else{var p=h.Utils.weight_rand(a);console.log("buff\u9009\u62e9\u5217\u8868",a,"\u968f\u673abuff",p);for(var u=0;u<p.quality.length;u++){for(e=[],c=0;c<t.length;c++)(r=t[c]).cfg.quality==p.quality[u]&&e.push(r);var d;if(d=h.Utils.weight_rand(e)){for(this.selInfo.push(d.cfg),o=0;o<t.length;o++)if((r=t[o]).id==d.id){t.splice(o,1);break}}else console.error("\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684buff",p,t)}}}this.selInfo.sort(function(){return Math.random()-.5})},e.prototype.showItem=function(t){var e=this.ndItemList[t];if(this.selInfo[t]){var o=this.selInfo[t],i=e.getChildByName("labName").getComponent(cc.Label),n=e.getChildByName("sprIcon").getComponent(cc.Sprite),a=e.getChildByName("labInfo").getComponent(cc.RichText);i.string=this.T(o.name),this.loadSpriteFrame(f.BraveTowerBundelName.Icon,"yz_zy_pzd"+o.quality,function(t){e.getComponent(cc.Sprite).spriteFrame=t}),this.loadSpriteFrame(f.BraveTowerBundelName.IconBuff,o.icon,function(t){n.spriteFrame=t});for(var r=[],s=o.value,c=0;c<s.length;c++)o.vaulePercentage[c]?r.push("<color=#f95cff>"+s[c]+"</c>"):r.push("<color=#f95cff>"+Math.round(1e4*s[c])/100+"%</c>");a.string="<b><outline color=\u201c#000000\u201d width=4>"+h.Utils.StringFormat.apply(h.Utils,l([o.info],r))+"</outline></b>";var p=e.getChildByName("ndHead");if(o.buffHero&&o.buffHero.length>0){p.active=!0;for(var u=Math.max(o.buffHero.length,p.childrenCount),d=function(t){var e=p.children[t],i=o.buffHero[t];if(i){e||((e=cc.instantiate(p.children[0])).parent=p,e.y=p.children[0].y),e.active=!0;var n=y.DataMgr.getInstance().getCardCfg(i);g.loadSpriteFrame(f.BraveTowerBundelName.IconCardHead,n.head,function(t){e.getComponent(cc.Sprite).spriteFrame=t}),e.children[0].active=!!m.default.instance.ctrUI.getCard(i)}else e.active=!1},g=this,v=0;v<u;v++)d(v)}else p.active=!1;e.getChildByName("ndAni").active=o.quality>=3}else e.active=!1},e.prototype.clickItem=function(t){var e=this;if(!this.isAni){this.isAni=!0;for(var o=function(o){var n=i.ndItemList[o];t==o?cc.tween(n).to(.1,{scale:1.2}).delay(.1).call(function(){m.default.instance.gameBuff.addBuff([e.selInfo[o].id]),e.closeUI()}).start():cc.tween(n).to(.1,{scaleX:0}).start()},i=this,n=0;n<this.ndItemList.length;n++)o(n)}},c([B(cc.Node)],e.prototype,"ndItem",void 0),c([B(cc.Node)],e.prototype,"ndLay",void 0),c([B(cc.Node)],e.prototype,"btnRefresh",void 0),c([B(cc.Node)],e.prototype,"btnGetAll",void 0),c([B(cc.Node)],e.prototype,"ndCard",void 0),c([b],e)}(p.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"950d4miT3xKtr4bRt5XrgDr","UISetting");var i=t,n=e,a=o;cc._RF.push(n,"950d4miT3xKtr4bRt5XrgDr","UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformConfig"),d=i("PlatformSetting"),h=i("AudioMgr"),f=i("SdkMgr"),m=i("ServerDataMgr"),g=i("Config"),y=i("PlayerMgr"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.version=null,e.btnCleardata=null,e.btnAddGold=null,e.btnAddDiam=null,e.btnPOP=null,e._musicBg2=null,e._effectBg2=null,e}return s(e,t),e.prototype.onEnable=function(){this.musicSlider.progress=h.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=h.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress);var o=y.PlayerMgr.getInstance();this.version.string="lv"+o.getTrackData().getVersionConf()+"_"+o.getTrackData().getVersionName()+"_"+o.getAbType(),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),h.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),h.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this);var e=d.PlatformSetting.currentPlatform==l.Platform.WECHAT&&u.ServerDataCfg[d.PlatformSetting.currentApp].wechatOpened,o=d.PlatformSetting.currentPlatform==l.Platform.BYTEDANCE&&u.ServerDataCfg[d.PlatformSetting.currentApp].douyinOpened;this.btnCleardata.node.parent.active=e||o,this.btnCleardata.node.on(cc.Node.EventType.TOUCH_END,function(){m.ServerdataMgr.clearAllData(function(){})},this),this.btnPOP.active=d.PlatformSetting.currentPlatform==l.Platform.OPPO||d.PlatformSetting.currentPlatform==l.Platform.EDITOR,this.btnPOP&&this.btnPOP.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(g.UIID.PopUserPrivacy,1)}),this.btnAddGold.active=d.PlatformSetting.currentPlatform==l.Platform.EDITOR||d.PlatformSetting.currentPlatform==l.Platform.WEB_LINK||f.SdkMgr.getInstance().getCheckVersion(d.SwitchID.ShenHe_ABD),this.btnAddGold.on(cc.Node.EventType.TOUCH_END,function(){y.PlayerMgr.getInstance().getUserData().addGoldNum(1e4)},this),this.btnAddDiam.active=d.PlatformSetting.currentPlatform==l.Platform.EDITOR||d.PlatformSetting.currentPlatform==l.Platform.WEB_LINK||f.SdkMgr.getInstance().getCheckVersion(d.SwitchID.ShenHe_ABD),this.btnAddDiam.on(cc.Node.EventType.TOUCH_END,function(){y.PlayerMgr.getInstance().getUserData().addDiamondNum(1e4)},this)},c([b(cc.Slider)],e.prototype,"musicSlider",void 0),c([b(cc.Slider)],e.prototype,"effectSlider",void 0),c([b(cc.Node)],e.prototype,"btnClose",void 0),c([b(cc.Label)],e.prototype,"version",void 0),c([b(cc.Label)],e.prototype,"btnCleardata",void 0),c([b(cc.Node)],e.prototype,"btnAddGold",void 0),c([b(cc.Node)],e.prototype,"btnAddDiam",void 0),c([b({type:cc.Node,tooltip:"\u9690\u79c1\u653f\u7b56"})],e.prototype,"btnPOP",void 0),c([_],e)}(p.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],UIShopBox:[function(t,e,o){"use strict";cc._RF.push(e,"c2b39kVatRD4Zl6DgduAhrH","UIShopBox");var i=t,n=e,a=o;cc._RF.push(n,"c2b39kVatRD4Zl6DgduAhrH","UIShopBox");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("Config"),d=i("ItemGood"),h=i("UtilLayout"),f=i("DataMgr"),m=i("PlayerMgr"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndType1=null,e.ndType2=null,e.ctrLay=null,e.btnClose=null,e.btnGet=null,e.index=0,e.type=1,e}return s(e,t),e.prototype.init=function(t,e){this.index=t,this.type=e},e.prototype.start=function(){this.initData(),this.initBtnListener(),this.initView()},e.prototype.initData=function(){var t=f.DataMgr.getInstance().getDrawCardsRewardList();this.cfgDraw=t[this.index],this.ctrLay.init(this.cfgDraw.Reward.length)},e.prototype.initBtnListener=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.btnGet.on(cc.Node.EventType.TOUCH_END,function(){for(var e=t.cfgDraw.Reward,o=[],i=0;i<e.length;i++)o.push({id:e[i][0],num:e[i][1]});var n=m.PlayerMgr.getInstance().onRewardToStr(o);m.PlayerMgr.getInstance().addRewardPop(n),m.PlayerMgr.getInstance().getUserData().addDrawList(t.index);for(var a=m.PlayerMgr.getInstance().getUserData().getDrawList(),r=f.DataMgr.getInstance().getDrawCardsRewardList(),s=!0,c=0;c<r.length;c++)if(1!=a[c]){s=!1;break}s&&m.PlayerMgr.getInstance().getUserData().cleanDrawList(r[r.length-1].AccumulateNum),p.AudioMgr.getInstance().playEffect(u.AudioId.treasure),t.closeUI(!0)})},e.prototype.initView=function(){this.ndType1.active=1==this.type,this.ndType2.active=2==this.type;var t=m.PlayerMgr.getInstance().getUserData().getDrawTimes(),e=m.PlayerMgr.getInstance().getUserData().getDrawList();t>=this.cfgDraw.AccumulateNum&&1!=e[this.index]?(this.btnClose.active=!1,this.btnGet.active=!0):(this.btnClose.active=!0,this.btnGet.active=!1)},e.prototype.initListItem=function(t,e){var o=this.cfgDraw.Reward[e],i=f.DataMgr.getInstance().getGoodsCfgById(o[0]);t.getComponent(d.default).initView(i.enumValue,o[1],!1),t.getChildByName("labName").getComponent(cc.Label).string=this.T(i.name)},c([v({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"ndType1",void 0),c([v({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"ndType2",void 0),c([v(h.UtilLayout)],e.prototype,"ctrLay",void 0),c([v({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([v({type:cc.Node,tooltip:"\u9886\u53d6"})],e.prototype,"btnGet",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],UIShopOdds:[function(t,e,o){"use strict";cc._RF.push(e,"26a7ag+nZlJoprQhz6Im0j6","UIShopOdds");var i=t,n=e,a=o;cc._RF.push(n,"26a7ag+nZlJoprQhz6Im0j6","UIShopOdds");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e}return s(e,t),e.prototype.start=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this)},c([d({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],UISideBoard:[function(t,e,o){"use strict";cc._RF.push(e,"ae50fFbv75IYovYVL2Vs9/N","UISideBoard");var i=t,n=e,a=o;cc._RF.push(n,"ae50fFbv75IYovYVL2Vs9/N","UISideBoard");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Appcfg"),u=i("SdkMgr"),d=i("CacheUtils"),h=i("Config"),f=i("GameTrackDataEvent"),m=i("GameEnumData"),g=i("DataMgr"),y=i("PlayerMgr"),v=cc._decorator,_=v.ccclass,b=v.property,B=h.GameConfig.AppCacheName+"SIDE_BOARD_REWARD",I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labNum=null,e.btnClose=null,e.btnGo=null,e.btnReward=null,e}return s(e,t),e.prototype.start=function(){var t=this,e=parseInt(g.DataMgr.getInstance().getParamCfg(m.BraveTowerEnumParamsCfg.Params13));this.labNum.string="x"+e,this.btnGo.on(cc.Node.EventType.TOUCH_END,function(){u.SdkMgr.getInstance().checkCanOpenSideBar(function(t){t&&u.SdkMgr.getInstance().openSideBar()})},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this),this.btnReward.on(cc.Node.EventType.TOUCH_END,function(){y.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.add_sidebar);var o=u.SdkMgr.getInstance().isFromBroadside(t._options),i=d.CacheUtils.getData(B);o&&"1"!=i&&(d.CacheUtils.saveData(B,"1"),y.PlayerMgr.getInstance().getUserData().addGoldNum(e),y.PlayerMgr.getInstance().getTaskData().addGetGold(e),t.onAppShow(null),t.closeUI())},this),this.addEvent(p.BaseEventName.onShow,this.onAppShow),this.onAppShow()},e.prototype.onAppShow=function(t){if(this._options=t,t&&console.log("onShow",t),"1"==d.CacheUtils.getData(B))return this.btnGo.active=!1,void(this.btnReward.active=!1);u.SdkMgr.getInstance().isFromBroadside(t)?(this.btnGo.active=!1,this.btnReward.active=!0):(this.btnGo.active=!0,this.btnReward.active=!1)},c([b({type:cc.Label,tooltip:"\u6570\u91cf"})],e.prototype,"labNum",void 0),c([b(cc.Node)],e.prototype,"btnClose",void 0),c([b(cc.Node)],e.prototype,"btnGo",void 0),c([b(cc.Node)],e.prototype,"btnReward",void 0),c([_],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],UISign:[function(t,e,o){"use strict";cc._RF.push(e,"312d9CLp9NM9I5n+fw6DoYd","UISign");var i=t,n=e,a=o;cc._RF.push(n,"312d9CLp9NM9I5n+fw6DoYd","UISign");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("SdkMgr"),u=i("Utils"),d=i("TextConfig"),h=i("BraveTowerEnum"),f=i("GameTrackDataEvent"),m=i("DataMgr"),g=i("PlayerMgr"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndDayList=[null],e.btnSign=null,e.btnVide=null,e.btnDouble=null,e.btnGet=null,e.btnClose=null,e}return s(e,t),e.prototype.start=function(){this.cfgList=m.DataMgr.getInstance().getSigninCfg(),this.initView(),this.initBtnListener()},e.prototype.initData=function(){},e.prototype.initBtnListener=function(){var t=this,e=function(e,o){var i=g.PlayerMgr.getInstance().getDailyData().getSignDay(),n=t.cfgList[i],a=g.PlayerMgr.getInstance().onRewardToStr([{id:n.GoodID,num:n.GoodNum}]),r=t.ndDayList[i].convertToWorldSpaceAR(t.ndDayList[i].getChildByName("sprIcon").position);g.PlayerMgr.getInstance().addRewards(a,e,r),g.PlayerMgr.getInstance().getDailyData().sign(o),t.initView(),t.sendEvent(h.BraveTowerEventName.UpdateFuncRedPoint)};this.btnSign.on(cc.Node.EventType.TOUCH_END,function(){e(1,0)},this),this.btnVide.on(cc.Node.EventType.TOUCH_END,function(){p.SdkMgr.getInstance().playVideo(p.AdType.AdFreeTime,function(){var t;g.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Double_sign),g.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Double_sign_X,(t=g.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?t:Math.floor((t-1)/5)+5),e(1,1)})},this),this.btnDouble.on(cc.Node.EventType.TOUCH_END,function(){p.SdkMgr.getInstance().playVideo(p.AdType.AdFreeTime,function(){var t;g.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Double_sign),g.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Double_sign_X,(t=g.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?t:Math.floor((t-1)/5)+5),e(2,1)})},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this)},e.prototype.initView=function(){var t=g.PlayerMgr.getInstance().getDailyData().getSignReward();switch(t){case 0:this.btnSign.active=!0,this.btnVide.active=!1,this.btnDouble.active=!0,this.btnGet.active=!1;break;case 1:this.btnSign.active=!1,this.btnVide.active=!0,this.btnDouble.active=!1,this.btnGet.active=!1;break;default:this.btnSign.active=!1,this.btnVide.active=!1,this.btnDouble.active=!1,this.btnGet.active=!0}for(var e=g.PlayerMgr.getInstance().getDailyData().getSignDay(),o=function(o){var n=i.ndDayList[o],a=i.cfgList[o];n.getChildByName("labDay").getComponent(cc.Label).string=u.Utils.StringFormat(i.T(d.TextConfig.Text01),o+1);var r=m.DataMgr.getInstance().getGoodsCfgById(a.GoodID);i.loadSpriteFrame(h.BraveTowerBundelName.Icon,r.sprBg,function(t){n.getChildByName("ndBg").getComponent(cc.Sprite).spriteFrame=t}),i.loadSpriteFrame(h.BraveTowerBundelName.Icon,r.icon,function(t){n.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),n.getChildByName("labNum").getComponent(cc.Label).string=i.T(r.name)+"x"+h.BraveTowerGameUtils.numberFomat(a.GoodNum);var s=!1;(o<e||o==e&&t>0)&&(s=!0),n.getChildByName("ndFinish").active=s},i=this,n=0;n<this.ndDayList.length;n++)o(n)},c([_({type:[cc.Node],tooltip:"\u7b7e\u5230\u5217\u8868"})],e.prototype,"ndDayList",void 0),c([_({type:cc.Node,tooltip:"\u7b7e\u5230\u6309\u94ae"})],e.prototype,"btnSign",void 0),c([_({type:cc.Node,tooltip:"\u89c6\u9891\u7b7e\u5230\u6309\u94ae"})],e.prototype,"btnVide",void 0),c([_({type:cc.Node,tooltip:"\u53cc\u500d\u7b7e\u5230\u6309\u94ae"})],e.prototype,"btnDouble",void 0),c([_({type:cc.Node,tooltip:"\u5df2\u7b7e\u5230"})],e.prototype,"btnGet",void 0),c([_({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],UISubEnter:[function(t,e,o){"use strict";cc._RF.push(e,"e4703LaK+NAkLa/qcaMkRg2","UISubEnter");var i=t,n=e,a=o;cc._RF.push(n,"e4703LaK+NAkLa/qcaMkRg2","UISubEnter");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.subEnterObj=void 0;var l=i("RSD_App"),p=i("BACK_APP"),u=i("BACK_APP2"),d=i("BKT_APP"),h=i("BALL_App"),f=i("BTY_App"),m=i("BHD_APP"),g=i("BBD_APP"),y=i("BBD2_APP"),v=i("DMD_APP"),_=i("DB_App"),b=i("DRA_App"),B=i("DW_APP"),I=i("DBS_APP"),P=i("FSL_APP"),C=i("FLY_App"),D=i("GAD_App"),T=i("Hold_App"),S=i("NEW_App"),A=i("PBT_App"),k=i("RCPDD_APP"),w=i("RUN_App"),N=i("SOD_APP"),R=i("STO_App"),M=i("subgameTime"),O=i("TLB_APP"),E=i("TPVP_APP"),L=i("YEAR_App"),x=i("common_Configs"),F=i("Common_PlayerMgr"),G=i("BasePlatform"),U=i("BaseUI"),j=i("PlatformSetting"),H=i("SdkMgr"),W=i("UIMgr"),V=i("Utils"),K=i("Config"),Y=i("GameTrackDataEvent"),z=i("DataMgr"),X=i("PlayerMgr"),q=i("GameEnumData"),J=cc._decorator,Z=J.ccclass,Q=J.property,$=function(t,e,o,i,n){this.subPlayTime=t,this.subPlayStage=e,this.subPlayName=o,this.subTrackId=i,this.Add_TrackId=n};a.subEnterObj=$;var tt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.subGameList=null,e.subClose=null,e.subMap=new Map,e}return s(e,t),e.prototype.initSubView=function(){this.initParam(),this.refreshSubView(),this.hideButtomView(),this.initSubButton()},e.prototype.initParam=function(){for(var t in this.subGameList.children){var e=this.subGameList.children[t].children[0];this.doInitParamDown(e.name)}},e.prototype.doInitParamDown=function(t){var e;if("a"==t){var o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params34)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params35)),n="\u53cc\u9f99\u620f\u73e0",a=Y.TrackId.double_dragons;e=new $(o,i,n,a,Y.TrackId.double_dragons_X)}else"b"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params32)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params33)),n="\u62a2\u9f99\u73e0",a=Y.TrackId.Grab_Dragon_Balls,e=new $(o,i,n,a,Y.TrackId.Grab_Dragon_Balls_X)):"c"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params30)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params31)),n="\u5c0f\u7f8e\u5feb\u8dd1",a=Y.TrackId.Girl_run,e=new $(o,i,n,a,Y.TrackId.Girl_run_X)):"d"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params28)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params29)),n="\u98de\u6765\u6a2a\u77f3",a=Y.TrackId.Flying_Stone,e=new $(o,i,n,a,Y.TrackId.Flying_Stone_X)):"e"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params26)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params27)),n="\u89e3\u6551\u5c0f\u7f8e",a=Y.TrackId.Help_girl,e=new $(o,i,n,a,Y.TrackId.Help_girl_X)):"f"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params24)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params25)),n="\u51fb\u9000\u6076\u9f99",a=Y.TrackId.Fight_dragon,e=new $(o,i,n,a,Y.TrackId.Fight_dragon_X)):"g"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params22)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params23)),n="\u5b88\u536b\u57ce\u5899",a=Y.TrackId.Walls_defended,e=new $(o,i,n,a,Y.TrackId.Walls_defended_X)):"h"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params18)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params21)),n="\u5361\u724c\u8dd1\u9177",a=Y.TrackId.Parkour_run,e=new $(o,i,n,a,Y.TrackId.Parkour_run_X)):"i"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params36)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params37)),n="\u626d\u86cb\u4e4b\u6218",a=Y.TrackId.Gacha,e=new $(o,i,n,a,Y.TrackId.Gacha_X)):"j"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params38)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params39)),n="\u9ebb\u5c06\u9f99",a=Y.TrackId.mahjong,e=new $(o,i,n,a,Y.TrackId.mahjong_X)):"k"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params38)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params39)),n="\u5bf9\u51b3\u6606\u4ed1",a=Y.TrackId.pkkunlun,e=new $(o,i,n,a,Y.TrackId.pkkunlun_X)):"l"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params40)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params41)),n="\u65b0\u6625\u6253\u86c7",a=Y.TrackId.xinchun,e=new $(o,i,n,a,Y.TrackId.xinchun_X)):"m"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u795e\u5668\u53ec\u5524",a=Y.TrackId.conjure,e=new $(o,i,n,a,Y.TrackId.conjure_X)):"n"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u8f6c\u5200\u6253\u9f99",a=Y.TrackId.conjure,e=new $(o,i,n,a,Y.TrackId.conjure_X)):"o"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u6ce1\u6ce1\u9f99",a=Y.TrackId.paopaolong,e=new $(o,i,n,a,Y.TrackId.paopaolong_X)):"p"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u6ce1\u6ce1\u9f99\u2161",a=Y.TrackId.paopaolong2,e=new $(o,i,n,a,Y.TrackId.paopaolong2_X)):"q"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u6076\u9b54\u8f6e\u76d8",a=Y.TrackId.Demon_Roulette,e=new $(o,i,n,a,Y.TrackId.Demon_Roulette_X)):"r"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u8f6c\u5200\u62fc\u591a\u591a",a=Y.TrackId.Knife_pdd,e=new $(o,i,n,a,Y.TrackId.Knife_pdd_X)):"s"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u6389\u5b50\u5f39",a=Y.TrackId.bullet_falls,e=new $(o,i,n,a,Y.TrackId.bullet_falls_X)):"t"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u661f\u7403\u9f99",a=Y.TrackId.xingqiu_Dragon,e=new $(o,i,n,a,Y.TrackId.xingqiu_Dragon_X)):"u"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u80cc\u5305\u9632\u7ebf",a=Y.TrackId.Backpack_Defense,e=new $(o,i,n,a,Y.TrackId.Backpack_Defense_X)):"v"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u80cc\u5305\u9632\u7ebf\u2161",a=Y.TrackId.Backpack_Defense2,e=new $(o,i,n,a,Y.TrackId.Backpack_Defense2_X)):"w"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u6700\u7ec8\u9632\u7ebf",a=Y.TrackId.defense_line,e=new $(o,i,n,a,Y.TrackId.defense_line_X)):"x"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u8f6e\u76d8\u5bf9\u51b3",a=Y.TrackId.wheel_pk,e=new $(o,i,n,a,Y.TrackId.wheel_pk_X)):"y"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u5854\u9632\u5c42\u5c42\u7834",a=Y.TrackId.TD_breach,e=new $(o,i,n,a,Y.TrackId.TD_breach_X)):"z"==t?(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u9ed1\u6d1e\u9632\u7ebf",a=Y.TrackId.BH_line,e=new $(o,i,n,a,Y.TrackId.BH_line_X)):"aa"==t&&(o=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params44)),i=Number(z.DataMgr.getInstance().getParamCfg(q.BraveTowerEnumParamsCfg.Params45)),n="\u6f02\u6d41\u4e16\u754c",a=Y.TrackId.Drifting_World,e=new $(o,i,n,a,Y.TrackId.Drifting_World_X));this.subMap[t]=e},e.prototype.hideButtomView=function(){for(var t in this.subGameList.children){var e=this.subGameList.children[t].children[0];this.checkISHideInSdk(e.name)&&(e.parent.active=!1)}},e.prototype.checkISHideInSdk=function(t){if(!H.SdkMgr.getInstance().getCheckVersion(j.SwitchID.ShenHe))return!1;var e=[];return e.push("c"),e.push("e"),-1!=e.indexOf(t)},e.prototype.checkISHideInWebLink=function(t){return j.PlatformSetting.currentPlatform==G.Platform.WEB_LINK&&-1!=[].indexOf(t)},e.prototype.initSubButton=function(){var t=this;this.subClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()});var e=function(e){var i=o.subGameList.children[e].children[0],n=Number(e);o.initSubButtonView(i,n),i.on(cc.Node.EventType.TOUCH_END,function(){t.EnterSubPlay(n,i.name)})},o=this;for(var i in this.subGameList.children)e(i)},e.prototype.initSubButtonView=function(t){var e=t.getChildByName("labName"),o=t.getChildByName("labInfo"),i=this.subMap[t.name];e.getComponent(cc.Label).string=i.subPlayName,o.getComponent(cc.Label).string=x.subGameTextCfg.subDesc},e.prototype.getClassByIndex=function(t){return"a"==t?_.default:"b"==t?h.default:"c"==t?w.default:"d"==t?R.default:"e"==t?f.default:"f"==t?b.default:"g"==t?D.default:"h"==t?A.default:"i"==t?N.default:"j"==t?S.default:"k"==t?C.default:"l"==t?L.default:"m"==t?T.default:"n"==t?l.default:"o"==t?g.default:"p"==t?y.default:"q"==t?v.default:"r"==t?k.default:"s"==t?I.default:"t"==t?P.default:"u"==t?p.default:"v"==t?u.default:"w"==t?d.default:"x"==t?E.default:"y"==t?O.default:"z"==t?m.default:"aa"==t?B.default:void 0},e.prototype.EnterSubPlay=function(t,e){var o=this,i=X.PlayerMgr.getInstance().getUserData().getMaxStage(),n=this.subMap[e];if(i<=n.subPlayStage)W.UIMgr.getInstance().openUI(K.UIID.UITips,K.UIID.UINONE,V.Utils.StringFormat(this.T(x.subGameTextCfg.subTips),n.subPlayStage+1));else{var a=Date.now(),r=F.default.getInstance().getSubUserData().getSubgameTimeByIndex(e),s=Math.floor((a-r)/1e3),c=function(){o.getClassByIndex(e).instance.enter_App(function(){W.UIMgr.getInstance().getUIById(K.UIID.UIHome).node.active=!1,M.subTimeGame.instance.initSubTimer(e)},function(t){W.UIMgr.getInstance().getUIById(K.UIID.UIHome).node.active=!0,M.subTimeGame.instance.closeSubTimer(),t&&X.PlayerMgr.getInstance().getUserData().addDiamondNum(t),F.default.getInstance().getSubUserData().setSubgameTimeByIndex(e)},!1,t)};s<n.subPlayTime?H.SdkMgr.getInstance().playVideo(H.AdType.AdFreeTime,function(){var t;X.PlayerMgr.getInstance().getTrackData().youmengTrack(n.subTrackId),c(),X.PlayerMgr.getInstance().getTrackData().youmengTrack(n.Add_TrackId,(t=X.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?t:Math.floor((t-1)/5)+5)}):c()}},e.prototype.refreshSubView=function(){var t=Date.now(),e=X.PlayerMgr.getInstance().getUserData().getMaxStage();for(var o in this.subGameList.children){Number(o);var i=this.subGameList.children[o].children[0],n=this.subMap[i.name],a=n.subPlayStage,r=F.default.getInstance().getSubUserData().getSubgameTimeByIndex(i.name),s=n.subPlayTime;this.onSubView(i,e,a,t,r,s)}},e.prototype.onSubView=function(t,e,o,i,n,a){if(e>o){var r=Math.floor((i-n)/1e3);t.getChildByName("ndMask").active=r<a,t.getChildByName("Layout").active=r<a,t.getChildByName("labInfo").active=!1,r<a&&(t.getChildByName("Layout").getChildByName("labTime").getComponent(cc.Label).string=a-r+"s")}else t.getChildByName("ndMask").active=!0,t.getChildByName("Layout").active=!1,t.getChildByName("labInfo").active=!0},e.prototype.start=function(){this.initSubView(),this.schedule(this.refreshSubView)},c([Q(cc.Node)],e.prototype,"subGameList",void 0),c([Q(cc.Node)],e.prototype,"subClose",void 0),c([Z],e)}(U.default);a.default=tt,cc._RF.pop(),cc._RF.pop()},{}],UITaskAndAchieve:[function(t,e,o){"use strict";cc._RF.push(e,"3327ek0RQlHM5OG/7BPfSkO","UITaskAndAchieve");var i=t,n=e,a=o;cc._RF.push(n,"3327ek0RQlHM5OG/7BPfSkO","UITaskAndAchieve");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("BaseUI"),u=i("List"),d=i("AudioMgr"),h=i("Utils"),f=i("Config"),m=i("TextConfig"),g=i("BraveTowerEnum"),y=i("ItemGood"),v=i("GameEnumData"),_=i("DataMgr"),b=i("PlayerMgr"),B=cc._decorator,I=B.ccclass,P=B.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.togCon=null,e.ndTask=null,e.listTask=null,e.ndAchieve=null,e.listAchieve=null,e.labAchievePoint=null,e.ndAchieveBox=null,e.btnClose=null,e.tag="Toggle1",e}return s(e,t),e.prototype.start=function(){this.initBtnListener(),this.initData(3),this.listTask.tmpNode.active=!1,this.listAchieve.tmpNode.active=!1,this.initTaskView(),this.showRed(),this.addEvent(g.BraveTowerEventName.UpdateFuncRedPoint,this.showRed)},e.prototype.initData=function(){},e.prototype.initBtnListener=function(){for(var t=this,e=0;e<this.togCon.toggleItems.length;e++)this.togCon.toggleItems[e].node.on("toggle",this.showView,this);g.BraveTowerGameUtils.aniAngle(this.ndAchieveBox.getChildByName("ndLight")),this.ndAchieveBox.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(f.UIID.UIAchieveBox)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this)},e.prototype.showView=function(t){if(t.isChecked&&this.tag!=t.node.name){switch(d.AudioMgr.getInstance().playAudioButtonClicked(),t.node.name){case"Toggle1":this.initTaskView();break;case"Toggle2":this.initAchieveView()}this.tag=t.node.name}},e.prototype.initTaskView=function(){this.ndTask.active=!0,this.ndAchieve.active=!1,this.taskList=l(b.PlayerMgr.getInstance().getTaskData().getTaskList()),this.taskList.sort(function(t,e){return t.isGet&&e.isGet?t.id-e.id:t.isGet&&!e.isGet?1:!t.isGet&&e.isGet?-1:t.num>=t.max&&e.num>=e.max?t.id-e.id:t.num>=t.max?-1:e.num>=e.max?1:0}),this.listTask.numItems=this.taskList.length},e.prototype.initTaskListItem=function(t,e){var o=this;t.active=!0;var i=this.taskList[e],n=_.DataMgr.getInstance().getTaskCfg(i.id),a=t.getChildByName("ItemGood").getComponent(y.default);a.initView(n.TasksReward[0],n.TasksReward[1],!1),t.getChildByName("labTitle").getComponent(cc.RichText).string="<b>"+h.Utils.StringFormat(this.T(m.TextConfig["Task"+n.type]),n.para)+"</b>",t.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=i.num/i.max,t.getChildByName("labPro").getComponent(cc.Label).string=i.num+"/"+i.max,t.getChildByName("ndGet").active=i.isGet;var r=t.getChildByName("btnGet"),s=t.getChildByName("btnLock");r.off(cc.Node.EventType.TOUCH_END),i.isGet?(r.active=!1,s.active=!1):i.num>=i.max?(r.active=!0,r.on(cc.Node.EventType.TOUCH_END,function(){var e=b.PlayerMgr.getInstance().onRewardToStr([{id:n.TasksReward[0],num:n.TasksReward[1]}]),r=t.convertToWorldSpaceAR(a.node.position);b.PlayerMgr.getInstance().addRewards(e,1,r),b.PlayerMgr.getInstance().getTaskData().getTaskReward(i.id),o.initTaskView(),o.sendEvent(g.BraveTowerEventName.UpdateFuncRedPoint)}),s.active=!1):(r.active=!1,s.active=!0)},e.prototype.initAchieveView=function(){this.ndTask.active=!1,this.ndAchieve.active=!0,this.labAchievePoint.string=g.BraveTowerGameUtils.numberFomat(b.PlayerMgr.getInstance().getTaskData().getAchievePoint()),this.achieveList=l(b.PlayerMgr.getInstance().getTaskData().getAchieveList()),this.achieveList.sort(function(t,e){return t.isGet&&e.isGet?t.id-e.id:t.isGet&&!e.isGet?1:!t.isGet&&e.isGet?-1:t.num>=t.max&&e.num>=e.max?t.id-e.id:t.num>=t.max?-1:e.num>=e.max?1:0}),this.listAchieve.numItems=this.achieveList.length;for(var t=!1,e=_.DataMgr.getInstance().getAchieveTreasureChestList(),o=b.PlayerMgr.getInstance().getTaskData().getAchieveGetList(),i=b.PlayerMgr.getInstance().getTaskData().getAchievePoint(),n=0;n<e.length;n++){var a=e[n];if(1!=o[n]&&i>=a.NeedAchieveNum){t=!0;break}}this.ndAchieveBox.getChildByName("ndLight").active=t},e.prototype.initAchieveListItem=function(t,e){var o=this;t.active=!0;var i=this.achieveList[e];4==i.type&&(i.num=b.PlayerMgr.getInstance().getUserData().getMaxStage()-1),5==i.type&&(i.num=b.PlayerMgr.getInstance().getUserData().getCardList().length);var n=_.DataMgr.getInstance().getAchieveCfg(i.id),a=t.getChildByName("ItemGood").getComponent(y.default);a.initView(v.BraveTowerEnumGoodsCfg.AchievePoint,n.AchieveDrop,!1),t.getChildByName("labTitle").getComponent(cc.RichText).string="<b>"+h.Utils.StringFormat(this.T(m.TextConfig["Task"+n.type]),n.para)+"</b>",t.getChildByName("sprPro").getComponent(cc.Sprite).fillRange=i.num/i.max,t.getChildByName("labPro").getComponent(cc.Label).string=i.num+"/"+i.max,t.getChildByName("ndGet").active=i.isGet;var r=t.getChildByName("btnGet"),s=t.getChildByName("btnLock"),c=t.getChildByName("ndLay");if(r.off(cc.Node.EventType.TOUCH_END),i.isGet)r.active=!1,s.active=!1,c.active=!1;else{i.num>=i.max?(r.active=!0,r.on(cc.Node.EventType.TOUCH_END,function(){var e=b.PlayerMgr.getInstance().onRewardToStr([{id:n.TasksReward[0],num:n.TasksReward[1]}]),r=t.convertToWorldSpaceAR(a.node.position);b.PlayerMgr.getInstance().addRewards(e,1,r),b.PlayerMgr.getInstance().getTaskData().getAchieveReward(i.id),o.initAchieveView(),o.sendEvent(g.BraveTowerEventName.UpdateFuncRedPoint)}),s.active=!1):(r.active=!1,s.active=!0),c.active=!0;var l=_.DataMgr.getInstance().getGoodsCfgById(n.TasksReward[0]);this.loadSpriteFrame(g.BraveTowerBundelName.Icon,l.icon,function(t){c.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),c.getChildByName("labNum").getComponent(cc.Label).string=g.BraveTowerGameUtils.numberFomat(n.TasksReward[1])}},e.prototype.showRed=function(){for(var t=!1,e=b.PlayerMgr.getInstance().getTaskData().getTaskList(),o=0;o<e.length;o++)if(!(c=e[o]).isGet&&c.num>=c.max){t=!0;break}this.togCon.toggleItems[0].node.getChildByName("ndRed").active=t;var i=!1,n=b.PlayerMgr.getInstance().getTaskData().getAchieveList();for(o=0;o<n.length;o++)if(!(c=n[o]).isGet&&c.num>=c.max){i=!0;break}this.togCon.toggleItems[1].node.getChildByName("ndRed").active=i,i=!1;var a=_.DataMgr.getInstance().getAchieveTreasureChestList(),r=b.PlayerMgr.getInstance().getTaskData().getAchieveGetList(),s=b.PlayerMgr.getInstance().getTaskData().getAchievePoint();for(o=0;o<a.length;o++){var c=a[o];if(1!=r[o]&&s>=c.NeedAchieveNum){i=!0;break}}this.ndAchieveBox.getChildByName("ndLight").active=i},c([P(cc.ToggleContainer)],e.prototype,"togCon",void 0),c([P({type:cc.Node,tooltip:"\u4efb\u52a1"})],e.prototype,"ndTask",void 0),c([P({type:u.default,tooltip:"\u4efb\u52a1"})],e.prototype,"listTask",void 0),c([P({type:cc.Node,tooltip:"\u6210\u5c31"})],e.prototype,"ndAchieve",void 0),c([P({type:u.default,tooltip:"\u6210\u5c31"})],e.prototype,"listAchieve",void 0),c([P({type:cc.Label,tooltip:"\u6210\u5c31\u70b9\u6570"})],e.prototype,"labAchievePoint",void 0),c([P({type:cc.Node,tooltip:"\u6210\u5c31\u5b9d\u7bb1"})],e.prototype,"ndAchieveBox",void 0),c([P({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([I],e)}(p.default);a.default=C,cc._RF.pop(),cc._RF.pop()},{}],UITiesInfo:[function(t,e,o){"use strict";cc._RF.push(e,"09d83ZSONdMirnIdvHd6r0D","UITiesInfo");var i=t,n=e,a=o;cc._RF.push(n,"09d83ZSONdMirnIdvHd6r0D","UITiesInfo");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("BaseUI"),u=i("Utils"),d=i("TextConfig"),h=i("BraveTowerEnum"),f=i("DataMgr"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprIcon=null,e.labName=null,e.labLock=null,e.labDesc=null,e.ndParent=null,e.ndItem=null,e.btnClose=null,e}return s(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.tiesInfo=e},e.prototype.start=function(){this.initData(),this.initBtnListener(),this.initView()},e.prototype.initData=function(){},e.prototype.initView=function(){var t=this,e=this.tiesInfo.cfg;this.loadSpriteFrame(h.BraveTowerBundelName.IconTies,e.icon,function(e){t.sprIcon.spriteFrame=e}),this.labName.string=this.T(e.name),this.labLock.string=this.T(this.tiesInfo.hasCardList.length>=this.tiesInfo.cardList.length?d.TextConfig.Text03:d.TextConfig.Text04);for(var o=[],i=0;i<e.vaule.length;i++)e.vaulePercentage[i]?o.push("<color="+e.color+">"+e.vaule[i]+"</c>"):o.push("<color="+e.color+">"+Math.round(1e4*e.vaule[i])/100+"%</c>");this.labDesc.string="<b><outline color=#000000 width=4>"+u.Utils.StringFormat.apply(u.Utils,l([this.T(e.info)],o))+"</outline></b>",this.ndItem.active=!1;var n=function(t){var o=e.effectList[t],i=cc.instantiate(a.ndItem);i.setParent(a.ndParent),i.x=0,i.active=!0;var n=f.DataMgr.getInstance().getCardCfg(o.cardId);a.loadSpriteFrame(h.BraveTowerBundelName.IconCardHead,n.head,function(t){i.getChildByName("sprIcon").getComponent(cc.Sprite).spriteFrame=t}),i.getChildByName("labName").getComponent(cc.Label).string=a.T(n.name),i.getChildByName("ndLock").active=!a.tiesInfo.hasCardList.includes(o.cardId);for(var r=[],s=0;s<o.vaule.length;s++)o.vaulePercentage[s]?r.push("<color=#2056ea>"+o.vaule[s]+"</c>"):r.push("<color=#2056ea>"+(100*o.vaule[s]).toFixed(0)+"%</c>");i.getChildByName("labInfo").getComponent(cc.RichText).string="<b>[<color=#2056ea>"+o.name+"</c>]:"+u.Utils.StringFormat.apply(u.Utils,l([a.T(o.info)],r))+"</b>"},a=this;for(i=0;i<e.effectList.length;i++)n(i)},e.prototype.initBtnListener=function(){var t=this;this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t.closeUI()},this)},c([y({type:cc.Sprite,tooltip:"\u56fe\u6807"})],e.prototype,"sprIcon",void 0),c([y({type:cc.Label,tooltip:"\u540d\u79f0"})],e.prototype,"labName",void 0),c([y({type:cc.Label,tooltip:"\u6fc0\u6d3b"})],e.prototype,"labLock",void 0),c([y({type:cc.RichText,tooltip:"\u63cf\u8ff0"})],e.prototype,"labDesc",void 0),c([y({type:cc.Node,tooltip:"\u4efb\u52a1"})],e.prototype,"ndParent",void 0),c([y({type:cc.Node,tooltip:"\u4efb\u52a1"})],e.prototype,"ndItem",void 0),c([y({type:cc.Node,tooltip:"\u5173\u95ed"})],e.prototype,"btnClose",void 0),c([g],e)}(p.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],UITips:[function(t,e,o){"use strict";cc._RF.push(e,"b8ba3ngR21FuYdxTm0/H8bV","UITips");var i=t,n=e,a=o;cc._RF.push(n,"b8ba3ngR21FuYdxTm0/H8bV","UITips");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tipsNode=null,e.tips=null,e}return s(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.str=this.T(e)},e.prototype.refreshUI=function(t,e,o,i){this.str=this.T(i),this.tweenAction.stop(),this.tips.string=this.str,this.tweenAction.start()},e.prototype.onLoad=function(){var t=this;this.tweenAction=cc.tween(this.tipsNode).set({position:cc.v3(0,200),scaleY:0}).to(.2,{scaleY:1}).delay(1).by(2,{position:new cc.Vec3(0,100)}).call(function(){t.closeUI()})},e.prototype.start=function(){this.tipsNode.opacity=255,this.tweenAction.stop(),this.tips.string=this.str,this.tweenAction.start()},c([d({type:cc.Node,tooltip:"layout\u8282\u70b9"})],e.prototype,"tipsNode",void 0),c([d({type:cc.Label,tooltip:"\u6587\u5b57"})],e.prototype,"tips",void 0),c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],UITop:[function(t,e,o){"use strict";cc._RF.push(e,"11a8dapgTpGr6BtdcJA1ZM7","UITop");var i=t,n=e,a=o;cc._RF.push(n,"11a8dapgTpGr6BtdcJA1ZM7","UITop");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("Utils"),d=i("Config"),h=i("BraveTowerEnum"),f=i("GameTrackDataEvent"),m=i("GameEnumData"),g=i("DataMgr"),y=i("PlayerMgr"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goldNum=null,e.goldIcon=null,e.goldAdd=null,e.aniLayout=null,e.diamondNum=null,e.diamondIcon=null,e.diamondAdd=null,e.aniList=[],e}return s(e,t),e.prototype.onLoad=function(){this.userData=y.PlayerMgr.getInstance().getUserData()},e.prototype.start=function(){var t=this;this.goldNum.string=h.BraveTowerGameUtils.numberFomat(this.userData.getGoldNum()),this.diamondNum.string=h.BraveTowerGameUtils.numberFomat(this.userData.getDiamondNum()),this.initEventListener();var e=g.DataMgr.getInstance().getParamCfg(m.BraveTowerEnumParamsCfg.Params11).split("|");this.goldAdd.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(d.UIID.UIAddGold,m.BraveTowerEnumGoodsCfg.Coin,parseInt(e[0]),function(o){var i;o&&(y.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Coins),y.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Coins_X,(i=y.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?i:Math.floor((i-1)/5)+5),y.PlayerMgr.getInstance().getUserData().addGoldNum(parseInt(e[0])),y.PlayerMgr.getInstance().getTaskData().addGetGold(parseInt(e[0])),t.sendEvent(h.BraveTowerEventName.UpdateRedPoint,8))})},this),this.diamondAdd.on(cc.Node.EventType.TOUCH_END,function(){t.openUI(d.UIID.UIAddGold,m.BraveTowerEnumGoodsCfg.Diamond,parseInt(e[1]),function(o){var i;o&&(y.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Diamonds),y.PlayerMgr.getInstance().getTrackData().youmengTrack(f.TrackId.Diamonds_X,(i=y.PlayerMgr.getInstance().getUserData().getMaxStage())<=5?i:Math.floor((i-1)/5)+5),y.PlayerMgr.getInstance().getUserData().addDiamondNum(parseInt(e[1])),t.sendEvent(h.BraveTowerEventName.UpdateRedPoint,2))})},this)},e.prototype.initEventListener=function(){this.addEvent(d.EventName.RefreshGold,this.refreshGold),this.addEvent(d.EventName.RefreshDiamond,this.refreshDiamond),this.addEvent(d.EventName.AniGold,this.onAniGold),this.addEvent(d.EventName.AniDiamond,this.onAniDiamond),this.addEvent(h.BraveTowerEventName.ShowTop,this.onShowTop)},e.prototype.refreshGold=function(t,e){var o=this;e?h.BraveTowerGameUtils.rollNumLabelAtlas(this.goldNum,this.userData.getGoldNum()-t,this.userData.getGoldNum(),function(){o.goldNum.string=h.BraveTowerGameUtils.numberFomat(o.userData.getGoldNum())},1):this.goldNum.string=h.BraveTowerGameUtils.numberFomat(this.userData.getGoldNum())},e.prototype.refreshDiamond=function(t,e){var o=this;e?h.BraveTowerGameUtils.rollNumLabelAtlas(this.diamondNum,this.userData.getDiamondNum()-t,this.userData.getDiamondNum(),function(){o.diamondNum.string=h.BraveTowerGameUtils.numberFomat(o.userData.getDiamondNum())},1):this.diamondNum.string=h.BraveTowerGameUtils.numberFomat(this.userData.getDiamondNum())},e.prototype.onAniDiamond=function(t,e){this.flyGoldAni(this.diamondIcon,t,e)},e.prototype.onAniGold=function(t,e){this.flyGoldAni(this.goldIcon,t,e)},e.prototype.flyGoldAni=function(t,e,o){var i=this,n=0,a=0,r=this.aniList.shift();if(r||((r=cc.instantiate(this.aniLayout)).parent=this.aniLayout.parent),r.active=!0,e){var s=r.parent.convertToNodeSpaceAR(e);r.setPosition(s)}else r.setPosition(0,0);o||(o=r.children.length),o=Math.min(o,r.children.length);for(var c=function(e){var o=r.children[e];o.active=!0,o.getComponent(cc.Sprite).spriteFrame=t.getComponent(cc.Sprite).spriteFrame;var s=u.Utils.randomRang(18,30),c=cc.v3();cc.Vec2.random(c,u.Utils.randomRang(200,300)),cc.Tween.stopAllByTarget(o),cc.tween(o).set({position:cc.Vec3.ZERO,scale:.5}).delay(n).show().to(.2,{position:c}).to(.03,{scale:s/10}).to(.02,{scale:1}).delay(.2).delay(n).call(function(){var e,s;e=t.convertToWorldSpaceAR(cc.Vec3.ZERO),s=r.convertToNodeSpaceAR(e),cc.tween(o).to(n+.05,{position:s}).hide().call(function(){0==a&&p.AudioMgr.getInstance().playEffect(d.AudioId.reward),cc.tween(t).to(.05,{scale:1.5}).to(.1,{scale:1}).start(),++a>=i.aniLayout.children.length-1&&(a=0,r.active=!1,i.aniList.push(r))}).start()}).start(),n+=.04},l=0;l<o;l++)c(l)},e.prototype.onShowTop=function(t){this.diamondIcon.parent.active=t},c([b(cc.Label)],e.prototype,"goldNum",void 0),c([b(cc.Node)],e.prototype,"goldIcon",void 0),c([b(cc.Node)],e.prototype,"goldAdd",void 0),c([b(cc.Node)],e.prototype,"aniLayout",void 0),c([b(cc.Label)],e.prototype,"diamondNum",void 0),c([b(cc.Node)],e.prototype,"diamondIcon",void 0),c([b(cc.Node)],e.prototype,"diamondAdd",void 0),c([_],e)}(l.default);a.default=B,cc._RF.pop(),cc._RF.pop()},{}],UITouch:[function(t,e,o){"use strict";cc._RF.push(e,"6efe8537FJKFoMtDV9psOIv","UITouch");var i=t,n=e,a=o;cc._RF.push(n,"6efe8537FJKFoMtDV9psOIv","UITouch");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("Appcfg"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchNode=null,e.needEffect=!0,e.touchNodes=[],e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.addEvent(p.BaseEventName.blocktouch,this.onBlockTouch),this.node.on(cc.Node.EventType.TOUCH_START,function(e){if(t.needEffect){var o;t.touchNodes.length>0?((o=t.touchNodes.pop()).active=!0,o.getComponent(cc.Animation).play()):((o=cc.instantiate(t.touchNode)).active=!0,o.parent=t.node);var i=t.node.convertToNodeSpaceAR(e.getLocation());o.setPosition(i),t.scheduleOnce(function(){o.active=!1,t.touchNodes.push(o)},.5)}}),this.node._touchListener.setSwallowTouches(!1)},e.prototype.onBlockTouch=function(t){this.node._touchListener.setSwallowTouches(!t)},c([h(cc.Node)],e.prototype,"touchNode",void 0),c([h({displayName:"\u662f\u5426\u9700\u8981\u70b9\u51fb\u7279\u6548"})],e.prototype,"needEffect",void 0),c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],UIUtils:[function(t,e,o){"use strict";cc._RF.push(e,"02b4f3KsDZMT7SinMRf3crw","UIUtils");var i=e,n=o;cc._RF.push(i,"02b4f3KsDZMT7SinMRf3crw","UIUtils"),Object.defineProperty(n,"__esModule",{value:!0}),n.UIUtils=void 0;var a=function(){function t(){}return t.rollNumLabelAtlas=function(t,e,o,i,n,a){void 0===a&&(a=6);var r=o,s=10*a,c=0,l=r/s+1;r<=s?(s=r,l=1):s+=1,s>0?cc.tween(e.node).call(function(){!function(){if(t){if(c!=r){(c+=l)>r&&(l-=c-r,c=r);var o=Number(e.string),n=Math.floor(o+l).toFixed(0)+"";e.string=n}}else c!=r&&((c+=l)>r&&(l=0,c=r),(o=Number(e.string))>i)&&(n=Math.floor(o-l).toFixed(0)+"",e.string=n)}()}).delay(.05).union().repeat(s).call(function(){n()}).start():n()},t.scheduleOnce=function(t,e,o){cc.director.getScheduler().enableForTarget(e),cc.director.getScheduler().schedule(t,e,1,0,o,!1)},t.schedule=function(t,e,o){cc.director.getScheduler().enableForTarget(e),cc.director.getScheduler().schedule(t,e,o,cc.macro.REPEAT_FOREVER,0,!1)},t.unSchedule=function(t,e){cc.director.getScheduler().enableForTarget(e),cc.director.getScheduler().isScheduled(t,e)&&cc.director.getScheduler().unschedule(t,e)},t}();n.UIUtils=a,cc._RF.pop(),cc._RF.pop()},{}],UtilLayout:[function(t,e,o){"use strict";cc._RF.push(e,"4a733GBVpRIxbEMCaRy8hEk","UtilLayout");var i=e,n=o;cc._RF.push(i,"4a733GBVpRIxbEMCaRy8hEk","UtilLayout");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.UtilLayout=void 0;var c,l,p,u,d=cc._decorator,h=d.ccclass,f=d.property,m=d.disallowMultiple,g=d.menu,y=(d.executionOrder,d.requireComponent);(function(t){t[t.LEFT=1]="LEFT",t[t.CENTER=2]="CENTER",t[t.RIGHT=3]="RIGHT"})(c||(c={})),function(t){t[t.Top=1]="Top",t[t.CENTER=2]="CENTER",t[t.BOTTOM=3]="BOTTOM"}(l||(l={})),function(t){t[t.Row=1]="Row",t[t.Col=2]="Col"}(p||(p={})),function(t){t[t.NODE=1]="NODE",t[t.Size=2]="Size"}(u||(u={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.horizontalDirection=p.Row,e.alignRowType=c.CENTER,e.alignColType=l.CENTER,e.templateType=u.NODE,e.tmpNode=null,e.ndSize=new cc.Size(109,111),e.maxCol=0,e.selectedEvent=new cc.Component.EventHandler,e.ctrLayout=null,e.itemPosArr=[],e.nodeList=[],e}return r(e,t),e.prototype.onLoad=function(){this.ctrLayout=this.node.getComponent(cc.Layout),this.ctrLayout.enabled=!1},e.prototype.init=function(t){switch(this.ctrLayout||(this.ctrLayout=this.node.getComponent(cc.Layout),this.ctrLayout.enabled=!1),this.layLen=t,this.horizontalDirection){case p.Row:this.initDataRow();break;case p.Col:this.initDataCol()}this.templateType==u.NODE&&this.initLayout()},e.prototype.initDataRow=function(){var t,e,o;this.itemPosArr=[],t=this.templateType==u.NODE?this.tmpNode.getContentSize():this.ndSize,0==this.maxCol?(e=1,o=this.layLen):(e=Math.ceil(this.layLen/this.maxCol),o=this.layLen>this.maxCol?this.maxCol:this.layLen),this.node.setContentSize(t.width*o+(o-1)*this.ctrLayout.spacingX+this.ctrLayout.paddingLeft+this.ctrLayout.paddingRight,t.height*e+(e-1)*this.ctrLayout.spacingY+this.ctrLayout.paddingTop+this.ctrLayout.paddingBottom);for(var i=cc.v2(-this.node.width*this.node.anchorX,this.node.height*(1-this.node.anchorY)),n=i.y-t.height/2-this.ctrLayout.paddingTop,a=[],r=0;r<e;r++)switch(this.ctrLayout.verticalDirection){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:a.push(n-t.height*r-r*this.ctrLayout.spacingY);break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:a.unshift(n-t.height*r-r*this.ctrLayout.spacingY)}for(var s=this.layLen,l=0;l<e;l++){var p=s>o?o:s,d=void 0;switch(this.alignRowType){case c.LEFT:d=i.x+this.ctrLayout.paddingLeft+t.width/2;break;case c.CENTER:var h=t.width*p+(p-1)*this.ctrLayout.spacingX;d=i.x+this.ctrLayout.paddingLeft+(this.node.width-this.ctrLayout.paddingLeft-this.ctrLayout.paddingRight)/2-h/2+t.width/2;break;case c.RIGHT:d=i.x+this.ctrLayout.paddingLeft+t.width/2,d+=(this.maxCol-p)*(t.width+this.ctrLayout.spacingX)}for(var f=0;f<p;f++)switch(this.ctrLayout.horizontalDirection){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:this.itemPosArr.push(cc.v2(d+t.width*f+f*this.ctrLayout.spacingX,a[l]));break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:this.itemPosArr.splice(l*o,0,cc.v2(d+t.width*f+f*this.ctrLayout.spacingX,a[l]))}s-=p}},e.prototype.initDataCol=function(){var t,e,o;this.itemPosArr=[],t=this.templateType==u.NODE?this.tmpNode.getContentSize():this.ndSize,0==this.maxCol?(e=this.layLen,o=1):(e=this.layLen>this.maxCol?this.maxCol:this.layLen,o=Math.ceil(this.layLen/this.maxCol)),this.node.setContentSize(t.width*o+(o-1)*this.ctrLayout.spacingX+this.ctrLayout.paddingLeft+this.ctrLayout.paddingRight,t.height*e+(e-1)*this.ctrLayout.spacingY+this.ctrLayout.paddingTop+this.ctrLayout.paddingBottom);for(var i=cc.v2(-this.node.width*this.node.anchorX,this.node.height*(1-this.node.anchorY)),n=i.x+t.width/2+this.ctrLayout.paddingLeft,a=[],r=0;r<o;r++)switch(this.ctrLayout.horizontalDirection){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:a.push(n+t.width*r+r*this.ctrLayout.spacingX);break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:a.unshift(n+t.width*r+r*this.ctrLayout.spacingX)}for(var s=this.layLen,c=0;c<o;c++){var p=s>e?e:s,d=void 0;switch(this.alignColType){case l.Top:d=i.y-this.ctrLayout.paddingTop-t.width/2;break;case l.CENTER:var h=t.height*p+(p-1)*this.ctrLayout.spacingY;d=i.y-this.ctrLayout.paddingTop-(this.node.height-this.ctrLayout.paddingTop-this.ctrLayout.paddingBottom)/2+h/2-t.height/2;break;case l.BOTTOM:d=i.y-this.ctrLayout.paddingTop-t.width/2,d-=(this.maxCol-p)*(t.height+this.ctrLayout.spacingY)}for(var f=0;f<p;f++)switch(this.ctrLayout.verticalDirection){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:this.itemPosArr.push(cc.v2(a[c],d-t.height*f-f*this.ctrLayout.spacingY));break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:this.itemPosArr.splice(c*e,0,cc.v2(a[c],d-t.height*f-f*this.ctrLayout.spacingY))}s-=p}},e.prototype.initLayout=function(){for(var t=Math.max(this.nodeList.length,this.layLen),e=0;e<t;e++){var o=this.getItem(e),i=this.getPos(e);i?(o||((o=cc.instantiate(this.tmpNode)).setParent(this.node),this.nodeList.push(o)),o.active=!0,o.setPosition(i),this.selectedEvent&&cc.Component.EventHandler.emitEvents([this.selectedEvent],o,e)):o&&(o.active=!1)}},e.prototype.getItem=function(t){return!this.nodeList[t]||t<0||t>=this.layLen?null:this.nodeList[t]},e.prototype.getPos=function(t){return!this.itemPosArr[t]||t<0||t>=this.layLen?null:this.itemPosArr[t]},s([f({type:cc.Enum(p),tooltip:!1})],e.prototype,"horizontalDirection",void 0),s([f({type:cc.Enum(c),tooltip:!1,visible:function(){return this.horizontalDirection==p.Row}})],e.prototype,"alignRowType",void 0),s([f({type:cc.Enum(l),tooltip:!1,visible:function(){return this.horizontalDirection==p.Col}})],e.prototype,"alignColType",void 0),s([f({type:cc.Enum(u),tooltip:!1})],e.prototype,"templateType",void 0),s([f({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==u.NODE}})],e.prototype,"tmpNode",void 0),s([f({type:cc.Size,tooltip:!1,visible:function(){return this.templateType==u.Size}})],e.prototype,"ndSize",void 0),s([f({type:cc.Integer,tooltip:!1})],e.prototype,"maxCol",void 0),s([f({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.templateType==u.NODE}})],e.prototype,"selectedEvent",void 0),s([h,m(),g("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/NewLayout"),y(cc.Layout)],e)}(cc.Component);n.UtilLayout=v,cc._RF.pop(),cc._RF.pop()},{}],Utils:[function(t,e,o){"use strict";cc._RF.push(e,"c3094hfLydDo5f53IYbb0ej","Utils");var i=e,n=o;cc._RF.push(i,"c3094hfLydDo5f53IYbb0ej","Utils"),Object.defineProperty(n,"__esModule",{value:!0}),n.Utils=void 0;var a=function(){function t(){}return t.formatStr=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return cc.js.formatStr(t,e)},t.StringFormat=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var i=0;i<e.length;i++){var n=new RegExp("\\{"+i+"\\}","gm");t=t.replace(n,arguments[i+1])}return t},t.formatGold=function(t){return(t+"").replace(/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,"$1,")},t.randomRang=function(t,e){return Math.floor(Math.random()*(e-t))+t},t.getRange=function(t,e){for(var o=[],i=t;i<e+1;i++)o.push(i);return o},t.weight_rand=function(t){for(var e,o=0,i=!1,n=function(t,e){var o=Math.min(t,e),i=Math.max(t,e),n=1;if(0===t||0===e)return i;for(var a=o;a>=1;a--)if(o%a==0&&i%a==0){n=a;break}return n},a=new Array,r=0;r<t.length;r++)void 0!==t[r].weight?-1!==t[r].weight.toString().indexOf("%")?(e=Math.floor(t[r].weight.toString().replace("%","")),i=!0):e=Math.floor(100*t[r].weight):e=0,a[r]=e,o=n(o,e);var s=new Array,c=0,l=0;if(i){for(r=0;r<t.length;r++){l=a[r];for(var p=0;p<l&&!(c>=100);p++)s.push(r),c++}for(;c<100;)s.push(t.length-1),c++}else for(r=0;r<t.length;r++){for(l=a[r]/o,p=0;p<l;p++)s.push(r);c+=l}return t[s[Math.floor(Math.random()*c)]]},t.encrypt=function(t,e){if(null==e||e.length<=0)return null;for(var o="",i=0;i<e.length;i++)o+=e.charCodeAt(i).toString();var n=Math.floor(o.length/5),a=parseInt(o.charAt(n)+o.charAt(2*n)+o.charAt(3*n)+o.charAt(4*n)+o.charAt(5*n)),r=Math.ceil(e.length/2),s=Math.pow(2,31)-1;if(a<2)return null;var c=Math.round(1e9*Math.random())%1e8;for(o+=c;o.length>10;)o=(parseInt(o.substring(0,10))+parseInt(o.substring(10,o.length))).toString();o=(a*o+r)%s;var l="",p="";for(i=0;i<t.length;i++){var u=(t.charCodeAt(i)^Math.floor(o/s*255))+"";p+=(l=parseInt(u))<16?"0"+l.toString(16):l.toString(16),o=(a*o+r)%s}for(c=c.toString(16);c.length<8;)c="0"+c;return p+c},t.decrypt=function(t,e){if(!(null==t||t.length<8||null==e||e.length<=0)){for(var o="",i=0;i<e.length;i++)o+=e.charCodeAt(i).toString();var n=Math.floor(o.length/5),a=parseInt(o.charAt(n)+o.charAt(2*n)+o.charAt(3*n)+o.charAt(4*n)+o.charAt(5*n)),r=Math.round(e.length/2),s=Math.pow(2,31)-1,c=parseInt(t.substring(t.length-8,t.length),16);for(t=t.substring(0,t.length-8),o+=c;o.length>10;)o=(parseInt(o.substring(0,10))+parseInt(o.substring(10,o.length))).toString();o=(a*o+r)%s;var l="",p="";for(i=0;i<t.length;i+=2)l=parseInt((parseInt(t.substring(i,i+2),16)^Math.floor(o/s*255))+""),p+=String.fromCharCode(l),o=(a*o+r)%s;return p}},t.randomDiffIndex=function(t,e,o){var i=this.randomRang(0,t);this.checkExist(i,o)?this.randomDiffIndex(t,e,o):(o.push(i),o.length<e&&this.randomDiffIndex(t,e,o))},t.checkExist=function(t,e){for(var o=0;o<e.length;o++)if(e[o]==t)return!0;return!1},t.mapToJson=function(t){return this.MapTOJson(t)},t.jsonToMap=function(t){for(var e=JSON.parse(t),o=new Map,i=0,n=Object.keys(e);i<n.length;i++){var a=n[i];o.set(Number(a),Number(e[a]))}return o},t.MapTOJson=function(t){var e="{",o=1;return t.forEach(function(t,i,n){n.size==o?e+='"'+i+'":"'+t+'"':e+='"'+i+'":"'+t+'",',o++}),e+="}"},t.isCardID=function(t){var e=0;if(!/^\d{17}(\d|x)$/i.test(t))return-1;if(t=t.replace(/x$/i,"a"),null=={11:"\u5317\u4eac",12:"\u5929\u6d25",13:"\u6cb3\u5317",14:"\u5c71\u897f",15:"\u5185\u8499\u53e4",21:"\u8fbd\u5b81",22:"\u5409\u6797",23:"\u9ed1\u9f99\u6c5f",31:"\u4e0a\u6d77",32:"\u6c5f\u82cf",33:"\u6d59\u6c5f",34:"\u5b89\u5fbd",35:"\u798f\u5efa",36:"\u6c5f\u897f",37:"\u5c71\u4e1c",41:"\u6cb3\u5357",42:"\u6e56\u5317",43:"\u6e56\u5357",44:"\u5e7f\u4e1c",45:"\u5e7f\u897f",46:"\u6d77\u5357",50:"\u91cd\u5e86",51:"\u56db\u5ddd",52:"\u8d35\u5dde",53:"\u4e91\u5357",54:"\u897f\u85cf",61:"\u9655\u897f",62:"\u7518\u8083",63:"\u9752\u6d77",64:"\u5b81\u590f",65:"\u65b0\u7586",71:"\u53f0\u6e7e",81:"\u9999\u6e2f",82:"\u6fb3\u95e8",91:"\u56fd\u5916"}[parseInt(t.substr(0,2))])return-2;var o=t.substr(6,4)+"-"+Number(t.substr(10,2))+"-"+Number(t.substr(12,2)),i=new Date(o.replace(/-/g,"/"));if(o!=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate())return-3;for(var n=17;n>=0;n--)e+=Math.pow(2,n)%11*parseInt(t.charAt(17-n),11);return e%11!=1?-4:0},t.checkAdult=function(t){var e=parseInt(t.substring(6,14))+18e4,o=new Date,i=o.getFullYear(),n=o.getMonth()+1,a=o.getDate();return parseInt(i+this.getFormatDate(n)+this.getFormatDate(a))>=e},t.getFormatDate=function(t){if(void 0===t||""===t)return"";var e=t+"";return e.length<2&&(e="0"+e),e},t.guid=function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+""+t()+t()+t()+t()+t()+t()},t.getWebUrlParams=function(t){var e={},o=t.split("?")[1];if(o)for(var i=o.split("&"),n=0,a=i.length;n<a;n++){var r=i[n].split("=");e[r[0]]=r[1]}return e},t.saveJsonFile=function(t,e){var o=new Blob([JSON.stringify(e)],{type:"application/json"});o=(o.slice||o.webkitSlice||o.mozSlice).call(o,0,o.size,"application/octet-stream");var i=document.createElementNS("http://www.w3.org/1999/xhtml","a");i.href=URL.createObjectURL(o),i.download=t+".json",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(i.href)},t.renameObjectKeys=function(t,e){var o=this;if("object"!=typeof t||null===t)return t;if(!e)return t;if(Array.isArray(t))return t.map(function(t){return o.renameObjectKeys(t,e)});var i={};for(var n in t)e[n]?i[e[n]]=this.renameObjectKeys(t[n],e):i[n]=this.renameObjectKeys(t[n],e);return i},t.restoreObjectKeys=function(t,e){var o=this;if("object"!=typeof t||null===t)return t;if(!e)return t;if(Array.isArray(t))return t.map(function(t){return o.restoreObjectKeys(t,e)});var i={},n=function(o){var n=Object.keys(e).find(function(t){return e[t]===o});n?i[n]=a.restoreObjectKeys(t[o],e):i[o]=a.restoreObjectKeys(t[o],e)},a=this;for(var r in t)n(r);return i},t}();n.Utils=a,cc._RF.pop(),cc._RF.pop()},{}],VivoManager:[function(t,e,o){"use strict";cc._RF.push(e,"1045fyoW+1Iw6uRR9Ulibck","VivoManager");var i=t,n=e,a=o;cc._RF.push(n,"1045fyoW+1Iw6uRR9Ulibck","VivoManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.VivoManager=void 0;var r=i("LogMgr"),s=function(){function t(){this.showBannerTime=0,this.trackAppKey="60783df09e4e8b6f6170467b",this.showAlert=!0}return t.prototype.youmengTrack=function(){},t.prototype.getCode=function(){return"xxx"},t.prototype.pauseRecord=function(){},t.prototype.closeNativeAd=function(){},t.prototype.hasVerify=function(){return!1},t.prototype.toAppStore=function(){},t.prototype.addNotify=function(){},t.prototype.openNotify=function(){},t.prototype.needDouyVefiy=function(){},t.prototype.interVefiy=function(){},t.prototype.showNative=function(){},t.prototype.hideNative=function(){},t.prototype.showInterNative=function(){},t.prototype.hideInterNative=function(){},t.prototype.canShowBtnMore=function(){},t.prototype.canShowEnergyForverVersion=function(){},t.prototype.showFloatIconAd=function(){},t.prototype.hideFloatIconAd=function(){},t.prototype.canCare=function(){return!1},t.prototype.addShortcut=function(t,e){cc.sys.platform===cc.sys.WECHAT_GAME||qg.installShortcut({message:"\u6dfb\u52a0\u5230\u684c\u9762\uff0c\u65b9\u4fbf\u4e0b\u6b21\u542f\u52a8",success:function(){e&&e("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u6210\u529f")},fail:function(){e&&e("\u684c\u9762\u56fe\u6807\u6dfb\u52a0\u5931\u8d25")}})},t.prototype.checkShortcut=function(t,e){cc.sys.platform===cc.sys.WECHAT_GAME||e&&e(!0)},t.prototype.shareImg=function(){},t.prototype.getUserInfo=function(t){t(null,null)},t.prototype.showGamePortalAd=function(){r.LogMgr.getInstance().debug("\u66f4\u591a\u6e38\u620f")},t.prototype.getAbName=function(t){t("A")},t.prototype.initTrack=function(){},t.prototype.canShare=function(){return!1},t.prototype.initSdk=function(){cc.sys.platform===cc.sys.WECHAT_GAME||(this.PlatformInfo=qg.getSystemInfoSync())},t.prototype.login=function(t,e){e&&e()},t.prototype.pay=function(t,e){e&&e()},t.prototype.share=function(t,e){e&&e()},t.prototype.showBanner=function(t,e){cc.sys.platform===cc.sys.WECHAT_GAME||(this.PlatformInfo.platformVersionCode>=1031?Date.now()-this.showBannerTime>=3e3&&this.createBanner():e&&e())},t.prototype.createBanner=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{null!=this.BannerAd&&this.hideBanner(),this.BannerAd=qg.createBannerAd({posId:"78d6063321d943f783ae902f768e489d",style:{left:0,top:this.PlatformInfo.screenHeight-170,width:this.PlatformInfo.screenWidth,height:170}});var t=Date.now();this.showBannerTime=t,this.BannerAd.show().then(function(){}).catch(function(){}),this.BannerAd.onError(function(t){console.log(" banner \u5e7f\u544a\u9519\u8bef",t.errCode)})}},t.prototype.hideBanner=function(){null!=this.BannerAd&&(this.BannerAd.hide(),this.BannerAd.destroy(),this.BannerAd.offError())},t.prototype.showInsertAd=function(t,e){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{if(!(this.PlatformInfo.platformVersionCode>=1031))return void(e&&e());console.log("\u5f00\u59cb\u663e\u793a\u63d2\u5c4f\u89c6\u9891=============>");var o=qg.createInterstitialAd({posId:"4c653de784624194b1e2b983c28a099b"});o.load(),o.onError(function(){o.offError()}),o.onLoad(function(){o.offLoad()}),o.show().then(function(){e&&e()}).catch(function(t){console.log("\u63d2\u5c4f\u5e7f\u544a\u5c55\u793a\u5931\u8d25",JSON.stringify(t))})}},t.prototype.showVideoAd=function(t,e,o){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{if(!(this.PlatformInfo.platformVersionCode>=1041))return void(o&&o());var i=qg.createRewardedVideoAd({posId:"99c0a29d264946fe8188540c22e0387d"});i.onError(function(){o&&o(),i.offError()}),i.onLoad(function(){i.show().then(function(){}).catch(function(){}),i.offLoad()}),i.onClose(function(t){t&&t.isEnded?e&&e(!0):o&&o(),i.offClose(),i.load()})}},t.prototype.otherFun=function(t,e){e&&e()},t.prototype.shark=function(t){cc.sys.platform===cc.sys.WECHAT_GAME||(1==t?qg.vibrateLong():qg.vibrateShort())},t.prototype.recordVideo=function(t,e){e&&e()},t.prototype.shareVideo=function(t,e){e&&e()},t.prototype.stopRecorderManager=function(){},t.prototype.setLanguage=function(t,e){return e&&e(),"zh"},t.prototype.initNativeAd=function(t,e){if(cc.sys.platform===cc.sys.WECHAT_GAME);else{var o=this,i=function(t){console.log("\u539f\u751f\u5e7f\u544a\u52a0\u8f7d",t.adList),e&&e(t.adList),t.adList[0]&&o.nativeAd.reportAdShow({adId:t.adList[0].adId})},n=function(t){console.log("\u539f\u751f\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",t),e&&e(null)};this.nativeAd&&(this.nativeAd.offLoad(i),this.nativeAd.offError(n),this.nativeAd=null),this.nativeAd=qg.createNativeAd({adUnitId:"af3ef7f7104c4742a4eda8e1c3df0199"}),this.nativeAd.onError(n),this.nativeAd.onLoad(i),this.nativeAd.load()}},t.prototype.showNativeAd=function(t){this.nativeAd&&this.nativeAd.reportAdClick({adId:t})},t}();a.VivoManager=s,cc._RF.pop(),cc._RF.pop()},{}],WalkCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"08d4a5X89ZNiYKY7C4cbuTL","WalkCtrl");var i=t,n=e,a=o;cc._RF.push(n,"08d4a5X89ZNiYKY7C4cbuTL","WalkCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RoleCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.corona=null,e.handle=null,e.roleContrl=null,e.startPositon=null,e.maxDistance=0,e.handleDistance=0,e}return s(e,t),e.prototype.onLoad=function(){this.maxDistance=this.corona.width/2,this.handleDistance=this.handle.width/2,this.roleContrl=l.default.getInstance(),this.walkListener()},e.prototype.walkListener=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){t.corona.active=!0,t.startPositon=e.getLocation().add(t.node.getPosition()),t.corona.setPosition(t.node.convertToNodeSpaceAR(e.getLocation()))}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getLocation(),i=180*Math.atan2(o.y-t.startPositon.y,o.x-t.startPositon.x)/Math.PI,n=Math.sqrt(Math.pow(o.y-t.startPositon.y,2)+Math.pow(o.x-t.startPositon.x,2));t.roleContrl.goBack(o.x-t.startPositon.x),t.contrlButton(i,n)}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.corona.active=!1,t.roleContrl.moveHero(1e3)}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.roleContrl.moveHero(1e3),t.corona.active=!1})},e.prototype.contrlButton=function(t,e){void 0===e&&(e=0),e=e<=this.maxDistance-this.handleDistance?e:this.maxDistance-this.handleDistance,this.handle.x=e*Math.cos(t*Math.PI/180),this.handle.y=e*Math.sin(t*Math.PI/180),this.roleContrl.moveHero(t)},c([d(cc.Node)],e.prototype,"corona",void 0),c([d(cc.Node)],e.prototype,"handle",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],WavesCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"3e063+F3FNFqaNI0bkPvcVQ","WavesCtrl");var i=t,n=e,a=o;cc._RF.push(n,"3e063+F3FNFqaNI0bkPvcVQ","WavesCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RSDGameEnumData"),p=i("RSD_DataMgr"),u=i("CameraCtrl"),d=i("DragonCtrl"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.waveTimett=null,e.waveTimes=0,e.level=1,e.waveCfg=[],e}return s(e,t),e.prototype.onLoad=function(){this.waveCfg=p.default.getInstance().getParam(l.enumBasicParaCfg.collectionTime).split(","),this.setWaveTimes()},e.prototype.setWaveTimes=function(){this.waveTimes=Number(this.waveCfg[this.level-1])},e.prototype.start=function(){},e.prototype.startGame=function(){this.countDown()},e.prototype.countDown=function(){var t=this;this.ct=setInterval(function(){t.waveTimes--,t.waveTimett.string=t.waveTimes+"",t.waveTimes<=0&&(clearInterval(t.ct),t.dragonAttack())},100)},e.prototype.dragonAttack=function(){d.default.instance.dragonAction=!0,u.default.instance.dragonAction=!0},c([m(cc.Label)],e.prototype,"waveTimett",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],WeachatServerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"daacfV0RMxOTKuEWnpyoyog","WeachatServerMgr");var i=t,n=e,a=o;cc._RF.push(n,"daacfV0RMxOTKuEWnpyoyog","WeachatServerMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.WeachatServerMgr=void 0;var r=i("Config"),s=i("Appcfg"),c=i("EventMgr"),l=i("SfSendQueue"),p=function(){function t(t,e,o){this.url="http://192.168.1.244:8050",this.appId=3,this.platform=0,this.isOpened=!1,this.openIdKey="igame_openId",this.uidKey="USERID",this.isLoaded=!1,this.canUpdate=!0,this.isClear=!1,this.isonHide=!1,this.url=t,this.isOpened=o,this.appId=e}return t.prototype.init=function(t,e){var o=this;void 0===e&&(e=!0),this.isOpened?(this.getOpenId(function(){t&&t()}),this.isonHide||(this.isonHide=!0,wx.onHide(function(){o.isClear||(console.log("\u8fdb\u6765\u4e86 onHide"),c.EventMgr.getInstance().emit(s.BaseEventName.onHide))}))):t&&t()},t.prototype.getNeedSaveServer=function(){return this.isOpened},t.prototype.clearDataByKey=function(t,e){this.isOpened?(this.isClear=!0,t=(t=t.replace(r.GameConfig.AppCacheName,"")).trim(),this.saveData(t,"{}",e)):e&&e()},t.prototype.getDataByKey=function(t){return this.isOpened?(t=(t=t.replace(r.GameConfig.AppCacheName,"")).trim(),this.data?"undefined"==this.data[t]||"{}"==this.data[t]?null:this.data[t]:null):null},t.prototype.getOpenId=function(t,e){if(void 0===e&&(e=!1),this.openId=window.openId,this.isOpened||e)if(this.openId)t&&t(this.openId);else{var o=this,i=wx.getStorageSync(this.openIdKey);if(i)return this.openId=i,window.openId=this.openId,void t(this.openId);if(i=wx.getStorageSync("um_od"))return this.openId=i,window.openId=this.openId,void t(this.openId);wx.login({success:function(e){if(e.code){var i={appId:o.appId,code:e.code,platform:o.platform};l.SfTrackHttp.httpGet(o.url+"/getOpenId",i,function(e){console.log(e),0==e.code?(o.openId=e.data.openid,wx.setStorageSync(o.openIdKey,o.openId),t&&t(o.openId)):t&&t()})}else console.log("\u767b\u5f55\u5931\u8d25\uff01"+e.errMsg),t&&t()},fail:function(e){console.log("login\u767b\u5f55\u5931\u8d25="+JSON.stringify(e)),t&&t()}})}else t&&t(null)},t.prototype.loadData=function(t){var e=this;if(this.isOpened){var o=this,i=wx.getAccountInfoSync(),n={appId:o.appId,thirdId:o.openId,platform:o.platform,appGameId:i.miniProgram.appId};l.SfTrackHttp.httpGet(o.url+"/loginData",n,function(i){null!=i?0==i.code?(l.SfTrackHttp.TOKEN=i.token,e.data=i.data,t&&t(i.data)):-2==i.code?(o.canUpdate=!1,wx.showModal({title:"\u63d0\u793a",content:"\u4ee3\u7801\u4fee\u6539\u6b63\u786e\u7684appid",success:function(t){t.confirm?console.log("\u7528\u6237\u70b9\u51fb\u786e\u5b9a"):t.cancel&&console.log("\u7528\u6237\u70b9\u51fb\u53d6\u6d88")}})):t&&t(null):t&&t(null)})}else t&&t(null)},t.prototype.checkLogin=function(t){this.isOpened?this.openId&&this.userId?t():this.getOpenId(function(){t()}):t&&t(null)},t.prototype.saveData=function(t,e,o){var i=this;if(this.isOpened)if(this.canUpdate){t=(t=t.replace(r.GameConfig.AppCacheName,"")).trim();var n=this;this.checkLogin(function(){var a=new l.SendConfig;a.callback=function(t){0==t.code?o&&o(t.data):-10==t.code?(i.isOpened=!1,wx.showModal({title:"\u8b66\u544a",showCancel:!1,content:"\u8d26\u53f7\u5728\u5176\u4ed6\u8bbe\u5907\u767b\u5f55\uff0c\u6b64\u8bbe\u5907\u5c06\u5f3a\u5236\u4e0b\u7ebf",success:function(t){(t.confirm||t.cancel)&&wx.exitMiniProgram({})}})):(console.error(t),o&&o(null))};var r={appId:n.appId,thirdId:n.openId,platform:n.platform,key:t,value:e};l.SendQueue.enqueue(r,n.url+"/saveData",a)})}else o&&o(null);else o&&o(null)},t.prototype.clearAllData=function(t){var e={appId:this.appId,thirdId:this.openId,platform:this.platform};l.SfTrackHttp.httpGet(this.url+"/remove",e,function(e){null!=e?0==e.code?(t&&t(!0),wx.restartMiniProgram({success:function(){}})):t&&t(!1):t&&t(null)})},t}();a.WeachatServerMgr=p,cc._RF.pop(),cc._RF.pop()},{}],WeaponBase:[function(t,e,o){"use strict";cc._RF.push(e,"24be2qhSslI3ZyCWfe1gv2B","WeaponBase");var i=t,n=e,a=o;cc._RF.push(n,"24be2qhSslI3ZyCWfe1gv2B","WeaponBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0}),a.WeaponType=a.WeaponBase=void 0;var c=i("AudioMgr"),l=i("NodeLib"),p=i("Hold_Configs"),u=i("Hold_GameCtrl"),d=i("linePos"),h=cc._decorator,f=(h.ccclass,h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.percentNum=0,e.durationTimer=0,e.isActive=!0,e.worldPos=null,e.baseScale=1,e.radius=0,e.width=0,e.height=0,e.effectTime=.5,e.nowTime=0,e.effectName="attack",e.moveSpeed=0,e.damagedEnemies=new Set,e}return s(e,t),e.prototype.init=function(t){var e;this.params=t,this.worldPos=this.node.convertToWorldSpaceAR(cc.v3(0,0)),this.moveSpeed=this.params.weaponPara3,this.pro_percent=null===(e=l.default.findChildByName(this.node,"percent"))||void 0===e?void 0:e.getComponent(cc.Sprite),this.pro_percent&&(this.pro_percent.fillRange=1)},e.prototype.onUpdate=function(){},e.prototype.applyAreaDamage=function(t,e){u.default.instance.damageEnemiesInRange(t,e,this.params.weaponPara0)},e.prototype.applyRectDamage=function(t,e,o,i){void 0===i&&(i=null),u.default.instance.damageEnemiesInRect(t,e,o,this.params.weaponPara0,i)},e.prototype.resycleNode=function(){var t=this;this.isActive=!1,this.node.removeFromParent(),this.scheduleOnce(function(){u.default.instance.getWeaponCtrl().resycleWeapon(t)})},Object.defineProperty(e.prototype,"weaponType",{get:function(){return this.params.weaponType},enumerable:!1,configurable:!0}),e.prototype.perspectiveMove=function(t){this.worldPos.y+=t,this.worldPos.z+=t;var e=d.PerspectiveLine.getInstance().getScreenPosition(this.worldPos.x,this.worldPos.y,this.worldPos.z,this.baseScale),o=this.node.parent.convertToNodeSpaceAR(cc.v2(e.x,e.y));this.node.setPosition(o.x,o.y),this.node.setScale(e.scale)},e.prototype.playAudio=function(t){this.nowTime,this.nowTime+=t,this.nowTime>=this.effectTime&&(this.nowTime=0,c.AudioMgr.getInstance().playEffect(this.effectName,p.Hold_AudioIDType.weapon))},e.prototype.update=function(){this.pro_percent&&(this.pro_percent.fillRange=(this.params.weaponPara2-this.durationTimer)/this.params.weaponPara2)},e}(cc.Component));a.WeaponBase=f,function(t){t[t.weapon_1=1]="weapon_1",t[t.weapon_2=2]="weapon_2",t[t.weapon_3=3]="weapon_3",t[t.weapon_4=4]="weapon_4",t[t.weapon_5=5]="weapon_5",t[t.weapon_6=6]="weapon_6",t[t.weapon_7=7]="weapon_7",t[t.weapon_8=8]="weapon_8",t[t.weapon_9=9]="weapon_9",t[t.weapon_10=10]="weapon_10"}(a.WeaponType||(a.WeaponType={})),cc._RF.pop(),cc._RF.pop()},{}],WeaponCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"53ec1EH6M9JMbiaSD+yyOUb","WeaponCtrl");var i=t,n=e,a=o;cc._RF.push(n,"53ec1EH6M9JMbiaSD+yyOUb","WeaponCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RSDGameEnumData"),p=i("RSD_DataMgr"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.role=null,e.weapon=null,e.weaponLayout=null,e.weaponNum=1,e.weaponSpeed=1,e.baseAngle=0,e.weaponAddNum=0,e.weaponPool=[],e}var o;return s(e,t),o=e,e.prototype.start=function(){o.instance=this,this.initWeapon()},e.prototype.resetWeaponAddNum=function(t,e){for(this.weaponNum+=e;this.weaponPool.length<this.weaponNum;)this.addWeaponToLayout();this.updateWeaponLayout(),this.weaponAddNum=e},e.prototype.initWeapon=function(){this.weaponAddNum=p.default.getInstance().getCharacterLevelCfgByLevel(1).rewardNum,this.weaponNum=p.default.getInstance().getParam(l.enumBasicParaCfg.basicWeaponry),this.weaponSpeed=p.default.getInstance().getParam(l.enumBasicParaCfg.basicASPD);for(var t=0;t<this.weaponNum;t++)this.addWeaponToLayout();this.updateWeaponLayout()},e.prototype.addWeaponToLayout=function(){var t=cc.instantiate(this.weapon);t.active=!0,t.parent=this.weaponLayout,this.weaponPool.push(t)},e.prototype.updateWeaponLayout=function(){this.baseAngle=0;for(var t=360/Math.max(1,this.weaponNum),e=0;e<this.weaponPool.length;e++){var o=this.weaponPool[e];e<this.weaponNum?(o.active=!0,o.angle=this.baseAngle,this.baseAngle+=t):o.active=!1}},e.prototype.weaponActive=function(){this.weaponLayout.position=this.role.position,this.weaponLayout.angle-=this.weaponSpeed},e.prototype.addWeapon=function(t){this.weaponNum+=t,this.weaponNum>this.weaponPool.length&&this.addWeaponToLayout(),this.updateWeaponLayout()},e.prototype.delWeapon=function(){this.weaponNum--,this.weaponNum<0&&(this.weaponNum=0),this.updateWeaponLayout()},e.prototype.update=function(){this.weaponActive()},c([h(cc.Node)],e.prototype,"role",void 0),c([h(cc.Prefab)],e.prototype,"weapon",void 0),c([h(cc.Node)],e.prototype,"weaponLayout",void 0),o=c([d],e)}(cc.Component);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],Weapon:[function(t,e,o){"use strict";cc._RF.push(e,"61136zNmRpJP5cuchTZWZwl","Weapon");var i=t,n=e,a=o;cc._RF.push(n,"61136zNmRpJP5cuchTZWZwl","Weapon");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("RoleCtrl"),p=i("DragonBody"),u=i("Enemy"),d=i("Tree"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=!1,e.sp=null,e.sk=null,e.attackedObjects=new Set,e}return s(e,t),e.prototype.doDamage=function(){var t=[];for(var e in l.default.instance.checkAttack())t.push(l.default.instance.checkAttack()[e]);var o=this.node.getComponent(cc.BoxCollider).world.points;for(var e in t){var i=t[e].tree,n=i.getComponent(cc.BoxCollider);if(n){var a=n.world.points;cc.Intersection.polygonPolygon(a,o)&&!this.attackedObjects.has(i)&&(this.attackedObjects.add(i),i.getComponent(u.default)?i.getComponent(u.default).die():i.getComponent(d.default)?i.getComponent(d.default).hit(t[e].pos):i.getComponent(p.default).die())}}},e.prototype.attackDragon=function(){var t=[];for(var e in l.default.instance.checkDragon())t.push(l.default.instance.checkDragon()[e]);var o=this.node.getComponent(cc.BoxCollider).world.points;for(var e in t){var i=t[e],n=i.getComponent(cc.BoxCollider);if(n){var a=n.world.points;cc.Intersection.polygonPolygon(a,o)&&(this.attackedObjects.has(i)||(this.attackedObjects.add(i),i.getComponent(p.default).die()))}}},e.prototype.update=function(){var t=this;this.doDamage(),this.attackDragon(),this.attackedObjects.forEach(function(e){if(cc.isValid(e)){var o=e.getComponent(cc.BoxCollider),i=t.node.getComponent(cc.BoxCollider);if(o&&i){var n=o.world.points,a=i.world.points;cc.Intersection.polygonPolygon(n,a)||t.attackedObjects.delete(e)}else t.attackedObjects.delete(e)}else t.attackedObjects.delete(e)})},c([m(cc.Node)],e.prototype,"sp",void 0),c([m(cc.Node)],e.prototype,"sk",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],WebLinkManager:[function(t,e,o){"use strict";cc._RF.push(e,"8ab12yUnhdDFITeKQSSqI23","WebLinkManager");var i=e,n=o;cc._RF.push(i,"8ab12yUnhdDFITeKQSSqI23","WebLinkManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.WebLinkManager=void 0;var a=function(){function t(){this.infostr=[]}return t.prototype.getLaunchOptionsSync=function(){},t.prototype.getCode=function(){return""},t.prototype.canShare=function(){return!1},t.prototype.pauseRecord=function(){},t.prototype.resumeRecord=function(){},t.prototype.verifyKey=function(){},t.prototype.toAppStore=function(){},t.prototype.openNotify=function(){},t.prototype.shareImg=function(){},t.prototype.getUserInfo=function(){},t.prototype.getIsZhiTouUser=function(){return!1},t.prototype.checkCanOpenSideBar=function(){},t.prototype.openSideBar=function(){},t.prototype.isFromBroadside=function(){},t.prototype.playMultitonVideo=function(){},t.prototype.checkShortcut=function(){},t.prototype.addShortcut=function(){},t.prototype.hasVerify=function(){return!0},t.prototype.youmengTrack=function(){},t.prototype.initSdk=function(t,e){e&&e()},t.prototype.login=function(t,e){e&&e()},t.prototype.pay=function(t,e){e&&e()},t.prototype.share=function(t,e){e&&e()},t.prototype.showBanner=function(t,e){e&&e()},t.prototype.hideBanner=function(t,e){e&&e()},t.prototype.showInsertAd=function(t,e){e&&e()},t.prototype.showVideoAd=function(t,e){e&&e()},t.prototype.otherFun=function(t,e){e&&e()},t.prototype.shark=function(t,e){e&&e()},t.prototype.recordVideo=function(t,e){e&&e()},t.prototype.shareVideo=function(t,e){e&&e()},t.prototype.stopRecorderManager=function(t,e){e&&e()},t.prototype.setLanguage=function(t,e){return e&&e(),"zh"},t}();n.WebLinkManager=a,cc._RF.pop(),cc._RF.pop()},{}],WebSock:[function(t,e,o){"use strict";cc._RF.push(e,"70df2VbIU9B66Fr+op8FKJp","WebSock");var i=e,n=o;cc._RF.push(i,"70df2VbIU9B66Fr+op8FKJp","WebSock"),Object.defineProperty(n,"__esModule",{value:!0}),n.WebSock=void 0;var a=function(){function t(){this._ws=null,this.onConnected=null,this.onMessage=null,this.onError=null,this.onClosed=null}return t.prototype.connect=function(t){var e=this;if(this._ws&&this._ws.readyState===WebSocket.CONNECTING)return console.log("websocket connecting, wait for a moment..."),!1;var o=null;if(t.url)o=t.url;else{var i=t.ip,n=t.port;o=t.protocol+"://"+i+":"+n}return console.log("\u8fde\u63a5\uff1a"+o),this._ws=new WebSocket(o),this._ws.binaryType=t.binaryType?t.binaryType:"arraybuffer",this._ws.onmessage=function(t){e.onMessage(t.data)},this._ws.onopen=this.onConnected,this._ws.onerror=this.onError,this._ws.onclose=this.onClosed,!0},t.prototype.send=function(t){return this._ws.readyState==WebSocket.OPEN&&(this._ws.send(t),!0)},t.prototype.close=function(t,e){this._ws.close(t,e)},t}();n.WebSock=a,cc._RF.pop(),cc._RF.pop()},{}],WechatEventMgr:[function(t,e,o){"use strict";cc._RF.push(e,"46780C2g9tBS7AO1LEb9okY","WechatEventMgr");var i=t,n=e,a=o;cc._RF.push(n,"46780C2g9tBS7AO1LEb9okY","WechatEventMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.WechatEventMgr=void 0;var r=i("Config"),s=i("GameTrackDataEvent"),c=i("PlayerMgr"),l=i("BasePlatform"),p=i("PlatformConfig"),u=i("UIUtils"),d=i("HttpMgr"),h=i("PlatformManager"),f=function(){function t(){this.gameId=p.WechatAppInfo.APP_ID,this.gameingTime=0,this.url="https://yuema.sfplay.net:5566/wxInvite/new/"}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.init=function(){},t.prototype.calcGameingTime=function(){this.gameingTime++,cc.sys.localStorage.setItem(r.GameConfig.AppCacheName+"_onLine",this.gameingTime),this.gameingTime>600?u.UIUtils.unSchedule(this.calcGameingTime,this):60==this.gameingTime||(180==this.gameingTime?(this.startTrack(s.TrackId._3m_openID),this.startTrack(s.TrackId._3m_openID)):300==this.gameingTime?this.startTrack(s.TrackId._5m_openID):420==this.gameingTime&&(this.startTrack(s.TrackId._7m_openID),u.UIUtils.unSchedule(this.calcGameingTime,this)))},t.prototype.getOpenId=function(t){if(this.openId=c.PlayerMgr.getInstance().getWechatData().getOpenId(),h.PlatformManager.currentPlatform==l.Platform.EDITOR&&(this.openId="test_openId"),this.openId&&""!=this.openId&&"undefined"!=this.openId)return console.log("\u5b58\u5728"+this.openId),void(t&&t(this.openId));var e=this,o=e.url+"getOpenID";wx.login({success:function(i){if(i.code){var n={code:i.code,gameId:e.gameId};d.HttpMgr.getInstance().httpPost(n,function(o){var i=JSON.parse(o);i&&400==i.code&&(e.openId=i.data,c.PlayerMgr.getInstance().getWechatData().setOpenId(e.openId),t&&t(e.openId))},o)}else t&&t(null),console.log("\u767b\u5f55\u5931\u8d25\uff01"+i.errMsg)}})},t.prototype.getOnlineTime=function(){return Math.floor(this.gameingTime/60)},t.prototype.trackVideoEvent=function(){var t=c.PlayerMgr.getInstance().getWechatData().addVideoCount(),e=null,o=null;t>=1&&t<3?(o=s.TrackId._5m1v_openID,e=s.TrackId._1v_openID):t>=3&&t<5?(e=s.TrackId._3v_openID,o=s.TrackId._5m3v_openID):t>=5&&t<7?(e=s.TrackId._5v_openID,o=s.TrackId._5m5v_openID):t>=7&&(e=s.TrackId._7v_openID,o=s.TrackId._5m7v_openID),e&&this.startTrack(e),o&&this.getOnlineTime()>=5&&this.startTrack(o)},t.prototype.startTrack=function(t){this.getOpenId(function(e){e&&c.PlayerMgr.getInstance().getTrackData().youmengTrack(t,e)})},t}();a.WechatEventMgr=f,cc._RF.pop(),cc._RF.pop()},{}],WechatManager:[function(t,e,o){"use strict";cc._RF.push(e,"19fbbH59GlI3pQ7lmXK5gwM","WechatManager");var i=t,n=e,a=o;cc._RF.push(n,"19fbbH59GlI3pQ7lmXK5gwM","WechatManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.WechatManager=void 0;var r=i("BasePlatform"),s=i("LogMgr"),c=i("PlatformConfig"),l=i("PlatformSetting"),p=function(){function t(){this.showAlert=!0,this.hasAd=!0,this.hasBanner=!0,this.hasInsertAd=!0,this.hasVideoAd=!0,this.BannerAd=null,this.BannerAdHight=0,this.customAdMap=new Map,this.sdkVersion="",this.videoAd=null}return t.prototype.initTrack=function(){},t.prototype.initSdk=function(){wx.sffile={};var t=wx.getFileSystemManager();try{t.accessSync(wx.env.USER_DATA_PATH+"/data.json");var e=t.readFileSync(wx.env.USER_DATA_PATH+"/data.json","utf-8");wx.sffile=JSON.parse(e)}catch(e){wx.downloadFile({url:"https://game.sfplay.net/data.json",success:function(e){t.saveFileSync(e.tempFilePath,wx.env.USER_DATA_PATH+"/data.json")},fail:function(){}})}this._systemInfo=wx.getSystemInfoSync(),this.sdkVersion=this._systemInfo.SDKVersion,this._systemInfo.screenWidth,this._systemInfo.screenHeight,this.compareVersion(this.sdkVersion,"1.1.0")>=0&&(wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),wx.onShareAppMessage(function(){return{title:c.AdConfig[l.PlatformSetting.currentApp][r.Platform.WECHAT].appTitle,imageUrl:"https://game2.sfplay.net/BraveTower/wechatIcon/20240920-165754.png"}})),this.compareVersion(this.sdkVersion,"2.0.4")>=0&&(this.videoAd=wx.createRewardedVideoAd({adUnitId:c.AdConfig[l.PlatformSetting.currentApp][r.Platform.WECHAT].videoId}),this.videoAd.onError(function(t){console.log(t)}))},t.prototype.youmengTrack=function(){},t.prototype.canShare=function(){return!0},t.prototype.login=function(t,e){e&&e()},t.prototype.pay=function(t,e){e&&e()},t.prototype.share=function(t,e){var o=Math.floor(3*Math.random());wx.shareAppMessage({title:["\u5e2e\u6211\u770b\u770b\u54ea\u4e2a\u5b57\u9519\u4e86\uff1f","\u4f60\u662f\u9003\u4e0d\u8fc7\u6211\u7684\u773c\u775b\u7684\uff01","\u5e2e\u6211\u770b\u770b\u54ea\u4e00\u53ea\u4e0d\u662f\u4f01\u9e45"][o],desc:"",imageUrl:"https://game2.sfplay.net/werid_assets/wechat/shareIcon/"+["1.jpeg","2.jpeg","3.jpeg"][o],query:"",success:function(){e&&e()},fail:function(){}})},t.prototype.showBanner=function(t,e){if(0==Math.floor(2*Math.random())){if(null==this.BannerAd)return;this.BannerAd.show().then(function(){}).catch(function(){})}else this.showBlockAd("banner");e&&e()},t.prototype.hideBanner=function(t){1!==t&&(null!=this.BannerAd&&this.BannerAd.hide(),this.hideBlockAd("banner"))},t.prototype.showInsertAd=function(t,e){if(this.compareVersion(this.sdkVersion,"2.6.0")>=0){var o=wx.createInterstitialAd({adUnitId:c.AdConfig[l.PlatformSetting.currentApp][r.Platform.WECHAT].insertId});o.onLoad(function(){o.show().then(function(){console.log("\u63d2\u5c4f\u5e7f\u544a\u5c55\u793a\u5b8c\u6210"),e&&e()}).catch(function(t){console.log("\u63d2\u5c4f\u5e7f\u544a\u5c55\u793a\u5931\u8d25",JSON.stringify(t))})}),o.onClose(function t(){o.offClose(t),o.destroy()}),o.onError(function(t){console.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",t),o.offError()}),o.onLoad(function(t){console.log("\u63d2\u5c4f\u5e7f\u544aonLoad\u5931\u8d25",t),o.offLoad()})}},t.prototype.showVideoAd=function(t,e,o){sfwx.WxZtSdk.instance.playAd(!0);var i=this.videoAd;i.show().then().catch(function(t){console.log(t.errMsg),i.load().then(function(){return i.show()}).catch(function(){o&&o()})}),i.onClose(function t(n){n&&n.isEnded||void 0===n?e&&(e(),sfwx.WxZtSdk.instance.playAd(!1)):o&&o(),i.load(),i.offClose(t)})},t.prototype.otherFun=function(t,e){e&&e()},t.prototype.shark=function(t,e){1==t?wx.vibrateLong({success:function(){},fail:function(){},complete:function(){}}):wx.vibrateShort({success:function(){},fail:function(){},complete:function(){}}),e&&e()},t.prototype.recordVideo=function(t,e){e&&e()},t.prototype.shareVideo=function(t,e){e&&e()},t.prototype.stopRecorderManager=function(t,e){e&&e("test.png")},t.prototype.setLanguage=function(t,e){return e&&e(),"zh"},t.prototype.compareVersion=function(t,e){t=t.split("."),e=e.split(".");for(var o=Math.max(t.length,e.length);t.length<o;)t.push("0");for(;e.length<o;)e.push("0");for(var i=0;i<o;i++){var n=parseInt(t[i]),a=parseInt(e[i]);if(n>a)return 1;if(n<a)return-1}return 0},t.prototype.getSystem=function(){return this._systemInfo.platform},t.prototype.hasVerify=function(){return!1},t.prototype.canCare=function(){return!1},t.prototype.canShowBtnMore=function(){return!1},t.prototype.showBlockAd=function(t){var e=this.customAdMap.get(t);1===t&&(e=this.customAdMap.get("home")),e&&e.show()},t.prototype.hideBlockAd=function(t){var e=this.customAdMap.get(t);1===t&&(e=this.customAdMap.get("home")),e&&e.hide()},t.prototype.showFloatIconAd=function(){},t.prototype.hideFloatIconAd=function(){},t.prototype.addShortcut=function(){},t.prototype.checkShortcut=function(){},t.prototype.shareImg=function(){},t.prototype.getUserInfo=function(t){t&&t(null,null)},t.prototype.initNativeAd=function(){},t.prototype.showNativeAd=function(){},t.prototype.showGamePortalAd=function(){s.LogMgr.getInstance().debug("\u66f4\u591a\u6e38\u620f")},t}();a.WechatManager=p,cc._RF.pop(),cc._RF.pop()},{}],WechatPayMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a030aieGPJEm5pGANe5GGAG","WechatPayMgr");var i=t,n=e,a=o;cc._RF.push(n,"a030aieGPJEm5pGANe5GGAG","WechatPayMgr"),Object.defineProperty(a,"__esModule",{value:!0}),a.WechatPayMgr=a.WXPayInfo=void 0;var r=i("HttpMgr");a.WXPayInfo=function(){};var s=function(){function t(){this.openIdKey="payopenkey",this.payUrl="https://yuema.sfplay.net/wxpay/",this.reqtime=0,this.isCallback=!1,this.isPaying=!1}return t.prototype.startPayItem=function(t,e,o,i){var n=this;if(void 0===i&&(i=1),this.isPaying)return wx.showToast({title:"\u6b63\u5728\u652f\u4ed8\u4e2d",icon:"error",duration:2e3}),void o(!1,"\u6b63\u5728\u652f\u4ed8\u4e2d");this.isPaying=!0,this.reqtime=0,this.isCallback=!1,this.getAppId(),this.getOpenId(function(a){if(!a)return wx.showToast({title:"openid\u83b7\u53d6\u9519\u8bef",icon:"error",duration:2e3}),void o(!1,"openid\u83b7\u53d6\u9519\u8bef");var s={appid:n.appId,openid:n.openId,productId:t,goodsPrice:e,buyQuantity:i};r.HttpMgr.getInstance().httpPost(s,function(t){var e=JSON.parse(t);e&&0==e.code?wx.requestMidasPaymentGameItem({signData:e.data.signData,paySig:e.data.paySig,signature:e.data.signature,success:function(){var t=JSON.parse(e.data.signData);n.isPaying=!1,n.paySuccess(t.outTradeNo,o)},fail:function(t,e){wx.showToast({title:"\u652f\u4ed8\u5931\u8d25",icon:"error",duration:2e3}),n.isPaying=!1,console.error(e+" \u652f\u4ed8\u5931\u8d25:",JSON.stringify(t)),o&&o(!1," \u652f\u4ed8\u5931\u8d25:"+JSON.stringify(t))}}):(n.isPaying=!1,wx.showToast({title:"\u652f\u4ed8\u5931\u8d25"+t,icon:"error",duration:2e3}),o&&o(!1," \u652f\u4ed8\u5931\u8d25:"+t))},n.payUrl+"genOrder",!0)})},t.prototype.queryOrder=function(t){var e=this;this.appId||this.getAppId();var o=function(){var o={appId:e.appId,openId:e.openId};r.HttpMgr.getInstance().httpPost(o,function(e){if(e&&e.startsWith("{")){var o=JSON.parse(e);if(0==o.code){for(var i=new Array,n=o.data,a=0;a<n.length;a++){for(var r=n[a],s=!1,c=0;c<i.length;c++){var l=i[c];if(l.productId==r.payid){s=!0,l.num++;break}}s||i.push({productId:r.payid,num:1})}t&&t(i)}else wx.showToast({title:o.msg,icon:0==o?"success":"error",duration:2e3}),t&&t([])}},e.payUrl+"queryAllOrder")};if(this.openId)o();else{var i=wx.getStorageSync(this.openIdKey),n=wx.getStorageSync("igame_openId"),a=wx.getStorageSync("um_od");i||n||a?(i?this.openId=i:n?this.openId=n:a&&(this.openId=a),this.openId?o():this.getOpenId(function(){o()})):this.getOpenId(function(){o()})}},t.prototype.paySuccess=function(t,e){var o=this;wx.showLoading({title:"\u67e5\u8be2\u8ba2\u5355\u4e2d",mask:!0});var i={orderid:t,appId:this.appId};this.invert=setInterval(function(){o.isCallback?o.isPaying=!1:o.requestOrder(i,function(t){o.isCallback?o.isPaying=!1:(o.isCallback=!0,1!=t.code&&(wx.hideLoading(),setTimeout(function(){wx.showToast({title:t.msg,icon:0==t?"success":"error",duration:2e3})},100),0==t.code&&e&&e(!0,"success")))})},2e3)},t.prototype.requestOrder=function(t,e){var o=this;this.reqtime+=1,r.HttpMgr.getInstance().httpPost(t,function(i){var n=JSON.parse(i);1==n.code?o.reqtime>=120?(clearInterval(o.invert),e({code:-6,msg:"\u8bf7\u7a0d\u540e\u67e5\u8be2"})):o.requestOrder(t,e):(clearInterval(o.invert),e(n))},this.payUrl+"queryOrder")},t.prototype.getAppId=function(){var t=wx.getAccountInfoSync().miniProgram;return t?(this.appId=t.appId,this.appId):null},t.prototype.getOpenId=function(t){var e=this,o=wx.getStorageSync(this.openIdKey);o||this.openId?r.HttpMgr.getInstance().httpPost({appId:this.appId,openId:o||this.openId},function(i){i&&i.startsWith("{")&&(-1==JSON.parse(i).data?e.login(t):t&&t(o||e.openId))},this.payUrl+"checkSessionKey"):this.login(t)},t.prototype.login=function(t){var e=this;wx.login({success:function(o){if(o&&o.code){var i={appId:e.appId,code:o.code};r.HttpMgr.getInstance().httpPost(i,function(o){var i=JSON.parse(o);i?0==i.code?(e.openId=i.data,wx.setStorageSync("igame_openId",e.openId),wx.setStorageSync("um_od",e.openId),t&&t(e.openId)):t&&t(null):setTimeout(function(){e.login(t)},1e3)},e.payUrl+"getOpenId")}else e.iLog("\u767b\u5f55\u5931\u8d25:"+o.errMsg)},fail:function(){t&&t(null)}})},t.prototype.iLog=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log("SF_WxPay:",t)},Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t}();a.WechatPayMgr=s,cc._RF.pop(),cc._RF.pop()},{}],YEARGameData:[function(t,e,o){"use strict";cc._RF.push(e,"a8eectylXlM5LnQZ/A4ykft","YEARGameData");var i=e,n=o;cc._RF.push(i,"a8eectylXlM5LnQZ/A4ykft","YEARGameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emYEARGameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffOddsCfg="buffOddsCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.dragonBallShowCfg="dragonBallShowCfg",t.dragonBallCfg="dragonBallCfg",t.levelCfg="levelCfg",t.mateOddsCfg="mateOddsCfg",t.mateCfg="mateCfg"}(n.emYEARGameDataKeys||(n.emYEARGameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],YEARGameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"6781dl4hsRLjZiu9/M3QnL0","YEARGameEnumData");var i=e,n=o;cc._RF.push(i,"6781dl4hsRLjZiu9/M3QnL0","YEARGameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.girlMoveSpeed=15]="girlMoveSpeed",t[t.wordsTime=16]="wordsTime",t[t.wordShow=17]="wordShow",t[t.dieWordDistance=18]="dieWordDistance",t[t.girlPosition=19]="girlPosition",t[t.dragonMoveAmniTime=20]="dragonMoveAmniTime",t[t.tipsStayTime=21]="tipsStayTime",t[t.ballFlySpeed=22]="ballFlySpeed",t[t.changeLimit=23]="changeLimit",t[t.sunsxLimit=24]="sunsxLimit"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],YEAR_App:[function(t,e,o){"use strict";cc._RF.push(e,"dc030K58BVFIaLaLTa0azzi","YEAR_App");var i=t,n=e,a=o;cc._RF.push(n,"dc030K58BVFIaLaLTa0azzi","YEAR_App"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("YEAR_Configs"),p=i("YEAR_DataMgr"),u=i("YEAR_PlayerMgr"),d=function(){function t(){this._isInited=!1,this._exitCall=null}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enter_App=function(t,e,o){var i=this;if(void 0===o&&(o=!1),l.Global.isDirect=o,this.addTouchEvent(),this._exitCall=e,o)s.UIMgr.getInstance().addUICnf(l.YEAR_UICF),r.AudioMgr.getInstance().addAdConf(l.YEAR_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){s.UIMgr.getInstance().openUIOfCallback(l.YEAR_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.YEAR_AudioId.bgm,l.YEARConfig.BgMusic)})})},!0);else{var n=function(){i._isInited=!0,u.default.getInstance().reset(),s.UIMgr.getInstance().openUIOfCallback(l.YEAR_UIID.UIGame,c.UIID.UINONE,function(){t&&t(),i.removeTouchEvent(),r.AudioMgr.getInstance().playMusic(l.YEAR_AudioId.bgm,l.YEARConfig.BgMusic)})};this._isInited?n():(s.UIMgr.getInstance().addUICnf(l.YEAR_UICF),r.AudioMgr.getInstance().addAdConf(l.YEAR_AudioCF),p.default.getInstance().load(function(){u.default.getInstance().preload(function(){n()})}))}},t.prototype.exit_App=function(t){s.UIMgr.getInstance().closeById(l.YEAR_UIID.UIGame),s.UIMgr.getInstance().closeById(l.YEAR_UIID.UIResult),s.UIMgr.getInstance().closeById(l.YEAR_UIID.UISetting),l.Global.isDirect||cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP),this._exitCall&&this._exitCall(t),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t}();a.default=d,cc._RF.pop(),cc._RF.pop()},{}],YEAR_BloodCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e63ednpPvRKtoiuJvDzgcpe","YEAR_BloodCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e63ednpPvRKtoiuJvDzgcpe","YEAR_BloodCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("PoolMgr"),p=i("Utils"),u=i("YEAR_Configs"),d=function(t,e){this.flag=t,this.num=e},h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useState=!1,e.bloodArr=[],e.limitTime=3,e.showNum=10,e}return s(e,t),e.prototype.isCirt=function(t,e){t?(this.isCritState.active=!0,this.critLabel.node.active=!0,this.commonLabel.node.active=!1,this.critLabel.string=e+""):(this.isCritState.active=!1,this.critLabel.node.active=!1,this.commonLabel.node.active=!0,this.commonLabel.string=e+""),this.doLabelTween()},e.prototype.doLabelTween=function(){var t=this;this.node.opacity=255;var e=p.Utils.randomRang(-30,30),o=p.Utils.randomRang(-30,30);this.node.x+=e,this.node.y+=o,cc.tween(this.node).by(.5,{y:100,opacity:-255}).call(function(){l.PoolMgr.getInstance().freeNode(u.poolName.blood,t.node)}).start()},e.prototype.resumeNode=function(){cc.tween(this.node).stop(),this.critLabel.node.active=!1,this.commonLabel.node.active=!1,this.node.x=0,this.node.y=0,this.node.opacity=255},e.prototype.inUse=function(){return this.useState},e.prototype.pushBlood=function(t,e){var o=new d(t,e);this.bloodArr.push(o)},e.prototype.showBlood=function(){for(var t=this.bloodArr.splice(0,this.showNum),e=0;e<t.length;e++){var o=t[e];this.isCirt(o.flag,o.num)}},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){(this.nowTime<0||!this.nowTime)&&(this.nowTime=this.limitTime,this.showBlood()),this.nowTime--},e.prototype.onDestroy=function(){this.bloodArr=[]},c([m(cc.Node)],e.prototype,"isCritState",void 0),c([m(cc.Label)],e.prototype,"critLabel",void 0),c([m(cc.Label)],e.prototype,"commonLabel",void 0),c([f],e)}(cc.Component);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],YEAR_Body:[function(t,e,o){"use strict";cc._RF.push(e,"0ce93d1cAVPIYe+W93GH2In","YEAR_Body");var i=t,n=e,a=o;cc._RF.push(n,"0ce93d1cAVPIYe+W93GH2In","YEAR_Body");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("YEAR_Configs"),d=i("YEARGameEnumData"),h=i("YEAR_DataMgr"),f=i("YEAR_UIGame"),m=i("YEAR_ball"),g=i("YEAR_bodyCtrl"),y=i("YEAR_boxCtrl"),v=i("YEAR_ballCtrl"),_=i("YEAR_fireNode"),b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.playerParent=null,e.box=null,e.hpParent=null,e.path=new Array,e.gapY=200,e.gapX=200,e.ballpState=!1,e.skillState=!1,e.nowIndex=0,e.moveWidth=300,e.colliderArr=[],e.width=35,e.lastTime=0,e.bodyArr=[],e.lastMoveTime=0,e.animationIndex=1,e.gapTime=0,e.nowTime=0,e.iceState=!1,e.fireState=!1,e.fireNum=0,e.vagueNum=1,e.onceTime=1,e.fireTime=0,e.haveFireNode=0,e.fireNodeArr=[],e.fireNodePos=[],e.num=0,e.dtNum=10,e.boxNum=0,e.isFirst=!0,e.isLast=!1,e.boxTemp=null,e.FirstAnimationTime=0,e.NeedDoAnimationTime=0,e.AnimationGapTime=.1,e.ballIndex=100001,e.fireIndex=100002,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){this.initBodyGapTime(),o.script=this,this.createPath(),this.ballCtrl=new v.default(this,this.path),this.lastNode=this.head,this.addEvent(u.emYEAREventName.pause,this.stop),this.addEvent(u.emYEAREventName.skillPause,this.skillPause),this.addEvent(u.emYEAREventName.skillResume,this.skillResume),this.addEvent(u.emYEAREventName.resume,this.resume),this.moveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed),this.gapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniTime),this.gapTime=.1,this.nowTime=this.gapTime,this.shouldMove=this.width,this.moveWidth=this.shouldMove,this.lastTime=Date.now()},e.prototype.doBallSkill=function(t,e){if(e.dragonBallID==m.ballID.iceBall)this.iceState=!0,this.stopAnimation();else if(e.dragonBallID==m.ballID.fireBall)if(t==m.ballState.dragon){var o=h.default.getInstance().getLevelCfgByID(this.nowIndex);this.createFireNode(e.dragonGetPara1*o.dragonHp,e.dragonGetPara2)}else this.fireState=!0,this.fireNum=e.playerGetPara1,this.changeFire();else e.dragonBallID==m.ballID.thunderBall||(e.dragonBallID==m.ballID.windBall?this.moveSpeed=e.dragonGetPara1:e.dragonBallID==m.ballID.vagueBall&&(this.vagueNum=e.dragonGetPara1));this.showBuff(e.dragonBallID)},e.prototype.changeFire=function(){for(var t in this.bodyArr)this.bodyArr[t].getComponent(g.default).changeFireState()},e.prototype.showBuff=function(t){if(t==m.ballID.iceBall){this.iceNode.active=!0;var e=this.iceNode.getComponent(sp.Skeleton);e.setAnimation(0,"dj_1",!1),e.setCompleteListener(function(){e.setAnimation(0,"dj_2",!0)})}else if(t==m.ballID.vagueBall){this.shieldNode.active=!0;var o=f.default.script.getWallPosY()+225;this.shieldNode.y=this.head.y-200<o?o:this.head.y-200,this.shieldNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!0)}},e.prototype.resumeBuff=function(t){var e=this;if(t==m.ballID.iceBall){var o=this.iceNode.getComponent(sp.Skeleton);o.setAnimation(0,"dj_3",!1),o.setCompleteListener(function(){e.iceNode.active=!1})}else t==m.ballID.vagueBall&&(this.shieldNode.active=!1)},e.prototype.resumeBallSkill=function(t){t==m.ballID.iceBall?(this.iceState=!1,this.resumeAnimation()):t==m.ballID.fireBall?(this.fireState=!1,this.changeFire()):t==m.ballID.windBall?this.moveSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed):t==m.ballID.vagueBall&&(this.vagueNum=1),this.resumeBuff(t)},e.prototype.doFireLose=function(t){if(this.fireTime-=t,this.fireTime<0)for(var e in this.fireTime=this.onceTime,this.colliderArr)this.colliderArr[e].getComponent(y.default).doFireDamage(this.fireNum*this.vagueNum)},e.prototype.createFireNode=function(t,e){this.fireNodeArr=[],this.fireNodePos=[];var o=cc.winSize.height/2+this.fireNode.height/2+50,i=this.fireNode.width-100,n=this.fireNode.height;this.haveFireNode=3;for(var a=-1;a<=1;a++)this.fireNodePos.push(new cc.Vec2(i*a+0,n*Math.abs(a)+o));for(this.fireNodePos[2].y-=100,a=0;a<this.fireNodePos.length;a++){var r=cc.instantiate(this.fireNode);r.parent=this.fireNode.parent,r.setPosition(this.fireNodePos[a]),r.getComponent(_.default).initParam(t,e),this.fireNodeArr.push(r)}},e.prototype.fireNodeDestroy=function(){this.haveFireNode--},e.prototype.skillPause=function(){this.skillState=!0},e.prototype.skillResume=function(){this.skillState=!1},e.prototype.stop=function(){this.ballpState=!0,this.stopAnimation()},e.prototype.stopAnimation=function(){for(var t in this.head.getComponent(g.default).stop(),this.bodyArr)this.bodyArr[t].getComponent(g.default)&&this.bodyArr[t].getComponent(g.default).stop()},e.prototype.resumeAnimation=function(){if(!this.iceState)for(var t in this.head.getComponent(g.default).resume(),this.bodyArr)this.bodyArr[t].getComponent(g.default)&&this.bodyArr[t].getComponent(g.default).resume()},e.prototype.resume=function(){this.ballpState=!1,this.lastTime=Date.now(),this.resumeAnimation()},e.prototype.getTurn=function(){return new cc.Vec2(200,this.gapY/2)},e.prototype.initBanner=function(t){var e=this;this.ballBanner.active=!0,this.ballBanner.getComponentInChildren(cc.Label).string=t+"\u5df2\u51fa\u73b0\uff0c\u5f00\u59cb\u62a2\u593a\uff01",this.bannerGapTime||(this.bannerGapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.tipsStayTime)),this.scheduleOnce(function(){e.ballBanner.active=!1},this.bannerGapTime)},e.prototype.createPath=function(){for(var t=-this.bgNode.width/2-30,e=cc.winSize.height/2-100,o=this.bgNode.width,i=f.default.script.getWallPosY(),n=this.bgNode.height/2+i,a=-this.bgNode.height/2+n,r=0;e>a;r++){for(var s=0;s<3;s++){var c=void 0;if(r%2==0){var l=2==s?this.gapX:0,p=2==s?this.gapY/2:0,u=0==s?t+l:t+o+l;c=new cc.Vec2(u,e-p)}else l=2==s?this.gapX:0,p=2==s?this.gapY/2:0,u=0==s?-t+l:-t-o-l,c=new cc.Vec2(u,e-p);if(Math.abs(c.y-i)<=100){for(;this.path.length<3*r+s+1;)this.path.push(new cc.Vec2(0,i));return void(this.path[this.path.length-1]=new cc.Vec2(0,i))}this.path.push(c)}e-=this.gapY}this.path[this.path.length-1]=new cc.Vec2(0,i)},e.prototype.changeSpeed=function(t,e){var o=Number(e);o<0?this.ballCtrl.test():this.moveSpeed=o},e.prototype.start=function(){this.head.zIndex=1e3,this.head.setPosition(this.path[0].x-200,this.path[0].y),this.head.getComponent(g.default).startYEAR(this.path,-1,0,0),this.bodyArr.push(this.head)},e.prototype.getHeadY=function(){var t=9999;return t=Math.min(t,this.head.y),t=Math.min(t,this.ballNode.y),t=Math.min(t,this.fireNode.y),this.head.y},e.prototype.getHeadNode=function(){return this.head},e.prototype.createNode=function(t){this.isLast||(this.moveWidth-=this.moveSpeed*t,this.lastMoveTime+=Number(t.toFixed(4)),this.moveWidth<=0&&(this.moveWidth+=this.shouldMove,this.createBody()))},e.prototype.initBodyGapTime=function(){this.AnimationGapTime=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmniTime)},e.prototype.createBody=function(){this.num>=9&&!u.Global.canAttack&&(u.Global.canAttack=!0),this.num%8==0&&(this.boxTemp&&this.boxTemp.getComponent(y.default).setCanBeAttack(),this.boxTemp=p.PoolMgr.getInstance().getNode(u.poolName.box),this.boxTemp||(this.boxTemp=cc.instantiate(this.boxNode)),this.nowIndex++,this.boxTemp.parent=this.hpParent,this.boxTemp.active=!0);var t=this.nowIndex%4;this.checkLength()&&(t=4,this.isLast=!0);var e=this.boxTemp.getComponent(y.default),o=h.default.getInstance().getLevelCfgByID(this.nowIndex),i=p.PoolMgr.getInstance().getNode(u.poolName.body);i||(i=cc.instantiate(this.player)),i.active=!0,i.parent=this.playerParent,this.bodyArr.push(i);var n=i.getComponent(g.default);n.setPreNode(this.lastNode,this.shouldMove);var a=Number((Date.now()/1e3).toFixed(2));this.NeedDoAnimationTime+=this.AnimationGapTime;var r=this.NeedDoAnimationTime-(a-this.FirstAnimationTime);n.doAnimation(r),this.fireState&&n.changeFireState();var s=this.lastNode.getComponent(g.default).getIndex();this.num%8==0&&(this.lastMoveTime=0),n.startYEAR(this.path,t,0,s),this.lastNode=i,e.addOtherNode(i),this.num%4==0&&this.num%8!=0&&(this.checkLength(1)?e.initNode(i,o.dragonHp,this.nowIndex,!0):e.initNode(i,o.dragonHp,this.nowIndex,!1),this.colliderArr.push(this.boxTemp)),i.zIndex=2e3-this.num++,this.isFirst&&(this.isFirst=!1)},e.prototype.doAnimation=function(t){if(this.nowTime>0)this.nowTime-=t;else{var e=this.bodyArr[this.animationIndex];e&&(this.animationIndex++,e.getComponent(g.default).doAnimation(),this.nowTime+=this.gapTime)}},e.prototype.checkLength=function(t){return void 0===t&&(t=0),this.nowIndex>=h.default.getInstance().getLevelCfg().length-t},e.prototype.checkCollider=function(t,e,o){var i=null,n=-1;for(var a in e!=this.ballIndex&&-1==n&&this.ballNode.getComponent(m.default).checkCollider(t)&&(i=this.ballNode.getComponent(m.default),n=this.ballIndex),this.fireNodeArr){if(-1!=n)break;var r=this.fireIndex+Number(a),s=this.fireNodeArr[a];e!=r&&s.getComponent(_.default).checkCollider(t)&&(i=s.getComponent(_.default),n=r)}for(var a in this.colliderArr){if(-1!=n)break;if(Number(a)!=e){var c=this.colliderArr[a].getComponent(y.default);c.checkCollider(t)&&(i=c,n=Number(a))}}return-1!=n&&this.handleAttack(o,i),n},e.prototype.handleAttack=function(t,e){var o=t.getDamageProperty(),i=Math.floor(o.damage*this.vagueNum);e.handleDamage(i,o.pos,o.isCrit,o.timer,o.timer>1)},e.prototype.checkSkillCollider=function(t,e){for(var o in e*=this.vagueNum,e=Math.floor(e),this.ballNode.getComponent(m.default).checkSkillCollider(t,e),this.fireNodeArr)this.fireNodeArr[o].getComponent(_.default).checkSkillCollider(t,e);for(var o in this.colliderArr)this.colliderArr[o].getComponent(y.default).checkSkillCollider(t,e)},e.prototype.moveBody=function(t){for(var e=0;e<this.bodyArr.length;e++){var o=this.bodyArr[e];o?o.getComponent(g.default).onUpdate(t,this.moveSpeed):(this.bodyArr.splice(e,1),e--)}},e.prototype.update=function(t){if(!this.ballpState){if(!this.skillState&&!this.iceState){if(this.haveFireNode)for(var e=0;e<this.fireNodeArr.length;e++)this.fireNodeArr[e].getComponent(_.default).onUpdate(t);this.createNode(t),this.moveBody(t)}this.fireState&&this.doFireLose(t);var o=Date.now(),i=(o-this.lastTime)/1e3;this.ballCtrl.onUpdate(i),this.lastTime=o}},c([I(cc.Animation)],e.prototype,"animation",void 0),c([I(cc.Node)],e.prototype,"head",void 0),c([I(cc.Node)],e.prototype,"playerParent",void 0),c([I(cc.Node)],e.prototype,"box",void 0),c([I(cc.Node)],e.prototype,"hpParent",void 0),c([I(cc.Node)],e.prototype,"boxNode",void 0),c([I(cc.Node)],e.prototype,"player",void 0),c([I(cc.Node)],e.prototype,"bgNode",void 0),c([I(cc.Node)],e.prototype,"ballNode",void 0),c([I(cc.Node)],e.prototype,"fireNode",void 0),c([I(cc.Node)],e.prototype,"ballBanner",void 0),c([I(cc.Node)],e.prototype,"iceNode",void 0),c([I(cc.Node)],e.prototype,"shieldNode",void 0),c([I({tooltip:"\u4fe9\u6392\u9f99\u4e4b\u95f4\u7684\u95f4\u9694"})],e.prototype,"gapY",void 0),c([I({tooltip:"\u8f6c\u5f2f\u5904\u79bb\u5c4f\u5e55\u7684\u8ddd\u79bb"})],e.prototype,"gapX",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],YEAR_BuffCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"59c8cq9uGVHypQHyPogzO0+","YEAR_BuffCtrl");var i=t,n=e,a=o;cc._RF.push(n,"59c8cq9uGVHypQHyPogzO0+","YEAR_BuffCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("Utils"),d=i("YEAR_Configs"),h=i("YEARGameEnumData"),f=i("YEAR_DataMgr"),m=i("YEAR_UIGame"),g=i("YEAR_Hero"),y=i("YEAR_HeroCtrl"),v=cc._decorator,_=v.ccclass,b=v.property,B=function(t,e){this.name=t,this.weight=e},I=function(t,e,o,i,n,a){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===o&&(o=null),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=0),this.isNew=t,this.newID=e,this.heroNode=o,this.type=i,this.addType=n,this.addNum=a},P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.nodeObj1=new I,e.nodeObj2=new I,e.lock=!0,e}return s(e,t),e.prototype.initNode=function(t){this.node.active=!1;var e=f.default.getInstance().getLevelCfgByID(t);if(e){if(e.buffType)if(1==e.buffType){var o=this.getResult(),i=this.getResult(),n=this.getPropertyResultArr(o,i,e);(0==o||1==o||2==o)&&this.initPropertyNode(o,n[0],this.node1,this.nodeObj1),(0==i||1==i||2==i)&&this.initPropertyNode(i,n[1],this.node2,this.nodeObj2)}else if(2==e.buffType){if(0==(o=this.getResult())){var a=this.getPropertyResult(e.buff1,o);this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)}else 1==o?(a=this.getPropertyResult(e.buff2?e.buff2:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1)):2==o&&(a=this.getPropertyResult(e.buff3?e.buff3:e.buff1,o),this.initPropertyNode(o,a[0],this.node1,this.nodeObj1));var r=this.getNewRole();this.initNewNode(r[0],this.node2,this.nodeObj2)}else r=this.getNewRole(2),this.initNewNode(r[0],this.node1,this.nodeObj1),this.initNewNode(r[1],this.node2,this.nodeObj2)}else console.error("\u5b9d\u7bb1\u9519\u8bef")},e.prototype.getPropertyResultArr=function(t,e,o){var i=[];if(t==e){var n=t+1>=d.Global.heroID.length?t-1:t+1,a=void 0;0==n?a=o.buff1:1==n?a=o.buff2?o.buff2:o.buff1:2==n&&(a=o.buff3?o.buff3:o.buff1),0==t?i=this.getPropertyResult(o.buff1,t,2,n,a):1==t?i=this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,2,n,a):2==t&&(i=this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,2,n,a))}else 0==t?i=i.concat(this.getPropertyResult(o.buff1,t,1)):1==t?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,t,1)):2==t&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,t,1))),0==e?i=i.concat(this.getPropertyResult(o.buff1,e,1)):1==e?i=i.concat(this.getPropertyResult(o.buff2?o.buff2:o.buff1,e,1)):2==e&&(i=i.concat(this.getPropertyResult(o.buff3?o.buff3:o.buff1,e,1)));return i},e.prototype.getResult=function(){var t=f.default.getInstance().getBuffOddsCfgByAmount(d.Global.heroID.length),e=[],o=t.buff1Odds+t.buff2Odds+t.buff3Odds;e.push(t.buff1Odds),e.push(t.buff2Odds),e.push(t.buff3Odds);for(var i=Math.random()*o,n=0;n<e.length;n++)if((i-=e[n])<=0)return n},e.prototype.getPropertyResult=function(t,e,o,i,n){void 0===o&&(o=1),void 0===i&&(i=0),void 0===n&&(n="");var a=t.split("|"),r=[];a=this.getLegalArr(a,e);for(var s=Object.keys(a);o--;){var c=Math.floor(Math.random()*s.length);if(r.push(a[s[c]]),s.splice(c,1),0==s.length&&o>0){var l=n.split("|");l=this.getLegalArr(l,i),r.push(l[0]);break}}return r},e.prototype.getLegalArr=function(t,e){var o=JSON.parse(JSON.stringify(t)),i=d.Global.heroID[e].node;if(3==d.Global.heroID[e].id){for(var n=0;n<o.length;n++)if(o[n].includes("penetrate")){o.splice(n,1);break}}else if(i.getComponent(g.default).getAttackSpeedState())for(n=0;n<o.length;n++)if(o[n].includes("speed")){o.splice(n,1);break}return o},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=[],o=d.Global.heroID[0].id,i=d.Global.heroID[1]?d.Global.heroID[1].id:-1;for(var n in d.Global.heroID){var a=d.Global.heroID[n].id,r=f.default.getInstance().getMateOddsCfgByID(a);e=e.concat(this.createRoleLottery(r.mateOdds.split("|"),o,i))}for(var s=[];t--;){var c=Number(u.Utils.weight_rand(e).name);for(n=0;n<e.length;n++)c==Number(e[n].name)&&(e.splice(n,1),n--);s.push(c)}return s},e.prototype.createRoleLottery=function(t,e,o){var i=[];for(var n in t){var a=t[n].split(","),r=Number(a[0]),s=Number(a[1]);if(e!=r&&r!=o){var c=new B(r.toString(),s);i.push(c)}}return i},e.prototype.initPropertyNode=function(t,e,o,i){var n=this;o.getComponent(cc.Sprite).spriteFrame=0==t?this.sp[0]:this.sp[1];var a=d.Global.heroID[t].id,r=f.default.getInstance().getCharacterByID(a);this.loadSpriteFrame(d.emYEARBundles.imgs,"js_b/"+r.image,function(r){n.initPropertyView(o,r,e,a),n.lock=!1,n.node.active=!0;var s=Number(e.split(",")[1]);e=e.split(",")[0],i.isNew=!1,i.addNum=s;var c=f.default.getInstance().getBuffByKey(e);i.addType=c.plusOrMul,i.heroNode=d.Global.heroID[t].node,c.buffType==d.emYEARBuffType.speedPlus?i.type=1:c.buffType==d.emYEARBuffType.ATKmul||c.buffType==d.emYEARBuffType.ATKplus?i.type=2:c.buffType==d.emYEARBuffType.penetratePlus?i.type=3:c.buffType==d.emYEARBuffType.bulletPlus?i.type=4:c.buffType==d.emYEARBuffType.critPlus?i.type=5:c.buffType==d.emYEARBuffType.skillMul&&(i.type=6)})},e.prototype.initPropertyView=function(t,e,o,i){var n=t.getChildByName("isNew"),a=t.getChildByName("item");t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e,n.active=!1,a.getChildByName("newName").active=!1;var r=a.getChildByName("property"),s=a.getChildByName("propertyNum");r.active=!0,s.active=!0;var c=Number(o.split(",")[1]);o=o.split(",")[0];var l=f.default.getInstance().getCharacterByID(i).characterName,p=f.default.getInstance().getBuffByKey(o);r.getComponent(cc.Label).string=l+p.buffWord;var u="";1==p.plusOrMul?(u="+",u+=c<1?100*c+"%":c):(u="\xd7",u+=c<1?100*c+"%":c),s.getComponent(cc.Label).string=u},e.prototype.initNewNode=function(t,e,o){var i=this;e.getComponent(cc.Sprite).spriteFrame=this.sp[1];var n=e.getChildByName("isNew"),a=e.getChildByName("item"),r=e.getChildByName("icon"),s=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emYEARBundles.imgs,"js_b/"+s.image,function(e){r.getComponent(cc.Sprite).spriteFrame=e,i.lock=!1,i.node.active=!0,n.active=!0,a.getChildByName("newName").active=!0,a.getChildByName("newName").getComponent(cc.Label).string=f.default.getInstance().getCharacterByID(t).characterName;var s=a.getChildByName("property"),c=a.getChildByName("propertyNum");s.active=!1,c.active=!1,o.isNew=!0,o.newID=t})},e.prototype.doReward=function(){p.AudioMgr.getInstance().playEffectFree(d.YEAR_AudioId.buff),y.default.script.checkCollider()?this.nodeObj1.isNew?y.default.script.addHero(this.nodeObj1.newID):this.doPeopertyReward(this.nodeObj1):this.nodeObj2.isNew?y.default.script.addHero(this.nodeObj2.newID):this.doPeopertyReward(this.nodeObj2),this.node.destroy()},e.prototype.doPeopertyReward=function(t){var e=t.heroNode,o=t.type;1==o?e.getComponent(g.default).addAttackSpeed(t.addType,t.addNum):2==o?e.getComponent(g.default).addAttackPower(t.addType,t.addNum):3==o?e.getComponent(g.default).addAttackPenerate(t.addType,t.addNum):4==o?e.getComponent(g.default).addBulletCount(t.addType,t.addNum):5==o?e.getComponent(g.default).addCritChance(t.addType,t.addNum):6==o&&e.getComponent(g.default).addSkill(t.addType,t.addNum)},e.prototype.checkCollider=function(){},e.prototype.onLoad=function(){this.addEvent(d.emYEAREventName.pause,this.yearp),this.addEvent(d.emYEAREventName.resume,this.resume)},e.prototype.yearp=function(){this.lock=!0},e.prototype.resume=function(){this.lock=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.lock||(this.node.y-=f.default.getInstance().getParam(h.enumBasicParaCfg.buffMove)*t*100,m.default.script.checkReWardLayer(this.node.y)&&this.doReward())},c([b(cc.Node)],e.prototype,"node1",void 0),c([b(cc.Node)],e.prototype,"node2",void 0),c([b(cc.SpriteFrame)],e.prototype,"sp",void 0),c([_],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],YEAR_Bullet2V2:[function(t,e,o){"use strict";cc._RF.push(e,"0e750F+nIpOq5KajWwUV2rH","YEAR_Bullet2V2");var i,n=t,a=o,r=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var c=n("BaseUI"),l=n("AudioMgr"),p=n("PoolMgr"),u=n("YEAR_Configs"),d=n("YEAR_Body"),h=n("YEAR_Hero"),f=function(t,e,o,i){this.damage=t,this.isCrit=e,this.pos=o,this.timer=i};a.damageObj=f;var m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDeyearry=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e.timer=0,e.hurtID=0,e}var o;return r(e,t),o=e,e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,f){if(void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===f&&(f=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDeyearry=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.heroCtrl=c.getComponent(h.default),this.createNeedCheckY(),this.timer>1)for(var m in f)r=cc.instantiate(r),this.initNodeView(a,r,s,f[m]);else this.initNodeView(a,r,s)},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=d.default.script.getHeadY()-this.node.y},e.prototype.update=function(t){if(this.active&&!this.isDeyearry){var e=this.flySpeed*t*100;if(this.node.y+=e,this.range-=e,this.needCheckY-=e,this.range<=0&&this.removeNode(),this.needCheckY<=0){var i=d.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(u.emYEAREventName.GAD_Show_Hit_Effect,n),l.AudioMgr.getInstance().playEffect(u.YEAR_AudioId.yeargonHit,u.YEAR_AudioId.yeargonHit+this.hurtID),this.hurtID++,this.hurtID%=3,this.lastAttackID=i,this.onDie()}}}},e.prototype.getDamageProperty=function(){return this.hit()},e.prototype.hit=function(){return this.damage=this.heroCtrl.getAttackPower(),this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new f(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition(),this.timer)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDeyearry||(this.isDeyearry=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)p.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start())},e.prototype.render=function(){},e.prototype.yearp=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},o=s([g],e)}(c.default));a.default=y,cc._RF.pop()},{}],YEAR_Bullet2:[function(t,e,o){"use strict";cc._RF.push(e,"dc7982C+CNMkIgGvwOHOZWo","YEAR_Bullet2");var i=t,n=e,a=o;cc._RF.push(n,"dc7982C+CNMkIgGvwOHOZWo","YEAR_Bullet2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("BaseUI"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("YEAR_Configs"),h=i("YEAR_Body"),f=i("YEAR_Hero"),m=function(t,e,o,i){this.damage=t,this.isCrit=e,this.pos=o,this.timer=i};a.damageObj=m;var g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e.prefab=[],e.penetrate=0,e.isDeyearry=!1,e.lastAttackID=-1,e.flag=!1,e.maxSpeed=5,e.timer=0,e.hurtID=0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(t,e,o,i,n,a,r,s,c,l,p,u,d,h){if(void 0===i&&(i=.2),void 0===n&&(n=2),void 0===d&&(d=1),void 0===h&&(h=[]),this.hero=c,this.active=!0,this.bulletIndex=l,this.isDeyearry=!1,this.lastAttackID=-1,this.poolName=p,this.speed=u,this.timer=d,this.initParm(t,e,o,i,n),this.heroCtrl=c.getComponent(f.default),this.createNeedCheckY(),this.timer>1)for(var m in h)r=cc.instantiate(r),this.initNodeView(a,r,s,h[m]);else this.initNodeView(a,r,s)},e.prototype.initParm=function(t,e,o,i,n){this.damage=t,this.range=2e3,this.critChance=i,this.critMultiplier=n,this.penetrate=o,this.flySpeed=e},e.prototype.initNodeView=function(t,e,o,i){void 0===i&&(i=null),this.position=t,this.prefab.push(e),e.parent=this.node,i?e.setPosition(i):e.setPosition(0,0),this.node.setPosition(this.position),this.node.parent=o,this.node.opacity=255},e.prototype.initNoInfackNodeView=function(){},e.prototype.onLoad=function(){},e.prototype.createNeedCheckY=function(){this.needCheckY=h.default.script.getHeadY()-this.node.y},e.prototype.update=function(t){if(this.active&&!this.isDeyearry){var e=this.flySpeed*t*100;if(this.node.y+=e,this.range-=e,this.needCheckY-=e,this.range<=0&&this.removeNode(),this.needCheckY<=0){var i=h.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(i>=0){var n=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(d.emYEAREventName.GAD_Show_Hit_Effect,n),p.AudioMgr.getInstance().playEffect(d.YEAR_AudioId.yeargonHit,d.YEAR_AudioId.yeargonHit+this.hurtID),this.hurtID++,this.hurtID%=3,this.lastAttackID=i,this.onDie()}}}},e.prototype.getDamageProperty=function(){return this.hit()},e.prototype.hit=function(){return this.damage=this.heroCtrl.getAttackPower(),this.finalDamage=this.damage,Math.random()<this.critChance&&(this.finalDamage*=this.critMultiplier),new m(this.finalDamage,this.finalDamage>this.damage,this.node.getPosition(),this.timer)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.onDie=function(){this.penetrate--,this.penetrate>=0||this.removeNode()},e.prototype.removeNode=function(){var t=this;this.isDeyearry||(this.isDeyearry=!0,cc.tween(this.node).to(.1,{opacity:0}).call(function(){for(var e in t.node.destroy(),t.node.removeFromParent(),t.node.removeAllChildren(),t.prefab)u.PoolMgr.getInstance().freeNode(t.poolName,t.prefab[e]);t.prefab=[]}).start())},e.prototype.render=function(){},e.prototype.yearp=function(){this.active=!1},e.prototype.resume=function(){this.active=!0},o=c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],YEAR_Bullet3:[function(t,e,o){"use strict";cc._RF.push(e,"e41edjOVF9JhrYHBd0OOZjr","YEAR_Bullet3");var i=t,n=e,a=o;cc._RF.push(n,"e41edjOVF9JhrYHBd0OOZjr","YEAR_Bullet3");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.damageObj=void 0;var l=i("YEAR_Configs"),p=i("YEAR_UIGame"),u=i("YEAR_Body"),d=i("YEAR_Bullet2V2"),h=i("Utils"),f=i("YEAR_DataMgr"),m=i("AudioMgr");a.damageObj=function(t,e,o){this.damage=t,this.isCrit=e,this.pos=o};var g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.angle=0,e.degree=10,e.onlyWall=!1,e.needBounce=!1,e.basePenarate=0,e.disappearTime=0,e.readyBounce=!1,e.hurtID=0,e}var o;return s(e,t),o=e,e.prototype.initNode=function(e,o,i,n,a,r,s,c,p,u,d,h,m,g){void 0===n&&(n=.2),void 0===a&&(a=2),void 0===m&&(m=1),void 0===g&&(g=[]),t.prototype.initNode.call(this,e,o,i,n,a,r,s,c,p,u,d,h,m,g);var y=Number(d.split("bullet")[1]);if(3!=y&&17!=y||(this.needBounce=!0),this.needBounce){this.initAngle(),this.lastDir=l.bulletDir.None;var v=f.default.getInstance().getCharacterByID(y);this.disappearTime=v.disappearTime,this.degree=v.hitTimes?v.hitTimes:10,this.flySpeed=v.bulletSpeed?v.bulletSpeed:o,3==y?this.onlyWall=!0:(this.onlyWall=!1,this.basePenarate=i)}},e.prototype.resume=function(){if(t.prototype.resume.call(this),this.needBounce&&!this.onlyWall)for(var e in this.prefab)this.prefab[e].children[0].getComponent(cc.Animation).resume()},e.prototype.yearp=function(){if(t.prototype.yearp.call(this),this.needBounce&&!this.onlyWall)for(var e in this.prefab)this.prefab[e].children[0].getComponent(cc.Animation).pause()},e.prototype.initAngle=function(){var t=h.Utils.randomRang(-45,45);this.angle=t;var e=(t+90)*(Math.PI/180),o=new cc.Vec3(Math.cos(e),Math.sin(e),0);this.velocity=o.multiplyScalar(100*this.flySpeed),this.changeAngle()},e.prototype.changeAngle=function(){for(var t in this.lastAttackID=-1,this.prefab)this.prefab[t].angle=this.angle},e.prototype.onDie=function(){this.needBounce?(this.degree--,this.onlyWall||(this.penetrate--,this.penetrate<0&&this.bounceWithDragon()),this.degree>=0||this.removeNode()):t.prototype.onDie.call(this)},e.prototype.bounceWithDragon=function(){this.penetrate=this.heroCtrl.getPenetrate(),this.lastDir=l.bulletDir.None,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()},e.prototype.overSide=function(t,e){if(this.readyBounce){var o=!1;t.x<e.leftBoundary-100&&(o=!0),t.x>e.rightBoundary+100&&(o=!0),t.y<e.downBoundary-100&&(o=!0),t.y>e.upBoundary+100&&(o=!0),o&&this.removeNode()}},e.prototype.disAppearNode=function(t){this.disappearTime-=t,this.disappearTime<=0&&this.removeNode()},e.prototype.onLoad=function(){},e.prototype.update=function(e){if(this.needBounce){if(this.active&&!this.isDeyearry){this.disAppearNode(e);var i=this.velocity.clone().multiplyScalar(e);this.node.setPosition(this.node.position.add(i));var n=p.default.script.getBulletBoundary(),a=this.node.position;a.y>n.downBoundary&&(this.readyBounce=!0),this.readyBounce&&(this.overSide(a,n),a.x<n.leftBoundary&&this.lastDir!=l.bulletDir.left&&(this.lastDir=l.bulletDir.left,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),a.x>n.rightBoundary&&this.lastDir!=l.bulletDir.right&&(this.lastDir=l.bulletDir.right,this.velocity.x=-this.velocity.x,this.angle=-1*this.angle,this.changeAngle()),a.y<n.downBoundary&&this.lastDir!=l.bulletDir.down&&(this.lastDir=l.bulletDir.down,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()),a.y>n.upBoundary&&this.lastDir!=l.bulletDir.up&&(this.lastDir=l.bulletDir.up,this.velocity.y=-this.velocity.y,this.angle=-1*this.angle+180,this.changeAngle()));var r=u.default.script.checkCollider(this.node.getPosition(),this.lastAttackID,this.node.getComponent(o));if(r>=0){var s=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.sendEvent(l.emYEAREventName.GAD_Show_Hit_Effect,s),this.lastAttackID=r,m.AudioMgr.getInstance().playEffect(l.YEAR_AudioId.yeargonHit,l.YEAR_AudioId.yeargonHit+this.hurtID),this.hurtID++,this.hurtID%=3,this.onDie()}}}else t.prototype.update.call(this,e)},o=c([y],e)}(d.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],YEAR_BulletEffect:[function(t,e,o){"use strict";cc._RF.push(e,"d8438gKdotJtopAOEQPFaBJ","YEAR_BulletEffect");var i=e,n=o;cc._RF.push(i,"d8438gKdotJtopAOEQPFaBJ","YEAR_BulletEffect");var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndBullet=null,e.ndMotionList=[null],e.ndParticleList=[null],e}return r(e,t),e.prototype.start=function(){this.show()},e.prototype.hide=function(){this.ndMotionList.forEach(function(t){t.node.active=!1}),this.ndParticleList.forEach(function(t){t.node.active=!1,t.resetSystem()})},e.prototype.show=function(){this.ndBullet.active=!0,this.ndMotionList.forEach(function(t){t.node.active=!0}),this.ndParticleList.forEach(function(t){t.node.active=!0,t.resetSystem()})},s([p({type:cc.Node,tooltip:"\u5b50\u5f39\u5934"})],e.prototype,"ndBullet",void 0),s([p({type:[cc.MotionStreak],tooltip:"\u62d6\u5c3e"})],e.prototype,"ndMotionList",void 0),s([p({type:[cc.ParticleSystem],tooltip:"\u7c92\u5b50"})],e.prototype,"ndParticleList",void 0),s([l],e)}(cc.Component);n.default=u,cc._RF.pop(),cc._RF.pop()},{}],YEAR_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"70cdbBWElxCKqPkO2WlMEBh","YEAR_Configs");var i,n,a,r,s,c=e,l=o;cc._RF.push(c,"70cdbBWElxCKqPkO2WlMEBh","YEAR_Configs"),Object.defineProperty(l,"__esModule",{value:!0}),l.Global=l.bulletDir=l.emYEARHitState=l.poolName=l.emYEARBuffType=l.emYEARGameState=l.emYEARRoleState=l.emYEARRoleType=l.emYEAREventName=l.YEAR_AudioCF=l.YEAR_AudioId=l.YEAR_UICF=l.YEARConfig=l.emYEARBundles=l.YEAR_UIID=void 0,function(t){t.UIGame="YEAR_UIGame",t.UIResult="YEAR_UIResult",t.UISetting="YEAR_UISetting"}(a=l.YEAR_UIID||(l.YEAR_UIID={})),function(t){t.prefabs="year_prefabs",t.audios="year_audios",t.imgs="year_imgs",t.configs="year_configs",t.configsB="year_configsB"}(r=l.emYEARBundles||(l.emYEARBundles={})),l.YEARConfig={WallWidth:350,EnemyFixedWidth:188,BgMusic:"BraveTowerBG",BottomHeight:265},l.YEAR_UICF=((i={})[a.UIGame]={prefab:"ui/YEAR_UIGame",name:"YEAR_UIGame",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UIResult]={prefab:"ui/YEAR_UIResult",name:"YEAR_UIResult",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i[a.UISetting]={prefab:"ui/YEAR_UISetting",name:"YEAR_UISetting",showTop:!0,showMult:!1,zIndex:1e3,bundleName:r.prefabs},i),function(t){t.bgm="bgm",t.buff="buff",t.bullet="bullet",t.burn="burn",t.fail="fail",t.godGun="godGun",t.mission="mission",t.palm="palm",t.pinkfire="pinkfire",t.yeargonHit="dragonHit",t.rake="rake",t.typhoon="typhoon",t.goldGod="goldGod",t.classic="classic",t.swordHit="swordHit",t.barrier="barrier",t.dragonYearGet="dragonBallGet",t.dragonYearShow="dragonBallShow",t.electric="electric",t.fireyear="fireball",t.ice="ice",t.icebreak="icebreak",t.lightningBullet="lightningBullet",t.magic="magic",t.wind="wind",t.moon="moon",t.boomerang="boomerang",t.boom="boom",t.moonGod="moonGod",t.doubleSword="doubleSword",t.lotus="lotus",t.summon="summon",t.bluePalm="bluePalm"}(s=l.YEAR_AudioId||(l.YEAR_AudioId={})),l.YEAR_AudioCF=((n={})[s.bgm]={path:"bgm",bundle:r.audios},n[s.buff]={path:"buff",bundle:r.audios},n[s.bullet]={path:"bullet",bundle:r.audios},n[s.burn]={path:"burn",bundle:r.audios},n[s.yeargonHit]={path:"dragonHit",bundle:r.audios},n[s.fail]={path:"fail",bundle:r.audios},n[s.godGun]={path:"godGun",bundle:r.audios},n[s.mission]={path:"mission",bundle:r.audios},n[s.palm]={path:"palm",bundle:r.audios},n[s.pinkfire]={path:"pinkfire",bundle:r.audios},n[s.rake]={path:"rake",bundle:r.audios},n[s.typhoon]={path:"typhoon",bundle:r.audios},n[s.goldGod]={path:"goldGod",bundle:r.audios},n[s.classic]={path:"classic",bundle:r.audios},n[s.swordHit]={path:"swordHit",bundle:r.audios},n[s.dragonYearGet]={path:"dragonBallGet",bundle:r.audios},n[s.barrier]={path:"barrier",bundle:r.audios},n[s.dragonYearShow]={path:"dragonBallShow",bundle:r.audios},n[s.electric]={path:"electric",bundle:r.audios},n[s.fireyear]={path:"fireball",bundle:r.audios},n[s.ice]={path:"ice",bundle:r.audios},n[s.icebreak]={path:"icebreak",bundle:r.audios},n[s.lightningBullet]={path:"lightningBullet",bundle:r.audios},n[s.magic]={path:"magic",bundle:r.audios},n[s.wind]={path:"wind",bundle:r.audios},n[s.moon]={path:"moon",bundle:r.audios},n[s.boomerang]={path:"boomerang",bundle:r.audios},n[s.boom]={path:"boom",bundle:r.audios},n[s.moonGod]={path:"moonGod",bundle:r.audios},n[s.doubleSword]={path:"doubleSword",bundle:r.audios},n[s.lotus]={path:"lotus",bundle:r.audios},n[s.summon]={path:"summon",bundle:r.audios},n[s.bluePalm]={path:"bluePalm",bundle:r.audios},n),function(t){t.GAD_Player_Die="year_gad_player_die",t.GAD_Shoot_Bullet="year_gad_shoot_bullet",t.GAD_Show_Hit_Text="year_gad_show_hit_text",t.GAD_Show_Warn="year_gad_show_warn",t.GAD_Bubble_Buf="year_gad_add_bubble_buf",t.GAD_Show_Hit_Effect="year_gad_hit_effect",t.GAD_Show_Buff_Tip="year_gad_show_buff_tip",t.GAD_Setting_Back="year_gad_setting_back",t.pause="year_pause",t.resume="year_resume",t.skillPause="year_skillPause",t.skillResume="year_skillResume",t.buff="year_buff",t.blood="year_blood",t.newTarm="year_newTarm",t.year_loot="year_loot",t.year_tips="year_tips"}(l.emYEAREventName||(l.emYEAREventName={})),function(t){t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t[t.Bullet=3]="Bullet",t[t.Card=4]="Card",t[t.Door=5]="Door",t[t.Prop=6]="Prop",t[t.Boss=7]="Boss"}(l.emYEARRoleType||(l.emYEARRoleType={})),function(t){t[t.None=0]="None",t[t.Idle=1]="Idle",t[t.Move=2]="Move",t[t.Attack=3]="Attack",t[t.Die=4]="Die",t[t.Hited=5]="Hited"}(l.emYEARRoleState||(l.emYEARRoleState={})),function(t){t[t.None=0]="None",t[t.Game=1]="Game",t[t.Pause=2]="Pause",t[t.Over=3]="Over"}(l.emYEARGameState||(l.emYEARGameState={})),function(t){t.speedPlus="speedPlus",t.ATKplus="ATKplus",t.ATKmul="ATKmul",t.bulletPlus="bulletPlus",t.penetratePlus="penetratePlus",t.critPlus="critPlus",t.skillMul="skillMul"}(l.emYEARBuffType||(l.emYEARBuffType={})),function(t){t.blood="year_blood",t.destroy="year_destroy",t.effect="year_effect",t.box="year_box",t.body="year_body",t.year_item="year_item",t.year_bullet="year_bullet",t.newyear_bullet="newyear_bullet",t.YEAR_Bullet_skill="YEAR_Bullet_skill"}(l.poolName||(l.poolName={})),function(t){t[t.None=0]="None",t[t.NoHurt=1]="NoHurt",t[t.HitHurt=2]="HitHurt",t[t.HitDie=3]="HitDie"}(l.emYEARHitState||(l.emYEARHitState={})),function(t){t.None="None",t.up="up",t.down="down",t.left="left",t.right="right"}(l.bulletDir||(l.bulletDir={}));var p=function(){function t(){}return t.heroID=[],t.bulletID=0,t.canAttack=!1,t.isDirect=!1,t.isBug=!1,t}();l.Global=p,cc._RF.pop(),cc._RF.pop()},{}],YEAR_DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"14552njVblN+qXlewEprLHx","YEAR_DataMgr");var i=t,n=e,a=o;cc._RF.push(n,"14552njVblN+qXlewEprLHx","YEAR_DataMgr");var r=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=i("BasePlatform"),c=i("HttpMgr"),l=i("PlatformManager"),p=i("ResourceMgr"),u=i("YEAR_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(){function t(){this._isRemote=!1}var e;return e=t,t.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},t.prototype.getUrlParam=function(t){if(!window||!window.location)return null;var e=window.location.search.replace("?","");if(""===e)return null;for(var o=e.split("&"),i=0;i<o.length;i++){var n=o[i].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}return null},t.prototype.load=function(t,e){var o=this;void 0===e&&(e=!1);var i=this._isRemote;if(l.PlatformManager.currentPlatform==s.Platform.EDITOR){var n=this.getUrlParam("isRemote");n&&"1"==n&&(i=!0)}e?i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_ball/configsB",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emYEARBundles.configsB,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()}):i?c.HttpMgr.getInstance().httpGet("http://192.168.2.250:8989/game/read",{dir:"qiujiayu/dragon_year/configs",fileName:"GameJsonCfg.json"},function(e,i){if(e&&i&&(i.startsWith("{")||i.startsWith("["))){var n=JSON.parse(i);0==n.code?(o.data=JSON.parse(n.data),console.log(o.data),t&&t()):console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01",i)}else console.error("\u8bfb\u53d6\u8fdc\u7a0b\u914d\u7f6e\u5931\u8d25\uff01\uff01\uff01")}):p.ResourceMgr.getInstance().loadRes(u.emYEARBundles.configs,"GameJsonCfg",cc.JsonAsset,function(e){o.data=e.json,e.decRef(),t&&t()})},t.prototype.getParam=function(t,e){return void 0===e&&(e=0),this.data.basicParaCfg[t].para?this.data.basicParaCfg[t].para:e},t.prototype.getBuffByKey=function(t){var e=this.data.buffTypeCfg;for(var o in e)if(e[o].buffType==t)return e[o]},t.prototype.getCharacterByID=function(t){var e=this.data.characterCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getCharacter=function(){return this.data.characterCfg},t.prototype.getLevelCfg=function(){return this.data.levelCfg},t.prototype.getLevelCfgByID=function(t){var e=this.data.levelCfg;for(var o in e)if(e[o].round==t)return e[o]},t.prototype.getMateCfgByID=function(t){var e=this.data.mateCfg;for(var o in e)if(e[o].mateID==t)return e[o]},t.prototype.getMateCfg=function(){return this.data.mateCfg},t.prototype.getDragonBallShowCfg=function(){return this.data.dragonBallShowCfg},t.prototype.getDragonBallCfg=function(){return this.data.dragonBallCfg},t.prototype.getDragonBallCfgBYid=function(t){var e=this.data.dragonBallCfg;for(var o in e)if(e[o].dragonBallID==t)return e[o]},t.prototype.getMateOddsCfgByID=function(t){var e=this.data.mateOddsCfg;for(var o in e)if(e[o].characterID==t)return e[o]},t.prototype.getBuffOddsCfgByAmount=function(t){var e=this.data.buffOddsCfg;for(var o in e)if(e[o].charAmount==t)return e[o]},e=r([h],t)}());a.default=f,cc._RF.pop(),cc._RF.pop()},{}],YEAR_HeroCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"d3a1eNwCCVPqp48MhLoaJLC","YEAR_HeroCtrl");var i=t,n=e,a=o;cc._RF.push(n,"d3a1eNwCCVPqp48MhLoaJLC","YEAR_HeroCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("YEAR_Configs"),d=i("YEAR_DataMgr"),h=i("YEAR_Hero"),f=i("YEAR_SkillCtrl"),m=i("YEAR_TarmCtrl"),g=i("YEAR_ball"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t,e){this.id=t,this.node=e},B=function(t,e){this.cfg=t,this.state=e},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPuase=!1,e.isBallLock=!1,e.ballArr=[],e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this;o.script=this,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.heroRoot.x+=o})},e.prototype.heroMove=function(t){this.heroRoot.x+=t},e.prototype.test=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).addAttackPower(2,5);else if("speed"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).addAttackSpeed(1,4);else if("penerate"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).addAttackPenerate(1,1);else if("fire"==e)for(var o in u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).changeFire()}else this.addHero(Number(e))},e.prototype.doBallSkill=function(t,e){e.dragonBallID==g.ballID.iceBall?this.heroDoSkill(e):e.dragonBallID==g.ballID.thunderBall?(t==g.ballState.dragon&&(this.isBallLock=!0),this.heroDoSkill(e,t)):e.dragonBallID==g.ballID.windBall?this.heroDoSkill(e):e.dragonBallID==g.ballID.vagueBall&&(this.heroDoSkill(e),f.default.script.changeDelayTime(e.playerGetPara1));var o=new B(e,t);this.ballArr.push(o)},e.prototype.heroDoSkill=function(t,e){for(var o in void 0===e&&(e=g.ballState.None),u.Global.heroID)u.Global.heroID[o].node.getComponent(h.default).doBallSkill(t,e)},e.prototype.heroResumeSkill=function(t){t==g.ballID.thunderBall?(this.isBallLock=!1,p.AudioMgr.getInstance().playEffect(u.YEAR_AudioId.electric,"skillBuff")):t==g.ballID.vagueBall&&f.default.script.resumeDelayTime();for(var e=0;e<this.ballArr.length;e++)this.ballArr[e].cfg.dragonBallID==t&&(this.ballArr.splice(e,1),e--);for(var e in u.Global.heroID)u.Global.heroID[e].node.getComponent(h.default).resumeBallSkill(t)},e.prototype.getBallLock=function(){return this.isBallLock},e.prototype.getBallSkill=function(t){for(var e in this.ballArr)t.getComponent(h.default).doBallSkill(this.ballArr[e].cfg,this.ballArr[e].state)},e.prototype.addFirstHero=function(){for(var t=d.default.getInstance().getCharacter(),e=[],o=0;o<t.length;o++)14!=t[o].characterID&&e.push(t[o].characterID);var i=Math.floor(Math.random()*e.length);this.addHero(e[i])},e.prototype.addHero=function(t){var e=this;if(u.Global.heroID.length>=3)console.error("\u4e0d\u5141\u8bb8\u52a0\u5165\u8d85\u8fc7\u4e09\u4e2a\u82f1\u96c4");else{u.Global.heroID||(u.Global.heroID=[]),this.node.getComponent(m.default).pushCard(t);var o=cc.instantiate(this.heorNode);o.active=!0,o.parent=this.node;var i=new b(t,o);u.Global.heroID.push(i),o.getComponent(h.default).initHero(t),this.getBallSkill(o),this.scheduleOnce(function(){e.checkOverSide()},.01)}},e.prototype.addTempHero=function(t,e,o,i,n){var a=cc.instantiate(this.heorNode);a.active=!0;var r=a.getComponent(h.default);a.parent=this.node,r.initHero(t),r.initTempHero(t,e,o,n,i)},e.prototype.clearHero=function(){u.Global.heroID=[]},e.prototype.getMaxDamage=function(t,e){var o=0;for(var i in u.Global.heroID)u.Global.heroID[i].id!=t&&u.Global.heroID[i].id!=e||(o=Math.max(u.Global.heroID[i].node.getComponent(h.default).getAttackPower(),o));return o},e.prototype.checkOverSide=function(){this.heroRoot.x+this.node.width/2>cc.winSize.width/2?this.heroRoot.x=cc.winSize.width/2-this.node.width/2:this.heroRoot.x-this.node.width/2<-cc.winSize.width/2&&(this.heroRoot.x=-cc.winSize.width/2+this.node.width/2)},e.prototype.checkCollider=function(){return this.node.x<0},e.prototype.start=function(){},c([_(cc.Node)],e.prototype,"heroRoot",void 0),c([_(cc.Node)],e.prototype,"heorNode",void 0),o=c([v],e)}(l.default);a.default=I,cc._RF.pop(),cc._RF.pop()},{}],YEAR_Hero:[function(t,e,o){"use strict";cc._RF.push(e,"ff3e8HDn9dO1IryS1A3GWbt","YEAR_Hero");var i=t,n=e,a=o;cc._RF.push(n,"ff3e8HDn9dO1IryS1A3GWbt","YEAR_Hero");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("YEAR_Configs"),h=i("YEARGameEnumData"),f=i("YEAR_DataMgr"),m=i("YEAR_UIGame"),g=i("YEAR_Bullet2"),y=i("YEAR_Bullet3"),v=i("YEAR_BulletEffect"),_=i("YEAR_SkillCtrl"),b=i("YEAR_ball"),B=i("YEAR_Body"),I=cc._decorator,P=I.ccclass,C=I.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletRange=1e3,e.attackSpeed=1,e.attackSpeedMultiplier=1,e.lastAttackTime=0,e.nowAttackTime=0,e.bulletCount=1,e.rawBulletCount=1,e.firing=!1,e.critChance=0,e.critMultiplier=0,e.penetrate=0,e.bullets=[],e.skillTimer=0,e.bulletPrefabSkillName="YEAR_Bullet_skill",e.skillMultiplier=0,e.maxSpeed=12,e.ballSubSpeed=1,e.ballAddSpeed=1,e.ballSubSkillCD=-1,e.thunderLock=!1,e.thunderState=!1,e.noInFactSpeed=5,e.speedInfactTimer=1,e.maxBulletNum=99999,e.rawMaxBulletNum=99999,e.isNewHero=!1,e.isTemp=!1,e.tempTime=0,e.lastFireTime=0,e.fireCooldown=.5,e.audioID=0,e}return s(e,t),e.prototype.initHero=function(t){this.initParm(t),this.initView(t),this.heroIndex=t,this.addEvent(d.emYEAREventName.pause,this.doPause),this.addEvent(d.emYEAREventName.resume,this.doResume)},e.prototype.initParm=function(t){1==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.basicATK):2==d.Global.heroID.length?this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.secondCharATK):3==d.Global.heroID.length&&(this.attackPower=f.default.getInstance().getParam(h.enumBasicParaCfg.thirdCharATK)),3==t?(this.maxBulletNum=f.default.getInstance().getParam(h.enumBasicParaCfg.changeLimit),this.isNewHero=!0):17==t?(this.maxBulletNum=f.default.getInstance().getParam(h.enumBasicParaCfg.sunsxLimit),this.isNewHero=!0):(this.maxBulletNum=99999,this.isNewHero=!1),this.rawMaxBulletNum=this.maxBulletNum,this.attackSpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.basicASPD),this.bulletCount=f.default.getInstance().getParam(h.enumBasicParaCfg.basicBullet),this.penetrate=f.default.getInstance().getParam(h.enumBasicParaCfg.basicPenetrate),this.flySpeed=f.default.getInstance().getParam(h.enumBasicParaCfg.bulletFlySpeed),this.critChance=f.default.getInstance().getParam(h.enumBasicParaCfg.basicCrit),this.critMultiplier=f.default.getInstance().getParam(h.enumBasicParaCfg.critDamage);var e=f.default.getInstance().getCharacterByID(t);this.skillInterval=e.skillCDtime,this.ballSubSkillCD=-1,this.skillMultiplier=e.skillATK,this.skillEffect=e.skillSound,this.speedInfactTimer=e.characterASPD,this.rawBulletCount=this.bulletCount,this.isTemp=!1},e.prototype.initView=function(t){var e=this;this.loadPrefab(d.emYEARBundles.prefabs,"bullets/YEAR_Bullet_"+t,function(o){e.poolName="bullet"+t,u.PoolMgr.getInstance().creatrePool(e.poolName,cc.instantiate(o)),e.bulletPrefab=o,e.startFiring()}),this.bulletNodeSkill=u.PoolMgr.getInstance().getNode(d.poolName.YEAR_Bullet_skill);var o=f.default.getInstance().getCharacterByID(t);this.loadSpriteFrame(d.emYEARBundles.imgs,"backs/"+o.cardColor,function(t){e.itemBg.spriteFrame=t}),this.loadSpriteFrame(d.emYEARBundles.imgs,"js/js_"+t,function(t){e.itemIcon.spriteFrame=t}),this.loadSpriteFrame(d.emYEARBundles.imgs,"skill/"+o.skillIcon,function(t){e.itemSkill.spriteFrame=t}),this.loadPrefab(d.emYEARBundles.prefabs,"skills/"+o.skill,function(o){e.heroSkill=cc.instantiate(o),11==t&&e.loadPrefab(d.emYEARBundles.prefabs,"skills/CardSkill"+t,function(){})}),this.itemName.string=o.characterName},e.prototype.startFiring=function(){this.firing=!0},e.prototype.ballpFiring=function(){this.firing=!1},e.prototype.changeFire=function(){this.firing=!this.firing},e.prototype.initTempHero=function(t,e,o,i,n){this.attackPower=e,this.heroIndex=t,this.attackSpeedMultiplier=o,this.bulletCount=i,this.isTemp=!0,this.tempTime=n},e.prototype.doBallSkill=function(t,e){void 0===e&&(e=b.ballState.None),this.isTemp||(t.dragonBallID!=b.ballID.thunderBall&&this.showBuff(t.dragonBallID),t.dragonBallID==b.ballID.iceBall?this.ballSubSpeed=t.dragonGetPara1:t.dragonBallID==b.ballID.thunderBall?e==b.ballState.dragon?(this.thunderLock=!0,this.showBuff(t.dragonBallID)):e==b.ballState.player&&(this.thunderState=!0):t.dragonBallID==b.ballID.windBall?(this.ballAddSpeed=t.playerGetPara1,this.maxBulletNum=2*this.rawMaxBulletNum):t.dragonBallID==b.ballID.vagueBall&&(this.ballSubSkillCD=t.playerGetPara1,this.isChangeCD()))},e.prototype.resumeBallSkill=function(t){if(!this.isTemp){if(t==b.ballID.iceBall)this.ballSubSpeed=1;else if(t==b.ballID.thunderBall)this.thunderLock=!1,this.thunderState=!1;else if(t==b.ballID.windBall)this.ballAddSpeed=1,this.maxBulletNum=this.rawMaxBulletNum;else if(t==b.ballID.vagueBall){if(-1==this.ballSubSkillCD)return;this.ballSubSkillCD=-1,this.isChangeCD()}this.doResumeBuff(t)}},e.prototype.isChangeCD=function(){var t=this.skillPercent.fillRange;this.skillTimer=this.infactCD*t},e.prototype.getBulletCount=function(){return this.bulletCount},e.prototype.useSkill=function(){var t=m.default.script.getSkillLayer(),e=this.bulletPos.getPosition(),o=this.bulletPos.convertToWorldSpaceAR(e);return e=t.convertToNodeSpaceAR(o),_.default.script.useSkill(this.heroIndex,Math.floor(this.attackPower*this.skillMultiplier),this.heroSkill,e)},e.prototype.addAttackPower=function(t,e){this.addBuffTween(),1==t?this.attackPower+=e:this.attackPower*=e},e.prototype.getAttackPower=function(){return this.attackPower},e.prototype.changeSkillInterval=function(t,e){this.addBuffTween();var o=this.skillInterval*(1-t);(o=Number(o.toFixed(2)))<e&&(o=e),this.skillInterval=o,this.cdTime.getComponent(cc.Label).string=this.skillInterval+""},e.prototype.addAttackSpeed=function(t,e){this.addBuffTween(),this.getAttackSpeedState()||(this.attackSpeedMultiplier+=e/f.default.getInstance().getParam(h.enumBasicParaCfg.speedPlusTimes))},e.prototype.getAttackSpeedState=function(){return this.attackSpeedMultiplier>=this.maxSpeed},e.prototype.addAttackPenerate=function(t,e,o,i){this.addBuffTween(),1==t?this.penetrate+=e:2==t?this.penetrate*=e:3==t&&(this.penetrate+e>o?this.addAttackSpeed(1,i):this.penetrate+=e)},e.prototype.getPenetrate=function(){return this.penetrate},e.prototype.addCritChance=function(t,e){this.addBuffTween(),1==t?this.critChance+=e:2==t?this.critChance*=e:3==t&&(this.critChance>=1?this.addBulletCount(1,1):this.critChance+=e)},e.prototype.showBuff=function(t){var e;t==b.ballID.windBall?e=this.windSp:t==b.ballID.thunderBall?e=this.thunderSp:t==b.ballID.vagueBall?e=this.vagueSp:t==b.ballID.iceBall&&(e=this.iceSp),e&&this.doShowBuff(e)},e.prototype.doShowBuff=function(t){var e=t.getComponent(sp.Skeleton);t.active=!0,e&&e.setAnimation(0,"animation",!0)},e.prototype.doResumeBuff=function(t){var e;t==b.ballID.windBall?e=this.windSp:t==b.ballID.thunderBall?e=this.thunderSp:t==b.ballID.vagueBall?e=this.vagueSp:t==b.ballID.iceBall&&(e=this.iceSp),e&&(e.active=!1)},e.prototype.addSkill=function(t,e){this.addBuffTween(),1==t?this.skillMultiplier+=e:2==t?this.skillMultiplier*=e:3==t&&(this.critChance>=1?this.addBulletCount(1,1):this.critChance+=e)},e.prototype.addBulletCount=function(t,e){this.addBuffTween(),1==t?this.bulletCount+=e:this.bulletCount*=e,this.rawBulletCount=this.bulletCount},e.prototype.addBuffTween=function(){var t=this;this.addBuffSp.opacity=255,this.addBuffSp.getComponent(sp.Skeleton).setAnimation(0,"emission",!1),this.addBuffSp.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.addBuffSp.opacity=0},.1)})},e.prototype.getSpeed=function(){return this.attackSpeedMultiplier},e.prototype.getAttackSpeed=function(){var t=this.attackSpeedMultiplier*this.ballAddSpeed/this.ballSubSpeed;return(t*=this.speedInfactTimer)<this.speedInfactTimer&&(t=this.speedInfactTimer),this.attackSpeed/t},e.prototype.updateSkillView=function(){this.isTemp||(this.skillPercent.fillRange=this.skillTimer/this.infactCD)},Object.defineProperty(e.prototype,"infactCD",{get:function(){return-1==this.ballSubSkillCD?this.skillInterval:this.ballSubSkillCD},enumerable:!1,configurable:!0}),e.prototype.update=function(t){var e=this;if(this.firing&&d.Global.canAttack&&(!this.thunderLock||this.isTemp)){if(this.nowAttackTime+=t,this.skillTimer+=t,this.isTemp&&(this.tempTime-=t,this.tempTime<=0)){var o=m.default.script.getBulletLayer(this.heroIndex).children;for(var i in o)o[i].removeFromParent();this.node.removeFromParent(),this.tempTime=0,this.isTemp=!1}if(this.updateSkillView(),this.skillTimer>=this.infactCD){if(this.isTemp)return;this.useSkill()&&(this.skillSp.opacity=255,p.AudioMgr.getInstance().playEffect(this.skillEffect,this.skillEffect),this.skillSp.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.skillSp.getComponent(sp.Skeleton).setCompleteListener(function(){e.scheduleOnce(function(){e.skillSp.opacity=0},.1)}),this.skillTimer=0)}this.nowAttackTime-this.lastAttackTime>this.getAttackSpeed()&&(this.fireBullets(),this.lastAttackTime=this.nowAttackTime)}},e.prototype.checkIsInfact=function(){return this.attackSpeedMultiplier<this.noInFactSpeed||1==this.bulletCount||3==this.heroIndex||17==this.heroIndex},e.prototype.fireBullets=function(){this.audioID=(this.audioID+1)%5;var t=m.default.script.getBulletLayer(this.heroIndex),e=this.bulletPos.getPosition();if(this.thunderState){var o=u.PoolMgr.getInstance().getNode(this.bulletPrefabSkillName)||cc.instantiate(this.bulletNodeSkill);this.doThunderBullet(o,t,e),p.AudioMgr.getInstance().playEffect(d.YEAR_AudioId.lightningBullet,"bullet"+this.heroIndex+this.audioID)}else{p.AudioMgr.getInstance().playEffect(d.YEAR_AudioId.bullet,"bullet"+this.heroIndex+this.audioID);for(var i=t.children.length+this.bulletCount-this.maxBulletNum,n=0;i>0;)t.children[n++].getComponent(y.default).removeNode(),i--;this.checkIsInfact()?this.creatInfactBullet(t,e):this.creatNoInfactBullet(t,e)}},e.prototype.doThunderBullet=function(t,e,o){var i=this,n=this.bulletPos.convertToWorldSpaceAR(o);t.parent=m.default.script.getBulletSkill(),o=e.convertToNodeSpaceAR(n),t.setPosition(o),t.active=!0,B.default.script.checkSkillCollider(this.getWorldColldierRect(t,0,0),Math.floor(this.attackPower*this.bulletCount)),t.getChildByName("bullet").getComponent(cc.Animation).play(),this.scheduleOnce(function(){t.active=!1,u.PoolMgr.getInstance().freeNode(i.bulletPrefabSkillName,t)},.07)},e.prototype.getWorldColldierRect=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0);var i=t.getAnchorPoint(),n=t.parent.convertToWorldSpaceAR(t.position),a=(t.width+e)*t.scaleX,r=(t.height+o)*t.scaleY;return cc.rect(n.x-i.x*a,n.y-i.y*r,a,r)},e.prototype.creatInfactBullet=function(t,e){this.isNewHero&&1!=this.ballAddSpeed?this.bulletCount=this.bulletCount>3?3:this.bulletCount:this.bulletCount=this.rawBulletCount;for(var o=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,i=0;i<this.bulletCount;i++){var n=new cc.Vec2(e.x-o,e.y);o+=30;var a=this.bulletPos.convertToWorldSpaceAR(n);n=t.convertToNodeSpaceAR(a);var r=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab);(u.PoolMgr.getInstance().getNode(d.poolName.newyear_bullet)||cc.instantiate(this.bullet)).getComponent(y.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,n,r,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier)}},e.prototype.creatNoInfactBullet=function(t,e){for(var o=[],i=this.bulletCount%2?30*-Math.floor(this.bulletCount/2):30*-Math.floor(this.bulletCount/2)+20,n=0;n<this.bulletCount;n++){var a=new cc.Vec2(0-i,0);i+=30,o.push(a)}var r=u.PoolMgr.getInstance().getNode(d.poolName.newyear_bullet)||cc.instantiate(this.bullet),s=u.PoolMgr.getInstance().getNode(this.poolName)||cc.instantiate(this.bulletPrefab),c=this.bulletPos.convertToWorldSpaceAR(e),l=t.convertToNodeSpaceAR(c);r.getComponent(y.default).initNode(this.attackPower,this.flySpeed,this.penetrate,this.critChance,this.critMultiplier,l,s,t,this.node,d.Global.bulletID++,this.poolName,this.attackSpeedMultiplier,this.bulletCount,o)},e.prototype.pushBullet=function(t){t.getComponent(v.default).hide(),this.bullets.push(t)},e.prototype.doPause=function(){this.ballpFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).yearp()},e.prototype.doResume=function(){this.startFiring();var t=m.default.script.getBulletLayer(this.heroIndex).children;for(var e in t)t[e].getComponent(g.default).resume()},c([C(cc.Prefab)],e.prototype,"bullet",void 0),c([C(cc.Node)],e.prototype,"bulletPos",void 0),c([C(cc.Node)],e.prototype,"skillSp",void 0),c([C(cc.Node)],e.prototype,"addBuffSp",void 0),c([C(cc.Label)],e.prototype,"itemName",void 0),c([C(cc.Sprite)],e.prototype,"itemBg",void 0),c([C(cc.Sprite)],e.prototype,"itemIcon",void 0),c([C(cc.Sprite)],e.prototype,"itemSkill",void 0),c([C(cc.Sprite)],e.prototype,"skillPercent",void 0),c([C(cc.Node)],e.prototype,"windSp",void 0),c([C(cc.Node)],e.prototype,"thunderSp",void 0),c([C(cc.Node)],e.prototype,"vagueSp",void 0),c([C(cc.Node)],e.prototype,"iceSp",void 0),c([C(cc.Node)],e.prototype,"cdTime",void 0),c([P],e)}(l.default);a.default=D,cc._RF.pop(),cc._RF.pop()},{}],YEAR_PlayerMgr:[function(t,e,o){"use strict";cc._RF.push(e,"d256bLJ/KpIqa7quLUMcW37","YEAR_PlayerMgr");var i=t,n=e,a=o;cc._RF.push(n,"d256bLJ/KpIqa7quLUMcW37","YEAR_PlayerMgr"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("YEAR_UserData"),s=function(){function t(){this._groupID=0,this._tagID=0,this._state=0,this._cards=[]}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.reset=function(){this._state=0,this._cards=[]},t.prototype.addCard=function(t){this._cards.push(t)},t.prototype.getCardByRandom=function(){return this._cards[Math.floor(Math.random()*this._cards.length)]},t.prototype.removeCard=function(t){var e=this._cards.indexOf(t);-1!=e&&this._cards.splice(e,1)},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getTagID=function(){return++this._tagID},t.prototype.getGroupID=function(){return++this._groupID},t.prototype.preload=function(t){this._userData=new r.default,this._userData.getData(),t&&t()},t}();a.default=s,cc._RF.pop(),cc._RF.pop()},{}],YEAR_SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"b26b9nNVOJDGbv0PU7JIoyP","YEAR_SkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"b26b9nNVOJDGbv0PU7JIoyP","YEAR_SkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("YEAR_Configs"),u=i("YEAR_Skill"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e.rawDelayTime=1.5,e.delayTime=1.5,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){return!this.isSkill&&(this.isSkill=!0,this.showBanner(t),o.parent=this.node,o.getComponent(u.default).useSkill(i,e,t),!0)},e.prototype.changeDelayTime=function(t){t/2<this.delayTime&&(this.delayTime=t/2-.15)},e.prototype.resumeDelayTime=function(){this.delayTime=this.rawDelayTime},e.prototype.showBanner=function(t){var e=this;this.loadSpriteFrame(p.emYEARBundles.imgs,"banner/banner"+t,function(t){e.banner.getComponent(cc.Sprite).spriteFrame=t,e.banner.active=!0});var o=Number((this.delayTime/3).toFixed(1));cc.tween(this.banner).by(o,{x:this.banner.width}).delay(o).by(o,{x:-this.banner.width}).call(function(){e.isSkill=!1,e.banner.active=!1}).start()},e.prototype.onLoad=function(){o.script=this,this.banner.x=-cc.winSize.width/2-this.banner.width/2},e.prototype.start=function(){},e.prototype.update=function(){},c([f(cc.Label)],e.prototype,"label",void 0),c([f(cc.Node)],e.prototype,"banner",void 0),c([f],e.prototype,"text",void 0),o=c([h],e)}(l.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],YEAR_Skill:[function(t,e,o){"use strict";cc._RF.push(e,"8f134p9crVGfLZ2kyjzfiuY","YEAR_Skill");var i=t,n=e,a=o;cc._RF.push(n,"8f134p9crVGfLZ2kyjzfiuY","YEAR_Skill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("YEAR_Body"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e.speed=25,e.skillSpeed=25,e.isDown=!1,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){"attack"==o.data.name&&(t.animationDuration=e.animation.duration)})},e.prototype.useSkill=function(t,e,o){this.index=o,this.skillSpeed=this.speed,this.damage=e,this["useSkill"+o](t),this.flyDis=l.default.script.getHeadY()-this.node.y},e.prototype.useSkill1=function(){var t=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-300),this.spAni.setAnimation(0,"hit",!1);var e=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65),this.offHeight=300},e.prototype.useSkill3=function(){var t=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-100),this.spAni.setAnimation(0,"cedz",!1);var e=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){t.doAttack()},e-.65)},e.prototype.useSkill4=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill6=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,l.default.script.getHeadY()),this.spAni.setAnimation(0,"hit",!1);var o=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill7=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill8=function(t){this.canMove=!0,this.isDown=!1,this.skillSpeed=.85*this.speed,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!0)},e.prototype.useSkill10=function(t){var e=this;this.canMove=!1,this.node.setPosition(t.x,l.default.script.getHeadY()),this.spAni.setAnimation(0,"animation",!1);var o=this.spAni.getCurrent(0).animation.duration;this.scheduleOnce(function(){e.doAttack()},o-.6)},e.prototype.useSkill11=function(t){this.canMove=!0,this.isDown=!1,this.node.setPosition(t),this.spAni.setAnimation(0,"bullet",!1),this.sub1.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.sub2.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)},e.prototype.useSkill17=function(){var t=this;this.canMove=!1,this.node.setPosition(0,l.default.script.getHeadY()-100),this.spAni.setAnimation(0,"ssxdz",!1);var e=this.spAni.getCurrent(0).animation.duration;this.offHeight=100,this.scheduleOnce(function(){t.doAttack()},e-2)},e.prototype.update=function(){var t=this;this.isDown||this.canMove&&(this.node.y+=this.skillSpeed,this.flyDis-=this.skillSpeed,this.flyDis<0&&(11==this.index&&this.scheduleOnce(function(){t.sub1.getComponent(sp.Skeleton).setAnimation(0,"hit",!1),t.sub2.getComponent(sp.Skeleton).setAnimation(0,"hit",!1)},.05),this.isDown=!0,this.spAni.setAnimation(0,"hit",!1),this.doAttack()))},e.prototype.doAttack=function(){l.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([d({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([d({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([d({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([d({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([u],e)}(cc.Component);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],YEAR_Target:[function(t,e,o){"use strict";cc._RF.push(e,"89682bupeJHCo9Ydl0poYjq","YEAR_Target");var i=e,n=o;cc._RF.push(i,"89682bupeJHCo9Ydl0poYjq","YEAR_Target"),Object.defineProperty(n,"__esModule",{value:!0}),n.Target=void 0;var a=function(){function t(t){this.health=t}return t.prototype.takeDamage=function(t){this.health-=t,console.log("Target takes "+t+" damage! Remaining health: "+this.health),this.health<=0&&this.destroy()},t.prototype.destroy=function(){console.log("Target destroyed!")},t}();n.Target=a,cc._RF.pop(),cc._RF.pop()},{}],YEAR_TarmCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"beddbg3MqdNG4yzpdWon4Br","YEAR_TarmCtrl");var i=t,n=e,a=o;cc._RF.push(n,"beddbg3MqdNG4yzpdWon4Br","YEAR_TarmCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("YEAR_Configs"),u=i("YEAR_DataMgr"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tarmMap=new Map,e.isTureTarmMap=new Map,e.isInit=!1,e.delayTime=1,e.arr=[],e.isBanner=!1,e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.initMap=function(){this.isInit=!0;var t=u.default.getInstance().getMateCfg();for(var e in t){var o=t[e].mateID;this.tarmMap[o]=[],this.isTureTarmMap[o]=!1;var i=t[e].mateRole.split(",");for(var n in i)this.tarmMap[o].push(Number(i[n]))}},e.prototype.pushCard=function(t){for(var e in this.isInit||this.initMap(),this.isTureTarmMap)if(!this.isTureTarmMap[e]){for(var o=this.tarmMap[e],i=0;i<o.length;i++)o[i]==t&&(o.splice(i,1),i--);0==o.length&&(this.isTureTarmMap[e]=!0,this.arr.push(Number(e)),this.isBanner||(this.isBanner=!0,this.doArr()))}},e.prototype.doArr=function(){var t=this;if(this.isBanner){var e=this.arr.splice(0,1);0!=e.length?(this.sendEvent(p.emYEAREventName.newTarm,e[0],this.delayTime),this.scheduleOnce(function(){t.doArr()},this.delayTime)):this.isBanner=!1}},c([h],e)}(l.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],YEAR_UIGameView:[function(t,e,o){"use strict";cc._RF.push(e,"15731nLwF9DNbYLqRZSgTYZ","YEAR_UIGameView");var i=t,n=e,a=o;cc._RF.push(n,"15731nLwF9DNbYLqRZSgTYZ","YEAR_UIGameView");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Config"),h=i("YEAR_Configs"),f=i("YEAR_BloodCtrl"),m=i("YEAR_BuffCtrl"),g=i("YEAR_mateCtrl"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndTipRoot=null,e.ndWarn=null,e.btnPause=null,e.hitEffect=null,e.ndBuffImg=null,e.doorHitEffctRoot=null,e.spBack=null,e.buffLayer=null,e.bloodLayer=null,e.hitLayer=null,e.blood=null,e.pauseLayer=null,e.closeNode=null,e.skillLayer=null,e.banner=null,e.bannerSp=[],e.isPause=!1,e.maxLength=50,e.hpIndex=0,e.hpArr=[],e.tipPools=[],e.gaptime=.5,e.nowTime=0,e.buffIndex=[],e.buffState=!1,e.maxShowCount=50,e.lastShowTime=0,e.throttleTime=.2,e}return s(e,t),e.prototype.onLoad=function(){p.PoolMgr.getInstance().creatrePool(h.poolName.effect,this.hitEffect,5),p.PoolMgr.getInstance().creatrePool("pbt_buff_img",this.ndBuffImg,2),this.createHpArr(this.maxLength),this.initSystemListen()},e.prototype.createHpArr=function(t){for(;t--;){var e=p.PoolMgr.getInstance().getNode(h.poolName.blood)||cc.instantiate(this.blood);this.hpArr.push(e)}},e.prototype.initSystemListen=function(){var t=this;h.Global.isDirect||cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){t.pauseLayer&&e.keyCode==cc.macro.KEY.space&&(t.pauseLayer.active?(t.pauseLayer.active=!1,t.sendEvent(h.emYEAREventName.resume),t.isPause=!1):(t.pauseLayer.active=!0,t.sendEvent(h.emYEAREventName.pause),t.isPause=!0))})},e.prototype.start=function(){var t=this;this.addEvent(h.emYEAREventName.GAD_Show_Hit_Text,this.onShowHitText),this.addEvent(h.emYEAREventName.GAD_Show_Warn,this.playWarn),this.addEvent(h.emYEAREventName.GAD_Show_Hit_Effect,this.showHitEffect),this.addEvent(h.emYEAREventName.buff,this.showBuff),this.addEvent(h.emYEAREventName.blood,this.showLoseLabel),this.addEvent(h.emYEAREventName.newTarm,this.showNewTarm),this.ndWarn.scale=Math.max(cc.winSize.width/this.ndWarn.width,cc.winSize.height/this.ndWarn.height),this.btnPause.on(cc.Node.EventType.TOUCH_END,function(){t.sendEvent(h.emYEAREventName.pause),t.isPause=!0,h.Global.isDirect?u.UIMgr.getInstance().openUI(h.YEAR_UIID.UISetting,d.UIID.UINONE,function(e){e&&t.sendEvent(h.emYEAREventName.resume)}):t.pauseLayer.active=!0}),this.pauseLayer.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active&&(t.sendEvent(h.emYEAREventName.resume),t.isPause=!1,t.pauseLayer.active=!1)}),this.closeNode.on(cc.Node.EventType.TOUCH_END,function(){t.pauseLayer.active=!1,u.UIMgr.getInstance().openUI(h.YEAR_UIID.UISetting,d.UIID.UINONE,function(e){e&&(t.sendEvent(h.emYEAREventName.resume),t.isPause=!1)})})},e.prototype.onShowHitText=function(){},e.prototype.playWarn=function(){var t=this;cc.Tween.stopAllByTarget(this.ndWarn),this.ndWarn.active=!0,cc.tween(this.ndWarn).to(.3,{opacity:0}).to(.3,{opacity:255}).union().repeatForever().start(),cc.tween(this.ndWarn).delay(2).call(function(){cc.Tween.stopAllByTarget(t.ndWarn),t.ndWarn.active=!1}).start()},e.prototype.showHitEffect=function(t){var e=this.node.convertToNodeSpaceAR(t),o=p.PoolMgr.getInstance().getNode(h.poolName.effect)||cc.instantiate(this.hitEffect);o.parent=this.hitLayer,o.setPosition(e),o.active=!0,o.opacity=255,this.scheduleOnce(function(){o.active=!1,p.PoolMgr.getInstance().freeNode("pbt_hit_effect",o)},.1)},e.prototype.update=function(t){var e,o=this;this.buffState&&!this.isPause&&(this.nowTime+=t,this.nowTime>this.gaptime&&(this.nowTime=0,this.buffIndex.length?e=this.buffIndex.shift():this.buffState=!1,this.buffState=0!=this.buffIndex.length,e&&this.loadPrefab(h.emYEARBundles.prefabs,"item/buff",function(t){var i=cc.instantiate(t);i.parent=o.buffLayer,i.getComponent(m.default).initNode(e)})))},e.prototype.showBuff=function(t){this.buffIndex.push(t),this.buffState=!0},e.prototype.showLoseLabel=function(t,e,o,i){if(void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),!(this.bloodLayer.children.length>=this.maxShowCount)||i){var n=cc.director.getTotalTime();if(!(n-this.lastShowTime<this.throttleTime)||i){this.lastShowTime=n;var a=p.PoolMgr.getInstance().getNode(h.poolName.blood);a.parent||(a.parent=this.bloodLayer);var r=a.getComponent(f.default);r.resumeNode(),a.setPosition(e.x,e.y+40),r.isCirt(o,t)}}},e.prototype.showNewTarm=function(t,e){var o=this;this.loadPrefab(h.emYEARBundles.prefabs,"item/mateIcon",function(e){var i=cc.instantiate(e);i.parent=o.skillLayer,i.getComponent(g.default).initNode(t)}),this.showBanner(t,e)},e.prototype.showBanner=function(t,e){var o=this;this.banner.getComponent(cc.Sprite).spriteFrame=this.bannerSp[t],cc.tween(this.banner).by(e/2,{x:this.banner.width}).delay(e/2).call(function(){o.banner.x=-cc.winSize.width/2-o.banner.width/2}).start()},c([_(cc.Node)],e.prototype,"ndTipRoot",void 0),c([_(cc.Node)],e.prototype,"ndWarn",void 0),c([_(cc.Node)],e.prototype,"btnPause",void 0),c([_(cc.Node)],e.prototype,"hitEffect",void 0),c([_(cc.Node)],e.prototype,"ndBuffImg",void 0),c([_(cc.Node)],e.prototype,"doorHitEffctRoot",void 0),c([_(cc.Sprite)],e.prototype,"spBack",void 0),c([_(cc.Node)],e.prototype,"buffLayer",void 0),c([_(cc.Node)],e.prototype,"bloodLayer",void 0),c([_(cc.Node)],e.prototype,"hitLayer",void 0),c([_(cc.Node)],e.prototype,"blood",void 0),c([_(cc.Node)],e.prototype,"pauseLayer",void 0),c([_(cc.Node)],e.prototype,"closeNode",void 0),c([_(cc.Node)],e.prototype,"skillLayer",void 0),c([_(cc.Node)],e.prototype,"banner",void 0),c([_(cc.SpriteFrame)],e.prototype,"bannerSp",void 0),c([v],e)}(l.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],YEAR_UIGame:[function(t,e,o){"use strict";cc._RF.push(e,"17852o/2MNDBagCCnpii84j","YEAR_UIGame");var i=t,n=e,a=o;cc._RF.push(n,"17852o/2MNDBagCCnpii84j","YEAR_UIGame");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.boundary=void 0;var l=i("BaseUI"),p=i("YEAR_Configs"),u=i("YEAR_DataMgr"),d=i("YEAR_HeroCtrl"),h=i("PoolMgr"),f=i("AudioMgr"),m=i("YEARGameEnumData"),g=i("SdkMgr"),y=i("PlatformSetting"),v=i("BasePlatform"),_=function(){};a.boundary=_;var b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ndCardGroup=null,e.sprBgSup=null,e.prefabDoor=null,e.prefabEnemy=null,e.prefabBullet=null,e.ndBulletRoot=null,e.heroRoot=null,e.ndFence=null,e.content=null,e.item=null,e.bulletLayer=null,e.rewardLayer=null,e.bloodLayer=null,e.destroyLayer=null,e.startNode=null,e.skillLayer=null,e.dieLayer=null,e.bulletSkill=null,e.gmNode=null,e}var o;return s(e,t),o=e,e.prototype.onLoad=function(){var t=this.ndCardGroup.getComponent(d.default);t.clearHero(),p.Global.canAttack=!1,p.Global.bulletID=0,t.addFirstHero(),o.script=this,this.createNodePool(),this.doStart(),this.initBulletBoundary()},e.prototype.initBulletBoundary=function(){this.bulletBoundary=new _;var t=cc.winSize;this.bulletBoundary.upBoundary=t.height/2,this.bulletBoundary.leftBoundary=-t.width/2,this.bulletBoundary.rightBoundary=t.width/2,this.bulletBoundary.downBoundary=this.getWallPosY()+50},e.prototype.getBulletBoundary=function(){return this.bulletBoundary},e.prototype.setGmNode=function(){(g.SdkMgr.getInstance().getCheckVersion(y.SwitchID.ShenHe_ABD)||y.PlatformSetting.currentPlatform==v.Platform.EDITOR||y.PlatformSetting.currentPlatform==v.Platform.WEB_LINK)&&(this.gmNode.active=!0)},e.prototype.doStart=function(){var t=this;f.AudioMgr.getInstance().playEffectFree(p.YEAR_AudioId.mission),this.startNode.active=!0,this.startNode.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.startNode.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){t.startNode.active=!1},.1)})},e.prototype.getNewRole=function(t){void 0===t&&(t=1);var e=u.default.getInstance().getCharacter(),o=[];for(var i in e)(!p.Global.isDirect||17!=e[i].characterID&&3!=e[i].characterID)&&o.push(e[i].characterID);return o[Math.floor(Math.random()*o.length)]},e.prototype.getWallPosY=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.y},e.prototype.getBulletSkill=function(){return this.bulletSkill},e.prototype.getWallPos=function(){return this.dieLayer.getComponent(cc.Widget).updateAlignment(),this.dieLayer.getPosition()},e.prototype.start=function(){this.initEvents()},e.prototype.createNodePool=function(){this.loadPrefab(p.emYEARBundles.prefabs,"item/blood",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.blood,e)}),this.loadPrefab(p.emYEARBundles.prefabs,"item/destroy",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.destroy,e)}),this.loadPrefab(p.emYEARBundles.prefabs,"item/box",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.box,e)}),this.loadPrefab(p.emYEARBundles.prefabs,"item/body",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.body,e)}),this.loadPrefab(p.emYEARBundles.prefabs,"item/year_item",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.year_item,e)}),this.loadPrefab(p.emYEARBundles.prefabs,"item/year_bullet",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.year_bullet,e)}),this.loadPrefab(p.emYEARBundles.prefabs,"item/year_bullet2",function(t){var e=cc.instantiate(t);h.PoolMgr.getInstance().creatrePool(p.poolName.newyear_bullet,e)}),this.loadPrefab(p.emYEARBundles.prefabs,"bullets/"+p.poolName.YEAR_Bullet_skill,function(t){h.PoolMgr.getInstance().creatrePool(p.poolName.YEAR_Bullet_skill,cc.instantiate(t))})},e.prototype.initEvents=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var o=e.getDeltaX();t.ndCardGroup.getComponent(d.default).heroMove(o)})},e.prototype.getBulletLayer=function(t){var e="layer"+t;return this.bulletLayer.getChildByName(e)},e.prototype.getAllBullet=function(){var t=[];for(var e in this.bulletLayer.children)for(var o in this.bulletLayer.children[e].children)t.push(this.bulletLayer.children[e].children[o])},e.prototype.getDestroyLayer=function(){return this.destroyLayer},e.prototype.getSkillLayer=function(){return this.skillLayer},e.prototype.checkReWardLayer=function(t){return this.rewardLayer.y>t},e.prototype.addHero=function(){},e.prototype.update=function(){},e.prototype.onScreenShake=function(){cc.Tween.stopAllByTarget(this.sprBgSup);var t=u.default.getInstance().getParam(m.enumBasicParaCfg.quake);cc.tween(this.sprBgSup).set({position:cc.v3(0,0)}).by(.05,{position:cc.v3(-1*t,-1*t)}).by(.05,{position:cc.v3(2*t,1*t)}).by(.05,{position:cc.v3(-2*t,0*t)}).by(.05,{position:cc.v3(2*t,-1*t)}).by(.05,{position:cc.v3(-1*t,1*t)}).set({position:cc.v3(0,0)}).start()},c([I(cc.Node)],e.prototype,"ndCardGroup",void 0),c([I(cc.Node)],e.prototype,"sprBgSup",void 0),c([I(cc.Prefab)],e.prototype,"prefabDoor",void 0),c([I(cc.Prefab)],e.prototype,"prefabEnemy",void 0),c([I(cc.Prefab)],e.prototype,"prefabBullet",void 0),c([I(cc.Node)],e.prototype,"ndBulletRoot",void 0),c([I(cc.Node)],e.prototype,"heroRoot",void 0),c([I(cc.Node)],e.prototype,"ndFence",void 0),c([I(cc.Node)],e.prototype,"content",void 0),c([I(cc.Node)],e.prototype,"item",void 0),c([I(cc.Node)],e.prototype,"bulletLayer",void 0),c([I(cc.Node)],e.prototype,"rewardLayer",void 0),c([I(cc.Node)],e.prototype,"bloodLayer",void 0),c([I(cc.Node)],e.prototype,"destroyLayer",void 0),c([I(cc.Node)],e.prototype,"startNode",void 0),c([I(cc.Node)],e.prototype,"skillLayer",void 0),c([I(cc.Node)],e.prototype,"dieLayer",void 0),c([I(cc.Node)],e.prototype,"bulletSkill",void 0),c([I(cc.Node)],e.prototype,"gmNode",void 0),o=c([B],e)}(l.default);a.default=P,cc._RF.pop(),cc._RF.pop()},{}],YEAR_UIResult:[function(t,e,o){"use strict";cc._RF.push(e,"85138V9DwtAn5+xaLzQX0Mk","YEAR_UIResult");var i=t,n=e,a=o;cc._RF.push(n,"85138V9DwtAn5+xaLzQX0Mk","YEAR_UIResult");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("YEAR_Configs"),p=i("YEAR_App"),u=i("BaseUI"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lblBar=null,e.spBar=null,e.ndWin=null,e.ndFail=null,e.ndTop=null,e.ndBar=null,e.btn=null,e.btnPlay=null,e.lblRwd=null,e.isDirect=null,e.unDirect=null,e.isWin=!1,e}return s(e,t),e.prototype.init=function(t){this.isWin=t,this.isDirect.active=l.Global.isDirect,this.unDirect.active=!l.Global.isDirect},e.prototype.start=function(){this.initView(),this.btn.on(cc.Node.EventType.TOUCH_END,function(){p.default.instance.exit_App(0)})},e.prototype.initView=function(){this.ndFail.active=!this.isWin,this.ndWin.active=this.isWin},c([f(cc.Label)],e.prototype,"lblBar",void 0),c([f(cc.Sprite)],e.prototype,"spBar",void 0),c([f(cc.Node)],e.prototype,"ndWin",void 0),c([f(cc.Node)],e.prototype,"ndFail",void 0),c([f(cc.Node)],e.prototype,"ndTop",void 0),c([f(cc.Node)],e.prototype,"ndBar",void 0),c([f(cc.Node)],e.prototype,"btn",void 0),c([f(cc.Node)],e.prototype,"btnPlay",void 0),c([f(cc.Label)],e.prototype,"lblRwd",void 0),c([f(cc.Node)],e.prototype,"isDirect",void 0),c([f(cc.Node)],e.prototype,"unDirect",void 0),c([h],e)}(u.default);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],YEAR_UISetting:[function(t,e,o){"use strict";cc._RF.push(e,"1f9e9adKv5EWb+7PxuTTKf5","YEAR_UISetting");var i=t,n=e,a=o;cc._RF.push(n,"1f9e9adKv5EWb+7PxuTTKf5","YEAR_UISetting");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BasePlatform"),p=i("BaseUI"),u=i("PlatformSetting"),d=i("AudioMgr"),h=i("SdkMgr"),f=i("YEAR_Configs"),m=i("YEAR_App"),g=i("YEAR_UIGame"),y=cc._decorator,v=y.ccclass,_=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.musicSlider=null,e.effectSlider=null,e.btnClose=null,e.btnBackHome=null,e.isDirect=null,e.unDirect=null,e.btnPlay=null,e.gmNode=null,e._musicBg2=null,e._effectBg2=null,e._callFunc=null,e}return s(e,t),e.prototype.init=function(t){this._callFunc=t,this.isDirect.active=f.Global.isDirect,this.unDirect.active=!f.Global.isDirect},e.prototype.onEnable=function(){this.musicSlider.progress=d.AudioMgr.getInstance().getMusicVolume(),this.effectSlider.progress=d.AudioMgr.getInstance().getEffectVolume()},e.prototype.start=function(){var t,e;this._musicBg2=null===(t=this.musicSlider.node.getChildByName("Background2"))||void 0===t?void 0:t.getComponent(cc.Sprite),this._effectBg2=null===(e=this.effectSlider.node.getChildByName("Background2"))||void 0===e?void 0:e.getComponent(cc.Sprite),this._musicBg2&&(this._musicBg2.fillRange=this.musicSlider.progress),this._effectBg2&&(this._effectBg2.fillRange=this.effectSlider.progress),this.bindEvent()},e.prototype.bindEvent=function(){var t=this;this.musicSlider.node.on("slide",function(e){t._musicBg2&&(t._musicBg2.fillRange=e.progress),d.AudioMgr.getInstance().setMusicVolume(e.progress)},this),this.gmNode.on(cc.Node.EventType.TOUCH_END,function(){(h.SdkMgr.getInstance().getCheckVersion(u.SwitchID.ShenHe_ABD)||u.PlatformSetting.currentPlatform==l.Platform.EDITOR||u.PlatformSetting.currentPlatform==l.Platform.WEB_LINK)&&g.default.script.setGmNode()}),this.effectSlider.node.on("slide",function(e){t._effectBg2&&(t._effectBg2.fillRange=e.progress),d.AudioMgr.getInstance().setEffectVolume(e.progress)},this),this.btnClose.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()},this),this.btnBackHome.on(cc.Node.EventType.TOUCH_END,function(){m.default.instance.exit_App(0)}),this.btnPlay.on(cc.Node.EventType.TOUCH_END,function(){t._callFunc&&t._callFunc(!0),t.closeUI()})},c([_(cc.Slider)],e.prototype,"musicSlider",void 0),c([_(cc.Slider)],e.prototype,"effectSlider",void 0),c([_(cc.Node)],e.prototype,"btnClose",void 0),c([_(cc.Node)],e.prototype,"btnBackHome",void 0),c([_(cc.Node)],e.prototype,"isDirect",void 0),c([_(cc.Node)],e.prototype,"unDirect",void 0),c([_(cc.Node)],e.prototype,"btnPlay",void 0),c([_(cc.Node)],e.prototype,"gmNode",void 0),c([v],e)}(p.default);a.default=b,cc._RF.pop(),cc._RF.pop()},{}],YEAR_UserData:[function(t,e,o){"use strict";cc._RF.push(e,"72155E5nTZPjoNjPTrZgUt/","YEAR_UserData");var i=t,n=e,a=o;cc._RF.push(n,"72155E5nTZPjoNjPTrZgUt/","YEAR_UserData");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(a,"__esModule",{value:!0});var c=i("BaseData"),l=i("Config"),p=function(){this.level=1},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.protoId=1,e.ecrypt=!1,e.aliseMap={level:"1"},e.gameKey=l.GameConfig.AppCacheName+"gad_udata",e.isNewUser=!1,e}return s(e,t),e.prototype.createData=function(){return this.data=new p,this.data},e.prototype.initData=function(t){t&&(this.isNewUser=!0),this.saveData()},e.prototype.getLevel=function(){return this.data.level||1},e.prototype.addLevel=function(){this.data.level=this.data.level||1,this.data.level++,this.saveData()},e}(c.BaseData);a.default=u,cc._RF.pop(),cc._RF.pop()},{}],YEAR_ballCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e556f2URu9C4J64l1O/4KhX","YEAR_ballCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e556f2URu9C4J64l1O/4KhX","YEAR_ballCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("YEAR_Configs"),c=i("YEAR_DataMgr"),l=i("YEAR_ball"),p=i("YEAR_bodyCtrl"),u=function(){function t(t,e){this.gameCtrl=null,this.pathIndex=new Map,this.path=[],this.nowTime=0,this.showIndex=0,this.cfgArr=[],this.nowCfg=null,this.ballLottery=[],this.gameCtrl=t,this.path=e,this.initParam()}return t.prototype.initParam=function(){this.cfgArr=c.default.getInstance().getDragonBallShowCfg(),this.initBallLottery(),this.refreshCfg(),this.createPath()},t.prototype.initBallLottery=function(){var t=c.default.getInstance().getDragonBallCfg();for(var e in this.ballLottery=[],t)this.ballLottery.push(t[e])},t.prototype.refreshCfg=function(){this.nowCfg=this.cfgArr[this.showIndex],this.showIndex++},t.prototype.createBall=function(t){r.AudioMgr.getInstance().playEffect(s.YEAR_AudioId.dragonYearShow,"dragonBallShow");var e=this.gameCtrl.head.getComponent(p.default).getIndex();if((e=this.pathIndex[e]+t.distance)!=this.path.length-1){var o=!0;for(this.pathIndex.has(e);o;)for(var i in o=!1,this.pathIndex)if(this.pathIndex[i]==e){o=!0,e++;break}}e>=this.path.length&&(e=this.path.length-1);var n=this.path[e],a=Math.floor(Math.random()*this.ballLottery.length),c=this.ballLottery[a];this.ballLottery.splice(a,1),0==this.ballLottery.length&&this.initBallLottery(),this.gameCtrl.initBanner(c.dragonBallName),this.gameCtrl.ballNode.getComponent(l.default).initParam(t.dragonBallHp,c,n,this)},t.prototype.createPath=function(){for(var t=(this.path[1].x-this.path[0].x)/4,e=[],o=0;o<this.path.length-1;){var i=this.path[o].x,n=-i/Math.abs(i),a=this.path[o].y;if(Math.abs(this.path[o+1].y-this.path[o].y)<1e-6){this.pathIndex[o]=e.length;for(var r=5;r--;){var s=new cc.Vec2(i,a);e.push(s),i+=t*n}this.pathIndex[o+1]=e.length-1,o+=2}else s=new cc.Vec2(i,a),e.push(s),this.pathIndex[o]=e.length-1,o+=1}e.push(this.path[this.path.length-1]),this.pathIndex[o]=e.length-1,this.path=e},t.prototype.getCommonElements=function(t,e){var o=this;return t.filter(function(t){return e.some(function(e){return o.areVec2Equal(t,e)})})},t.prototype.getUniqueElements=function(t,e){var o=this;return t.filter(function(t){return!e.some(function(e){return o.areVec2Equal(t,e)})})},t.prototype.areVec2Equal=function(t,e){return Math.abs(t.x-e.x)<=2&&Math.abs(t.y-e.y)<=2},t.prototype.test=function(){this.nowTime=this.nowCfg.showTime-1},t.prototype.reduceTime=function(t){this.nowCfg&&this.nowTime+t>this.nowCfg.showTime&&(this.nowTime-=t)},t.prototype.onUpdate=function(t){if(this.nowCfg&&(this.nowTime+=t,this.nowTime>=this.nowCfg.showTime)){var e=this.nowCfg;this.refreshCfg(),this.createBall(e)}},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],YEAR_ball:[function(t,e,o){"use strict";cc._RF.push(e,"629a7U+I9hLFLG/MunHiL8W","YEAR_ball");var i=t,n=e,a=o;cc._RF.push(n,"629a7U+I9hLFLG/MunHiL8W","YEAR_ball");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.ballID=a.ballState=void 0;var l,p,u=i("BaseCtrl"),d=i("AudioMgr"),h=i("Utils"),f=i("YEAR_Configs"),m=i("YEARGameEnumData"),g=i("YEAR_DataMgr"),y=i("YEAR_HeroCtrl"),v=i("YEAR_Body"),_=function(t,e,o){this.time=t,this.state=e,this.cfg=o},b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpLabel=null,e.ballSprite=null,e.montionStreak=null,e.ballNode=null,e.dragonBallLabel=null,e.playerBallLabel=null,e.state=l.None,e.ballTimeArr=[],e.isPause=!1,e.dragonLimitY=700,e.playerLimitY=-300,e.step=0,e}return s(e,t),e.prototype.initParam=function(t,e,o,i){this.ballCtrlScript||(this.ballCtrlScript=i),this.ballSpeed||(this.ballSpeed=g.default.getInstance().getParam(m.enumBasicParaCfg.ballFlySpeed)),this.ballNode.y=0,this.ballNode.x=0,this.stopFloatEffect(),this.state=l.None,this.hpNum=Math.floor(t),this.cfg=e,this.montionStreak.node.active=!1,this.montionStreak.node.angle=0,this.initView(o)},e.prototype.initView=function(t){this.hpLabel.string=this.hpNum.toString(),this.hpLabel.node.active=!0,this.ballSprite.setAnimation(0,this.cfg.dragonBallImage,!0),this.node.setPosition(t),this.applyFloatEffect(this.ballNode)},e.prototype.initTest=function(){this.cfg=g.default.getInstance().getDragonBallCfgBYid(Math.ceil(5*Math.random()))},e.prototype.doDestroyTest=function(t,e){this.state=1==e?l.dragon:l.player,this.doItem(this.cfg,this.state)},e.prototype.applyFloatEffect=function(t,e,o){void 0===e&&(e=20),void 0===o&&(o=1.5);var i=t.position.clone();this.floatTween=cc.tween(t).to(o,{position:new cc.Vec3(i.x,i.y+e,i.z)}).to(o,{position:i}).union().repeatForever().start()},e.prototype.stopFloatEffect=function(){this.floatTween&&(this.floatTween.stop(),this.floatTween=null)},e.prototype.doDestroy=function(t){if(this.state==l.None){if(d.AudioMgr.getInstance().playEffect(f.YEAR_AudioId.dragonYearGet,"dragonBallShow"),this.stopFloatEffect(),this.state=t,t==l.player)this.montionStreak.node.scaleY=-1;else{var e=this.node.y+100;this.dragonLimitY=e,this.step=0,this.montionStreak.node.scaleY=1}this.montionStreak.node.angle=0,this.node.getChildByName("ball").y=0,this.montionStreak.node.active=!0,this.montionStreak.setAnimation(0,this.cfg.dragonBallImage,!0),this.hpLabel.node.active=!1,this.ballCtrlScript.reduceTime(6)}},e.prototype.doDestoryTween=function(t){if(this.state==l.player)this.node.y+=this.ballSpeed*t*-1,this.node.y<this.playerLimitY&&this.doDestroyTweenDown();else if(this.state==l.dragon)if(0==this.step){var e=this.ballSpeed*t;this.node.y+=e,this.node.y>=this.dragonLimitY&&(this.step=1)}else{var o=v.default.script.getHeadNode().getPosition(),i=o.sub(this.node.getPosition()),n=new cc.Vec2(1,0);this.montionStreak.node.angle=270-i.angle(n)/Math.PI*180,i.normalizeSelf(),this.node.x+=i.x*this.ballSpeed*3*t,this.node.y+=i.y*this.ballSpeed*3*t,o.fuzzyEquals(this.node.getPosition(),30)&&this.doDestroyTweenDown()}},e.prototype.doDestroyTweenDown=function(){this.doItem(this.cfg,this.state),this.node.y=5e3,this.state=l.None},e.prototype.doItem=function(t,e){var o=-1;t.dragonBallID==p.iceBall?(o=e==l.dragon?t.dragonGetPara2:t.playerGetPara1,d.AudioMgr.getInstance().playEffect(f.YEAR_AudioId.ice,"skillBuff")):t.dragonBallID==p.fireBall?e==l.dragon?this.getScript(t,e).doBallSkill(e,t):o=t.playerGetPara2:t.dragonBallID==p.thunderBall?o=e==l.dragon?t.dragonGetPara1:t.playerGetPara1:t.dragonBallID==p.windBall?(d.AudioMgr.getInstance().playEffect(f.YEAR_AudioId.wind,"skillBuff"),o=e==l.dragon?t.dragonGetPara2:t.playerGetPara2):t.dragonBallID==p.vagueBall&&(o=e==l.dragon?t.dragonGetPara2:t.playerGetPara2,e==l.dragon?d.AudioMgr.getInstance().playEffect(f.YEAR_AudioId.barrier,"skillBuff"):d.AudioMgr.getInstance().playEffect(f.YEAR_AudioId.magic,"skillBuff"));var i=e==l.dragon?t.dragonGetDes:t.playerGetDes,n=e==l.dragon?this.dragonBallLabel:this.playerBallLabel;if(this.showBanner(n,i),-1!=o){var a=new _(o,e,t);this.ballTimeArr.push(a),this.getScript(t,e).doBallSkill(e,t)}},e.prototype.showBanner=function(t,e){this.bannerTime||(this.bannerTime=g.default.getInstance().getParam(m.enumBasicParaCfg.tipsStayTime)),t.active=!0;var o=e.split(","),i=t.getChildByName("label1").getComponent(cc.Label),n=t.getChildByName("label2").getComponent(cc.Label);i.string=o[0],n.string=o[1]?o[1]:"",this.scheduleOnce(function(){t.active=!1},this.bannerTime)},e.prototype.getScript=function(t,e){return"player"==(e==l.dragon?t.dragonEffect:t.playerEffect)?y.default.script:v.default.script},e.prototype.checkSkillCollider=function(t,e){this.state==l.None&&t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.getPosition()),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.checkCollider=function(t){return this.state==l.None&&!!this.isInRange(t)},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hpNum-=Math.floor(s),this.hpNum<=0)this.sendEvent(f.emYEAREventName.blood,t,this.getPos(e),o),this.doDestroy(l.player);else for(;r--;)this.doDamage(t,this.getPos(e),o,a)},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(f.emYEAREventName.blood,t,e,o,i),this.hpLabel.string=Math.max(this.hpNum,0).toString()},e.prototype.getPos=function(t){var e=h.Utils.randomRang(-30,30),o=h.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.resumeItem=function(t){for(var e=0;e<this.ballTimeArr.length;e++)this.ballTimeArr[e].time-=t,this.ballTimeArr[e].time<0&&(this.ballTimeArr[e].cfg.dragonBallID==p.iceBall&&d.AudioMgr.getInstance().playEffect(f.YEAR_AudioId.icebreak,"skillBuff"),y.default.script.heroResumeSkill(this.ballTimeArr[e].cfg.dragonBallID),v.default.script.resumeBallSkill(this.ballTimeArr[e].cfg.dragonBallID),this.ballTimeArr.splice(e,1),e--)},e.prototype.checkDragon=function(){if(this.state==l.None){var t=v.default.script.getHeadNode().getPosition();this.areVec2ComponentsEqual(t,this.node.getPosition(),50,10)&&this.doDestroy(l.dragon)}},e.prototype.areVec2ComponentsEqual=function(t,e,o,i){var n=Math.abs(t.x-e.x)<o,a=Math.abs(t.y-e.y)<i;return n&&a},e.prototype.resume=function(){this.isPause=!1},e.prototype.pause=function(){this.isPause=!0},e.prototype.onLoad=function(){this.addEvent(f.emYEAREventName.pause,this.pause),this.addEvent(f.emYEAREventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.isPause||(this.resumeItem(t),this.doDestoryTween(t),this.checkDragon())},c([I(cc.Label)],e.prototype,"hpLabel",void 0),c([I(sp.Skeleton)],e.prototype,"ballSprite",void 0),c([I(sp.Skeleton)],e.prototype,"montionStreak",void 0),c([I(cc.Node)],e.prototype,"ballNode",void 0),c([I(cc.Node)],e.prototype,"dragonBallLabel",void 0),c([I(cc.Node)],e.prototype,"playerBallLabel",void 0),c([B],e)}(u.default);a.default=P,function(t){t.None="None",t.player="player",t.dragon="dragon"}(l=a.ballState||(a.ballState={})),function(t){t[t.iceBall=1]="iceBall",t[t.fireBall=2]="fireBall",t[t.thunderBall=3]="thunderBall",t[t.windBall=4]="windBall",t[t.vagueBall=5]="vagueBall"}(p=a.ballID||(a.ballID={})),cc._RF.pop(),cc._RF.pop()},{}],YEAR_bodyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1acbeORTApP66Y88OhsQT6j","YEAR_bodyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1acbeORTApP66Y88OhsQT6j","YEAR_bodyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("YEAR_Configs"),d=i("YEARGameEnumData"),h=i("YEAR_DataMgr"),f=i("YEAR_UIGame"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStart=!1,e.index=0,e.ballgonSpeed=100,e.end=!1,e.sp=[],e.gapDt=.2,e.isYEARgon=!1,e.isLast=!1,e.baseTime=.5,e.resumeTime=.5,e.damageState=!1,e.posNum=2,e}var o;return s(e,t),o=e,e.prototype.startYEAR=function(t,e,o,i){this.isYEARgon=!1,4==e&&(this.isLast=!0),-1!=e?(this.changeSp(e),this.destroyNode=p.PoolMgr.getInstance().getNode(u.poolName.destroy)):this.isYEARgon=!0,this.path=t,this.index=i,this.targetPos=this.path[this.index],this.isStart=!0,this.maxIndex=this.path.length-4,this.posNum=2},e.prototype.changeFireState=function(){this.isYEARgon||this.isLast||(this.fireNode.active=!this.fireNode.active,this.fireNode.active&&this.fireNode.getComponent(sp.Skeleton).setAnimation(0,"fire",!0))},e.prototype.stop=function(){this.isStart=!1,this.isYEARgon?this.node.getComponent(sp.Skeleton).clearTrack(0):this.spNode.getComponent(cc.Animation).pause()},e.prototype.resume=function(){this.isStart=!0,this.isYEARgon?this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0):this.spNode.getComponent(cc.Animation).resume()},e.prototype.changeSp=function(t){this.spNode.getComponent(cc.Sprite).spriteFrame=this.sp[t]},e.prototype.playAnimation=function(t){var e=this;this.scheduleOnce(function(){e.spNode.getComponent(cc.Animation).play(),e.spNode.getComponent(cc.Animation).play().clip.speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmni)},t)},e.prototype.doAnimation=function(t){var e=this;void 0===t&&(t=0),this.scheduleOnce(function(){var t=e.spNode.getComponent(cc.Animation);t.play("body"),t.getAnimationState("body").speed=h.default.getInstance().getParam(d.enumBasicParaCfg.dragonMoveAmni)},t)},e.prototype.doDamage=function(){this.spNode.color=cc.color().fromHEX("#a60000"),this.resumeTime=this.baseTime,this.damageState=!0},e.prototype.reSumeDamage=function(){this.spNode.color=cc.Color.WHITE},e.prototype.resumeNode=function(t){0!=this.damageState&&(this.resumeTime-=t,this.resumeTime<0&&this.damageState&&(this.reSumeDamage(),this.damageState=!1))},e.prototype.informPre=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0),this.preNode&&(u.Global.isBug&&(this.node.active=!1),u.Global.isBug||(this.preNode=this.getInfactPre()),this.preNode.getComponent(o).setNodePosition(this.node.getPosition(),this.index))},e.prototype.getInfactPre=function(){for(var t=this.preNode;!t.active;)t.removeFromParent(),t=t.getComponent(o).preNode;return t},e.prototype.setNodePosition=function(t,e){var o=this;u.Global.isBug||this.informPre(t,e),this.index=e,this.targetPos=this.path[this.index],this.node.setPosition(t),u.Global.isBug&&this.informPre(t,e),this.isYEARgon&&"die"!=this.node.getComponent(sp.Skeleton).animation&&(this.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1),this.node.getComponent(sp.Skeleton).setCompleteListener(function(){o.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}))},e.prototype.getIndex=function(){return this.index},e.prototype.playDeballry=function(){var t=this;f.default.script.onScreenShake();var e=p.PoolMgr.getInstance().getNode(u.poolName.destroy);e||(e=cc.instantiate(this.destroyNode)),e.parent=f.default.script.getDestroyLayer(),e.setPosition(this.node.getPosition()),e.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){e.destroy()},.1)})},e.prototype.setPreNode=function(t,e){var o=t.position;o.x-=e,this.isLast&&(this.spNode.anchorX=.8,this.spNode.anchorY=.3),this.node.position=o,this.preNode=t},e.prototype.onLoad=function(){this.ballgonSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed)},e.prototype.start=function(){var t=this;cc.game.on("gameEnd",function(){t.isStart=!1})},e.prototype.update=function(t){this.isStart&&this.resumeNode(t)},e.prototype.onUpdate=function(t,e){if(this.node.active&&!this.end&&this.isStart){var o=this.targetPos,i=this.node.getPosition();if(null!=o&&null!=i){var n=o.sub(i).mag(),a=e*t;a=Math.min(a,n);var r=o.sub(i).normalize().mul(a);this.node.setPosition(i.add(r)),this.isYEARgon&&(r.x<0?this.node.scaleX=1:r.x>0&&(this.node.scaleX=-1)),this.isLast&&(r.x<0?this.node.scaleX=-1:r.x>0&&(this.node.scaleX=1)),n<=a&&(this.node.setPosition(o),this.index++,this.index>=this.path.length||(this.targetPos=this.path[this.index])),this.index>=this.maxIndex&&(this.endPos||(this.endPos=f.default.script.getWallPos()),this.node.getPosition().fuzzyEquals(this.endPos,50)&&(this.end=!0,this.sendEvent(u.emYEAREventName.pause),this.openUI(u.YEAR_UIID.UIResult)))}}},c([y(cc.SpriteFrame)],e.prototype,"sp",void 0),c([y(cc.Node)],e.prototype,"spNode",void 0),c([y(cc.Node)],e.prototype,"fireNode",void 0),o=c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],YEAR_boxCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"3caf6MCzzlCBYdEsGckntwa","YEAR_boxCtrl");var i=t,n=e,a=o;cc._RF.push(n,"3caf6MCzzlCBYdEsGckntwa","YEAR_boxCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("Utils"),h=i("YEAR_Configs"),f=i("YEAR_DataMgr"),m=i("YEAR_bodyCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.boxSpArr=[],e.otherNodes=[],e.isDie=!1,e.lastAttackIndex=0,e.hp=2,e.isLast=!1,e.canBeAttack=!1,e.isCreate=!1,e}return s(e,t),e.prototype.start=function(){this.canBeAttack=!1},e.prototype.setCanBeAttack=function(){this.canBeAttack=!0},e.prototype.initNode=function(t,e,o,i){var n=this;void 0===i&&(i=!1),this.scheduleOnce(function(){n.boxSp.node.active=!0,n.label.node.active=!0},.1),this.isLast=i,this.targetNode=t,this.hp=e,this.boxIndex=o,this.label.string=e.toString(),this.initBox(),this.blood=u.PoolMgr.getInstance().getNode(h.poolName.blood)},e.prototype.initBox=function(){f.default.getInstance().getLevelCfgByID(this.boxIndex).buffType&&(this.boxSp.spriteFrame=this.boxSpArr[1])},e.prototype.addOtherNode=function(t){this.otherNodes.push(t)},e.prototype.checkCollider=function(t){if(this.checkIsDie(),this.canBeAttack)return!this.isDie&&!!this.isInRange(t)},e.prototype.checkIsDie=function(){if(!this.isDie){var t=!1;for(var e in this.otherNodes)if(0==this.otherNodes[e].active){t=!0;break}t&&(this.node.active=!1),this.isDie=t}},e.prototype.checkSkillCollider=function(t,e){this.canBeAttack&&(this.isDie||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0))},e.prototype.doFireDamage=function(t){if(!this.isDie){var e=Math.ceil(this.hp*t);this.handleDamage(e,this.node.getPosition())}},e.prototype.isInRange=function(t){var e=this.targetNode.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hp-=s,this.hp<=0)this.sendEvent(h.emYEAREventName.blood,t,this.getPos(e),o),this.doDie();else for(;r--;)this.doDamage(t,this.getPos(e),o,a)},e.prototype.getPos=function(t){var e=d.Utils.randomRang(-30,30),o=d.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(h.emYEAREventName.blood,t,e,o,i),this.label.string=Math.max(this.hp,0).toString(),this.otherNodes.forEach(function(t){t.getComponent(m.default).doDamage()})},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.doDie=function(){var t=this;p.AudioMgr.getInstance().playEffectFree(h.YEAR_AudioId.burn,6),this.isDie=!0,this.node.active=!1,h.Global.isBug?this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(),e.active=!1,o%2&&e.getComponent(m.default).playDeballry()},.05*o)}):this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.getComponent(m.default).informPre(e.getPosition(),e.getComponent(m.default).getIndex()),e.active=!1},.05*(9-o)),t.scheduleOnce(function(){o%2&&e.getComponent(m.default).playDeballry()},.05*o)}),this.isLast&&(this.sendEvent(h.emYEAREventName.pause),this.openUI(h.YEAR_UIID.UIResult,!0)),this.spawnBuffItem()},e.prototype.spawnBuffItem=function(){this.isCreate||(this.isCreate=!0,this.sendEvent(h.emYEAREventName.buff,this.boxIndex))},e.prototype.update=function(){this.targetNode&&!this.isDie&&this.node.setPosition(this.targetNode.position)},c([v(cc.Label)],e.prototype,"label",void 0),c([v(cc.Sprite)],e.prototype,"boxSp",void 0),c([v(cc.SpriteFrame)],e.prototype,"boxSpArr",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],YEAR_fireNode:[function(t,e,o){"use strict";cc._RF.push(e,"ca91e1Rt6xFj4mwMcSK9vOe","YEAR_fireNode");var i=t,n=e,a=o;cc._RF.push(n,"ca91e1Rt6xFj4mwMcSK9vOe","YEAR_fireNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("Utils"),d=i("YEAR_Configs"),h=i("YEAR_UIGame"),f=i("YEAR_Body"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aimY=0,e.nodeActive=!0,e.inDestroy=!1,e.fireEffectTime=3,e.nowTime=0,e}return s(e,t),e.prototype.initParam=function(t,e){this.inDestroy=!1,this.hpNum=Math.floor(t),this.speed=e,this.aimY=h.default.script.getWallPosY(),p.AudioMgr.getInstance().playEffect(d.YEAR_AudioId.fireyear,"fireBall"),this.nodeActive=!0,this.initView()},e.prototype.initView=function(){this.node.getComponent(sp.Skeleton).setAnimation(0,"animation",!0),this.hpLabel.string=this.hpNum.toString()},e.prototype.doDestroy=function(){var t=this;f.default.script.fireNodeDestroy(),this.node.active=!1,this.nodeActive=!1,this.scheduleOnce(function(){t.node.removeFromParent()},1)},e.prototype.checkSkillCollider=function(t,e){this.hpNum<=0||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.getPosition()),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.checkCollider=function(t){return!(this.hpNum<=0||!this.isInRange(t))},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=150},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hpNum-=s,this.hpNum<=0)this.sendEvent(d.emYEAREventName.blood,t,this.getPos(e),o),this.doDestroy();else for(;r--;)this.doDamage(t,this.getPos(e),o,a)},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(d.emYEAREventName.blood,t,e,o,i),this.hpLabel.string=Math.max(this.hpNum,0).toString()},e.prototype.getPos=function(t){var e=u.Utils.randomRang(-30,30),o=u.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.node.y-=this.speed*t,this.nodeActive&&(this.nowTime+=t,this.nowTime>=this.fireEffectTime&&(this.nowTime=0,p.AudioMgr.getInstance().playEffect(d.YEAR_AudioId.fireyear,"fireBall")),this.node.y-this.node.height/2<this.aimY&&(this.sendEvent(d.emYEAREventName.pause),this.openUI(d.YEAR_UIID.UIResult)))},c([y(cc.Label)],e.prototype,"hpLabel",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],YEAR_mateCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c9839bSSDBCh6M6YuT6M1LA","YEAR_mateCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c9839bSSDBCh6M6YuT6M1LA","YEAR_mateCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("YEAR_Configs"),u=i("YEAR_DataMgr"),d=i("YEAR_HeroCtrl"),h=i("YEAR_mateSkillCtrl"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e.maxCDTime=0,e.cdTime=0,e.mateSkillAttack=1,e.mateID=1,e.isPause=!1,e}return s(e,t),e.prototype.initNode=function(t){this.mateID=t,this.initParam(),this.initView(),this.initButton()},e.prototype.initParam=function(){var t=this,e=u.default.getInstance().getMateCfgByID(this.mateID);this.maxCDTime=e.mateCDtime,this.mateSkillAttack=e.mateSkillATK,this.loadPrefab(p.emYEARBundles.prefabs,"skills/mateSkill"+this.mateID,function(e){t.skillNode=cc.instantiate(e)})},e.prototype.initView=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID);this.skillLabel.string=t.mateName,this.cdPercent.fillRange=0,this.skillIcon.spriteFrame=this.getSpriteByName(),this.cdLabel.node.active=!1},e.prototype.initButton=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.useSkill()})},e.prototype.useSkill=function(){if(this.cdTime<=0){if(d.default.script.getBallLock())return;var t=u.default.getInstance().getMateCfgByID(this.mateID),e=Number(t.mateRole.split(",")[0]),o=Number(t.mateRole.split(",")[1]);h.default.script.useSkill(this.mateID,d.default.script.getMaxDamage(e,o)*t.mateSkillATK,this.skillNode,new cc.Vec2(0,0))&&this.initStartUseSkill()}},e.prototype.initStartUseSkill=function(){this.cdLabel.node.active=!0,this.cdTime=this.maxCDTime,this.cdLabel.string=this.cdTime+"",this.cdPercent.fillRange=1},e.prototype.refreshSkillView=function(t){var e=this;this.cdTime-=t,this.cdPercent.fillRange=(this.cdTime>0?this.cdTime:0)/this.maxCDTime,this.cdTime<=0?(this.cdLabel.node.active=!1,this.spNode.node.active=!0,this.spNode.setAnimation(0,"animation",!1),this.spNode.setCompleteListener(function(){e.spNode.node.active=!1})):this.cdLabel.string=this.cdTime.toFixed(0)},e.prototype.getSpriteByName=function(){var t=u.default.getInstance().getMateCfgByID(this.mateID).mateIconRes;for(var e in this.spArr)if(t==this.spArr[e].name)return this.spArr[e]},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.onLoad=function(){this.addEvent(p.emYEAREventName.pause,this.pause),this.addEvent(p.emYEAREventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.cdTime>0&&!this.isPause&&!d.default.script.getBallLock()&&this.refreshSkillView(t)},c([g(cc.SpriteFrame)],e.prototype,"spArr",void 0),c([g(cc.Label)],e.prototype,"cdLabel",void 0),c([g(cc.Label)],e.prototype,"skillLabel",void 0),c([g(cc.Sprite)],e.prototype,"cdPercent",void 0),c([g(cc.Sprite)],e.prototype,"skillIcon",void 0),c([g(sp.Skeleton)],e.prototype,"spNode",void 0),c([m],e)}(l.default);a.default=y,cc._RF.pop(),cc._RF.pop()},{}],YEAR_mateSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"c0d6cm3BHlGMYmEeRMa9Ji7","YEAR_mateSkillCtrl");var i=t,n=e,a=o;cc._RF.push(n,"c0d6cm3BHlGMYmEeRMa9Ji7","YEAR_mateSkillCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("YEAR_mateSkill"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.banner=null,e.text="hello",e.isSkill=!1,e}var o;return s(e,t),o=e,e.prototype.useSkill=function(t,e,o,i){var n=this;return!this.isSkill&&(this.isSkill=!0,this.scheduleOnce(function(){n.isSkill=!1},.5),o.parent=this.node,o.getComponent(p.default).useSkill(i,e,t),!0)},e.prototype.onLoad=function(){o.script=this},e.prototype.start=function(){},e.prototype.update=function(){},c([h(cc.Label)],e.prototype,"label",void 0),c([h(cc.Node)],e.prototype,"banner",void 0),c([h],e.prototype,"text",void 0),o=c([d],e)}(l.default);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],YEAR_mateSkill:[function(t,e,o){"use strict";cc._RF.push(e,"7b032pSx01KzLJ3iULWHHj1","YEAR_mateSkill");var i=t,n=e,a=o;cc._RF.push(n,"7b032pSx01KzLJ3iULWHHj1","YEAR_mateSkill");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("EventMgr"),u=i("YEAR_Configs"),d=i("YEAR_DataMgr"),h=i("YEAR_Body"),f=i("YEAR_Hero"),m=i("YEAR_HeroCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spAni=null,e.colBox=null,e.colCircle=null,e.sub1=null,e.sub2=null,e.canMove=!1,e.offWidth=0,e.offHeight=0,e.attackTriggerTime=.1,e.animationDuration=0,e}return s(e,t),e.prototype.onLoad=function(){var t=this;this.spAni.setEventListener(function(e,o){var i=d.default.getInstance().getMateCfgByID(t.index),n=Number(i.mateRole.split(",")[0]),a=Number(i.mateRole.split(",")[1]),r=[];for(var s in u.Global.heroID)u.Global.heroID[s].id!=n&&u.Global.heroID[s].id!=a||r.push(u.Global.heroID[s].node.getComponent(f.default));"attack"==o.data.name&&(t.doMateSkillCtrl(t.index,r,i),t.doAttack())})},e.prototype.doMateSkillCtrl=function(t,e,o){1==t?this.doMateSkill1(e,o):2==t?this.doMateSkill2(e,o):3==t?this.doMateSkill3(e,o):4==t?this.doMateSkill4(e,o):5==t?this.doMateSkill5(e,o):6==t?this.doMateSkill6(e,o):7==t&&this.doMateSkill7(e,o)},e.prototype.doMateSkill1=function(t,e){for(var o in t)t[o].addAttackSpeed(1,Number(e.matePara))},e.prototype.doMateSkill2=function(t,e){var o=m.default.script.getMaxDamage(4,8),i=Math.floor(o*Number(e.matePara));for(var n in t)t[n].addAttackPower(1,i)},e.prototype.doMateSkill3=function(t,e){p.EventMgr.getInstance().emit(u.emYEAREventName.skillPause),this.scheduleOnce(function(){p.EventMgr.getInstance().emit(u.emYEAREventName.skillResume)},Number(e.matePara))},e.prototype.doMateSkill4=function(t,e){for(var o in t){var i=Math.floor(2*Math.random()),n=Number(e.matePara.split(",")[i]),a=t[o];n<1?a.addCritChance(3,n):a.addBulletCount(1,n)}},e.prototype.doMateSkill5=function(t,e){var o=Number(e.matePara.split(",")[0]),i=Number(e.matePara.split(",")[1]);for(var n in t)t[n].changeSkillInterval(o,i)},e.prototype.doMateSkill6=function(t,e){var o=Number(e.matePara.split(",")[0]),i=Number(e.matePara.split(",")[1]);for(var n in t)t[n].addAttackPenerate(3,o,5,i)},e.prototype.doMateSkill7=function(t,e){var o=Math.max(t[0].getAttackPower(),t[1].getAttackPower()),i=Math.max(t[0].getSpeed(),t[1].getSpeed()),n=e.matePara.split(","),a=Math.floor(o*Number(n[0])),r=Math.floor(i*Number(n[1])),s=Number(n[2]),c=Math.min(t[0].getBulletCount(),t[1].getBulletCount());m.default.script.addTempHero(14,a,r,s,c)},e.prototype.useSkill=function(t,e,o){var i=d.default.getInstance().getMateCfgByID(o);if(l.AudioMgr.getInstance().playEffect(i.mateSound,"mateSkill"),this.index=o,this.spAni.setAnimation(0,"animation",!1),7!=o)this.node.setPosition(t.x,h.default.script.getHeadY());else{var n=m.default.script.node.getPosition();this.node.setPosition(n)}this.damage=e},e.prototype.update=function(){},e.prototype.doAttack=function(){h.default.script.checkSkillCollider(this.getWorldColldierRect(this.offWidth,this.offHeight),this.damage)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},c([v({type:sp.Skeleton,tooltip:"\u52a8\u753b"})],e.prototype,"spAni",void 0),c([v({type:cc.BoxCollider,tooltip:"\u77e9\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colBox",void 0),c([v({type:cc.CircleCollider,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"colCircle",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub1",void 0),c([v({type:cc.Node,tooltip:"\u5706\u5f62\u78b0\u649e\u4f53"})],e.prototype,"sub2",void 0),c([y],e)}(cc.Component);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],ballCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"fad9dE4/ExMra6dnX/XY6pF","ballCtrl");var i=t,n=e,a=o;cc._RF.push(n,"fad9dE4/ExMra6dnX/XY6pF","ballCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("BALL_Configs"),c=i("BALL_DataMgr"),l=i("ball"),p=i("BALL_bodyCtrl"),u=function(){function t(t,e){this.gameCtrl=null,this.pathIndex=new Map,this.path=[],this.nowTime=0,this.showIndex=0,this.cfgArr=[],this.nowCfg=null,this.ballLottery=[],this.gameCtrl=t,this.path=e,this.initParam()}return t.prototype.initParam=function(){this.cfgArr=c.default.getInstance().getDragonBallShowCfg(),this.initBallLottery(),this.refreshCfg(),this.createPath()},t.prototype.initBallLottery=function(){var t=c.default.getInstance().getDragonBallCfg();for(var e in this.ballLottery=[],t)this.ballLottery.push(t[e])},t.prototype.refreshCfg=function(){this.nowCfg=this.cfgArr[this.showIndex],this.showIndex++},t.prototype.createBall=function(t){r.AudioMgr.getInstance().playEffect(s.BALL_AudioId.dragonBallShow,"dragonBallShow");var e=this.gameCtrl.head.getComponent(p.default).getIndex();if((e=this.pathIndex[e]+t.distance)!=this.path.length-1){var o=!0;for(this.pathIndex.has(e);o;)for(var i in o=!1,this.pathIndex)if(this.pathIndex[i]==e){o=!0,e++;break}}e>=this.path.length&&(e=this.path.length-1);var n=this.path[e],a=Math.floor(Math.random()*this.ballLottery.length),c=this.ballLottery[a];this.ballLottery.splice(a,1),0==this.ballLottery.length&&this.initBallLottery(),this.gameCtrl.initBanner(c.dragonBallName),this.gameCtrl.ballNode.getComponent(l.default).initParam(t.dragonBallHp,c,n,this)},t.prototype.createPath=function(){for(var t=(this.path[1].x-this.path[0].x)/4,e=[],o=0;o<this.path.length-1;){var i=this.path[o].x,n=-i/Math.abs(i),a=this.path[o].y;if(Math.abs(this.path[o+1].y-this.path[o].y)<1e-6){this.pathIndex[o]=e.length;for(var r=5;r--;){var s=new cc.Vec2(i,a);e.push(s),i+=t*n}this.pathIndex[o+1]=e.length-1,o+=2}else s=new cc.Vec2(i,a),e.push(s),this.pathIndex[o]=e.length-1,o+=1}e.push(this.path[this.path.length-1]),this.pathIndex[o]=e.length-1,this.path=e},t.prototype.getCommonElements=function(t,e){var o=this;return t.filter(function(t){return e.some(function(e){return o.areVec2Equal(t,e)})})},t.prototype.getUniqueElements=function(t,e){var o=this;return t.filter(function(t){return!e.some(function(e){return o.areVec2Equal(t,e)})})},t.prototype.areVec2Equal=function(t,e){return Math.abs(t.x-e.x)<=2&&Math.abs(t.y-e.y)<=2},t.prototype.test=function(){this.nowTime=this.nowCfg.showTime-1},t.prototype.reduceTime=function(t){this.nowCfg&&this.nowTime+t>this.nowCfg.showTime&&(this.nowTime-=t)},t.prototype.onUpdate=function(t){if(this.nowCfg&&(this.nowTime+=t,this.nowTime>=this.nowCfg.showTime)){var e=this.nowCfg;this.refreshCfg(),this.createBall(e)}},t}();a.default=u,cc._RF.pop(),cc._RF.pop()},{}],ball:[function(t,e,o){"use strict";cc._RF.push(e,"843fdKLiz1JcYFsqIIhNBAb","ball");var i=t,n=e,a=o;cc._RF.push(n,"843fdKLiz1JcYFsqIIhNBAb","ball");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.ballID=a.ballState=void 0;var l,p,u=i("BaseCtrl"),d=i("AudioMgr"),h=i("Utils"),f=i("BALL_Configs"),m=i("BALLGameEnumData"),g=i("BALL_DataMgr"),y=i("BALL_HeroCtrl"),v=i("BALL_Body"),_=function(t,e,o){this.time=t,this.state=e,this.cfg=o},b=cc._decorator,B=b.ccclass,I=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpLabel=null,e.ballSprite=null,e.montionStreak=null,e.ballNode=null,e.dragonBallLabel=null,e.playerBallLabel=null,e.state=l.None,e.ballTimeArr=[],e.isPause=!1,e.dragonLimitY=700,e.playerLimitY=-300,e.step=0,e}return s(e,t),e.prototype.initParam=function(t,e,o,i){this.ballCtrlScript||(this.ballCtrlScript=i),this.ballSpeed||(this.ballSpeed=g.default.getInstance().getParam(m.enumBasicParaCfg.ballFlySpeed)),this.ballNode.y=0,this.ballNode.x=0,this.stopFloatEffect(),this.state=l.None,this.hpNum=Math.floor(t),this.cfg=e,this.montionStreak.node.active=!1,this.montionStreak.node.angle=0,this.initView(o)},e.prototype.initView=function(t){this.hpLabel.string=this.hpNum.toString(),this.hpLabel.node.active=!0,this.ballSprite.setAnimation(0,this.cfg.dragonBallImage,!0),this.node.setPosition(t),this.applyFloatEffect(this.ballNode)},e.prototype.initTest=function(){this.cfg=g.default.getInstance().getDragonBallCfgBYid(Math.ceil(5*Math.random()))},e.prototype.doDestroyTest=function(t,e){this.state=1==e?l.dragon:l.player,this.doItem(this.cfg,this.state)},e.prototype.applyFloatEffect=function(t,e,o){void 0===e&&(e=20),void 0===o&&(o=1.5);var i=t.position.clone();this.floatTween=cc.tween(t).to(o,{position:new cc.Vec3(i.x,i.y+e,i.z)}).to(o,{position:i}).union().repeatForever().start()},e.prototype.stopFloatEffect=function(){this.floatTween&&(this.floatTween.stop(),this.floatTween=null)},e.prototype.doDestroy=function(t){if(this.state==l.None){if(d.AudioMgr.getInstance().playEffect(f.BALL_AudioId.dragonBallGet,"dragonBallShow"),this.stopFloatEffect(),this.state=t,t==l.player)this.montionStreak.node.scaleY=-1;else{var e=this.node.y+100;this.dragonLimitY=e,this.step=0,this.montionStreak.node.scaleY=1}this.montionStreak.node.angle=0,this.node.getChildByName("ball").y=0,this.montionStreak.node.active=!0,this.montionStreak.setAnimation(0,this.cfg.dragonBallImage,!0),this.hpLabel.node.active=!1,this.ballCtrlScript.reduceTime(6)}},e.prototype.doDestoryTween=function(t){if(this.state==l.player)this.node.y+=this.ballSpeed*t*-1,this.node.y<this.playerLimitY&&this.doDestroyTweenDown();else if(this.state==l.dragon)if(0==this.step){var e=this.ballSpeed*t;this.node.y+=e,this.node.y>=this.dragonLimitY&&(this.step=1)}else{var o=v.default.script.getHeadNode().getPosition(),i=o.sub(this.node.getPosition()),n=new cc.Vec2(1,0);this.montionStreak.node.angle=270-i.angle(n)/Math.PI*180,i.normalizeSelf(),this.node.x+=i.x*this.ballSpeed*3*t,this.node.y+=i.y*this.ballSpeed*3*t,o.fuzzyEquals(this.node.getPosition(),30)&&this.doDestroyTweenDown()}},e.prototype.doDestroyTweenDown=function(){this.doItem(this.cfg,this.state),this.node.y=5e3,this.state=l.None},e.prototype.doItem=function(t,e){var o=-1;t.dragonBallID==p.iceBall?(o=e==l.dragon?t.dragonGetPara2:t.playerGetPara1,d.AudioMgr.getInstance().playEffect(f.BALL_AudioId.ice,"skillBuff")):t.dragonBallID==p.fireBall?e==l.dragon?this.getScript(t,e).doBallSkill(e,t):o=t.playerGetPara2:t.dragonBallID==p.thunderBall?o=e==l.dragon?t.dragonGetPara1:t.playerGetPara1:t.dragonBallID==p.windBall?(d.AudioMgr.getInstance().playEffect(f.BALL_AudioId.wind,"skillBuff"),o=e==l.dragon?t.dragonGetPara2:t.playerGetPara2):t.dragonBallID==p.vagueBall&&(o=e==l.dragon?t.dragonGetPara2:t.playerGetPara2,e==l.dragon?d.AudioMgr.getInstance().playEffect(f.BALL_AudioId.barrier,"skillBuff"):d.AudioMgr.getInstance().playEffect(f.BALL_AudioId.magic,"skillBuff"));var i=e==l.dragon?t.dragonGetDes:t.playerGetDes,n=e==l.dragon?this.dragonBallLabel:this.playerBallLabel;if(this.showBanner(n,i),-1!=o){var a=new _(o,e,t);this.ballTimeArr.push(a),this.getScript(t,e).doBallSkill(e,t)}},e.prototype.showBanner=function(t,e){this.bannerTime||(this.bannerTime=g.default.getInstance().getParam(m.enumBasicParaCfg.tipsStayTime)),t.active=!0;var o=e.split(","),i=t.getChildByName("label1").getComponent(cc.Label),n=t.getChildByName("label2").getComponent(cc.Label);i.string=o[0],n.string=o[1]?o[1]:"",this.scheduleOnce(function(){t.active=!1},this.bannerTime)},e.prototype.getScript=function(t,e){return"player"==(e==l.dragon?t.dragonEffect:t.playerEffect)?y.default.script:v.default.script},e.prototype.checkSkillCollider=function(t,e){this.state==l.None&&t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.getPosition()),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.checkCollider=function(t){return this.state==l.None&&!!this.isInRange(t)},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hpNum-=Math.floor(s),this.hpNum<=0)this.sendEvent(f.emBALLEventName.blood,t,this.getPos(e),o),this.doDestroy(l.player);else for(;r--;)this.doDamage(t,this.getPos(e),o,a)},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(f.emBALLEventName.blood,t,e,o,i),this.hpLabel.string=Math.max(this.hpNum,0).toString()},e.prototype.getPos=function(t){var e=h.Utils.randomRang(-30,30),o=h.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.resumeItem=function(t){for(var e=0;e<this.ballTimeArr.length;e++)this.ballTimeArr[e].time-=t,this.ballTimeArr[e].time<0&&(this.ballTimeArr[e].cfg.dragonBallID==p.iceBall&&d.AudioMgr.getInstance().playEffect(f.BALL_AudioId.icebreak,"skillBuff"),y.default.script.heroResumeSkill(this.ballTimeArr[e].cfg.dragonBallID),v.default.script.resumeBallSkill(this.ballTimeArr[e].cfg.dragonBallID),this.ballTimeArr.splice(e,1),e--)},e.prototype.checkDragon=function(){if(this.state==l.None){var t=v.default.script.getHeadNode().getPosition();this.areVec2ComponentsEqual(t,this.node.getPosition(),50,10)&&this.doDestroy(l.dragon)}},e.prototype.areVec2ComponentsEqual=function(t,e,o,i){var n=Math.abs(t.x-e.x)<o,a=Math.abs(t.y-e.y)<i;return n&&a},e.prototype.resume=function(){this.isPause=!1},e.prototype.pause=function(){this.isPause=!0},e.prototype.onLoad=function(){this.addEvent(f.emBALLEventName.pause,this.pause),this.addEvent(f.emBALLEventName.resume,this.resume)},e.prototype.start=function(){},e.prototype.update=function(t){this.isPause||(this.resumeItem(t),this.doDestoryTween(t),this.checkDragon())},c([I(cc.Label)],e.prototype,"hpLabel",void 0),c([I(sp.Skeleton)],e.prototype,"ballSprite",void 0),c([I(sp.Skeleton)],e.prototype,"montionStreak",void 0),c([I(cc.Node)],e.prototype,"ballNode",void 0),c([I(cc.Node)],e.prototype,"dragonBallLabel",void 0),c([I(cc.Node)],e.prototype,"playerBallLabel",void 0),c([B],e)}(u.default);a.default=P,function(t){t.None="None",t.player="player",t.dragon="dragon"}(l=a.ballState||(a.ballState={})),function(t){t[t.iceBall=1]="iceBall",t[t.fireBall=2]="fireBall",t[t.thunderBall=3]="thunderBall",t[t.windBall=4]="windBall",t[t.vagueBall=5]="vagueBall"}(p=a.ballID||(a.ballID={})),cc._RF.pop(),cc._RF.pop()},{}],bodyCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"7da94KFxtZFApWKznTyMSWG","bodyCtrl");var i=t,n=e,a=o;cc._RF.push(n,"7da94KFxtZFApWKznTyMSWG","bodyCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("PoolMgr"),u=i("DRA_Configs"),d=i("DARGameEnumData"),h=i("DRA_DataMgr"),f=i("DRA_UIGame"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStart=!1,e.skillState=!1,e.index=0,e.dragonSpeed=100,e.end=!1,e.sp=[],e.gapDt=.2,e.isDragon=!1,e.isLast=!1,e.baseTime=.5,e.resumeTime=.5,e.damageState=!1,e.posNum=2,e}var o;return s(e,t),o=e,e.prototype.startRun=function(t,e,o,i){this.isDragon=!1,4==e&&(this.isLast=!0),-1!=e?(this.changeSp(e),this.playAnimation(o*this.gapDt),this.destroyNode=p.PoolMgr.getInstance().getNode(u.poolName.destroy)):this.isDragon=!0,this.path=t,this.index=i,this.targetPos=this.path[this.index],this.isStart=!0,this.maxIndex=this.path.length-4,this.posNum=2},e.prototype.initIndex=function(){},e.prototype.stop=function(){this.isStart=!1,this.isDragon?this.node.getComponent(sp.Skeleton).clearTrack(0):this.spNode.getComponent(cc.Animation).pause()},e.prototype.resume=function(){this.isStart=!0,this.isDragon?this.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!0):this.spNode.getComponent(cc.Animation).resume()},e.prototype.changeSp=function(t){this.spNode.getComponent(cc.Sprite).spriteFrame=this.sp[t]},e.prototype.playAnimation=function(t){var e=this;this.scheduleOnce(function(){e.spNode.getComponent(cc.Animation).play()},t-.2)},e.prototype.doDamage=function(){this.spNode.color=cc.color().fromHEX("#a60000"),this.resumeTime=this.baseTime,this.damageState=!0},e.prototype.reSumeDamage=function(){this.spNode.color=cc.Color.WHITE},e.prototype.resumeNode=function(t){0!=this.damageState&&(this.resumeTime-=t,this.resumeTime<0&&this.damageState&&(this.reSumeDamage(),this.damageState=!1))},e.prototype.informPre=function(){this.preNode&&(this.node.active=!1,this.preNode.getComponent(o).setNodePosition(this.node.getPosition(),this.index))},e.prototype.setNodePosition=function(t,e){var o=this;this.index=e,this.targetPos=this.path[this.index],this.node.setPosition(t),this.informPre(),this.isDragon&&"die"!=this.node.getComponent(sp.Skeleton).animation&&(this.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1),this.node.getComponent(sp.Skeleton).setCompleteListener(function(){o.node.getComponent(sp.Skeleton).setAnimation(0,"idle",!1)}))},e.prototype.getIndex=function(){return this.index},e.prototype.playDestory=function(){var t=this;f.default.script.onScreenShake();var e=p.PoolMgr.getInstance().getNode(u.poolName.destroy);e||(e=cc.instantiate(this.destroyNode)),e.parent=f.default.script.getDestroyLayer(),e.setPosition(this.node.getPosition()),e.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),e.getComponent(sp.Skeleton).setCompleteListener(function(){t.scheduleOnce(function(){e.destroy()},.1)})},e.prototype.setPreNode=function(t,e){var o=t.position;o.x-=e,this.isLast&&(this.spNode.anchorX=.8,this.spNode.anchorY=.3),this.node.position=o,this.preNode=t},e.prototype.onLoad=function(){this.dragonSpeed=h.default.getInstance().getParam(d.enumBasicParaCfg.moveSpeed)},e.prototype.start=function(){var t=this;cc.game.on("gameEnd",function(){t.isStart=!1})},e.prototype.update=function(t){this.isStart&&this.resumeNode(t)},e.prototype.onUpdate=function(t){if(this.node.active&&!this.end&&this.isStart){var e=this.targetPos,o=this.node.getPosition();if(null!=e&&null!=o){var i=this.dragonSpeed*t,n=e.sub(o).mag(),a=e.sub(o).normalize().mul(i);this.node.setPosition(o.add(a)),(this.isDragon||this.isLast)&&(a.x<0?this.node.scaleX=-1:this.node.scaleX=1),n<=i&&(this.node.setPosition(e),this.index++,this.index>=this.path.length?(this.end=!0,this.sendEvent(u.emDRAEventName.pause),this.openUI(u.DRA_UIID.UIResult)):this.targetPos=this.path[this.index]),this.index>=this.maxIndex&&(this.endPos||(this.endPos=f.default.script.getWallPos()),this.node.getPosition().fuzzyEquals(this.endPos,50)&&(this.end=!0,this.sendEvent(u.emDRAEventName.pause),this.openUI(u.DRA_UIID.UIResult)))}}},c([y(cc.SpriteFrame)],e.prototype,"sp",void 0),c([y(cc.Node)],e.prototype,"spNode",void 0),o=c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],boxCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"a80e294Ce1K7Zmq8Mua65QQ","boxCtrl");var i=t,n=e,a=o;cc._RF.push(n,"a80e294Ce1K7Zmq8Mua65QQ","boxCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("Utils"),h=i("DRA_Configs"),f=i("DRA_DataMgr"),m=i("bodyCtrl"),g=cc._decorator,y=g.ccclass,v=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.boxSpArr=[],e.otherNodes=[],e.isDie=!1,e.lastAttackIndex=0,e.hp=2,e.isLast=!1,e.canBeAttack=!1,e.lastHitTime=0,e.hitCooldown=.1,e.isCreate=!1,e}return s(e,t),e.prototype.start=function(){this.canBeAttack=!1},e.prototype.setCanBeAttack=function(){this.canBeAttack=!0},e.prototype.initNode=function(t,e,o,i){var n=this;void 0===i&&(i=!1),this.scheduleOnce(function(){n.boxSp.node.active=!0,n.label.node.active=!0},.1),this.isLast=i,this.targetNode=t,this.hp=e,this.boxIndex=o,this.label.string=e.toString(),this.initBox(),this.blood=u.PoolMgr.getInstance().getNode(h.poolName.blood)},e.prototype.initBox=function(){f.default.getInstance().getLevelCfgByID(this.boxIndex).buffType&&(this.boxSp.spriteFrame=this.boxSpArr[1])},e.prototype.addOtherNode=function(t){this.otherNodes.push(t)},e.prototype.checkCollider=function(t,e,o,i,n,a){if(this.checkIsDie(),this.canBeAttack)return!this.isDie&&!!this.isInRange(t)&&(this.handleDamage(e,t,i,n,a),!0)},e.prototype.checkIsDie=function(){if(!this.isDie){var t=!1;for(var e in this.otherNodes)if(0==this.otherNodes[e].active){t=!0;break}t&&(this.node.active=!1),this.isDie=t}},e.prototype.checkSkillCollider=function(t,e){this.canBeAttack&&(this.isDie||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0))},e.prototype.isInRange=function(t){var e=this.targetNode.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=50},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;n&&(s=i*t,r=i),this.hp-=s;var c=performance.now()/1e3;if(this.hp<=0)this.sendEvent(h.emDRAEventName.blood,t,e,o),this.doDie();else for(;r--;)this.doDamage(t,this.getPos(e),o,a);c-this.lastHitTime>=this.hitCooldown&&(p.AudioMgr.getInstance().playEffect(h.DRA_AudioId.dragonHit,h.DRA_AudioId.dragonHit),this.lastHitTime=c)},e.prototype.getPos=function(t){var e=d.Utils.randomRang(-30,30),o=d.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(h.emDRAEventName.blood,t,e,o,i),this.label.string=Math.max(this.hp,0).toString(),this.otherNodes.forEach(function(t){t.getComponent(m.default).doDamage()})},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.targetNode.parent.convertToWorldSpaceAR(this.targetNode.position),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.doDie=function(){var t=this;p.AudioMgr.getInstance().playEffectFree(h.DRA_AudioId.burn,6),this.isDie=!0,this.node.active=!1,this.otherNodes.forEach(function(e,o){t.scheduleOnce(function(){e.active=!1,e.getComponent(m.default).informPre(),o%2&&e.getComponent(m.default).playDestory()},.05*o)}),this.isLast&&(this.sendEvent(h.emDRAEventName.pause),this.openUI(h.DRA_UIID.UIResult,!0)),this.spawnBuffItem()},e.prototype.spawnBuffItem=function(){this.isCreate||(this.isCreate=!0,this.sendEvent(h.emDRAEventName.buff,this.boxIndex))},e.prototype.update=function(){this.targetNode&&!this.isDie&&this.node.setPosition(this.targetNode.position)},c([v(cc.Label)],e.prototype,"label",void 0),c([v(cc.Sprite)],e.prototype,"boxSp",void 0),c([v(cc.SpriteFrame)],e.prototype,"boxSpArr",void 0),c([y],e)}(l.default);a.default=_,cc._RF.pop(),cc._RF.pop()},{}],buttomBaseNode:[function(t,e,o){"use strict";cc._RF.push(e,"81453R2Sl5Fs7UNzzs2V2/E","buttomBaseNode");var i=t,n=e,a=o;cc._RF.push(n,"81453R2Sl5Fs7UNzzs2V2/E","buttomBaseNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initParam=function(t,e,o,i,n,a){this.node.x=t,this.speed=e,this.leftBoundary=i,this.rightBoundary=n,this.doorType=a,this.initView(),this.initScale(o),this.initBoundary()},e.prototype.initView=function(){},e.prototype.initScale=function(){},e.prototype.initBoundary=function(){},e.prototype.changeSpeed=function(t){var e=this.node.x+this.speed*t,o=Math.abs(this.speed);e>=this.rightBoundary&&(this.speed=-o),e<=this.leftBoundary&&(this.speed=o)},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.changeSpeed(t),this.node.getComponent(cc.RigidBody).linearVelocity=new cc.Vec2(this.speed,0)},c([u],e)}(l.default));a.default=d,cc._RF.pop(),cc._RF.pop()},{}],buttomCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"e6265v0oKxFX6mE5AInRNW9","buttomCtrl");var i=t,n=e,a=o;cc._RF.push(n,"e6265v0oKxFX6mE5AInRNW9","buttomCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("Utils"),u=i("NodeLib"),d=i("SODGameEnumData"),h=i("SOD_DataMgr"),f=i("buttomDoorNode"),m=i("buttomObstacleNode"),g=i("buttomFactor"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buttomDoorArr=[],e.buttomObstacleArr=[],e.pro_factory=null,e.pro_leftBoundary=null,e.pro_rightBoundary=null,e.pro_doorLayer=null,e.pro_obstacleLayer=null,e.pro_leftWall=null,e.pro_rightWall=null,e.sod_gameCtrl=null,e}return s(e,t),e.prototype.initCtrl=function(t){this.sod_gameCtrl=t},e.prototype.getGameCtrl=function(){return this.sod_gameCtrl},e.prototype.initProperty=function(){this.pro_factory=u.default.findChildByName(this.node,"factory"),this.pro_leftBoundary=u.default.findChildByName(this.node,"leftBoundary"),this.pro_rightBoundary=u.default.findChildByName(this.node,"rightBoundary"),this.pro_doorLayer=u.default.findChildByName(this.node,"doorLayer"),this.pro_obstacleLayer=u.default.findChildByName(this.node,"obstacleLayer"),this.pro_leftWall=u.default.findChildByName(this.node,"pro_leftWall"),this.pro_rightWall=u.default.findChildByName(this.node,"pro_rightWall"),this.pro_leftWall.getComponent(cc.PhysicsPolygonCollider).friction=h.default.getInstance().getParam(d.enumBasicParaCfg.frictionPara),this.pro_leftWall.getComponent(cc.PhysicsPolygonCollider).restitution=h.default.getInstance().getParam(d.enumBasicParaCfg.elasticityPara),this.pro_rightWall.getComponent(cc.PhysicsPolygonCollider).friction=h.default.getInstance().getParam(d.enumBasicParaCfg.frictionPara),this.pro_rightWall.getComponent(cc.PhysicsPolygonCollider).restitution=h.default.getInstance().getParam(d.enumBasicParaCfg.elasticityPara)},e.prototype.showInWeb=function(){this.pro_leftBoundary.active=!1,this.pro_rightBoundary.active=!1},e.prototype.initAllButtomNode=function(){for(var t in this.pro_doorLayer.children){var e=Number(t)+1,o=h.default.getInstance().getBuffPositionCfgByIndex(e),i=this.pro_doorLayer.children[t].getComponent(f.default),n=this.getRandomX(),a=o.doorMove;i.initParam(n,a,o.doorLength,this.pro_leftBoundary.x,this.pro_rightBoundary.x,o.doorType),this.buttomDoorArr.push(i)}for(var t in this.pro_obstacleLayer.children){var r=void 0;0==(e=Number(t))?r=h.default.getInstance().getParam(d.enumBasicParaCfg.barrierOne):1==e?r=h.default.getInstance().getParam(d.enumBasicParaCfg.barrierTwo):2==e&&(r=h.default.getInstance().getParam(d.enumBasicParaCfg.barrierThree));var s=Number(r.split(",")[0]),c=Number(r.split(",")[1]),l=this.pro_obstacleLayer.children[t].getComponent(m.default);l.initParam(this.getRandomX(),s,c,this.pro_leftBoundary.x,this.pro_rightBoundary.x),this.buttomObstacleArr.push(l)}this.pro_factory.getComponent(g.default).initParam(this.pro_leftBoundary.x,this.pro_rightBoundary.x,this)},e.prototype.moveAllButtomNode=function(t){this.buttomDoorArr.forEach(function(e){e.onUpdate(t)}),this.buttomObstacleArr.forEach(function(e){e.onUpdate(t)})},e.prototype.checkIntersect=function(t,e){for(var o=0;o<this.buttomDoorArr.length;o++)if(o!=t){var i=this.buttomDoorArr[o].node,n=this.buttomDoorArr[o];if(this.isIntersect(e,i))return 10*o+n.getDoorType()}return-1},e.prototype.isIntersect=function(t,e){var o=e.getComponent(f.default).getColliderWidth()/2,i=t.position,n=e.position,a=Math.abs(i.x-n.x),r=Math.abs(i.y-n.y);return a<=o&&r<=50},e.prototype.getRandomX=function(){return p.Utils.randomRang(this.pro_leftBoundary.x+150,this.pro_rightBoundary.x-150)},e.prototype.initListen=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.pro_factory.getComponent(g.default).doMove(e.getDeltaX())}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.pro_factory.getComponent(g.default).createSoilder()})},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){this.showInWeb(),this.initAllButtomNode(),this.initListen()},e.prototype.onUpdate=function(t){this.moveAllButtomNode(t),this.pro_factory.getComponent(g.default).onUpdate(t)},c([v],e)}(l.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],buttomDoorNode:[function(t,e,o){"use strict";cc._RF.push(e,"4c25aAeIcxPZ7LHS8MjK7db","buttomDoorNode");var i=t,n=e,a=o;cc._RF.push(n,"4c25aAeIcxPZ7LHS8MjK7db","buttomDoorNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("NodeLib"),p=i("SOD_DataMgr"),u=i("gameLib"),d=i("buttomBaseNode"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_doorSpNode=null,e.pro_leftNode=null,e.pro_rightNode=null,e.baseWidth=0,e}return s(e,t),e.prototype.initProperty=function(){this.pro_doorSpNode=this.node.getChildByName("doorSp"),this.pro_leftNode=this.node.getChildByName("left"),this.pro_rightNode=this.node.getChildByName("right")},e.prototype.initView=function(){t.prototype.initView.call(this);var e=p.default.getInstance().getBuffTypeCfgByType(this.doorType),o=l.default.getChildSprite(this.pro_doorSpNode,"itemIcon");l.default.getChildLabel(this.pro_doorSpNode,"itemName").string=e.buffName,o.spriteFrame=u.default.instance.getDoorSpByName(e.buffIcon),this.pro_doorSpNode.getComponent(cc.Sprite).spriteFrame=u.default.instance.getDoorSpByName(e.buffBack),this.pro_leftNode.getComponent(cc.Sprite).spriteFrame=u.default.instance.getDoorSpByName(e.buffSword),this.pro_rightNode.getComponent(cc.Sprite).spriteFrame=u.default.instance.getDoorSpByName(e.buffSword)},e.prototype.getDoorType=function(){return this.doorType},e.prototype.getColliderWidth=function(){return this.baseWidth},e.prototype.initScale=function(t){var e=5*t;this.baseWidth=e,this.pro_doorSpNode.width=this.baseWidth,this.pro_leftNode.x=-e/2,this.pro_rightNode.x=e/2},e.prototype.initBoundary=function(){var t=this.baseWidth/2+10;this.leftBoundary+=t,this.rightBoundary-=t},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(e){t.prototype.onUpdate.call(this,e)},c([f],e)}(d.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],buttomFactor:[function(t,e,o){"use strict";cc._RF.push(e,"eead8rRyt1Au4io0tB0T2eJ","buttomFactor");var i=t,n=e,a=o;cc._RF.push(n,"eead8rRyt1Au4io0tB0T2eJ","buttomFactor");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("NodeLib"),h=i("SOD_Configs"),f=i("SODGameEnumData"),m=i("SOD_DataMgr"),g=i("SOD_UIGame"),y=i("topCtrl"),v=i("itemCircle"),_=cc._decorator,b=_.ccclass,B=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemArr=[],e.itemNum=0,e}return s(e,t),e.prototype.initProperty=function(){this.pro_progress=d.default.getChildSprite(this.node,"progress"),this.pro_item=d.default.findChildByName(this.node,"pro_item")},e.prototype.initParam=function(t,e,o){this.soldierMadeTime=m.default.getInstance().getParam(f.enumBasicParaCfg.soldierMadeTime),this.nowMadeTime=0;var i=this.node.width*this.node.scaleX/2;this.leftBoundary=t+i,this.rightBoundary=e-i,this.buttomCtrl=o},e.prototype.doMove=function(t){var e=this.node.x+t;e>this.rightBoundary||e<this.leftBoundary||(this.node.x=e)},e.prototype.createSoilder=function(){if(!(this.itemNum<=0)){this.itemNum--,this.refreshItemNum(),p.AudioMgr.getInstance().playEffect(h.SOD_AudioId.treasure);var t=u.PoolMgr.getInstance().getNode(h.SOD_PoolName.itemCircle);t.getComponent(cc.RigidBody).gravityScale=m.default.getInstance().getParam(f.enumBasicParaCfg.gravityPara);var e=g.default.instance.getButtomItemLayer();t.parent=e;var o=this.node.convertToWorldSpaceAR(new cc.Vec2(0,0));t.setPosition(e.convertToNodeSpaceAR(o));var i=t.getComponent(v.default);i.initParam(1),this.itemArr.push(i)}},e.prototype.addProgress=function(t){this.itemNum>=this.pro_item.children.length||(this.nowMadeTime+=t,this.nowMadeTime>=this.soldierMadeTime&&(this.itemNum++,this.refreshItemNum(),this.nowMadeTime=0),this.pro_progress.fillRange=this.nowMadeTime/this.soldierMadeTime)},e.prototype.refreshItemNum=function(){for(var t in this.itemNum=Math.min(this.itemNum,this.pro_item.children.length),this.itemNum=Math.max(this.itemNum,0),this.pro_item.children)parseInt(t)+1<=this.itemNum?this.pro_item.children[t].active=!0:this.pro_item.children[t].active=!1},e.prototype.checkCollider=function(){for(var t in this.itemArr){var e=this.itemArr[t],o=e.getColliderIndex(),i=e.node,n=this.buttomCtrl.checkIntersect(o,i);if(-1!=n){var a=n%10,r=(n-a)/10;e.setColliderIndex(r),this.handleDoorType(e,a)}}},e.prototype.handleDoorType=function(t,e){p.AudioMgr.getInstance().playEffect(h.SOD_AudioId.levelup);var o=m.default.getInstance().getBuffTypeCfgByType(e),i=t.getGrade(),n=t.getColliderIndex(),a=t.node;if(e==h.buffType.upGrade){if(t.getGrade()>=m.default.getInstance().getSoilderCfg().length)return;t.addGrade()}else if(e==h.buffType.addAttack)t.addExtraPower(o.buffPara1);else if(e==h.buffType.addNum){var r=u.PoolMgr.getInstance().getNode(h.SOD_PoolName.itemCircle);r.parent=a.parent,r.position=a.position;var s=r.getComponent(v.default);this.itemArr.push(s),s.initParam(i,n)}t.showSpAni()},e.prototype.getItemArr=function(){return this.itemArr},e.prototype.resetItemCircleColliderTime=function(t){for(var e in this.itemArr)this.itemArr[e].onUpdate(t)},e.prototype.checkDestosyItemCircle=function(){for(var t in this.itemArr){var e=this.itemArr[t];this.willDestroy(e.node)&&(e.doDestroy(),this.buttomCtrl.getGameCtrl().gameTopCtrl.getComponent(y.default).addItem(e),this.itemArr.splice(parseInt(t),1))}},e.prototype.willDestroy=function(t){var e=t.position,o=g.default.instance.getItemDestroyPos();return e.y<o.y},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.addProgress(t),this.checkCollider(),this.checkDestosyItemCircle(),this.resetItemCircleColliderTime(t)},c([b],e)}(l.default));a.default=B,cc._RF.pop(),cc._RF.pop()},{}],buttomObstacleNode:[function(t,e,o){"use strict";cc._RF.push(e,"79cd1S7wFBGiomTsqmmxlf2","buttomObstacleNode");var i=t,n=e,a=o;cc._RF.push(n,"79cd1S7wFBGiomTsqmmxlf2","buttomObstacleNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("SODGameEnumData"),p=i("SOD_DataMgr"),u=i("buttomBaseNode"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initParam=function(e,o,i,n,a,r){t.prototype.initParam.call(this,e,o,i,n,a,r)},e.prototype.initScale=function(t){this.node.scale=t,this.node.getComponent(cc.PhysicsBoxCollider).apply()},e.prototype.initBoundary=function(){var t=this.node.width*this.node.scale/2;this.leftBoundary+=t,this.rightBoundary-=t},e.prototype.onLoad=function(){},e.prototype.start=function(){this.node.getComponent(cc.PhysicsBoxCollider).friction=p.default.getInstance().getParam(l.enumBasicParaCfg.frictionPara),this.node.getComponent(cc.PhysicsBoxCollider).restitution=p.default.getInstance().getParam(l.enumBasicParaCfg.elasticityPara)},c([h],e)}(u.default));a.default=f,cc._RF.pop(),cc._RF.pop()},{}],common_Configs:[function(t,e,o){"use strict";cc._RF.push(e,"bf0a1GdL7RCi4PlPUAi+cQ7","common_Configs");var i,n,a=t,r=e,s=o;cc._RF.push(r,"bf0a1GdL7RCi4PlPUAi+cQ7","common_Configs"),Object.defineProperty(s,"__esModule",{value:!0}),s.subGameTextCfg=s.COMMON_AudioCF=s.COMMON_AudioId=s.commonConfig=s.commonGameState=s.Common_PoolName=s.Common_EventName=s.Common_UICF=s.CommonBundles=s.Common_UIID=void 0;var c,l,p,u=a("Appcfg");(function(t){t.UIResult="Common_UIResult",t.UIPause="Comon_UiPause",t.UIGameView="Common_UIGameView",t.GameButtom="Common_GameButtom"})(c=s.Common_UIID||(s.Common_UIID={})),function(t){t.prefabs="common_prefabs",t.audios="common_audios"}(l=s.CommonBundles||(s.CommonBundles={})),s.Common_UICF=((i={})[c.UIResult]={prefab:"ui/COMMON_UIResult",name:"COMMON_UIResult",showTop:!0,showMult:!1,zIndex:u.OrderLayer.top,bundleName:l.prefabs},i[c.UIPause]={prefab:"ui/COMMON_UIPause",name:"COMMON_UIPause",showTop:!0,showMult:!1,zIndex:u.OrderLayer.top,bundleName:l.prefabs},i[c.UIGameView]={prefab:"ui/Common_UIGameView",name:"Common_UIGameView",showTop:!0,showMult:!1,zIndex:u.OrderLayer.main,bundleName:l.prefabs},i[c.GameButtom]={prefab:"ui/Common_UIButtom",name:"Common_UIButtom",showTop:!0,showMult:!1,zIndex:u.OrderLayer.main+1,bundleName:l.prefabs},i),function(t){t.common_loseBlood="common_loseBlood",t.common_screenShake="common_screenShake",t.common_warn="common_warn"}(s.Common_EventName||(s.Common_EventName={})),(s.Common_PoolName||(s.Common_PoolName={})).com_blood="com_blood",function(t){t.playing="playing",t.puase="pause"}(s.commonGameState||(s.commonGameState={})),s.commonConfig={bgMusic:"KinghtFallBG"},function(t){t.bgm="bgm",t.victory="victory",t.fail="fail"}(p=s.COMMON_AudioId||(s.COMMON_AudioId={})),s.COMMON_AudioCF=((n={})[p.bgm]={path:"bgm",bundle:l.audios},n[p.victory]={path:"victory",bundle:l.audios},n[p.fail]={path:"fail",bundle:l.audios},n),function(t){t.subTips="\u7b2c{0}\u7ae0\u89e3\u9501\u672c\u73a9\u6cd5",t.subDesc="\u7b2c\u56db\u7ae0\u89e3\u9501"}(s.subGameTextCfg||(s.subGameTextCfg={})),cc._RF.pop(),cc._RF.pop()},{}],director:[function(t,e){"use strict";cc._RF.push(e,"cfb67V6emdO+Ix0sO+/GlI7","director");var o=e;cc._RF.push(o,"cfb67V6emdO+Ix0sO+/GlI7","director"),cc._RF.pop(),cc._RF.pop()},{}],fireNode:[function(t,e,o){"use strict";cc._RF.push(e,"0f0d9nFgDhHQpBc5RrZYOOE","fireNode");var i=t,n=e,a=o;cc._RF.push(n,"0f0d9nFgDhHQpBc5RrZYOOE","fireNode");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseUI"),p=i("AudioMgr"),u=i("Utils"),d=i("BALL_Configs"),h=i("BALL_UIGame"),f=i("BALL_Body"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aimY=0,e.nodeActive=!0,e.inDestroy=!1,e.fireEffectTime=3,e.nowTime=0,e}return s(e,t),e.prototype.initParam=function(t,e){this.inDestroy=!1,this.hpNum=Math.floor(t),this.speed=e,this.aimY=h.default.script.getWallPosY(),p.AudioMgr.getInstance().playEffect(d.BALL_AudioId.fireball,"fireBall"),this.nodeActive=!0,this.initView()},e.prototype.initView=function(){this.node.getComponent(sp.Skeleton).setAnimation(0,"animation",!0),this.hpLabel.string=this.hpNum.toString()},e.prototype.doDestroy=function(){var t=this;f.default.script.fireNodeDestroy(),this.node.active=!1,this.nodeActive=!1,this.scheduleOnce(function(){t.node.removeFromParent()},1)},e.prototype.checkSkillCollider=function(t,e){this.hpNum<=0||t.intersects(this.getWorldColldierRect())&&this.handleDamage(e,this.node.getPosition(),!1,1,!1,!0)},e.prototype.getWorldColldierRect=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var o=this.node.getAnchorPoint(),i=this.node.parent.convertToWorldSpaceAR(this.node.getPosition()),n=(this.node.width+t)*this.node.scaleX,a=(this.node.height+e)*this.node.scaleY;return cc.rect(i.x-o.x*n,i.y-o.y*a,n,a)},e.prototype.checkCollider=function(t){return!(this.hpNum<=0||!this.isInRange(t))},e.prototype.isInRange=function(t){var e=this.node.position;return Math.abs(t.x-e.x)<=150&&Math.abs(t.y-e.y)<=150},e.prototype.handleDamage=function(t,e,o,i,n,a){void 0===o&&(o=!1),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===a&&(a=!1);var r=1,s=t;if(n&&(s=i*t,r=i),this.hpNum-=s,this.hpNum<=0)this.sendEvent(d.emBALLEventName.blood,t,this.getPos(e),o),this.doDestroy();else for(;r--;)this.doDamage(t,this.getPos(e),o,a)},e.prototype.doDamage=function(t,e,o,i){void 0===e&&(e=null),void 0===o&&(o=!1),void 0===i&&(i=!1),this.sendEvent(d.emBALLEventName.blood,t,e,o,i),this.hpLabel.string=Math.max(this.hpNum,0).toString()},e.prototype.getPos=function(t){var e=u.Utils.randomRang(-30,30),o=u.Utils.randomRang(-30,30);return t.x+=e,t.y+=o,t},e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.node.y-=this.speed*t,this.nodeActive&&(this.nowTime+=t,this.nowTime>=this.fireEffectTime&&(this.nowTime=0,p.AudioMgr.getInstance().playEffect(d.BALL_AudioId.fireball,"fireBall")),this.node.y-this.node.height/2<this.aimY&&(this.sendEvent(d.emBALLEventName.pause),this.openUI(d.BALL_UIID.UIResult)))},c([y(cc.Label)],e.prototype,"hpLabel",void 0),c([g],e)}(l.default);a.default=v,cc._RF.pop(),cc._RF.pop()},{}],fly_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"5c0b6fywpxOqbNAMVF0/X2C","fly_GameData");var i=e,n=o;cc._RF.push(i,"5c0b6fywpxOqbNAMVF0/X2C","fly_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emfly_GameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffMapCfg="buffMapCfg",t.buffOddsEnCfg="buffOddsEnCfg",t.buffOddsCfg="buffOddsCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.levelRedCfg="levelRedCfg",t.levelCfg="levelCfg",t.mateOddsCfg="mateOddsCfg",t.mateOddsEnCfg="mateOddsEnCfg",t.mateCfg="mateCfg",t.motionCfg="motionCfg"}(n.emfly_GameDataKeys||(n.emfly_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],fly_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"ebccfDUOXREHa9kr75symS+","fly_GameEnumData");var i=e,n=o;cc._RF.push(i,"ebccfDUOXREHa9kr75symS+","fly_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.girlMoveSpeed=15]="girlMoveSpeed",t[t.wordsTime=16]="wordsTime",t[t.wordShow=17]="wordShow",t[t.dieWordDistance=18]="dieWordDistance",t[t.girlPosition=19]="girlPosition",t[t.dragonMoveAmniTime=20]="dragonMoveAmniTime",t[t.tipsStayTime=21]="tipsStayTime",t[t.ballFlySpeed=22]="ballFlySpeed",t[t.changeLimit=23]="changeLimit",t[t.sunsxLimit=24]="sunsxLimit",t[t.moveSpeedRed=5]="moveSpeedRed",t[t.dragonMoveAmniRed=13]="dragonMoveAmniRed",t[t.dragonMoveAmniTimeRed=20]="dragonMoveAmniTimeRed"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],fly_buttomCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"835f4HQN+lJKLsoB7Vabytw","fly_buttomCtrl");var i=t,n=e,a=o;cc._RF.push(n,"835f4HQN+lJKLsoB7Vabytw","fly_buttomCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NodeLib"),u=i("FLY_Configs"),d=i("FLY_HeroItem"),h=i("FLY_BuffCtrl"),f=i("FLY_HeroCtrl"),m=i("FLY_MateSkillCtrl"),g=i("FLY_TarmCtrl"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_heroCtrl=null,e.pro_enemyCtrl=null,e.pro_tarmCtrl=null,e.pro_buffCtrl=null,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_heroCtrl=p.default.findChildByName(this.node,"pro_heroCtrl").getComponent(f.default),this.pro_enemyCtrl=p.default.findChildByName(this.node,"pro_enemyCtrl").getComponent(f.default),this.pro_tarmCtrl=p.default.findChildByName(this.node,"pro_tarmCtrl").getComponent(g.default),this.pro_buffCtrl=p.default.findChildByName(this.node,"pro_buffCtrl").getComponent(h.default),this.pro_mateSkillCtrl=p.default.findChildByName(this.node,"pro_mateSkillCtrl").getComponent(m.default)},e.prototype.initParam=function(){this.pro_heroCtrl.initCamp(u.belongCamp.hero),this.pro_enemyCtrl.initCamp(u.belongCamp.enemy),this.pro_heroCtrl.addFirstHero(),this.pro_enemyCtrl.addFirstHero()},e.prototype.testAddHero=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in this.pro_heroCtrl.getHeroList())this.pro_heroCtrl.getHeroList()[o].getComponent(d.default).modifyAttribute(u.emFLYBuffType.ATKmul,2,4);else if("speed"==e)for(var o in this.pro_heroCtrl.getHeroList())this.pro_heroCtrl.getHeroList()[o].getComponent(d.default).modifyAttribute(u.emFLYBuffType.speedPlus,2,4);else if("penerate"==e)for(var o in this.pro_heroCtrl.getHeroList())this.pro_heroCtrl.getHeroList()[o].getComponent(d.default).modifyAttribute(u.emFLYBuffType.penetratePlus,2,4)}else this.pro_heroCtrl.addHero(Number(e))},e.prototype.getHeroCtrl=function(){return this.pro_heroCtrl},e.prototype.getEnemyCtrl=function(){return this.pro_enemyCtrl},e.prototype.getBuffCtrl=function(){return this.pro_buffCtrl},e.prototype.getTarmCtrl=function(){return this.pro_tarmCtrl},e.prototype.getMateSkillCtrl=function(){return this.pro_mateSkillCtrl},e.prototype.moveHero=function(t){this.pro_heroCtrl.moveHero(t)},e.prototype.onLoad=function(){var t=this;this.initPorperty(),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.moveHero(e.getDelta().x)})},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.pro_heroCtrl.onUpdate(t),this.pro_enemyCtrl.onUpdate(t),this.pro_tarmCtrl.onUpdate(t),this.pro_buffCtrl.onUpdate(t)},c([v],e)}(l.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],fly_gameCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"aed71nI6F9J4ofPsnj36Tqo","fly_gameCtrl");var i=t,n=e,a=o;cc._RF.push(n,"aed71nI6F9J4ofPsnj36Tqo","fly_gameCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.boundary=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("NodeLib"),d=i("FLY_Configs"),h=i("FLY_DataMgr"),f=i("fly_buttomCtrl"),m=i("fly_topCtrl"),g=function(){};a.boundary=g;var y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_dieNode=null,e.pro_gmNode=null,e.pro_topCtrl=null,e.pro_buttomCtrl=null,e.pro_bulletLayer=null,e.pro_fence=null,e.pro_start=null,e.bulletBoundary=null,e.poolNum=0,e}var o;return s(e,t),o=e,e.prototype.initProperty=function(){this.pro_topCtrl=u.default.findChildByName(this.node,"pro_topCtrl").getComponent(m.default),this.pro_buttomCtrl=u.default.findChildByName(this.node,"pro_buttomCtrl").getComponent(f.default),this.pro_start=u.default.findChildByName(this.node,"pro_start"),this.pro_gmNode=u.default.findChildByName(this.node,"gmButton");var t=u.default.findChildByName(this.node,"root");this.pro_bulletLayer=u.default.findChildByName(t,"bulletLayer"),this.pro_fence=u.default.findChildByName(t,"pro_fence"),this.pro_dieNode=u.default.findChildByName(t,"pro_dieNode"),this.gameState=d.emFLYGameState.None},e.prototype.initEventListen=function(){this.addEvent(d.emFLYEventName.pause,this.onGamePause),this.addEvent(d.emFLYEventName.resume,this.onGameResume)},e.prototype.getBullletLayerByHeroIndex=function(t){for(var e=this.pro_bulletLayer.children,o=0;o<e.length;o++)if(e[o].name=="layer"+t)return e[o]},e.prototype.getPro_topCtrl=function(){return this.pro_topCtrl},e.prototype.getPro_buttomCtrl=function(){return this.pro_buttomCtrl},e.prototype.getBulletBoundary=function(){return this.bulletBoundary},e.prototype.openGmButtom=function(){this.pro_gmNode.active=!0},e.prototype.getPro_dieNode=function(){return this.pro_dieNode.getComponent(cc.Widget).updateAlignment(),this.pro_dieNode},e.prototype.getPro_dieNodeGapY=function(){var t=this.pro_dieNode.y;return this.pro_dieNode.getComponent(cc.Widget).updateAlignment(),this.pro_dieNode.y-t},e.prototype.initPool=function(){var t=this,e=h.default.getInstance().getCharacter();this.poolNum+=2*e.length;var o=function(o){var n=e[o].characterID;if(i.loadPrefab(d.emFLYBundles.prefabs,"item/bullets/FLY_Bullet_"+n,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.bulletName+n,e),t.startGame()}),14==n)return i.poolNum--,"continue";i.loadPrefab(d.emFLYBundles.prefabs,"item/skills/CardSkill"+n,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.CardSkill+n,e),t.startGame()})},i=this;for(var n in e)o(n);var a=function(e){r.poolNum++,r.loadPrefab(d.emFLYBundles.prefabs,"item/skills/"+d.poolName.MateSkill+e,function(o){p.PoolMgr.getInstance().creatrePool(d.poolName.MateSkill+e,o),t.startGame()})},r=this;for(n=1;n<=7;n++)a(n);this.poolNum+=5,this.loadPrefab(d.emFLYBundles.prefabs,"item/dragon/body",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body,e),t.startGame()}),this.loadPrefab(d.emFLYBundles.prefabs,"item/dragon/"+d.poolName.body_blood,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body_blood,e),t.startGame()}),this.loadPrefab(d.emFLYBundles.prefabs,"item/"+d.poolName.body_destroy,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body_destroy,e),t.startGame()}),this.loadPrefab(d.emFLYBundles.prefabs,"item/enemy_hit_fps",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.effect,e),t.startGame()}),this.loadPrefab(d.emFLYBundles.prefabs,"item/bullets/FLY_Bullet_skill",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.Bullet_skill,e),t.startGame()})},e.prototype.initBulletBoundary=function(){this.pro_fence.getComponent(cc.Widget).updateAlignment(),this.bulletBoundary=new g;var t=cc.winSize;this.bulletBoundary.upBoundary=t.height/2,this.bulletBoundary.leftBoundary=-t.width/2,this.bulletBoundary.rightBoundary=t.width/2,this.bulletBoundary.downBoundary=this.pro_fence.y-50},e.prototype.startGame=function(){this.poolNum--,0==this.poolNum&&this.gameState==d.emFLYGameState.None&&(this.gameState=d.emFLYGameState.Game)},e.prototype.startGameView=function(){var t=this;this.pro_buttomCtrl.initParam(),this.pro_start.active=!0,this.pro_start.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.pro_start.getComponent(sp.Skeleton).setCompleteListener(function(){t.pro_start.active=!1,t.poolNum<=0&&t.gameState==d.emFLYGameState.None&&(t.gameState=d.emFLYGameState.Game)})},e.prototype.onGamePause=function(){this.gameState=d.emFLYGameState.Pause},e.prototype.onGameResume=function(){this.gameState=d.emFLYGameState.Game},e.prototype.onGameOver=function(){this.gameState=d.emFLYGameState.Over},e.prototype.getGameState=function(){return this.gameState},e.prototype.onLoad=function(){o.instance=this,this.initProperty(),this.initEventListen(),this.initBulletBoundary(),this.gameState=d.emFLYGameState.None},e.prototype.start=function(){this.initPool(),this.startGameView()},e.prototype.update=function(t){this.gameState==d.emFLYGameState.Game&&(this.pro_topCtrl.onUpdate(t),this.pro_buttomCtrl.onUpdate(t))},e.instance=null,o=c([v],e)}(l.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],fly_topCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"6247ciHLZhIu4crcuQBI1NN","fly_topCtrl");var i=t,n=e,a=o;cc._RF.push(n,"6247ciHLZhIu4crcuQBI1NN","fly_topCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NodeLib"),u=i("FLY_Configs"),d=i("FLY_DragonCtrl"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_enemyCtrl=null,e.pro_ourCtrl=null,e.pro_enemyBar=null,e.pro_ourBar=null,e.pro_Ani=null,e.createPathLineNum=6,e.allHeight=0,e.baseY=0,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_enemyCtrl=p.default.findChildByName(this.node,"pro_enemyCtrl").getComponent(d.default),this.pro_ourCtrl=p.default.findChildByName(this.node,"pro_ourCtrl").getComponent(d.default),this.pro_enemyBar=p.default.findChildByName(this.node,"pro_enemyBar").getComponent(cc.Sprite),this.pro_ourBar=p.default.findChildByName(this.node,"pro_ourBar").getComponent(cc.Sprite),this.pro_Ani=p.default.findChildByName(this.node,"pro_Ani")},e.prototype.initParam=function(){this.allHeight=444,this.baseY=67;var t=cc.view.getVisibleSize(),e=t.width>1e3?1e3:t.width,o=t.height>1334?1334:t.height,i=new cc.Vec2(e/2,o/2),n=new cc.Vec2(0,0),a=new cc.Vec2(-e/2,-o/2),r=this.createPath(a,n,this.createPathLineNum,e),s=this.createPath(i,n,this.createPathLineNum,e);this.pro_enemyCtrl.initParam(!0,s),this.pro_ourCtrl.initParam(!1,r)},e.prototype.testChangeSpeed=function(t,e){this.getDragonCtrlByCamp(u.belongCamp.hero).testChangeSpeed(e)},e.prototype.testChangeEnemySpeed=function(t,e){this.getDragonCtrlByCamp(u.belongCamp.enemy).testChangeSpeed(e)},e.prototype.getDragonCtrlByCamp=function(t){return t==u.belongCamp.hero?this.pro_enemyCtrl:this.pro_ourCtrl},e.prototype.createPath=function(t,e,o,i){for(var n=[],a=(e.y-t.y)/(o-1),r=t.x,s=t.x>0?-1:1,c=0;c<o;c++){var l=new cc.Vec2(r,t.y+c*a);if(0==c&&(l.x=l.x-200*s),n.push(l),c==o-1){n.push(e.clone());break}r+=s*i;var p=new cc.Vec2(r,t.y+c*a);s*=-1,n.push(p)}for(c=2;c<n.length;c+=2){var u=n[c].x>0?1:-1,d=new cc.Vec2(n[c].x+50*u,n[c].y-a/2);n.splice(c,0,d),c++}return n},e.prototype.changeBarWidth=function(){var t=this.pro_enemyCtrl.getDragonPercent(),e=this.pro_ourCtrl.getDragonPercent()-t;this.pro_Ani.y=this.baseY+this.allHeight*e/2,this.pro_ourBar.fillRange=.5+e/2,this.pro_ourBar.fillRange=this.pro_ourBar.fillRange>1?1:this.pro_ourBar.fillRange,this.pro_ourBar.fillRange=this.pro_ourBar.fillRange<0?0:this.pro_ourBar.fillRange,this.pro_enemyBar.fillStart=this.pro_ourBar.fillRange},e.prototype.onLoad=function(){this.initPorperty()},e.prototype.start=function(){this.initParam()},e.prototype.onUpdate=function(t){this.pro_enemyCtrl.onUpdate(t),this.pro_ourCtrl.onUpdate(t),this.changeBarWidth()},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],gameLib:[function(t,e,o){"use strict";cc._RF.push(e,"55177f/T11Nw4AYt5g1VBxV","gameLib");var i=t,n=e,a=o;cc._RF.push(n,"55177f/T11Nw4AYt5g1VBxV","gameLib");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=cc._decorator,u=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spArr=[],e}var o;return s(e,t),o=e,e.prototype.getDoorSpByName=function(t){for(var e in this.spArr)if(this.spArr[e].name==t)return this.spArr[e]},e.prototype.onLoad=function(){o.instance=this},e.prototype.start=function(){},c([d(cc.SpriteFrame)],e.prototype,"spArr",void 0),o=c([u],e)}(l.default);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],hold_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"20230a7G51FUqbCXVQhzdqI","hold_GameData");var i=e,n=o;cc._RF.push(i,"20230a7G51FUqbCXVQhzdqI","hold_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emhold_GameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.enemyCfg="enemyCfg",t.leftTreasureCfg="leftTreasureCfg",t.levelCfg="levelCfg",t.rightTreasureCfg="rightTreasureCfg",t.weaponCfg="weaponCfg"}(n.emhold_GameDataKeys||(n.emhold_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],hold_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"f9259lypqpI5oGAaJF5Hh95","hold_GameEnumData");var i=e,n=o;cc._RF.push(i,"f9259lypqpI5oGAaJF5Hh95","hold_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.bulletFlySpeed=4]="bulletFlySpeed",t[t.basicCrit=5]="basicCrit",t[t.critDamage=6]="critDamage",t[t.quake=7]="quake",t[t.speedPlusTimes=8]="speedPlusTimes",t[t.baseHP=9]="baseHP",t[t.speedleftDrop=10]="speedleftDrop",t[t.speedrightDrop=11]="speedrightDrop"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul",t.critDamPlus="critDamPlus",t.character="character"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],itemCircle:[function(t,e,o){"use strict";cc._RF.push(e,"93fe4dqC6lPG7cnpkEVgAeG","itemCircle");var i=t,n=e,a=o;cc._RF.push(n,"93fe4dqC6lPG7cnpkEVgAeG","itemCircle");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("NodeLib"),d=i("SOD_Configs"),h=i("SODGameEnumData"),f=i("SOD_DataMgr"),m=i("gameLib"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.grade=1,e.extraPower=0,e.colliderIndex=-1,e.colliderTime=3,e.nowColliderTime=3,e.maxLevel=0,e}return s(e,t),e.prototype.initProperty=function(){this.pro_itemSp=u.default.getChildSprite(this.node,"itemSp"),this.pro_itemBg=u.default.getChildSprite(this.node,"itemBg"),this.pro_spAni=u.default.findChildByName(this.node,"spAni"),this.colliderTime=f.default.getInstance().getParam(h.enumBasicParaCfg.repeatBuffTime),this.node.getComponent(cc.RigidBody).angularVelocity=f.default.getInstance().getParam(h.enumBasicParaCfg.angularPara),this.maxLevel=f.default.getInstance().getSoilderCfg().length},e.prototype.initParam=function(t,e){void 0===e&&(e=-1),this.extraPower=0,this.grade=t,this.colliderIndex=e,this.nowColliderTime=this.colliderTime,this.pro_spAni.active=!1,this.refreshView()},e.prototype.addExtraPower=function(t){this.extraPower+=t},e.prototype.getExtraPower=function(){return this.extraPower},e.prototype.getGrade=function(){return this.grade},e.prototype.addGrade=function(){this.grade>=this.maxLevel||(this.grade++,this.refreshView())},e.prototype.showSpAni=function(){this.pro_spAni.active=!0,this.pro_spAni.getComponent(sp.Skeleton).setAnimation(0,"open",!1)},e.prototype.setColliderIndex=function(t){this.colliderIndex=t,this.nowColliderTime=this.colliderTime},e.prototype.getColliderIndex=function(){return this.colliderIndex},e.prototype.refreshView=function(){var t=f.default.getInstance().getSoilderCfgByID(this.grade);this.pro_itemSp.spriteFrame=m.default.instance.getDoorSpByName(t.eggImage),this.pro_itemBg.spriteFrame=m.default.instance.getDoorSpByName(t.eggShape)},e.prototype.upGrade=function(){},e.prototype.resetColliderIndex=function(t){this.nowColliderTime-=t,this.nowColliderTime<=0&&(this.colliderIndex=-1,this.nowColliderTime=this.colliderTime)},e.prototype.doDestroy=function(){p.PoolMgr.getInstance().freeNode(d.SOD_PoolName.itemCircle,this.node),this.pro_spAni.active=!1},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.resetColliderIndex(t)},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],itemCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"56739NfoMpH+Z595IXBj1xI","itemCtrl");var i=t,n=e,a=o;cc._RF.push(n,"56739NfoMpH+Z595IXBj1xI","itemCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("DARGameEnumData"),p=i("DRA_DataMgr"),u=i("DRA_Body"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sp=[],e.path=[],e.pathIndex=0,e.dragonSpeed=100,e.moveLock=!0,e}return s(e,t),e.prototype.changeSp=function(t){this.node.getComponentsInChildren(cc.Sprite)[1].spriteFrame=this.sp[t]},e.prototype.playAnimation=function(){},e.prototype.doMove=function(){this.moveLock=!1},e.prototype.pauseMove=function(){this.moveLock=!0},e.prototype.onLoad=function(){},e.prototype.start=function(){var t=u.default.script.getTurn(),e=t.x,o=t.y;this.path.push(new cc.Vec2(e,-o/4)),this.path.push(new cc.Vec2(-e,2*-o)),this.path.push(new cc.Vec2(-e,-o)),this.path.push(new cc.Vec2(e,4*-o)),this.dragonSpeed=p.default.getInstance().getParam(l.enumBasicParaCfg.moveSpeed),this.targetPos=this.path[0]},e.prototype.update=function(t){if(!this.moveLock){var e=this.targetPos,o=this.node.getPosition(),i=e.sub(o).normalize(),n=i.x*this.dragonSpeed*t,a=i.y*this.dragonSpeed*t;this.node.x+=n,this.node.y+=a,this.node.getPosition().fuzzyEquals(this.targetPos,2)&&(this.pathIndex++,this.targetPos=this.path[this.pathIndex%4])}},c([f(cc.SpriteFrame)],e.prototype,"sp",void 0),c([h],e)}(cc.Component);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],linePos:[function(t,e,o){"use strict";cc._RF.push(e,"938e4JgBURL0YBK7kNd5m9s","linePos");var i=e,n=o;cc._RF.push(i,"938e4JgBURL0YBK7kNd5m9s","linePos"),Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveLine=void 0;var a=function(){function t(){this.angle=90}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.init=function(t,e,o,i,n){this.focalLength=t,this.baseScale=e,this.startX=o,this.startY=i,this.vanishingPoint=n||{x:0,y:0}},t.prototype.getScreenPosition=function(t,e,o,i){void 0===i&&(i=1);var n=this.focalLength/(this.focalLength+o);return{x:(t-this.vanishingPoint.x)*n+this.vanishingPoint.x,y:(e-this.vanishingPoint.y)*n+this.vanishingPoint.y,scale:this.baseScale*n*i}},t}();n.PerspectiveLine=a,cc._RF.pop(),cc._RF.pop()},{}],logLib:[function(t,e,o){"use strict";cc._RF.push(e,"b072bHWOzdHXI6TdeV97SSu","logLib");var i=t,n=e,a=o;cc._RF.push(n,"b072bHWOzdHXI6TdeV97SSu","logLib");var r=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0}),a.MyLog=void 0;var s=i("BasePlatform"),c=i("PlatformSetting"),l=function(){function t(){}return t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(c.PlatformSetting.currentPlatform!=s.Platform.EDITOR);else{var o=(new Error).stack;if(console.log((new Error).name),console.log.apply(console,r(["Log from Editor: "],t)),o){var i=o.split("\n")[1],n=i.match(/(\S+\.ts:\d+)/);n&&console.log("%cFile Location:","color: green; font-weight: bold;",n[0])}}},t}();a.MyLog=l,cc._RF.pop(),cc._RF.pop()},{}],new_GameData:[function(t,e,o){"use strict";cc._RF.push(e,"1db026PnrtNJ4sqB2th4jti","new_GameData");var i=e,n=o;cc._RF.push(i,"1db026PnrtNJ4sqB2th4jti","new_GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.emnew_GameDataKeys=void 0,function(t){t.basicParaCfg="basicParaCfg",t.buffOddsCfg="buffOddsCfg",t.buffTypeCfg="buffTypeCfg",t.characterCfg="characterCfg",t.dragonBallShowCfg="dragonBallShowCfg",t.dragonBallCfg="dragonBallCfg",t.levelCfg="levelCfg",t.mahjongCfg="mahjongCfg",t.mateOddsCfg="mateOddsCfg",t.mateCfg="mateCfg",t.taskCfg="taskCfg"}(n.emnew_GameDataKeys||(n.emnew_GameDataKeys={})),cc._RF.pop(),cc._RF.pop()},{}],new_GameEnumData:[function(t,e,o){"use strict";cc._RF.push(e,"abe96/x09tH94+gYvvu0VKC","new_GameEnumData");var i=e,n=o;cc._RF.push(i,"abe96/x09tH94+gYvvu0VKC","new_GameEnumData"),Object.defineProperty(n,"__esModule",{value:!0}),n.enumBuffTypeCfg=n.enumBasicParaCfg=void 0,function(t){t[t.basicASPD=1]="basicASPD",t[t.basicATK=2]="basicATK",t[t.basicBullet=3]="basicBullet",t[t.basicPenetrate=4]="basicPenetrate",t[t.moveSpeed=5]="moveSpeed",t[t.bulletFlySpeed=6]="bulletFlySpeed",t[t.basicCrit=7]="basicCrit",t[t.critDamage=8]="critDamage",t[t.buffMove=9]="buffMove",t[t.secondCharATK=10]="secondCharATK",t[t.thirdCharATK=11]="thirdCharATK",t[t.quake=12]="quake",t[t.dragonMoveAmni=13]="dragonMoveAmni",t[t.speedPlusTimes=14]="speedPlusTimes",t[t.girlMoveSpeed=15]="girlMoveSpeed",t[t.wordsTime=16]="wordsTime",t[t.wordShow=17]="wordShow",t[t.dieWordDistance=18]="dieWordDistance",t[t.girlPosition=19]="girlPosition",t[t.dragonMoveAmniTime=20]="dragonMoveAmniTime",t[t.tipsStayTime=21]="tipsStayTime",t[t.ballFlySpeed=22]="ballFlySpeed",t[t.changeLimit=23]="changeLimit",t[t.sunsxLimit=24]="sunsxLimit"}(n.enumBasicParaCfg||(n.enumBasicParaCfg={})),function(t){t.SpeedPlus="speedPlus",t.SpeedSub="speedSub",t.ATKplus="ATKplus",t.ATKsub="ATKsub",t.ATKmul="ATKmul",t.ATKdiv="ATKdiv",t.BulletPlus="bulletPlus",t.Bulletsub="bulletsub",t.penetratePlus="penetratePlus",t.penetrateSub="penetrateSub",t.summonNew="summonNew",t.critPlus="critPlus",t.skillMul="skillMul"}(n.enumBuffTypeCfg||(n.enumBuffTypeCfg={})),cc._RF.pop(),cc._RF.pop()},{}],new_buttomCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"bb1bbdfJdtIzLN3s2Tx5A0p","new_buttomCtrl");var i=t,n=e,a=o;cc._RF.push(n,"bb1bbdfJdtIzLN3s2Tx5A0p","new_buttomCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("NodeLib"),u=i("NEW_Configs"),d=i("NEW_HeroItem"),h=i("NEW_BuffCtrl"),f=i("NEW_HeroCtrl"),m=i("NEW_TarmCtrl"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_heroCtrl=null,e.pro_tarmCtrl=null,e.pro_buffCtrl=null,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_heroCtrl=p.default.findChildByName(this.node,"pro_heroCtrl").getComponent(f.default),this.pro_tarmCtrl=p.default.findChildByName(this.node,"pro_tarmCtrl").getComponent(m.default),this.pro_buffCtrl=p.default.findChildByName(this.node,"pro_buffCtrl").getComponent(h.default)},e.prototype.testAddHero=function(t,e){if(isNaN(Number(e))){if("attack"==e)for(var o in this.pro_heroCtrl.getHeroList())this.pro_heroCtrl.getHeroList()[o].getComponent(d.default).modifyAttribute(u.heroPropertyType.attackPower,2,4);else if("speed"==e)for(var o in this.pro_heroCtrl.getHeroList())this.pro_heroCtrl.getHeroList()[o].getComponent(d.default).modifyAttribute(u.heroPropertyType.attackSpeed,2,4);else if("penerate"==e)for(var o in this.pro_heroCtrl.getHeroList())this.pro_heroCtrl.getHeroList()[o].getComponent(d.default).modifyAttribute(u.heroPropertyType.penetrate,2,4)}else this.pro_heroCtrl.addHero(Number(e))},e.prototype.getHeroCtrl=function(){return this.pro_heroCtrl},e.prototype.getBuffCtrl=function(){return this.pro_buffCtrl},e.prototype.getTarmCtrl=function(){return this.pro_tarmCtrl},e.prototype.moveHero=function(t){this.pro_heroCtrl.moveHero(t)},e.prototype.onLoad=function(){var t=this;this.initPorperty(),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.moveHero(e.getDelta().x)})},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.pro_heroCtrl.onUpdate(t),this.pro_tarmCtrl.onUpdate(t),this.pro_buffCtrl.onUpdate(t)},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],new_gameCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"16f22JQnvZMNY+d0BRM1xbF","new_gameCtrl");var i=t,n=e,a=o;cc._RF.push(n,"16f22JQnvZMNY+d0BRM1xbF","new_gameCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.boundary=void 0;var l=i("BaseUI"),p=i("PoolMgr"),u=i("NodeLib"),d=i("NEW_Configs"),h=i("NEW_DataMgr"),f=i("new_buttomCtrl"),m=i("new_topCtrl"),g=function(){};a.boundary=g;var y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_dieNode=null,e.pro_gmNode=null,e.pro_topCtrl=null,e.pro_buttomCtrl=null,e.pro_bulletLayer=null,e.pro_fence=null,e.pro_start=null,e.bulletBoundary=null,e.poolNum=0,e}var o;return s(e,t),o=e,e.prototype.initProperty=function(){this.pro_topCtrl=u.default.findChildByName(this.node,"pro_topCtrl").getComponent(m.default),this.pro_buttomCtrl=u.default.findChildByName(this.node,"pro_buttomCtrl").getComponent(f.default),this.pro_start=u.default.findChildByName(this.node,"pro_start"),this.pro_gmNode=u.default.findChildByName(this.node,"gmButton");var t=u.default.findChildByName(this.node,"root");this.pro_bulletLayer=u.default.findChildByName(t,"bulletLayer"),this.pro_fence=u.default.findChildByName(t,"pro_fence"),this.pro_dieNode=u.default.findChildByName(t,"pro_dieNode"),this.gameState=d.emNEWGameState.None},e.prototype.initEventListen=function(){this.addEvent(d.emNEWEventName.pause,this.onGamePause),this.addEvent(d.emNEWEventName.resume,this.onGameResume)},e.prototype.getBullletLayerByHeroIndex=function(t){for(var e=this.pro_bulletLayer.children,o=0;o<e.length;o++)if(e[o].name=="layer"+t)return e[o]},e.prototype.getPro_topCtrl=function(){return this.pro_topCtrl},e.prototype.getPro_buttomCtrl=function(){return this.pro_buttomCtrl},e.prototype.getBulletBoundary=function(){return this.bulletBoundary},e.prototype.openGmButtom=function(){this.pro_gmNode.active=!0},e.prototype.getPro_dieNode=function(){return this.pro_dieNode.getComponent(cc.Widget).updateAlignment(),this.pro_dieNode},e.prototype.getPro_dieNodeGapY=function(){var t=this.pro_dieNode.y;return this.pro_dieNode.getComponent(cc.Widget).updateAlignment(),this.pro_dieNode.y-t},e.prototype.initPool=function(){var t=this,e=h.default.getInstance().getCharacter();this.poolNum+=2*e.length;var o=function(o){var n=e[o].characterID;if(i.loadPrefab(d.emNEWBundles.prefabs,"item/bullets/NEW_Bullet_"+n,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.bulletName+n,e),t.startGame()}),14==n)return i.poolNum--,"continue";i.loadPrefab(d.emNEWBundles.prefabs,"item/skills/CardSkill"+n,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.CardSkill+n,e),t.startGame()})},i=this;for(var n in e)o(n);var a=function(e){r.poolNum++,r.loadPrefab(d.emNEWBundles.prefabs,"item/skills/"+d.poolName.MateSkill+e,function(o){p.PoolMgr.getInstance().creatrePool(d.poolName.MateSkill+e,o),t.startGame()})},r=this;for(n=1;n<=7;n++)a(n);this.poolNum+=7,this.loadPrefab(d.emNEWBundles.prefabs,"item/dragon/"+d.poolName.body_box,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body_box,e),t.startGame()}),this.loadPrefab(d.emNEWBundles.prefabs,"item/dragon/"+d.poolName.body_link,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body_link,e),t.startGame()}),this.loadPrefab(d.emNEWBundles.prefabs,"item/dragon/"+d.poolName.body_num,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body_num,e),t.startGame()}),this.loadPrefab(d.emNEWBundles.prefabs,"item/dragon/"+d.poolName.body_blood,function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body_blood,e),t.startGame()}),this.loadPrefab(d.emNEWBundles.prefabs,"item/enemy_hit_fps",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.effect,e),t.startGame()}),this.loadPrefab(d.emNEWBundles.prefabs,"item/dragon_destroy",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.body_destroy,e),t.startGame()}),this.loadPrefab(d.emNEWBundles.prefabs,"item/bullets/NEW_Bullet_skill",function(e){p.PoolMgr.getInstance().creatrePool(d.poolName.Bullet_skill,e),t.startGame()})},e.prototype.initBulletBoundary=function(){this.pro_fence.getComponent(cc.Widget).updateAlignment(),this.bulletBoundary=new g;var t=cc.winSize;this.bulletBoundary.upBoundary=t.height/2,this.bulletBoundary.leftBoundary=-t.width/2,this.bulletBoundary.rightBoundary=t.width/2,this.bulletBoundary.downBoundary=this.pro_fence.y-50},e.prototype.startGame=function(){this.poolNum--,0==this.poolNum&&this.gameState==d.emNEWGameState.None&&(this.gameState=d.emNEWGameState.Game)},e.prototype.startGameView=function(){var t=this;this.pro_buttomCtrl.getHeroCtrl().addFirstHero(),this.pro_start.active=!0,this.pro_start.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this.pro_start.getComponent(sp.Skeleton).setCompleteListener(function(){t.pro_start.active=!1,t.poolNum<=0&&t.gameState==d.emNEWGameState.None&&(t.gameState=d.emNEWGameState.Game)})},e.prototype.onGamePause=function(){this.gameState=d.emNEWGameState.Pause},e.prototype.onGameResume=function(){this.gameState=d.emNEWGameState.Game},e.prototype.onGameOver=function(){this.gameState=d.emNEWGameState.Over},e.prototype.getGameState=function(){return this.gameState},e.prototype.onLoad=function(){o.instance=this,this.initProperty(),this.initEventListen(),this.initBulletBoundary(),this.gameState=d.emNEWGameState.None},e.prototype.start=function(){this.initPool(),this.startGameView()},e.prototype.update=function(t){this.gameState==d.emNEWGameState.Game&&(this.pro_topCtrl.onUpdate(t),this.pro_buttomCtrl.onUpdate(t))},e.instance=null,o=c([v],e)}(l.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],new_topCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1493c9b/uxB0o2ECJKlFHvn","new_topCtrl");var i=t,n=e,a=o;cc._RF.push(n,"1493c9b/uxB0o2ECJKlFHvn","new_topCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("UIMgr"),d=i("Utils"),h=i("Config"),f=i("NodeLib"),m=i("NEW_Configs"),g=i("new_GameEnumData"),y=i("NEW_DataMgr"),v=i("NEW_DragonBaseItem"),_=i("NEW_DragonBloodItem"),b=i("NEW_MahjongCtrl"),B=i("new_gameCtrl"),I=function(t,e){this.name=t,this.weight=e},P=cc._decorator,C=P.ccclass,D=(P.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_dragonPath=null,e.pro_body_boxLayer=null,e.pro_body_linkLayer=null,e.pro_body_numLayer=null,e.pro_body_bloodLayer=null,e.pro_mahjongCtrl=null,e.pro_body_head=null,e.pro_body_last=null,e.dragonPath=[],e.dragonSpeed=200,e.dragonBodyArr=[],e.dragonBloodArr=[],e.createGapTime=0,e.baseCreateGapTime=.2,e.bodyNowIndex=1,e.nowLevel=1,e.lastNode=null,e.nowLevelCfg=null,e.itemIndex=1e4,e.bloodNode=null,e.skillPause=!1,e.skillPauseTime=0,e.body_numWidth=94,e.body_boxWidth=120,e.body_linkWidth=64,e.constDistance=.5,e.bodyGapIndex=[],e.headGapNum=260,e.lastGapNum=300,e.isEnd=!1,e.canWin=!1,e.iceState=!1,e.mahjongID=1,e.mahjongIsFirst=!0,e.createGapNum=0,e}return s(e,t),e.prototype.initPorperty=function(){this.pro_dragonPath=f.default.findChildByName(this.node,"pro_dragonPath").getComponent(cc.Animation),this.pro_body_boxLayer=f.default.findChildByName(this.node,"pro_body_boxLayer"),this.pro_body_linkLayer=f.default.findChildByName(this.node,"pro_body_linkLayer"),this.pro_body_numLayer=f.default.findChildByName(this.node,"pro_body_numLayer"),this.pro_body_bloodLayer=f.default.findChildByName(this.node,"pro_body_bloodLayer"),this.pro_mahjongCtrl=f.default.findChildByName(this.node,"pro_mahjongCtrl").getComponent(b.default),this.pro_body_head=f.default.findChildByName(this.node,"pro_body_head"),this.pro_body_last=f.default.findChildByName(this.node,"pro_body_last")},e.prototype.initParam=function(){this.canWin=!1,this.isEnd=!1,this.createGapTime=0,this.bodyNowIndex=1,this.nowLevel=1,this.lastNode=null,this.nowLevelCfg=y.default.getInstance().getLevelCfgByID(this.nowLevel),this.dragonSpeed=y.default.getInstance().getParam(g.enumBasicParaCfg.moveSpeed),this.itemIndex=1e4,this.dragonPath=[],this.dragonBodyArr=[],this.dragonBloodArr=[]},e.prototype.setIceState=function(t){this.iceState=t},e.prototype.doSkillPause=function(t){this.skillPause=!0,this.skillPauseTime=t},e.prototype.checkCollision=function(t,e,o,i){for(var n=0;n<this.dragonBloodArr.length;n++)if(e!=n&&this.dragonBloodArr[n].checkCollision(t,o,i))return n;return-1},e.prototype.checkRangeSkill=function(t,e){for(var o=0;o<this.dragonBloodArr.length;o++)this.dragonBloodArr[o].checkRangeCollision(t,e)},e.prototype.removeBloodItem=function(t){for(var e in this.dragonBloodArr)if(this.dragonBloodArr[e].uuid==t.uuid){this.dragonBloodArr.splice(parseInt(e),1);break}0==this.dragonBloodArr.length&&(this.isEnd||this.canWin)&&(u.UIMgr.getInstance().openUI(m.NEW_UIID.UIResult,h.UIID.UINONE,!0),this.sendEvent(m.emNEWEventName.pause))},e.prototype.removeBodyItem=function(t){for(var e in this.dragonBodyArr)if(this.dragonBodyArr[e].uuid==t.uuid){this.dragonBodyArr.splice(parseInt(e),1);break}},e.prototype.getCloserChildNode=function(t){for(var e=1e5,o=this.pro_body_head,i=0;i<this.dragonBloodArr.length;i++)this.dragonBloodArr[i].checkInSkillRange(t)&&this.dragonBloodArr[i].node.y<e&&(e=this.dragonBloodArr[i].node.y,o=this.dragonBloodArr[i].node);return o},e.prototype.getHeadY=function(){return this.pro_body_head.y},e.prototype.getMahjongCtrl=function(){return this.pro_mahjongCtrl},e.prototype.hideLight=function(t){for(var e=0;e<this.dragonBodyArr.length;e++)this.dragonBodyArr[e].hideLight(t)},e.prototype.showLight=function(t){for(var e=0;e<this.dragonBodyArr.length;e++)this.dragonBodyArr[e].setLight(t)},e.prototype.testChangeSpeed=function(t,e){"up"==e?this.dragonSpeed*=2:"down"==e&&(this.dragonSpeed/=2)},e.prototype.createPath=function(){for(var t=this.pro_dragonPath.getClips()[0].curveData.props.position,e=Math.floor(B.default.instance.getPro_dieNodeGapY()),o=0;o<t.length;o++){var i=t[o],n=cc.v2();cc.Vec2.fromArray(n,i.value),n.y+=e,this.dragonPath.push(n)}var a=this.constDistance,r=[],s=0;for(o=1;o<this.dragonPath.length;o++){for(var c=this.dragonPath[o-1],l=this.dragonPath[o],p=c.sub(l).mag();s+p>=a;){var u=a-s,d=l.sub(c).normalize(),h=c.add(d.mul(u));r.push(h),s=0,c=h,p=l.sub(c).mag()}s+=p}this.dragonPath=r},e.prototype.createBodyGap=function(){this.bodyGapIndex=[],this.bodyGapIndex.push(this.body_numWidth/this.constDistance),this.bodyGapIndex.push((this.body_boxWidth/2+this.body_linkWidth/2)/this.constDistance),this.bodyGapIndex.push((this.body_numWidth/2+this.body_linkWidth/2)/this.constDistance),this.createGapNum=this.headGapNum},e.prototype.createBody=function(){this.isEnd||(this.bloodNode||this.createBodyBlood(),this.bodyNowIndex<=3?this.createBodyNum():4==this.bodyNowIndex?this.createBodyLink():5==this.bodyNowIndex?this.createBodyBox():6==this.bodyNowIndex&&this.createLastNode())},e.prototype.initBodyNode=function(t,e){var o=t.node;this.bloodNode.getComponent(_.default).addChildNode(t),o.zIndex=this.itemIndex--;var i=this.dragonPath[0];o.setPosition(i);var n=0;e==m.poolName.body_box&&(n=this.body_boxWidth/this.constDistance),e==m.poolName.body_link&&(n=this.body_linkWidth/this.constDistance),e==m.poolName.body_num&&(n=this.body_numWidth/this.constDistance);var a=this.pro_mahjongCtrl.getNeedLightMahjongArr(),r=this.getInfactPre().getComponent(v.default).getNowIndex()-this.getGapNum(n);t.initParam(r,this.dragonPath,this,n,e,this.lastNode,this.mahjongID,this.mahjongIsFirst),t.setLight(a),this.dragonBodyArr.push(t),this.lastNode=o},e.prototype.refreshMahjongID=function(){var t=this.getMahjongCtrl().getNowTaskCfg();if(t){for(var e=t.mahShowOdds.split("|"),o=[],i=0;i<e.length;i++){var n=e[i].split(","),a=n[1];o.push(new I(n[0],a))}var r=d.Utils.weight_rand(o);this.mahjongID=parseInt(r.name)}else this.mahjongID=Math.ceil(9*Math.random())},e.prototype.setNextLevel=function(){this.nowLevel++,this.nowLevelCfg=y.default.getInstance().getLevelCfgByID(this.nowLevel)},e.prototype.getGapNum=function(t){return this.getInfactPre().getComponent(v.default).getGapNum()/2+t/2},e.prototype.checkCanCreate=function(t,e){void 0===e&&(e=!1);var o=0;return t==m.poolName.body_box&&(o=this.body_boxWidth/this.constDistance),t==m.poolName.body_link&&(o=this.body_linkWidth/this.constDistance),t==m.poolName.body_num&&(o=this.body_numWidth/this.constDistance),e&&(o=this.lastGapNum),this.getInfactPre().getComponent(v.default).getNowIndex()-this.getGapNum(o)>=0},e.prototype.createBodyLink=function(){if(this.checkCanCreate(m.poolName.body_link)){this.setNextLevel(),this.refreshMahjongID();var t=p.PoolMgr.getInstance().getNode(m.poolName.body_link);this.pro_body_linkLayer.addChild(t);var e=t.getComponent(v.default);this.initBodyNode(e,m.poolName.body_link),this.createBodyBlood(),this.nowLevelCfg?(this.nowLevelCfg.treasureType?(this.bodyNowIndex=5,this.createGapNum+=this.bodyGapIndex[1]):(this.bodyNowIndex=1,this.createGapNum+=this.bodyGapIndex[2]),this.mahjongIsFirst=!0):(this.bodyNowIndex=6,this.createGapNum=this.lastGapNum)}},e.prototype.createBodyNum=function(){if(this.checkCanCreate(m.poolName.body_num)){this.bodyNowIndex++;var t=p.PoolMgr.getInstance().getNode(m.poolName.body_num);this.pro_body_numLayer.addChild(t);var e=t.getComponent(v.default);this.initBodyNode(e,m.poolName.body_num),3==this.bodyNowIndex&&this.setBodyBloodTagetNode(t,0,this.mahjongID),4!=this.bodyNowIndex?this.createGapNum+=this.bodyGapIndex[0]:this.createGapNum+=this.bodyGapIndex[2],this.mahjongIsFirst=!1}},e.prototype.createBodyBox=function(){if(this.checkCanCreate(m.poolName.body_box)){this.bodyNowIndex=4;var t=p.PoolMgr.getInstance().getNode(m.poolName.body_box);this.pro_body_boxLayer.addChild(t);var e=t.getComponent(v.default);this.initBodyNode(e,m.poolName.body_box),this.createGapNum+=this.bodyGapIndex[1],this.setBodyBloodTagetNode(t,1)}},e.prototype.createBodyHead=function(){var t=this.pro_body_head,e=t.getComponent(v.default),o=this.dragonPath[0];t.setPosition(o),this.lastNode=t,this.dragonBodyArr.push(e),e.initParam(0,this.dragonPath,this,this.headGapNum)},e.prototype.createLastNode=function(){if(this.checkCanCreate("isLast",!0)){var t=this.pro_body_last,e=t.getComponent(v.default),o=this.dragonPath[0];return t.setPosition(o),this.lastNode=t,this.dragonBodyArr.push(e),e.initParam(0,this.dragonPath,this,this.lastGapNum),e.setIsLast(),this.isEnd=!0,!0}},e.prototype.createBodyBlood=function(){this.bloodNode&&(this.bloodNode.getComponent(_.default).doCanbeHitDown(),y.default.getInstance().getLevelCfgByID(this.nowLevel+1)||(this.canWin=!0)),this.bloodNode=p.PoolMgr.getInstance().getNode(m.poolName.body_blood),this.pro_body_bloodLayer.addChild(this.bloodNode),this.bloodNode.active=!1},e.prototype.setBodyBloodTagetNode=function(t,e,o){void 0===o&&(o=-1),this.bloodNode.active=!0;var i=this.bloodNode.getComponent(_.default),n=this.nowLevelCfg.dragonHp,a=t.height/2;i.initParam(n,e,a,t,this,this.nowLevel,o),this.dragonBloodArr.push(i)},e.prototype.getInfactPre=function(){for(var t=null,e=0;e<this.dragonBodyArr.length;e++)this.dragonBodyArr[e].getIsDestroy()||(t=this.dragonBodyArr[e].node);return t},e.prototype.onLoad=function(){this.initPorperty()},e.prototype.start=function(){this.initParam(),this.createPath(),this.createBodyHead(),this.refreshMahjongID(),this.createBodyGap()},e.prototype.onUpdate=function(t){if(this.skillPause&&(this.skillPauseTime-=t,this.skillPauseTime<=0&&(this.skillPause=!1)),!this.skillPause&&!this.iceState){this.createGapNum-=this.dragonSpeed,this.createGapNum<=0&&this.createBody();for(var e=0;e<this.dragonBodyArr.length;e++)this.dragonBodyArr[e].onUpdate(t,this.dragonSpeed)}for(e=0;e<this.dragonBloodArr.length;e++)this.dragonBloodArr[e].onUpdate(t);this.pro_mahjongCtrl.setExtraBuffOnUpdate(t)},c([C],e)}(l.default));a.default=D,cc._RF.pop(),cc._RF.pop()},{}],oMathLib:[function(t,e,o){"use strict";cc._RF.push(e,"0c97c7QqO9PfIldNUD7ulwD","oMathLib");var i=e,n=o;cc._RF.push(i,"0c97c7QqO9PfIldNUD7ulwD","oMathLib"),Object.defineProperty(n,"__esModule",{value:!0}),n.LibWeightObj=void 0,n.LibWeightObj=function(t,e){this.name=t,this.weight=e};var a=function(){function t(){}return t.generateValues=function(t,e,o,i){for(var n=[],a=o,r=0;r<i;r++){var s=Math.min(e,a-(i-r-1)*t),c=Math.max(t,a-(i-r-1)*e);if(c>s)return null;var l=Math.floor(Math.random()*(s-c+1))+c;n.push(l),a-=l}return n},t.verifyRandomChoice=function(t,e){void 0===e&&(e=1e4);var o={},i=0;t.forEach(function(t){o[t.name]=0,i+=Number(t.weight)});for(var n=0;n<e;n++){var a=this.weight_rand(t);o[a.name]++}console.log("Trial Results:"),t.forEach(function(n){var a=o[n.name]/e;console.log(n.name+": "+a.toFixed(4)+" (Expected: "+(t.weight/i).toFixed(4)+")")})},t.weight_rand=function(t,e){var o;void 0===e&&(e=1);for(var i=0,n=!1,a=function(t,e){var o=Math.min(t,e),i=Math.max(t,e),n=1;if(0===t||0===e)return i;for(var a=o;a>=1;a--)if(o%a==0&&i%a==0){n=a;break}return n},r=new Array,s=0;s<t.length;s++)void 0!==t[s].weight?-1!==t[s].weight.toString().indexOf("%")?(o=Math.floor(t[s].weight.toString().replace("%","")),n=!0):o=Math.floor(100*t[s].weight):o=0,r[s]=o,i=a(i,o);var c=new Array,l=0,p=0;if(n){for(s=0;s<t.length;s++){p=r[s];for(var u=0;u<p&&!(l>=100);u++)c.push(s),l++}for(;l<100;)c.push(t.length-1),l++}else for(s=0;s<t.length;s++){for(p=r[s]/i,u=0;u<p;u++)c.push(s);l+=p}return t[c[Math.floor(Math.random()*l)]]},t}();n.default=a,cc._RF.pop(),cc._RF.pop()},{}],richTextLib:[function(t,e,o){"use strict";cc._RF.push(e,"99699QLrglKQqsn1I44aTzr","richTextLib");var i=e,n=o;cc._RF.push(i,"99699QLrglKQqsn1I44aTzr","richTextLib"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(){}return t.insertStr=function(t,e,o){if(e<-t.length-1||e>t.length)throw"insert position is error";return e>=0?t.slice(0,e)+o+t.slice(e):t.slice(0,t.length+1+e)+o+t.slice(t.length+1+e)},t.formatString=function(e){for(var o=0;o<e.length;o++)if("\uff0c"==e[o])return t.insertStr(e,o+1,"\n");return e},t.formatStringByChar=function(e,o){for(var i=0;i<e.length;i++)if(e[i]==o)return t.insertStr(e,i+1,"\n");return e},t.prototype.setInColor=function(e){t.inColor=e},t.prototype.setOutColor=function(e){t.outColor=e},t.getRichText=function(e){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var n=t.outColor,a=t.inColor,r=0,s="",c=!1,l=e;for(var p in e)"}"==e[p]&&(c=!1,l=e.replace(s,o[r++]),s=""),c&&(s+=e[p]),"{"==e[p]&&(c=!0);return(l=(l=(l="<color = "+n+">"+l).replace("{","<color = "+a+">")).replace("}","</c>"))+"</c>"},t.inColor="f2ac44",t.outColor="454443",t}();n.default=a,cc._RF.pop(),cc._RF.pop()},{}],sod_bulletBase:[function(t,e,o){"use strict";cc._RF.push(e,"cccbd28nkBHdZkV98/G3tgz","sod_bulletBase");var i=t,n=e,a=o;cc._RF.push(n,"cccbd28nkBHdZkV98/G3tgz","sod_bulletBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("SOD_Configs"),d=i("SODGameEnumData"),h=i("SOD_DataMgr"),f=i("sod_factorBase"),m=i("sod_itemBase"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetNode=null,e.bulletSpeed=0,e.bulletPower=0,e.bulletPoolName="",e.parentCtrl=null,e}return s(e,t),e.prototype.initParam=function(t,e,o,i){this.targetNode=t,this.bulletPower=e,this.bulletPoolName=o,this.parentCtrl=i,this.bulletSpeed=15*h.default.getInstance().getParam(d.enumBasicParaCfg.bulletSpeed)},e.prototype.doColliderDown=function(){var t=this.targetNode.parent,e=t.getComponent(m.default),o=t.getComponent(f.default);e?e.handleHurt(this.bulletPower):o&&o.reduceHp(this.bulletPower),p.PoolMgr.getInstance().freeNode(this.bulletPoolName,this.node),this.parentCtrl.removeItem(this)},e.prototype.checkCollider=function(){var t=this.getWorldRect(this.node),e=this.getWorldRect(this.targetNode);if(!(t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y))return!1;this.doColliderDown()},e.prototype.getWorldRect=function(t){var e=t.convertToWorldSpaceAR(cc.v2(0,0));return{x:e.x,y:e.y,width:t.width,height:t.height}},e.prototype.checkTarget=function(){var t=this.targetNode.parent.getComponent(m.default);return!(!t||t.getState()!=u.SOD_ItemState.die||(p.PoolMgr.getInstance().freeNode(this.bulletPoolName,this.node),this.parentCtrl.removeItem(this),0))},e.prototype.start=function(){},e.prototype.onUpdate=function(t){if(!this.checkTarget()){var e=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),o=this.targetNode.convertToWorldSpaceAR(cc.Vec3.ZERO).sub(e),i=180*Math.atan2(o.y,o.x)/Math.PI;this.node.angle=i;var n=o.normalize();this.node.x+=n.x*this.bulletSpeed*t,this.node.y+=n.y*this.bulletSpeed*t,this.checkCollider()}},c([y],e)}(l.default));a.default=v,cc._RF.pop(),cc._RF.pop()},{}],sod_factorBase:[function(t,e,o){"use strict";cc._RF.push(e,"7776aKCABFNhayYsv6kkZLo","sod_factorBase");var i=t,n=e,a=o;cc._RF.push(n,"7776aKCABFNhayYsv6kkZLo","sod_factorBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("UIMgr"),u=i("NodeLib"),d=i("SOD_Configs"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.factoryHp=0,e.factoryMaxHp=0,e.pro_factoryHpProgress=null,e.pro_factoryHpLabel=null,e.isEnd=!1,e}return s(e,t),e.prototype.initProperty=function(){this.pro_factoryHpProgress=u.default.getChildSprite(this.node,"pro_factoryHpProgress"),this.pro_factoryHpLabel=u.default.getChildLabel(this.node,"pro_factoryHpLabel"),this.pro_hit=u.default.findChildByName(this.node,"pro_hit")},e.prototype.initParam=function(t,e){this.factoryType=t,t==d.SOD_FactoryType.player?this.animationName="hit_human":this.animationName="hit_animal",this.factoryMaxHp=e,this.factoryHp=e,this.isEnd=!1,this.refreshHp()},e.prototype.getHitWpos=function(){return u.default.findChildByName(this.node,"attackedPos").convertToWorldSpaceAR(cc.Vec3.ZERO)},e.prototype.reduceHp=function(t){this.isEnd||(this.pro_hit.getComponent(sp.Skeleton).setAnimation(0,this.animationName,!1),this.factoryHp-=t,this.factoryHp=Math.max(0,this.factoryHp),this.refreshHp())},e.prototype.refreshHp=function(){this.pro_factoryHpProgress.fillRange=this.factoryHp/this.factoryMaxHp,this.pro_factoryHpLabel.string=""+this.factoryHp,this.factoryHp<=0&&this.checkResult()},e.prototype.checkResult=function(){this.isEnd=!0,this.factoryType==d.SOD_FactoryType.player?(this.sendEvent(d.SOD_EventName.sod_pause),p.UIMgr.getInstance().openUI(d.SOD_UIID.UIResult,-1,!1)):(this.sendEvent(d.SOD_EventName.sod_pause),p.UIMgr.getInstance().openUI(d.SOD_UIID.UIResult,-1,!0))},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},c([f],e)}(l.default));a.default=m,cc._RF.pop(),cc._RF.pop()},{}],sod_gameCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"a5d86supMdBqrSzVR0W/qdF","sod_gameCtrl");var i=t,n=e,a=o;cc._RF.push(n,"a5d86supMdBqrSzVR0W/qdF","sod_gameCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("PoolMgr"),u=i("SOD_Configs"),d=i("SOD_DataMgr"),h=i("buttomCtrl"),f=i("topCtrl"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameState=u.SOD_GameState.none,e}return s(e,t),e.prototype.initProperty=function(){this.gameButtomCtrl=this.node.getChildByName("buttom").getComponent(h.default),this.gameTopCtrl=this.node.getChildByName("top").getComponent(f.default),this.gameButtomCtrl.initCtrl(this),this.gameTopCtrl.initCtrl(this),this.gameState=u.SOD_GameState.none},e.prototype.initNodePool=function(){var t=this;this.loadPrefab(u.emSODBundles.prefabs,"buttom/itemCircle",function(e){p.PoolMgr.getInstance().creatrePool(u.SOD_PoolName.itemCircle,cc.instantiate(e)),t.gameState=u.SOD_GameState.game});var e=d.default.getInstance().getPrefabCfg(),o=function(t){var o=e[t];o.prefabName&&i.loadPrefab(u.emSODBundles.prefabs,o.prefabBundle+"/"+o.prefabName,function(t){p.PoolMgr.getInstance().creatrePool(o.prefabName,cc.instantiate(t))}),o.bulletName&&i.loadPrefab(u.emSODBundles.prefabs,o.prefabBundle+"/"+o.bulletName,function(t){p.PoolMgr.getInstance().creatrePool(o.bulletName,cc.instantiate(t))})},i=this;for(var n in e)o(n)},e.prototype.pauseGame=function(){this.gameState=u.SOD_GameState.pause,this.gameTopCtrl.pauseGame()},e.prototype.resumeGame=function(){this.gameState=u.SOD_GameState.game,this.gameTopCtrl.resumeGame()},e.prototype.onLoad=function(){this.initProperty(),this.initNodePool()},e.prototype.start=function(){},e.prototype.update=function(t){this.gameState!=u.SOD_GameState.pause&&(this.gameButtomCtrl.getComponent(h.default).onUpdate(t),this.gameTopCtrl.getComponent(f.default).onUpdate(t))},c([g],e)}(l.default));a.default=y,cc._RF.pop(),cc._RF.pop()},{}],sod_itemBase:[function(t,e,o){"use strict";cc._RF.push(e,"7cc68DLSaFAE7dBvcFWRKrn","sod_itemBase");var i=t,n=e,a=o;cc._RF.push(n,"7cc68DLSaFAE7dBvcFWRKrn","sod_itemBase");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("BaseCtrl"),p=i("AudioMgr"),u=i("PoolMgr"),d=i("SOD_Configs"),h=i("SODGameEnumData"),f=i("SOD_DataMgr"),m=i("sod_bulletBase"),g=i("sod_factorBase"),y=cc._decorator,v=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_bulletPos=null,e.pro_hpNode=null,e.pro_hpProgress=null,e.pro_die=null,e.pro_hit=null,e.state=d.SOD_ItemState.none,e.itemType=d.SOD_ItemType.none,e.attackPower=0,e.hpNum=0,e.hpMaxNum=0,e.moveSpeed=0,e.attackSpeed=0,e.attackSpeedTimer=0,e.moveAttack=100,e.attackRange=0,e.attackTarget=null,e.topNodeCtrl=null,e.itemPoolName="",e.bulletPoolName="",e.isWarrior=!1,e.rawCanAttackDisx=1,e.canAttack=1,e.audioName="",e.rangeAttack=!1,e}var o;return s(e,t),o=e,e.prototype.initProperty=function(){this.pro_spAni=this.node.getChildByName("spAni").getComponent(sp.Skeleton),this.pro_bulletPos=this.node.getChildByName("bulletPos"),this.pro_hpNode=this.node.getChildByName("pro_hpNode"),this.pro_hpProgress=this.pro_hpNode.getChildByName("pro_hpProgress").getComponent(cc.Sprite),this.pro_die=this.node.getChildByName("die"),this.pro_hit=this.node.getChildByName("hit")},e.prototype.initParam=function(t,e,o,i,n,a,r,s,c,l,p){void 0===p&&(p=""),this.state=d.SOD_ItemState.none,this.attackPower=t,this.attackSpeed=e,this.attackRange=o,this.hpMaxNum=i,this.hpNum=i,this.moveSpeed=n,this.itemType=a,this.topNodeCtrl=s,this.itemPoolName=r,this.bulletPoolName=p,this.isWarrior=c,this.audioName=l,this.rangeAttack="enemy_4"==r,""!=p&&(this.pro_bulletPos=this.node.getChildByName("bulletPos")),this.initParamByPool()},e.prototype.initParamByPool=function(){var t=this;this.pro_hpNode.active=!1,this.canAttack=this.rawCanAttackDisx,this.attackTarget=null,this.setState(d.SOD_ItemState.move),this.pro_die.active=!1,this.pro_hit.active=!1,this.pro_spAni.setEventListener(null),this.pro_spAni.setCompleteListener(null),this.pro_die.getComponent(sp.Skeleton).setCompleteListener(null),this.pro_spAni.setEventListener(function(e,o){"attack"==o.data.name&&t.doHurt()}),this.pro_spAni.setCompleteListener(function(e){"attack"==e.animation.name?t.doAttackDown():"die"==e.animation.name&&t.doDieDown()})},e.prototype.getItemType=function(){return this.itemType},e.prototype.getState=function(){return this.state},e.prototype.getCanBeAttack=function(){return this.canAttack<=0},e.prototype.setState=function(t){this.state=t,t==d.SOD_ItemState.move?this.pro_spAni.setAnimation(0,"move",!0):t==d.SOD_ItemState.attack?this.pro_spAni.setAnimation(0,"idle",!0):t==d.SOD_ItemState.die&&this.pro_spAni.setAnimation(0,"die",!1)},e.prototype.updateAttackTime=function(t){this.attackSpeedTimer+=t,this.attackSpeedTimer>=1/this.attackSpeed&&this.doAttackStart()},e.prototype.doAttackStart=function(){this.attackSpeedTimer=0,this.setState(d.SOD_ItemState.attacking),this.pro_spAni.setAnimation(0,"attack",!1)},e.prototype.doHurt=function(){if(this.state!=d.SOD_ItemState.die){var t=this.attackTarget.getComponent(o);if(t){if(this.checkItemIsUninfirm(t)&&(this.attackTarget=this.topNodeCtrl.getCloserAim(this.itemType,this.node,this.attackRange)),!this.attackTarget)return void this.setState(d.SOD_ItemState.move);if(p.AudioMgr.getInstance().playEffect(this.audioName,this.audioName),this.isWarrior)if(this.rangeAttack)for(var e=f.default.getInstance().getParam(h.enumBasicParaCfg.bossAtkTarget),i=Number(e.split(",")[0]),n=Number(e.split(",")[1]),a=this.topNodeCtrl.getInRangeAimArr(this.itemType,this.node,i,n),r=0;r<a.length;r++)a[r].getComponent(o).handleHurt(this.attackPower);else this.attackTarget.getComponent(o).handleHurt(this.attackPower);else this.createBullet()}else this.isWarrior?this.attackTarget.getComponent(g.default).reduceHp(this.attackPower):this.createBullet()}},e.prototype.checkItemIsUninfirm=function(t){if(t.getState()==d.SOD_ItemState.die)return!0;var e=t.node.convertToWorldSpaceAR(cc.Vec3.ZERO),o=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO);return e.sub(o).mag()>this.attackRange||void 0},e.prototype.doAttackDown=function(){var t=this.attackTarget.getComponent(o);if(t){if(t.getState()==d.SOD_ItemState.die)return this.attackTarget=null,void this.setState(d.SOD_ItemState.move);this.setState(d.SOD_ItemState.attack)}else{var e=this.topNodeCtrl.getCloserAim(this.itemType,this.node,this.attackRange);e&&(this.attackTarget=e),this.setState(d.SOD_ItemState.attack)}},e.prototype.handleHurt=function(t){this.state!=d.SOD_ItemState.die&&(this.pro_hpNode.active=!0,this.hpNum-=t,this.refreshHpProgress(),this.hpNum<=0?(this.setState(d.SOD_ItemState.die),this.topNodeCtrl.removeItem(this)):(this.pro_hit.active=!0,this.itemType==d.SOD_ItemType.enemy?this.pro_hit.getComponent(sp.Skeleton).setAnimation(0,"hit_animal",!1):this.pro_hit.getComponent(sp.Skeleton).setAnimation(0,"hit_human",!1)))},e.prototype.doDieDown=function(){var t=this;this.pro_hpNode.active=!1,this.pro_die.active=!0,this.pro_die.getComponent(sp.Skeleton).setAnimation(0,"animation",!1);var e=this.pro_die.getComponent(sp.Skeleton).getCurrent(0),o=e.animationEnd-e.animationStart;this.scheduleOnce(function(){u.PoolMgr.getInstance().freeNode(t.itemPoolName,t.node)},o)},e.prototype.refreshHpProgress=function(){var t=this.hpNum/this.hpMaxNum;this.pro_hpProgress.fillRange=t},e.prototype.movetoAttack=function(){this.setState(d.SOD_ItemState.attack),this.moveAttack>=1/this.attackSpeed&&(this.doAttackStart(),this.moveAttack=0)},e.prototype.doMove=function(t){this.moveAttack+=t;var e,o=this.topNodeCtrl.getCloserAim(this.itemType,this.node),i=this.topNodeCtrl.getCloserBase(this.itemType),n=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO);if(o?(this.attackTarget=o,e=this.attackTarget.convertToWorldSpaceAR(cc.Vec3.ZERO)):(this.attackTarget=i,e=this.attackTarget.getComponent(g.default).getHitWpos()),this.canAttack<=0){var a=n.sub(e).mag();if(o){if(a<=this.attackRange)return void this.movetoAttack()}else if(a<=this.attackRange+50)return void this.movetoAttack()}var r=e.sub(n).normalize();this.node.x+=r.x*this.moveSpeed*2*t,this.node.y+=r.y*this.moveSpeed*2*t,this.canAttack>0&&(this.canAttack-=2*this.moveSpeed*t)},e.prototype.createBullet=function(){var t=u.PoolMgr.getInstance().getNode(this.bulletPoolName);t.parent=this.topNodeCtrl.getBulletLayer();var e=this.pro_bulletPos.convertToWorldSpaceAR(cc.Vec3.ZERO);t.position=this.topNodeCtrl.getBulletLayer().convertToNodeSpaceAR(e);var o=t.getComponent(m.default),i=this.attackTarget.getChildByName("bulletAttackPos");o.initParam(i,this.attackPower,this.bulletPoolName,this.topNodeCtrl),this.topNodeCtrl.addBullet(o)},e.prototype.pauseGame=function(){this.pro_spAni.paused=!0},e.prototype.resumeGame=function(){this.pro_spAni.paused=!1},e.prototype.onLoad=function(){this.initProperty()},e.prototype.start=function(){},e.prototype.onUpdate=function(t){this.state==d.SOD_ItemState.move?this.doMove(t):this.state==d.SOD_ItemState.attack&&this.updateAttackTime(t)},o=c([v],e)}(l.default));a.default=_,cc._RF.pop(),cc._RF.pop()},{}],stringLib:[function(t,e,o){"use strict";cc._RF.push(e,"a47e9+JmipBi504murf423F","stringLib");var i=e,n=o;cc._RF.push(i,"a47e9+JmipBi504murf423F","stringLib"),Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(){}return t.insertStr=function(t,e,o){if(e<-t.length-1||e>t.length)throw"insert position is error";return e>=0?t.slice(0,e)+o+t.slice(e):t.slice(0,t.length+1+e)+o+t.slice(t.length+1+e)},t.formatString=function(e){for(var o=0;o<e.length;o++)","!=e[o]&&"\uff0c"!=e[o]&&"\u3002"!=e[o]||(e=t.insertStr(e,o+1,"\n"));return e},t.formatStringByChar=function(e,o){for(var i=0;i<e.length;i++)if(e[i]==o)return t.insertStr(e,i+1,"\n");return e},t.prototype.setInColor=function(e){t.inColor=e},t.prototype.setOutColor=function(e){t.outColor=e},t.getRichText=function(e){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var n=t.outColor,a=t.inColor,r=0,s=e;return"<color="+n+">"+(s=s.replace(/{(.*?)}/g,function(t,e){var i=o[r++]||e;return"<color="+a+">"+i+"</color>"}))+"</color>"},t.getStringText=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var i=0,n=t;return n.replace(/{(.*?)}/g,function(t,o){return e[i++]||o})},t.getStringText2=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var i=0,n=t;return n.replace(/{(.*?)}/g,function(t,o){var n=e[i++]||o;return n<1&&(n=100*n+"%"),n})},t.inColor="ffffff",t.outColor="ffffff",t}();n.default=a,cc._RF.pop(),cc._RF.pop()},{}],subGameCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"017480g+txMBZq1inpYHNHc","subGameCtrl");var i=t,n=e,a=o;cc._RF.push(n,"017480g+txMBZq1inpYHNHc","subGameCtrl"),Object.defineProperty(a,"__esModule",{value:!0});var r=i("AudioMgr"),s=i("UIMgr"),c=i("Config"),l=i("common_Configs"),p=function(){function t(){this.initMap=new Map,this._exitCall=null,this._enterCall=null,this._isInited=!0,this.closeUIArr=[]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.enterSubModel=function(t,e){void 0===e&&(e=!1),e&&s.UIMgr.getInstance().openUI(l.Common_UIID.UIGameView,c.UIID.UINONE),t&&t()},t.prototype.selectEnter=function(){},t.prototype.doEnterDown=function(){r.AudioMgr.getInstance().playMusic(l.COMMON_AudioId.bgm,l.commonConfig.bgMusic),this._enterCall&&this._enterCall(),this._enterCall=null,this.removeTouchEvent()},t.prototype.initProperty=function(){},t.prototype.exitSubModel=function(){this._exitCall&&this._exitCall(),this._exitCall=null},t.prototype.addTouchEvent=function(){var t=new cc.Node;t.setContentSize(cc.winSize.width,cc.winSize.height),t.addComponent(cc.BlockInputEvents).enabled=!0,t.zIndex=9999,t.name="block_touch_event",t.parent=cc.Canvas.instance.node},t.prototype.removeTouchEvent=function(){var t=cc.Canvas.instance.node.getChildByName("block_touch_event");t&&t.destroy()},t.prototype.setGameState=function(t){this.gameState=t},t.prototype.getGameState=function(){return this.gameState},t}();a.default=p,cc._RF.pop(),cc._RF.pop()},{}],subgameTime:[function(t,e,o){"use strict";cc._RF.push(e,"8bb0dwAeg9Ib5LfLndRIgbe","subgameTime");var i=t,n=e,a=o;cc._RF.push(n,"8bb0dwAeg9Ib5LfLndRIgbe","subgameTime"),Object.defineProperty(a,"__esModule",{value:!0}),a.subTimeGame=void 0;var r=i("Common_PlayerMgr"),s=function(){function t(){this.isTimerActive=!1,this.subGameIndex="",this.subGameGapTime=10}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.initSubTimer=function(t){this.isTimerActive=!0,this.subGameIndex=t,this.startSubTimer()},t.prototype.startSubTimer=function(){var t=this;this.isTimerActive&&(r.default.getInstance().getSubUserData().setSubgameTimeByIndex(this.subGameIndex),setTimeout(function(){t.startSubTimer()},1e3*this.subGameGapTime))},t.prototype.closeSubTimer=function(){this.isTimerActive=!1},t}();a.subTimeGame=s,cc._RF.pop(),cc._RF.pop()},{}],topCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"0aff7+vABRHcatmoSiEaH8n","topCtrl");var i=t,n=e,a=o;cc._RF.push(n,"0aff7+vABRHcatmoSiEaH8n","topCtrl");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},l=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var a=arguments[e],r=0,s=a.length;r<s;r++,n++)i[n]=a[r];return i};Object.defineProperty(a,"__esModule",{value:!0});var p=i("BaseCtrl"),u=i("PoolMgr"),d=i("ArrLib"),h=i("NodeLib"),f=i("SOD_Configs"),m=i("SODGameEnumData"),g=i("SOD_DataMgr"),y=i("sod_factorBase"),v=i("sod_itemBase"),_=function(t,e,o){this.soilderID=t,this.extraAttack=e,this.createTime=o},b=cc._decorator,B=b.ccclass,I=(b.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pro_ourSide=null,e.pro_enemySide=null,e.pro_ourParent=null,e.pro_enemyParent=null,e.pro_bulletLayer=null,e.enemyList=[],e.ourList=[],e.bulletList=[],e.nowLevel=0,e.maxLevel=0,e.nowRound=0,e.maxRound=0,e.createList=[],e.pipeCreateTime=0,e.levelTime=0,e}return s(e,t),e.prototype.initproperty=function(){this.pro_ourSide=h.default.findChildByName(this.node,"pro_ourSide"),this.pro_enemySide=h.default.findChildByName(this.node,"pro_enemySide"),this.pro_enemyParent=h.default.findChildByName(this.node,"pro_enemyFactory"),this.pro_ourParent=h.default.findChildByName(this.node,"pro_ourFactory"),this.pro_bulletLayer=h.default.findChildByName(this.node,"pro_bulletLayer")},e.prototype.initParam=function(){this.pipeCreateTime=g.default.getInstance().getParam(m.enumBasicParaCfg.pipeCreateTime),this.nowLevel=1,this.nowRound=1,this.maxLevel=g.default.getInstance().getMAXLevel(),this.maxRound=g.default.getInstance().getMAXRoundByLevel(this.nowLevel),this.levelTime=g.default.getInstance().getLevelCfgByLevelAndRound(this.nowLevel,this.nowRound).levelTime,this.pro_ourSide.getComponent(y.default).initParam(f.SOD_FactoryType.player,g.default.getInstance().getParam(m.enumBasicParaCfg.baseHp)),this.pro_enemySide.getComponent(y.default).initParam(f.SOD_FactoryType.enemy,g.default.getInstance().getParam(m.enumBasicParaCfg.enemyBaseHp))},e.prototype.initCtrl=function(t){this.sod_gameCtrl=t},e.prototype.getGameCtrl=function(){return this.sod_gameCtrl},e.prototype.getBulletLayer=function(){return this.pro_bulletLayer},e.prototype.addItem=function(t){var e=new _(t.getGrade(),t.getExtraPower(),this.pipeCreateTime);this.createList.push(e)},e.prototype.testAddItem=function(t,e){var o=Number(e),i=new _(o,0,.1);this.createList.push(i)},e.prototype.removeItem=function(t){for(var e in this.ourList)if(this.ourList[e].uuid==t.uuid){this.ourList.splice(parseInt(e),1);break}for(var e in this.enemyList)if(this.enemyList[e].uuid==t.uuid){this.enemyList.splice(parseInt(e),1),this.sendEvent(f.SOD_EventName.sod_changeEnemyNum,this.enemyList.length);break}for(var e in this.bulletList)if(this.bulletList[e].uuid==t.uuid){this.bulletList.splice(parseInt(e),1);break}},e.prototype.addBullet=function(t){this.bulletList.push(t)},e.prototype.createOurItem=function(t){for(var e in this.createList){var o=this.createList[e];o.createTime<=0?(this.doCreateOurItemDown(o),this.createList.splice(parseInt(e),1)):o.createTime-=t}},e.prototype.doCreateOurItemDown=function(t){var e=g.default.getInstance().getSoilderCfgByID(t.soilderID);this.sendEvent(f.SOD_EventName.sod_showBanner,e.banner);var o=e.prefabID,i=g.default.getInstance().getPrefabCfgByID(o),n=i.prefabName,a=u.PoolMgr.getInstance().getNode(n);a.parent=this.pro_ourParent,a.position=cc.v3(0,0);var r=a.getComponent(v.default),s=e.ATKsoilder+t.extraAttack;i.bulletName?r.initParam(s,e.ASPDsoilder,e.ATKrangeX,e.HpSoilder,e.moveSoilder,f.SOD_ItemType.player,n,this,!1,e.attackSound,i.bulletName):r.initParam(s,e.ASPDsoilder,e.ATKrangeX,e.HpSoilder,e.moveSoilder,f.SOD_ItemType.player,n,this,!0,e.attackSound),this.ourList.push(r)},e.prototype.createOtherItem=function(t){if(!(this.nowLevel>this.maxLevel)&&(this.levelTime-=t,this.levelTime<=0)){if(this.nowRound>this.maxRound&&(this.nowRound=1,this.nowLevel++,this.nowLevel>this.maxLevel))return void console.log("\u5df2\u7ecf\u751f\u6210\u6240\u6709\u5173\u5361");var e=g.default.getInstance().getLevelCfgByLevelAndRound(this.nowLevel,this.nowRound);if(e){this.sendEvent(f.SOD_EventName.sod_changeWave,this.nowLevel,this.nowRound);var o=e.enemyID.split(","),i=d.ArrLib.getInstance().getRandomUniqueElements(o,e.soilderNumber);for(var n in i){var a=Number(i[n]),r=g.default.getInstance().getEnemyCfgByID(a);this.doCreateOtherItemDown(e,r)}this.nowRound++;var s=g.default.getInstance().getLevelCfgByLevelAndRound(this.nowLevel,this.nowRound);s&&(this.levelTime=s.levelTime)}}},e.prototype.doCreateOtherItemDown=function(t,e){var o=g.default.getInstance().getPrefabCfgByID(e.prefabID),i=o.prefabID,n=g.default.getInstance().getPrefabCfgByID(i).prefabName,a=u.PoolMgr.getInstance().getNode(n);a.parent=this.pro_enemyParent,a.position=cc.v3(0,0);var r=a.getComponent(v.default);o.bulletName?r.initParam(t.ATKenemy,t.ASPDsoilder,e.ATKrangeX,t.HpEnemy,t.moveEnemy,f.SOD_ItemType.enemy,n,this,!1,e.attackSound,o.bulletName):r.initParam(t.ATKenemy,t.ASPDsoilder,e.ATKrangeX,t.HpEnemy,t.moveEnemy,f.SOD_ItemType.enemy,n,this,!0,e.attackSound),this.enemyList.push(r),this.sendEvent(f.SOD_EventName.sod_changeEnemyNum,this.enemyList.length)},e.prototype.getCloserAim=function(t,e,o){o||(o=999999);var i=t==f.SOD_ItemType.enemy?this.ourList:this.enemyList,n=null,a=999999;for(var r in i){var s=i[r];if(s.getState()!=f.SOD_ItemState.die&&s.getCanBeAttack()){var c=i[r].node,l=e.convertToWorldSpaceAR(cc.Vec3.ZERO),p=c.convertToWorldSpaceAR(cc.Vec3.ZERO),u=l.sub(p).mag();u<a&&u<o&&(a=u,n=c)}}return n},e.prototype.getInRangeAimArr=function(t,e,o,i){var n=t==f.SOD_ItemType.enemy?this.ourList:this.enemyList,a=[];for(var r in n){var s=n[r];if(s.getState()!=f.SOD_ItemState.die&&s.getCanBeAttack()){var c=n[r].node,l=e.convertToWorldSpaceAR(cc.Vec3.ZERO),p=c.convertToWorldSpaceAR(cc.Vec3.ZERO);if(l.sub(p).mag()<o&&(a.push(c),a.length>=i))break}}return a},e.prototype.getCloserBase=function(t){return t==f.SOD_ItemType.player?this.pro_enemySide:this.pro_ourSide},e.prototype.moveAllItem=function(t){this.ourList.forEach(function(e){e.onUpdate(t)}),this.enemyList.forEach(function(e){e.onUpdate(t)}),this.bulletList.forEach(function(e){e.onUpdate(t)});var e=l(this.ourList);e.push.apply(e,this.enemyList),e.sort(function(t,e){var o=t.node.convertToWorldSpaceAR(cc.Vec3.ZERO);return e.node.convertToWorldSpaceAR(cc.Vec3.ZERO).y-o.y});for(var o=0;o<e.length;o++)e[o].node.zIndex=o+20},e.prototype.pauseGame=function(){this.ourList.forEach(function(t){t.pauseGame()}),this.enemyList.forEach(function(t){t.pauseGame()})},e.prototype.resumeGame=function(){this.ourList.forEach(function(t){t.resumeGame()}),this.enemyList.forEach(function(t){t.resumeGame()})},e.prototype.onLoad=function(){this.initproperty()},e.prototype.start=function(){this.initParam()},e.prototype.onUpdate=function(t){this.createOurItem(t),this.createOtherItem(t),this.moveAllItem(t)},c([B],e)}(p.default));a.default=I,cc._RF.pop(),cc._RF.pop()},{}],weapon_10:[function(t,e,o){"use strict";cc._RF.push(e,"84803uUPRJA74qGc66Ax2X8","weapon_10");var i=t,n=e,a=o;cc._RF.push(n,"84803uUPRJA74qGc66Ax2X8","weapon_10");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("WeaponBase"),p=i("Hold_Configs"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackNode=null,e.fireInterval=0,e}return s(e,t),e.prototype.onLoad=function(){this.width=800,this.height=250},e.prototype.start=function(){var t=this,e=this.node.getComponent(sp.Skeleton);e.setAnimation(0,"attack",!0),e.timeScale=this.params.weaponPara1,e.setCompleteListener(function(e){"attack"==e.animation.name&&t.damagedEnemies.clear()}),this.effectTime=e.getCurrent(0).animation.duration/e.timeScale,this.nowTime=0,this.effectName=p.HOLD_AudioId.sword},e.prototype.onUpdate=function(t){this.fireInterval+=t,this.durationTimer+=t;var e=this.attackNode.parent.convertToWorldSpaceAR(this.attackNode.position);this.applyRectDamage(e,this.width,this.height,this.damagedEnemies),this.playAudio(t),this.durationTimer>=this.params.weaponPara2&&this.resycleNode()},c([h(cc.Node)],e.prototype,"attackNode",void 0),c([d],e)}(l.WeaponBase);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],weapon_1:[function(t,e,o){"use strict";cc._RF.push(e,"e7439ftWs5Mb51EivRB2fIb","weapon_1");var i=t,n=e,a=o;cc._RF.push(n,"e7439ftWs5Mb51EivRB2fIb","weapon_1");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.weapon_1=void 0;var l=i("AudioMgr"),p=i("Hold_Configs"),u=i("Hold_GameCtrl"),d=i("linePos"),h=i("WeaponBase"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.projectNode=null,e.fireInterval=0,e.projectiles=[],e}return s(e,t),e.prototype.onLoad=function(){},e.prototype.onUpdate=function(t){this.projectiles.forEach(function(e){var o=e.getComponent(v);null==o||o.onUpdate(t)}),this.isActive&&(this.fireInterval+=t,this.durationTimer+=t,this.fireInterval>=1/this.params.weaponPara1&&(this.fireProjectile(),this.fireInterval=0),this.durationTimer>=this.params.weaponPara2&&(this.isActive=!1,this.node.active=!1))},e.prototype.resycleProject=function(t){this.projectiles=this.projectiles.filter(function(e){return e!=t.node}),0==this.projectiles.length&&this.doResycleDown()},e.prototype.fireProjectile=function(){l.AudioMgr.getInstance().playEffect(p.HOLD_AudioId.turret,p.Hold_AudioIDType.weapon);var t=cc.instantiate(this.projectNode);t.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),t.active=!0;var e=u.default.instance.getBulletLayerByIndex(t.name);t.parent=e;var o=this.node.convertToWorldSpaceAR(cc.v3(0,0)),i=e.convertToNodeSpaceAR(o);t.addComponent(v).init(i,this.params.weaponPara3,this.params.weaponPara0,this),this.projectiles.push(t)},e.prototype.doResycleDown=function(){this.isActive||this.resycleNode()},c([g(cc.Node)],e.prototype,"projectNode",void 0),c([m],e)}(h.WeaponBase);a.weapon_1=y;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=800,e.direction=cc.Vec3.RIGHT,e.worldPos=null,e.offsetX=0,e.offsetY=0,e.initialLocalPos=null,e.parentCtrl=null,e.maxDistance=2e3,e.isDestroy=!1,e.attackPower=50,e.width=50,e.height=50,e.radius=20,e.canMove=!0,e}return s(e,t),e.prototype.init=function(t,e,o,i){var n=this;this.width=400,this.height=500,this.initialLocalPos=t.clone(),this.worldPos=this.node.parent.convertToWorldSpaceAR(t),this.node.position=t,this.speed=e,this.parentCtrl=i,this.attackPower=o,this.node.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0),this.node.getComponent(sp.Skeleton).setCompleteListener(function(t){"effect"==t.animation.name&&(n.node.getComponent(sp.Skeleton).setAnimation(0,"effect",!1),n.doResycle())})},e.prototype.onUpdate=function(t){if(this.canMove){var e=t*this.speed;this.worldPos.y+=e,this.worldPos.z+=e;var o=d.PerspectiveLine.getInstance().getScreenPosition(this.worldPos.x,this.worldPos.y,this.worldPos.z,1),i=this.node.parent.convertToNodeSpaceAR(cc.v2(o.x,o.y));this.offsetX=i.x-this.initialLocalPos.x,this.offsetY=i.y-this.initialLocalPos.y,this.node.setPosition(i.x,i.y),this.node.setScale(o.scale);var n=Math.atan2(this.offsetY,this.offsetX)*(180/Math.PI);this.node.angle=n-90,this.maxDistance-=e,this.checkCollision(),this.maxDistance<=0&&this.doResycle()}},e.prototype.doResycle=function(){this.isDestroy||(this.isDestroy=!0,this.parentCtrl.resycleProject(this),this.node.removeFromParent())},e.prototype.checkCollision=function(){u.default.instance.checkCollisionWithEnemies(this.node.position,this.radius)&&(this.doAttack(),this.node.getComponent(sp.Skeleton).setAnimation(0,"effect",!1),this.canMove=!1)},e.prototype.doAttack=function(){var t=this.node.parent.convertToWorldSpaceAR(this.node.position);u.default.instance.damageEnemiesInRect(t,this.width,this.height,this.attackPower)},e}(cc.Component);cc._RF.pop(),cc._RF.pop()},{}],weapon_2:[function(t,e,o){"use strict";cc._RF.push(e,"455d9tg0spKI6iTwNDopQau","weapon_2");var i=t,n=e,a=o;cc._RF.push(n,"455d9tg0spKI6iTwNDopQau","weapon_2");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.weapon_2=void 0;var l=i("AudioMgr"),p=i("Hold_Configs"),u=i("WeaponBase"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fireInterval=0,e.maxDistance=0,e.canMove=!0,e}return s(e,t),e.prototype.onLoad=function(){this.baseScale=1.4,this.maxDistance=1e3,this.radius=200},e.prototype.start=function(){l.AudioMgr.getInstance().playEffect(p.HOLD_AudioId.boomerang,p.Hold_AudioIDType.weapon)},e.prototype.onUpdate=function(t){this.isActive&&(this.fireInterval+=t,this.durationTimer+=t,this.perspectMove(this.moveSpeed*t),this.fireInterval>=1/this.params.weaponPara1&&(this.applyAreaDamage(this.node.position,this.radius),l.AudioMgr.getInstance().playEffect(p.HOLD_AudioId.boomerang,p.Hold_AudioIDType.weapon),this.fireInterval=0),this.durationTimer>=this.params.weaponPara2&&this.resycleNode())},e.prototype.perspectMove=function(e){this.canMove&&(t.prototype.perspectiveMove.call(this,e),this.maxDistance-=e,this.maxDistance<=0&&(this.canMove=!1))},c([h],e)}(u.WeaponBase));a.weapon_2=f,cc._RF.pop(),cc._RF.pop()},{}],weapon_3:[function(t,e,o){"use strict";cc._RF.push(e,"d8b42H65DlHGINHYDQYDHF6","weapon_3");var i=t,n=e,a=o;cc._RF.push(n,"d8b42H65DlHGINHYDQYDHF6","weapon_3");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Hold_Configs"),p=i("WeaponBase"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackNode=null,e.fireInterval=0,e}return s(e,t),e.prototype.onLoad=function(){this.radius=200,this.width=500,this.height=200},e.prototype.start=function(){var t=this,e=this.node.getComponent(sp.Skeleton);e.setAnimation(0,"attack",!0),e.timeScale=this.params.weaponPara1,e.setCompleteListener(function(e){"attack"==e.animation.name&&t.damagedEnemies.clear()}),this.effectTime=e.getCurrent(0).animation.duration/e.timeScale,this.nowTime=0,this.effectName=l.HOLD_AudioId.peacock},e.prototype.onUpdate=function(t){if(this.isActive){this.fireInterval+=t,this.durationTimer+=t;var e=this.attackNode.parent.convertToWorldSpaceAR(this.attackNode.position);this.applyRectDamage(e,this.width,this.height,this.damagedEnemies),this.playAudio(t),this.durationTimer>=this.params.weaponPara2&&this.resycleNode()}},c([h(cc.Node)],e.prototype,"attackNode",void 0),c([d],e)}(p.WeaponBase);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],weapon_4:[function(t,e,o){"use strict";cc._RF.push(e,"946f0y4/nJNnqbsXCKVfPqb","weapon_4");var i=t,n=e,a=o;cc._RF.push(n,"946f0y4/nJNnqbsXCKVfPqb","weapon_4");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("Hold_Configs"),p=i("WeaponBase"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackNode=null,e.fireInterval=0,e}return s(e,t),e.prototype.onLoad=function(){this.radius=200,this.width=500,this.height=200},e.prototype.start=function(){var t=this,e=this.node.getComponent(sp.Skeleton);e.setAnimation(0,"attack",!0),e.timeScale=this.params.weaponPara1,e.setCompleteListener(function(e){"attack"==e.animation.name&&t.damagedEnemies.clear()}),this.effectTime=e.getCurrent(0).animation.duration/e.timeScale,this.nowTime=0,this.effectName=l.HOLD_AudioId.sleArrow},e.prototype.onUpdate=function(t){if(this.isActive){this.fireInterval+=t,this.durationTimer+=t;var e=this.attackNode.parent.convertToWorldSpaceAR(this.attackNode.position);this.applyRectDamage(e,this.width,this.height,this.damagedEnemies),this.playAudio(t),this.durationTimer>=this.params.weaponPara2&&this.resycleNode()}},c([h(cc.Node)],e.prototype,"attackNode",void 0),c([d],e)}(p.WeaponBase);a.default=f,cc._RF.pop(),cc._RF.pop()},{}],weapon_5:[function(t,e,o){"use strict";cc._RF.push(e,"02c49kqKFJOG6xEnuq6TvVe","weapon_5");var i=t,n=e,a=o;cc._RF.push(n,"02c49kqKFJOG6xEnuq6TvVe","weapon_5");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("Hold_Configs"),u=i("Hold_GameCtrl"),d=i("WeaponBase"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackNode=null,e.fireInterval=0,e.isAttack=!1,e}return s(e,t),e.prototype.onLoad=function(){this.width=500,this.height=500},e.prototype.start=function(){this.doAttackStart(),this.initListen()},e.prototype.initListen=function(){var t=this;this.attackNode.getComponent(sp.Skeleton).setCompleteListener(function(e){"chuxian"==e.animation.name?(t.attackNode.getComponent(sp.Skeleton).setAnimation(0,"idle",!0),t.isAttack=!0):"xiaoshi"==e.animation.name&&t.resycleNode()})},e.prototype.onUpdate=function(t){if(this.isActive){if(this.durationTimer+=t,this.isAttack&&(this.fireInterval+=t,this.fireInterval>=1/this.params.weaponPara1)){this.fireInterval=0;var e=this.attackNode.parent.convertToWorldSpaceAR(this.attackNode.position);this.applyRectDamage(e,this.width,this.height),l.AudioMgr.getInstance().playEffect(p.HOLD_AudioId.calabash,p.Hold_AudioIDType.weapon)}this.durationTimer>=this.params.weaponPara2&&(this.attackNode.getComponent(sp.Skeleton).setAnimation(0,"xiaoshi",!1),this.isActive=!1)}},e.prototype.doAttackStart=function(){var t=u.default.instance.getMinYEnemyPos(),e=this.node.convertToNodeSpaceAR(new cc.Vec2(0,t));this.attackNode.setPosition(0,e.y),this.attackNode.getComponent(sp.Skeleton).setAnimation(0,"chuxian",!1)},e.prototype.logWeaponType=function(){console.log("Shuriken")},c([m(cc.Node)],e.prototype,"attackNode",void 0),c([f],e)}(d.WeaponBase);a.default=g,cc._RF.pop(),cc._RF.pop()},{}],weapon_6:[function(t,e,o){"use strict";cc._RF.push(e,"23b118xCkNHhZ996o+YM3P4","weapon_6");var i=t,n=e,a=o;cc._RF.push(n,"23b118xCkNHhZ996o+YM3P4","weapon_6");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("WeaponBase"),p=cc._decorator,u=p.ccclass,d=(p.property,i("Hold_Configs")),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fireInterval=0,e.animationTime=0,e.attackWorldPos=cc.v3(0,0,0),e.moveY=700,e}return s(e,t),e.prototype.onLoad=function(){this.radius=200,this.width=800,this.height=700},e.prototype.start=function(){var t=this,e=this.node.getComponent(sp.Skeleton);e.setAnimation(0,"attack",!0),e.timeScale=this.params.weaponPara1,this.animationTime=e.getCurrent(0).animation.duration/e.timeScale,this.attackWorldPos=this.node.convertToWorldSpaceAR(new cc.Vec3(0,0,0)),e.setCompleteListener(function(e){"attack"==e.animation.name&&t.damagedEnemies.clear()}),this.effectTime=this.animationTime,this.nowTime=0,this.effectName=d.HOLD_AudioId.firefan},e.prototype.onUpdate=function(t){if(this.isActive){this.fireInterval+=t,this.durationTimer+=t;var e=this.fireInterval/this.animationTime;this.fireInterval>=this.animationTime&&(this.fireInterval=0);var o=this.attackWorldPos.clone();o.y+=e*this.moveY,this.applyRectDamage(o,this.width,this.height,this.damagedEnemies),this.playAudio(t),this.durationTimer>=this.params.weaponPara2&&this.resycleNode()}},c([u],e)}(l.WeaponBase);a.default=h,cc._RF.pop(),cc._RF.pop()},{}],weapon_7:[function(t,e,o){"use strict";cc._RF.push(e,"dc18bOFgZBByY2KqGu2Mbwk","weapon_7");var i=t,n=e,a=o;cc._RF.push(n,"dc18bOFgZBByY2KqGu2Mbwk","weapon_7");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0});var l=i("AudioMgr"),p=i("Hold_Configs"),u=i("WeaponBase"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackNode=null,e.bulletNode=null,e.bulletAttackNode=null,e.fireInterval=0,e.isAttack=!1,e.bulletAttackWidth=0,e.bulletAttackHeight=0,e}return s(e,t),e.prototype.onLoad=function(){this.radius=200,this.width=800,this.height=2e3,this.bulletAttackWidth=500,this.bulletAttackHeight=200},e.prototype.start=function(){var t=this;this.doAttackStart(),this.attackNode.getComponent(sp.Skeleton).setCompleteListener(function(e){"1appear"==e.animation.name?(t.attackNode.getComponent(sp.Skeleton).setAnimation(0,"2continue",!0),t.isAttack=!0):"3disappear"==e.animation.name&&t.resycleNode()}),l.AudioMgr.getInstance().playEffect(p.HOLD_AudioId.arrow,p.Hold_AudioIDType.weapon)},e.prototype.onUpdate=function(t){if(this.isActive)if(this.durationTimer+=t,this.durationTimer>=this.params.weaponPara2&&(this.attackNode.getComponent(sp.Skeleton).setAnimation(0,"3disappear",!1),this.isActive=!1),this.isAttack){if(this.fireInterval+=t,this.fireInterval>=1/this.params.weaponPara1){this.fireInterval=0;var e=this.attackNode.parent.convertToWorldSpaceAR(this.attackNode.position);this.applyRectDamage(e,this.width,this.height),l.AudioMgr.getInstance().playEffect(p.HOLD_AudioId.freeze,p.Hold_AudioIDType.weapon)}}else e=this.bulletAttackNode.parent.convertToWorldSpaceAR(this.bulletAttackNode.position),this.applyRectDamage(e,this.bulletAttackWidth,this.bulletAttackHeight,this.damagedEnemies)},e.prototype.doAttackStart=function(){this.node.getComponent(sp.Skeleton).setAnimation(0,"attack",!1),this.bulletNode.active=!0,this.bulletNode.getComponent(sp.Skeleton).setAnimation(0,"attack",!1),this.attackNode.getComponent(sp.Skeleton).setAnimation(0,"1appear",!1)},c([f(cc.Node)],e.prototype,"attackNode",void 0),c([f(cc.Node)],e.prototype,"bulletNode",void 0),c([f(cc.Node)],e.prototype,"bulletAttackNode",void 0),c([h],e)}(u.WeaponBase);a.default=m,cc._RF.pop(),cc._RF.pop()},{}],weapon_8:[function(t,e,o){"use strict";cc._RF.push(e,"4dd037AabBLIaX5FYe4q36F","weapon_8");var i=t,n=e,a=o;cc._RF.push(n,"4dd037AabBLIaX5FYe4q36F","weapon_8");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.weapon_9=void 0;var l=i("AudioMgr"),p=i("Hold_Configs"),u=i("Hold_GameCtrl"),d=i("WeaponBase"),h=cc._decorator,f=h.ccclass,m=h.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aniNode=null,e.fireInterval=0,e.maxDistance=0,e.canMove=!0,e}return s(e,t),e.prototype.onLoad=function(){this.baseScale=1,this.maxDistance=1200,this.radius=200},e.prototype.start=function(){var t=u.default.instance.getMinYEnemyPos(),e=this.node.parent.convertToWorldSpaceAR(this.node.position).y;this.maxDistance=t-e,this.node.getComponent(sp.Skeleton).setAnimation(0,"bullet",!0)},e.prototype.onUpdate=function(t){this.isActive&&(this.canMove||(this.durationTimer+=t),this.perspectMove(t*this.moveSpeed),this.durationTimer>=this.params.weaponPara2&&(u.default.instance.setEnemyCtrlState(1),this.resycleNode()))},e.prototype.perspectMove=function(e){this.canMove&&(t.prototype.perspectiveMove.call(this,e),this.maxDistance-=e,this.maxDistance<=0&&this.doMoveDown())},e.prototype.doMoveDown=function(){l.AudioMgr.getInstance().playEffect(p.HOLD_AudioId.icebreak,p.Hold_AudioIDType.weapon),u.default.instance.setEnemyCtrlState(0),this.node.getComponent(sp.Skeleton).setAnimation(0,"posui",!1),this.aniNode.getComponent(sp.Skeleton).setAnimation(0,"posui",!1),this.canMove=!1},e.prototype.logWeaponType=function(){console.log("fenghuolun")},c([m(cc.Node)],e.prototype,"aniNode",void 0),c([f],e)}(d.WeaponBase);a.weapon_9=g,cc._RF.pop(),cc._RF.pop()},{}],weapon_9:[function(t,e,o){"use strict";cc._RF.push(e,"f4ed9Gg/eNGfY5GPaxruQzG","weapon_9");var i=t,n=e,a=o;cc._RF.push(n,"f4ed9Gg/eNGfY5GPaxruQzG","weapon_9");var r,s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.weapon_9=void 0;var l=i("WeaponBase"),p=i("AudioMgr"),u=i("Hold_Configs"),d=cc._decorator,h=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fireInterval=0,e.maxDistance=0,e.canMove=!0,e}return s(e,t),e.prototype.onLoad=function(){this.baseScale=1,this.maxDistance=1200,this.radius=200},e.prototype.start=function(){p.AudioMgr.getInstance().playEffect(u.HOLD_AudioId.blood,u.Hold_AudioIDType.weapon)},e.prototype.onUpdate=function(t){this.isActive&&(this.perspectMove(t*this.moveSpeed),this.fireInterval+=t,this.durationTimer+=t,this.fireInterval>=1/this.params.weaponPara1&&(p.AudioMgr.getInstance().playEffect(u.HOLD_AudioId.blood,u.Hold_AudioIDType.weapon),this.applyAreaDamage(this.node.position,this.radius),this.fireInterval=0),this.durationTimer>=this.params.weaponPara2&&this.resycleNode())},e.prototype.perspectMove=function(e){this.canMove&&(t.prototype.perspectiveMove.call(this,e),this.maxDistance-=e,this.maxDistance<=0&&(this.canMove=!1))},e.prototype.logWeaponType=function(){console.log("fenghuolun")},c([h],e)}(l.WeaponBase));a.weapon_9=f,cc._RF.pop(),cc._RF.pop()},{}]},{},["AniBg","AnimationAction","AppManager","BACK_EffDie","BACK_Enemy","BACK_GameData","BACK_RoleBase","BACK_RoleBullet","BACK_SelectLevel","BACK_UIGM","BACK_UIGame","BACK_UIGameOver","BACK_UIPause","BALLGameData","BALL_Body","BALL_Bullet2","BALL_Bullet3","BALL_BulletEffect","BALL_Hero","BALL_HeroCtrl","BALL_Skill","BALL_SkillCtrl","BALL_Target","BALL_TarmCtrl","BALL_UIGameView","BALL_UIResult","BALL_UISetting","BALL_bodyCtrl","BALL_boxCtrl","BALL_mateSkill","BALL_mateSkillCtrl","BBD2Anima","BBD2ArrowItem","BBD2ArrowItem2","BBD2BossItem","BBD2GameData","BBD2GridItem","BBD2PlayerCtrl","BBD2_UIBuff","BBD2_UIGame","BBD2_UIResult","BBD2_UISetting","BBDAnima","BBDArrowItem","BBDArrowItem2","BBDBossItem","BBDGameData","BBDGridItem","BBDPlayerCtrl","BBD_UIBuff","BBD_UIGame","BBD_UIResult","BBD_UISetting","BHD_EffDie","BHD_EnemyRole","BHD_GameData","BHD_RoleBox","BHD_RoleBullet","BHD_RoleFieldAtk","BHD_UIBuffPro","BHD_UIGM","BHD_UIGame","BHD_UIGameOver","BHD_UIPause","BHD_UISelectBuff","BKT_EffDie","BKT_Enemy","BKT_GameData","BKT_RoleBase","BKT_RoleBullet","BKT_UIGM","BKT_UIGameOver","BKT_UIPause","BTYGameData","BTY_BeautyCtrl","BTY_Bullet2","BTY_BulletEffect","BTY_Enemy","BTY_EnemyVehicle","BTY_Hero","BTY_HeroCtrl","BTY_Skill","BTY_SkillCtrl","BTY_Target","BTY_TarmCtrl","BTY_UIGame","BTY_UIGameView","BTY_UIResult","BTY_UISetting","BTY_enemyCtrl","BTY_mateSkill","BTY_mateSkillCtrl","BaseServer","BezierCurve","Binary","BtnPress","BBD_Configs","BuildCustomEvent","ButtonCtrl","ByteDanceServerMgr","COMMON_BloodCtrl","COMMON_UIGameView","COMMON_UIPause","COMMON_UIResult","CameraCtrl","CardBullt10","CardCtrl01","CardCtrl02","CardCtrl03","CardCtrl04","CardCtrl05","CardCtrl06","CardCtrl07","CardCtrl08","CardCtrl09","CardCtrl10","CardCtrl11","CardCtrl12","CardCtrl13","CardCtrl14","CardCtrl15","CardCtrl16","CardCtrl17","CardCtrl18","CardSkill03","CityMgr","CoronaCtrl","DARGameData","DBGameData","DBS_AddBuffTakeGain","DBS_DeopBulletCtrl","DBS_EffAnimDie","DBS_GameData","DBS_JoystickCtrl","DBS_PoolMgr","DBS_RoleBase","DBS_TakeBase","DBS_TakeBuff","DBS_TakeGain","DBS_TakeLock","DBS_TakeMove","DBS_UIGM","DBS_UIGame","DBS_UIGameOver","DBS_UIPause","DBS_UISelectBuff","DBS_UISelectSolderRole","DBS_UIToolTips","DB_Bullet2","DB_Bullet2V2","DB_Bullet3","DB_BulletEffect","DB_Hero","DB_HeroCtrl","DB_Skill","DB_SkillCtrl","DB_Target","DB_TarmCtrl","DB_UIGameView","DB_UIResult","DB_UISetting","DB_ball","DB_ballCtrl","DB_bodyCtrl","DB_boxCtrl","DB_fireNode","DB_mateSkill","DB_mateSkillCtrl","DMDGameData","DMD_AnimaItem","DMD_BossCtrl","DMD_GameRoundBase","DMD_PlayerCtrl","DMD_PropItem","DMD_UIGame","DMD_UIGlove","DMD_UINextBoss","DMD_UIResult","DMD_UITips","DRA_Body","DRA_Bullet2","DRA_BulletEffect","DRA_Hero","DRA_HeroCtrl","DRA_Skill","DRA_SkillCtrl","DRA_Target","DRA_TarmCtrl","DRA_UIGameView","DRA_UIResult","DRA_UISetting","DRA_mateSkill","DRA_mateSkillCtrl","DW_Agent","DW_BossEnemy","DW_Common","DW_EffDie","DW_EnemyRole","DW_GameData","DW_JoystickCtrl","DW_QuadTree","DW_RoleBullet","DW_RoleField","DW_Simulator","DW_Trailing","DW_UIBuffPro","DW_UIGM","DW_UIGame","DW_UIGameOver","DW_UIPause","DW_UISelectBuff","DW_kdtree","DMD_DataMgr","DragonBody","DragonCtrl","Enemy","EnemyCtrl","FLY_BulletBaseItem","FLY_ExtraBuffCtrl","FLY_SkillCtrl","FLY_UIGameView","FLY_UIResult","FLY_UISetting","FSL_AtkHitEff","FSL_BuffBox","FSL_GameData","FSL_JoystickCtrl","FSL_LoongDieEff","FSL_LoongInitCourse","FSL_PropBoxBase","FSL_PropBoxMove","FSL_RoleBaseCtrl","FSL_RoleBullet","FSL_RoleBulletBase","FSL_RoleBulletPro","FSL_SkillBox","FSL_UIGM","FSL_UIGame","FSL_UIGameOver","FSL_UIPause","FSL_UISelectBuff","FSL_UISelectSolderRole","FSL_UIToolTips","GADGameData","GAD_Base","GAD_Bubble","GAD_BulletEffect","GAD_CardItem","GAD_Enemy_Ani","GAD_UIGame","GAD_UIGameView","GAD_UIResult","GAD_UISetting","GameBuff","GameData","GameEffect","GameShareData","GameSkillBuff","GameTram","GameUICtrl","HOLD_UIGameView","HOLD_UIResult","HOLD_UISetting","Hold_EnemyCtrl","Hold_GM","Hold_RoleCtrl","Hold_buffCtrl","Hold_rightBuffCtrl","Hold_weaponCtrl","InitCard","InitLab","ItemCardBullt","ItemEnemyBase","ItemEnemyBoss","ItemHp","LabelPlus","ListItem","LiveMgr","Loading","FSL_Loong","FSL_LoongLinkTrack","Main","MapCtrl","NEW_BulletBaseItem","NEW_ExtraBuffCtrl","NEW_MateSkillCtrl","NEW_SkillCtrl","NEW_UIGameView","NEW_UIResult","NEW_UISetting","NetInterface","NetManager","NetNode","PBTGameData","PBT_Base","PBT_Bubble","PBT_BulletEffect","PBT_CardItem","PBT_Enemy_Ani","PBT_UIGame","PBT_UIGameView","PBT_UIResult","PBT_UISetting","PopUserPrivacy","QuadTree","RCPDD_DieEff","RCPDD_GameData","RCPDD_GameMapCamera","RCPDD_JoystickCtrl","RCPDD_Quadtree","RCPDD_Tool","RCPDD_UIDoor","RCPDD_UIGame","RCPDD_UIGameOver","RCPDD_UISelectBuff","RCPDD_UISelectSolderRole","RCPDD_UISetting","RCPDD_UIToolTips","RSDGameData","RSD_UIGame","RUN2_boxCtrl","RUNGameData","RUN_Bullet2","RUN_BulletEffect","RUN_Hero","RUN_HeroCtrl","RUN_Skill","RUN_SkillCtrl","RUN_Target","RUN_TarmCtrl","RUN_UIGame","RUN_UIGameView","RUN_UIResult","RUN_UISetting","RUN_girlCtrl","RUN_mateSkill","RUN_mateSkillCtrl","ResCacheMgr","ArrLib","SFHttpHelp","SODGameData","SOD_UIResult","SOD_UISetting","STOGameData","STO_Bullet2","STO_BulletEffect","STO_Enemy","STO_Hero","STO_HeroCtrl","STO_Skill","STO_SkillCtrl","STO_Target","STO_TarmCtrl","STO_UIGame","STO_UIGameView","STO_UIResult","STO_UISetting","STO_enemyCtrl","STO_mateSkill","STO_mateSkillCtrl","ScrollCard","SegBaseData","SfSendQueue","SpineUtils","SubscribeManager","SwordPresent","TLB_BoxRoleAtk","TLB_EffDie","TLB_EnemyRole","TLB_GameData","TLB_RoleBullet","TLB_UIBuffPro","TLB_UIGM","TLB_UIGame","TLB_UIGameOver","TLB_UIPause","TLB_UISelectBuff","TPVP_Agent","TPVP_Common","TPVP_EffDie","TPVP_GameData","TPVP_RoleBase","TPVP_RoleBaseV2","TPVP_Simulator","TPVP_UIGM","TPVP_UIGame","TPVP_UIGameOver","TPVP_UIPause","TPVP_WeaponBase","TPVP_kdtree","TileCtrl","TranstaLabel","TranstanImg","Tree","TreeCtrl","TreeCtrlWithQ","UIAchieveBox","UIAddCoin","UIAddGold","UICardInfo","UICardLock","UICtrl","UIExchangeCode","UIGame","UIGameCardSell","UIGamePause","UIGameResult","UIGameTiesInfo","UIGuide","UIHome","UIOnlineReward","UIReport","UIReportTop","UIReward","UIRewardCard","UISelectBuff","UISetting","UIShopBox","UIShopOdds","UISideBoard","UISign","UISubEnter","UITaskAndAchieve","UITiesInfo","UITips","UITouch","WalkCtrl","WavesCtrl","WeachatServerMgr","Weapon","WeaponBase","WeaponCtrl","WebSock","WechatPayMgr","YEARGameData","YEAR_App","YEAR_Bullet2","YEAR_Bullet2V2","YEAR_Bullet3","YEAR_BulletEffect","YEAR_Hero","YEAR_HeroCtrl","YEAR_Skill","YEAR_SkillCtrl","YEAR_Target","YEAR_TarmCtrl","YEAR_UIGameView","YEAR_UIResult","YEAR_UISetting","YEAR_ball","YEAR_ballCtrl","YEAR_bodyCtrl","YEAR_boxCtrl","YEAR_fireNode","YEAR_mateSkill","YEAR_mateSkillCtrl","Common_PlayerMgr","NodeLib","stringLib","ball","ballCtrl","BaseMgr","bodyCtrl","boxCtrl","DBS_DropBullet","DBS_RoleBullet","buttomBaseNode","BaseCardCtrl","BaseCardSkillCtrl","SubGameData","BACK_Config","BACK_DataMgr","BACK_GameEnumData","BHD_Config","BHD_DataMgr","BHD_GameEnumData","BKT_Config","BKT_DataMgr","BKT_GameEnumData","DBS_Config","DBS_GameEnumData","DW_Config","DW_DataMgr","DW_GameEnumData","FSL_Config","FSL_DataMgr","FSL_GameEnumData","RCPDD_Config","RCPDD_GameEnumData","TLB_Config","TLB_DataMgr","TLB_GameEnumData","TPVP_Config","TPVP_DataMgr","TPVP_GameEnumData","TextConfig","common_Configs","BALL_Configs","BBD2_Configs","BTY_Configs","DB_Configs","DMD_Configs","DRA_Configs","FLY_Configs","GAD_Configs","Hold_Configs","NEW_Configs","PBT_Configs","PlatformConfig","RSD_Configs","RUN_Configs","SOD_Configs","STO_Configs","YEAR_Configs","BraveTowerEnum","GameCtrl","ItemGood","UtilLayout","GameSpawnCtrl","RoleCtrl","GameCtrlData","GamePlayInfo","BALL_BloodCtrl","BALL_BuffCtrl","BALL_mateCtrl","BTY_BloodCtrl","BTY_BuffCtrl","BTY_mateCtrl","DB_BloodCtrl","DB_BuffCtrl","DB_mateCtrl","DRA_BloodCtrl","DRA_BuffCtrl","DRA_mateCtrl","GAD_BuffTips","GAD_Bullet","GAD_Cards","GAD_Door","GAD_Enermy","Hold_GameCtrl","PBT_BuffTips","PBT_Bullet","PBT_Cards","PBT_Door","PBT_Enermy","RUN_BloodCtrl","RUN_BuffCtrl","RUN_mateCtrl","STO_BloodCtrl","STO_BuffCtrl","STO_mateCtrl","YEAR_BloodCtrl","YEAR_BuffCtrl","YEAR_mateCtrl","RCPDD_EvolutionDataMgr","BALL_UserData","BTY_UserData","DB_UserData","DRA_UserData","GAD_UserData","GameDailyData","GameGuideData","GameSetData","GameTaskData","GameTrackData","GameUserData","PBT_UserData","RSD_UserData","RUN_UserData","STO_UserData","YEAR_UserData","director","buttomDoorNode","buttomObstacleNode","DB_Body","RUN2_Body","RUN2_bodyCtrl","YEAR_Body","BALLGameEnumData","BBD2GameEnumData","BBDGameEnumData","BTYGameEnumData","DARGameEnumData","DBGameEnumData","DMDGameEnumData","GADGameEnumData","GameEnumData","PBTGameEnumData","RSDGameEnumData","RUNGameEnumData","SODGameEnumData","STOGameEnumData","YEARGameEnumData","fly_GameEnumData","hold_GameEnumData","new_GameEnumData","fireNode","fly_GameData","fly_buttomCtrl","fly_topCtrl","BaseButton","List","FeedCardMgr","LogMgr","TweenMgr","WechatEventMgr","ServerDataMgr","CacheUtils","BACK_GameManager","BACK_PlayerData","BHD_GameMgr","BKT_GameManager","DBS_DataMgr","DBS_GameManager","DW_GameMgr","FSL_GameManager","FSL_PoolMgr","BBD2MapGrid","BBDMapGrid","DMD_MapCtrl","RCPDD_Door","RCPDD_GameManager","RCPDD_PropTool","RCPDD_Skill","RCPDD_SolderRole","TLB_GameMgr","TPVP_GameMgr","TPVP_SFCMSpine","GameTrackDataEvent","fly_gameCtrl","FLY_BloodCtrl","NEW_BloodCtrl","Hold_extraBuffItem","PlayerMgr","sod_gameCtrl","UITop","buttomCtrl","gameLib","topCtrl","hold_GameData","HomeBattleCtrl","HomeBossCtrl","HomeCardCtrl","HomeShopCtrl","COMMON_BloodLayerCtrl","FLY_BloodItem","FLY_BuffItem","FLY_DragonBaseItem","FLY_DragonBloodItem","FLY_HeroItem","FLY_MateIconItem","FLY_MateSkillItem","FLY_SkillItem","ItemCard","ItemEnemy","NEW_BloodItem","NEW_BuffItem","NEW_DragonBaseItem","NEW_DragonBloodItem","NEW_HeroItem","NEW_MateIconItem","NEW_MateSkillItem","NEW_SkillItem","buttomFactor","sod_factorBase","sod_itemBase","itemCircle","itemCtrl","FLY_BuffCtrl","FLY_DragonCtrl","FLY_HeroCtrl","FLY_MateSkillCtrl","FLY_TarmCtrl","NEW_BuffCtrl","NEW_HeroCtrl","NEW_MahjongCtrl","NEW_TarmCtrl","Hold_EnemyItem","Hold_RoleItem","Hold_buffItem","Hold_bulletItem","logLib","BALL_DataMgr","BALL_PlayerMgr","BBD2_DataMgr","BBD_DataMgr","BTY_DataMgr","BTY_PlayerMgr","DB_DataMgr","DB_PlayerMgr","DRA_DataMgr","DRA_PlayerMgr","DataMgr","FLY_DataMgr","GAD_DataMgr","GAD_PlayerMgr","Hold_DataMgr","LanguageMgr","NEW_DataMgr","PBT_DataMgr","PBT_PlayerMgr","RSD_DataMgr","RSD_PlayerMgr","RUN_DataMgr","RUN_PlayerMgr","SOD_DataMgr","STO_DataMgr","STO_PlayerMgr","TileManager","YEAR_DataMgr","YEAR_PlayerMgr","BACK_Sphere","BALL_App","BACK_APP","BACK_APP2","BKT_APP","BTY_App","BHD_APP","BBD_APP","BBD2_APP","DMD_APP","DB_App","DRA_App","DW_APP","DBS_APP","FSL_APP","FLY_App","GAD_App","Hold_App","NEW_App","PBT_App","RCPDD_APP","RUN_App","SOD_APP","STO_App","TLB_APP","TPVP_APP","RSD_App","subgameTime","SocketMgr","new_GameData","new_buttomCtrl","new_gameCtrl","new_topCtrl","oMathLib","BACK_Btn_Skills","BACK_HarmEff","BACK_Skills","BACK_StoneMap","BACK_YunSpAnim","BHD_BoxInfoTipsBox","BHD_Btn_Skills","BHD_HarmEff","BHD_RoleMateTips","BHD_Skills","BHD_TowerGoldAnim","BKT_Btn_Skills","BKT_HarmEff","BKT_Skills","DBS_CriticalEff","DBS_Skills","DW_BoxInfoTipsBox","DW_Btn_Skills","DW_HarmEff","DW_PlankRipple","DW_PlayerCamera","DW_RoleMateTips","DW_SeaWave","DW_Skills","FSL_DropBuff","FSL_HarmEff","FSL_LoongMovePathInfo","FSL_Skills","TLB_BoxInfoTipsBox","TLB_Btn_Skills","TLB_HarmEff","TLB_MapLayre","TLB_RoleMateTips","TLB_Skills","TPVP_HarmEff","TPVP_RoleProTsipBox","AndroidManager","ByteDanceManager","EditorManager","ImplodeManager","IosManager","KSManager","OppoManager","VivoManager","WebLinkManager","WechatManager","BACK_PoolMgr","BHD_PoolMgr","BKT_PoolMgr","DW_PoolMgr","TLB_PoolMgr","TPVP_PoolMgr","DW_AddPropTips","DW_Prop","DW_QuadTreeMgr","RCPDD_QuadtreeItem","RCPDD_QuadtreeManager","richTextLib","BACK_RoleBox","BACK_RoleField","BHD_TowerDefense","BKT_RoleBox","BKT_RoleField","DBS_EnemyRole","DBS_LordRole","DBS_OursideRole","DW_PlankBox","DW_PlayerCtrl","DW_RoleBox","FSL_PlayerRole","RCPDD_EnemyNode","RCPDD_MinMonster","RCPDD_PlayerNode","RCPDD_RoleBase","TLB_BoxPlace","TLB_RoleFieldSkill","TLB_RoleMove","TPVP_RoleEnemy","TPVP_RoleFriend","TPVP_TbeBoxBack","TPVP_WeaponBox","TPVP_WeaponTbe","BaseCtrl","BaseData","BasePlatform","BaseUI","Appcfg","PlatformSetting","AudioMgr","EventMgr","HttpMgr","PlatformManager","PoolMgr","ResourceMgr","SdkMgr","UIMgr","Utils","Config","sod_bulletBase","subGameCtrl","BALL_UIGame","BKT_UIGame","DB_UIGame","DRA_UIGame","SOD_UIGame","YEAR_UIGame","ArgsParseUtils","TimeUtils","UIUtils","linePos","weapon_1","weapon_10","weapon_2","weapon_3","weapon_4","weapon_5","weapon_6","weapon_7","weapon_8","weapon_9"]);